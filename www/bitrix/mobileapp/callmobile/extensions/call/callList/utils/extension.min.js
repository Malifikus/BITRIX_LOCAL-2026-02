jn.define("call/callList/utils",((t,e,r)=>{const{DateFormatter:n}=t("im/messenger/lib/date-formatter");function s(t){if(!t){return 0}const e=Date.parse(t);if(Number.isFinite(e)){return Math.floor(e/1e3)}const r=String(t).trim().match(/^(\d{1,2})\.(\d{1,2})\.(\d{4})\s+(\d{1,2}):(\d{2})(?::(\d{2}))?$/);if(r){const t=Number(r[1]);const e=Number(r[2])-1;const n=Number(r[3]);const s=Number(r[4]);const i=Number(r[5]);const o=Number(r[6]||0);const a=new Date(n,e,t,s,i,o);return Math.floor(a.getTime()/1e3)}return 0}function i(t){const e=Math.floor(t/3600);const r=Math.floor(t%3600/60);const n=t%60;const s=[];if(e>0){s.push(BX.message("MOBILEAPP_CALL_LIST_TIME_HOURS_SHORT").replace("#VALUE#",String(e)))}if(r>0){s.push(BX.message("MOBILEAPP_CALL_LIST_TIME_MINUTES_SHORT").replace("#VALUE#",String(r)))}if(n>0){s.push(BX.message("MOBILEAPP_CALL_LIST_TIME_SECONDS_SHORT").replace("#VALUE#",String(n)))}return s.join(" ")}function o(t){const e=new Date(t*1e3);return n.getRecentFormat(e)}function a(t,e){return new Promise(((r,n)=>{try{BX.rest.callMethod(t,e,(t=>{if(t.error()){n(t.error())}else{const e=t.data();r(e)}}))}catch(t){n(t)}}))}function c(t){const e=String(t||"").trim();if(!e){return""}const r=e.toLowerCase();if(r.endsWith("blank.gif")||r.endsWith("blank.svg")){return""}if(e.startsWith("/")){return e.split(" ").join("%20")}const n=e.replace(/^(https?:\/\/)+/i,"");const s=n.indexOf("/");const i=s>=0?n.slice(s):n.startsWith("/")?n:`/${n}`;return i.split(" ").join("%20")}async function u(t,e={}){const{limit:r=10,offset:n=0,excludeUserIds:s=null,includeUserId:i=false}=e;const o=await a("im.search.user",{FIND:t,LIMIT:r,OFFSET:n});let u=[];if(o){u=Array.isArray(o)?o:Object.values(o)}u=u.filter((t=>!t.bot&&!t.network&&!t.connector));if(s&&s.size>0){u=u.filter((t=>!s.has(String(t.id))))}return Promise.all(u.map((async t=>{let e=0;const r=await a("im.dialog.get",{DIALOG_ID:t.id});if(r){e=r.id||0}const n={chatId:e,id:`user-${t.id}`,key:`user-${t.id}`,ts:0,title:t.name||"",phone:"",phoneNumber:"",sourceType:"user",dialogId:String(t.id),chatType:"private",avatar:c(t.avatar),workPosition:t.work_position||t.workPosition||"",userColor:t.color||"",isUnseen:false,duration:0};if(i){n.userId=Number(t.id)}return n})))}r.exports={parseStatusTime:s,formatDuration:i,formatTime:o,restCall:a,normalizeUserAvatarPath:c,searchUsers:u}}));
//# sourceMappingURL=extension.map.js