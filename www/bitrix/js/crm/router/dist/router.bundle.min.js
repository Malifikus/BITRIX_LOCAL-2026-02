this.BX=this.BX||{};(function(e,t,n){"use strict";let i=null;class r{}r.KANBAN="KANBAN";r.LIST="LIST";var l=babelHelpers.classPrivateFieldLooseKey("getItemDetailUrlTemplate");var o=babelHelpers.classPrivateFieldLooseKey("getItemDetailUrlTemplateMap");class s{constructor(){Object.defineProperty(this,o,{value:u});Object.defineProperty(this,l,{value:a});this.defaultRootUrlTemplates={};this.customRootUrlTemplates={};this.currentViews={}}static get Instance(){if(window.top!==window&&t.Reflection.getClass("top.BX.Crm.Router")){return window.top.BX.Crm.Router.Instance}if(i===null){i=new s}return i}setUrlTemplates(e){if(t.Type.isPlainObject(e.defaultRootUrlTemplates)){this.defaultRootUrlTemplates=e.defaultRootUrlTemplates}if(t.Type.isPlainObject(e.customRootUrlTemplates)){this.customRootUrlTemplates=e.customRootUrlTemplates}return this}setCurrentListView(e,t){this.currentViews[e]=t;return this}getCurrentListView(e){return this.currentViews[e]||r.KANBAN}static openSlider(e,n=null){const i=String(e);if(!t.Type.isStringFilled(i)){return Promise.resolve()}let r=t.Type.isPlainObject(n)?n:{};r={cacheable:false,allowChangeHistory:true,events:{},...r};return new Promise((e=>{r.events.onClose=t=>e(t.getSlider());BX.SidePanel.Instance.open(i,r)}))}openTypeDetail(e,n,i){const r=t.Type.isPlainObject(n)?n:{};r.width=876;r.allowChangeHistory=false;r.cacheable=false;const l=this.getTypeDetailUrl(e);if(l){if(t.Type.isPlainObject(i)){l.setQueryParams(i)}return s.openSlider(l.toString(),r)}return null}openAutomatedSolutionDetail(e=0,n={}){const i=t.Type.isPlainObject(n)?n:{};i.width=876;i.allowChangeHistory=false;i.cacheable=false;const r=this.getAutomatedSolutionDetailUrl(e);if(r){return s.openSlider(r,i)}return null}getTemplate(e,t=0){var n;if(t>0&&Object.hasOwn(this.customRootUrlTemplates,t)){var i;return(i=this.customRootUrlTemplates[t][e])!=null?i:null}return(n=this.defaultRootUrlTemplates[e])!=null?n:null}getTypeDetailUrl(e=0){const n=this.getTemplate("bitrix:crm.type.detail",e);if(n){return new t.Uri(n.replace("#entityTypeId#",e))}return null}getTypeListUrl(){const e=this.getTemplate("bitrix:crm.type.list");if(e){return new t.Uri(e)}return null}openTypeHelpPage(){s.openHelper(null,13315798)}static openHelper(e=null,n=null){if(e&&t.Type.isFunction(e.preventDefault)){e.preventDefault()}if(top.BX.Helper&&n>0){top.BX.Helper.show(`redirect=detail&code=${n}`)}}showFeatureSlider(e,n,i="limit_smart_process_automation"){s.Instance.closeSettingsMenu(e,n);if(t.Reflection.getClass("BX.UI.InfoHelper.show")){BX.UI.InfoHelper.show(i)}}getItemListUrlInCurrentView(e,n=0){const i=this.getCurrentListView(e);let l=null;if(i===r.KANBAN){l=this.getTemplate("bitrix:crm.item.kanban",e)}else{l=this.getTemplate("bitrix:crm.item.list",e)}if(l){return new t.Uri(l.replace("#entityTypeId#",e).replace("#categoryId#",n))}return null}getKanbanUrl(e,n=0){const i=this.getTemplate("bitrix:crm.item.kanban",e);if(i){return new t.Uri(i.replace("#entityTypeId#",e).replace("#categoryId#",n))}return null}getItemListUrl(e,n=0){const i=this.getTemplate("bitrix:crm.item.list",e);if(i){return new t.Uri(i.replace("#entityTypeId#",e).replace("#categoryId#",n))}return null}openDocumentSlider(e){return s.openSlider(`/bitrix/components/bitrix/crm.document.view/slider.php?documentId=${e}`,{width:1060,loader:"/bitrix/components/bitrix/crm.document.view/templates/.default/images/document_view.svg"})}openSignDocumentSlider(e,t){return s.openSlider(`/bitrix/components/bitrix/crm.signdocument.view/slider.php?documentId=${e}&memberHash=${t}`,{width:1060})}openSignDocumentModifySlider(e){return s.openSlider(`/sign/doc/0/?docId=${e}&stepId=changePartner&noRedirect=Y`,{width:1250})}openCalendarEventSlider(e,t){const n=`crm-calendar-slider-${e}-${Math.floor(Math.random()*1e3)}`;return new(window.top.BX||window.BX).Calendar.SliderLoader(e,{sliderId:n,isSharing:t}).show()}openRepeatSaleSegmentSlider(e,t=true,n={}){return s.openSlider(`/crm/repeat-sale-segment/details/${e}/`,{width:922,cacheable:false,requestMethod:"post",requestParams:{readOnly:t,analytics:n}})}closeSettingsMenu(e,n){if(n&&t.Type.isFunction(n.getMenuWindow)){const e=n.getMenuWindow();if(e){e.close();return}}const i=this;if(i&&t.Type.isFunction(i.close)){i.close()}}closeToolbarSettingsMenuRecursively(e,t){let n=t==null?void 0:t.getMenuWindow();if(!n){return}while(n){n.close();n=n.getParentMenuWindow()}}closeSliderOrRedirect(e,n=null){var i,r;const l=(i=BX.SidePanel)==null?void 0:(r=i.Instance)==null?void 0:r.getSliderByWindow(n!=null?n:window);if(l){l.close();return}if(e instanceof t.Uri){window.location.href=e.toString()}else{window.location.href=e}}getAutomatedSolutionListUrl(){return new t.Uri("/automation/type/automated_solution/list/")}getAutomatedSolutionDetailUrl(e){let n=t.Text.toInteger(e);n=n>0?n:0;return new t.Uri(`/automation/type/automated_solution/details/${n}/`)}getDealKanbanUrl(e){let n=t.Text.toInteger(e);n=n>0?n:0;return new t.Uri(`/crm/deal/kanban/category/${n}/`)}getItemDetailUrl(e,n,i=null){const r=t.Text.toInteger(e);const o=t.Text.toInteger(n);const s=t.Type.isNil(i)?null:t.Text.toInteger(i);if(!BX.CrmEntityType.isDefined(r)||o<0){return null}let a=babelHelpers.classPrivateFieldLooseBase(this,l)[l](r);if(a===null&&BX.CrmEntityType.isDynamicTypeByTypeId(r)){a=this.getTemplate("bitrix:crm.item.details")}if(!a){return null}const u=new t.Uri(a.replace("#entityId#",o));if(!t.Type.isNil(s)){u.setQueryParam("category_id",s)}return u}openMessageSenderConnectionsSlider(e={}){const n=new t.Uri("/crm/messagesender/connections/").setQueryParams({analytics:e}).toString();return s.openSlider(n,{width:920,cacheable:false})}}function a(e){var t;return(t=babelHelpers.classPrivateFieldLooseBase(this,o)[o]()[e])!=null?t:null}function u(){return{[BX.CrmEntityType.enumeration.lead]:"/crm/lead/details/#entityId#/",[BX.CrmEntityType.enumeration.deal]:"/crm/deal/details/#entityId#/",[BX.CrmEntityType.enumeration.contact]:"/crm/contact/details/#entityId#/",[BX.CrmEntityType.enumeration.company]:"/crm/company/details/#entityId#/",[BX.CrmEntityType.enumeration.quote]:`/crm/type/${BX.CrmEntityType.enumeration.quote}/details/#entityId#/`,[BX.CrmEntityType.enumeration.smartinvoice]:`/crm/type/${BX.CrmEntityType.enumeration.smartinvoice}/details/#entityId#/`}}e.Router=s})(this.BX.Crm=this.BX.Crm||{},BX,BX.Main);
//# sourceMappingURL=router.bundle.map.js