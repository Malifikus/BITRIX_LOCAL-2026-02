{"version":3,"file":"notification-content.bundle.js","sources":["../src/classes/notification-read-service.js","../src/classes/notification-header-menu.js","../src/classes/notification-menu.js","../src/const/const.js","../src/components/base/additional-text.js","../src/components/base/grid.js","../src/components/base/text.js","../src/components/base/title.js","../src/components/base/changed.js","../src/components/base/users.js","../src/components/elements/quick-answer.js","../src/components/elements/item-confirm-buttons.js","../src/components/elements/item-avatar.js","../src/components/elements/item-actions.js","../src/components/elements/item-reaction.js","../src/components/elements/item-subject.js","../src/components/modules/base/base-header.js","../src/components/base/plain.js","../src/components/modules/base/base-item.js","../src/components/modules/calendar/calendar-item.js","../src/components/modules/crm/crm-item.js","../src/components/modules/task/task-item.js","../src/components/modules/bizproc/bizproc-item.js","../src/components/modules/sonet/sonet.js","../src/components/modules/compatibility/compatibility-header.js","../src/components/modules/compatibility/compatibility-item.js","../src/components/modules/default/default-item.js","../src/components/index.js","../src/components/elements/placeholder.js","../src/components/elements/scroll-button.js","../src/filter/elements/search/value-chip.js","../src/filter/elements/search/values-container.js","../src/filter/elements/search/search-input.js","../src/filter/elements/action-buttons.js","../src/filter/fields/author-field.js","../src/filter/fields/type-field.js","../src/filter/fields/date-field.js","../src/filter/elements/filter-popup.js","../src/filter/notification-filter.js","../src/classes/notification-search-service.js","../src/notification-content.js"],"sourcesContent":["import { Runtime, Type } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { RestMethod, NotificationTypesCodes } from 'im.v2.const';\nimport { Logger } from 'im.v2.lib.logger';\nimport { runAction } from 'im.v2.lib.rest';\n\nexport class NotificationReadService\n{\n\tstore: Object;\n\trestClient: Object;\n\titemsToRead = new Set();\n\treadRequestWithDebounce: Function;\n\treadOnClientWithDebounce: Function;\n\tchangeReadStatusBlockTimeout = {};\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t\tthis.readOnClientWithDebounce = Runtime.debounce(this.readOnClient, 50, this);\n\t\tthis.readRequestWithDebounce = Runtime.debounce(this.readRequest, 500, this);\n\t}\n\n\taddToReadQueue(notificationIds: number[]): void\n\t{\n\t\tif (!Type.isArrayFilled(notificationIds))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnotificationIds.forEach((id: number) => {\n\t\t\tif (!Type.isNumber(id))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst notification = this.store.getters['notifications/getById'](id);\n\t\t\tif (notification.read)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.itemsToRead.add(id);\n\t\t});\n\t}\n\n\tread(): void\n\t{\n\t\tthis.readOnClientWithDebounce();\n\t\tthis.readRequestWithDebounce();\n\t}\n\n\treadRequest(): void\n\t{\n\t\tif (this.itemsToRead.size === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst allNotifications = this.store.getters['notifications/getSortedCollection'];\n\n\t\tconst confirmNotifications = allNotifications.filter((notification) => {\n\t\t\treturn notification.sectionCode === NotificationTypesCodes.confirm;\n\t\t});\n\n\t\tconst confirmNotificationIds = new Set(confirmNotifications.map((notification) => notification.id));\n\n\t\tconst allIdsToRead = [...this.itemsToRead];\n\n\t\tconst notificationsToReadIds = allIdsToRead.filter((id) => {\n\t\t\treturn !confirmNotificationIds.has(id);\n\t\t});\n\n\t\tif (notificationsToReadIds.length === 0)\n\t\t{\n\t\t\tthis.itemsToRead.clear();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst params = {\n\t\t\tids: notificationsToReadIds,\n\t\t};\n\n\t\trunAction(RestMethod.imV2NotifyRead, { data: params })\n\t\t\t.then((response) => {\n\t\t\t\tLogger.warn(`I have read all the notifications, total: ${notificationsToReadIds.length}`, response);\n\t\t\t})\n\t\t\t.catch((result: RestResult) => {\n\t\t\t\tconsole.error('NotificationReadService: readRequest error', result.error());\n\t\t\t});\n\n\t\tthis.itemsToRead.clear();\n\t}\n\n\treadOnClient()\n\t{\n\t\tthis.store.dispatch('notifications/read', { ids: [...this.itemsToRead], read: true });\n\t}\n\n\treadAll(excludeIds: number[] = []): void\n\t{\n\t\tthis.store.dispatch('notifications/readAllSimple', { excludeIds });\n\n\t\tconst params = {\n\t\t\tids: excludeIds,\n\t\t};\n\n\t\trunAction(RestMethod.imV2NotifyReadAll, { data: params })\n\t\t\t.then((response) => {\n\t\t\t\tconst currentCounter = this.store.getters['notifications/getCounter'];\n\t\t\t\tconst newCounter = response.counter;\n\t\t\t\tif (newCounter < currentCounter)\n\t\t\t\t{\n\t\t\t\t\tvoid this.store.dispatch('notifications/setCounter', newCounter);\n\t\t\t\t}\n\n\t\t\t\tLogger.warn(`I have read ALL the notifications, excluded: ${excludeIds.length}`, response);\n\t\t\t})\n\t\t\t.catch((result: RestResult) => {\n\t\t\t\tconsole.error('NotificationReadService: readAll error', result);\n\t\t\t});\n\t}\n\n\tchangeReadStatus(notificationId: number): void\n\t{\n\t\tlet notification = this.store.getters['notifications/getById'](notificationId);\n\t\tlet fromSearchCollection = false;\n\n\t\tif (!notification)\n\t\t{\n\t\t\tnotification = this.store.getters['notifications/getSearchItemById'](notificationId);\n\t\t\tfromSearchCollection = true;\n\t\t}\n\n\t\tif (!notification)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (fromSearchCollection)\n\t\t{\n\t\t\tthis.store.commit('notifications/updateSearchResult', [\n\t\t\t\t{ id: notification.id, fields: { read: !notification.read } },\n\t\t\t]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.store.dispatch('notifications/read', { ids: [notification.id], read: !notification.read });\n\t\t}\n\n\t\tclearTimeout(this.changeReadStatusBlockTimeout[notification.id]);\n\t\tthis.changeReadStatusBlockTimeout[notification.id] = setTimeout(() => {\n\t\t\tthis.restClient.callMethod(RestMethod.imNotifyRead, {\n\t\t\t\tid: notification.id,\n\t\t\t\taction: notification.read ? 'N' : 'Y',\n\t\t\t\tonly_current: 'Y',\n\t\t\t}).then(() => {\n\t\t\t\tLogger.warn(`Notification ${notification.id} unread status set to ${!notification.read}`);\n\t\t\t}).catch((result: RestResult) => {\n\t\t\t\tconsole.error('NotificationReadService: changeReadStatus error', result.error());\n\t\t\t\t// revert?\n\t\t\t});\n\t\t}, 1500);\n\t}\n\n\tdestroy()\n\t{\n\t\tLogger.warn('Notification read service destroyed');\n\t}\n}\n","import { Loc } from 'main.core';\nimport { Menu, MenuItemDesign, type MenuItemOptions } from 'ui.system.menu';\nimport { Messenger } from 'im.public';\nimport { SettingsSection } from 'im.v2.const';\nimport { Core } from 'im.v2.application.core';\nimport { NotificationReadService } from './notification-read-service';\n\nexport class NotificationHeaderMenu\n{\n\tmenu: Menu;\n\tstore: Object;\n\n\tconstructor()\n\t{\n\t\tthis.notificationReadService = new NotificationReadService();\n\t\tthis.store = Core.getStore();\n\t}\n\n\topenMenu(isReadAllAvailable, bindElement): void\n\t{\n\t\tif (this.menu)\n\t\t{\n\t\t\tthis.menu.destroy();\n\t\t\tthis.menu = null;\n\t\t}\n\n\t\tthis.menu = new Menu({\n\t\t\tid: 'im-notifications-header-menu',\n\t\t\titems: this.getHeaderMenuItems(isReadAllAvailable),\n\t\t\tcloseOnItemClick: true,\n\t\t\tautoHide: true,\n\t\t});\n\n\t\tthis.menu.show(bindElement);\n\t}\n\n\tgetHeaderMenuItems(isReadAllAvailable: boolean): MenuItemOptions[]\n\t{\n\t\treturn [\n\t\t\tthis.getOptionsItem(),\n\t\t\tthis.getReadAllItem(isReadAllAvailable),\n\t\t];\n\t}\n\n\tgetReadAllItem(isReadAllAvailable): ?MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_NOTIFICATIONS_READ_ALL_BUTTON'),\n\t\t\tdesign: isReadAllAvailable ? MenuItemDesign.Default : MenuItemDesign.Disabled,\n\t\t\tonClick: () => {\n\t\t\t\tthis.notificationReadService.readAll();\n\t\t\t\tthis.menu.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetOptionsItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_NOTIFICATIONS_OPTIONS_BUTTON'),\n\t\t\tonClick: () => {\n\t\t\t\tvoid Messenger.openSettings({ onlyPanel: SettingsSection.notification });\n\t\t\t\tthis.menu.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tdestroy(): void\n\t{\n\t\tif (this.menu)\n\t\t{\n\t\t\tthis.menu.destroy();\n\t\t\tthis.menu = null;\n\t\t}\n\n\t\tif (this.notificationReadService)\n\t\t{\n\t\t\tthis.notificationReadService.destroy();\n\t\t}\n\t}\n}\n","import { Loc, Event } from 'main.core';\nimport { Menu, type MenuItemOptions } from 'ui.system.menu';\nimport { SettingsService } from 'im.v2.provider.service.settings';\nimport { Settings, type NotificationSettingsItem, NotificationSettingsType } from 'im.v2.const';\nimport { Notifier } from 'im.v2.lib.notifier';\nimport { Analytics } from 'im.v2.lib.analytics';\n\nexport class NotificationMenu\n{\n\tmenu: Menu;\n\tnotificationItem: ?Object;\n\tstore: Object;\n\n\tstatic events = {\n\t\tmarkAsUnreadClick: 'markAsUnreadClick',\n\t};\n\n\tstatic lastMenu: ?Menu = null;\n\tstatic lastMenuId: ?(string | number) = null;\n\n\tstatic closeMenuOnScroll(): void\n\t{\n\t\ttry\n\t\t{\n\t\t\tNotificationMenu.lastMenu?.close();\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error(e);\n\t\t}\n\t\tfinally\n\t\t{\n\t\t\tNotificationMenu.lastMenu = null;\n\t\t\tNotificationMenu.lastMenuId = null;\n\t\t}\n\t}\n\n\tconstructor({ store })\n\t{\n\t\tthis.store = store;\n\t}\n\n\topenMenu(notificationItem, bindElement): void\n\t{\n\t\tif (\n\t\t\tNotificationMenu.lastMenu\n\t\t\t&& NotificationMenu.lastMenuId === notificationItem.id\n\t\t\t&& NotificationMenu.lastMenu.getPopup()?.isShown()\n\t\t)\n\t\t{\n\t\t\tNotificationMenu.lastMenu.close();\n\t\t\tNotificationMenu.lastMenu = null;\n\t\t\tNotificationMenu.lastMenuId = null;\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.menu)\n\t\t{\n\t\t\tthis.menu.destroy();\n\t\t\tthis.menu = null;\n\t\t}\n\n\t\tthis.notificationItem = notificationItem;\n\n\t\tconst items = this.#getMenuItems();\n\t\tif (items.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.menu = new Menu({\n\t\t\tid: `im-notification-menu-${this.notificationItem.id}`,\n\t\t\titems,\n\t\t\tevents: {\n\t\t\t\tonClose: () => {\n\t\t\t\t\tif (NotificationMenu.lastMenu === this.menu)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#onCloseMenu();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonDestroy: () => {\n\t\t\t\t\tif (NotificationMenu.lastMenu === this.menu)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#onCloseMenu();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tthis.menu.show(bindElement);\n\t\tNotificationMenu.lastMenu = this.menu;\n\t\tNotificationMenu.lastMenuId = this.notificationItem.id;\n\t}\n\n\t#onCloseMenu(): void\n\t{\n\t\tNotificationMenu.lastMenu = null;\n\t\tNotificationMenu.lastMenuId = null;\n\t}\n\n\tasync toggleSubscription(): void\n\t{\n\t\tconst currentSettings = this.#getCurrentItemSettings();\n\t\tif (this.#areSubscribedTypesExist())\n\t\t{\n\t\t\tconst typesToRestore = this.#getLastSubscribedTypes();\n\n\t\t\tconst settingsToUnsubscribe = {\n\t\t\t\t...this.#getParsedSettingName(),\n\t\t\t\tlastSubscribedTypes: this.#getLastSubscribedTypes(),\n\t\t\t\tshouldSubscribe: false,\n\t\t\t};\n\t\t\tvoid (new SettingsService()).toggleSubscription(settingsToUnsubscribe);\n\n\t\t\tNotifier.notification.onUnsubscribeComplete(currentSettings.label, (event, balloon) => {\n\t\t\t\tconst settingsToResubscribe = {\n\t\t\t\t\t...this.#getParsedSettingName(),\n\t\t\t\t\tlastSubscribedTypes: typesToRestore,\n\t\t\t\t\tshouldSubscribe: true,\n\t\t\t\t};\n\t\t\t\tvoid (new SettingsService()).toggleSubscription(settingsToResubscribe);\n\t\t\t\tballoon.close();\n\t\t\t});\n\n\t\t\tAnalytics.getInstance().notification.onUnsubscribeFromNotification({\n\t\t\t\tmoduleId: settingsToUnsubscribe.notifyModule,\n\t\t\t\toptionName: settingsToUnsubscribe.notifyEvent,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst settingsToSubscribe = {\n\t\t\t\t...this.#getParsedSettingName(),\n\t\t\t\tlastSubscribedTypes: this.#getLastSubscribedTypes(),\n\t\t\t\tshouldSubscribe: true,\n\t\t\t};\n\t\t\tvoid (new SettingsService()).toggleSubscription(settingsToSubscribe);\n\n\t\t\tNotifier.notification.onSubscribeComplete(currentSettings.label);\n\t\t}\n\t}\n\n\t#getMenuItems(): MenuItemOptions[]\n\t{\n\t\treturn [\n\t\t\tthis.#getUnSubscribeItem(),\n\t\t\tthis.#getMarkAsUnreadItem(),\n\t\t].filter(Boolean);\n\t}\n\n\t#getMarkAsUnreadItem(): ?MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: this.notificationItem.read\n\t\t\t\t? Loc.getMessage('IM_NOTIFICATIONS_ITEM_MENU_MARK_UNREAD')\n\t\t\t\t: Loc.getMessage('IM_NOTIFICATIONS_ITEM_MENU_MARK_READ'),\n\t\t\tonClick: () => {\n\t\t\t\tEvent.EventEmitter.emit(NotificationMenu.events.markAsUnreadClick, this.notificationItem);\n\t\t\t},\n\t\t};\n\t}\n\n\t#getUnSubscribeItem(): ?MenuItemOptions\n\t{\n\t\tif (!this.#shouldShowItem())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: this.#areSubscribedTypesExist()\n\t\t\t\t? Loc.getMessage('IM_NOTIFICATIONS_ITEM_MENU_UNSUBSCRIBE')\n\t\t\t\t: Loc.getMessage('IM_NOTIFICATIONS_ITEM_MENU_SUBSCRIBE'),\n\t\t\tonClick: () => {\n\t\t\t\tthis.toggleSubscription();\n\t\t\t},\n\t\t};\n\t}\n\n\t#getCurrentItemSettings(): ?NotificationSettingsItem\n\t{\n\t\tconst notificationsSettings = this.store.getters['application/settings/get'](Settings.notifications);\n\t\tconst { notifyModule, notifyEvent } = this.#getParsedSettingName();\n\n\t\treturn notificationsSettings[notifyModule]?.items[notifyEvent];\n\t}\n\n\t#getParsedSettingName(): { notifyModule: string; notifyEvent: string; }\n\t{\n\t\tconst { settingName } = this.notificationItem;\n\t\tconst [notifyModule, notifyEvent] = settingName.split('|');\n\n\t\treturn {\n\t\t\tnotifyModule,\n\t\t\tnotifyEvent,\n\t\t};\n\t}\n\n\t#isAtLeastWebEnabled(): boolean\n\t{\n\t\treturn !this.#getCurrentItemSettings().disabled.includes(NotificationSettingsType.web);\n\t}\n\n\t#hasNotificationButtons(): boolean\n\t{\n\t\treturn this.notificationItem.notifyButtons && this.notificationItem.notifyButtons.length > 0;\n\t}\n\n\t#getSubscribedTypes(): Array<string>\n\t{\n\t\tconst settings = this.#getCurrentItemSettings();\n\n\t\treturn this.#getNotificationSettingsTypeValues().filter((type) => {\n\t\t\treturn !settings.disabled.includes(type) && settings[type] === true;\n\t\t});\n\t}\n\n\t#areSubscribedTypesExist(): boolean\n\t{\n\t\treturn this.#getSubscribedTypes().length > 0;\n\t}\n\n\t#getNotificationSettingsTypeValues(): Array<string>\n\t{\n\t\treturn Object.values(NotificationSettingsType);\n\t}\n\n\t#shouldShowItem(): boolean\n\t{\n\t\treturn this.#getCurrentItemSettings() && this.#isAtLeastWebEnabled() && !this.#hasNotificationButtons();\n\t}\n\n\t#getLastSubscribedTypes(): Array<string>\n\t{\n\t\tif (this.#areSubscribedTypesExist())\n\t\t{\n\t\t\treturn this.#getSubscribedTypes();\n\t\t}\n\n\t\tif (this.#isAtLeastWebEnabled())\n\t\t{\n\t\t\treturn [NotificationSettingsType.web];\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tisEmpty(notificationItem): boolean\n\t{\n\t\tconst prevItem = this.notificationItem;\n\t\tthis.notificationItem = notificationItem;\n\t\tconst items = this.#getMenuItems();\n\t\tthis.notificationItem = prevItem;\n\n\t\treturn items.length === 0;\n\t}\n}","export const NotificationType = Object.freeze({\n\tchanged: 'changed',\n\tgrid: 'grid',\n\ttext: 'text',\n\tusers: 'users',\n\ttitle: 'title',\n});\n\nexport const DefaultNotificationIconTitleClass = Object.freeze({\n\tcalendar: '--o-calendar-with-slots',\n\ttask: '--o-task',\n});\n\nexport const CrmNotificationIconTitleClass = Object.freeze({\n\tdefault: '--o-crm',\n\tdeal: '--o-handshake',\n\tlead: '--o-lead',\n\tcontact: '--o-contact',\n\tquote: '--o-file',\n\tcompany: '--o-company',\n\torder: '--o-box',\n\tprocess: '--o-smart-process',\n\tcall: '--o-phone-up',\n\ttask: '--o-complete-task-list',\n\tmeeting: '--o-calendar-with-slots',\n\tmail: '--o-mail',\n\tinvoice: '--o-invoice',\n});\n\nexport const SonetNotificationIconTitleClass = Object.freeze({\n\tnewsfeed: '--o-newsfeed',\n\twiki: '--wiki',\n\tvote: '--o-complete-task-list',\n\tgroup: '--o-three-persons',\n});\n\nexport const BizprocNotificationIconTitleClass = Object.freeze({\n\tbizproc: '--o-business-process',\n\tcustomSection: '--o-activity',\n});\n","import { Parser } from 'im.v2.lib.parser';\n\nimport type { ImModelNotificationParams } from 'im.v2.model';\n\n// @vue/component\nexport const DetailedAdditionalText = {\n\tname: 'DetailedAdditionalText',\n\tprops: {\n\t\tnotificationParams: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tparams(): ImModelNotificationParams\n\t\t{\n\t\t\treturn this.notificationParams;\n\t\t},\n\t\ttext(): string\n\t\t{\n\t\t\tconst text = this.params.entity?.content?.additionalText ?? '';\n\n\t\t\treturn Parser.decodeNotificationParam(text);\n\t\t},\n\t\thasAdditionalText(): boolean\n\t\t{\n\t\t\treturn this.text.length > 0;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"hasAdditionalText\" class=\"bx-im-content-notification-item-content__grid-additional-container\">\n\t\t\t<span v-html=\"text\" class=\"bx-im-content-notification-item-content__grid-additional-text\"/>\n\t\t</div>\n\t`,\n};\n","import { BIcon, Outline as OutlineIcons } from 'ui.icon-set.api.vue';\nimport { NotificationType } from '../../const/const';\nimport { DetailedAdditionalText } from './additional-text';\n\nimport { Utils } from 'im.v2.lib.utils';\nimport type { ImModelNotificationParams, ImModelUser } from 'im.v2.model';\n\nconst gridIconClassesMap = {\n\tdate: OutlineIcons.CALENDAR_WITH_SLOTS,\n\tplace: OutlineIcons.MEETING_POINT,\n\trepeat: OutlineIcons.REPEAT,\n\tuser: OutlineIcons.PERSON,\n\tdefault: OutlineIcons.INFO_CIRCLE,\n};\n\nexport const NotificationGridItemTypeIcon = Object.freeze({\n\tuser: 'user',\n\tplace: 'place',\n\tdate: 'date',\n\trepeat: 'repeat',\n});\n\ntype NotificationGridItemType = {\n\ttitle: string,\n\tvalue: string,\n\ttype: $Values<typeof NotificationGridItemTypeIcon>\n}\n\n// @vue/component\nexport const DetailedGrid = {\n\tname: 'DetailedGrid',\n\tcomponents: { BIcon, DetailedAdditionalText },\n\tprops: {\n\t\tnotificationParams: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tparams(): ImModelNotificationParams\n\t\t{\n\t\t\treturn this.notificationParams;\n\t\t},\n\t\tnotificationType(): ?string\n\t\t{\n\t\t\treturn this.params.entity?.contentType ?? null;\n\t\t},\n\t\tcontent(): Object[]\n\t\t{\n\t\t\treturn this.params.entity.content;\n\t\t},\n\t\tisGridType(): boolean\n\t\t{\n\t\t\treturn this.notificationType === NotificationType.grid;\n\t\t},\n\t\titems(): Array<NotificationGridItemType>\n\t\t{\n\t\t\treturn this.content.items;\n\t\t},\n\t\tformattedItems(): Array<NotificationGridItemType>\n\t\t{\n\t\t\treturn this.items.map((item) => {\n\t\t\t\tif (item.type !== 'user')\n\t\t\t\t{\n\t\t\t\t\treturn item;\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\t...item,\n\t\t\t\t\tuser: this.$store.getters['users/get'](Number(item.value)),\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tgetIconClass(itemType: string): string\n\t\t{\n\t\t\treturn gridIconClassesMap[itemType] || gridIconClassesMap.default;\n\t\t},\n\t\tgetUserImage(item: NotificationGridItemType): Object\n\t\t{\n\t\t\treturn { backgroundImage: `url('${item.user.avatar}')` };\n\t\t},\n\t\tgetItemValue(item: NotificationGridItemType): string\n\t\t{\n\t\t\tif (item.type === 'user' && item.user)\n\t\t\t{\n\t\t\t\treturn item.user.name;\n\t\t\t}\n\n\t\t\treturn item.value;\n\t\t},\n\t\tisUserItem(item: NotificationGridItemType): boolean\n\t\t{\n\t\t\treturn item.type === 'user' && item.user;\n\t\t},\n\t\tisUserHasAvatar(item: NotificationGridItemType): boolean\n\t\t{\n\t\t\treturn item.type === 'user' && item.user.avatar;\n\t\t},\n\t\tgetUserLink(user: ImModelUser): string\n\t\t{\n\t\t\treturn Utils.user.getProfileLink(user.id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"isGridType\" class=\"bx-im-content-notification-item-content__details-block\">\n\t\t\t<template v-for=\"(item, index) in formattedItems\" :key=\"index\">\n\t\t\t\t<div class=\"bx-im-content-notification-item-content__details-name\"> {{ item.title }}</div>\n\t\t\t\t<div class=\"bx-im-content-notification-item-content__details-value\">\n\t\t\t\t\t<template v-if=\"isUserHasAvatar(item)\">\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"bx-im-content-notification-item-content__details-icon ui-icon-set --user\"\n\t\t\t\t\t\t\t:style=\"getUserImage(item)\"\n\t\t\t\t\t\t></span>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\tv-if=\"getIconClass(item.type)\"\n\t\t\t\t\t\t\tclass=\"bx-im-content-notification-item-content__details-icon\"\n\t\t\t\t\t\t\t:name=\"getIconClass(item.type)\"\n\t\t\t\t\t\t\t:size=\"16\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-if=\"isUserItem(item)\">\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t:href=\"getUserLink(item.user)\"\n\t\t\t\t\t\t\tclass=\"bx-im-content-notification-item-content__details-text\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ getItemValue(item) }}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"bx-im-content-notification-item-content__details-text\"\n\t\t\t\t\t\t\t:title=\"getItemValue(item)\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ getItemValue(item) }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t\t<DetailedAdditionalText :notificationParams=\"notificationParams\"/>\n\t`,\n};\n","import { NotificationType } from '../../const/const';\nimport { Parser } from 'im.v2.lib.parser';\n\nimport type { ImModelNotificationParams } from 'im.v2.model';\n\n// @vue/component\nexport const DetailedText = {\n\tname: 'DetailedText',\n\tprops: {\n\t\tnotificationParams: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tparams(): ImModelNotificationParams\n\t\t{\n\t\t\treturn this.notificationParams;\n\t\t},\n\t\tnotificationType(): ?string\n\t\t{\n\t\t\treturn this.params.entity.contentType ?? null;\n\t\t},\n\t\tcontent(): { value: string }\n\t\t{\n\t\t\treturn this.params.entity.content;\n\t\t},\n\t\tisTextType(): boolean\n\t\t{\n\t\t\treturn this.notificationType === NotificationType.text;\n\t\t},\n\t\tvalueText(): string\n\t\t{\n\t\t\treturn Parser.decodeNotificationParam(this.content?.value || '');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"isTextType\" class=\"bx-im-content-notification-item-content__details-item\">\n\t\t\t<span v-html=\"valueText\" class=\"bx-im-content-notification-item-content__details-text --line-clamp-3\"/>\n\t\t</div>\n\t`,\n};\n","import type { ImModelNotificationParams } from 'im.v2.model';\n\n// @vue/component\nexport const DetailedTitle = {\n\tname: 'DetailedTitle',\n\tprops: {\n\t\tnotificationParams: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\ticon: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tcolor: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed: {\n\t\tparams(): ImModelNotificationParams\n\t\t{\n\t\t\treturn this.notificationParams;\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.params.entity.title || '';\n\t\t},\n\t\thref(): string\n\t\t{\n\t\t\treturn this.params.entity.href || '';\n\t\t},\n\t\tshowDetailedTitle(): boolean\n\t\t{\n\t\t\treturn this.title !== '';\n\t\t},\n\t\thasHref(): boolean\n\t\t{\n\t\t\treturn Boolean(this.href);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"showDetailedTitle\" class=\"bx-im-content-notification-item-content__details-header\">\n\t\t\t<span\n\t\t\t\tclass=\"ui-icon-set\"\n\t\t\t\t:class=\"icon\"\n\t\t\t\t:style=\"color ? { '--ui-icon-set__icon-color': color } : {}\"\n\t\t\t></span>\n\t\t\t<a\n\t\t\t\tv-if=\"hasHref\"\n\t\t\t\t:href=\"href\"\n\t\t\t\tclass=\"bx-im-content-notification-item-content__details-title --line-clamp-2\"\n\t\t\t>{{ title }}</a>\n\t\t\t<span\n\t\t\t\tv-else\n\t\t\t\tclass=\"bx-im-content-notification-item-content__details-title --line-clamp-2\"\n\t\t\t>{{ title }}</span>\n\t\t</div>\n\t`,\n};\n","import { NotificationType } from '../../const/const';\n\nimport type { ImModelNotificationParams } from 'im.v2.model';\n\n// @vue/component\nexport const DetailedChangedValue = {\n\tname: 'DetailedChangedValue',\n\tprops: {\n\t\tnotificationParams: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tparams(): ImModelNotificationParams\n\t\t{\n\t\t\treturn this.notificationParams;\n\t\t},\n\t\tnotificationType(): ?string\n\t\t{\n\t\t\treturn this.params.entity.contentType ?? null;\n\t\t},\n\t\tcontent(): { prev: string, next: string }\n\t\t{\n\t\t\treturn this.params.entity.content;\n\t\t},\n\t\tisChangedType(): boolean\n\t\t{\n\t\t\treturn this.notificationType === NotificationType.changed;\n\t\t},\n\t\tprevValue(): string\n\t\t{\n\t\t\treturn this.content.prev;\n\t\t},\n\t\tnextValue(): string\n\t\t{\n\t\t\treturn this.content.next;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"isChangedType\" class=\"bx-im-content-notification-item-content__details-item --changed\">\n\t\t\t<div class=\"bx-im-content-notification-item-content__details-content --prev\">\n\t\t\t\t<span>\n\t\t\t\t\t{{ prevValue }}\n\t\t\t\t\t<span class=\"bx-im-content-notification-item-content__details-arrow ui-icon-set --arrow-right-m\"></span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-content-notification-item-content__details-content\">{{ nextValue }}</div>\n\t\t</div>\n\t`,\n};\n","import { Dom, Text } from 'main.core';\nimport { Utils } from 'im.v2.lib.utils';\nimport { NotificationType } from '../../const/const';\n\nimport type { ImModelNotificationParams, ImModelUser } from 'im.v2.model';\n\nconst MAX_USERS_TO_DISPLAY = 2;\n\n// @vue/component\nexport const DetailedUsers = {\n\tname: 'DetailedUsers',\n\tprops: {\n\t\tnotificationParams: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tparams(): ImModelNotificationParams\n\t\t{\n\t\t\treturn this.notificationParams;\n\t\t},\n\t\tnotificationType(): ?string\n\t\t{\n\t\t\treturn this.params.entity.contentType ?? null;\n\t\t},\n\t\tcontent(): { ids: number[], text: string }\n\t\t{\n\t\t\treturn this.params.entity.content;\n\t\t},\n\t\tisUsersType(): boolean\n\t\t{\n\t\t\treturn this.notificationType === NotificationType.users;\n\t\t},\n\t\ttext(): string\n\t\t{\n\t\t\treturn this.content.text;\n\t\t},\n\t\tallUserIds(): string[]\n\t\t{\n\t\t\treturn this.content.ids;\n\t\t},\n\t\tusersToDisplay(): ImModelUser[]\n\t\t{\n\t\t\tconst users = this.allUserIds.slice(0, MAX_USERS_TO_DISPLAY);\n\n\t\t\treturn users.map((id) => this.$store.getters['users/get'](id));\n\t\t},\n\t\tremainingCount(): number\n\t\t{\n\t\t\treturn this.allUserIds.length - MAX_USERS_TO_DISPLAY;\n\t\t},\n\t\tformattedText(): string\n\t\t{\n\t\t\tlet result = this.text.replace('#USER_LIST#', (): string => {\n\t\t\t\treturn this.usersToDisplay\n\t\t\t\t\t.map((user) => this.getUserLink(user))\n\t\t\t\t\t.join(', ');\n\t\t\t});\n\n\t\t\tif (this.link)\n\t\t\t{\n\t\t\t\tresult = result\n\t\t\t\t\t.replace('[link]', `<a href=\"${this.link}\" class=\"bx-im-content-notification-item-content__details-link\" target=\"_self\">`)\n\t\t\t\t\t.replace('#COUNT#', this.remainingCount)\n\t\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t\t;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult = result.replace('#COUNT#', this.remainingCount);\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tlink(): ?string\n\t\t{\n\t\t\treturn this.params.entity.href ?? null;\n\t\t},\n\t},\n\tmethods: {\n\t\tgetUserLink(user: ImModelUser): string\n\t\t{\n\t\t\tconst userHref = Utils.user.getProfileLink(user.id);\n\t\t\tconst name = Text.encode(user.name);\n\n\t\t\treturn Dom.create({\n\t\t\t\ttag: 'a',\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'bx-im-content-notification-item-content__details-link',\n\t\t\t\t\thref: userHref,\n\t\t\t\t\ttarget: '_self',\n\t\t\t\t},\n\t\t\t\ttext: name,\n\t\t\t}).outerHTML;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"isUsersType\"\n\t\t\tclass=\"bx-im-content-notification-item-content__details-users\"\n\t\t\tv-html=\"formattedText\"\n\t\t>\n\t\t</div>\n\t`,\n};\n","import { Button as UiButton, AirButtonStyle, ButtonColor, ButtonSize } from 'ui.vue3.components.button';\n\nimport './css/quick-answer.css';\n\n// @vue/component\nexport const QuickAnswer = {\n\tname: 'QuickAnswer',\n\tcomponents: { UiButton },\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['sendQuickAnswer'],\n\tdata()\n\t{\n\t\treturn {\n\t\t\tquickAnswerText: '',\n\t\t\tquickAnswerResultMessage: '',\n\t\t\tshowQuickAnswer: false,\n\t\t\tisSending: false,\n\t\t\tsuccessSentQuickAnswer: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tAirButtonStyle: () => AirButtonStyle,\n\t},\n\tmethods:\n\t{\n\t\ttoggleQuickAnswer()\n\t\t{\n\t\t\tif (this.successSentQuickAnswer)\n\t\t\t{\n\t\t\t\tthis.showQuickAnswer = true;\n\t\t\t\tthis.successSentQuickAnswer = false;\n\t\t\t\tthis.quickAnswerResultMessage = '';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showQuickAnswer = !this.showQuickAnswer;\n\t\t\t}\n\n\t\t\tif (this.showQuickAnswer)\n\t\t\t{\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.$refs['textarea'].focus();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tsendQuickAnswer()\n\t\t{\n\t\t\tif (this.isSending || this.quickAnswerText.trim() === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isSending = true;\n\n\t\t\tthis.$emit('sendQuickAnswer', {\n\t\t\t\tid: this.notification.id,\n\t\t\t\ttext: this.quickAnswerText.trim(),\n\t\t\t\tcallbackSuccess: (response) => {\n\t\t\t\t\tconst {result_message: resultMessage} = response.data();\n\t\t\t\t\tconst [message] = resultMessage;\n\t\t\t\t\tthis.quickAnswerResultMessage = message;\n\t\t\t\t\tthis.successSentQuickAnswer = true;\n\t\t\t\t\tthis.quickAnswerText = '';\n\t\t\t\t\tthis.isSending = false;\n\t\t\t\t},\n\t\t\t\tcallbackError: () => {\n\t\t\t\t\tthis.isSending = false;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-notification-quick-answer__container\">\n\t\t\t<UiButton\n\t\t\t\tv-if=\"!showQuickAnswer\"\n\t\t\t\t:size=\"ButtonSize.SMALL\"\n\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_QUICK_ANSWER_BUTTON')\"\n\t\t\t\t:loading=\"isSending\"\n\t\t\t\tclass=\"--air\"\n\t\t\t\t:style=\"AirButtonStyle.OUTLINE_NO_ACCENT\"\n\t\t\t\t@click=\"toggleQuickAnswer\" \n\t\t\t\t@dblclick.stop\n\t\t\t>\n\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_NOTIFICATIONS_QUICK_ANSWER_BUTTON') }}\n\t\t\t</UiButton>\n\t\t\t<transition name=\"quick-answer-slide\">\n\t\t\t\t<div \n\t\t\t\t\tv-if=\"showQuickAnswer && !successSentQuickAnswer\" \n\t\t\t\t\tclass=\"bx-im-content-notification-quick-answer__textarea-container\"\n\t\t\t\t>\n\t\t\t\t\t<textarea\n\t\t\t\t\t\tref=\"textarea\"\n\t\t\t\t\t\tautofocus\n\t\t\t\t\t\tclass=\"bx-im-content-notification-quick-answer__textarea\"\n\t\t\t\t\t\tv-model=\"quickAnswerText\"\n\t\t\t\t\t\t:disabled=\"isSending\"\n\t\t\t\t\t\t@keydown.enter.prevent\n\t\t\t\t\t\t@keyup.enter.prevent=\"sendQuickAnswer\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div \n\t\t\t\t\t\tv-if=\"!successSentQuickAnswer\" \n\t\t\t\t\t\tclass=\"bx-im-content-notification-quick-answer__buttons-container\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<UiButton\n\t\t\t\t\t\t\t:size=\"ButtonSize.SMALL\"\n\t\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_QUICK_ANSWER_SEND')\"\n\t\t\t\t\t\t\t:isLoading=\"isSending\"\n\t\t\t\t\t\t\tclass=\"--air\"\n\t\t\t\t\t\t\t:style=\"AirButtonStyle.FILLED\"\n\t\t\t\t\t\t\t@click=\"sendQuickAnswer\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<UiButton\n\t\t\t\t\t\t\t:size=\"ButtonSize.SMALL\"\n\t\t\t\t\t\t\tclass=\"--air\"\n\t\t\t\t\t\t\t:style=\"AirButtonStyle.OUTLINE_NO_ACCENT\"\n\t\t\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_QUICK_ANSWER_CANCEL')\"\n\t\t\t\t\t\t\t:isDisabled=\"isSending\"\n\t\t\t\t\t\t\t@click=\"toggleQuickAnswer\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t\t<div v-if=\"successSentQuickAnswer\" class=\"bx-im-content-notification-quick-answer__result\">\n\t\t\t\t<div class=\"bx-im-content-notification-quick-answer__success-icon\"></div>\n\t\t\t\t<div class=\"bx-im-content-notification-quick-answer__success-text\">{{ quickAnswerResultMessage }}</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Text } from 'main.core';\nimport { Button as UiButton, AirButtonStyle, ButtonColor, ButtonSize } from 'ui.vue3.components.button';\n\nimport './css/item-confirm-buttons.css';\n\n// @vue/component\nexport const ItemConfirmButtons = {\n\tname: 'ItemConfirmButtons',\n\tcomponents: { UiButton },\n\tprops: {\n\t\tbuttons: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['confirmButtonsClick'],\n\tcomputed: {\n\t\tButtonSize: () => ButtonSize,\n\t\tButtonColor: () => ButtonColor,\n\t\tpreparedButtons(): Array\n\t\t{\n\t\t\treturn this.buttons.map((button) => {\n\t\t\t\tconst [id, value] = button.COMMAND_PARAMS.split('|');\n\n\t\t\t\t// we need to decode it, because legacy chat does htmlspecialcharsbx on the server side\n\t\t\t\t// @see \\CIMMessenger::Add\n\t\t\t\tconst text = Text.decode(button.TEXT);\n\n\t\t\t\treturn { id, value, text };\n\t\t\t});\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tclick(button)\n\t\t{\n\t\t\tthis.$emit('confirmButtonsClick', button);\n\t\t},\n\t\tgetButtonStyle(button): string\n\t\t{\n\t\t\treturn button.value === 'Y' ? AirButtonStyle.FILLED : AirButtonStyle.OUTLINE_NO_ACCENT;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-notification-item-confirm-buttons__container\">\n\t\t\t<UiButton\n\t\t\t\tv-for=\"(button, index) in preparedButtons\" :key=\"index\"\n\t\t\t\t:text=\"button.text\"\n\t\t\t\tclass=\"--air\"\n\t\t\t\t:style=\"getButtonStyle(button)\"\n\t\t\t\t:size=\"ButtonSize.SMALL\"\n\t\t\t\t@click=\"click(button)\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { ChatAvatar, AvatarSize } from 'im.v2.component.elements.avatar';\nimport { Type } from 'main.core';\n\nimport './css/item-avatar.css';\n\nimport type { ImModelUser } from 'im.v2.model';\n\nconst NotificationSystemIconClasses = Object.freeze({\n\tdefault: '--default',\n\tbiconector: '--bi-constructor',\n\tapp: '--app',\n\tbizproc: '--bizproc',\n\tnewsfeed: '--newsfeed',\n\tgroup: '--group',\n\tflow: '--flow',\n\tsign: '--sign',\n\tvideoConf: '--video-conf',\n\topenLines: '--open-lines',\n\tvoximplant: '--voximplant',\n\tbooking: '--booking',\n\tcalendar: '--calendar',\n\tb24: '--b24',\n\tmail: '--mail',\n\ttariff: '--license',\n\tdisk: '--disk',\n\tcrm: '--crm',\n\tcompany: '--company',\n\tcontact: '--contact',\n\tdeal: '--deal',\n\tlead: '--lead',\n\tquote: '--quote',\n\torder: '--order',\n\tsmartProcess: '--smart-process',\n\ttimeline: '--timeline',\n\tinvoice: '--invoice',\n});\n\nconst NotificationIconModuleClasses = Object.freeze({\n\tbiconector: NotificationSystemIconClasses.biconector,\n\tbizproc: NotificationSystemIconClasses.bizproc,\n\tblog: NotificationSystemIconClasses.newsfeed,\n\tsocialnetwork: NotificationSystemIconClasses.group,\n\tsign: NotificationSystemIconClasses.sign,\n\timconnector: NotificationSystemIconClasses.openLines,\n\timopenlines: NotificationSystemIconClasses.openLines,\n\tvoximplant: NotificationSystemIconClasses.voximplant,\n\tvoximplantcontroller: NotificationSystemIconClasses.voximplant,\n\tbooking: NotificationSystemIconClasses.booking,\n\tcalendar: NotificationSystemIconClasses.calendar,\n\tintranet: NotificationSystemIconClasses.b24,\n\tsender: NotificationSystemIconClasses.mail,\n\tmail: NotificationSystemIconClasses.mail,\n\tbitrix24: NotificationSystemIconClasses.tariff,\n\tdisk: NotificationSystemIconClasses.disk,\n\tcrm: NotificationSystemIconClasses.crm,\n});\n\n// @vue/component\nexport const ItemAvatar = {\n\tname: 'ItemAvatar',\n\tcomponents: { ChatAvatar },\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tAvatarSize: () => AvatarSize,\n\t\tisSystem(): boolean\n\t\t{\n\t\t\treturn this.userId === 0;\n\t\t},\n\t\tuserId(): string\n\t\t{\n\t\t\treturn this.notification.authorId;\n\t\t},\n\t\tuserDialogId(): string\n\t\t{\n\t\t\treturn this.userId.toString();\n\t\t},\n\t\tuser(): ?ImModelUser\n\t\t{\n\t\t\t// For now, we don't have a user if it is an OL user.\n\t\t\treturn this.$store.getters['users/get'](this.userId);\n\t\t},\n\t\tsystemIconClass(): string\n\t\t{\n\t\t\tconst systemIcon = this.notification.params?.componentParams?.systemIcon;\n\t\t\tif (Type.isStringFilled(systemIcon))\n\t\t\t{\n\t\t\t\treturn NotificationSystemIconClasses[systemIcon] || NotificationSystemIconClasses.default;\n\t\t\t}\n\n\t\t\tlet moduleId = this.notification.moduleId;\n\t\t\tif (!moduleId) // check push, because in push moduleId is empty, but settingName is filled\n\t\t\t{\n\t\t\t\tconst settingName = this.notification.settingName ?? '';\n\t\t\t\tmoduleId = settingName.split('|')[0].trim();\n\t\t\t}\n\n\t\t\treturn NotificationIconModuleClasses[moduleId] || NotificationSystemIconClasses.default;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-notification-item-avatar__container\">\n\t\t\t<div \n\t\t\t\tv-if=\"isSystem || !user\"\n\t\t\t\tclass=\"bx-im-content-notification-item-avatar__system-icon\"\n\t\t\t\t:class=\"systemIconClass\"\n\t\t\t></div>\n\t\t\t<ChatAvatar \n\t\t\t\tv-else \n\t\t\t\t:avatarDialogId=\"userDialogId\" \n\t\t\t\t:contextDialogId=\"userDialogId\" \n\t\t\t\t:size=\"AvatarSize.M\" \n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { NotificationMenu } from '../../classes/notification-menu';\n\nimport './css/item-actions.css';\n\nimport type { ImModelNotification } from 'im.v2.model';\n\n// @vue/component\nexport const ItemActions = {\n\tname: 'ItemActions',\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcanDelete: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tnotificationItem(): ImModelNotification\n\t\t{\n\t\t\treturn this.notification;\n\t\t},\n\t\tareActionsAvailable(): boolean\n\t\t{\n\t\t\treturn this.notificationItem.notifyButtons.length === 0;\n\t\t},\n\t\tisMenuEmpty(): boolean\n\t\t{\n\t\t\tif (!this.notificationMenu)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn this.notificationMenu.isEmpty(this.notificationItem);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.notificationMenu = new NotificationMenu({\n\t\t\tstore: this.$store,\n\t\t});\n\t},\n\tmethods: {\n\t\tonDeleteClick(): void\n\t\t{\n\t\t\tthis.$emit('deleteClick');\n\t\t},\n\t\tonMenuButtonClick(event): void\n\t\t{\n\t\t\tthis.notificationMenu.openMenu(this.notificationItem, event.currentTarget);\n\t\t},\n\t\tonMenuClose(): void\n\t\t{\n\t\t\tthis.isMenuShown = false;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"areActionsAvailable\" class=\"bx-im-content-notification-item__actions\">\n\t\t\t<div\n\t\t\t\tv-if=\"!isMenuEmpty\"\n\t\t\t\tclass=\"bx-im-content-notification-item__actions-more-button\" \n\t\t\t\t@click=\"onMenuButtonClick\" \n\t\t\t>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"canDelete\"\n\t\t\t\tclass=\"bx-im-content-notification-item__actions-delete-button\"\n\t\t\t\t@click=\"onDeleteClick\"\n\t\t\t>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { reactionCssClass as ReactionIconClass } from 'ui.reactions-select';\n\nimport type { ImModelNotification } from 'im.v2.model';\n\n// @vue/component\nexport const ItemReaction = {\n\tname: 'ItemReaction',\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tnotificationItem(): ImModelNotification\n\t\t{\n\t\t\treturn this.notification;\n\t\t},\n\t\ttype(): string\n\t\t{\n\t\t\treturn this.notificationItem.params.componentParams.entity.reaction;\n\t\t},\n\t\treactionClass(): string\n\t\t{\n\t\t\treturn ReactionIconClass[this.type];\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-notification-item-content__reaction\" :class=\"reactionClass\"></div>\n\t`,\n};\n","import { ChatTitle } from 'im.v2.component.elements.chat-title';\nimport { UserType } from 'im.v2.const';\nimport { Parser } from 'im.v2.lib.parser';\n\nimport type { ImModelUser } from 'im.v2.model';\n\nconst AUTHOR_PLACEHOLDER = '#AUTHOR#';\n\n// @vue/component\nexport const ItemSubject = {\n\tname: 'ItemSubject',\n\tcomponents: { ChatTitle },\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['userClick'],\n\tcomputed: {\n\t\tauthor(): ImModelUser\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.notification.authorId, true);\n\t\t},\n\t\tauthorDialogId(): string\n\t\t{\n\t\t\treturn this.notification.authorId.toString();\n\t\t},\n\t\ttitleClasses(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'bx-im-content-notification-item-header__title-text': true,\n\t\t\t\t'bx-im-content-notification-item-header__title-user-text': true,\n\t\t\t\t'--extranet': this.author.type === UserType.extranet,\n\t\t\t};\n\t\t},\n\t\tsubjectText(): string\n\t\t{\n\t\t\treturn Parser.decodeNotificationParam(this.notification.params.componentParams?.subject ?? '');\n\t\t},\n\t\tparsedSubject(): { before: string, after: string }\n\t\t{\n\t\t\tlet subject = this.subjectText;\n\t\t\tif (this.subjectText.includes('#USER_COUNT#'))\n\t\t\t{\n\t\t\t\tsubject = this.subjectText.replace('#USER_COUNT#', this.notification.params.users.length);\n\t\t\t}\n\n\t\t\tconst parts = subject.split(AUTHOR_PLACEHOLDER);\n\n\t\t\treturn {\n\t\t\t\tbefore: parts[0],\n\t\t\t\tafter: parts[1],\n\t\t\t};\n\t\t},\n\t\tbeforeText(): string\n\t\t{\n\t\t\treturn this.parsedSubject.before;\n\t\t},\n\t\tafterText(): string\n\t\t{\n\t\t\treturn this.parsedSubject.after;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-notification-item-header__subject\">\n\t\t\t<span\n\t\t\t\tv-html=\"beforeText\"\n\t\t\t\tclass=\"bx-im-content-notification-item-header__subject-text\"\n\t\t\t/>\n\t\t\t<ChatTitle\n\t\t\t\t:dialogId=\"authorDialogId\"\n\t\t\t\t:showItsYou=\"false\"\n\t\t\t\t:class=\"titleClasses\"\n\t\t\t\t@click.prevent=\"$emit('userClick')\"\n\t\t\t/>\n\t\t\t<slot></slot>\n\t\t\t<span\n\t\t\t\tv-html=\"afterText\"\n\t\t\t\tclass=\"bx-im-content-notification-item-header__subject-text\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Messenger } from 'im.public';\nimport { ChatTitle } from 'im.v2.component.elements.chat-title';\nimport { ItemSubject } from '../../elements/item-subject';\n\nimport '../../elements/css/item-header.css';\n\nimport type { ImModelUser, ImModelNotification } from 'im.v2.model';\n\n// @vue/component\nexport const BaseNotificationItemHeader = {\n\tname: 'BaseNotificationItemHeader',\n\tcomponents: {\n\t\tChatTitle,\n\t\tItemSubject,\n\t},\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['moreUsersClick'],\n\tcomputed: {\n\t\tnotificationItem(): ImModelNotification\n\t\t{\n\t\t\treturn this.notification;\n\t\t},\n\t\tuser(): ImModelUser\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.notificationItem.authorId, true);\n\t\t},\n\t\tisSystem(): boolean\n\t\t{\n\t\t\treturn this.notification.authorId === 0;\n\t\t},\n\t\tuserDialogId(): string\n\t\t{\n\t\t\treturn this.notification.authorId.toString();\n\t\t},\n\t\thasMoreUsers(): boolean\n\t\t{\n\t\t\tif (this.isSystem)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn Boolean(this.notificationItem.params?.users) && this.notificationItem.params.users.length > 0;\n\t\t},\n\t\tmoreUsers(): { start: string, end: string }\n\t\t{\n\t\t\tconst phrase = this.$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_MORE_USERS').split('#COUNT#');\n\n\t\t\treturn {\n\t\t\t\tstart: phrase[0],\n\t\t\t\tend: this.notificationItem.params.users.length + phrase[1],\n\t\t\t};\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonUserTitleClick()\n\t\t{\n\t\t\tif (this.isSystem)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tMessenger.openChat(this.userDialogId);\n\t\t},\n\t\tonMoreUsersClick(event)\n\t\t{\n\t\t\tif (event.users)\n\t\t\t{\n\t\t\t\tthis.$emit('moreUsersClick', {\n\t\t\t\t\tevent: event.event,\n\t\t\t\t\tusers: event.users,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-notification-item-header__container\">\n\t\t\t<div class=\"bx-im-content-notification-item-header__title-container\">\n\t\t\t\t<ItemSubject\n\t\t\t\t\t:notification=\"notification\"\n\t\t\t\t\t@userClick=\"onUserTitleClick\"\n\t\t\t\t>\n\t\t\t\t\t<span v-if=\"hasMoreUsers\" class=\"bx-im-content-notification-item-header__more-users\">\n\t\t\t\t\t\t<span class=\"bx-im-content-notification-item-header__more-users-start\">{{ moreUsers.start }}</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"bx-im-content-notification-item-header__more-users-dropdown\"\n\t\t\t\t\t\t\t@click=\"onMoreUsersClick({users: notificationItem.params.users, event: $event})\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ moreUsers.end }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>\n\t\t\t\t</ItemSubject>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import type { ImModelNotificationParams } from 'im.v2.model';\nimport { Parser } from 'im.v2.lib.parser';\n\n// @vue/component\nexport const PlainText = {\n\tname: 'PlainText',\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tparams(): ImModelNotificationParams\n\t\t{\n\t\t\treturn this.notification?.params?.componentParams ?? {};\n\t\t},\n\t\thasPlainText(): boolean\n\t\t{\n\t\t\treturn this.text.length > 0;\n\t\t},\n\t\ttext(): string\n\t\t{\n\t\t\tconst text = this.params?.plainText || '';\n\n\t\t\treturn Parser.decodeNotificationParam(text);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"hasPlainText\" class=\"bx-im-content-notification-item-content__plain\">\n\t\t\t<span v-html=\"text\" class=\"bx-im-content-notification-item-content__plain-text\"/>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { NotificationTypesCodes } from 'im.v2.const';\nimport { Attach } from 'im.v2.component.elements.attach';\nimport { Parser } from 'im.v2.lib.parser';\nimport { DateFormatter, DateTemplate } from 'im.v2.lib.date-formatter';\n\nimport { QuickAnswer } from '../../elements/quick-answer';\nimport { ItemConfirmButtons } from '../../elements/item-confirm-buttons';\nimport { ItemAvatar } from '../../elements/item-avatar';\nimport { ItemActions } from '../../elements/item-actions';\nimport { ItemReaction } from '../../elements/item-reaction';\nimport { NotificationMenu } from '../../../classes/notification-menu';\nimport { BaseNotificationItemHeader } from './base-header';\nimport { NotificationReadService } from '../../../classes/notification-read-service';\nimport { PlainText } from '../../base/plain';\n\nimport type { ImModelNotification, ImModelUser, ImModelNotificationParams } from 'im.v2.model';\n\nimport '../../elements/css/item.css';\n\n// @vue/component\nexport const BaseNotificationItem = {\n\tname: 'BaseNotificationItem',\n\tcomponents: {\n\t\tItemAvatar,\n\t\tQuickAnswer,\n\t\tPlainText,\n\t\tItemConfirmButtons,\n\t\tItemActions,\n\t\tItemReaction,\n\t\tAttach,\n\t\tBaseNotificationItemHeader,\n\t},\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: [\n\t\t'buttonsClick',\n\t\t'confirmButtonsClick',\n\t\t'deleteClick',\n\t\t'sendQuickAnswer',\n\t\t'moreUsersClick',\n\t],\n\tcomputed: {\n\t\tNotificationTypesCodes: () => NotificationTypesCodes,\n\t\tnotificationItem(): ImModelNotification\n\t\t{\n\t\t\treturn this.notification;\n\t\t},\n\t\tparams(): Object\n\t\t{\n\t\t\treturn this.notificationItem.params;\n\t\t},\n\t\tcomponentParams(): ?ImModelNotificationParams\n\t\t{\n\t\t\treturn this.notificationItem?.params?.componentParams;\n\t\t},\n\t\tentity(): ?Object\n\t\t{\n\t\t\treturn this.componentParams?.entity;\n\t\t},\n\t\ttype(): number\n\t\t{\n\t\t\treturn this.notification.sectionCode;\n\t\t},\n\t\tisUnread(): boolean\n\t\t{\n\t\t\treturn !this.notificationItem.read;\n\t\t},\n\t\tuserData(): ImModelUser\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.notificationItem.authorId, true);\n\t\t},\n\t\tdate(): Date\n\t\t{\n\t\t\treturn this.notificationItem.date;\n\t\t},\n\t\thasQuickAnswer(): boolean\n\t\t{\n\t\t\treturn Boolean(this.params?.canAnswer === 'Y');\n\t\t},\n\t\thasReaction(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.entity?.reaction);\n\t\t},\n\t\tattachList(): ?Array\n\t\t{\n\t\t\treturn this.params?.attach;\n\t\t},\n\t\titemDate(): string\n\t\t{\n\t\t\treturn DateFormatter.formatByTemplate(this.date, DateTemplate.notification);\n\t\t},\n\t\tcanDelete(): boolean\n\t\t{\n\t\t\treturn this.notificationItem.sectionCode === NotificationTypesCodes.simple;\n\t\t},\n\t\tshowDetailedBlock(): boolean\n\t\t{\n\t\t\tconst type = this.entity?.contentType;\n\n\t\t\treturn Boolean(type);\n\t\t},\n\t\tisSubjectOnly(): boolean\n\t\t{\n\t\t\treturn this.params?.componentParams?.subject\n\t\t\t\t&& !this.params?.componentParams?.plainText\n\t\t\t\t&& !this.entity\n\t\t\t;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.notificationReadService = new NotificationReadService();\n\t\tEventEmitter.subscribe(\n\t\t\tNotificationMenu.events.markAsUnreadClick,\n\t\t\tthis.markAsUnreadClick,\n\t\t);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.notificationReadService.destroy();\n\t\tEventEmitter.unsubscribe(\n\t\t\tNotificationMenu.events.markAsUnreadClick,\n\t\t\tthis.markAsUnreadClick,\n\t\t);\n\t},\n\tmethods: {\n\t\tmarkAsUnreadClick(event)\n\t\t{\n\t\t\tconst notificationFromEvent: ImModelNotification = event.getData();\n\n\t\t\tif (this.notificationItem.id === notificationFromEvent.id)\n\t\t\t{\n\t\t\t\tthis.notificationReadService.changeReadStatus(this.notificationItem.id);\n\t\t\t}\n\t\t},\n\t\tonConfirmButtonsClick(event): void\n\t\t{\n\t\t\tthis.$emit('confirmButtonsClick', event);\n\t\t},\n\t\tonSendQuickAnswer(event): void\n\t\t{\n\t\t\tthis.$emit('sendQuickAnswer', event);\n\t\t},\n\t\tonDeleteClick(): void\n\t\t{\n\t\t\tthis.$emit('deleteClick', this.notificationItem.id);\n\t\t},\n\t\tonUnsubscribeClick(): void\n\t\t{\n\t\t\tthis.$emit('unsubscribeClick', this.notificationItem.id);\n\t\t},\n\t\tonContentClick(event): void\n\t\t{\n\t\t\tParser.executeClickEvent(event, { emitter: this.getEmitter() });\n\t\t},\n\t\tonMoreUsersClick(event): void\n\t\t{\n\t\t\tthis.$emit('moreUsersClick', event);\n\t\t},\n\t\tgetEmitter(): EventEmitter\n\t\t{\n\t\t\treturn this.$Bitrix.eventEmitter;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"bx-im-content-notification-item__container\"\n\t\t\t:class=\"{'--unread': isUnread}\"\n\t\t\t:data-test-id=\"'im-content-notification-item-container-' + notificationItem.id\"\n\t\t>\n\t\t\t<ItemAvatar :notification=\"notificationItem\"/>\n\t\t\t<div class=\"bx-im-content-notification-item__content-container\" :class=\"{ '--subject-only': isSubjectOnly }\">\n\t\t\t\t<slot name=\"header\">\n\t\t\t\t\t<BaseNotificationItemHeader\n\t\t\t\t\t\t:notification=\"notificationItem\"\n\t\t\t\t\t\t@moreUsersClick=\"onMoreUsersClick\"\n\t\t\t\t\t/>\n\t\t\t\t</slot>\n\t\t\t\t<ItemActions\n\t\t\t\t\t:canDelete=\"canDelete\"\n\t\t\t\t\t:notification=\"notificationItem\"\n\t\t\t\t\t@deleteClick=\"onDeleteClick\"\n\t\t\t\t\t@unsubscribeClick=\"onUnsubscribeClick\"\n\t\t\t\t\t@markAsUnreadClick=\"markAsUnreadClick\"\n\t\t\t\t/>\n\t\t\t\t<PlainText :notification=\"notificationItem\" />\n\t\t\t\t<div \n\t\t\t\t\tclass=\"bx-im-content-notification-item-content__container\"\n\t\t\t\t\t:class=\"{ '--subject-only': isSubjectOnly }\"\n\t\t\t\t\t@click=\"onContentClick\"\n\t\t\t\t>\n\t\t\t\t\t<div :class=\"{ 'bx-im-content-notification-item-content__details': showDetailedBlock }\">\n\t\t\t\t\t\t<slot name=\"content\"></slot>\n\t\t\t\t\t\t<ItemReaction v-if=\"hasReaction\" :notification=\"notificationItem\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<QuickAnswer\n\t\t\t\t\t\tv-if=\"hasQuickAnswer\"\n\t\t\t\t\t\t:notification=\"notificationItem\"\n\t\t\t\t\t\t@sendQuickAnswer=\"onSendQuickAnswer\"\n\t\t\t\t\t/>\n\t\t\t\t\t<template v-if=\"attachList\">\n\t\t\t\t\t\t<template v-for=\"attachItem in attachList\">\n\t\t\t\t\t\t\t<Attach :config=\"attachItem\"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t\t<ItemConfirmButtons\n\t\t\t\t\t\tv-if=\"notificationItem.notifyButtons.length > 0\"\n\t\t\t\t\t\t@confirmButtonsClick=\"onConfirmButtonsClick\"\n\t\t\t\t\t\t:buttons=\"notificationItem.notifyButtons\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div class=\"bx-im-content-notification-item-content__date-container\">\n\t\t\t\t\t\t<div class=\"bx-im-content-notification-item-content__date\">{{ itemDate }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Color } from 'im.v2.const';\nimport { DetailedGrid } from '../../base/grid';\nimport { DetailedText } from '../../base/text';\nimport { DetailedTitle } from '../../base/title';\nimport { DetailedChangedValue } from '../../base/changed';\nimport { DetailedUsers } from '../../base/users';\nimport { BaseNotificationItem } from '../base/base-item';\nimport { DefaultNotificationIconTitleClass } from '../../../const/const';\n\nimport '../../elements/css/item.css';\n\nimport type { ImModelNotification } from 'im.v2.model';\n\n// @vue/component\nexport const CalendarNotificationItem = {\n\tname: 'CalendarNotificationItem',\n\tcomponents: {\n\t\tDetailedTitle,\n\t\tDetailedText,\n\t\tDetailedGrid,\n\t\tDetailedChangedValue,\n\t\tDetailedUsers,\n\t\tBaseNotificationItem,\n\t},\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tColor: () => Color,\n\t\tnotificationItem(): ImModelNotification\n\t\t{\n\t\t\treturn this.notification;\n\t\t},\n\t\tnotificationParams(): ?Object\n\t\t{\n\t\t\treturn this.notificationItem.params?.componentParams ?? null;\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\treturn DefaultNotificationIconTitleClass.calendar;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseNotificationItem :notification=\"notificationItem\">\n\t\t\t<template #content>\n\t\t\t\t<DetailedTitle\n\t\t\t\t\t:notificationParams=\"notificationParams\"\n\t\t\t\t\t:icon=\"iconClass\" \n\t\t\t\t\t:color=\"Color.accentMainPrimaryAlt\"\n\t\t\t\t/>\n\t\t\t\t<DetailedGrid :notificationParams=\"notificationParams\" />\n\t\t\t\t<DetailedChangedValue :notificationParams=\"notificationParams\" />\n\t\t\t\t<DetailedText :notificationParams=\"notificationParams\" />\n\t\t\t\t<DetailedUsers :notificationParams=\"notificationParams\" />\n\t\t\t</template>\n\t\t</BaseNotificationItem>\n\t`,\n};\n","import { Color } from 'im.v2.const';\nimport { CrmNotificationIconTitleClass } from '../../../const/const';\nimport { DetailedChangedValue } from '../../base/changed';\nimport { DetailedGrid } from '../../base/grid';\nimport { DetailedText } from '../../base/text';\nimport { DetailedTitle } from '../../base/title';\nimport { BaseNotificationItem } from '../base/base-item';\n\nimport '../../elements/css/item.css';\n\nimport type { ImModelNotification } from 'im.v2.model';\n\n// @vue/component\nexport const CrmNotificationItem = {\n\tname: 'CrmNotificationItem',\n\tcomponents: {\n\t\tDetailedTitle,\n\t\tDetailedText,\n\t\tDetailedGrid,\n\t\tDetailedChangedValue,\n\t\tBaseNotificationItem,\n\t},\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tColor: () => Color,\n\t\tnotificationItem(): ImModelNotification\n\t\t{\n\t\t\treturn this.notification;\n\t\t},\n\t\tnotificationParams(): ?Object\n\t\t{\n\t\t\treturn this.notificationItem.params?.componentParams ?? null;\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\tconst entityKey = this.notificationParams.entity.entityType;\n\n\t\t\tif (entityKey && CrmNotificationIconTitleClass[entityKey])\n\t\t\t{\n\t\t\t\treturn CrmNotificationIconTitleClass[entityKey];\n\t\t\t}\n\n\t\t\treturn CrmNotificationIconTitleClass.deal;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseNotificationItem :notification=\"notificationItem\">\n\t\t\t<template #content>\n\t\t\t\t<DetailedTitle\n\t\t\t\t\t:notificationParams=\"notificationParams\"\n\t\t\t\t\t:icon=\"iconClass\"\n\t\t\t\t\t:color=\"Color.accentMainSuccessAlt\"\n\t\t\t\t/>\n\t\t\t\t<DetailedGrid :notificationParams=\"notificationParams\" />\n\t\t\t\t<DetailedChangedValue :notificationParams=\"notificationParams\" />\n\t\t\t\t<DetailedText :notificationParams=\"notificationParams\" />\n\t\t\t</template>\n\t\t</BaseNotificationItem>\n\t`,\n};\n","import { Color } from 'im.v2.const';\nimport { DetailedGrid } from '../../base/grid';\nimport { DetailedText } from '../../base/text';\nimport { DetailedTitle } from '../../base/title';\nimport { DetailedChangedValue } from '../../base/changed';\nimport { BaseNotificationItem } from '../base/base-item';\nimport { DefaultNotificationIconTitleClass } from '../../../const/const';\n\nimport '../../elements/css/item.css';\n\nimport type { ImModelNotification } from 'im.v2.model';\n\n// @vue/component\nexport const TaskNotificationItem = {\n\tname: 'TaskNotificationItem',\n\tcomponents: {\n\t\tDetailedTitle,\n\t\tDetailedText,\n\t\tDetailedGrid,\n\t\tDetailedChangedValue,\n\t\tBaseNotificationItem,\n\t},\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tColor: () => Color,\n\t\tnotificationItem(): ImModelNotification\n\t\t{\n\t\t\treturn this.notification;\n\t\t},\n\t\tnotificationParams(): ?Object\n\t\t{\n\t\t\treturn this.notificationItem.params?.componentParams ?? null;\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\treturn DefaultNotificationIconTitleClass.task;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseNotificationItem :notification=\"notification\">\n\t\t\t<template #content>\n\t\t\t\t<DetailedTitle\n\t\t\t\t\t:notificationParams=\"notificationParams\"\n\t\t\t\t\t:icon=\"iconClass\"\n\t\t\t\t\t:color=\"Color.accentMainSuccess\"\n\t\t\t\t/>\n\t\t\t\t<DetailedChangedValue :notificationParams=\"notificationParams\" />\n\t\t\t\t<DetailedGrid :notificationParams=\"notificationParams\" />\n\t\t\t\t<DetailedText :notificationParams=\"notificationParams\" />\n\t\t\t</template>\n\t\t</BaseNotificationItem>\n\t`,\n};\n","import { Color } from 'im.v2.const';\nimport { BizprocNotificationIconTitleClass } from '../../../const/const';\nimport { DetailedChangedValue } from '../../base/changed';\nimport { DetailedGrid } from '../../base/grid';\nimport { DetailedText } from '../../base/text';\nimport { DetailedTitle } from '../../base/title';\nimport { BaseNotificationItem } from '../base/base-item';\n\nimport '../../elements/css/item.css';\n\nimport type { ImModelNotification } from 'im.v2.model';\n\n// @vue/component\nexport const BizprocNotificationItem = {\n\tname: 'BizprocNotificationItem',\n\tcomponents: {\n\t\tDetailedTitle,\n\t\tDetailedText,\n\t\tDetailedChangedValue,\n\t\tDetailedGrid,\n\t\tBaseNotificationItem,\n\t},\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tColor: () => Color,\n\t\tnotificationItem(): ImModelNotification\n\t\t{\n\t\t\treturn this.notification;\n\t\t},\n\t\tnotificationParams(): ?Object\n\t\t{\n\t\t\treturn this.notificationItem.params?.componentParams ?? null;\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\tconst entityKey = this.notificationParams.entity.entityType;\n\t\t\tif (entityKey && BizprocNotificationIconTitleClass[entityKey])\n\t\t\t{\n\t\t\t\treturn BizprocNotificationIconTitleClass[entityKey];\n\t\t\t}\n\n\t\t\treturn BizprocNotificationIconTitleClass.bizproc;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseNotificationItem :notification=\"notificationItem\">\n\t\t\t<template #content>\n\t\t\t\t<DetailedTitle\n\t\t\t\t\t:notificationParams=\"notificationParams\"\n\t\t\t\t\t:icon=\"iconClass\"\n\t\t\t\t\t:color=\"Color.orangeExtra\"\n\t\t\t\t/>\n\t\t\t\t<DetailedGrid :notificationParams=\"notificationParams\" />\n\t\t\t\t<DetailedChangedValue :notificationParams=\"notificationParams\" />\n\t\t\t\t<DetailedText :notificationParams=\"notificationParams\" />\n\t\t\t</template>\n\t\t</BaseNotificationItem>\n\t`,\n};\n","import { Color } from 'im.v2.const';\nimport { SonetNotificationIconTitleClass } from '../../../const/const';\nimport { DetailedChangedValue } from '../../base/changed';\nimport { DetailedGrid } from '../../base/grid';\nimport { DetailedText } from '../../base/text';\nimport { DetailedTitle } from '../../base/title';\nimport { BaseNotificationItem } from '../base/base-item';\n\nimport '../../elements/css/item.css';\n\nimport type { ImModelNotification } from 'im.v2.model';\n\n// @vue/component\nexport const SonetNotificationItem = {\n\tname: 'SonetNotificationItem',\n\tcomponents: {\n\t\tDetailedTitle,\n\t\tDetailedText,\n\t\tDetailedGrid,\n\t\tDetailedChangedValue,\n\t\tBaseNotificationItem,\n\t},\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tColor: () => Color,\n\t\tnotificationItem(): ImModelNotification\n\t\t{\n\t\t\treturn this.notification;\n\t\t},\n\t\tnotificationParams(): ?Object\n\t\t{\n\t\t\treturn this.notificationItem.params?.componentParams ?? null;\n\t\t},\n\t\ticonClass(): string\n\t\t{\n\t\t\tconst entityKey = this.notificationParams.entity.entityType;\n\n\t\t\tif (entityKey && SonetNotificationIconTitleClass[entityKey])\n\t\t\t{\n\t\t\t\treturn SonetNotificationIconTitleClass[entityKey];\n\t\t\t}\n\n\t\t\treturn SonetNotificationIconTitleClass.newsfeed;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseNotificationItem :notification=\"notificationItem\">\n\t\t\t<template #content>\n\t\t\t\t<DetailedTitle\n\t\t\t\t\t:notificationParams=\"notificationParams\"\n\t\t\t\t\t:icon=\"iconClass\"\n\t\t\t\t\t:color=\"Color.accentExtraAqua\"\n\t\t\t\t/>\n\t\t\t\t<DetailedGrid :notificationParams=\"notificationParams\" />\n\t\t\t\t<DetailedChangedValue :notificationParams=\"notificationParams\" />\n\t\t\t\t<DetailedText :notificationParams=\"notificationParams\" />\n\t\t\t</template>\n\t\t</BaseNotificationItem>\n\t`,\n};\n","import { Messenger } from 'im.public';\nimport { UserType } from 'im.v2.const';\nimport { ChatTitle } from 'im.v2.component.elements.chat-title';\n\nimport '../../elements/css/item-header.css';\n\nimport type { ImModelUser, ImModelNotification } from 'im.v2.model';\nimport type { JsonObject } from 'main.core';\n\n// @vue/component\nexport const CompatibilityNotificationItemHeader = {\n\tname: 'CompatibilityNotificationItemHeader',\n\tcomponents: { ChatTitle },\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: [\n\t\t'moreUsersClick',\n\t],\n\tcomputed: {\n\t\tnotificationItem(): ImModelNotification\n\t\t{\n\t\t\treturn this.notification;\n\t\t},\n\t\tuser(): ImModelUser\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.notificationItem.authorId, true);\n\t\t},\n\t\thasName(): boolean\n\t\t{\n\t\t\treturn this.notificationItem.authorId > 0 && this.user.name.length > 0;\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\tif (this.notificationItem.title.length > 0)\n\t\t\t{\n\t\t\t\treturn this.notificationItem.title;\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_ITEM_SYSTEM');\n\t\t},\n\t\tisSystem(): boolean\n\t\t{\n\t\t\treturn this.notification.authorId === 0;\n\t\t},\n\t\tuserDialogId(): string\n\t\t{\n\t\t\treturn this.notification.authorId.toString();\n\t\t},\n\t\ttitleClasses(): JsonObject\n\t\t{\n\t\t\treturn {\n\t\t\t\t'bx-im-content-notification-item-header__title-text': true,\n\t\t\t\t'bx-im-content-notification-item-header__title-user-text': !this.isSystem,\n\t\t\t\t'--extranet': this.user.type === UserType.extranet,\n\t\t\t\t'--short': !this.hasMoreUsers,\n\t\t\t};\n\t\t},\n\t\thasMoreUsers(): boolean\n\t\t{\n\t\t\tif (this.isSystem)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn Boolean(this.notificationItem.params?.users) && this.notificationItem.params.users.length > 0;\n\t\t},\n\t\tmoreUsers(): string\n\t\t{\n\t\t\tconst phrase = this.$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_MORE_USERS').split('#COUNT#');\n\n\t\t\treturn {\n\t\t\t\tstart: phrase[0],\n\t\t\t\tend: this.notificationItem.params.users.length + phrase[1],\n\t\t\t};\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonUserTitleClick()\n\t\t{\n\t\t\tif (this.isSystem)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tMessenger.openChat(this.userDialogId);\n\t\t},\n\t\tonMoreUsersClick(event)\n\t\t{\n\t\t\tif (event.users)\n\t\t\t{\n\t\t\t\tthis.$emit('moreUsersClick', {\n\t\t\t\t\tevent: event.event,\n\t\t\t\t\tusers: event.users,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-notification-item-header__container\">\n\t\t\t<div class=\"bx-im-content-notification-item-header__title-container\">\n\t\t\t\t<ChatTitle\n\t\t\t\t\tv-if=\"hasName\"\n\t\t\t\t\t:dialogId=\"userDialogId\"\n\t\t\t\t\t:showItsYou=\"false\"\n\t\t\t\t\t:class=\"titleClasses\"\n\t\t\t\t\t@click.prevent=\"onUserTitleClick\"\n\t\t\t\t/>\n\t\t\t\t<span v-else @click.prevent=\"onUserTitleClick\" :class=\"titleClasses\">{{ title }}</span>\n\t\t\t\t<span v-if=\"hasMoreUsers\" class=\"bx-im-content-notification-item-header__more-users\">\n\t\t\t\t\t<span class=\"bx-im-content-notification-item-header__more-users-start\">{{ moreUsers.start }}</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"bx-im-content-notification-item-header__more-users-dropdown\"\n\t\t\t\t\t\t@click=\"onMoreUsersClick({users: notificationItem.params.users, event: $event})\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ moreUsers.end }}\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Parser } from 'im.v2.lib.parser';\n\nimport { BaseNotificationItem } from '../base/base-item';\nimport { CompatibilityNotificationItemHeader } from './compatibility-header';\n\n// @vue/component\nexport const CompatibilityNotificationItem = {\n\tname: 'DefaultNotificationItem',\n\tcomponents: {\n\t\tBaseNotificationItem,\n\t\tCompatibilityNotificationItemHeader,\n\t},\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['moreUsersClick'],\n\tcomputed: {\n\t\tcontent(): string\n\t\t{\n\t\t\treturn Parser.decodeNotification(this.notification);\n\t\t},\n\t},\n\tmethods: {\n\t\tonMoreUsersClick(event)\n\t\t{\n\t\t\tthis.$emit('moreUsersClick', event);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseNotificationItem :notification=\"notification\">\n\t\t\t<template #header>\n\t\t\t\t<CompatibilityNotificationItemHeader\n\t\t\t\t\t:notification=\"notification\"\n\t\t\t\t\t@moreUsersClick=\"onMoreUsersClick\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<template #content>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"content.length > 0\"\n\t\t\t\t\tclass=\"bx-im-content-notification-item-content__content-text\"\n\t\t\t\t\tv-html=\"content\"\n\t\t\t\t></div>\n\t\t\t</template>\n\t\t</BaseNotificationItem>\n\t`,\n};\n","import { Color } from 'im.v2.const';\nimport { BaseNotificationItem } from '../base/base-item';\n\nimport '../../elements/css/item.css';\n\nimport type { ImModelNotification } from 'im.v2.model';\n\n// @vue/component\nexport const DefaultNotificationItem = {\n\tname: 'DefaultNotificationItem',\n\tcomponents: {\n\t\tBaseNotificationItem,\n\t},\n\tprops: {\n\t\tnotification: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tColor: () => Color,\n\t\tnotificationItem(): ImModelNotification\n\t\t{\n\t\t\treturn this.notification;\n\t\t},\n\t\tnotificationParams(): ?Object\n\t\t{\n\t\t\treturn this.notificationItem.params?.componentParams ?? null;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BaseNotificationItem :notification=\"notificationItem\"/>\n\t`,\n};\n","import { CalendarNotificationItem } from './modules/calendar/calendar-item';\nimport { CrmNotificationItem } from './modules/crm/crm-item';\nimport { TaskNotificationItem } from './modules/task/task-item';\nimport { BizprocNotificationItem } from './modules/bizproc/bizproc-item';\nimport { SonetNotificationItem } from './modules/sonet/sonet';\nimport { CompatibilityNotificationItem } from './modules/compatibility/compatibility-item';\nimport { DefaultNotificationItem } from './modules/default/default-item';\n\nexport const NotificationComponents = {\n\tTaskEntity: TaskNotificationItem,\n\tCalendarEntity: CalendarNotificationItem,\n\tCompatibilityEntity: CompatibilityNotificationItem,\n\tCrmEntity: CrmNotificationItem,\n\tBizprocEntity: BizprocNotificationItem,\n\tSonetEntity: SonetNotificationItem,\n\tDefaultEntity: DefaultNotificationItem,\n};\n","import './css/placeholder.css';\n\nexport const ItemPlaceholder = {\n\tname: 'ItemPlaceholder',\n\tprops: {\n\t\titemsToShow: {\n\t\t\ttype: Number,\n\t\t\tdefault: 50,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-notification-placeholder__container\" v-for=\"index in itemsToShow\">\n\t\t\t<div class=\"bx-im-content-notification-placeholder__element\">\n\t\t\t\t<div class=\"bx-im-content-notification-placeholder__avatar-container\">\n\t\t\t\t\t<div class=\"bx-im-content-notification-placeholder__avatar\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-content-notification-placeholder__content-container\">\n\t\t\t\t\t<div class=\"bx-im-content-notification-placeholder__content-inner\">\n\t\t\t\t\t\t<div class=\"bx-im-content-notification-placeholder__content --top\"></div>\n\t\t\t\t\t\t<div class=\"bx-im-content-notification-placeholder__content --short\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bx-im-content-notification-placeholder__content --full\"></div>\n\t\t\t\t\t<div class=\"bx-im-content-notification-placeholder__content --middle\"></div>\n\t\t\t\t\t<div class=\"bx-im-content-notification-placeholder__content --bottom\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { NotificationTypesCodes } from 'im.v2.const';\nimport { mapState } from 'ui.vue3.vuex';\n\nimport './css/scroll-button.css';\n\nexport const ScrollButton = {\n\tname: 'ScrollButton',\n\tprops: {\n\t\tunreadCounter: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\tnotificationsOnScreen: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['scrollButtonClick'],\n\tcomputed: {\n\t\tnotificationCollection(): Array\n\t\t{\n\t\t\treturn this.$store.getters['notifications/getSortedCollection'];\n\t\t},\n\t\thasUnreadOnScreen(): boolean\n\t\t{\n\t\t\treturn [...this.notificationsOnScreen].some(id => !this.notificationMapCollection.get(id)?.read);\n\t\t},\n\t\tfirstUnreadId(): ?number\n\t\t{\n\t\t\tconst item = this.notificationCollection.find(notification => !notification.read);\n\t\t\tif (!item)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\treturn item.id;\n\t\t},\n\t\tfirstUnreadBelowVisible(): ?number\n\t\t{\n\t\t\tconst minIdOnScreen = Math.min(...this.notificationsOnScreen);\n\n\t\t\tconst item = this.notificationCollection.find(notification => {\n\t\t\t\treturn !notification.read\n\t\t\t\t\t&& notification.sectionCode === NotificationTypesCodes.simple\n\t\t\t\t\t&& minIdOnScreen > notification.id\n\t\t\t\t;\n\t\t\t});\n\n\t\t\tif (!item)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\treturn item.id;\n\t\t},\n\t\thasUnreadBelowVisible(): boolean\n\t\t{\n\t\t\tlet unreadCounterBeforeVisible = 0;\n\n\t\t\tfor (let i = 0; i <= this.notificationCollection.length - 1; i++)\n\t\t\t{\n\t\t\t\tif (!this.notificationCollection[i].read)\n\t\t\t\t{\n\t\t\t\t\t++unreadCounterBeforeVisible;\n\t\t\t\t}\n\n\t\t\t\t// In this case we decide that there is no more unread notifications below visible notifications,\n\t\t\t\t// so we show arrow up on scroll button.\n\t\t\t\tif (\n\t\t\t\t\tthis.notificationsOnScreen.has(this.notificationCollection[i].id)\n\t\t\t\t\t&& this.unreadCounter === unreadCounterBeforeVisible\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tshowScrollButton()\n\t\t{\n\t\t\t// todo: check BXIM.settings.notifyAutoRead\n\t\t\tif (this.unreadCounter === 0 || this.hasUnreadOnScreen)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tarrowButtonClass()\n\t\t{\n\t\t\tconst arrowDown = this.hasUnreadBelowVisible;\n\n\t\t\treturn {\n\t\t\t\t'bx-im-notifications-scroll-button-arrow-down': arrowDown,\n\t\t\t\t'bx-im-notifications-scroll-button-arrow-up': !arrowDown,\n\t\t\t};\n\t\t},\n\t\tformattedCounter(): string\n\t\t{\n\t\t\tif (this.unreadCounter > 99)\n\t\t\t{\n\t\t\t\treturn '99+';\n\t\t\t}\n\n\t\t\treturn `${this.unreadCounter}`;\n\t\t},\n\t\t...mapState({\n\t\t\tnotificationMapCollection: state => state.notifications.collection,\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tonScrollButtonClick()\n\t\t{\n\t\t\tlet idToScroll = null;\n\t\t\tif (this.firstUnreadBelowVisible)\n\t\t\t{\n\t\t\t\tidToScroll = this.firstUnreadBelowVisible;\n\t\t\t}\n\t\t\telse if (!this.hasUnreadBelowVisible)\n\t\t\t{\n\t\t\t\tidToScroll = this.firstUnreadId;\n\t\t\t}\n\n\t\t\tlet firstUnreadNode = null;\n\t\t\tif (idToScroll !== null)\n\t\t\t{\n\t\t\t\tconst selector = `.bx-im-content-notification-item__container[data-id=\"${idToScroll}\"]`;\n\t\t\t\tfirstUnreadNode = document.querySelector(selector);\n\t\t\t}\n\n\t\t\tif (firstUnreadNode)\n\t\t\t{\n\t\t\t\tthis.$emit('scrollButtonClick', firstUnreadNode.offsetTop);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst latestNotification = this.notificationCollection[this.notificationCollection.length - 1];\n\t\t\t\tconst selector = `.bx-im-content-notification-item__container[data-id=\"${latestNotification.id}\"]`;\n\t\t\t\tconst latestNotificationNode = document.querySelector(selector);\n\n\t\t\t\tthis.$emit('scrollButtonClick', latestNotificationNode.offsetTop);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition name=\"bx-im-notifications-scroll-button\">\n\t\t\t<div \n\t\t\t\tv-show=\"showScrollButton\" \n\t\t\t\tclass=\"bx-im-content-notification-scroll-button__container\" \n\t\t\t\t@click=\"onScrollButtonClick\"\n\t\t\t>\n\t\t\t\t<div class=\"bx-im-content-notification-scroll-button__button\">\n\t\t\t\t\t<div class=\"bx-im-notifications-scroll-button-counter\">\n\t\t\t\t\t\t{{ formattedCounter }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class=\"arrowButtonClass\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`\n};\n","import { Chip, ChipDesign, ChipSize } from 'ui.system.chip.vue';\n\nimport './css/value-chip.css';\n\n// @vue/component\nexport const NotificationFilterValueChip = {\n\tname: 'NotificationFilterValueChip',\n\tcomponents: { Chip },\n\tprops: {\n\t\ttext: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\temits: ['clear'],\n\tcomputed: {\n\t\tChipDesign: () => ChipDesign,\n\t\tChipSize: () => ChipSize,\n\t},\n\ttemplate: `\n\t\t<Chip\n\t\t\tclass=\"bx-im-notification-filter_search-value__chip-container\"\n\t\t\t:size=\"ChipSize.Xs\"\n\t\t\t:design=\"ChipDesign.Tinted\"\n\t\t\t:text=\"text\"\n\t\t\t:withClear=\"true\"\n\t\t\t:title=\"title\"\n\t\t\t:compact=\"false\"\n\t\t\t@clear=\"$emit('clear')\"\n\t\t/>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { NotificationFilterFieldTypes } from '../../notification-filter';\nimport { NotificationFilterValueChip } from './value-chip';\n\nimport './css/values-container.css';\n\nconst ANOTHER_TYPE = 'anotherValues';\n\n// @vue/component\nexport const NotificationFilterValuesContainer = {\n\tname: 'NotificationFilterValuesContainer',\n\tcomponents: { NotificationFilterValueChip },\n\tprops: {\n\t\tnonEmptyEntries: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['remove'],\n\tcomputed: {\n\t\tANOTHER_TYPE: () => ANOTHER_TYPE,\n\t\tfirstNonEmptyField(): ?{ key: string, value: string | Array }\n\t\t{\n\t\t\tconst list = this.nonEmptyEntries;\n\n\t\t\treturn list.length > 0 ? list[0] : null;\n\t\t},\n\t\tsecondNonEmptyField(): ?{ key: string, value: string | Array }\n\t\t{\n\t\t\tconst list = this.nonEmptyEntries;\n\n\t\t\treturn list.length > 1 ? list[1] : null;\n\t\t},\n\t\tremainingNonEmptyEntries(): Array<{ key: string, value: string | Array }>\n\t\t{\n\t\t\tconst list = this.nonEmptyEntries;\n\n\t\t\treturn list.length > 1 ? list.slice(1) : [];\n\t\t},\n\t\tfirstTagTitle(): string\n\t\t{\n\t\t\tif (!this.firstNonEmptyField)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this.formatEntry(this.firstNonEmptyField);\n\t\t},\n\t\tsecondTagTitle(): string\n\t\t{\n\t\t\tif (!this.secondNonEmptyField)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this.formatEntry(this.secondNonEmptyField);\n\t\t},\n\t\tremainingTagTitle(): string\n\t\t{\n\t\t\tif (this.remainingNonEmptyEntries.length === 0)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this.remainingNonEmptyEntries.map((e) => this.formatEntry(e)).join('\\n');\n\t\t},\n\t\thasNonEmptyEntries(): boolean\n\t\t{\n\t\t\treturn this.nonEmptyEntries.length > 0;\n\t\t},\n\t\thasSingleRemainingEntry(): boolean\n\t\t{\n\t\t\treturn this.remainingNonEmptyEntries.length === 1;\n\t\t},\n\t\thasMultipleRemainingEntries(): boolean\n\t\t{\n\t\t\treturn this.remainingNonEmptyEntries.length > 1;\n\t\t},\n\t},\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tgetTitle(key: string, values?: string | Array | null): string\n\t\t{\n\t\t\tif (!values && key === this.ANOTHER_TYPE && this.remainingNonEmptyEntries.length > 0)\n\t\t\t{\n\t\t\t\treturn this.loc(\n\t\t\t\t\t'IM_NOTIFICATIONS_FILTER_ANOTHER_VALUES_TAG',\n\t\t\t\t\t{ '#COUNT#': String(this.remainingNonEmptyEntries.length) },\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn this.formatEntry({ key, value: values });\n\t\t},\n\t\tgetTagTitle(fieldKey: string): string\n\t\t{\n\t\t\tif (fieldKey === NotificationFilterFieldTypes.searchTypes)\n\t\t\t{\n\t\t\t\treturn 'IM_NOTIFICATIONS_FILTER_TYPE_FIELD_TAG_TEXT';\n\t\t\t}\n\n\t\t\tif (fieldKey === NotificationFilterFieldTypes.searchDate)\n\t\t\t{\n\t\t\t\treturn 'IM_NOTIFICATIONS_FILTER_DATE_FIELD_TAG_TEXT';\n\t\t\t}\n\n\t\t\tif (fieldKey === NotificationFilterFieldTypes.searchAuthors)\n\t\t\t{\n\t\t\t\treturn 'IM_NOTIFICATIONS_FILTER_AUTHOR_FIELD_TAG_TEXT';\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tformatValue(fieldKey: string, value: any): string\n\t\t{\n\t\t\tif (Type.isArray(value))\n\t\t\t{\n\t\t\t\treturn value.join(', ');\n\t\t\t}\n\n\t\t\treturn String(value);\n\t\t},\n\t\tformatEntry(entry: { key: string, value: any }): string\n\t\t{\n\t\t\tconst phraseCode = this.getTagTitle(entry.key);\n\t\t\tif (phraseCode === '')\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this.loc(\n\t\t\t\tphraseCode,\n\t\t\t\t{ '#VALUE#': this.formatValue(entry.key, entry.value) },\n\t\t\t);\n\t\t},\n\t\tonRemoveSimpleTag(key: string): void\n\t\t{\n\t\t\tif (this.firstNonEmptyField)\n\t\t\t{\n\t\t\t\tthis.$emit('remove', [key]);\n\t\t\t}\n\t\t},\n\t\tonRemoveRemainingTags(): void\n\t\t{\n\t\t\tconst keys = this.remainingNonEmptyEntries.map((e) => e.key);\n\t\t\tif (keys.length > 0)\n\t\t\t{\n\t\t\t\tthis.$emit('remove', keys);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"hasNonEmptyEntries\"\n\t\t\tclass=\"bx-im-notification-filter-value_tags-container\"\n\t\t>\n\t\t\t<NotificationFilterValueChip\n\t\t\t\tv-if=\"firstNonEmptyField\"\n\t\t\t\t:text=\"getTitle(firstNonEmptyField.key, firstNonEmptyField.value)\"\n\t\t\t\t:title=\"firstTagTitle\"\n\t\t\t\tdata-test-id=\"im_notifications-filter__chip-first\"\n\t\t\t\t@clear=\"onRemoveSimpleTag(firstNonEmptyField.key)\"\n\t\t\t/>\n\t\t\t<NotificationFilterValueChip\n\t\t\t\tv-if=\"hasSingleRemainingEntry\"\n\t\t\t\t:text=\"getTitle(secondNonEmptyField.key, secondNonEmptyField.value)\"\n\t\t\t\t:title=\"secondTagTitle\"\n\t\t\t\tdata-test-id=\"im_notifications-filter__chip-second\"\n\t\t\t\t@clear=\"onRemoveSimpleTag(secondNonEmptyField.key)\"\n\t\t\t/>\n\t\t\t<NotificationFilterValueChip\n\t\t\t\tv-if=\"hasMultipleRemainingEntries\"\n\t\t\t\t:text=\"getTitle(ANOTHER_TYPE)\"\n\t\t\t\t:title=\"remainingTagTitle\"\n\t\t\t\tdata-test-id=\"im_notifications-filter__chip-third\"\n\t\t\t\t@clear=\"onRemoveRemainingTags()\"\n\t\t\t/>\n\t\t\t<span class=\"bx-im-notification-filter-plus\">+</span>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { BIcon, Outline as OutlineIcons } from 'ui.icon-set.api.vue';\n\nimport { NotificationFilterFieldTypes } from '../../notification-filter';\nimport { NotificationFilterValuesContainer } from './values-container';\nimport { Color } from 'im.v2.const';\n\nimport type { JsonObject } from 'main.core';\n\nimport './css/search-input.css';\n\n// @vue/component\nexport const NotificationFilterSearchInput = {\n\tname: 'NotificationFilterSearchInput',\n\tcomponents: { BIcon, NotificationFilterValuesContainer },\n\tprops: {\n\t\tdisplayData: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmodelValue: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\temits: ['update:modelValue', 'focus', 'remove', 'clear'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisFocused: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tColor: () => Color,\n\t\tOutlineIcons: () => OutlineIcons,\n\t\tisSearchEmpty(): boolean\n\t\t{\n\t\t\treturn this.modelValue === '';\n\t\t},\n\t\twithTags(): boolean\n\t\t{\n\t\t\treturn this.nonEmptyEntries.length > 0;\n\t\t},\n\t\tnonEmptyEntries(): Array<{ key: string, value: string | Array }>\n\t\t{\n\t\t\tconst result = [];\n\t\t\tfor (const [key, value] of Object.entries(this.displayData))\n\t\t\t{\n\t\t\t\tif (Type.isArrayFilled(value))\n\t\t\t\t{\n\t\t\t\t\tresult.push({ key, value });\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isStringFilled(value))\n\t\t\t\t{\n\t\t\t\t\tresult.push({ key, value });\n\t\t\t\t}\n\n\t\t\t\tif (key === NotificationFilterFieldTypes.searchDate)\n\t\t\t\t{\n\t\t\t\t\tif (value.date?.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push({ key, value: value.date });\n\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (value.dateFrom?.length > 0 && value.dateTo?.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push({ key, value: `${value.dateFrom} - ${value.dateTo}` });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tplaceholderText(): string\n\t\t{\n\t\t\tif (this.nonEmptyEntries.length > 0)\n\t\t\t{\n\t\t\t\treturn this.loc('IM_NOTIFICATIONS_FILTER_SEARCH_INPUT_PLACEHOLDER_WITH_TAGS');\n\t\t\t}\n\n\t\t\treturn this.loc('IM_NOTIFICATIONS_FILTER_SEARCH_INPUT_PLACEHOLDER');\n\t\t},\n\t},\n\twatch: {\n\t\tsearchValue(): void\n\t\t{\n\t\t\tthis.$emit('updateSearch', this.searchValue);\n\t\t},\n\t},\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonFocus(event): void\n\t\t{\n\t\t\tthis.isFocused = true;\n\t\t\tthis.$emit('focus', event);\n\t\t},\n\t\tonRemove(keys: Array<string>): void\n\t\t{\n\t\t\tthis.$emit('remove', keys);\n\t\t},\n\t\tonInput(event: Event)\n\t\t{\n\t\t\tthis.$emit('update:modelValue', event.target.value);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"bx-im-content-notification-filter-search\"\n\t\t\t:class=\"{ '--focused': isFocused }\"\n\t\t\tref=\"container\"\n\t\t\tdata-test-id=\"im_content-notification-filter__search-container\"\n\t\t>\n\t\t\t<NotificationFilterValuesContainer\n\t\t\t\t:nonEmptyEntries=\"nonEmptyEntries\"\n\t\t\t\t@remove=\"onRemove\"\n\t\t\t/>\n\t\t\t<input\n\t\t\t\tclass=\"bx-im-content-notification-filter-search__input\"\n\t\t\t\ttype=\"text\"\n\t\t\t\t:value=\"modelValue\"\n\t\t\t\t:class=\"{ '--with-tags': this.withTags }\"\n\t\t\t\t:placeholder=\"placeholderText\"\n\t\t\t\tdata-test-id=\"im_notifications-filter__search-input\"\n\t\t\t\t@focus=\"onFocus\"\n\t\t\t\t@input=\"onInput\"\n\t\t\t\t@blur=\"this.isFocused = false\"\n\t\t\t/>\n\t\t\t<div class=\"bx-im-content-notification-filter-search__icons-block\">\n\t\t\t\t<BIcon\n\t\t\t\t\t:name=\"OutlineIcons.SEARCH\"\n\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t:color=\"Color.base5\"\n\t\t\t\t\t:hoverable=\"true\"\n\t\t\t\t\tclass=\"bx-im-content-notification-filter-search__icon-search\"\n\t\t\t\t\t:class=\"{ '--without-delete-icon': isSearchEmpty }\"\n\t\t\t\t/>\n\t\t\t\t<BIcon\n\t\t\t\t\t:name=\"OutlineIcons.CROSS_L\"\n\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t:color=\"Color.base5\"\n\t\t\t\t\t:hoverable=\"true\"\n\t\t\t\t\tclass=\"bx-im-content-notification-filter-search__icon-delete\"\n\t\t\t\t\t:class=\"{ '--hidden': isSearchEmpty }\"\n\t\t\t\t\tdata-test-id=\"im_notifications-filter__search-reset\"\n\t\t\t\t\t@click.stop=\"$emit('clear')\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Button as UiButton, AirButtonStyle, ButtonSize } from 'ui.vue3.components.button';\nimport { Outline as OutlineIcons } from 'ui.icon-set.api.core';\n\n// @vue/component\nexport const NotificationFilterActionButtons = {\n\tname: 'NotificationFilterPopupActionButtons',\n\tcomponents: { UiButton },\n\temits: ['search', 'reset'],\n\tcomputed: {\n\t\tOutlineIcons: () => OutlineIcons,\n\t\tButtonSize: () => ButtonSize,\n\t\tAirButtonStyle: () => AirButtonStyle,\n\t},\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-notification-filter-popup__actions-container\">\n\t\t\t<UiButton\n\t\t\t\t:text=\"loc('IM_NOTIFICATIONS_FILTER_SEARCH_BUTTON')\"\n\t\t\t\tclass=\"--air\"\n\t\t\t\t:style=\"AirButtonStyle.FILLED\"\n\t\t\t\t:size=\"ButtonSize.LARGE\"\n\t\t\t\t:leftIcon=\"OutlineIcons.SEARCH\"\n\t\t\t\t:dataset=\"{ testId: 'im_content-notification-filter__popup-search-button' }\"\n\t\t\t\t@click=\"$emit('search')\"\n\t\t\t/>\n\t\t\t<UiButton\n\t\t\t\t:text=\"loc('IM_NOTIFICATIONS_FILTER_RESET_BUTTON')\"\n\t\t\t\tclass=\"--air\"\n\t\t\t\t:style=\"AirButtonStyle.PLAIN\"\n\t\t\t\t:size=\"ButtonSize.LARGE\"\n\t\t\t\t:dataset=\"{ testId: 'im_content-notification-filter__popup-reset-button' }\"\n\t\t\t\t@click=\"$emit('reset')\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { TagSelector } from 'ui.entity-selector';\nimport type { BaseEvent } from 'main.core.events';\n\nimport './css/field.css';\n\n// @vue/component\nexport const NotificationFilterAuthorField = {\n\tname: 'AuthorFilterField',\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\t},\n\temits: ['update:modelValue', 'popupStateChange'],\n\tcomputed: {\n\t\tlabelText(): string\n\t\t{\n\t\t\treturn this.loc('IM_NOTIFICATIONS_FILTER_AUTHOR_FIELD_TITLE');\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.selector = this.getSelector();\n\t\tthis.selector.renderTo(this.$refs['author-selector']);\n\t},\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tgetSelector(): TagSelector\n\t\t{\n\t\t\tconst preselectedItems = this.modelValue.map((author) => ['user', author.id]);\n\t\t\tconst selector = new TagSelector({\n\t\t\t\tevents: {\n\t\t\t\t\tonTagAdd: (event: BaseEvent) => {\n\t\t\t\t\t\tconst { tag } = event.getData();\n\t\t\t\t\t\tif (!this.modelValue.some((author) => author.id === tag.id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst searchAuthors = [\n\t\t\t\t\t\t\t\t...this.modelValue,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tid: tag.id,\n\t\t\t\t\t\t\t\t\tname: tag.title?.text ?? String(tag.id),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\tthis.$emit('update:modelValue', searchAuthors);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonTagRemove: (event: BaseEvent) => {\n\t\t\t\t\t\tconst { tag } = event.getData();\n\t\t\t\t\t\tconst searchAuthors = this.modelValue.filter((author) => author.id !== tag.id);\n\t\t\t\t\t\tthis.$emit('update:modelValue', searchAuthors);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tmultiple: true,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\theight: 250,\n\t\t\t\t\twidth: 380,\n\t\t\t\t\tpreselectedItems,\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\thideOnDeselect: false,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\tthis.$emit('popupStateChange', { popup: 'author', active: true });\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonHide: () => {\n\t\t\t\t\t\t\tthis.$emit('popupStateChange', { popup: 'author', active: false });\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst container = selector.getDialog()?.getContainer();\n\t\t\tif (container)\n\t\t\t{\n\t\t\t\tDom.attr(container, 'data-test-id', 'im_notifications-filter__author-field-selector');\n\t\t\t}\n\n\t\t\treturn selector;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-notifications-filter_field__container\">\n\t\t\t<div class=\"bx-im-notifications-filter_field__label\">{{ labelText }}</div>\n\t\t\t<div\n\t\t\t\tref=\"author-selector\"\n\t\t\t\tclass=\"bx-im-notifications-filter_field__selector-container\"\n\t\t\t\tdata-test-id=\"im_notifications-filter__author-field-container\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { TagSelector } from 'ui.entity-selector';\n\nimport './css/field.css';\n\nimport type { BaseEvent } from 'main.core.events';\nimport type { JsonObject } from 'main.core';\n\n// @vue/component\nexport const NotificationFilterTypeField = {\n\tname: 'TypeFilterField',\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\t\tschema: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\temits: ['update:modelValue', 'popupStateChange'],\n\tcomputed: {\n\t\tlabelText(): string\n\t\t{\n\t\t\treturn this.loc('IM_NOTIFICATIONS_FILTER_TYPE_FIELD_TITLE');\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.selector = this.getSelector();\n\t\tthis.selector.renderTo(this.$refs['type-selector']);\n\t},\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tgetSelector(): TagSelector\n\t\t{\n\t\t\tconst entityId = 'im-notification-filter-type';\n\t\t\tconst targetNode = this.getTargetNode();\n\t\t\tconst items = this.filterTypes().map((group) => ({\n\t\t\t\tid: String(group.MODULE_ID),\n\t\t\t\tentityId,\n\t\t\t\ttabs: 'recents',\n\t\t\t\ttitle: group.NAME,\n\t\t\t\tselected: this.modelValue.some((item) => item.id === String(group.MODULE_ID)),\n\t\t\t}));\n\n\t\t\tconst selector = new TagSelector({\n\t\t\t\tevents: {\n\t\t\t\t\tonTagAdd: (event: BaseEvent) => {\n\t\t\t\t\t\tconst { tag } = event.getData();\n\t\t\t\t\t\tif (!this.modelValue.some((type) => type.id === tag.id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst searchTypes = [\n\t\t\t\t\t\t\t\t...this.modelValue,\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tid: tag.id,\n\t\t\t\t\t\t\t\t\tname: tag.title?.text ?? String(tag.id),\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\tthis.$emit('update:modelValue', searchTypes);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonTagRemove: (event: BaseEvent) => {\n\t\t\t\t\t\tconst { tag } = event.getData();\n\t\t\t\t\t\tconst searchTypes = this.modelValue.filter((type) => type.id !== tag.id);\n\t\t\t\t\t\tthis.$emit('update:modelValue', searchTypes);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tmultiple: true,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\theight: 250,\n\t\t\t\t\twidth: 300,\n\t\t\t\t\tmultiple: true,\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\tcompactView: true,\n\t\t\t\t\tshowAvatars: false,\n\t\t\t\t\thideOnDeselect: false,\n\t\t\t\t\tenableSearch: false,\n\t\t\t\t\ttargetNode,\n\t\t\t\t\titems,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\t\tconst { item } = event.getData();\n\t\t\t\t\t\t\tif (!this.modelValue.some((type) => type.id === item.id))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst searchTypes = [\n\t\t\t\t\t\t\t\t\t...this.modelValue,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tid: item.id,\n\t\t\t\t\t\t\t\t\t\tname: item.title?.text ?? String(item.id),\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\tthis.$emit('update:modelValue', searchTypes);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\tthis.$emit('popupStateChange', { popup: 'type', active: true });\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonHide: () => {\n\t\t\t\t\t\t\tthis.$emit('popupStateChange', { popup: 'type', active: false });\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst container = selector.getDialog()?.getContainer();\n\t\t\tif (container)\n\t\t\t{\n\t\t\t\tDom.attr(container, 'data-test-id', 'im_notifications-filter__types-field-selector');\n\t\t\t}\n\n\t\t\treturn selector;\n\t\t},\n\t\tgetTargetNode(): HTMLElement\n\t\t{\n\t\t\treturn this.$refs['type-selector']?.$refs?.inputContainer ?? this.$el;\n\t\t},\n\t\tfilterTypes(): JsonObject[]\n\t\t{\n\t\t\tconst originalSchema = { ...this.schema };\n\n\t\t\t// rename some groups\n\t\t\tif (originalSchema.calendar)\n\t\t\t{\n\t\t\t\toriginalSchema.calendar.NAME = this.$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_SEARCH_FILTER_TYPE_CALENDAR');\n\t\t\t}\n\n\t\t\tif (originalSchema.sender)\n\t\t\t{\n\t\t\t\toriginalSchema.sender.NAME = this.$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_SEARCH_FILTER_TYPE_SENDER');\n\t\t\t}\n\n\t\t\tif (originalSchema.blog)\n\t\t\t{\n\t\t\t\toriginalSchema.blog.NAME = this.$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_SEARCH_FILTER_TYPE_BLOG');\n\t\t\t}\n\n\t\t\tif (originalSchema.socialnetwork)\n\t\t\t{\n\t\t\t\toriginalSchema.socialnetwork.NAME = this.$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_SEARCH_FILTER_TYPE_SOCIALNETWORK');\n\t\t\t}\n\n\t\t\tif (originalSchema.intranet)\n\t\t\t{\n\t\t\t\toriginalSchema.intranet.NAME = this.$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_SEARCH_FILTER_TYPE_INTRANET');\n\t\t\t}\n\n\t\t\t// we need only these modules in this order!\n\t\t\tconst modulesToShowInFilter = [\n\t\t\t\t'tasks', 'calendar', 'crm', 'timeman', 'mail', 'disk', 'bizproc', 'voximplant', 'sender',\n\t\t\t\t'blog', 'vote', 'socialnetwork', 'imopenlines', 'photogallery', 'intranet', 'forum',\n\t\t\t];\n\n\t\t\tconst notificationFilterTypes = [];\n\t\t\tmodulesToShowInFilter.forEach((moduleId) => {\n\t\t\t\tif (originalSchema[moduleId])\n\t\t\t\t{\n\t\t\t\t\tnotificationFilterTypes.push(originalSchema[moduleId]);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn notificationFilterTypes;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-notifications-filter_field__container\">\n\t\t\t<div class=\"bx-im-notifications-filter_field__label\">{{ labelText }}</div>\n\t\t\t<div\n\t\t\t\tref=\"type-selector\"\n\t\t\t\tclass=\"bx-im-notifications-filter_field__selector-container\"\n\t\t\t\tdata-test-id=\"im_notifications-filter__type-field-container\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { PopupManager } from 'main.popup';\nimport { Menu, type MenuItemOptions } from 'ui.system.menu';\nimport { DatePicker, DatePickerEvent, createDate } from 'ui.date-picker';\nimport { BInput, InputSize } from 'ui.system.input.vue';\nimport { BIcon, Outline as OutlineIcons } from 'ui.icon-set.api.vue';\n\nimport type { JsonObject } from 'main.core';\n\nimport './css/field.css';\n\nconst DateFieldOption = {\n\tNONE: 'none',\n\tSINGLE: 'single',\n\tRANGE: 'range',\n};\n\nexport const NotificationFilterDateField = {\n\tname: 'DateFilterField',\n\tcomponents: {\n\t\tBIcon,\n\t\tBInput,\n\t},\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t},\n\temits: ['update:modelValue', 'popupStateChange'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tsearchType: this.getCurrentSearchType(),\n\t\t};\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.menu?.destroy();\n\t},\n\tcomputed: {\n\t\tOutlineIcons: () => OutlineIcons,\n\t\tInputSize: () => InputSize,\n\t\tisFirstDateNotEmpty(): boolean\n\t\t{\n\t\t\treturn this.modelValue.date?.length > 0 || this.modelValue.dateFrom?.length > 0;\n\t\t},\n\t\tisSecondDateNotEmpty(): boolean\n\t\t{\n\t\t\treturn this.modelValue.dateTo?.length > 0;\n\t\t},\n\t\tlabelText(): string\n\t\t{\n\t\t\treturn this.loc('IM_NOTIFICATIONS_FILTER_DATE_FIELD_TITLE');\n\t\t},\n\t\tdateOptionText(): string\n\t\t{\n\t\t\tconst currentOption = this.getDateOptions().find(\n\t\t\t\t(option) => option.id === this.searchType,\n\t\t\t);\n\n\t\t\treturn currentOption ? currentOption.text : '';\n\t\t},\n\t\tshowFirstDateInput(): boolean\n\t\t{\n\t\t\treturn this.searchType === DateFieldOption.SINGLE || this.searchType === DateFieldOption.RANGE;\n\t\t},\n\t\tshowSecondDateInput(): boolean\n\t\t{\n\t\t\treturn this.searchType === DateFieldOption.RANGE;\n\t\t},\n\t\tfirstDateValue(): string\n\t\t{\n\t\t\tif (this.searchType === DateFieldOption.SINGLE)\n\t\t\t{\n\t\t\t\treturn this.modelValue.date || '';\n\t\t\t}\n\n\t\t\tif (this.searchType === DateFieldOption.RANGE)\n\t\t\t{\n\t\t\t\treturn this.modelValue.dateFrom || '';\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tsecondDateValue(): string\n\t\t{\n\t\t\tif (this.searchType === DateFieldOption.RANGE)\n\t\t\t{\n\t\t\t\treturn this.modelValue.dateTo || '';\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tgetCurrentSearchType(): string\n\t\t{\n\t\t\tif (this.modelValue.date)\n\t\t\t{\n\t\t\t\treturn DateFieldOption.SINGLE;\n\t\t\t}\n\n\t\t\tif (this.modelValue.dateFrom && this.modelValue.dateTo)\n\t\t\t{\n\t\t\t\treturn DateFieldOption.RANGE;\n\t\t\t}\n\n\t\t\treturn DateFieldOption.NONE;\n\t\t},\n\t\tgetDateOptions(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t{ id: DateFieldOption.NONE, text: this.loc('IM_NOTIFICATIONS_FILTER_DATE_OPTION_NONE') },\n\t\t\t\t{ id: DateFieldOption.SINGLE, text: this.loc('IM_NOTIFICATIONS_FILTER_DATE_OPTION_SINGLE') },\n\t\t\t\t{ id: DateFieldOption.RANGE, text: this.loc('IM_NOTIFICATIONS_FILTER_DATE_OPTION_RANGE') },\n\t\t\t];\n\t\t},\n\t\tgetOptionsMenuItems(): MenuItemOptions\n\t\t{\n\t\t\treturn this.getDateOptions().map((option) => ({\n\t\t\t\ttitle: option.text,\n\t\t\t\tisSelected: option.id === this.searchType,\n\t\t\t\tonClick: (): void => {\n\t\t\t\t\tthis.searchType = option.id;\n\t\t\t\t\tthis.$emit('update:modelValue', {});\n\t\t\t\t\tthis.menu.updateItems(this.getOptionsMenuItems());\n\t\t\t\t},\n\t\t\t}));\n\t\t},\n\t\tonDateOptionClick(): void\n\t\t{\n\t\t\tthis.$emit('popupStateChange', { popup: 'dateOptions', active: true });\n\n\t\t\tif (!this.menu)\n\t\t\t{\n\t\t\t\tPopupManager.getPopupById('im-notification-filter-date-option')?.destroy();\n\t\t\t\tthis.menu = new Menu({\n\t\t\t\t\tid: 'im-notification-filter-date-option',\n\t\t\t\t\tmaxHeight: 400,\n\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\titems: this.getOptionsMenuItems(),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPopupAfterClose: () => {\n\t\t\t\t\t\t\tthis.$emit('popupStateChange', { popup: 'dateOptions', active: false });\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.menu.show(this.$refs.dateOption.$el);\n\t\t\tconst popupContainer = this.menu.getPopupContainer();\n\t\t\tif (popupContainer)\n\t\t\t{\n\t\t\t\tDom.attr(popupContainer, 'data-test-id', 'im_notifications-filter__type-field-menu');\n\t\t\t}\n\t\t},\n\t\tonDateFilterClick(event: BaseEvent, toDate: boolean = false): void\n\t\t{\n\t\t\tthis.$emit('popupStateChange', { popup: 'datePicker', active: true });\n\t\t\tif (this.ignoreNextClick)\n\t\t\t{\n\t\t\t\tthis.ignoreNextClick = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.datePickerInstance = new DatePicker({\n\t\t\t\ttargetNode: event.target,\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tevents: {\n\t\t\t\t\t[DatePickerEvent.SELECT]: (pickerEvent: BaseEvent) => this.handleDatePickerSelect(pickerEvent, toDate),\n\t\t\t\t\tonHide: () => {\n\t\t\t\t\t\tthis.datePickerInstance.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tanimation: 'fading-slide',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonPopupAfterClose: () => {\n\t\t\t\t\t\t\tthis.$emit('popupStateChange', { popup: 'datePicker', active: false });\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst value = toDate ? this.secondDateValue : this.firstDateValue;\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tconst dateFormat = this.datePickerInstance.getDateFormat();\n\t\t\t\tthis.datePickerInstance.selectDates([createDate(value, dateFormat)]);\n\t\t\t}\n\n\t\t\tthis.datePickerInstance.show();\n\t\t},\n\t\tonSecondDateFilterClick(event: BaseEvent): void\n\t\t{\n\t\t\tthis.onDateFilterClick(event, true);\n\t\t},\n\t\thandleDatePickerSelect(datePickerEvent: BaseEvent, toDate: boolean = false): void\n\t\t{\n\t\t\tconst { date } = datePickerEvent.getData();\n\t\t\tconst value = this.datePickerInstance.formatDate(date);\n\n\t\t\tif (toDate)\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', {\n\t\t\t\t\tdate: this.modelValue.date || '',\n\t\t\t\t\tdateFrom: this.modelValue.dateFrom || '',\n\t\t\t\t\tdateTo: value,\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.searchType === DateFieldOption.SINGLE)\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', {\n\t\t\t\t\tdate: value,\n\t\t\t\t\tdateFrom: '',\n\t\t\t\t\tdateTo: '',\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('update:modelValue', {\n\t\t\t\tdate: this.modelValue.date || '',\n\t\t\t\tdateFrom: value,\n\t\t\t\tdateTo: this.modelValue.dateTo || '',\n\t\t\t});\n\t\t},\n\t\tonFirstDateClear(): void\n\t\t{\n\t\t\tthis.$emit('update:modelValue', {\n\t\t\t\tdate: '',\n\t\t\t\tdateFrom: '',\n\t\t\t\tdateTo: this.modelValue.dateTo || '',\n\t\t\t});\n\t\t},\n\t\tonSecondDateClear(): void\n\t\t{\n\t\t\tthis.$emit('update:modelValue', {\n\t\t\t\tdate: this.modelValue.date || '',\n\t\t\t\tdateFrom: this.modelValue.dateFrom || '',\n\t\t\t\tdateTo: '',\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-notifications-filter_field__container\">\n\t\t\t<div class=\"bx-im-notifications-filter_field__label\">{{ labelText }}</div>\n\t\t\t<div class=\"bx-im-notifications-filter_field__selector-container bx-im-content-notification-date-field-container\">\n\t\t\t\t<BInput\n\t\t\t\t\tv-model=\"dateOptionText\"\n\t\t\t\t\tclass=\"bx-im-content-notification-date-field\"\n\t\t\t\t\t:class=\"[{ '--with-margin': showFirstDateInput }, { '--range-option': showSecondDateInput }]\"\n\t\t\t\t\tref=\"dateOption\"\n\t\t\t\t\t:clickable=\"true\"\n\t\t\t\t\t:dropdown=\"true\"\n\t\t\t\t\t:size=\"InputSize.Lg\"\n\t\t\t\t\tdata-test-id=\"im_notifications-filter__date-options-container\"\n\t\t\t\t\t@click=\"onDateOptionClick\"\n\t\t\t\t/>\n\t\t\t\t<BInput\n\t\t\t\t\tv-if=\"showFirstDateInput\"\n\t\t\t\t\tv-model=\"firstDateValue\"\n\t\t\t\t\tclass=\"bx-im-content-notification-date-field\"\n\t\t\t\t\t:class=\"{'--with-margin': showSecondDateInput}\"\n\t\t\t\t\t:icon=\"OutlineIcons.CALENDAR_WITH_SLOTS\"\n\t\t\t\t\t:clickable=\"true\"\n\t\t\t\t\t:withClear=\"isFirstDateNotEmpty\"\n\t\t\t\t\t:size=\"InputSize.Lg\"\n\t\t\t\t\tdata-test-id=\"im_notifications-filter__date-from-date-container\"\n\t\t\t\t\t@clear=\"onFirstDateClear\"\n\t\t\t\t\t@click=\"onDateFilterClick\"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"showSecondDateInput\"\n\t\t\t\t\tclass=\"bx-im-content-notification-date-field-line\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"bx-im-content-notification-date-field-line-item\"/>\n\t\t\t\t</div>\n\t\t\t\t<BInput\n\t\t\t\t\tv-if=\"showSecondDateInput\"\n\t\t\t\t\tv-model=\"secondDateValue\"\n\t\t\t\t\tclass=\"bx-im-content-notification-date-field\"\n\t\t\t\t\t:icon=\"OutlineIcons.CALENDAR_WITH_SLOTS\"\n\t\t\t\t\t:clickable=\"true\"\n\t\t\t\t\t:withClear=\"isSecondDateNotEmpty\"\n\t\t\t\t\t:size=\"InputSize.Lg\"\n\t\t\t\t\tdata-test-id=\"im_notifications-filter__date-to-date-container\"\n\t\t\t\t\t@clear=\"onSecondDateClear\"\n\t\t\t\t\t@click=\"onSecondDateFilterClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { MessengerPopup } from 'im.v2.component.elements.popup';\nimport { NotificationFilterActionButtons } from './action-buttons';\nimport { NotificationFilterAuthorField } from '../fields/author-field';\nimport { NotificationFilterTypeField } from '../fields/type-field';\nimport { NotificationFilterDateField } from '../fields/date-field';\nimport 'im.v2.css.classes';\n\nimport './css/filter-popup.css';\n\nimport type { PopupOptions } from 'main.popup';\nimport type { JsonObject } from 'main.core';\n\nconst POPUP_ID = 'im-content-notification-filter-popup';\n\n// @vue/component\nexport const NotificationFilterPopup = {\n\tname: 'NotificationFilterPopup',\n\tcomponents: {\n\t\tMessengerPopup,\n\t\tNotificationFilterActionButtons,\n\t\tNotificationFilterAuthorField,\n\t\tNotificationFilterTypeField,\n\t\tNotificationFilterDateField,\n\t},\n\tprops: {\n\t\tbindElement: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tschema: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tfilterData: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({\n\t\t\t\tsearchTypes: [],\n\t\t\t\tsearchDate: {},\n\t\t\t\tsearchAuthors: [],\n\t\t\t}),\n\t\t},\n\t},\n\temits: [\n\t\t'close',\n\t\t'search',\n\t\t'reset',\n\t\t'mounted',\n\t\t'popupStateChange',\n\t],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tsearchTypes: this.filterData.searchTypes,\n\t\t\tsearchDate: this.filterData.searchDate,\n\t\t\tsearchAuthors: this.filterData.searchAuthors,\n\t\t};\n\t},\n\tcomputed: {\n\t\tpopupId: () => POPUP_ID,\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 560,\n\t\t\t\theight: 350,\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\toffsetTop: 10,\n\t\t\t\tautoHide: false,\n\t\t\t\tpadding: 0,\n\t\t\t\tcontentPadding: 0,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t},\n\t\t\t\tclassName: 'bx-im-content-notification-filter-popup',\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t};\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.$emit('mounted', this.$refs.wrapper);\n\t},\n\tmethods: {\n\t\tbuildData(): JsonObject\n\t\t{\n\t\t\treturn {\n\t\t\t\tsearchTypes: this.searchTypes,\n\t\t\t\tsearchDate: this.searchDate,\n\t\t\t\tsearchAuthors: this.searchAuthors,\n\t\t\t};\n\t\t},\n\t\tonSearchClick(): void\n\t\t{\n\t\t\tthis.$emit('search', this.buildData());\n\t\t},\n\t\tgetContentElement(): HTMLElement\n\t\t{\n\t\t\treturn this.$refs.wrapper;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<MessengerPopup\n\t\t\t:config=\"config\"\n\t\t\t:id=\"popupId\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"bx-im-content-notification-filter-popup__wrapper\"\n\t\t\t\tref=\"wrapper\"\n\t\t\t>\n\t\t\t\t<div class=\"bx-im-content-notification-filter-popup__fields-list bx-im-messenger__scope\">\n\t\t\t\t\t<NotificationFilterAuthorField\n\t\t\t\t\t\tv-model=\"searchAuthors\"\n\t\t\t\t\t\t@popupStateChange=\"$emit('popupStateChange', $event)\"\n\t\t\t\t\t/>\n\t\t\t\t\t<NotificationFilterTypeField\n\t\t\t\t\t\tv-model=\"searchTypes\"\n\t\t\t\t\t\t:schema=\"schema\"\n\t\t\t\t\t\t@popupStateChange=\"$emit('popupStateChange', $event)\"\n\t\t\t\t\t/>\n\t\t\t\t\t<NotificationFilterDateField\n\t\t\t\t\t\tv-model=\"searchDate\"\n\t\t\t\t\t\t@popupStateChange=\"$emit('popupStateChange', $event)\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<NotificationFilterActionButtons\n\t\t\t\t\t@search=\"onSearchClick\"\n\t\t\t\t\t@reset=\"this.$emit('reset')\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</MessengerPopup>\n\t`,\n};\n","import { Event, Type } from 'main.core';\n\nimport { NotificationFilterSearchInput } from './elements/search/search-input';\nimport { NotificationFilterPopup } from './elements/filter-popup';\n\nimport type { JsonObject } from 'main.core';\n\ntype SearchAuthor = {\n\tid: string,\n\tname: string,\n};\n\ntype SearchType = {\n\tid: string,\n\tname: string,\n};\n\ntype SearchDate = {\n\tdate?: string,\n\tdateFrom?: string,\n\tdateTo?: string,\n}\n\ntype NotificationFilterData = {\n\tsearchQuery?: string,\n\tsearchAuthors?: Array<SearchAuthor>,\n\tsearchTypes?: Array<SearchType>,\n\tsearchDate?: SearchDate,\n};\n\nexport const NotificationFilterFieldTypes = Object.freeze({\n\tsearchAuthors: 'searchAuthors',\n\tsearchTypes: 'searchTypes',\n\tsearchDate: 'searchDate',\n});\n\n// @vue/component\nexport const NotificationFilter = {\n\tname: 'NotificationFilter',\n\tcomponents: {\n\t\tNotificationFilterSearchInput,\n\t\tNotificationFilterPopup,\n\t},\n\tprops: {\n\t\tschema: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\temits: ['search'],\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisInputFocused: false,\n\t\t\tactivePopups: {\n\t\t\t\tauthor: false,\n\t\t\t\ttype: false,\n\t\t\t\tdateOptions: false,\n\t\t\t\tdatePicker: false,\n\t\t\t},\n\t\t\tfilterData: {\n\t\t\t\tsearchQuery: '',\n\t\t\t\tsearchAuthors: [],\n\t\t\t\tsearchTypes: [],\n\t\t\t\tsearchDate: {},\n\t\t\t},\n\t\t\tpopupElement: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tdisplayData(): JsonObject\n\t\t{\n\t\t\tconst searchTypeTitles = [];\n\t\t\tthis.filterData.searchTypes?.forEach((type) => {\n\t\t\t\tsearchTypeTitles.push(type.name);\n\t\t\t});\n\n\t\t\tconst searchAuthorNames = [];\n\t\t\tthis.filterData.searchAuthors?.forEach((type) => {\n\t\t\t\tsearchAuthorNames.push(type.name);\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\tsearchTypes: searchTypeTitles,\n\t\t\t\tsearchDate: this.filterData.searchDate,\n\t\t\t\tsearchAuthors: searchAuthorNames,\n\t\t\t};\n\t\t},\n\t},\n\twatch: {\n\t\t'filterData.searchQuery': function(value): void\n\t\t{\n\t\t\tthis.onSearchUpdate(value);\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tEvent.bind(document, 'click', this.handleClickOutside);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEvent.unbind(document, 'click', this.handleClickOutside);\n\t},\n\tmethods: {\n\t\tonInputFocus(): void\n\t\t{\n\t\t\tthis.isInputFocused = !this.isInputFocused;\n\t\t\tthis.clearActivePopups();\n\t\t},\n\t\tonPopupClose(): void\n\t\t{\n\t\t\tthis.isInputFocused = false;\n\t\t\tthis.clearActivePopups();\n\t\t},\n\t\tclearActivePopups(): void\n\t\t{\n\t\t\tthis.activePopups = {\n\t\t\t\tauthor: false,\n\t\t\t\ttype: false,\n\t\t\t\tdateOptions: false,\n\t\t\t\tdatePicker: false,\n\t\t\t};\n\t\t},\n\t\tapplyData(data: NotificationFilterData = {}, reset = false): void\n\t\t{\n\t\t\tthis.filterData = {\n\t\t\t\tsearchQuery: reset ? '' : this.filterData.searchQuery,\n\t\t\t\tsearchTypes: data.searchTypes ?? [],\n\t\t\t\tsearchDate: data.searchDate ?? {},\n\t\t\t\tsearchAuthors: data.searchAuthors ?? [],\n\t\t\t};\n\n\t\t\tconst searchTypeIds = [];\n\t\t\tif (Type.isArray(data.searchTypes))\n\t\t\t{\n\t\t\t\tdata.searchTypes.forEach((type) => {\n\t\t\t\t\tsearchTypeIds.push(type.id);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst searchAuthorIds = [];\n\t\t\tif (Type.isArray(data.searchAuthors))\n\t\t\t{\n\t\t\t\tdata.searchAuthors.forEach((author) => {\n\t\t\t\t\tsearchAuthorIds.push(author.id);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlet { dateFrom, dateTo } = data.searchDate ?? {};\n\t\t\tif (dateFrom && dateTo)\n\t\t\t{\n\t\t\t\tconst dateFromTimestamp = new Date(dateFrom).getTime();\n\t\t\t\tconst dateToTimestamp = new Date(dateTo).getTime();\n\n\t\t\t\tif (dateToTimestamp < dateFromTimestamp)\n\t\t\t\t{\n\t\t\t\t\t[dateFrom, dateTo] = [dateTo, dateFrom];\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdateFrom = '';\n\t\t\t\tdateTo = '';\n\t\t\t}\n\n\t\t\tconst valueData = {\n\t\t\t\tsearchQuery: this.filterData.searchQuery,\n\t\t\t\tsearchTypes: searchTypeIds,\n\t\t\t\tsearchDate: this.filterData.searchDate.date ?? '',\n\t\t\t\tsearchDateFrom: dateFrom,\n\t\t\t\tsearchDateTo: dateTo,\n\t\t\t\tsearchAuthors: searchAuthorIds,\n\t\t\t};\n\n\t\t\tthis.$emit('search', valueData);\n\t\t},\n\t\tonPopupUpdate(data): void\n\t\t{\n\t\t\tthis.applyData(data);\n\t\t\tthis.isInputFocused = false;\n\t\t},\n\t\tonFilterReset(): void\n\t\t{\n\t\t\tthis.applyData({}, true);\n\t\t\tthis.isInputFocused = false;\n\t\t},\n\t\tonSearchUpdate(): void\n\t\t{\n\t\t\tthis.isInputFocused = false;\n\t\t\tthis.applyData(this.filterData);\n\t\t},\n\t\tonTagsRemove(keys: Array<string>): void\n\t\t{\n\t\t\tkeys.forEach((key) => {\n\t\t\t\tswitch (key)\n\t\t\t\t{\n\t\t\t\t\tcase NotificationFilterFieldTypes.searchTypes:\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.filterData.searchTypes = [];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcase NotificationFilterFieldTypes.searchDate:\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.filterData.searchDate = {};\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcase NotificationFilterFieldTypes.searchAuthors:\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.filterData.searchAuthors = [];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.isInputFocused = false;\n\t\t\tthis.applyData(this.filterData);\n\t\t},\n\t\tonPopupStateChange({ popup, active }): void\n\t\t{\n\t\t\tthis.activePopups[popup] = active;\n\t\t},\n\t\thandleClickOutside(event: MouseEvent): void\n\t\t{\n\t\t\tif (!this.isInputFocused)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst isAnyDialogActive = Object.values(this.activePopups).some(\n\t\t\t\t(active) => active,\n\t\t\t);\n\t\t\tif (isAnyDialogActive)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst inputElement = this.getInputElement();\n\t\t\tconst clickedInsideInput = inputElement?.contains(event.target);\n\t\t\tconst clickedInsidePopup = this.popupElement?.contains(event.target);\n\n\t\t\tif (!clickedInsideInput && !clickedInsidePopup)\n\t\t\t{\n\t\t\t\tthis.isInputFocused = false;\n\t\t\t}\n\t\t},\n\t\tgetInputElement(): HTMLElement\n\t\t{\n\t\t\treturn this.$refs.searchInput;\n\t\t},\n\t\tonPopupMounted(element): void\n\t\t{\n\t\t\tthis.popupElement = element;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div ref=\"searchInput\">\n\t\t\t<NotificationFilterSearchInput\n\t\t\t\t:displayData=\"displayData\"\n\t\t\t\tv-model=\"filterData.searchQuery\"\n\t\t\t\t@clear=\"onFilterReset\"\n\t\t\t\t@remove=\"onTagsRemove\"\n\t\t\t\t@click=\"onInputFocus\"\n\t\t\t/>\n\t\t</div>\n\t\t<NotificationFilterPopup\n\t\t\tv-if=\"isInputFocused\"\n\t\t\t:schema=\"schema\"\n\t\t\t:bindElement=\"getInputElement()\"\n\t\t\t:filterData=\"filterData\"\n\t\t\t@search=\"onPopupUpdate\"\n\t\t\t@reset=\"onFilterReset\"\n\t\t\t@close=\"onPopupClose\"\n\t\t\t@mounted=\"onPopupMounted\"\n\t\t\t@popupStateChange=\"onPopupStateChange\"\n\t\t\tref=\"filterPopup\"\n\t\t/>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { UserManager } from 'im.v2.lib.user';\nimport { Logger } from 'im.v2.lib.logger';\nimport { RestMethod } from 'im.v2.const';\n\nconst LIMIT_PER_PAGE = 50;\n\nexport class NotificationSearchService\n{\n\tsearchQuery: string = '';\n\tsearchTypes: Array = [];\n\tsearchDate: Date = null;\n\tsearchDateFrom: Date = null;\n\tsearchDateTo: Date = null;\n\tsearchAuthors: Array = [];\n\n\tstore: Object = null;\n\trestClient: Object = null;\n\tuserManager: Object = null;\n\tisLoading: boolean = false;\n\n\tlastId: number = 0;\n\thasMoreItemsToLoad: boolean = true;\n\n\tconstructor()\n\t{\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t\tthis.userManager = new UserManager();\n\t}\n\n\tloadFirstPage({\n\t\tsearchQuery,\n\t\tsearchAuthors,\n\t\tsearchTypes,\n\t\tsearchDate,\n\t\tsearchDateFrom,\n\t\tsearchDateTo,\n\t}): Promise\n\t{\n\t\tthis.isLoading = true;\n\n\t\tthis.searchQuery = searchQuery;\n\t\tthis.searchAuthors = searchAuthors;\n\t\tthis.searchTypes = searchTypes;\n\t\tthis.searchDate = searchDate;\n\t\tthis.searchDateFrom = searchDateFrom;\n\t\tthis.searchDateTo = searchDateTo;\n\n\t\treturn this.requestItems({ firstPage: true });\n\t}\n\n\tloadNextPage(): Promise\n\t{\n\t\tif (this.isLoading || !this.hasMoreItemsToLoad)\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tthis.isLoading = true;\n\n\t\treturn this.requestItems();\n\t}\n\n\tsearchInModel({\n\t\tsearchQuery,\n\t\tsearchAuthors,\n\t\tsearchTypes,\n\t\tsearchDate,\n\t\tsearchDateFrom,\n\t\tsearchDateTo,\n\t}): Array\n\t{\n\t\tthis.searchQuery = searchQuery;\n\t\tthis.searchAuthors = searchAuthors;\n\t\tthis.searchTypes = searchTypes;\n\t\tthis.searchDate = searchDate;\n\t\tthis.searchDateFrom = searchDateFrom;\n\t\tthis.searchDateTo = searchDateTo;\n\n\t\treturn this.store.getters['notifications/getSortedCollection'].filter((item) => {\n\t\t\tlet result = false;\n\t\t\tif (this.searchQuery?.length >= 3)\n\t\t\t{\n\t\t\t\tresult = item.text.toLowerCase().includes(this.searchQuery.toLowerCase());\n\t\t\t\tif (!result)\n\t\t\t\t{\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.searchTypes?.length > 0)\n\t\t\t{\n\t\t\t\tconst settingPrefix = item.settingName.split('|')[0];\n\t\t\t\tresult = this.searchTypes.includes(settingPrefix);\n\t\t\t\tif (!result)\n\t\t\t\t{\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.searchDateFrom !== '' && this.searchDateTo !== '')\n\t\t\t{\n\t\t\t\tconst fromDate = BX.parseDate(this.searchDateFrom);\n\t\t\t\tconst toDate = BX.parseDate(this.searchDateTo);\n\n\t\t\t\tif (fromDate instanceof Date && toDate instanceof Date)\n\t\t\t\t{\n\t\t\t\t\tconst itemDateForCompare = (new Date(item.date.getTime())).setHours(0, 0, 0, 0);\n\t\t\t\t\tconst fromDateForCompare = fromDate.setHours(0, 0, 0, 0);\n\t\t\t\t\tconst toDateForCompare = toDate.setHours(0, 0, 0, 0);\n\n\t\t\t\t\tresult = itemDateForCompare >= fromDateForCompare && itemDateForCompare <= toDateForCompare;\n\t\t\t\t\tif (!result)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.searchDate !== '')\n\t\t\t{\n\t\t\t\tconst date = BX.parseDate(this.searchDate);\n\t\t\t\tif (date instanceof Date)\n\t\t\t\t{\n\t\t\t\t\tconst itemDateForCompare = (new Date(item.date.getTime())).setHours(0, 0, 0, 0);\n\t\t\t\t\tconst dateFromInput = date.setHours(0, 0, 0, 0);\n\n\t\t\t\t\tresult = itemDateForCompare === dateFromInput;\n\t\t\t\t\tif (!result)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.searchAuthors?.length > 0)\n\t\t\t{\n\t\t\t\tresult = this.searchAuthors.includes(item.authorId);\n\t\t\t\tif (!result)\n\t\t\t\t{\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t});\n\t}\n\n\trequestItems({ firstPage = false } = {}): Promise\n\t{\n\t\tconst queryParams = this.getSearchRequestParams(firstPage);\n\n\t\treturn this.restClient.callMethod(RestMethod.imNotifyHistorySearch, queryParams)\n\t\t\t.then((response) => {\n\t\t\t\tconst responseData = response.data();\n\t\t\t\tLogger.warn('im.notify.history.search: first page results', responseData);\n\t\t\t\tthis.hasMoreItemsToLoad = !this.isLastPage(responseData.notifications);\n\t\t\t\tif (!responseData || responseData.notifications.length === 0)\n\t\t\t\t{\n\t\t\t\t\tLogger.warn('im.notify.get: no notifications', responseData);\n\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tthis.lastId = this.getLastItemId(responseData.notifications);\n\n\t\t\t\tthis.userManager.setUsersToModel(responseData.users);\n\t\t\t\tthis.isLoading = false;\n\n\t\t\t\treturn responseData.notifications;\n\t\t\t}).catch((result: RestResult) => {\n\t\t\t\tconsole.error('NotificationService: requestItems error', result.error());\n\t\t\t});\n\t}\n\n\tgetSearchRequestParams(firstPage: boolean): Object\n\t{\n\t\tconst requestParams = {\n\t\t\tSEARCH_TEXT: this.searchQuery,\n\t\t\tSEARCH_TYPES: this.searchTypes,\n\t\t\tSEARCH_AUTHORS: this.searchAuthors,\n\t\t\tLIMIT: LIMIT_PER_PAGE,\n\t\t\tCONVERT_TEXT: 'Y',\n\t\t};\n\n\t\tif (\n\t\t\tBX.parseDate(this.searchDateFrom) instanceof Date\n\t\t\t&& BX.parseDate(this.searchDateTo) instanceof Date\n\t\t)\n\t\t{\n\t\t\trequestParams.SEARCH_DATE_FROM = BX.parseDate(this.searchDateFrom).toISOString();\n\t\t\trequestParams.SEARCH_DATE_TO = BX.parseDate(this.searchDateTo).toISOString();\n\t\t}\n\t\telse if (BX.parseDate(this.searchDate) instanceof Date)\n\t\t{\n\t\t\trequestParams.SEARCH_DATE = BX.parseDate(this.searchDate).toISOString();\n\t\t}\n\n\t\tif (!firstPage)\n\t\t{\n\t\t\trequestParams.LAST_ID = this.lastId;\n\t\t}\n\n\t\treturn requestParams;\n\t}\n\n\tgetLastItemId(collection: Array<Object>): number\n\t{\n\t\treturn collection[collection.length - 1].id;\n\t}\n\n\tisLastPage(notifications: Array): boolean\n\t{\n\t\treturn !Type.isArrayFilled(notifications) || notifications.length < LIMIT_PER_PAGE;\n\t}\n\n\tdestroy()\n\t{\n\t\tLogger.warn('Notification search service destroyed');\n\t}\n}\n","import 'main.polyfill.intersectionobserver';\nimport { Dom, Event, Runtime, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { mapState } from 'ui.vue3.vuex';\n\nimport { Logger } from 'im.v2.lib.logger';\nimport { NotificationTypesCodes, Settings } from 'im.v2.const';\nimport { NotificationService } from 'im.v2.provider.service.notification';\nimport { UserListPopup } from 'im.v2.component.elements.user-list-popup';\nimport { Loader } from 'im.v2.component.elements.loader';\nimport { Utils } from 'im.v2.lib.utils';\nimport { SpecialBackground, ThemeManager, type BackgroundStyle } from 'im.v2.lib.theme';\nimport { NotificationHeaderMenu } from './classes/notification-header-menu';\nimport { NotificationMenu } from './classes/notification-menu';\n\nimport { NotificationComponents } from './components';\nimport { ItemPlaceholder } from './components/elements/placeholder';\nimport { ScrollButton } from './components/elements/scroll-button';\nimport { NotificationFilter } from './filter/notification-filter';\nimport { NotificationSearchService } from './classes/notification-search-service';\nimport { NotificationReadService } from './classes/notification-read-service';\n\nimport './css/notification-content.css';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelNotification } from 'im.v2.model';\nimport type { BitrixVueComponentProps } from 'ui.vue3';\n\n// @vue/component\nexport const NotificationContent = {\n\tname: 'NotificationContent',\n\tcomponents:\n\t{\n\t\tItemPlaceholder,\n\t\tScrollButton,\n\t\tNotificationFilter,\n\t\tUserListPopup,\n\t\tLoader,\n\t},\n\tdirectives:\n\t{\n\t\t'notifications-item-observer':\n\t\t{\n\t\t\tmounted(element, binding)\n\t\t\t{\n\t\t\t\tbinding.instance.observer.observe(element);\n\t\t\t},\n\t\t\tbeforeUnmount(element, binding)\n\t\t\t{\n\t\t\t\tbinding.instance.observer.unobserve(element);\n\t\t\t},\n\t\t},\n\t},\n\tdata(): JsonObject\n\t{\n\t\treturn {\n\t\t\tisInitialLoading: false,\n\t\t\tinitialLoadComplete: false,\n\t\t\treadQueue: new Set(),\n\t\t\tisNextPageLoading: false,\n\t\t\tnotificationsOnScreen: new Set(),\n\t\t\tmarkedAsUnreadIds: new Set(),\n\n\t\t\twindowFocused: false,\n\t\t\tshowSearchResult: false,\n\n\t\t\tpopupBindElement: null,\n\t\t\tshowUserListPopup: false,\n\t\t\tuserListIds: null,\n\n\t\t\tschema: {},\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tNotificationTypesCodes: () => NotificationTypesCodes,\n\t\tnotificationCollection(): ImModelNotification[]\n\t\t{\n\t\t\treturn this.$store.getters['notifications/getSortedCollection'];\n\t\t},\n\t\tconfirmNotifications(): ImModelNotification[]\n\t\t{\n\t\t\treturn this.notifications.filter((notification) => {\n\t\t\t\treturn notification.sectionCode === NotificationTypesCodes.confirm;\n\t\t\t});\n\t\t},\n\t\thasConfirmNotifications(): boolean\n\t\t{\n\t\t\treturn this.confirmNotifications.length > 0;\n\t\t},\n\t\tsimpleNotifications(): ImModelNotification[]\n\t\t{\n\t\t\treturn this.notifications.filter((notification) => {\n\t\t\t\treturn notification.sectionCode !== NotificationTypesCodes.confirm;\n\t\t\t});\n\t\t},\n\t\tconfirmNotificationsCounter(): number\n\t\t{\n\t\t\treturn this.confirmNotifications.length;\n\t\t},\n\t\tformattedCounter(): string\n\t\t{\n\t\t\treturn this.confirmNotificationsCounter > 99 ? '99+' : String(this.confirmNotificationsCounter);\n\t\t},\n\t\tsearchResultCollection(): ImModelNotification[]\n\t\t{\n\t\t\treturn this.$store.getters['notifications/getSearchResultCollection'];\n\t\t},\n\t\tnotifications(): ImModelNotification[]\n\t\t{\n\t\t\tif (this.showSearchResult)\n\t\t\t{\n\t\t\t\treturn this.searchResultCollection;\n\t\t\t}\n\n\t\t\treturn this.notificationCollection;\n\t\t},\n\t\tisReadAllAvailable(): boolean\n\t\t{\n\t\t\tif (this.showSearchResult)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.unreadCounter > 0;\n\t\t},\n\t\tisEmptyState(): boolean\n\t\t{\n\t\t\treturn this.notifications.length === 0 && !this.isInitialLoading && !this.isNextPageLoading;\n\t\t},\n\t\temptyStateIcon(): string\n\t\t{\n\t\t\treturn this.showSearchResult\n\t\t\t\t? 'bx-im-content-notification__not-found-icon'\n\t\t\t\t: 'bx-im-content-notification__empty-state-icon'\n\t\t\t;\n\t\t},\n\t\temptyStateTitle(): string\n\t\t{\n\t\t\treturn this.showSearchResult\n\t\t\t\t? this.$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_SEARCH_RESULTS_NOT_FOUND')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_NO_NEW_ITEMS')\n\t\t\t;\n\t\t},\n\t\tenableAutoRead(): boolean\n\t\t{\n\t\t\treturn this.$store.getters['application/settings/get'](Settings.notification.enableAutoRead);\n\t\t},\n\t\t...mapState({\n\t\t\tunreadCounter: (state) => state.notifications.unreadCounter,\n\t\t}),\n\t},\n\tcreated()\n\t{\n\t\tthis.notificationService = new NotificationService();\n\t\tthis.notificationSearchService = new NotificationSearchService();\n\t\tthis.notificationReadService = new NotificationReadService();\n\t\tthis.headerMenu = new NotificationHeaderMenu();\n\t\tthis.searchOnServerDelayed = Runtime.debounce(this.searchOnServer, 1500, this);\n\n\t\tEvent.bind(window, 'focus', this.onWindowFocus);\n\t\tEvent.bind(window, 'blur', this.onWindowBlur);\n\n\t\tthis.initObserver();\n\n\t\tEventEmitter.subscribe(\n\t\t\tNotificationMenu.events.markAsUnreadClick,\n\t\t\tthis.onMarkAsUnreadClick,\n\t\t);\n\t},\n\tasync mounted()\n\t{\n\t\tthis.isInitialLoading = true;\n\t\tthis.windowFocused = document.hasFocus();\n\n\t\tthis.schema = await this.notificationService.loadFirstPage();\n\t\tthis.isInitialLoading = false;\n\t\tthis.initialLoadComplete = true;\n\t\tthis.processReadQueue();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tif (this.initialLoadComplete && this.enableAutoRead)\n\t\t{\n\t\t\tthis.notificationReadService.readAll([...this.markedAsUnreadIds]);\n\t\t}\n\n\t\tthis.notificationService.destroy();\n\t\tthis.notificationSearchService.destroy();\n\t\tthis.notificationReadService.destroy();\n\n\t\tif (this.headerMenu)\n\t\t{\n\t\t\tthis.headerMenu.destroy();\n\t\t}\n\n\t\tEvent.unbind(window, 'focus', this.onWindowFocus);\n\t\tEvent.unbind(window, 'blur', this.onWindowBlur);\n\n\t\tEventEmitter.unsubscribe(\n\t\t\tNotificationMenu.events.markAsUnreadClick,\n\t\t\tthis.onMarkAsUnreadClick,\n\t\t);\n\t},\n\tmethods:\n\t{\n\t\tinitObserver()\n\t\t{\n\t\t\tthis.observer = new IntersectionObserver((entries) => {\n\t\t\t\tentries.forEach((entry) => {\n\t\t\t\t\tconst notificationId = Number.parseInt(entry.target.dataset.id, 10);\n\t\t\t\t\tif (!entry.isIntersecting)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.notificationsOnScreen.delete(notificationId);\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tentry.intersectionRatio >= 0.7\n\t\t\t\t\t\t|| (entry.intersectionRatio > 0 && entry.intersectionRect.height > entry.rootBounds.height / 2)\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.read(notificationId);\n\t\t\t\t\t\tthis.notificationsOnScreen.add(notificationId);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.notificationsOnScreen.delete(notificationId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, {\n\t\t\t\troot: this.$refs.listNotifications,\n\t\t\t\tthreshold: Array.from({ length: 101 }).fill(0).map((zero, index) => index * 0.01),\n\t\t\t});\n\t\t},\n\t\tread(notificationIds: number | number[])\n\t\t{\n\t\t\tif (!this.enableAutoRead)\n\t\t\t{\n\t\t\t\tLogger.warn('Notifications: Auto read is disabled!');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.windowFocused)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (Type.isNumber(notificationIds))\n\t\t\t{\n\t\t\t\tnotificationIds = [notificationIds];\n\t\t\t}\n\n\t\t\tif (!this.initialLoadComplete)\n\t\t\t{\n\t\t\t\tnotificationIds.forEach((id: number) => this.readQueue.add(id));\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst simpleNotificationIds = notificationIds.filter((notificationId) => {\n\t\t\t\tconst notification = this.$store.getters['notifications/getById'](notificationId);\n\n\t\t\t\treturn notification.sectionCode !== NotificationTypesCodes.confirm;\n\t\t\t});\n\n\t\t\tif (simpleNotificationIds.length > 0)\n\t\t\t{\n\t\t\t\tthis.notificationReadService.addToReadQueue(simpleNotificationIds);\n\t\t\t\tthis.notificationReadService.read();\n\t\t\t}\n\t\t},\n\t\tprocessReadQueue()\n\t\t{\n\t\t\tif (this.readQueue.size === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.warn(`Processing initial read queue with ${this.readQueue.size} items.`);\n\t\t\tconst idsToRead = [...this.readQueue];\n\t\t\tthis.readQueue.clear();\n\n\t\t\tthis.read(idsToRead);\n\t\t},\n\t\tasync searchOnServer(event)\n\t\t{\n\t\t\tconst result = await this.notificationSearchService.loadFirstPage(event);\n\t\t\tthis.isNextPageLoading = false;\n\t\t\tthis.setSearchResult(result);\n\t\t},\n\t\tsetSearchResult(items: Array)\n\t\t{\n\t\t\tthis.$store.dispatch('notifications/setSearchResult', {\n\t\t\t\tnotifications: items,\n\t\t\t});\n\t\t},\n\t\tgetComponentForItem(notification: ImModelNotification): BitrixVueComponentProps\n\t\t{\n\t\t\tconst componentId = notification.params?.componentId;\n\t\t\tif (componentId && NotificationComponents[componentId])\n\t\t\t{\n\t\t\t\treturn NotificationComponents[componentId];\n\t\t\t}\n\n\t\t\treturn NotificationComponents.CompatibilityEntity;\n\t\t},\n\t\tonScrollButtonClick(offset)\n\t\t{\n\t\t\tthis.$refs.listNotifications.scroll({\n\t\t\t\ttop: offset,\n\t\t\t\tbehavior: 'smooth',\n\t\t\t});\n\t\t},\n\t\tonScroll(event)\n\t\t{\n\t\t\tNotificationMenu.closeMenuOnScroll();\n\n\t\t\tthis.showUserListPopup = false;\n\n\t\t\tif (this.showSearchResult)\n\t\t\t{\n\t\t\t\tthis.onScrollSearchResult(event);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.onScrollNotifications(event);\n\t\t\t}\n\t\t},\n\t\tonClickHeaderMenu(event: BaseEvent): void\n\t\t{\n\t\t\tthis.headerMenu.openMenu(this.isReadAllAvailable, event.currentTarget);\n\t\t},\n\t\tonScrollNotifications(event)\n\t\t{\n\t\t\tif (\n\t\t\t\t!Utils.dom.isOneScreenRemaining(event.target)\n\t\t\t\t|| !this.notificationService.hasMoreItemsToLoad\n\t\t\t\t|| this.isInitialLoading\n\t\t\t\t|| this.isNextPageLoading\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isNextPageLoading = true;\n\t\t\tthis.notificationService.loadNextPage().then(() => {\n\t\t\t\tthis.isNextPageLoading = false;\n\t\t\t});\n\t\t},\n\t\tasync onScrollSearchResult(event)\n\t\t{\n\t\t\tif (\n\t\t\t\t!Utils.dom.isOneScreenRemaining(event.target)\n\t\t\t\t|| !this.notificationSearchService.hasMoreItemsToLoad\n\t\t\t\t|| this.isInitialLoading\n\t\t\t\t|| this.isNextPageLoading\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isNextPageLoading = true;\n\t\t\tconst result = await this.notificationSearchService.loadNextPage();\n\t\t\tthis.isNextPageLoading = false;\n\t\t\tthis.setSearchResult(result);\n\t\t},\n\t\tonConfirmButtonsClick(button: { id: string, value: string})\n\t\t{\n\t\t\tconst { id, value } = button;\n\t\t\tconst notificationId = Number.parseInt(id, 10);\n\n\t\t\tthis.notificationsOnScreen.delete(notificationId);\n\t\t\tthis.notificationService.sendConfirmAction(notificationId, value);\n\t\t},\n\t\tonDeleteClick(notificationId: number)\n\t\t{\n\t\t\tthis.notificationsOnScreen.delete(notificationId);\n\t\t\tthis.notificationService.delete(notificationId);\n\t\t},\n\t\tonMoreUsersClick(event)\n\t\t{\n\t\t\tLogger.warn('onMoreUsersClick', event);\n\t\t\tthis.popupBindElement = event.event.target;\n\t\t\tthis.userListIds = event.users;\n\t\t\tthis.showUserListPopup = true;\n\t\t},\n\t\tonSearch(event)\n\t\t{\n\t\t\tif (\n\t\t\t\tevent.searchQuery?.length < 3\n\t\t\t\t&& event.searchTypes?.length === 0\n\t\t\t\t&& event.searchDate === ''\n\t\t\t\t&& (event.searchDateFrom === '' || event.searchDateTo === '')\n\t\t\t\t&& event.searchAuthors?.length === 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.showSearchResult = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.showSearchResult = true;\n\t\t\tconst localResult = this.notificationSearchService.searchInModel(event);\n\t\t\tthis.$store.dispatch('notifications/clearSearchResult');\n\t\t\tthis.$store.dispatch('notifications/setSearchResult', { notifications: localResult, skipValidation: true });\n\n\t\t\tthis.isNextPageLoading = true;\n\t\t\tthis.searchOnServerDelayed(event);\n\t\t},\n\t\tonSendQuickAnswer(event)\n\t\t{\n\t\t\tthis.notificationService.sendQuickAnswer(event);\n\t\t},\n\t\tonWindowFocus()\n\t\t{\n\t\t\tthis.windowFocused = true;\n\t\t\tthis.read([...this.notificationsOnScreen]);\n\t\t},\n\t\tonWindowBlur()\n\t\t{\n\t\t\tthis.windowFocused = false;\n\t\t},\n\t\tonLeave(element, done)\n\t\t{\n\t\t\tconst ANIMATION_DURATION_MS = 250;\n\n\t\t\tconst { height } = element.getBoundingClientRect();\n\t\t\tDom.style(element, 'height', `${height}px`);\n\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tDom.addClass(element, '--leave');\n\t\t\t\tDom.style(element, 'height', '0px');\n\t\t\t});\n\n\t\t\tsetTimeout(done, ANIMATION_DURATION_MS);\n\t\t},\n\t\tonDoubleClick(notificationId: number)\n\t\t{\n\t\t\tconst notification = this.$store.getters['notifications/getById'](notificationId) || this.$store.getters['notifications/getSearchItemById'](notificationId);\n\n\t\t\tif (!notification)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEvent.EventEmitter.emit(NotificationMenu.events.markAsUnreadClick, notification);\n\t\t},\n\t\tonMarkAsUnreadClick(event: BaseEvent): void\n\t\t{\n\t\t\tconst notification = event.getData();\n\n\t\t\tif (!notification)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst notificationId = notification.id;\n\n\t\t\tif (notification.read)\n\t\t\t{\n\t\t\t\tthis.markedAsUnreadIds.add(notificationId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.markedAsUnreadIds.delete(notificationId);\n\t\t\t}\n\t\t},\n\t\tgetNotificationsBackgroundStyle(): BackgroundStyle\n\t\t{\n\t\t\treturn ThemeManager.getBackgroundStyleById(SpecialBackground.notifications);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-content-notification__container --ui-context-content-light\">\n\t\t\t<div class=\"bx-im-content-notification__header-container\">\n\t\t\t\t<div class=\"bx-im-content-notification__header\">\n\t\t\t\t\t<div class=\"bx-im-content-notification__header-left-container\">\n\t\t\t\t\t\t<div class=\"bx-im-content-notification__header-panel-container\">\n\t\t\t\t\t\t\t<div class=\"bx-im-content-notification__panel-title_icon\"></div>\n\t\t\t\t\t\t\t<div class=\"bx-im-content-notification__panel_text\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_NOTIFICATIONS_HEADER') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<NotificationFilter\n\t\t\t\t\t\t\tv-if=\"this.initialLoadComplete && notificationCollection.length > 0\"\n\t\t\t\t\t\t\t:schema=\"schema\"\n\t\t\t\t\t\t\t@search=\"onSearch\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"notificationCollection.length > 0\" class=\"bx-im-content-notification__header-buttons-container\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"bx-im-content-notification__header-menu\"\n\t\t\t\t\t\t\t@click=\"onClickHeaderMenu\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-content-notification__elements-container\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"bx-im-content-notification__elements\"\n\t\t\t\t\t@scroll.passive=\"onScroll\"\n\t\t\t\t\tref=\"listNotifications\"\n\t\t\t\t\t:style=\"getNotificationsBackgroundStyle()\"\n\t\t\t\t>\n\t\t\t\t\t<div v-if=\"hasConfirmNotifications\" class=\"bx-im-content-notification__elements-group\">\n\t\t\t\t\t\t <div class=\"bx-im-content-notification__elements-title\">\n\t\t\t\t\t\t\t {{ $Bitrix.Loc.getMessage('IM_NOTIFICATIONS_GROUP_TITLE') }}\n\t\t\t\t\t\t\t <div\n\t\t\t\t\t\t\t\t class=\"bx-im-content-notification__elements-group-counter\"\n\t\t\t\t\t\t\t >\n\t\t\t\t\t\t\t\t {{ formattedCounter }}\n\t\t\t\t\t\t\t </div>\n\t\t\t\t\t\t </div>\n\t\t\t\t\t\t<TransitionGroup \n\t\t\t\t\t\t\tname=\"notification-confirm-item\"\n\t\t\t\t\t\t\ttag=\"div\" \n\t\t\t\t\t\t\t@leave=\"onLeave\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t\tv-for=\"notification in confirmNotifications\"\n\t\t\t\t\t\t\t\t:is=\"getComponentForItem(notification)\"\n\t\t\t\t\t\t\t\t:key=\"notification.id\"\n\t\t\t\t\t\t\t\t:data-id=\"notification.id\"\n\t\t\t\t\t\t\t\t:notification=\"notification\"\n\t\t\t\t\t\t\t\t@confirmButtonsClick=\"onConfirmButtonsClick\"\n\t\t\t\t\t\t\t\t@deleteClick=\"onDeleteClick\"\n\t\t\t\t\t\t\t\t@moreUsersClick=\"onMoreUsersClick\"\n\t\t\t\t\t\t\t\t@sendQuickAnswer=\"onSendQuickAnswer\"\n\t\t\t\t\t\t\t\tv-notifications-item-observer\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</TransitionGroup>\n\t\t\t\t\t</div>\n\t\t\t\t\t<TransitionGroup \n\t\t\t\t\t\tname=\"notification-simple-item\"\n\t\t\t\t\t\ttag=\"div\"\n\t\t\t\t\t\t@leave=\"onLeave\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<component\n\t\t\t\t\t\t\tv-for=\"notification in simpleNotifications\"\n\t\t\t\t\t\t\t:is=\"getComponentForItem(notification)\"\n\t\t\t\t\t\t\t:key=\"notification.id\"\n\t\t\t\t\t\t\t:data-id=\"notification.id\"\n\t\t\t\t\t\t\t:notification=\"notification\"\n\t\t\t\t\t\t\t@confirmButtonsClick=\"onConfirmButtonsClick\"\n\t\t\t\t\t\t\t@deleteClick=\"onDeleteClick\"\n\t\t\t\t\t\t\t@moreUsersClick=\"onMoreUsersClick\"\n\t\t\t\t\t\t\t@sendQuickAnswer=\"onSendQuickAnswer\"\n\t\t\t\t\t\t\t@dblclick=\"onDoubleClick(notification.id)\"\n\t\t\t\t\t\t\tv-notifications-item-observer\n\t\t\t\t\t\t/>\n\t\t\t\t\t</TransitionGroup>\n\t\t\t\t\t<div v-if=\"isEmptyState\" class=\"bx-im-content-notification__empty-state-container\">\n\t\t\t\t\t\t<div :class=\"emptyStateIcon\"></div>\n\t\t\t\t\t\t<span class=\"bx-im-content-notification__empty-state-title\">\n\t\t\t\t\t\t\t{{ emptyStateTitle }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ItemPlaceholder v-if=\"isInitialLoading\" />\n\t\t\t\t\t<div v-if=\"isNextPageLoading\" class=\"bx-im-content-notification__loader-container\">\n\t\t\t\t\t\t<Loader />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<ScrollButton\n\t\t\t\t\tv-if=\"!isInitialLoading || !isNextPageLoading\"\n\t\t\t\t\t:unreadCounter=\"unreadCounter\"\n\t\t\t\t\t:notificationsOnScreen=\"notificationsOnScreen\"\n\t\t\t\t\t@scrollButtonClick=\"onScrollButtonClick\"\n\t\t\t\t/>\n\t\t\t\t<UserListPopup\n\t\t\t\t\tv-if=\"showUserListPopup\"\n\t\t\t\t\t:userIds=\"userListIds\"\n\t\t\t\t\t:bindElement=\"popupBindElement\"\n\t\t\t\t\t:showPopup=\"showUserListPopup\"\n\t\t\t\t\t@close=\"showUserListPopup = false\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n"],"names":["NotificationReadService","constructor","itemsToRead","Set","changeReadStatusBlockTimeout","store","Core","getStore","restClient","getRestClient","readOnClientWithDebounce","Runtime","debounce","readOnClient","readRequestWithDebounce","readRequest","addToReadQueue","notificationIds","Type","isArrayFilled","forEach","id","isNumber","notification","getters","read","add","size","allNotifications","confirmNotifications","filter","sectionCode","NotificationTypesCodes","confirm","confirmNotificationIds","map","allIdsToRead","notificationsToReadIds","has","length","clear","params","ids","runAction","RestMethod","imV2NotifyRead","data","then","response","Logger","warn","catch","result","console","error","dispatch","readAll","excludeIds","imV2NotifyReadAll","currentCounter","newCounter","counter","changeReadStatus","notificationId","fromSearchCollection","commit","fields","clearTimeout","setTimeout","callMethod","imNotifyRead","action","only_current","destroy","NotificationHeaderMenu","notificationReadService","openMenu","isReadAllAvailable","bindElement","menu","Menu","items","getHeaderMenuItems","closeOnItemClick","autoHide","show","getOptionsItem","getReadAllItem","title","Loc","getMessage","design","MenuItemDesign","Default","Disabled","onClick","close","Messenger","openSettings","onlyPanel","SettingsSection","NotificationMenu","closeMenuOnScroll","lastMenu","e","lastMenuId","notificationItem","getPopup","isShown","events","onClose","onDestroy","toggleSubscription","currentSettings","typesToRestore","settingsToUnsubscribe","lastSubscribedTypes","shouldSubscribe","SettingsService","Notifier","onUnsubscribeComplete","label","event","balloon","settingsToResubscribe","Analytics","getInstance","onUnsubscribeFromNotification","moduleId","notifyModule","optionName","notifyEvent","settingsToSubscribe","onSubscribeComplete","isEmpty","prevItem","Boolean","Event","EventEmitter","emit","markAsUnreadClick","notificationsSettings","Settings","notifications","settingName","split","disabled","includes","NotificationSettingsType","web","notifyButtons","settings","type","Object","values","NotificationType","freeze","changed","grid","text","users","DefaultNotificationIconTitleClass","calendar","task","CrmNotificationIconTitleClass","default","deal","lead","contact","quote","company","order","process","call","meeting","mail","invoice","SonetNotificationIconTitleClass","newsfeed","wiki","vote","group","BizprocNotificationIconTitleClass","bizproc","customSection","DetailedAdditionalText","name","props","notificationParams","required","computed","entity","content","additionalText","Parser","decodeNotificationParam","hasAdditionalText","template","gridIconClassesMap","date","OutlineIcons","CALENDAR_WITH_SLOTS","place","MEETING_POINT","repeat","REPEAT","user","PERSON","INFO_CIRCLE","NotificationGridItemTypeIcon","DetailedGrid","components","BIcon","notificationType","contentType","isGridType","formattedItems","item","$store","Number","value","methods","getIconClass","itemType","getUserImage","backgroundImage","avatar","getItemValue","isUserItem","isUserHasAvatar","getUserLink","Utils","getProfileLink","DetailedText","isTextType","valueText","DetailedTitle","icon","String","color","href","showDetailedTitle","hasHref","DetailedChangedValue","isChangedType","prevValue","prev","nextValue","next","MAX_USERS_TO_DISPLAY","DetailedUsers","isUsersType","allUserIds","usersToDisplay","slice","remainingCount","formattedText","replace","join","link","userHref","Text","encode","Dom","create","tag","className","target","outerHTML","QuickAnswer","UiButton","emits","quickAnswerText","quickAnswerResultMessage","showQuickAnswer","isSending","successSentQuickAnswer","ButtonSize","ButtonColor","AirButtonStyle","toggleQuickAnswer","$nextTick","$refs","focus","sendQuickAnswer","trim","$emit","callbackSuccess","result_message","resultMessage","message","callbackError","ItemConfirmButtons","buttons","Array","preparedButtons","button","COMMAND_PARAMS","decode","TEXT","click","getButtonStyle","FILLED","OUTLINE_NO_ACCENT","NotificationSystemIconClasses","biconector","app","flow","sign","videoConf","openLines","voximplant","booking","b24","tariff","disk","crm","smartProcess","timeline","NotificationIconModuleClasses","blog","socialnetwork","imconnector","imopenlines","voximplantcontroller","intranet","sender","bitrix24","ItemAvatar","ChatAvatar","AvatarSize","isSystem","userId","authorId","userDialogId","toString","systemIconClass","systemIcon","componentParams","isStringFilled","ItemActions","canDelete","areActionsAvailable","isMenuEmpty","notificationMenu","created","onDeleteClick","onMenuButtonClick","currentTarget","onMenuClose","isMenuShown","ItemReaction","reaction","reactionClass","ReactionIconClass","AUTHOR_PLACEHOLDER","ItemSubject","ChatTitle","author","authorDialogId","titleClasses","UserType","extranet","subjectText","subject","parsedSubject","parts","before","after","beforeText","afterText","BaseNotificationItemHeader","hasMoreUsers","moreUsers","phrase","$Bitrix","start","end","onUserTitleClick","openChat","onMoreUsersClick","PlainText","hasPlainText","plainText","BaseNotificationItem","Attach","isUnread","userData","hasQuickAnswer","canAnswer","hasReaction","attachList","attach","itemDate","DateFormatter","formatByTemplate","DateTemplate","simple","showDetailedBlock","isSubjectOnly","subscribe","beforeUnmount","unsubscribe","notificationFromEvent","getData","onConfirmButtonsClick","onSendQuickAnswer","onUnsubscribeClick","onContentClick","executeClickEvent","emitter","getEmitter","eventEmitter","CalendarNotificationItem","Color","iconClass","CrmNotificationItem","entityKey","entityType","TaskNotificationItem","BizprocNotificationItem","SonetNotificationItem","CompatibilityNotificationItemHeader","hasName","CompatibilityNotificationItem","decodeNotification","DefaultNotificationItem","NotificationComponents","TaskEntity","CalendarEntity","CompatibilityEntity","CrmEntity","BizprocEntity","SonetEntity","DefaultEntity","ItemPlaceholder","itemsToShow","ScrollButton","unreadCounter","notificationsOnScreen","notificationCollection","hasUnreadOnScreen","some","notificationMapCollection","get","firstUnreadId","find","firstUnreadBelowVisible","minIdOnScreen","Math","min","hasUnreadBelowVisible","unreadCounterBeforeVisible","i","showScrollButton","arrowButtonClass","arrowDown","formattedCounter","mapState","state","collection","onScrollButtonClick","idToScroll","firstUnreadNode","selector","document","querySelector","offsetTop","latestNotification","latestNotificationNode","NotificationFilterValueChip","Chip","ChipDesign","ChipSize","ANOTHER_TYPE","NotificationFilterValuesContainer","nonEmptyEntries","firstNonEmptyField","list","secondNonEmptyField","remainingNonEmptyEntries","firstTagTitle","formatEntry","secondTagTitle","remainingTagTitle","hasNonEmptyEntries","hasSingleRemainingEntry","hasMultipleRemainingEntries","loc","phraseCode","replacements","getTitle","key","getTagTitle","fieldKey","NotificationFilterFieldTypes","searchTypes","searchDate","searchAuthors","formatValue","isArray","entry","onRemoveSimpleTag","onRemoveRemainingTags","keys","NotificationFilterSearchInput","displayData","modelValue","isFocused","isSearchEmpty","withTags","entries","push","dateFrom","dateTo","placeholderText","watch","searchValue","onFocus","onRemove","onInput","NotificationFilterActionButtons","NotificationFilterAuthorField","labelText","mounted","getSelector","renderTo","preselectedItems","TagSelector","onTagAdd","onTagRemove","multiple","dialogOptions","height","width","entities","options","intranetUsersOnly","inviteEmployeeLink","dropdownMode","hideOnDeselect","onShow","popup","active","onHide","container","getDialog","getContainer","attr","NotificationFilterTypeField","schema","entityId","targetNode","getTargetNode","filterTypes","MODULE_ID","tabs","NAME","selected","compactView","showAvatars","enableSearch","inputContainer","$el","originalSchema","modulesToShowInFilter","notificationFilterTypes","DateFieldOption","NONE","SINGLE","RANGE","NotificationFilterDateField","BInput","searchType","getCurrentSearchType","InputSize","isFirstDateNotEmpty","isSecondDateNotEmpty","dateOptionText","currentOption","getDateOptions","option","showFirstDateInput","showSecondDateInput","firstDateValue","secondDateValue","getOptionsMenuItems","isSelected","updateItems","onDateOptionClick","PopupManager","getPopupById","maxHeight","animation","onPopupAfterClose","dateOption","popupContainer","getPopupContainer","onDateFilterClick","toDate","ignoreNextClick","datePickerInstance","DatePicker","DatePickerEvent","SELECT","pickerEvent","handleDatePickerSelect","popupOptions","dateFormat","getDateFormat","selectDates","createDate","onSecondDateFilterClick","datePickerEvent","formatDate","onFirstDateClear","onSecondDateClear","POPUP_ID","NotificationFilterPopup","MessengerPopup","filterData","popupId","config","padding","contentPadding","bindOptions","position","wrapper","buildData","onSearchClick","getContentElement","NotificationFilter","isInputFocused","activePopups","dateOptions","datePicker","searchQuery","popupElement","searchTypeTitles","searchAuthorNames","onSearchUpdate","bind","handleClickOutside","unbind","onInputFocus","clearActivePopups","onPopupClose","applyData","reset","searchTypeIds","searchAuthorIds","dateFromTimestamp","Date","getTime","dateToTimestamp","valueData","searchDateFrom","searchDateTo","onPopupUpdate","onFilterReset","onTagsRemove","onPopupStateChange","isAnyDialogActive","inputElement","getInputElement","clickedInsideInput","contains","clickedInsidePopup","searchInput","onPopupMounted","element","LIMIT_PER_PAGE","NotificationSearchService","userManager","isLoading","lastId","hasMoreItemsToLoad","UserManager","loadFirstPage","requestItems","firstPage","loadNextPage","Promise","resolve","searchInModel","toLowerCase","settingPrefix","fromDate","BX","parseDate","itemDateForCompare","setHours","fromDateForCompare","toDateForCompare","dateFromInput","queryParams","getSearchRequestParams","imNotifyHistorySearch","responseData","isLastPage","getLastItemId","setUsersToModel","requestParams","SEARCH_TEXT","SEARCH_TYPES","SEARCH_AUTHORS","LIMIT","CONVERT_TEXT","SEARCH_DATE_FROM","toISOString","SEARCH_DATE_TO","SEARCH_DATE","LAST_ID","NotificationContent","UserListPopup","Loader","directives","binding","instance","observer","observe","unobserve","isInitialLoading","initialLoadComplete","readQueue","isNextPageLoading","markedAsUnreadIds","windowFocused","showSearchResult","popupBindElement","showUserListPopup","userListIds","hasConfirmNotifications","simpleNotifications","confirmNotificationsCounter","searchResultCollection","isEmptyState","emptyStateIcon","emptyStateTitle","enableAutoRead","notificationService","NotificationService","notificationSearchService","headerMenu","searchOnServerDelayed","searchOnServer","window","onWindowFocus","onWindowBlur","initObserver","onMarkAsUnreadClick","hasFocus","processReadQueue","IntersectionObserver","parseInt","dataset","isIntersecting","delete","intersectionRatio","intersectionRect","rootBounds","root","listNotifications","threshold","from","fill","zero","index","simpleNotificationIds","idsToRead","setSearchResult","getComponentForItem","componentId","offset","scroll","top","behavior","onScroll","onScrollSearchResult","onScrollNotifications","onClickHeaderMenu","dom","isOneScreenRemaining","sendConfirmAction","onSearch","localResult","skipValidation","onLeave","done","ANIMATION_DURATION_MS","getBoundingClientRect","style","requestAnimationFrame","addClass","onDoubleClick","getNotificationsBackgroundStyle","ThemeManager","getBackgroundStyleById","SpecialBackground"],"mappings":"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"}