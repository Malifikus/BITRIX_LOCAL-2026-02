{"version":3,"file":"desktop-manager.bundle.js","sources":["../src/classes/check-utils.js","../src/classes/conference.js","../src/classes/encoder.js","../src/helpers/bx-link-processor.js","../src/classes/event-handlers/bx-link.js","../src/classes/event-handlers/auth.js","../src/classes/event-handlers/status.js","../src/classes/event-handlers/counter.js","../src/classes/event-handlers/hotkey.js","../src/classes/event-handlers/new-tab.js","../src/helpers/slider-bindings.js","../src/helpers/data-updater.js","../src/classes/event-handlers/wake-up.js","../src/classes/reload-checker.js","../src/classes/chat-window.js","../src/classes/browser-window.js","../src/classes/broadcast-manager.js","../src/desktop-manager.js"],"sourcesContent":["import { Dom, Extension } from 'main.core';\n\nconst IMAGE_DESKTOP_RUN = 'icon.png';\nconst IMAGE_DESKTOP_TWO_WINDOW_MODE = 'internal.png';\n\nconst IMAGE_CHECK_URL = 'http://127.0.0.1:20141';\nconst IMAGE_CHECK_TIMEOUT = 500;\nconst IMAGE_CLASS = 'bx-im-messenger__out-of-view';\n\nconst checkTimeoutList = {};\n\nexport const CheckUtils = {\n\ttestImageLoad(image = IMAGE_DESKTOP_RUN): Promise<boolean>\n\t{\n\t\tlet resolvePromise = null;\n\n\t\tconst loadCheckPromise = new Promise((resolve) => {\n\t\t\tresolvePromise = resolve;\n\t\t});\n\n\t\tconst dateCheck = Date.now();\n\t\tlet isPromiseResolvedToFalse = false;\n\n\t\tconst imageForCheck = Dom.create({\n\t\t\ttag: 'img',\n\t\t\tattrs: {\n\t\t\t\tsrc: `${IMAGE_CHECK_URL}/${image}?${dateCheck}`,\n\t\t\t\t'data-id': dateCheck,\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tclassName: IMAGE_CLASS,\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\terror() {\n\t\t\t\t\tif (isPromiseResolvedToFalse)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst checkId = this.dataset.id;\n\t\t\t\t\tresolvePromise(false);\n\n\t\t\t\t\tclearTimeout(checkTimeoutList[checkId]);\n\t\t\t\t\tDom.remove(this);\n\t\t\t\t},\n\t\t\t\tload() {\n\t\t\t\t\tconst checkId = this.dataset.id;\n\t\t\t\t\tresolvePromise(true);\n\n\t\t\t\t\tclearTimeout(checkTimeoutList[checkId]);\n\t\t\t\t\tDom.remove(this);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tdocument.body.append(imageForCheck);\n\n\t\tcheckTimeoutList[dateCheck] = setTimeout(() => {\n\t\t\tisPromiseResolvedToFalse = true;\n\n\t\t\tresolvePromise(false);\n\t\t\tDom.remove(imageForCheck);\n\t\t}, IMAGE_CHECK_TIMEOUT);\n\n\t\treturn loadCheckPromise;\n\t},\n\n\ttestInternetConnection(): Promise\n\t{\n\t\tconst currentTimestamp = Date.now();\n\n\t\tconst settings = Extension.getSettings('im.v2.lib.desktop');\n\t\tconst internetCheckUrl = settings.get('internetCheckUrl');\n\n\t\treturn new Promise((resolve) => {\n\t\t\tfetch(`${internetCheckUrl}.${currentTimestamp}`)\n\t\t\t\t.then((response: Response) => {\n\t\t\t\t\tif (response.status === 200)\n\t\t\t\t\t{\n\t\t\t\t\t\tresolve(true);\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve(false);\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tresolve(false);\n\t\t\t\t});\n\t\t});\n\t},\n\n\tIMAGE_DESKTOP_RUN,\n\tIMAGE_DESKTOP_TWO_WINDOW_MODE,\n};\n","import { DesktopApi } from 'im.v2.lib.desktop-api';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Loc, Reflection } from 'main.core';\n\nlet conferenceList = [];\nlet conferenceIndex = 0;\n\nexport const Conference = {\n\topenConference(code: string): boolean\n\t{\n\t\tif (!Utils.conference.isValidCode(code))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!DesktopApi.isDesktop())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet windowSize = null;\n\n\t\tconst sizes = [\n\t\t\t{ width: 2560, height: 1440 },\n\t\t\t{ width: 2048, height: 1152 },\n\t\t\t{ width: 1920, height: 1080 },\n\t\t\t{ width: 1600, height: 900 },\n\t\t\t{ width: 1366, height: 768 },\n\t\t\t{ width: 1024, height: 576 },\n\t\t];\n\n\t\tfor (const size of sizes)\n\t\t{\n\t\t\twindowSize = size;\n\t\t\tif (screen.width > size.width && screen.height > size.height)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tconferenceList = conferenceList.filter((name) => {\n\t\t\treturn Boolean(DesktopApi.findWindow(name));\n\t\t});\n\n\t\tconferenceList.push(Utils.conference.getWindowNameByCode(code));\n\n\t\tDesktopApi.createWindow(Utils.conference.getWindowNameByCode(code), (controller) => {\n\t\t\tcontroller.SetProperty('title', Loc.getMessage('IM_LIB_DESKTOP_CONFERENCE_TITLE'));\n\t\t\tcontroller.SetProperty('clientSize', { Width: windowSize.width, Height: windowSize.height });\n\n\t\t\t// we need the first 'center' command to prevent the window from jumping after we show it\n\t\t\tcontroller.ExecuteCommand('center');\n\t\t\tcontroller.SetProperty('minClientSize', { Width: 940, Height: 400 });\n\t\t\tcontroller.SetProperty('backgroundColor', '#2B3038');\n\t\t\tcontroller.ExecuteCommand('html.load', `<script>location.href=\"/video/${code}/\";</script>`);\n\t\t\tcontroller.ExecuteCommand('show');\n\n\t\t\t// we need the second 'center' command because we know the exact size of the window after we show it\n\t\t\tcontroller.ExecuteCommand('center');\n\t\t});\n\n\t\treturn true;\n\t},\n\ttoggleConference(): boolean\n\t{\n\t\tif (conferenceIndex > conferenceList.length - 1)\n\t\t{\n\t\t\tconferenceIndex = 0;\n\n\t\t\tDesktopApi.showWindow();\n\n\t\t\treturn true;\n\t\t}\n\n\t\tconferenceList = conferenceList.filter((name) => {\n\t\t\treturn Boolean(DesktopApi.findWindow(name));\n\t\t});\n\n\t\tfor (let index = conferenceIndex; index < conferenceList.length; index++)\n\t\t{\n\t\t\tconferenceIndex++;\n\n\t\t\tconst target = DesktopApi.findWindow(conferenceList[index]);\n\t\t\tif (target)\n\t\t\t{\n\t\t\t\tDesktopApi.activateWindow(target);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t},\n};\n","import {Type} from 'main.core';\n\nconst ENCODE_SEPARATOR = '!!';\n\nexport const Encoder = {\n\tencodeParams(params: {[key]: any}): string\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tlet result = '';\n\t\tconst first = true;\n\n\t\tObject.entries(params).forEach(([key, value]) => {\n\t\t\tconst prefix = first ? '' : ENCODE_SEPARATOR;\n\t\t\tresult += `${prefix}${key}${ENCODE_SEPARATOR}${value}`;\n\t\t});\n\n\t\treturn result;\n\t},\n\n\tdecodeParams(encodedParams: string): {[key]: any}\n\t{\n\t\tconst result = {};\n\t\tif (!Type.isStringFilled(encodedParams))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst chunks = encodedParams.split(ENCODE_SEPARATOR);\n\t\tfor (let i = 0; i < chunks.length; i += 2)\n\t\t{\n\t\t\tconst key = chunks[i];\n\t\t\tconst value = chunks[i+1];\n\t\t\tresult[key] = value;\n\t\t}\n\n\t\treturn result;\n\t},\n\n\tencodeParamsJson(params): string\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\treturn '{}';\n\t\t}\n\n\t\tlet result = '';\n\t\ttry\n\t\t{\n\t\t\tresult = encodeURIComponent(JSON.stringify(params));\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('DesktopUtils: could not encode params.', error);\n\t\t\tresult = '{}';\n\t\t}\n\n\t\treturn result;\n\t},\n\n\tdecodeParamsJson(encodedParams: string): {[key]: any}\n\t{\n\t\tlet result = {};\n\t\tif (!Type.isStringFilled(encodedParams))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tresult = JSON.parse(decodeURIComponent(encodedParams));\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('DesktopUtils: could not decode encoded params.', error);\n\t\t}\n\n\t\treturn result;\n\t}\n};","import { Messenger } from 'im.public';\nimport { DesktopApi } from 'im.v2.lib.desktop-api';\nimport { DesktopBxLink, LegacyDesktopBxLink } from 'im.v2.const';\nimport { DesktopManager } from 'im.v2.lib.desktop';\n\nimport { Encoder } from '../classes/encoder';\n\nimport type { DesktopBxLinkKey, LegacyDesktopBxLinkKey, RawParams } from '../classes/event-handlers/bx-link';\n\nexport const BxLinkProcessor = {\n\thandleCommand(command: DesktopBxLinkKey, rawParams: ?RawParams): void\n\t{\n\t\tconst params = rawParams ?? {};\n\n\t\tObject.entries(params).forEach(([key, value]) => {\n\t\t\tparams[key] = decodeURIComponent(value);\n\t\t});\n\n\t\tif (command !== DesktopBxLink.openPage)\n\t\t{\n\t\t\tDesktopApi.activateWindow();\n\t\t}\n\n\t\tif (command === DesktopBxLink.chat)\n\t\t{\n\t\t\tconst messageId = params.messageId ?? 0;\n\t\t\tvoid Messenger.openChat(params.dialogId, messageId);\n\t\t}\n\t\telse if (command === DesktopBxLink.lines)\n\t\t{\n\t\t\tvoid Messenger.openLines(params.dialogId);\n\t\t}\n\t\telse if (command === DesktopBxLink.conference)\n\t\t{\n\t\t\tvoid DesktopManager.getInstance().openConference(params.code);\n\t\t}\n\t\telse if (command === DesktopBxLink.call)\n\t\t{\n\t\t\tconst withVideo = params.withVideo !== 'N';\n\t\t\tvoid Messenger.startVideoCall(params.dialogId, withVideo);\n\t\t}\n\t\telse if (command === DesktopBxLink.phone)\n\t\t{\n\t\t\tconst decodedParams = Encoder.decodeParamsJson(params.phoneParams);\n\t\t\tvoid Messenger.startPhoneCall(params.number, decodedParams);\n\t\t}\n\t\telse if (command === DesktopBxLink.callList)\n\t\t{\n\t\t\tconst decodedParams = Encoder.decodeParamsJson(params.callListParams);\n\t\t\tvoid Messenger.startCallList(params.callListId, decodedParams);\n\t\t}\n\t\telse if (command === DesktopBxLink.notifications)\n\t\t{\n\t\t\tvoid Messenger.openNotifications();\n\t\t}\n\t\telse if (command === DesktopBxLink.recentSearch)\n\t\t{\n\t\t\tvoid Messenger.openRecentSearch();\n\t\t}\n\t\telse if (command === DesktopBxLink.copilot)\n\t\t{\n\t\t\tvoid Messenger.openCopilot(params.dialogId);\n\t\t}\n\t\telse if (command === DesktopBxLink.collab)\n\t\t{\n\t\t\tvoid Messenger.openCollab(params.dialogId);\n\t\t}\n\t\telse if (command === DesktopBxLink.channel)\n\t\t{\n\t\t\tvoid Messenger.openChannel(params.dialogId);\n\t\t}\n\t\telse if (command === DesktopBxLink.taskComments)\n\t\t{\n\t\t\tconst messageId = params.messageId ?? 0;\n\t\t\tvoid Messenger.openTaskComments(params.dialogId, messageId);\n\t\t}\n\t\telse if (command === DesktopBxLink.settings)\n\t\t{\n\t\t\tvoid Messenger.openSettings({ onlyPanel: params.section });\n\t\t}\n\t\telse if (command === DesktopBxLink.chatCreation)\n\t\t{\n\t\t\tvoid Messenger.openChatCreation(params.chatType);\n\t\t}\n\t\telse if (command === DesktopBxLink.openLayout)\n\t\t{\n\t\t\tconst { id, entityId } = params;\n\n\t\t\tvoid Messenger.openNavigationItem({\n\t\t\t\tid,\n\t\t\t\tentityId,\n\t\t\t});\n\t\t}\n\t\telse if (command === DesktopBxLink.timeManager)\n\t\t{\n\t\t\tBX.Timeman?.Monitor?.openReport();\n\t\t}\n\t\telse if (command === DesktopBxLink.openTab)\n\t\t{\n\t\t\tDesktopApi.setActiveTab();\n\t\t}\n\t\telse if (command === DesktopBxLink.openPage)\n\t\t{\n\t\t\tconst options = Encoder.decodeParamsJson(params.options);\n\t\t\tDesktopApi.openPage(options.url, options.options);\n\t\t}\n\t\telse if (command === DesktopBxLink.botContext)\n\t\t{\n\t\t\tconst { dialogId, context } = params;\n\t\t\tconst decodedContext = Encoder.decodeParamsJson(context);\n\n\t\t\tvoid Messenger.openChatWithBotContext(dialogId, decodedContext);\n\t\t}\n\t},\n\thandleLegacyCommand(command: LegacyDesktopBxLinkKey, rawParams: ?RawParams): void\n\t{\n\t\tconst params = rawParams ?? {};\n\n\t\tObject.entries(params).forEach(([key, value]) => {\n\t\t\tparams[key] = decodeURIComponent(value);\n\t\t});\n\n\t\tif (command === LegacyDesktopBxLink.messenger)\n\t\t{\n\t\t\tif (params.dialog)\n\t\t\t{\n\t\t\t\tvoid Messenger.openChat(params.dialog);\n\t\t\t}\n\t\t\telse if (params.chat)\n\t\t\t{\n\t\t\t\tvoid Messenger.openChat(`chat${params.chat}`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvoid Messenger.openChat();\n\t\t\t}\n\t\t}\n\t\telse if (command === LegacyDesktopBxLink.chat && params.id)\n\t\t{\n\t\t\tvoid Messenger.openChat(`chat${params.id}`);\n\t\t}\n\t\telse if (command === LegacyDesktopBxLink.notify)\n\t\t{\n\t\t\tvoid Messenger.openNotifications();\n\t\t}\n\t\telse if (command === LegacyDesktopBxLink.callTo)\n\t\t{\n\t\t\tif (params.video)\n\t\t\t{\n\t\t\t\tvoid Messenger.startVideoCall(params.video);\n\t\t\t}\n\t\t\telse if (params.audio)\n\t\t\t{\n\t\t\t\tvoid Messenger.startVideoCall(params.audio, false);\n\t\t\t}\n\t\t\telse if (params.phone)\n\t\t\t{\n\t\t\t\tvoid Messenger.startPhoneCall(params.phone);\n\t\t\t}\n\t\t}\n\t\telse if (command === LegacyDesktopBxLink.callList)\n\t\t{\n\t\t\tvoid Messenger.openRecentSearch();\n\t\t}\n\t},\n};\n","import { EventType, DesktopBxLink, LegacyDesktopBxLink, DesktopBroadcastAction, WINDOW_ACTIVATION_DELAY } from 'im.v2.const';\nimport { DesktopApi, DesktopFeature } from 'im.v2.lib.desktop-api';\nimport { DesktopBroadcastManager } from 'im.v2.lib.desktop';\n\nimport { BxLinkProcessor } from '../../helpers/bx-link-processor';\n\nexport type DesktopBxLinkKey = $Keys<typeof DesktopBxLink>;\nexport type LegacyDesktopBxLinkKey = $Keys<typeof LegacyDesktopBxLink>;\nexport type RawParams = {\n\tdialogId: string,\n}\n\nexport class BxLinkHandler\n{\n\tstatic init(): BxLinkHandler\n\t{\n\t\treturn new BxLinkHandler();\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.#subscribeToBxProtocolEvent();\n\t\tthis.#subscribeToLegacyBxProtocolEvent();\n\t}\n\n\t#subscribeToBxProtocolEvent()\n\t{\n\t\tDesktopApi.subscribe(EventType.desktop.onBxLink, async (command: DesktopBxLinkKey, rawParams: ?RawParams) => {\n\t\t\tawait DesktopApi.showBrowserWindow();\n\n\t\t\tif (DesktopApi.isFeatureSupported(DesktopFeature.portalTabActivation.id))\n\t\t\t{\n\t\t\t\tawait DesktopApi.handlePortalTabActivation();\n\t\t\t}\n\n\t\t\tDesktopBroadcastManager.getInstance().sendActionMessage({\n\t\t\t\taction: DesktopBroadcastAction.bxLink,\n\t\t\t\tparams: {\n\t\t\t\t\tcommand,\n\t\t\t\t\trawParams,\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\t#subscribeToLegacyBxProtocolEvent()\n\t{\n\t\tDesktopApi.subscribe(EventType.desktop.onBxLink, (command: LegacyDesktopBxLinkKey, rawParams: ?RawParams) => {\n\t\t\tBxLinkProcessor.handleLegacyCommand(command, rawParams);\n\t\t});\n\t}\n}\n","import {EventType, RestMethod} from 'im.v2.const';\nimport {runAction} from 'im.v2.lib.rest';\n\nimport {DesktopApi} from 'im.v2.lib.desktop-api';\n\nexport class AuthHandler\n{\n\tstatic init(): AuthHandler\n\t{\n\t\treturn new AuthHandler();\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.#subscribeToLogoutEvent();\n\t}\n\n\t#subscribeToLogoutEvent()\n\t{\n\t\tDesktopApi.subscribe(EventType.desktop.onExit, this.#onExit.bind(this));\n\t}\n\n\t#onExit()\n\t{\n\t\trunAction(RestMethod.imV2DesktopLogout)\n\t\t\t.finally(() => {\n\t\t\t\tDesktopApi.shutdown();\n\t\t\t});\n\t}\n}","import { Browser, Event } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { EventType, RestMethod, Settings } from 'im.v2.const';\nimport { DesktopApi } from 'im.v2.lib.desktop-api';\n\nimport { DesktopManager } from '../../desktop-manager';\n\nexport class StatusHandler\n{\n\tstatic init(): StatusHandler\n\t{\n\t\treturn new StatusHandler();\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.#subscribeToAwayEvent();\n\t\tthis.#subscribeToFocusEvent();\n\t\tthis.#subscribeToBlurEvent();\n\t\tthis.#subscribeToIconClickEvent();\n\n\t\tthis.#setInitialStatus();\n\t\tthis.#subscribeToStatusChange();\n\t}\n\n\t// region icon click\n\t#subscribeToIconClickEvent()\n\t{\n\t\tDesktopApi.subscribe(EventType.desktop.onIconClick, this.#onIconClick.bind(this));\n\t}\n\n\t#onIconClick()\n\t{\n\t\tDesktopManager.getInstance().toggleConference();\n\t}\n\n\t// endregion icon click\n\n\t// region away\n\t#subscribeToAwayEvent()\n\t{\n\t\tDesktopApi.subscribe(EventType.desktop.onUserAway, this.#onUserAway.bind(this));\n\t}\n\n\t#onUserAway(away: boolean)\n\t{\n\t\tconst method = away ? RestMethod.imUserStatusIdleStart : RestMethod.imUserStatusIdleEnd;\n\t\tCore.getRestClient().callMethod(method)\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error(`Desktop: error in ${method}  - ${error}`);\n\t\t\t})\n\t\t;\n\t}\n\t// endregion away\n\n\t// region focus/blur events\n\t#subscribeToFocusEvent()\n\t{\n\t\tEvent.bind(window, 'focus', this.#removeNativeNotifications.bind(this));\n\t}\n\n\t#subscribeToBlurEvent()\n\t{\n\t\t// TODO remove this after refactor notification balloons\n\t\tEvent.bind(window, 'blur', this.#removeNativeNotifications.bind(this));\n\t}\n\n\t#removeNativeNotifications()\n\t{\n\t\tif (!Browser.isWin() || !DesktopApi.isChatWindow())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDesktopApi.removeNativeNotifications();\n\t}\n\t// endregion focus/blur events\n\n\t// region user status\n\t#setInitialStatus()\n\t{\n\t\tconst status = Core.getStore().getters['application/settings/get'](Settings.user.status);\n\t\tDesktopApi.setIconStatus(status);\n\t}\n\n\t#subscribeToStatusChange()\n\t{\n\t\tconst statusWatcher = (state, getters) => {\n\t\t\treturn getters['application/settings/get'](Settings.user.status);\n\t\t};\n\t\tCore.getStore().watch(statusWatcher, (newStatus: string) => {\n\t\t\tDesktopApi.setIconStatus(newStatus);\n\t\t});\n\t}\n\t// endregion user status\n}\n","import { Core } from 'im.v2.application.core';\nimport { EventType } from 'im.v2.const';\n\nimport { DesktopApi } from 'im.v2.lib.desktop-api';\nimport { EventEmitter } from 'main.core.events';\n\nimport type { Store } from 'ui.vue3.vuex';\n\nexport class CounterHandler\n{\n\t#store: Store;\n\n\tstatic init(): CounterHandler\n\t{\n\t\treturn new CounterHandler();\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.#store = Core.getStore();\n\n\t\tthis.#onCounterChange();\n\t\tthis.#subscribeToCountersChange();\n\t}\n\n\t#subscribeToCountersChange()\n\t{\n\t\tEventEmitter.subscribe(EventType.counter.onNotificationCounterChange, this.#onCounterChange.bind(this));\n\t\tEventEmitter.subscribe(EventType.counter.onChatCounterChange, this.#onCounterChange.bind(this));\n\t}\n\n\t#onCounterChange()\n\t{\n\t\tconst chatCounter = this.#store.getters['counters/getTotalChatCounter'];\n\t\tconst notificationCounter = this.#store.getters['notifications/getCounter'];\n\n\t\tconst isImportant = chatCounter > 0;\n\t\tDesktopApi.setCounter(chatCounter + notificationCounter, isImportant);\n\t}\n}","import { Event } from 'main.core';\nimport { Logger } from 'im.v2.lib.logger';\nimport { Utils } from 'im.v2.lib.utils';\nimport { DesktopApi } from 'im.v2.lib.desktop-api';\n\nexport class HotkeyHandler\n{\n\tstatic init(): HotkeyHandler\n\t{\n\t\treturn new HotkeyHandler();\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.#bindHotkeys();\n\t}\n\n\t#bindHotkeys()\n\t{\n\t\tEvent.bind(window, 'keydown', (event) => {\n\t\t\tconst logFolderCombination = Utils.key.isCombination(event, 'Ctrl+Shift+L');\n\t\t\tif (logFolderCombination)\n\t\t\t{\n\t\t\t\tDesktopApi.openLogsFolder();\n\t\t\t\tLogger.desktop('NOTICE: User open log folder (hotkey)');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst devToolsCombination = Utils.key.isCombination(event, 'Ctrl+Shift+D');\n\t\t\tif (devToolsCombination)\n\t\t\t{\n\t\t\t\tDesktopApi.openDeveloperTools();\n\t\t\t\tLogger.desktop('NOTICE: User open developer tools (hotkey)');\n\t\t\t}\n\t\t});\n\t}\n}\n","import { EventType } from 'im.v2.const';\nimport { DesktopApi } from 'im.v2.lib.desktop-api';\n\nexport class NewTabHandler\n{\n\tstatic init(): NewTabHandler\n\t{\n\t\treturn new NewTabHandler();\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.#subscribeToNewTabEvent();\n\t}\n\n\t#subscribeToNewTabEvent()\n\t{\n\t\tDesktopApi.subscribe(EventType.desktop.onNewTabClick, this.#onNewTabClick.bind(this));\n\t}\n\n\t#onNewTabClick()\n\t{\n\t\tDesktopApi.createTab('/desktop/menu/');\n\t}\n}\n","import { DesktopApi } from 'im.v2.lib.desktop-api';\n\nexport const SliderBindings = {\n\tinit()\n\t{\n\t\tconst sliderBindingStatus = DesktopApi.getSliderBindingsStatus();\n\t\tif (sliderBindingStatus)\n\t\t{\n\t\t\tBX.SidePanel.Instance.enableAnchorBinding();\n\n\t\t\treturn;\n\t\t}\n\n\t\tBX.SidePanel.Instance.disableAnchorBinding();\n\t},\n};\n","import { ChatService } from 'im.v2.provider.service.chat';\nimport { LayoutManager } from 'im.v2.lib.layout';\nimport { LegacyRecentService } from 'im.v2.provider.service.recent';\n\nimport type { ImModelLayout } from 'im.v2.model';\n\nexport const DesktopDataUpdater = {\n\tasync reloadChatInfo(): Promise<void>\n\t{\n\t\tawait LegacyRecentService.getInstance().requestItems({ firstPage: true });\n\n\t\tconst currentLayout = LayoutManager.getInstance().getLayout();\n\n\t\tif (currentLayout.entityId)\n\t\t{\n\t\t\tawait this.reopenChat(currentLayout);\n\t\t}\n\t},\n\tasync reopenChat(currentLayout: ImModelLayout): Promise<void>\n\t{\n\t\tLayoutManager.getInstance().clearCurrentLayoutEntityId();\n\n\t\tconst chatService = new ChatService();\n\t\tawait chatService.resetChat(currentLayout.entityId);\n\n\t\tvoid LayoutManager.getInstance().setLayout(currentLayout);\n\t},\n};\n","import { Core } from 'im.v2.application.core';\nimport { CallManager } from 'im.v2.lib.call';\nimport { DesktopManager } from 'im.v2.lib.desktop';\nimport { DesktopApi } from 'im.v2.lib.desktop-api';\nimport { EventType } from 'im.v2.const';\nimport { Logger } from 'im.v2.lib.logger';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { DesktopDataUpdater } from '../../helpers/data-updater';\nimport { CheckUtils } from '../check-utils';\n\nexport class WakeUpHandler\n{\n\t#initDate: Date;\n\t#wakeUpTimer = null;\n\tsidePanelManager: Object = BX.SidePanel.Instance;\n\n\tstatic init(): WakeUpHandler\n\t{\n\t\treturn new WakeUpHandler();\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.#initDate = new Date();\n\n\t\tDesktopApi.subscribe(EventType.desktop.onWakeUp, this.#onWakeUp.bind(this));\n\t}\n\n\tasync #onWakeUp()\n\t{\n\t\tconst hasConnection = await CheckUtils.testInternetConnection();\n\t\tif (!hasConnection)\n\t\t{\n\t\t\tLogger.desktop('StatusHandler: onWakeUp event, no internet connection, delay 60 sec');\n\n\t\t\tclearTimeout(this.#wakeUpTimer);\n\t\t\tthis.#wakeUpTimer = setTimeout(this.#onWakeUp.bind(this), 60 * 1000);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (Utils.date.isSameHour(new Date(), this.#initDate))\n\t\t{\n\t\t\tLogger.desktop('StatusHandler: onWakeUp event, same hour - restart pull client');\n\t\t\tCore.getPullClient().restart();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.sidePanelManager.opened)\n\t\t\t{\n\t\t\t\tclearTimeout(this.#wakeUpTimer);\n\t\t\t\tthis.#wakeUpTimer = setTimeout(this.#onWakeUp.bind(this), 60 * 1000);\n\n\t\t\t\tLogger.desktop('StatusHandler: onWakeUp event, slider is open, delay 60 sec');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (CallManager.getInstance().hasCurrentCall())\n\t\t\t{\n\t\t\t\tclearTimeout(this.#wakeUpTimer);\n\t\t\t\tthis.#wakeUpTimer = setTimeout(this.#onWakeUp.bind(this), 60 * 1000);\n\n\t\t\t\tLogger.desktop('StatusHandler: onWakeUp event, call is active, delay 60 sec');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!DesktopManager.getInstance().canReloadWindow())\n\t\t\t{\n\t\t\t\tawait DesktopDataUpdater.reloadChatInfo();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tLogger.desktop('StatusHandler: onWakeUp event, reload window');\n\n\t\t\tDesktopApi.reloadWindow();\n\t\t}\n\t}\n}\n","import { Event } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport { EventType } from 'im.v2.const';\nimport { CallManager } from 'im.v2.lib.call';\nimport { DesktopManager } from 'im.v2.lib.desktop';\nimport { Logger } from 'im.v2.lib.logger';\nimport { Utils } from 'im.v2.lib.utils';\nimport { DesktopApi } from 'im.v2.lib.desktop-api';\n\nimport { CheckUtils } from './check-utils';\nimport { DesktopDataUpdater } from '../helpers/data-updater';\n\nconst ONE_HOUR = 60 * 60 * 1000;\n\nexport class ReloadChecker\n{\n\t#initDate: Date;\n\t#sidePanelManager: BX.SidePanel.Manager = BX.SidePanel.Instance;\n\n\tstatic init(): ReloadChecker\n\t{\n\t\treturn new ReloadChecker();\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.#initDate = new Date();\n\t\tthis.#startReloadCheck();\n\t\tthis.#subscribeToReloadEvent();\n\t}\n\n\t#startReloadCheck(): void\n\t{\n\t\tsetInterval(async () => {\n\t\t\tconst isReloadNeeded = await this.#isReloadNeeded();\n\n\t\t\tif (!isReloadNeeded)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!DesktopManager.getInstance().canReloadWindow())\n\t\t\t{\n\t\t\t\tawait DesktopDataUpdater.reloadChatInfo();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.#reloadWindow();\n\t\t}, ONE_HOUR);\n\t}\n\n\tasync #isReloadNeeded(): Promise<boolean>\n\t{\n\t\tif (Utils.date.isSameDay(new Date(), this.#initDate))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.#sidePanelManager.opened)\n\t\t{\n\t\t\tLogger.desktop('Checker: checkDayForReload, slider is open - delay reload');\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (CallManager.getInstance().hasCurrentCall())\n\t\t{\n\t\t\tLogger.desktop('Checker: checkDayForReload, call is active - delay reload');\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn CheckUtils.testInternetConnection();\n\t}\n\n\t#reloadWindow(): void\n\t{\n\t\tLogger.desktop('Checker: checkDayForReload, new day - reload window');\n\t\tDesktopApi.reloadWindow();\n\t}\n\n\t#subscribeToReloadEvent()\n\t{\n\t\tEvent.bind(window, 'beforeunload', () => {\n\t\t\tconst event = new BaseEvent();\n\t\t\tEventEmitter.emit(window, EventType.desktop.onReload, event);\n\t\t});\n\t}\n}\n","import { EventEmitter } from 'main.core.events';\n\nimport { Core } from 'im.v2.application.core';\nimport { EventType } from 'im.v2.const';\nimport { DesktopApi } from 'im.v2.lib.desktop-api';\nimport { Logger } from 'im.v2.lib.logger';\n\nimport { BxLinkHandler } from './event-handlers/bx-link';\nimport { AuthHandler } from './event-handlers/auth';\nimport { StatusHandler } from './event-handlers/status';\nimport { CounterHandler } from './event-handlers/counter';\nimport { HotkeyHandler } from './event-handlers/hotkey';\nimport { NewTabHandler } from './event-handlers/new-tab';\nimport { SliderBindings } from '../helpers/slider-bindings';\nimport { WakeUpHandler } from './event-handlers/wake-up';\nimport { ReloadChecker } from './reload-checker';\n\n/* eslint-disable no-undef */\nexport class DesktopChatWindow\n{\n\tstatic init(): DesktopChatWindow\n\t{\n\t\treturn new DesktopChatWindow();\n\t}\n\n\tconstructor()\n\t{\n\t\tReloadChecker.init();\n\t\tWakeUpHandler.init();\n\t\tStatusHandler.init();\n\t\tAuthHandler.init();\n\t\tBxLinkHandler.init();\n\t\tCounterHandler.init();\n\t\tHotkeyHandler.init();\n\t\tNewTabHandler.init();\n\t\tSliderBindings.init();\n\n\t\tthis.#sendInitEvent();\n\t\tthis.#subscribeOnErrorEvent();\n\t\tthis.#initComplete();\n\t}\n\n\t#sendInitEvent()\n\t{\n\t\tconst { preloadedEntities: { legacyCurrentUser } } = Core.getApplicationData();\n\t\tDesktopApi.emit(EventType.desktop.onInit, [{\n\t\t\tuserInfo: legacyCurrentUser,\n\t\t}]);\n\t}\n\n\t#initComplete()\n\t{\n\t\tDesktopApi.setLogInfo = function(...params)\n\t\t{\n\t\t\tLogger.desktop(...params);\n\t\t};\n\n\t\twindow.BX.debugEnable(true);\n\n\t\tDesktopApi.printWelcomePrompt();\n\t}\n\n\t#subscribeOnErrorEvent()\n\t{\n\t\tEventEmitter.subscribe(EventType.request.onAuthError, () => {\n\t\t\treturn this.#handleInvalidAuthError();\n\t\t});\n\t}\n\n\t#handleInvalidAuthError(): Promise\n\t{\n\t\treturn DesktopApi.login();\n\t}\n}\n","import { DesktopApi } from 'im.v2.lib.desktop-api';\nimport { Logger } from 'im.v2.lib.logger';\n\nimport { NewTabHandler } from './event-handlers/new-tab';\nimport { HotkeyHandler } from './event-handlers/hotkey';\nimport { WakeUpHandler } from './event-handlers/wake-up';\nimport { ReloadChecker } from './reload-checker';\nimport { SliderBindings } from '../helpers/slider-bindings';\n\n/* eslint-disable no-undef */\nexport class DesktopBrowserWindow\n{\n\tstatic init(): DesktopBrowserWindow\n\t{\n\t\treturn new DesktopBrowserWindow();\n\t}\n\n\tconstructor()\n\t{\n\t\tReloadChecker.init();\n\t\tWakeUpHandler.init();\n\t\tHotkeyHandler.init();\n\t\tSliderBindings.init();\n\t\tNewTabHandler.init();\n\n\t\tthis.#initComplete();\n\t}\n\n\t#initComplete()\n\t{\n\t\tDesktopApi.setLogInfo = function(...params)\n\t\t{\n\t\t\tLogger.desktop(...params);\n\t\t};\n\t}\n}\n","import { Event } from 'main.core';\n\nimport { DesktopBroadcastAction } from 'im.v2.const';\nimport { CallManager } from 'im.v2.lib.call';\nimport { MessageNotifierManager } from 'im.v2.lib.message-notifier';\nimport { DesktopApi } from 'im.v2.lib.desktop-api';\n\nimport { BxLinkProcessor } from '../helpers/bx-link-processor';\n\nimport type { JsonObject } from 'main.core';\nimport type { NotifierClickParams } from 'im.v2.lib.message-notifier';\nimport type { DesktopBxLinkKey, RawParams } from './event-handlers/bx-link';\n\ntype DesktopBroadcastActionValue = $Values<typeof DesktopBroadcastAction>;\n\ntype ActionMessageEvent = {\n\taction: DesktopBroadcastActionValue,\n\tparams: JsonObject,\n}\n\ntype BxLinkParams = {\n\tcommand: DesktopBxLinkKey,\n\trawParams: ?RawParams\n}\n\nconst CHANNEL_DESKTOP = 'im-channel-desktop';\n\nexport class DesktopBroadcastManager\n{\n\t#actionHandlers = {\n\t\t[DesktopBroadcastAction.notification]: this.#onNotifierClick.bind(this),\n\t\t[DesktopBroadcastAction.answerButtonClick]: this.#onAnswerButtonClick.bind(this),\n\t\t[DesktopBroadcastAction.bxLink]: this.#handleBxLinkCommand.bind(this),\n\t};\n\n\tstatic getInstance(): DesktopBroadcastManager\n\t{\n\t\tif (!this.instance)\n\t\t{\n\t\t\tthis.instance = new this();\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n\tstatic init()\n\t{\n\t\tDesktopBroadcastManager.getInstance();\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.initBroadcastHandler();\n\t}\n\n\tinitBroadcastHandler()\n\t{\n\t\tthis.channel = new BroadcastChannel(CHANNEL_DESKTOP);\n\n\t\tif (DesktopApi.isChatWindow())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tEvent.bind(this.channel, 'message', (event: MessageEvent) => {\n\t\t\tconst { data } = event;\n\n\t\t\tif (!DesktopApi.isActiveTab())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst handleAction = this.#actionHandlers[data.action];\n\n\t\t\tif (!handleAction)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\thandleAction(data.params);\n\t\t});\n\t}\n\n\tsendActionMessage(message: ActionMessageEvent)\n\t{\n\t\tthis.channel.postMessage(message);\n\t}\n\n\t#onNotifierClick(params: NotifierClickParams)\n\t{\n\t\tMessageNotifierManager.getInstance().onNotifierClick(params);\n\t}\n\n\t#onAnswerButtonClick(params: JsonObject)\n\t{\n\t\tconst { mediaParams, callParams } = params;\n\n\t\tCallManager.getInstance().onAnswerButtonClick(mediaParams, callParams);\n\t}\n\n\t#handleBxLinkCommand(params: BxLinkParams)\n\t{\n\t\tBxLinkProcessor.handleCommand(params.command, params.rawParams);\n\t}\n}\n","import { Extension, Type } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\n\nimport { Core } from 'im.v2.application.core';\nimport { DesktopBxLink, Settings } from 'im.v2.const';\nimport { Logger } from 'im.v2.lib.logger';\nimport { DesktopApi, DesktopFeature } from 'im.v2.lib.desktop-api';\nimport { LayoutManager } from 'im.v2.lib.layout';\nimport { Feature, FeatureManager } from 'im.v2.lib.feature';\n\nimport { CheckUtils } from './classes/check-utils';\nimport { Conference } from './classes/conference';\nimport { DesktopChatWindow } from './classes/chat-window';\nimport { DesktopBrowserWindow } from './classes/browser-window';\nimport { Encoder } from './classes/encoder';\nimport { DesktopBroadcastManager } from './classes/broadcast-manager';\n\nimport type { CreatableChatType } from 'im.v2.component.content.chat-forms.forms';\n\nexport { DesktopBroadcastManager } from './classes/broadcast-manager';\n\nconst DESKTOP_PROTOCOL_VERSION = 2;\nconst LOCATION_RESET_TIMEOUT = 1000;\n\nexport class DesktopManager\n{\n\tstatic instance: DesktopManager;\n\n\t#desktopIsActive: boolean;\n\t#desktopActiveVersion: number;\n\t#locationChangedToBx = false;\n\t#enableRedirectCounter = 1;\n\n\tstatic getInstance(): DesktopManager\n\t{\n\t\tif (!this.instance)\n\t\t{\n\t\t\tthis.instance = new this();\n\t\t}\n\n\t\treturn this.instance;\n\t}\n\n\tstatic init()\n\t{\n\t\tDesktopManager.getInstance();\n\t}\n\n\tstatic isDesktop(): boolean\n\t{\n\t\treturn DesktopApi.isDesktop();\n\t}\n\n\tstatic isChatWindow(): boolean\n\t{\n\t\treturn DesktopApi.isChatWindow();\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.#initDesktopStatus();\n\n\t\tif (!DesktopManager.isDesktop())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDesktopBroadcastManager.init();\n\n\t\tif (DesktopApi.isChatWindow())\n\t\t{\n\t\t\tDesktopChatWindow.init();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDesktopBrowserWindow.init();\n\t\t}\n\t}\n\n\tisDesktopActive(): boolean\n\t{\n\t\tif (DesktopManager.isDesktop())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn this.#desktopIsActive;\n\t}\n\n\tsetDesktopActive(flag: boolean)\n\t{\n\t\tthis.#desktopIsActive = flag;\n\t}\n\n\tsetDesktopVersion(version: number)\n\t{\n\t\tthis.#desktopActiveVersion = version;\n\t}\n\n\tgetDesktopVersion(): number\n\t{\n\t\treturn this.#desktopActiveVersion;\n\t}\n\n\tisLocationChangedToBx(): boolean\n\t{\n\t\treturn this.#locationChangedToBx;\n\t}\n\n\tcanReloadWindow(): boolean\n\t{\n\t\treturn LayoutManager.getInstance().isEmbeddedMode();\n\t}\n\n\tredirectToChat(dialogId: string = '', messageId: number = 0): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToChat', dialogId);\n\t\tlet link = `bx://${DesktopBxLink.chat}/dialogId/${dialogId}`;\n\t\tif (messageId > 0)\n\t\t{\n\t\t\tlink += `/messageId/${messageId}`;\n\t\t}\n\t\tthis.openBxLink(link);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tredirectToChatWithBotContext(dialogId: string = '', context: Object = {}): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToChatWithBotContext', dialogId);\n\t\tlet link = `bx://${DesktopBxLink.botContext}/dialogId/${dialogId}`;\n\t\tif (!Type.isPlainObject(context))\n\t\t{\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\tconst preparedContext = Encoder.encodeParamsJson(context);\n\t\tlink += `/context/${preparedContext}`;\n\n\t\tthis.openBxLink(link);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tredirectToLines(dialogId: string = ''): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToLines', dialogId);\n\t\tthis.openBxLink(`bx://${DesktopBxLink.lines}/dialogId/${dialogId}`);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tredirectToCopilot(dialogId: string = ''): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToCopilot', dialogId);\n\t\tthis.openBxLink(`bx://${DesktopBxLink.copilot}/dialogId/${dialogId}`);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tredirectToCollab(dialogId: string = ''): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToCollab', dialogId);\n\t\tthis.openBxLink(`bx://${DesktopBxLink.collab}/dialogId/${dialogId}`);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tredirectToChannel(dialogId: string = ''): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToChannel', dialogId);\n\t\tthis.openBxLink(`bx://${DesktopBxLink.channel}/dialogId/${dialogId}`);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tredirectToTaskComments(dialogId: string = '', messageId: number = 0): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToTaskComments', dialogId);\n\t\tlet link = `bx://${DesktopBxLink.taskComments}/dialogId/${dialogId}`;\n\t\tif (messageId > 0)\n\t\t{\n\t\t\tlink += `/messageId/${messageId}`;\n\t\t}\n\t\tthis.openBxLink(link);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tredirectToNotifications(): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToNotifications');\n\t\tthis.openBxLink(`bx://${DesktopBxLink.notifications}`);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tredirectToRecentSearch(): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToRecentSearch');\n\t\tthis.openBxLink(`bx://${DesktopBxLink.recentSearch}`);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tredirectToConference(code: string): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToConference', code);\n\n\t\tthis.openBxLink(`bx://${DesktopBxLink.conference}/code/${code}`);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tredirectToSettings(sectionName: string): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToSettings', sectionName);\n\n\t\tthis.openBxLink(`bx://${DesktopBxLink.settings}/section/${sectionName}`);\n\n\t\treturn Promise.resolve();\n\t}\n\n\topenConference(code: string): Promise\n\t{\n\t\tLogger.warn('Desktop: openConference', code);\n\n\t\tconst result = Conference.openConference(code);\n\t\tif (!result)\n\t\t{\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\treturn Promise.resolve(true);\n\t}\n\n\ttoggleConference()\n\t{\n\t\tLogger.warn('Desktop: toggleConference');\n\n\t\tConference.toggleConference();\n\t}\n\n\tredirectToChatCreation(chatType: CreatableChatType): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToChatCreation', chatType);\n\t\tthis.openBxLink(`bx://${DesktopBxLink.chatCreation}/chatType/${chatType}/`);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tredirectToVideoCall(dialogId: string = '', withVideo: boolean = true): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToVideoCall', dialogId, withVideo);\n\t\tconst withVideoParam = withVideo ? 'Y' : 'N';\n\t\tthis.openBxLink(`bx://${DesktopBxLink.call}/dialogId/${dialogId}/withVideo/${withVideoParam}`);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tredirectToPhoneCall(number: string, params: Object<any, string>): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToPhoneCall', number, params);\n\t\tconst encodedParams = Encoder.encodeParamsJson(params);\n\t\tthis.openBxLink(`bx://${DesktopBxLink.phone}/number/${number}/phoneParams/${encodedParams}`);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tredirectToCallList(callListId: number, params: Object<string, any>): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToCallList', callListId, params);\n\t\tconst encodedParams = Encoder.encodeParamsJson(params);\n\t\tthis.openBxLink(`bx://${DesktopBxLink.callList}/callListId/${callListId}/callListParams/${encodedParams}`);\n\n\t\treturn Promise.resolve();\n\t}\n\n\topenAccountTab(domainName: string)\n\t{\n\t\tthis.openBxLink(`bx://v2/${domainName}/${DesktopBxLink.openTab}`);\n\t}\n\n\topenPage(url: string, options: { skipNativeBrowser?: boolean } = {})\n\t{\n\t\tconst encodedParams = Encoder.encodeParamsJson({ url, options });\n\n\t\tthis.openBxLink(`bx://${DesktopBxLink.openPage}/options/${encodedParams}`);\n\t}\n\n\tredirectToLayout({ id, entityId }): Promise\n\t{\n\t\tLogger.warn('Desktop: redirectToLayout', id, entityId);\n\t\tconst preparedEntityId = entityId ?? '';\n\t\tthis.openBxLink(`bx://${DesktopBxLink.openLayout}/id/${id}/entityId/${preparedEntityId}`);\n\n\t\treturn Promise.resolve();\n\t}\n\n\tasync checkStatusInDifferentContext(): Promise<boolean>\n\t{\n\t\tif (!this.isDesktopActive())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (DesktopApi.isChatWindow())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (DesktopApi.isDesktop() && !DesktopApi.isChatWindow())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn CheckUtils.testImageLoad();\n\t}\n\n\tcheckForRedirect(): Promise<boolean>\n\t{\n\t\tif (!this.isRedirectEnabled() || !this.isRedirectOptionEnabled())\n\t\t{\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\treturn this.checkStatusInDifferentContext();\n\t}\n\n\tasync checkForOpenBrowserPage(): Promise<boolean>\n\t{\n\t\tawait Core.ready();\n\n\t\tif (!this.isDesktopActive() || !this.isRedirectOptionEnabled())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst desktopVersion = this.getDesktopVersion();\n\t\tif (!DesktopApi.isFeatureSupportedInVersion(desktopVersion, DesktopFeature.openPage.id))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn CheckUtils.testImageLoad(CheckUtils.IMAGE_DESKTOP_TWO_WINDOW_MODE);\n\t}\n\n\tisRedirectEnabled(): boolean\n\t{\n\t\treturn this.#enableRedirectCounter > 0;\n\t}\n\n\tenableRedirect()\n\t{\n\t\tthis.#enableRedirectCounter++;\n\t}\n\n\tdisableRedirect()\n\t{\n\t\tthis.#enableRedirectCounter--;\n\t}\n\n\tisRedirectOptionEnabled(): boolean\n\t{\n\t\tif (!FeatureManager.isFeatureAvailable(Feature.isDesktopRedirectAvailable))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (DesktopApi.isDesktop() && !DesktopApi.isChatWindow())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn Core.getStore().getters['application/settings/get'](Settings.desktop.enableRedirect);\n\t}\n\n\topenBxLink(rawUrl: string)\n\t{\n\t\tconst preparedUrl = this.#prepareBxUrl(rawUrl);\n\n\t\tthis.#locationChangedToBx = true;\n\t\tsetTimeout(() => {\n\t\t\tconst event = new BaseEvent({ compatData: [] });\n\t\t\tEventEmitter.emit(window, 'BXLinkOpened', event);\n\t\t\tthis.#locationChangedToBx = false;\n\t\t}, LOCATION_RESET_TIMEOUT);\n\n\t\tlocation.href = preparedUrl;\n\t}\n\n\t#prepareBxUrl(url: string): string\n\t{\n\t\tif (/^bx:\\/\\/v(\\d)\\//.test(url))\n\t\t{\n\t\t\treturn url;\n\t\t}\n\n\t\treturn url.replace('bx://', `bx://v${DESKTOP_PROTOCOL_VERSION}/${location.hostname}/`);\n\t}\n\n\t#initDesktopStatus()\n\t{\n\t\tconst settings = Extension.getSettings('im.v2.lib.desktop');\n\t\tthis.setDesktopActive(settings.get('desktopIsActive'));\n\t\tthis.setDesktopVersion(settings.get('desktopActiveVersion'));\n\t}\n}\n"],"names":["IMAGE_DESKTOP_RUN","IMAGE_DESKTOP_TWO_WINDOW_MODE","IMAGE_CHECK_URL","IMAGE_CHECK_TIMEOUT","IMAGE_CLASS","checkTimeoutList","CheckUtils","testImageLoad","image","resolvePromise","loadCheckPromise","Promise","resolve","dateCheck","Date","now","isPromiseResolvedToFalse","imageForCheck","Dom","create","tag","attrs","src","props","className","events","error","checkId","dataset","id","clearTimeout","remove","load","document","body","append","setTimeout","testInternetConnection","currentTimestamp","settings","Extension","getSettings","internetCheckUrl","get","fetch","then","response","status","catch","conferenceList","conferenceIndex","Conference","openConference","code","Utils","conference","isValidCode","DesktopApi","isDesktop","windowSize","sizes","width","height","size","screen","filter","name","Boolean","findWindow","push","getWindowNameByCode","createWindow","controller","SetProperty","Loc","getMessage","Width","Height","ExecuteCommand","toggleConference","length","showWindow","index","target","activateWindow","ENCODE_SEPARATOR","Encoder","encodeParams","params","Type","isPlainObject","result","Object","entries","forEach","key","value","prefix","first","decodeParams","encodedParams","isStringFilled","chunks","split","i","encodeParamsJson","encodeURIComponent","JSON","stringify","console","decodeParamsJson","parse","decodeURIComponent","BxLinkProcessor","handleCommand","command","rawParams","DesktopBxLink","openPage","chat","messageId","Messenger","openChat","dialogId","lines","openLines","DesktopManager","getInstance","call","withVideo","startVideoCall","phone","decodedParams","phoneParams","startPhoneCall","number","callList","callListParams","startCallList","callListId","notifications","openNotifications","recentSearch","openRecentSearch","copilot","openCopilot","collab","openCollab","channel","openChannel","taskComments","openTaskComments","openSettings","onlyPanel","section","chatCreation","openChatCreation","chatType","openLayout","entityId","openNavigationItem","timeManager","BX","Timeman","Monitor","openReport","openTab","setActiveTab","options","url","botContext","context","decodedContext","openChatWithBotContext","handleLegacyCommand","LegacyDesktopBxLink","messenger","dialog","notify","callTo","video","audio","BxLinkHandler","init","constructor","subscribe","EventType","desktop","onBxLink","showBrowserWindow","isFeatureSupported","DesktopFeature","portalTabActivation","handlePortalTabActivation","DesktopBroadcastManager","sendActionMessage","action","DesktopBroadcastAction","bxLink","AuthHandler","onExit","bind","runAction","RestMethod","imV2DesktopLogout","finally","shutdown","StatusHandler","onIconClick","onUserAway","away","method","imUserStatusIdleStart","imUserStatusIdleEnd","Core","getRestClient","callMethod","Event","window","Browser","isWin","isChatWindow","removeNativeNotifications","getStore","getters","Settings","user","setIconStatus","statusWatcher","state","watch","newStatus","CounterHandler","EventEmitter","counter","onNotificationCounterChange","onChatCounterChange","chatCounter","notificationCounter","isImportant","setCounter","HotkeyHandler","event","logFolderCombination","isCombination","openLogsFolder","Logger","devToolsCombination","openDeveloperTools","NewTabHandler","onNewTabClick","createTab","SliderBindings","sliderBindingStatus","getSliderBindingsStatus","SidePanel","Instance","enableAnchorBinding","disableAnchorBinding","DesktopDataUpdater","reloadChatInfo","LegacyRecentService","requestItems","firstPage","currentLayout","LayoutManager","getLayout","reopenChat","clearCurrentLayoutEntityId","chatService","ChatService","resetChat","setLayout","WakeUpHandler","sidePanelManager","onWakeUp","hasConnection","date","isSameHour","getPullClient","restart","opened","CallManager","hasCurrentCall","canReloadWindow","reloadWindow","ONE_HOUR","ReloadChecker","setInterval","isReloadNeeded","isSameDay","BaseEvent","emit","onReload","DesktopChatWindow","preloadedEntities","legacyCurrentUser","getApplicationData","onInit","userInfo","setLogInfo","debugEnable","printWelcomePrompt","request","onAuthError","login","DesktopBrowserWindow","CHANNEL_DESKTOP","instance","notification","answerButtonClick","initBroadcastHandler","BroadcastChannel","data","isActiveTab","handleAction","message","postMessage","MessageNotifierManager","onNotifierClick","mediaParams","callParams","onAnswerButtonClick","DESKTOP_PROTOCOL_VERSION","LOCATION_RESET_TIMEOUT","isDesktopActive","setDesktopActive","flag","setDesktopVersion","version","getDesktopVersion","isLocationChangedToBx","isEmbeddedMode","redirectToChat","warn","link","openBxLink","redirectToChatWithBotContext","reject","preparedContext","redirectToLines","redirectToCopilot","redirectToCollab","redirectToChannel","redirectToTaskComments","redirectToNotifications","redirectToRecentSearch","redirectToConference","redirectToSettings","sectionName","redirectToChatCreation","redirectToVideoCall","withVideoParam","redirectToPhoneCall","redirectToCallList","openAccountTab","domainName","redirectToLayout","preparedEntityId","checkStatusInDifferentContext","checkForRedirect","isRedirectEnabled","isRedirectOptionEnabled","checkForOpenBrowserPage","ready","desktopVersion","isFeatureSupportedInVersion","enableRedirect","disableRedirect","FeatureManager","isFeatureAvailable","Feature","isDesktopRedirectAvailable","rawUrl","preparedUrl","compatData","location","href","test","replace","hostname"],"mappings":"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"}