{"version":3,"file":"registry.bundle.js","sources":["../src/base/base.js","../src/recent/recent.js","../src/user/user.js","../src/message/classes/message-base.js","../src/message/classes/channel.js","../src/message/classes/comments.js","../src/message/classes/copilot.js","../src/message/classes/ai-assistant.js","../src/message/classes/task-comments.js","../src/message/message-menu-manager.js","../src/sticker/sticker-pack.js","../src/sticker/sticker.js"],"sourcesContent":["import { EventEmitter } from 'main.core.events';\nimport { Event } from 'main.core';\nimport { Menu } from 'ui.system.menu';\nimport { Store } from 'ui.vue3.vuex';\nimport { RestClient } from 'rest.client';\n\nimport { Core } from 'im.v2.application.core';\n\nimport type { PopupTarget } from 'main.popup';\nimport type { MenuItemOptions, MenuOptions, MenuSectionOptions } from 'ui.system.menu';\n\nconst EVENT_NAMESPACE = 'BX.Messenger.v2.Lib.Menu';\n\nexport class BaseMenu extends EventEmitter\n{\n\tmenuInstance: Menu;\n\tcontext: Object;\n\ttarget: HTMLElement;\n\tstore: Store;\n\trestClient: RestClient;\n\tid: String = 'im-base-context-menu';\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace(EVENT_NAMESPACE);\n\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t}\n\n\t// public\n\topenMenu(context: Object, target: PopupTarget)\n\t{\n\t\tif (this.menuInstance)\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\tthis.context = context;\n\t\tthis.target = target;\n\t\tthis.menuInstance = new Menu(this.getMenuOptions());\n\t\tthis.menuInstance.show(this.target);\n\n\t\tthis.#bindBlurEvent();\n\t}\n\n\tgetMenuOptions(): MenuOptions\n\t{\n\t\treturn {\n\t\t\tid: this.id,\n\t\t\tbindOptions: { forceBindPosition: true, position: 'bottom' },\n\t\t\ttargetContainer: document.body,\n\t\t\tcacheable: false,\n\t\t\tcloseByEsc: true,\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\titems: this.#prepareItems(),\n\t\t\tsections: this.getMenuGroups(),\n\t\t\tevents: {\n\t\t\t\tonClose: () => this.close(),\n\t\t\t\tonDestroy: () => this.destroy(),\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMenuItems(): MenuItemOptions | null[]\n\t{\n\t\treturn [];\n\t}\n\n\tgetMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [];\n\t}\n\n\tgroupItems(menuItems: MenuItemOptions | null[], group: string): MenuItemOptions[]\n\t{\n\t\treturn menuItems.filter((item) => item !== null).map((item: MenuItemOptions) => {\n\t\t\treturn {\n\t\t\t\t...item,\n\t\t\t\tsectionCode: group,\n\t\t\t};\n\t\t});\n\t}\n\n\tgetMenuClassName(): string\n\t{\n\t\treturn '';\n\t}\n\n\tclose()\n\t{\n\t\tthis.emit('close');\n\t\tif (!this.menuInstance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.menuInstance.destroy();\n\t\tthis.menuInstance = null;\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.close();\n\t}\n\n\tgetCurrentUserId(): number\n\t{\n\t\treturn Core.getUserId();\n\t}\n\n\t#prepareItems(): MenuItemOptions[]\n\t{\n\t\treturn this.getMenuItems().filter((item) => item !== null);\n\t}\n\n\t#bindBlurEvent(): void\n\t{\n\t\tEvent.bindOnce(window, 'blur', () => {\n\t\t\tthis.destroy();\n\t\t});\n\t}\n}\n","import { Loc, Type } from 'main.core';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\n\nimport { Core } from 'im.v2.application.core';\nimport { ActionByRole, EventType, SidebarDetailBlock, ChatType, UserType, ActionByUserType } from 'im.v2.const';\nimport { CallManager } from 'im.v2.lib.call';\nimport { LegacyRecentService } from 'im.v2.provider.service.recent';\nimport { ChatService } from 'im.v2.provider.service.chat';\nimport { Utils } from 'im.v2.lib.utils';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { showLeaveChatConfirm } from 'im.v2.lib.confirm';\nimport { ChannelManager } from 'im.v2.lib.channel';\nimport { Messenger } from 'im.public';\nimport { InviteManager } from 'im.v2.lib.invite';\nimport { Analytics } from 'im.v2.lib.analytics';\n\nimport { BaseMenu } from '../base/base';\n\nimport type { EventEmitter } from 'main.core.events';\nimport type { MenuItemOptions, MenuSectionOptions, MenuOptions } from 'ui.system.menu';\nimport type { ImModelRecentItem, ImModelUser, ImModelChat } from 'im.v2.model';\nimport type { ApplicationContext } from 'im.v2.const';\n\ntype MenuItemContext = {\n\tdialogId: string,\n\tcompactMode?: boolean,\n\trecentItem?: ImModelRecentItem\n}\n\nconst MenuSectionCode = {\n\tfirst: 'first',\n\tsecond: 'second',\n\tthird: 'third',\n};\n\nexport class RecentMenu extends BaseMenu\n{\n\temitter: EventEmitter;\n\tcontext: MenuItemContext;\n\tcallManager: CallManager;\n\tpermissionManager: PermissionManager;\n\tchatService: ChatService;\n\n\tconstructor(applicationContext: ApplicationContext)\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-recent-context-menu';\n\t\tthis.chatService = new ChatService();\n\t\tthis.callManager = CallManager.getInstance();\n\t\tthis.permissionManager = PermissionManager.getInstance();\n\n\t\tconst { emitter } = applicationContext;\n\t\tthis.emitter = emitter;\n\t}\n\n\tgetMenuOptions(): MenuOptions\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t};\n\t}\n\n\tgetMenuClassName(): string\n\t{\n\t\treturn this.context.compactMode ? '' : super.getMenuClassName();\n\t}\n\n\tgetMenuItems(): MenuItemOptions | null[]\n\t{\n\t\tif (this.#isInvitationActive())\n\t\t{\n\t\t\tconst firstGroupItems = [\n\t\t\t\tthis.getSendMessageItem(),\n\t\t\t\tthis.getOpenProfileItem(),\n\t\t\t];\n\n\t\t\treturn [\n\t\t\t\t...this.groupItems(firstGroupItems, MenuSectionCode.first),\n\t\t\t\t...this.groupItems(this.getInviteItems(), MenuSectionCode.second),\n\t\t\t];\n\t\t}\n\n\t\treturn [\n\t\t\tthis.getUnreadMessageItem(),\n\t\t\tthis.getPinMessageItem(),\n\t\t\tthis.getMuteItem(),\n\t\t\tthis.getOpenProfileItem(),\n\t\t\tthis.getChatsWithUserItem(),\n\t\t\tthis.getHideItem(),\n\t\t\tthis.getLeaveItem(),\n\t\t];\n\t}\n\n\tgetMenuGroups(): MenuSectionOptions[]\n\t{\n\t\tif (this.#isInvitationActive())\n\t\t{\n\t\t\treturn [\n\t\t\t\t{ code: MenuSectionCode.first },\n\t\t\t\t{ code: MenuSectionCode.second },\n\t\t\t];\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tgetSendMessageItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_WRITE_V2'),\n\t\t\tonClick: () => {\n\t\t\t\tvoid Messenger.openChat(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetOpenItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_OPEN'),\n\t\t\tonClick: () => {\n\t\t\t\tvoid Messenger.openChat(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetUnreadMessageItem(): ?MenuItemOptions\n\t{\n\t\tconst { recentItem, dialogId } = this.context;\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst dialog = this.store.getters['chats/get'](dialogId, true);\n\t\tconst showReadOption = recentItem.unread || dialog.counter > 0;\n\n\t\treturn {\n\t\t\ttitle: showReadOption ? Loc.getMessage('IM_LIB_MENU_READ') : Loc.getMessage('IM_LIB_MENU_UNREAD'),\n\t\t\tonClick: () => {\n\t\t\t\tif (showReadOption)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.readDialog(dialogId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.unreadDialog(dialogId);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetPinMessageItem(): ?MenuItemOptions\n\t{\n\t\tconst { recentItem, dialogId } = this.context;\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isPinned = recentItem.pinned;\n\n\t\treturn {\n\t\t\ttitle: isPinned ? Loc.getMessage('IM_LIB_MENU_UNPIN_MSGVER_1') : Loc.getMessage('IM_LIB_MENU_PIN_MSGVER_1'),\n\t\t\tonClick: () => {\n\t\t\t\tif (isPinned)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.unpinChat(dialogId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.pinChat(dialogId);\n\t\t\t\t\tAnalytics.getInstance().chatPins.onPin(dialogId);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMuteItem(): ?MenuItemOptions\n\t{\n\t\tconst { dialogId } = this.context;\n\t\tconst canMute = this.permissionManager.canPerformActionByRole(ActionByRole.mute, dialogId);\n\t\tif (!canMute)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst dialog = this.store.getters['chats/get'](dialogId, true);\n\t\tconst isMuted = dialog.muteList.includes(Core.getUserId());\n\n\t\treturn {\n\t\t\ttitle: isMuted ? Loc.getMessage('IM_LIB_MENU_UNMUTE_2') : Loc.getMessage('IM_LIB_MENU_MUTE_2'),\n\t\t\tonClick: () => {\n\t\t\t\tif (isMuted)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.unmuteChat(dialogId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.muteChat(dialogId);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetOpenProfileItem(): ?MenuItemOptions\n\t{\n\t\tif (!this.isUser() || this.isBot())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = Utils.user.getProfileLink(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_OPEN_PROFILE_V2'),\n\t\t\tonClick: () => {\n\t\t\t\tBX.SidePanel.Instance.open(profileUri);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetHideItem(): ?MenuItemOptions\n\t{\n\t\tif (!this.#canHideChat())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_HIDE_MSGVER_1'),\n\t\t\tonClick: () => {\n\t\t\t\tLegacyRecentService.getInstance().hideChat(this.context.dialogId);\n\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetLeaveItem(): ?MenuItemOptions\n\t{\n\t\tif (this.isCollabChat())\n\t\t{\n\t\t\treturn this.#leaveCollab();\n\t\t}\n\n\t\treturn this.#leaveChat();\n\t}\n\n\tgetChatsWithUserItem(): ?MenuItemOptions\n\t{\n\t\tif (!this.isUser() || this.isBot() || this.isChatWithCurrentUser())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isAnyChatOpened = this.store.getters['application/getLayout'].entityId.length > 0;\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_FIND_SHARED_CHATS'),\n\t\t\tonClick: async () => {\n\t\t\t\tif (!isAnyChatOpened)\n\t\t\t\t{\n\t\t\t\t\tawait Messenger.openChat(this.context.dialogId);\n\t\t\t\t}\n\n\t\t\t\tthis.emitter.emit(EventType.sidebar.open, {\n\t\t\t\t\tpanel: SidebarDetailBlock.chatsWithUser,\n\t\t\t\t\tstandalone: true,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\t// region invitation\n\tgetInviteItems(): MenuItemOptions[]\n\t{\n\t\tconst { recentItem } = this.context;\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst items = [];\n\n\t\tlet canInvite; // TODO change to APPLICATION variable\n\t\tif (Type.isUndefined(BX.MessengerProxy))\n\t\t{\n\t\t\tcanInvite = true;\n\t\t\tconsole.error('BX.MessengerProxy.canInvite() method not found in v2 version!');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcanInvite = BX.MessengerProxy.canInvite();\n\t\t}\n\n\t\tconst canManageInvite = canInvite && Core.getUserId() === recentItem.invitation.originator;\n\t\tif (canManageInvite)\n\t\t{\n\t\t\titems.push(\n\t\t\t\tthis.getResendInviteItem(),\n\t\t\t\tthis.getCancelInviteItem(),\n\t\t\t);\n\t\t}\n\n\t\treturn items;\n\t}\n\n\tgetResendInviteItem(): ?MenuItemOptions\n\t{\n\t\tconst { recentItem, dialogId } = this.context;\n\t\tif (!recentItem || !this.#canResendInvitation())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_INVITE_RESEND'),\n\t\t\tonClick: () => {\n\t\t\t\tInviteManager.resendInvite(dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetCancelInviteItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_INVITE_CANCEL'),\n\t\t\tonClick: () => {\n\t\t\t\tMessageBox.show({\n\t\t\t\t\tmessage: Loc.getMessage('IM_LIB_INVITE_CANCEL_CONFIRM'),\n\t\t\t\t\tmodal: true,\n\t\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\t\tonOk: (messageBox) => {\n\t\t\t\t\t\tInviteManager.cancelInvite(this.context.dialogId);\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t\tonCancel: (messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\t// endregion\n\n\tgetChat(): ImModelChat\n\t{\n\t\treturn this.store.getters['chats/get'](this.context.dialogId, true);\n\t}\n\n\tisUser(): boolean\n\t{\n\t\treturn this.store.getters['chats/isUser'](this.context.dialogId);\n\t}\n\n\tisBot(): boolean\n\t{\n\t\tif (!this.isUser())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst user: ImModelUser = this.store.getters['users/get'](this.context.dialogId);\n\n\t\treturn user.type === UserType.bot;\n\t}\n\n\tisChannel(): boolean\n\t{\n\t\treturn ChannelManager.isChannel(this.context.dialogId);\n\t}\n\n\tisCommentsChat(): boolean\n\t{\n\t\tconst { type }: ImModelChat = this.store.getters['chats/get'](this.context.dialogId, true);\n\n\t\treturn type === ChatType.comment;\n\t}\n\n\tisCollabChat(): boolean\n\t{\n\t\tconst { type }: ImModelChat = this.store.getters['chats/get'](this.context.dialogId, true);\n\n\t\treturn type === ChatType.collab;\n\t}\n\n\tisChatWithCurrentUser(): boolean\n\t{\n\t\treturn this.getCurrentUserId() === Number.parseInt(this.context.dialogId, 10);\n\t}\n\n\t#leaveChat(): ?MenuItemOptions\n\t{\n\t\tconst canLeaveChat = this.permissionManager.canPerformActionByRole(ActionByRole.leave, this.context.dialogId);\n\t\tif (!canLeaveChat)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst title = this.isChannel()\n\t\t\t? Loc.getMessage('IM_LIB_MENU_LEAVE_CHANNEL')\n\t\t\t: Loc.getMessage('IM_LIB_MENU_LEAVE_MSGVER_1')\n\t\t;\n\n\t\treturn {\n\t\t\ttitle,\n\t\t\tonClick: async () => {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t\tconst userChoice = await showLeaveChatConfirm(this.context.dialogId);\n\t\t\t\tif (userChoice === true)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.leaveChat(this.context.dialogId);\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t}\n\n\t#leaveCollab(): ?MenuItemOptions\n\t{\n\t\tconst canLeaveChat = this.permissionManager.canPerformActionByRole(ActionByRole.leave, this.context.dialogId);\n\t\tconst canLeaveCollab = this.permissionManager.canPerformActionByUserType(ActionByUserType.leaveCollab);\n\t\tif (!canLeaveChat || !canLeaveCollab)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_LEAVE_MSGVER_1'),\n\t\t\tonClick: async () => {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t\tconst userChoice = await showLeaveChatConfirm(this.context.dialogId);\n\t\t\t\tif (!userChoice)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.chatService.leaveCollab(this.context.dialogId);\n\t\t\t},\n\t\t};\n\t}\n\n\t#canHideChat(): boolean\n\t{\n\t\tconst { recentItem, dialogId } = this.context;\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isInvitation = this.#isInvitationActive();\n\t\tconst isFakeUser = recentItem.isFakeElement;\n\t\tconst isAiAssistantBot = this.store.getters['users/bots/isAiAssistant'](dialogId);\n\n\t\treturn !isInvitation && !isFakeUser && !isAiAssistantBot;\n\t}\n\n\t#isInvitationActive(): boolean\n\t{\n\t\tconst { recentItem } = this.context;\n\t\tif (!recentItem || !recentItem.invitation)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn recentItem.invitation.isActive;\n\t}\n\n\t#canResendInvitation(): boolean\n\t{\n\t\tconst { recentItem } = this.context;\n\t\tif (!recentItem || !recentItem.invitation)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn recentItem.invitation.canResend;\n\t}\n}\n","import { Loc } from 'main.core';\n\nimport { Messenger } from 'im.public';\nimport { Utils } from 'im.v2.lib.utils';\nimport { ChatService } from 'im.v2.provider.service.chat';\nimport { showKickUserConfirm } from 'im.v2.lib.confirm';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { ActionByRole, ChatType, EventType, UserType } from 'im.v2.const';\n\nimport { BaseMenu } from '../base/base';\n\nimport type { EventEmitter } from 'main.core.events';\nimport type { MenuItemOptions } from 'ui.system.menu';\nimport type { ImModelUser, ImModelChat } from 'im.v2.model';\nimport type { ApplicationContext } from 'im.v2.const';\n\ntype UserMenuContext = {\n\tuser: ImModelUser,\n\tdialog: ImModelChat\n};\n\nexport class UserMenu extends BaseMenu\n{\n\temitter: EventEmitter;\n\tcontext: UserMenuContext;\n\tpermissionManager: PermissionManager;\n\n\tconstructor(applicationContext: ApplicationContext)\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'bx-im-user-context-menu';\n\t\tthis.permissionManager = PermissionManager.getInstance();\n\n\t\tconst { emitter } = applicationContext;\n\t\tthis.emitter = emitter;\n\t}\n\n\tgetKickItem(): ?MenuItemOptions\n\t{\n\t\tconst canKick = this.permissionManager.canPerformActionByRole(ActionByRole.kick, this.context.dialog.dialogId);\n\t\tif (!canKick)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: this.#getKickItemText(),\n\t\t\tonClick: async () => {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t\tconst userChoice = await showKickUserConfirm(this.context.dialog.dialogId);\n\t\t\t\tif (userChoice !== true)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvoid this.#kickUser();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMentionItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_USER_MENTION'),\n\t\t\tonClick: () => {\n\t\t\t\tthis.emitter.emit(EventType.textarea.insertMention, {\n\t\t\t\t\tmentionText: this.context.user.name,\n\t\t\t\t\tmentionReplacement: Utils.text.getMentionBbCode(this.context.user.id, this.context.user.name),\n\t\t\t\t\tdialogId: this.context.dialog.dialogId,\n\t\t\t\t\tisMentionSymbol: false,\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetSendItem(): ?MenuItemOptions\n\t{\n\t\tif (this.context.dialog.type === ChatType.user)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_USER_WRITE'),\n\t\t\tonClick: () => {\n\t\t\t\tvoid Messenger.openChat(this.context.user.id);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetProfileItem(): ?MenuItemOptions\n\t{\n\t\tif (this.isBot())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = Utils.user.getProfileLink(this.context.user.id);\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_OPEN_PROFILE_V2'),\n\t\t\tonClick: () => {\n\t\t\t\tBX.SidePanel.Instance.open(profileUri);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tisCollabChat(): boolean\n\t{\n\t\tconst { type }: ImModelChat = this.store.getters['chats/get'](this.context.dialog.dialogId, true);\n\n\t\treturn type === ChatType.collab;\n\t}\n\n\tisBot(): boolean\n\t{\n\t\treturn this.context.user.type === UserType.bot;\n\t}\n\n\t#getKickItemText(): string\n\t{\n\t\tif (this.isCollabChat())\n\t\t{\n\t\t\treturn Loc.getMessage('IM_LIB_MENU_USER_KICK_FROM_COLLAB');\n\t\t}\n\n\t\treturn Loc.getMessage('IM_LIB_MENU_USER_KICK_FROM_CHAT');\n\t}\n\n\t#kickUser(): Promise\n\t{\n\t\tif (this.isCollabChat())\n\t\t{\n\t\t\treturn (new ChatService()).kickUserFromCollab(this.context.dialog.dialogId, this.context.user.id);\n\t\t}\n\n\t\treturn (new ChatService()).kickUserFromChat(this.context.dialog.dialogId, this.context.user.id);\n\t}\n}\n","import { Loc, Type } from 'main.core';\nimport { MenuItemDesign } from 'ui.system.menu';\nimport { Outline as OutlineIcons } from 'ui.icon-set.api.core';\n\nimport { ChatManager } from 'im.v2.lib.chat';\nimport { MessageManager } from 'im.v2.lib.message';\nimport { PromoManager } from 'im.v2.lib.promo';\nimport { Analytics } from 'im.v2.lib.analytics';\nimport { ChannelManager } from 'im.v2.lib.channel';\nimport { Core } from 'im.v2.application.core';\nimport { Parser } from 'im.v2.lib.parser';\nimport { EntityCreator } from 'im.v2.lib.entity-creator';\nimport { MessageService } from 'im.v2.provider.service.message';\nimport { DiskService } from 'im.v2.provider.service.disk';\nimport { EventType, PlacementType, ActionByRole, PromoId } from 'im.v2.const';\nimport { MarketManager } from 'im.v2.lib.market';\nimport { Utils } from 'im.v2.lib.utils';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { showDeleteChannelPostConfirm, showDownloadAllFilesConfirm } from 'im.v2.lib.confirm';\nimport { Notifier } from 'im.v2.lib.notifier';\nimport { FeatureManager, Feature } from 'im.v2.lib.feature';\n\n// noinspection ES6PreferShortImport\nimport { BaseMenu } from '../../base/base';\n\nimport type { EventEmitter } from 'main.core.events';\nimport type { MenuItemOptions, MenuOptions, MenuSectionOptions } from 'ui.system.menu';\nimport type { ImModelMessage, ImModelChat, ImModelFile } from 'im.v2.model';\nimport type { ApplicationContext } from 'im.v2.const';\n\nexport type MessageMenuContext = ImModelMessage & { dialogId: string };\n\nexport const MenuSectionCode = {\n\tfirst: 'first',\n\tsecond: 'second',\n\tthird: 'third',\n};\n\nexport const NestedMenuSectionCode = {\n\tfirst: 'first',\n\tsecond: 'second',\n\tthird: 'third',\n};\n\nexport class MessageMenu extends BaseMenu\n{\n\temitter: EventEmitter;\n\tcontext: MessageMenuContext;\n\tdiskService: DiskService;\n\n\tmaxPins: number = 20;\n\n\tconstructor(applicationContext: ApplicationContext)\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'bx-im-message-context-menu';\n\t\tthis.diskService = new DiskService();\n\t\tthis.marketManager = MarketManager.getInstance();\n\n\t\tconst { emitter } = applicationContext;\n\t\tthis.emitter = emitter;\n\t}\n\n\tgetMenuOptions(): MenuOptions\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\tangle: true,\n\t\t\toffsetLeft: 11,\n\t\t\tminWidth: 238,\n\t\t};\n\t}\n\n\tgetMenuItems(): (MenuItemOptions | null)[]\n\t{\n\t\tconst firstGroupItems = [\n\t\t\tthis.getReplyItem(),\n\t\t\tthis.getCopyItem(),\n\t\t\tthis.getEditItem(),\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getForwardItem(),\n\t\t\tthis.getAskCopilotItem(),\n\t\t\tthis.getCreateTaskItem(),\n\t\t\t...this.getAdditionalItems(),\n\t\t];\n\n\t\tconst secondGroupItems = [\n\t\t\tthis.getDeleteItem(),\n\t\t\tthis.getSelectItem(),\n\t\t];\n\n\t\treturn [\n\t\t\t...this.groupItems(firstGroupItems, MenuSectionCode.first),\n\t\t\t...this.groupItems(secondGroupItems, MenuSectionCode.second),\n\t\t];\n\t}\n\n\tgetMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [\n\t\t\t{ code: MenuSectionCode.first },\n\t\t\t{ code: MenuSectionCode.second },\n\t\t];\n\t}\n\n\tgetNestedMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [\n\t\t\t{ code: NestedMenuSectionCode.first },\n\t\t\t{ code: NestedMenuSectionCode.second },\n\t\t];\n\t}\n\n\tgetSelectItem(): ?MenuItemOptions\n\t{\n\t\tif (this.isDeletedMessage() || !this.isRealMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_SELECT'),\n\t\t\ticon: OutlineIcons.CIRCLE_CHECK,\n\t\t\tonClick: () => {\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onSelect(this.context.dialogId);\n\n\t\t\t\tthis.emitter.emit(EventType.dialog.openBulkActionsMode, {\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetReplyItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_REPLY'),\n\t\t\tonClick: () => {\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onReply(this.context.dialogId);\n\t\t\t\tthis.emitter.emit(EventType.textarea.replyMessage, {\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t\ticon: OutlineIcons.QUOTE,\n\t\t};\n\t}\n\n\tgetForwardItem(): ?MenuItemOptions\n\t{\n\t\tif (this.isDeletedMessage() || !this.isRealMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_FORWARD'),\n\t\t\ticon: OutlineIcons.FORWARD,\n\t\t\tonClick: () => {\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onForward(this.context.dialogId);\n\t\t\t\tthis.emitter.emit(EventType.dialog.showForwardPopup, {\n\t\t\t\t\tmessagesIds: [this.context.id],\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetCopyItem(): ?MenuItemOptions\n\t{\n\t\tif (this.isDeletedMessage() || this.context.text.trim().length === 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_COPY'),\n\t\t\tonClick: async () => {\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onCopyText({\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t});\n\n\t\t\t\tconst textToCopy = Parser.prepareCopy(this.context);\n\n\t\t\t\tawait Utils.text.copyToClipboard(textToCopy);\n\t\t\t\tNotifier.message.onCopyComplete();\n\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t\ticon: OutlineIcons.COPY,\n\t\t};\n\t}\n\n\tgetCopyLinkItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_COPY_LINK_MSGVER_1'),\n\t\t\ticon: OutlineIcons.LINK,\n\t\t\tonClick: () => {\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onCopyLink(this.context.dialogId);\n\n\t\t\t\tconst textToCopy = ChatManager.buildMessageLink(this.context.dialogId, this.context.id);\n\t\t\t\tif (BX.clipboard?.copy(textToCopy))\n\t\t\t\t{\n\t\t\t\t\tNotifier.message.onCopyLinkComplete();\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetCopyFileItem(): ?MenuItemOptions\n\t{\n\t\tif (this.context.files.length !== 1)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_COPY_FILE'),\n\t\t\ticon: OutlineIcons.COPY,\n\t\t\tonClick: () => {\n\t\t\t\tconst fileId = this.context.files[0];\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onCopyFile({\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t\tfileId,\n\t\t\t\t});\n\n\t\t\t\tconst textToCopy = Parser.prepareCopyFile(this.context);\n\t\t\t\tif (BX.clipboard?.copy(textToCopy))\n\t\t\t\t{\n\t\t\t\t\tNotifier.file.onCopyComplete();\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetPinItem(): ?MenuItemOptions\n\t{\n\t\tconst canPin = PermissionManager.getInstance().canPerformActionByRole(\n\t\t\tActionByRole.pinMessage,\n\t\t\tthis.context.dialogId,\n\t\t);\n\n\t\tif (this.isDeletedMessage() || !canPin)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isPinned = this.store.getters['messages/pin/isPinned']({\n\t\t\tchatId: this.context.chatId,\n\t\t\tmessageId: this.context.id,\n\t\t});\n\n\t\treturn {\n\t\t\ttitle: isPinned ? Loc.getMessage('IM_DIALOG_CHAT_MENU_UNPIN') : Loc.getMessage('IM_DIALOG_CHAT_MENU_PIN'),\n\t\t\ticon: OutlineIcons.PIN,\n\t\t\tonClick: () => {\n\t\t\t\tconst messageService = new MessageService({ chatId: this.context.chatId });\n\t\t\t\tif (isPinned)\n\t\t\t\t{\n\t\t\t\t\tmessageService.unpinMessage(this.context.chatId, this.context.id);\n\t\t\t\t\tAnalytics.getInstance().messageContextMenu.onUnpin(this.context.dialogId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (this.#arePinsExceedLimit())\n\t\t\t\t\t{\n\t\t\t\t\t\tNotifier.chat.onMessagesPinLimitError(this.maxPins);\n\t\t\t\t\t\tAnalytics.getInstance().messageContextMenu.onReachingPinsLimit(this.context.dialogId);\n\t\t\t\t\t\tthis.menuInstance.close();\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessageService.pinMessage(this.context.chatId, this.context.id);\n\t\t\t\t\tAnalytics.getInstance().messageContextMenu.onPin(this.context.dialogId);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetFavoriteItem(): MenuItemOptions\n\t{\n\t\tif (this.isDeletedMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isInFavorite = this.store.getters['sidebar/favorites/isFavoriteMessage'](this.context.chatId, this.context.id);\n\n\t\tconst menuItemText = isInFavorite\n\t\t\t? Loc.getMessage('IM_DIALOG_CHAT_MENU_REMOVE_FROM_SAVED')\n\t\t\t: Loc.getMessage('IM_DIALOG_CHAT_MENU_SAVE')\n\t\t;\n\n\t\treturn {\n\t\t\ttitle: menuItemText,\n\t\t\ticon: OutlineIcons.FAVORITE,\n\t\t\tonClick: () => {\n\t\t\t\tconst messageService = new MessageService({ chatId: this.context.chatId });\n\t\t\t\tif (isInFavorite)\n\t\t\t\t{\n\t\t\t\t\tmessageService.removeMessageFromFavorite(this.context.id);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tAnalytics.getInstance().messageContextMenu.onAddFavorite({\n\t\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\t});\n\n\t\t\t\t\tmessageService.addMessageToFavorite(this.context.id);\n\t\t\t\t}\n\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMarkItem(): ?MenuItemOptions\n\t{\n\t\tconst canUnread = this.context.viewed && !this.isOwnMessage();\n\n\t\tconst dialog: ImModelChat = this.store.getters['chats/getByChatId'](this.context.chatId);\n\t\tconst isMarked = this.context.id === dialog.markedId;\n\t\tif (!canUnread || isMarked)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_MARK'),\n\t\t\ticon: OutlineIcons.NEW_MESSAGE,\n\t\t\tonClick: () => {\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onMark(this.context.dialogId);\n\n\t\t\t\tconst messageService = new MessageService({ chatId: this.context.chatId });\n\t\t\t\tmessageService.markMessage(this.context.id);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetCreateTaskItem(): ?MenuItemOptions\n\t{\n\t\tif (this.isDeletedMessage() || this.#isStickerMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_CREATE_TASK_MSGVER_1'),\n\t\t\ticon: OutlineIcons.TASK,\n\t\t\tonClick: () => {\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onCreateTask(this.context.dialogId);\n\n\t\t\t\tconst entityCreator = new EntityCreator(this.context.chatId);\n\t\t\t\tvoid entityCreator.createTaskForMessage(this.context.id);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetCreateMeetingItem(): ?MenuItemOptions\n\t{\n\t\tif (this.isDeletedMessage() || this.#isStickerMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_CREATE_MEETING_MSGVER_1'),\n\t\t\ticon: OutlineIcons.CALENDAR_WITH_SLOTS,\n\t\t\tonClick: () => {\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onCreateEvent(this.context.dialogId);\n\n\t\t\t\tconst entityCreator = new EntityCreator(this.context.chatId);\n\t\t\t\tvoid entityCreator.createMeetingForMessage(this.context.id);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetEditItem(): ?MenuItemOptions\n\t{\n\t\tif (!MessageManager.isEditable(this.context.id))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_EDIT'),\n\t\t\ticon: OutlineIcons.EDIT_L,\n\t\t\tonClick: () => {\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onEdit(this.context.dialogId);\n\n\t\t\t\tthis.emitter.emit(EventType.textarea.editMessage, {\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetAskCopilotItem(): ?MenuItemOptions\n\t{\n\t\tif (!FeatureManager.isFeatureAvailable(Feature.isCopilotMentionAvailable))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (!this.canSendMessage() || this.isDeletedMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isChannel = ChannelManager.isChannel(this.context.dialogId);\n\t\tif (isChannel)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst copilotBotDialogId = this.store.getters['users/bots/getCopilotBotDialogId'];\n\t\tconst { name: mentionText } = this.store.getters['users/get'](copilotBotDialogId, true);\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_ASK_COPILOT'),\n\t\t\ticon: OutlineIcons.COPILOT,\n\t\t\tdesign: MenuItemDesign.Copilot,\n\t\t\tonClick: () => {\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onAskCopilot(this.context.dialogId);\n\t\t\t\tthis.emitter.emit(EventType.textarea.insertMention, {\n\t\t\t\t\tmentionText,\n\t\t\t\t\tmentionReplacement: Utils.text.getMentionBbCode(copilotBotDialogId, mentionText),\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\n\t\t\t\tthis.emitter.emit(EventType.textarea.replyMessage, {\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetDeleteItem(): ?MenuItemOptions\n\t{\n\t\tif (this.isDeletedMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst permissionManager = PermissionManager.getInstance();\n\t\tconst canDeleteOthersMessage = permissionManager.canPerformActionByRole(\n\t\t\tActionByRole.deleteOthersMessage,\n\t\t\tthis.context.dialogId,\n\t\t);\n\n\t\tif (!this.isOwnMessage() && !canDeleteOthersMessage)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_DELETE'),\n\t\t\tdesign: MenuItemDesign.Alert,\n\t\t\ticon: OutlineIcons.TRASHCAN,\n\t\t\tonClick: this.#onDelete.bind(this),\n\t\t};\n\t}\n\n\tgetMarketItems(): MenuItemOptions[]\n\t{\n\t\tconst { dialogId, id } = this.context;\n\t\tconst placements = this.marketManager.getAvailablePlacementsByType(PlacementType.contextMenu, dialogId);\n\t\tconst marketMenuItem = [];\n\n\t\tconst context = { messageId: id, dialogId };\n\n\t\tplacements.forEach((placement) => {\n\t\t\tmarketMenuItem.push({\n\t\t\t\ttitle: placement.title,\n\t\t\t\ticon: OutlineIcons.MARKET,\n\t\t\t\tonClick: () => {\n\t\t\t\t\tvoid MarketManager.openSlider(placement, context);\n\t\t\t\t\tthis.menuInstance.close();\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tconst MARKET_ITEMS_LIMIT = 10;\n\n\t\treturn marketMenuItem.slice(0, MARKET_ITEMS_LIMIT);\n\t}\n\n\tgetDownloadFileItem(): ?MenuItemOptions\n\t{\n\t\tif (!Type.isArrayFilled(this.context.files))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.#isSingleFile())\n\t\t{\n\t\t\treturn this.#getDownloadSingleFileItem();\n\t\t}\n\n\t\treturn this.#getDownloadSeveralFilesItem();\n\t}\n\n\tgetSaveToDiskItem(): ?MenuItemOptions\n\t{\n\t\tif (!Type.isArrayFilled(this.context.files))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst menuItemText = this.#isSingleFile()\n\t\t\t? Loc.getMessage('IM_DIALOG_CHAT_MENU_SAVE_ON_DISK_MSGVER_1')\n\t\t\t: Loc.getMessage('IM_DIALOG_CHAT_MENU_SAVE_ALL_ON_DISK');\n\n\t\treturn {\n\t\t\ttitle: menuItemText,\n\t\t\ticon: OutlineIcons.FOLDER_24,\n\t\t\tonClick: async function() {\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onSaveOnDisk({\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\n\t\t\t\tthis.menuInstance.close();\n\t\t\t\tawait this.diskService.save(this.context.files);\n\t\t\t\tNotifier.file.onDiskSaveComplete(this.#isSingleFile());\n\t\t\t}.bind(this),\n\t\t};\n\t}\n\n\tgetAdditionalItems(): MenuItemOptions[]\n\t{\n\t\tconst items = this.getNestedItems();\n\t\tif (this.#needNestedMenu(items))\n\t\t{\n\t\t\treturn [{\n\t\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_MORE'),\n\t\t\t\tsubMenu: {\n\t\t\t\t\titems,\n\t\t\t\t\tsections: this.getNestedMenuGroups(),\n\t\t\t\t},\n\t\t\t}];\n\t\t}\n\n\t\treturn items;\n\t}\n\n\tgetNestedItems(): MenuItemOptions[]\n\t{\n\t\tconst firstGroupItems = [\n\t\t\tthis.getPinItem(),\n\t\t\tthis.getCopyLinkItem(),\n\t\t\tthis.getCopyFileItem(),\n\t\t\tthis.getMarkItem(),\n\t\t\tthis.getFavoriteItem(),\n\t\t\tthis.getSaveToDiskItem(),\n\t\t\tthis.getCreateMeetingItem(),\n\t\t];\n\n\t\treturn [\n\t\t\t...this.groupItems(firstGroupItems, NestedMenuSectionCode.first),\n\t\t\t...this.groupItems(this.getMarketItems(), NestedMenuSectionCode.second),\n\t\t];\n\t}\n\n\tisOwnMessage(): boolean\n\t{\n\t\treturn this.context.authorId === Core.getUserId();\n\t}\n\n\tisDeletedMessage(): boolean\n\t{\n\t\treturn this.context.isDeleted;\n\t}\n\n\tisRealMessage(): boolean\n\t{\n\t\treturn this.store.getters['messages/isRealMessage'](this.context.id);\n\t}\n\n\tcanSendMessage(): boolean\n\t{\n\t\tconst dialog = Core.getStore().getters['chats/get'](this.context.dialogId, true);\n\n\t\tif (!dialog.isTextareaEnabled)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn PermissionManager.getInstance().canPerformActionByRole(ActionByRole.send, this.context.dialogId);\n\t}\n\n\t#isStickerMessage(): boolean\n\t{\n\t\treturn this.store.getters['stickers/messages/isSticker'](this.context.id);\n\t}\n\n\t#needNestedMenu(additionalItems: MenuItemOptions[]): boolean\n\t{\n\t\tconst NESTED_MENU_MIN_ITEMS = 3;\n\t\tconst menuItems = additionalItems.filter((item) => item !== null);\n\n\t\treturn menuItems.length >= NESTED_MENU_MIN_ITEMS;\n\t}\n\n\t#getFirstFile(): ?ImModelFile\n\t{\n\t\treturn this.store.getters['files/get'](this.context.files[0]);\n\t}\n\n\t#isSingleFile(): boolean\n\t{\n\t\treturn this.context.files.length === 1;\n\t}\n\n\tasync #onDelete()\n\t{\n\t\tconst { id: messageId, dialogId, chatId } = this.context;\n\t\tAnalytics.getInstance().messageContextMenu.onDelete({ messageId, dialogId });\n\t\tthis.menuInstance.close();\n\n\t\tif (await this.#isDeletionCancelled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst messageService = new MessageService({ chatId });\n\t\tmessageService.deleteMessages([messageId]);\n\t}\n\n\tasync #isDeletionCancelled(): Promise<boolean>\n\t{\n\t\tconst { id: messageId, dialogId } = this.context;\n\t\tif (!ChannelManager.isChannel(dialogId))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst confirmResult = await showDeleteChannelPostConfirm();\n\t\tif (!confirmResult)\n\t\t{\n\t\t\tAnalytics.getInstance().messageContextMenu.onCancelDelete({ messageId, dialogId });\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t#getDownloadSingleFileItem(): MenuItemOptions\n\t{\n\t\tconst file = this.#getFirstFile();\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_DOWNLOAD_FILE'),\n\t\t\ticon: OutlineIcons.DOWNLOAD,\n\t\t\tonClick: function() {\n\t\t\t\tUtils.file.downloadFiles([file]);\n\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onFileDownload({\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this),\n\t\t};\n\t}\n\n\t#getDownloadSeveralFilesItem(): MenuItemOptions\n\t{\n\t\tconst files: ImModelFile[] = this.context.files.map((fileId) => {\n\t\t\treturn this.store.getters['files/get'](fileId);\n\t\t});\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_DOWNLOAD_FILES'),\n\t\t\ticon: OutlineIcons.DOWNLOAD,\n\t\t\tonClick: async () => {\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onFileDownload({\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\t\t\t\tUtils.file.downloadFiles(files);\n\n\t\t\t\tconst needToShowPopup = PromoManager.getInstance().needToShow(PromoId.downloadSeveralFiles);\n\t\t\t\tif (needToShowPopup && Utils.browser.isChrome() && !Utils.platform.isBitrixDesktop())\n\t\t\t\t{\n\t\t\t\t\tthis.menuInstance?.close();\n\t\t\t\t\tawait showDownloadAllFilesConfirm();\n\t\t\t\t\tvoid PromoManager.getInstance().markAsWatched(PromoId.downloadSeveralFiles);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance?.close();\n\t\t\t},\n\t\t};\n\t}\n\n\t#arePinsExceedLimit(): string\n\t{\n\t\tconst pins = this.store.getters['messages/pin/getPinned'](this.context.chatId);\n\n\t\treturn pins.length >= this.maxPins;\n\t}\n}\n","import { MessageMenu, MenuSectionCode, NestedMenuSectionCode } from './message-base';\n\nimport type { MenuItemOptions, MenuSectionOptions } from 'ui.system.menu';\n\nexport class ChannelMessageMenu extends MessageMenu\n{\n\tgetMenuItems(): MenuItemOptions[]\n\t{\n\t\tconst firstGroupItems = [\n\t\t\tthis.getCopyItem(),\n\t\t\tthis.getEditItem(),\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getForwardItem(),\n\t\t\tthis.getAskCopilotItem(),\n\t\t\tthis.getCreateTaskItem(),\n\t\t\t...this.getAdditionalItems(),\n\t\t];\n\n\t\tconst secondGroupItems = [\n\t\t\tthis.getDeleteItem(),\n\t\t\tthis.getSelectItem(),\n\t\t];\n\n\t\treturn [\n\t\t\t...this.groupItems(firstGroupItems, MenuSectionCode.first),\n\t\t\t...this.groupItems(secondGroupItems, MenuSectionCode.second),\n\t\t];\n\t}\n\n\tgetNestedItems(): MenuItemOptions[]\n\t{\n\t\tconst firstGroupItems = [\n\t\t\tthis.getPinItem(),\n\t\t\tthis.getCopyLinkItem(),\n\t\t\tthis.getCopyFileItem(),\n\t\t\tthis.getMarkItem(),\n\t\t\tthis.getFavoriteItem(),\n\t\t\tthis.getSaveToDiskItem(),\n\t\t\tthis.getCreateMeetingItem(),\n\t\t];\n\n\t\treturn this.groupItems(firstGroupItems, NestedMenuSectionCode.first);\n\t}\n\n\tgetNestedMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [\n\t\t\t{ code: NestedMenuSectionCode.first },\n\t\t];\n\t}\n}\n","import { Loc } from 'main.core';\nimport { Outline as OutlineIcons } from 'ui.icon-set.api.core';\n\nimport { EventType } from 'im.v2.const';\nimport { ChannelManager } from 'im.v2.lib.channel';\n\nimport { MessageMenu, MenuSectionCode, NestedMenuSectionCode } from './message-base';\n\nimport type { MenuItemOptions, MenuSectionOptions } from 'ui.system.menu';\n\nexport class CommentsMessageMenu extends MessageMenu\n{\n\tgetMenuItems(): MenuItemOptions[]\n\t{\n\t\tconst message = this.context;\n\t\tconst contextDialogId = this.context.dialogId;\n\t\tif (ChannelManager.isCommentsPostMessage(message, contextDialogId))\n\t\t{\n\t\t\treturn this.#getCommentsPostMenuItems();\n\t\t}\n\n\t\treturn this.#getDefaultMenuItems();\n\t}\n\n\tgetNestedItems(): MenuItemOptions[]\n\t{\n\t\tconst firstGroupItems = [\n\t\t\tthis.getCopyFileItem(),\n\t\t\tthis.getFavoriteItem(),\n\t\t\tthis.getSaveToDiskItem(),\n\t\t\tthis.getCreateMeetingItem(),\n\t\t];\n\n\t\treturn this.groupItems(firstGroupItems, NestedMenuSectionCode.first);\n\t}\n\n\tgetMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [\n\t\t\t{ code: MenuSectionCode.first },\n\t\t\t{ code: MenuSectionCode.second },\n\t\t\t{ code: MenuSectionCode.third },\n\t\t];\n\t}\n\n\tgetNestedMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [\n\t\t\t{ code: NestedMenuSectionCode.first },\n\t\t];\n\t}\n\n\tgetOpenInChannelItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_COMMENTS_OPEN_IN_CHANNEL'),\n\t\t\ticon: OutlineIcons.GO_TO_MESSAGE,\n\t\t\tonClick: () => {\n\t\t\t\tthis.emitter.emit(EventType.dialog.closeComments);\n\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\t#getCommentsPostMenuItems(): MenuItemOptions[]\n\t{\n\t\tconst firstGroupItems = [\n\t\t\tthis.getCopyItem(),\n\t\t\tthis.getCopyFileItem(),\n\t\t];\n\t\tconst secondGroupItems = [\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getSaveToDiskItem(),\n\t\t];\n\n\t\treturn [\n\t\t\t...this.groupItems(firstGroupItems, MenuSectionCode.first),\n\t\t\t...this.groupItems(secondGroupItems, MenuSectionCode.second),\n\t\t\t...this.groupItems([this.getOpenInChannelItem()], MenuSectionCode.third),\n\t\t];\n\t}\n\n\t#getDefaultMenuItems(): MenuItemOptions[]\n\t{\n\t\tconst firstGroupItems = [\n\t\t\tthis.getReplyItem(),\n\t\t\tthis.getCopyItem(),\n\t\t\tthis.getEditItem(),\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getAskCopilotItem(),\n\t\t\tthis.getCreateTaskItem(),\n\t\t\t...this.getAdditionalItems(),\n\t\t];\n\n\t\treturn [\n\t\t\t...this.groupItems(firstGroupItems, MenuSectionCode.first),\n\t\t\t...this.groupItems([this.getDeleteItem()], MenuSectionCode.second),\n\t\t];\n\t}\n}\n","import { Loc } from 'main.core';\nimport { Outline as OutlineIcons } from 'ui.icon-set.api.core';\n\nimport { Analytics } from 'im.v2.lib.analytics';\nimport { CopilotManager } from 'im.v2.lib.copilot';\nimport { FeedbackManager } from 'im.v2.lib.feedback';\n\nimport { MessageMenu, MenuSectionCode } from './message-base';\n\nimport type { ImModelChat } from 'im.v2.model';\nimport type { MenuItemOptions } from 'ui.system.menu';\n\nexport class CopilotMessageMenu extends MessageMenu\n{\n\tgetMenuItems(): MenuItemOptions[]\n\t{\n\t\tconst firstGroupItems = [\n\t\t\tthis.getCopyItem(),\n\t\t\tthis.getMarkItem(),\n\t\t\tthis.getFavoriteItem(),\n\t\t\tthis.getForwardItem(),\n\t\t\tthis.getSendFeedbackItem(),\n\t\t];\n\n\t\tconst secondGroupItems = [\n\t\t\tthis.getDeleteItem(),\n\t\t\tthis.getSelectItem(),\n\t\t];\n\n\t\treturn [\n\t\t\t...this.groupItems(firstGroupItems, MenuSectionCode.first),\n\t\t\t...this.groupItems(secondGroupItems, MenuSectionCode.second),\n\t\t];\n\t}\n\n\tgetSendFeedbackItem(): MenuItemOptions\n\t{\n\t\tconst copilotManager = new CopilotManager();\n\t\tif (!copilotManager.isCopilotBot(this.context.authorId))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_AI_ASSISTANT_FEEDBACK'),\n\t\t\ticon: OutlineIcons.FEEDBACK,\n\t\t\tonClick: () => {\n\t\t\t\tAnalytics.getInstance().messageContextMenu.onSendFeedback(this.context.dialogId);\n\n\t\t\t\tvoid this.#openForm();\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tasync #openForm()\n\t{\n\t\tvoid (new FeedbackManager()).openCopilotForm({\n\t\t\tuserCounter: this.#getUserCounter(),\n\t\t\ttext: this.context.text,\n\t\t});\n\t}\n\n\t#getUserCounter(): number\n\t{\n\t\tconst chat: ImModelChat = this.store.getters['chats/get'](this.context.dialogId);\n\n\t\treturn chat.userCounter;\n\t}\n}\n","import { Loc } from 'main.core';\nimport { Outline as OutlineIcons } from 'ui.icon-set.api.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { FeedbackManager } from 'im.v2.lib.feedback';\n\nimport { MessageMenu, MenuSectionCode, NestedMenuSectionCode } from './message-base';\n\nimport type { MenuItemOptions, MenuSectionOptions } from 'ui.system.menu';\n\nexport class AiAssistantMessageMenu extends MessageMenu\n{\n\tgetMenuItems(): MenuItemOptions[]\n\t{\n\t\tconst firstGroupItems = [\n\t\t\tthis.getCopyItem(),\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getForwardItem(),\n\t\t\tthis.getCreateTaskItem(),\n\t\t\t...this.getAdditionalItems(),\n\t\t];\n\n\t\treturn this.groupItems(firstGroupItems, MenuSectionCode.first);\n\t}\n\n\tgetNestedItems(): MenuItemOptions[]\n\t{\n\t\tconst firstGroupItems = [\n\t\t\tthis.getCopyFileItem(),\n\t\t\tthis.getMarkItem(),\n\t\t\tthis.getFavoriteItem(),\n\t\t\tthis.getSaveToDiskItem(),\n\t\t\tthis.getCreateMeetingItem(),\n\t\t];\n\n\t\treturn [\n\t\t\t...this.groupItems(firstGroupItems, NestedMenuSectionCode.first),\n\t\t\t...this.groupItems([this.getSendFeedbackItem()], NestedMenuSectionCode.second),\n\t\t\t...this.groupItems(this.getMarketItems(), NestedMenuSectionCode.third),\n\t\t];\n\t}\n\n\tgetNestedMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [\n\t\t\t{ code: NestedMenuSectionCode.first },\n\t\t\t{ code: NestedMenuSectionCode.second },\n\t\t\t{ code: NestedMenuSectionCode.third },\n\t\t];\n\t}\n\n\tgetSendFeedbackItem(): MenuItemOptions\n\t{\n\t\tconst isAiAssistantBot = Core.getStore().getters['users/bots/isAiAssistant'](this.context.authorId);\n\n\t\tif (!isAiAssistantBot)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_AI_ASSISTANT_FEEDBACK'),\n\t\t\ticon: OutlineIcons.FEEDBACK,\n\t\t\tonClick: () => {\n\t\t\t\tvoid (new FeedbackManager()).openAiAssistantForm({});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n}\n","import { MessageMenu, MenuSectionCode, NestedMenuSectionCode } from './message-base';\n\nimport type { MenuItemOptions, MenuSectionOptions } from 'ui.system.menu';\n\nexport class TaskCommentsMessageMenu extends MessageMenu\n{\n\tgetMenuItems(): MenuItemOptions[]\n\t{\n\t\tconst firstGroupItems = [\n\t\t\tthis.getReplyItem(),\n\t\t\tthis.getCopyItem(),\n\t\t\tthis.getEditItem(),\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getAskCopilotItem(),\n\t\t\tthis.getCreateTaskItem(),\n\t\t\tthis.getAddResultItem(),\n\t\t\tthis.getRemoveResultItem(),\n\t\t\t...this.getAdditionalItems(),\n\t\t];\n\n\t\tconst secondGroupItems = [\n\t\t\tthis.getDeleteItem(),\n\t\t];\n\n\t\treturn [\n\t\t\t...this.groupItems(firstGroupItems, MenuSectionCode.first),\n\t\t\t...this.groupItems(secondGroupItems, MenuSectionCode.second),\n\t\t];\n\t}\n\n\tgetNestedItems(): MenuItemOptions[]\n\t{\n\t\tconst firstGroupItems = [\n\t\t\tthis.getPinItem(),\n\t\t\tthis.getCopyLinkItem(),\n\t\t\tthis.getCopyFileItem(),\n\t\t\tthis.getFavoriteItem(),\n\t\t\tthis.getSaveToDiskItem(),\n\t\t\tthis.getCreateMeetingItem(),\n\t\t];\n\n\t\treturn this.groupItems(firstGroupItems, NestedMenuSectionCode.first);\n\t}\n\n\tgetMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [\n\t\t\t{ code: MenuSectionCode.first },\n\t\t\t{ code: MenuSectionCode.second },\n\t\t];\n\t}\n\n\tgetNestedMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [\n\t\t\t{ code: NestedMenuSectionCode.first },\n\t\t];\n\t}\n\n\tgetAddResultItem(): ?MenuItemOptions\n\t{\n\t\treturn null;\n\t}\n\n\tgetRemoveResultItem(): ?MenuItemOptions\n\t{\n\t\treturn null;\n\t}\n}\n","import { Core } from 'im.v2.application.core';\nimport { ChannelManager } from 'im.v2.lib.channel';\nimport { CopilotManager } from 'im.v2.lib.copilot';\nimport { ChatType, DataAttribute, MessageComponent } from 'im.v2.const';\n\n// noinspection ES6PreferShortImport\nimport { MessageMenu } from './classes/message-base';\nimport { ChannelMessageMenu } from './classes/channel';\nimport { CommentsMessageMenu } from './classes/comments';\nimport { CopilotMessageMenu } from './classes/copilot';\nimport { AiAssistantMessageMenu } from './classes/ai-assistant';\nimport { TaskCommentsMessageMenu } from './classes/task-comments';\n\nimport type { ImModelChat } from 'im.v2.model';\nimport type { MessageMenuContext } from 'im.v2.lib.menu';\nimport type { ApplicationContext } from 'im.v2.const';\n\ntype MenuCheckFunction = (context: MessageMenuContext) => boolean;\ntype MessageType = $Values<typeof MessageComponent>;\ntype OpenMenuPayload = {\n\tmessageContext: MessageMenuContext,\n\tapplicationContext: ApplicationContext,\n\ttarget: HTMLElement\n};\n\nexport class MessageMenuManager\n{\n\tstatic #instance = null;\n\n\t#defaultMenuByCallback: Map<MenuCheckFunction, MessageMenu> = new Map();\n\t#customMenuByCallback: Map<MenuCheckFunction, MessageMenu> = new Map();\n\t#menuByMessageType: Map<MessageType, MessageMenu> = new Map();\n\t#menuInstance = null;\n\n\tstatic getInstance(): MessageMenuManager\n\t{\n\t\tif (!this.#instance)\n\t\t{\n\t\t\tthis.#instance = new MessageMenuManager();\n\t\t}\n\n\t\treturn this.#instance;\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.#registerDefaultMenus();\n\t}\n\n\topenMenu(payload: OpenMenuPayload): void\n\t{\n\t\tthis.destroyMenuInstance();\n\n\t\tconst { messageContext, target, applicationContext } = payload;\n\t\tconst MenuClass = this.#resolveMenuClass(messageContext);\n\t\tthis.#menuInstance = new MenuClass(applicationContext);\n\t\tthis.#menuInstance.openMenu(messageContext, target);\n\t}\n\n\tregisterMenuByCallback(callback: MenuCheckFunction, menuClass: MessageMenu): void\n\t{\n\t\tthis.#customMenuByCallback.set(callback, menuClass);\n\t}\n\n\tunregisterMenuByCallback(callback: MenuCheckFunction): void\n\t{\n\t\tthis.#customMenuByCallback.delete(callback);\n\t}\n\n\tdestroyMenuInstance(): void\n\t{\n\t\tif (!this.#menuInstance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#menuInstance.destroy();\n\t\tthis.#menuInstance = null;\n\t}\n\n\tshouldUseNativeContextMenu(target: HTMLElement): boolean\n\t{\n\t\treturn Boolean(target.closest(`[${DataAttribute.useNativeContextMenu}]`));\n\t}\n\n\tregisterMenuByMessageType(messageType: MessageType, menuClass: MessageMenu): void\n\t{\n\t\tif (this.#hasMenuForMessageType(messageType))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#menuByMessageType.set(messageType, menuClass);\n\t}\n\n\t#resolveMenuClass(context: MessageMenuContext): MessageMenu\n\t{\n\t\tif (!this.#isCustomMenuAllowed(context))\n\t\t{\n\t\t\treturn this.#getDefaultMenuClass(context);\n\t\t}\n\n\t\tconst customMenu = this.#getCustomMenuClass(context);\n\n\t\treturn customMenu ?? this.#getDefaultMenuClass(context);\n\t}\n\n\t#registerDefaultMenus()\n\t{\n\t\tthis.#defaultMenuByCallback.set(this.#isChannel.bind(this), ChannelMessageMenu);\n\t\tthis.#defaultMenuByCallback.set(this.#isComment.bind(this), CommentsMessageMenu);\n\t\tthis.#defaultMenuByCallback.set(this.#isCopilot.bind(this), CopilotMessageMenu);\n\t\tthis.#defaultMenuByCallback.set(this.#isAiAssistant.bind(this), AiAssistantMessageMenu);\n\t\tthis.#defaultMenuByCallback.set(this.#isTaskComments.bind(this), TaskCommentsMessageMenu);\n\t}\n\n\t#isCustomMenuAllowed(context: MessageMenuContext): boolean\n\t{\n\t\treturn !ChannelManager.isCommentsPostMessage(context, context.dialogId);\n\t}\n\n\t#getDefaultMenuClass(context: MessageMenuContext): MessageMenu\n\t{\n\t\tconst MenuClass = this.#getClassByMap(this.#defaultMenuByCallback, context);\n\n\t\treturn MenuClass ?? MessageMenu;\n\t}\n\n\t#getCustomMenuClass(context: MessageMenuContext): MessageMenu | null\n\t{\n\t\tif (this.#hasMenuForMessageType(context.componentId))\n\t\t{\n\t\t\treturn this.#getMenuForMessageType(context.componentId);\n\t\t}\n\n\t\treturn this.#getClassByMap(this.#customMenuByCallback, context);\n\t}\n\n\t#getClassByMap(menuMap: Map<MenuCheckFunction, MessageMenu>, context: MessageMenuContext): MessageMenu | null\n\t{\n\t\tconst menuMapEntries = menuMap.entries();\n\t\tfor (const [callback, MenuClass] of menuMapEntries)\n\t\t{\n\t\t\tif (callback(context))\n\t\t\t{\n\t\t\t\treturn MenuClass;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#getChatType(dialogId: string): $Values<typeof ChatType>\n\t{\n\t\tconst chat: ImModelChat = Core.getStore().getters['chats/get'](dialogId, true);\n\n\t\treturn chat.type;\n\t}\n\n\t#isChannel(context: MessageMenuContext): boolean\n\t{\n\t\treturn ChannelManager.isChannel(context.dialogId);\n\t}\n\n\t#isComment(context: MessageMenuContext): boolean\n\t{\n\t\tconst type = this.#getChatType(context.dialogId);\n\n\t\treturn type === ChatType.comment;\n\t}\n\n\t#isCopilot(context: MessageMenuContext): boolean\n\t{\n\t\treturn (new CopilotManager()).isCopilotChat(context.dialogId);\n\t}\n\n\t#isAiAssistant(context: MessageMenuContext): boolean\n\t{\n\t\treturn Core.getStore().getters['users/bots/isAiAssistant'](context.dialogId);\n\t}\n\n\t#isTaskComments(context: MessageMenuContext): boolean\n\t{\n\t\tconst type = this.#getChatType(context.dialogId);\n\n\t\treturn type === ChatType.taskComments;\n\t}\n\n\t#hasMenuForMessageType(messageType: MessageType): boolean\n\t{\n\t\treturn this.#menuByMessageType.has(messageType);\n\t}\n\n\t#getMenuForMessageType(messageType: MessageType): MessageMenu\n\t{\n\t\treturn this.#menuByMessageType.get(messageType);\n\t}\n}\n","import { Loc } from 'main.core';\nimport { Outline as OutlineIcons } from 'ui.icon-set.api.core';\nimport { MenuItemDesign } from 'ui.system.menu';\n\nimport { Notifier } from 'im.v2.lib.notifier';\nimport { Core } from 'im.v2.application.core';\nimport { PopupType, StickerPackType } from 'im.v2.const';\nimport { StickerService } from 'im.v2.provider.service.sticker';\nimport { showStickerPackDeleteConfirm, showStickerPackUnlinkConfirm } from 'im.v2.lib.confirm';\n\nimport { BaseMenu } from '../base/base';\n\nimport type { MenuItemOptions, MenuOptions, MenuSectionOptions } from 'ui.system.menu';\nimport type { ImModelStickerPack } from 'im.v2.model';\n\nconst MenuSectionCode = {\n\tfirst: 'first',\n\tsecond: 'second',\n};\n\nexport class StickerPackMenu extends BaseMenu\n{\n\tcontext: { pack: ImModelStickerPack, isRecent: boolean, dialogId: string };\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = PopupType.stickerPackContextMenu;\n\t}\n\n\tgetMenuOptions(): MenuOptions\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tangle: false,\n\t\t};\n\t}\n\n\tgetMenuItems(): MenuItemOptions\n\t{\n\t\tif (this.context.isRecent)\n\t\t{\n\t\t\treturn [\n\t\t\t\tthis.getClearRecentItem(),\n\t\t\t];\n\t\t}\n\n\t\treturn [\n\t\t\t...this.groupItems([this.getEditPackItem()], MenuSectionCode.first),\n\t\t\t...this.groupItems([\n\t\t\t\tthis.getUnlinkPackItem(),\n\t\t\t\tthis.getDeletePackItem(),\n\t\t\t], MenuSectionCode.second),\n\t\t];\n\t}\n\n\tgetMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn this.getMenuItems().map((menuItem: MenuItemOptions) => {\n\t\t\treturn { code: menuItem.sectionCode };\n\t\t});\n\t}\n\n\tgetEditPackItem(): MenuItemOptions | null\n\t{\n\t\tif (!this.#isPackOwner())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_EDIT_STICKER_PACK'),\n\t\t\ticon: OutlineIcons.EDIT_M,\n\t\t\tonClick: () => {\n\t\t\t\tthis.emit('openEditor');\n\t\t\t},\n\t\t};\n\t}\n\n\tgetDeletePackItem(): MenuItemOptions | null\n\t{\n\t\tif (!this.#canDeletePack())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_REMOVE_STICKER_PACK'),\n\t\t\tdesign: MenuItemDesign.Alert,\n\t\t\ticon: OutlineIcons.TRASHCAN,\n\t\t\tonClick: async () => {\n\t\t\t\tconst confirmResult = await showStickerPackDeleteConfirm();\n\t\t\t\tif (!confirmResult)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.emit('closeParentPopup');\n\t\t\t\tawait StickerService.getInstance().deletePack({\n\t\t\t\t\tid: this.context.pack.id,\n\t\t\t\t\ttype: this.context.pack.type,\n\t\t\t\t});\n\t\t\t\tNotifier.sticker.onRemovePackComplete();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetUnlinkPackItem(): MenuItemOptions | null\n\t{\n\t\tif (!this.#canUnlinkPack())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_UNLINK_STICKER_PACK'),\n\t\t\tdesign: MenuItemDesign.Alert,\n\t\t\ticon: OutlineIcons.TRASHCAN,\n\t\t\tonClick: async () => {\n\t\t\t\tconst confirmResult = await showStickerPackUnlinkConfirm();\n\t\t\t\tif (!confirmResult)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.emit('closeParentPopup');\n\t\t\t\tawait StickerService.getInstance().unlinkPack({\n\t\t\t\t\tid: this.context.pack.id,\n\t\t\t\t\ttype: this.context.pack.type,\n\t\t\t\t});\n\t\t\t\tNotifier.sticker.onRemovePackComplete();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetClearRecentItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_CLEAR_RECENT_STICKERS'),\n\t\t\ticon: OutlineIcons.BROOM,\n\t\t\tonClick: () => {\n\t\t\t\tvoid StickerService.getInstance().clearRecent();\n\t\t\t},\n\t\t};\n\t}\n\n\t#isPackOwner(): boolean\n\t{\n\t\treturn this.context.pack.authorId === Core.getUserId();\n\t}\n\n\t#isVendorStickerPack(): boolean\n\t{\n\t\treturn this.context.packType === StickerPackType.vendor;\n\t}\n\n\t#canUnlinkPack(): boolean\n\t{\n\t\tif (this.#isVendorStickerPack())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!this.context.pack.isAdded)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn !this.#isPackOwner();\n\t}\n\n\t#canDeletePack(): boolean\n\t{\n\t\tif (this.#isVendorStickerPack())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.#isPackOwner();\n\t}\n}\n","import { Loc } from 'main.core';\nimport { Outline as OutlineIcons } from 'ui.icon-set.api.core';\nimport { MenuItemDesign } from 'ui.system.menu';\n\nimport { Core } from 'im.v2.application.core';\nimport { SendingService } from 'im.v2.provider.service.sending';\nimport { StickerService } from 'im.v2.provider.service.sticker';\nimport { PopupType } from 'im.v2.const';\n\nimport { BaseMenu } from '../base/base';\n\nimport type { MenuItemOptions, MenuOptions } from 'ui.system.menu';\nimport type { ImModelSticker, ImModelStickerPack } from 'im.v2.model';\n\nexport class StickerMenu extends BaseMenu\n{\n\tcontext: { sticker: ImModelSticker, isRecent: boolean, dialogId: string };\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = PopupType.stickerContextMenu;\n\t}\n\n\tgetMenuOptions(): MenuOptions\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tangle: false,\n\t\t};\n\t}\n\n\tgetMenuItems(): MenuItemOptions\n\t{\n\t\treturn [\n\t\t\tthis.getSendItem(),\n\t\t\tthis.getRemoveFromRecentItem(),\n\t\t\tthis.getDeleteFromPackItem(),\n\t\t];\n\t}\n\n\tgetSendItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_SEND_STICKER'),\n\t\t\ticon: OutlineIcons.SEND,\n\t\t\tonClick: () => {\n\t\t\t\tthis.emit('closeParentPopup');\n\t\t\t\tvoid SendingService.getInstance().sendMessageWithSticker({\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t\tstickerParams: {\n\t\t\t\t\t\tid: this.context.sticker.id,\n\t\t\t\t\t\tpackId: this.context.sticker.packId,\n\t\t\t\t\t\tpackType: this.context.sticker.packType,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetDeleteFromPackItem(): MenuItemOptions | null\n\t{\n\t\tif (this.context.isRecent)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isPacksOwner = this.#isPackOwner();\n\t\tif (!isPacksOwner)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_REMOVE_STICKER'),\n\t\t\tdesign: MenuItemDesign.Alert,\n\t\t\ticon: OutlineIcons.TRASHCAN,\n\t\t\tonClick: () => {\n\t\t\t\tvoid StickerService.getInstance().deleteStickerFromPack({\n\t\t\t\t\tids: [this.context.sticker.id],\n\t\t\t\t\tpackId: this.context.sticker.packId,\n\t\t\t\t\tpackType: this.context.sticker.packType,\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetRemoveFromRecentItem(): MenuItemOptions | null\n\t{\n\t\tif (!this.context.isRecent)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_REMOVE_RECENT_STICKER'),\n\t\t\ticon: OutlineIcons.CIRCLE_MINUS,\n\t\t\tdesign: MenuItemDesign.Alert,\n\t\t\tonClick: () => {\n\t\t\t\tvoid StickerService.getInstance().removeFromRecent({\n\t\t\t\t\tid: this.context.sticker.id,\n\t\t\t\t\tpackId: this.context.sticker.packId,\n\t\t\t\t\tpackType: this.context.sticker.packType,\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t#isPackOwner(): boolean\n\t{\n\t\tconst pack: ImModelStickerPack = Core.getStore().getters['stickers/packs/getByIdentifier']({\n\t\t\tid: this.context.sticker.packId,\n\t\t\ttype: this.context.sticker.packType,\n\t\t});\n\n\t\tif (!pack)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn pack.authorId === Core.getUserId();\n\t}\n}\n"],"names":["EVENT_NAMESPACE","BaseMenu","EventEmitter","constructor","id","setEventNamespace","store","Core","getStore","restClient","getRestClient","openMenu","context","target","menuInstance","close","Menu","getMenuOptions","show","bindOptions","forceBindPosition","position","targetContainer","document","body","cacheable","closeByEsc","className","getMenuClassName","items","sections","getMenuGroups","events","onClose","onDestroy","destroy","getMenuItems","groupItems","menuItems","group","filter","item","map","sectionCode","emit","getCurrentUserId","getUserId","Event","bindOnce","window","MenuSectionCode","first","second","third","RecentMenu","applicationContext","chatService","ChatService","callManager","CallManager","getInstance","permissionManager","PermissionManager","emitter","compactMode","firstGroupItems","getSendMessageItem","getOpenProfileItem","getInviteItems","getUnreadMessageItem","getPinMessageItem","getMuteItem","getChatsWithUserItem","getHideItem","getLeaveItem","code","title","Loc","getMessage","onClick","Messenger","openChat","dialogId","getOpenItem","recentItem","dialog","getters","showReadOption","unread","counter","readDialog","unreadDialog","isPinned","pinned","unpinChat","pinChat","Analytics","chatPins","onPin","canMute","canPerformActionByRole","ActionByRole","mute","isMuted","muteList","includes","unmuteChat","muteChat","isUser","isBot","profileUri","Utils","user","getProfileLink","BX","SidePanel","Instance","open","LegacyRecentService","hideChat","isCollabChat","isChatWithCurrentUser","isAnyChatOpened","entityId","length","EventType","sidebar","panel","SidebarDetailBlock","chatsWithUser","standalone","canInvite","Type","isUndefined","MessengerProxy","console","error","canManageInvite","invitation","originator","push","getResendInviteItem","getCancelInviteItem","InviteManager","resendInvite","MessageBox","message","modal","buttons","MessageBoxButtons","OK_CANCEL","onOk","messageBox","cancelInvite","onCancel","getChat","type","UserType","bot","isChannel","ChannelManager","isCommentsChat","ChatType","comment","collab","Number","parseInt","canLeaveChat","leave","userChoice","showLeaveChatConfirm","leaveChat","canLeaveCollab","canPerformActionByUserType","ActionByUserType","leaveCollab","isInvitation","isFakeUser","isFakeElement","isAiAssistantBot","isActive","canResend","UserMenu","getKickItem","canKick","kick","showKickUserConfirm","getMentionItem","textarea","insertMention","mentionText","name","mentionReplacement","text","getMentionBbCode","isMentionSymbol","getSendItem","getProfileItem","kickUserFromCollab","kickUserFromChat","NestedMenuSectionCode","MessageMenu","maxPins","diskService","DiskService","marketManager","MarketManager","angle","offsetLeft","minWidth","getReplyItem","getCopyItem","getEditItem","getDownloadFileItem","getForwardItem","getAskCopilotItem","getCreateTaskItem","getAdditionalItems","secondGroupItems","getDeleteItem","getSelectItem","getNestedMenuGroups","isDeletedMessage","isRealMessage","icon","OutlineIcons","CIRCLE_CHECK","messageContextMenu","onSelect","openBulkActionsMode","messageId","onReply","replyMessage","QUOTE","FORWARD","onForward","showForwardPopup","messagesIds","trim","onCopyText","textToCopy","Parser","prepareCopy","copyToClipboard","Notifier","onCopyComplete","COPY","getCopyLinkItem","LINK","onCopyLink","ChatManager","buildMessageLink","clipboard","copy","onCopyLinkComplete","getCopyFileItem","files","fileId","onCopyFile","prepareCopyFile","file","getPinItem","canPin","pinMessage","chatId","PIN","messageService","MessageService","unpinMessage","onUnpin","chat","onMessagesPinLimitError","onReachingPinsLimit","getFavoriteItem","isInFavorite","menuItemText","FAVORITE","removeMessageFromFavorite","onAddFavorite","addMessageToFavorite","getMarkItem","canUnread","viewed","isOwnMessage","isMarked","markedId","NEW_MESSAGE","onMark","markMessage","TASK","onCreateTask","entityCreator","EntityCreator","createTaskForMessage","getCreateMeetingItem","CALENDAR_WITH_SLOTS","onCreateEvent","createMeetingForMessage","MessageManager","isEditable","EDIT_L","onEdit","editMessage","FeatureManager","isFeatureAvailable","Feature","isCopilotMentionAvailable","canSendMessage","copilotBotDialogId","COPILOT","design","MenuItemDesign","Copilot","onAskCopilot","canDeleteOthersMessage","deleteOthersMessage","Alert","TRASHCAN","bind","getMarketItems","placements","getAvailablePlacementsByType","PlacementType","contextMenu","marketMenuItem","forEach","placement","MARKET","openSlider","MARKET_ITEMS_LIMIT","slice","isArrayFilled","getSaveToDiskItem","FOLDER_24","onSaveOnDisk","save","onDiskSaveComplete","getNestedItems","subMenu","authorId","isDeleted","isTextareaEnabled","send","additionalItems","NESTED_MENU_MIN_ITEMS","onDelete","deleteMessages","confirmResult","showDeleteChannelPostConfirm","onCancelDelete","DOWNLOAD","downloadFiles","onFileDownload","needToShowPopup","PromoManager","needToShow","PromoId","downloadSeveralFiles","browser","isChrome","platform","isBitrixDesktop","showDownloadAllFilesConfirm","markAsWatched","pins","ChannelMessageMenu","CommentsMessageMenu","contextDialogId","isCommentsPostMessage","getOpenInChannelItem","GO_TO_MESSAGE","closeComments","CopilotMessageMenu","getSendFeedbackItem","copilotManager","CopilotManager","isCopilotBot","FEEDBACK","onSendFeedback","FeedbackManager","openCopilotForm","userCounter","AiAssistantMessageMenu","openAiAssistantForm","TaskCommentsMessageMenu","getAddResultItem","getRemoveResultItem","MessageMenuManager","Map","payload","destroyMenuInstance","messageContext","MenuClass","registerMenuByCallback","callback","menuClass","set","unregisterMenuByCallback","delete","shouldUseNativeContextMenu","Boolean","closest","DataAttribute","useNativeContextMenu","registerMenuByMessageType","messageType","customMenu","componentId","menuMap","menuMapEntries","entries","isCopilotChat","taskComments","has","get","StickerPackMenu","PopupType","stickerPackContextMenu","isRecent","getClearRecentItem","getEditPackItem","getUnlinkPackItem","getDeletePackItem","menuItem","EDIT_M","showStickerPackDeleteConfirm","StickerService","deletePack","pack","sticker","onRemovePackComplete","showStickerPackUnlinkConfirm","unlinkPack","BROOM","clearRecent","packType","StickerPackType","vendor","isAdded","StickerMenu","stickerContextMenu","getRemoveFromRecentItem","getDeleteFromPackItem","SEND","SendingService","sendMessageWithSticker","stickerParams","packId","isPacksOwner","deleteStickerFromPack","ids","CIRCLE_MINUS","removeFromRecent"],"mappings":"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"}