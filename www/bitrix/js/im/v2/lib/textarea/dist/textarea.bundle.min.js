this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};(function(e,t,s,n,l,a){"use strict";const i="BX.Messenger.v2.Textarea.ResizeManager";var o=babelHelpers.classPrivateFieldLooseKey("observer");var r=babelHelpers.classPrivateFieldLooseKey("textareaHeight");var c=babelHelpers.classPrivateFieldLooseKey("initObserver");class v extends a.EventEmitter{constructor(){super();Object.defineProperty(this,c,{value:u});Object.defineProperty(this,o,{writable:true,value:void 0});Object.defineProperty(this,r,{writable:true,value:void 0});this.setEventNamespace(i);babelHelpers.classPrivateFieldLooseBase(this,c)[c]()}observeTextarea(e){babelHelpers.classPrivateFieldLooseBase(this,o)[o].observe(e);babelHelpers.classPrivateFieldLooseBase(this,r)[r]=e.clientHeight}unobserveTextarea(e){babelHelpers.classPrivateFieldLooseBase(this,o)[o].unobserve(e);babelHelpers.classPrivateFieldLooseBase(this,r)[r]=0}}function u(){babelHelpers.classPrivateFieldLooseBase(this,o)[o]=new ResizeObserver((e=>{e.forEach((e=>{var t;const s=(t=e.borderBoxSize)==null?void 0:t[0].blockSize;if(l.Type.isNumber(s)&&s!==babelHelpers.classPrivateFieldLooseBase(this,r)[r]){this.emit(v.events.onHeightChange,{newHeight:s});babelHelpers.classPrivateFieldLooseBase(this,r)[r]=s}}))}))}v.events={onHeightChange:"onHeightChange"};const d="\t";const h="\n";const p="Key";const g={prepareInlineQuote(e){const n=e.value.slice(e.selectionStart,e.selectionEnd);if(!n){return e.value}const l=t.Parser.prepareQuote({},n);const a=e.value.slice(0,e.selectionStart);const i=e.value.slice(e.selectionEnd);return s.Quote.prepareInlineQuote(a,i,l)},addTab(e){const t=e.selectionStart+1;const s=e.value.slice(0,e.selectionStart);const n=e.value.slice(e.selectionEnd);const l=`${s}${d}${n}`;e.value=l;e.selectionStart=t;e.selectionEnd=t;return l},removeTab(e){const t=e.value.slice(e.selectionStart-1,e.selectionStart);if(t!==d){return e.value}const s=e.selectionStart-1;const n=e.value.slice(0,e.selectionStart-1);const l=e.value.slice(e.selectionEnd);const a=`${n}${l}`;e.value=a;e.selectionStart=s;e.selectionEnd=s;return a},handleDecorationTag(e,t){t=t.replace(p,"").toLowerCase();const s=`[${t}]`;const n=`[/${t}]`;const l=e.value.slice(e.selectionStart,e.selectionEnd);if(!l){return e.value}const a=l.toLowerCase().startsWith(s)&&l.toLowerCase().endsWith(n);if(a){return this.removeDecorationTag(e,t)}else{return this.addDecorationTag(e,t)}},addDecorationTag(e,t){const s=`[${t}]`;const n=`[/${t}]`;return this.applyWrapping(e,s,n)},removeDecorationTag(e,t){const s=`[${t}]`;const n=`[/${t}]`;const l=s.length+n.length;const a=e.selectionStart;const i=e.selectionEnd-l;const o=e.value.slice(0,e.selectionStart);const r=e.selectionStart+s.length;const c=e.selectionEnd-n.length;const v=e.value.slice(r,c);const u=e.value.slice(e.selectionEnd);const d=`${o}${v}${u}`;e.value=d;e.selectionStart=a;e.selectionEnd=i;return d},addNewLine(e){const t=e.selectionStart+1;const s=e.value.slice(0,e.selectionStart);const n=e.value.slice(e.selectionEnd);const l=`${s}${h}${n}`;e.value=l;e.selectionStart=t;e.selectionEnd=t;return l},insertText(e,t={}){const{text:s,withNewLine:n=false,replace:l=false}=t;const a=e.selectionStart+s.length+1;let i="";if(l){i="";e.value="";e.selectionStart=0;e.selectionEnd=0}if(e.value.length===0){i=s}else{const t=e.value.slice(0,e.selectionStart);const l=e.value.slice(e.selectionEnd);i=n?`${e.value}${h}${s}`:`${t} ${s} ${l}`}e.focus({preventScroll:true});e.value=i;e.selectionStart=a;e.selectionEnd=a;return i},insertMention(e,t={}){const{textToInsert:s,textToReplace:n=""}=t;const l=n.length>0;let a="";let i=e.selectionStart+s.length+1;if(l){i-=n.length;const t=e.value.slice(0,e.selectionStart-n.length);const l=e.value.slice(e.selectionStart);a=`${t}${s} ${l}`}else{const t=e.value.slice(0,e.selectionStart);const n=e.value.slice(e.selectionEnd);a=`${t}${s} ${n}`}e.focus({preventScroll:true});e.value=a;e.selectionStart=i;e.selectionEnd=i;return a},addUrlTag(e,t){if(!this.shouldHandleUrl(e,t)){return e.value}return this.applyUrlWrapping(e,t)},handlePasteUrl(e,t){var s;const n=(s=t.clipboardData)==null?void 0:s.getData("text/plain");if(!this.shouldHandleUrl(e,n)){return e.value}t.preventDefault();return this.applyUrlWrapping(e,n)},shouldHandleUrl(e,t){const s=e.value.slice(e.selectionStart,e.selectionEnd);const l=n.Utils.text.checkUrl(t);return l&&s},applyUrlWrapping(e,t){const s=`[URL=${t}]`;const n="[/URL]";return this.applyWrapping(e,s,n)},applyWrapping(e,t,s){const n=e.value.slice(e.selectionStart,e.selectionEnd);const l=t.length+s.length;const a=e.selectionStart;const i=e.selectionEnd+l;const o=e.value.slice(0,e.selectionStart);const r=e.value.slice(e.selectionEnd);const c=`${o}${t}${n}${s}${r}`;e.value=c;e.selectionStart=a;e.selectionEnd=i;return c}};e.Textarea=g;e.ResizeManager=v})(this.BX.Messenger.v2.Lib=this.BX.Messenger.v2.Lib||{},BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX,BX.Event);
//# sourceMappingURL=textarea.bundle.map.js