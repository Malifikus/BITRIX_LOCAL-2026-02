this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};(function(e,s,l,a,i,t,r,o,n,c){"use strict";var b=babelHelpers.classPrivateFieldLooseKey("initPromise");var d=babelHelpers.classPrivateFieldLooseKey("store");var u=babelHelpers.classPrivateFieldLooseKey("restClient");var p=babelHelpers.classPrivateFieldLooseKey("pullClient");var v=babelHelpers.classPrivateFieldLooseKey("host");var P=babelHelpers.classPrivateFieldLooseKey("userId");var h=babelHelpers.classPrivateFieldLooseKey("siteId");var L=babelHelpers.classPrivateFieldLooseKey("languageId");var H=babelHelpers.classPrivateFieldLooseKey("offline");var B=babelHelpers.classPrivateFieldLooseKey("applicationData");var F=babelHelpers.classPrivateFieldLooseKey("init");var f=babelHelpers.classPrivateFieldLooseKey("prepareVariables");var M=babelHelpers.classPrivateFieldLooseKey("initRestClient");var y=babelHelpers.classPrivateFieldLooseKey("initStorage");var g=babelHelpers.classPrivateFieldLooseKey("initPull");var w=babelHelpers.classPrivateFieldLooseKey("onPullStatusChange");class O{constructor(){Object.defineProperty(this,w,{value:S});Object.defineProperty(this,g,{value:K});Object.defineProperty(this,y,{value:m});Object.defineProperty(this,M,{value:j});Object.defineProperty(this,f,{value:C});Object.defineProperty(this,F,{value:X});Object.defineProperty(this,b,{writable:true,value:null});Object.defineProperty(this,d,{writable:true,value:null});Object.defineProperty(this,u,{writable:true,value:null});Object.defineProperty(this,p,{writable:true,value:null});Object.defineProperty(this,v,{writable:true,value:void 0});Object.defineProperty(this,P,{writable:true,value:void 0});Object.defineProperty(this,h,{writable:true,value:void 0});Object.defineProperty(this,L,{writable:true,value:void 0});Object.defineProperty(this,H,{writable:true,value:false});Object.defineProperty(this,B,{writable:true,value:{}});babelHelpers.classPrivateFieldLooseBase(this,f)[f]();babelHelpers.classPrivateFieldLooseBase(this,M)[M]()}ready(){if(!babelHelpers.classPrivateFieldLooseBase(this,b)[b]){babelHelpers.classPrivateFieldLooseBase(this,b)[b]=babelHelpers.classPrivateFieldLooseBase(this,F)[F]()}return babelHelpers.classPrivateFieldLooseBase(this,b)[b]}createVue(e,a={}){const i={};if(a.el){i.el=a.el}if(a.template){i.template=a.template}if(a.name){i.name=a.name}if(a.components){i.components=a.components}if(a.data){i.data=a.data}return new Promise((t=>{i.created=function(){if(s.Type.isFunction(a.created)){a.created.call(this)}t(this)};const r=l.BitrixVue.createApp(i);r.config.errorHandler=function(e,l,i){console.error(e,l,i);if(s.Type.isFunction(a.onError)){a.onError(e)}};r.config.warnHandler=function(e,s,l){console.warn(e,s,l)};r.config.unwrapInjectedRef=true;e.bitrixVue=r;r.use(babelHelpers.classPrivateFieldLooseBase(this,d)[d]).mount(i.el)}))}getHost(){return babelHelpers.classPrivateFieldLooseBase(this,v)[v]}getUserId(){return babelHelpers.classPrivateFieldLooseBase(this,P)[P]}getSiteId(){return babelHelpers.classPrivateFieldLooseBase(this,h)[h]}getLanguageId(){return babelHelpers.classPrivateFieldLooseBase(this,L)[L]}getStore(){return babelHelpers.classPrivateFieldLooseBase(this,d)[d]}getRestClient(){return babelHelpers.classPrivateFieldLooseBase(this,u)[u]}getPullClient(){return babelHelpers.classPrivateFieldLooseBase(this,p)[p]}setApplicationData(e){babelHelpers.classPrivateFieldLooseBase(this,B)[B]={...babelHelpers.classPrivateFieldLooseBase(this,B)[B],...e}}getApplicationData(){return babelHelpers.classPrivateFieldLooseBase(this,B)[B]}isOnline(){return!babelHelpers.classPrivateFieldLooseBase(this,H)[H]}isCloud(){const e=s.Extension.getSettings("im.v2.application.core");return e.get("isCloud")}}async function X(){try{await babelHelpers.classPrivateFieldLooseBase(this,y)[y]();await babelHelpers.classPrivateFieldLooseBase(this,g)[g]();return this}catch(e){console.error("Core: error starting core application",e);throw e}}function C(){var e,l,a;babelHelpers.classPrivateFieldLooseBase(this,v)[v]=location.origin;babelHelpers.classPrivateFieldLooseBase(this,P)[P]=(e=Number.parseInt(s.Loc.getMessage("USER_ID"),10))!=null?e:0;babelHelpers.classPrivateFieldLooseBase(this,h)[h]=(l=s.Loc.getMessage("SITE_ID"))!=null?l:"s1";babelHelpers.classPrivateFieldLooseBase(this,L)[L]=(a=s.Loc.getMessage("LANGUAGE_ID"))!=null?a:"en"}function j(){babelHelpers.classPrivateFieldLooseBase(this,u)[u]=BX.rest}async function m(){const e=a.Builder.init().addModel(o.ApplicationModel.create()).addModel(o.MessagesModel.create()).addModel(o.ChatsModel.create()).addModel(o.FilesModel.create()).addModel(o.UsersModel.create()).addModel(o.RecentModel.create()).addModel(o.CountersModel.create()).addModel(o.NotificationsModel.create()).addModel(o.SidebarModel.create()).addModel(o.MarketModel.create()).addModel(o.CopilotModel.create()).addModel(o.StickersModel.create()).addModel(o.AiAssistantModel.create());if(c.OpenLinesLaunchResources){c.OpenLinesLaunchResources.models.forEach((s=>{e.addModel(s.create())}))}const s=await e.build();babelHelpers.classPrivateFieldLooseBase(this,d)[d]=s.store}function K(){babelHelpers.classPrivateFieldLooseBase(this,p)[p]=BX.PULL;if(!babelHelpers.classPrivateFieldLooseBase(this,p)[p]){return Promise.reject(new Error("Core: error setting pull client"))}babelHelpers.classPrivateFieldLooseBase(this,p)[p].subscribe(new n.BasePullHandler);babelHelpers.classPrivateFieldLooseBase(this,p)[p].subscribe(new n.RecentPullHandler);babelHelpers.classPrivateFieldLooseBase(this,p)[p].subscribe(new n.RecentUnreadPullHandler);babelHelpers.classPrivateFieldLooseBase(this,p)[p].subscribe(new n.NotificationPullHandler);babelHelpers.classPrivateFieldLooseBase(this,p)[p].subscribe(new n.NotifierPullHandler);babelHelpers.classPrivateFieldLooseBase(this,p)[p].subscribe(new n.OnlinePullHandler);babelHelpers.classPrivateFieldLooseBase(this,p)[p].subscribe(new n.CounterPullHandler);babelHelpers.classPrivateFieldLooseBase(this,p)[p].subscribe(new n.AnchorPullHandler);babelHelpers.classPrivateFieldLooseBase(this,p)[p].subscribe(new n.SidebarPullHandler);babelHelpers.classPrivateFieldLooseBase(this,p)[p].subscribe(new n.StickersPullHandler);if(c.OpenLinesLaunchResources){c.OpenLinesLaunchResources.pullHandlers.forEach((e=>{babelHelpers.classPrivateFieldLooseBase(this,p)[p].subscribe(new e)}))}babelHelpers.classPrivateFieldLooseBase(this,p)[p].subscribe({type:BX.PullClient.SubscriptionType.Status,callback:babelHelpers.classPrivateFieldLooseBase(this,w)[w].bind(this)});return Promise.resolve()}function S(e){if(e.status===BX.PullClient.PullStatus.Online){babelHelpers.classPrivateFieldLooseBase(this,H)[H]=false}else if(e.status===BX.PullClient.PullStatus.Offline){babelHelpers.classPrivateFieldLooseBase(this,H)[H]=true}}const A=new O;e.Core=A;e.CoreApplication=O})(this.BX.Messenger.v2.Application=this.BX.Messenger.v2.Application||{},BX??{},BX?.Vue3??{},BX?.Vue3?.Vuex??{},BX??{},BX??{},BX?.Messenger?.v2?.Application??{},BX?.Messenger?.v2?.Model??{},BX?.Messenger?.v2?.Provider?.Pull??{},BX?.OpenLines?.v2?.Lib??{});
//# sourceMappingURL=core.bundle.map.js