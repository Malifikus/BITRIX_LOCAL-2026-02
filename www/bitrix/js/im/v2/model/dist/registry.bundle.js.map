{"version":3,"file":"registry.bundle.js","sources":["../src/utils/format.js","../src/application/nested-modules/settings/format/format-functions.js","../src/application/nested-modules/settings/format/field-config.js","../src/utils/validate.js","../src/application/nested-modules/settings/settings.js","../src/application/nested-modules/tariff-restrictions/format/field-config.js","../src/application/nested-modules/tariff-restrictions/tariff-restrictions.js","../src/application/application.js","../src/messages/format/format-functions.js","../src/messages/format/field-config.js","../src/messages/nested-modules/pin.js","../src/messages/nested-modules/reactions.js","../src/messages/nested-modules/comments/format/field-config.js","../src/messages/nested-modules/comments/comments.js","../src/messages/nested-modules/select.js","../src/messages/nested-modules/anchors/helpers.js","../src/messages/nested-modules/anchors/anchors.js","../src/messages/messages.js","../src/chats/format/format-functions.js","../src/chats/format/field-config.js","../src/chats/nested-modules/auto-delete/format/fields-config.js","../src/chats/nested-modules/auto-delete/auto-delete.js","../src/chats/nested-modules/collabs/format/field-config.js","../src/chats/nested-modules/collabs/collabs.js","../src/chats/nested-modules/input-actions.js","../src/chats/chats.js","../src/users/format/format-functions.js","../src/users/format/field-config.js","../src/users/nested-modules/bots.js","../src/users/users.js","../src/files/format/format-functions.js","../src/files/format/field-config.js","../src/files/files.js","../src/recent/format/format-functions.js","../src/recent/format/field-config.js","../src/recent/nested-modules/calls.js","../src/recent/recent.js","../src/notifications/notifications.js","../src/sidebar/nested-modules/links/format/field-config.js","../src/sidebar/nested-modules/links/links.js","../src/sidebar/nested-modules/favorites/format/field-config.js","../src/sidebar/nested-modules/favorites/favorites.js","../src/sidebar/nested-modules/members.js","../src/sidebar/nested-modules/message-search/message-search.js","../src/sidebar/nested-modules/tasks/format/field-config.js","../src/sidebar/nested-modules/tasks/tasks.js","../src/sidebar/nested-modules/meeting/format/field-config.js","../src/sidebar/nested-modules/meeting/meeting.js","../src/sidebar/nested-modules/files/format/field-config.js","../src/sidebar/nested-modules/files/files.js","../src/sidebar/nested-modules/multidialog/format/field-config.js","../src/sidebar/nested-modules/multidialog/multidialog.js","../src/sidebar/sidebar.js","../src/market/market.js","../src/counters/counters.js","../src/copilot/format/field-config.js","../src/copilot/nested-modules/chats/field-config.js","../src/copilot/nested-modules/chats/chats.js","../src/copilot/nested-modules/messages/field-config.js","../src/copilot/nested-modules/messages/messages.js","../src/copilot/nested-modules/roles/field-config.js","../src/copilot/nested-modules/roles/roles.js","../src/copilot/copilot.js","../src/ai-assistant/ai-assistant.js","../src/stickers/format/field-config.js","../src/stickers/nested-modules/recent/field-config.js","../src/stickers/nested-modules/recent/recent.js","../src/stickers/nested-modules/messages/field-config.js","../src/stickers/nested-modules/messages/messages.js","../src/stickers/nested-modules/packs/field-config.js","../src/stickers/nested-modules/packs/packs.js","../src/stickers/stickers.js"],"sourcesContent":["import { Type, Text } from 'main.core';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport type { JsonObject, JsonValue } from 'main.core';\n\nexport const isNumberOrString = (target: JsonValue): boolean => {\n\treturn Type.isNumber(target) || Type.isString(target);\n};\n\nexport const convertToString = (target: JsonValue): string => {\n\treturn target.toString();\n};\n\nexport const convertToNumber = (target: string | number): number => {\n\treturn Number.parseInt(target, 10);\n};\n\nexport const convertToDate = (target: string) => {\n\treturn Utils.date.cast(target, false);\n};\n\nconst SNAKE_CASE_REGEXP = /(_[\\da-z])/gi;\nexport const convertObjectKeysToCamelCase = (targetObject: JsonObject): JsonObject => {\n\tconst resultObject = {};\n\tObject.entries(targetObject).forEach(([key, value]) => {\n\t\tconst newKey = prepareKey(key);\n\t\tif (Type.isPlainObject(value))\n\t\t{\n\t\t\tresultObject[newKey] = convertObjectKeysToCamelCase(value);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isArray(value))\n\t\t{\n\t\t\tresultObject[newKey] = convertArrayItemsKeysToCamelCase(value);\n\n\t\t\treturn;\n\t\t}\n\t\tresultObject[newKey] = value;\n\t});\n\n\treturn resultObject;\n};\n\nconst prepareKey = (rawKey: string): string => {\n\tlet key = rawKey;\n\tif (key.search(SNAKE_CASE_REGEXP) !== -1)\n\t{\n\t\tkey = key.toLowerCase();\n\t}\n\n\treturn Text.toCamelCase(key);\n};\n\nconst convertArrayItemsKeysToCamelCase = (targetArray: JsonValue[]): JsonValue[] => {\n\treturn targetArray.map((arrayItem) => {\n\t\tif (!Type.isPlainObject(arrayItem))\n\t\t{\n\t\t\treturn arrayItem;\n\t\t}\n\n\t\treturn convertObjectKeysToCamelCase(arrayItem);\n\t});\n};\n","import { NotificationSettingsBlock } from 'im.v2.const';\nimport type { RawNotificationSettingsBlock, NotificationSettingsItem } from 'im.v2.const';\n\ntype PreparedNotificationSettings = {\n\t[block: string]: NotificationSettingsBlock,\n};\n\nconst SortWeight = {\n\ttasks: 2600,\n\tcalendar: 2500,\n\tim: 2400,\n\tblog: 2300,\n\tvote: 2200,\n\tmain: 2100,\n\tsocialnetwork: 2000,\n\tbizproc: 1900,\n\trpa: 1800,\n\tlists: 1700,\n\tmail: 1600,\n\tcrm: 1500,\n\tsender: 1400,\n\tbooking: 1300,\n\tvoximplant: 1200,\n\timopenlines: 1100,\n\ttimeman: 1000,\n\tdisk: 900,\n\tbitrix24: 800,\n\tsign: 700,\n\tbiconnector: 600,\n\trest: 500,\n\tintranet: 400,\n\tphotogallery: 300,\n\twiki: 200,\n\tforum: 100,\n};\n\nexport const prepareNotificationSettings = (target: RawNotificationSettingsBlock[]): PreparedNotificationSettings => {\n\tconst result = {};\n\n\tconst sortedTarget = sortNotificationSettingsBlock(target);\n\tsortedTarget.forEach((block: RawNotificationSettingsBlock) => {\n\t\tconst preparedItems = {};\n\t\tblock.notices.forEach((item: NotificationSettingsItem) => {\n\t\t\tpreparedItems[item.id] = item;\n\t\t});\n\t\tresult[block.id] = {\n\t\t\tid: block.id,\n\t\t\tlabel: block.label,\n\t\t\titems: preparedItems,\n\t\t};\n\t});\n\n\treturn result;\n};\n\nconst sortNotificationSettingsBlock = (target: RawNotificationSettingsBlock[]): RawNotificationSettingsBlock[] => {\n\treturn [...target].sort((a, b) => {\n\t\tconst weightA = SortWeight[a.id] ?? 0;\n\t\tconst weightB = SortWeight[b.id] ?? 0;\n\n\t\treturn weightB - weightA;\n\t});\n};\n","import { Type } from 'main.core';\n\nimport { Settings } from 'im.v2.const';\n\nimport { convertToNumber, isNumberOrString } from '../../../../utils/format';\nimport { prepareNotificationSettings } from './format-functions';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const settingsFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: Settings.notification.enableSound,\n\t\ttargetFieldName: Settings.notification.enableSound,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.notification.enableAutoRead,\n\t\ttargetFieldName: Settings.notification.enableAutoRead,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.notification.mode,\n\t\ttargetFieldName: Settings.notification.mode,\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: Settings.notification.enableWeb,\n\t\ttargetFieldName: Settings.notification.enableWeb,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.notification.enableMail,\n\t\ttargetFieldName: Settings.notification.enableMail,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.notification.enablePush,\n\t\ttargetFieldName: Settings.notification.enablePush,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'notifications',\n\t\ttargetFieldName: 'notifications',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: prepareNotificationSettings,\n\t},\n\t{\n\t\tfieldName: Settings.message.bigSmiles,\n\t\ttargetFieldName: Settings.message.bigSmiles,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.appearance.background,\n\t\ttargetFieldName: Settings.appearance.background,\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: Settings.appearance.alignment,\n\t\ttargetFieldName: Settings.appearance.alignment,\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: Settings.recent.showBirthday,\n\t\ttargetFieldName: Settings.recent.showBirthday,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.recent.showInvited,\n\t\ttargetFieldName: Settings.recent.showInvited,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.recent.showLastMessage,\n\t\ttargetFieldName: Settings.recent.showLastMessage,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.hotkey.sendByEnter,\n\t\ttargetFieldName: Settings.hotkey.sendByEnter,\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: (target) => {\n\t\t\treturn target === '1';\n\t\t},\n\t},\n\t{\n\t\tfieldName: Settings.hotkey.sendByEnter,\n\t\ttargetFieldName: Settings.hotkey.sendByEnter,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.desktop.enableRedirect,\n\t\ttargetFieldName: Settings.desktop.enableRedirect,\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: Settings.user.status,\n\t\ttargetFieldName: Settings.user.status,\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\n\nimport { convertObjectKeysToCamelCase } from './format';\n\nimport type { JsonObject, JsonValue } from 'main.core';\n\nexport type FieldsConfig = FieldsConfigItem[];\ntype FieldsConfigItem = {\n\tfieldName: string | Array<string>,\n\ttargetFieldName: string,\n\tcheckFunction?: CheckFunction | Array<CheckFunction>, // OR logic\n\tformatFunction?: FormatFunction,\n};\ntype CheckFunction = (target: JsonValue) => boolean;\ntype FormatFunction = (target: JsonValue, currentResult: JsonObject, rawFields: JsonObject) => JsonValue;\n\nexport const formatFieldsWithConfig = (fields: JsonObject, config: FieldsConfig): JsonObject => {\n\tconst resultObject = {};\n\tconst rawFields = convertObjectKeysToCamelCase(fields);\n\n\tconfig.forEach((fieldConfig: FieldsConfigItem) => {\n\t\tconst { fieldName, targetFieldName, checkFunction, formatFunction } = fieldConfig;\n\n\t\t// check if field exists\n\t\tconst foundFieldName = getValidFieldName(rawFields, fieldName);\n\t\tif (!foundFieldName)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// validate value\n\t\tif (!isFieldValueValid(rawFields[foundFieldName], checkFunction))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// format value\n\t\tresultObject[targetFieldName] = formatFieldValue({\n\t\t\tfieldValue: rawFields[foundFieldName],\n\t\t\tformatFunction,\n\t\t\tcurrentResult: resultObject,\n\t\t\trawFields: fields,\n\t\t});\n\t});\n\n\treturn resultObject;\n};\n\nconst getValidFieldName = (fields: JsonObject, fieldName: string | string[]): string | null => {\n\tlet fieldNameList = fieldName;\n\tif (Type.isStringFilled(fieldNameList))\n\t{\n\t\tfieldNameList = [fieldNameList];\n\t}\n\n\tfor (const singleField of fieldNameList)\n\t{\n\t\tif (!Type.isUndefined(fields[singleField]))\n\t\t{\n\t\t\treturn singleField;\n\t\t}\n\t}\n\n\treturn null;\n};\n\nconst isFieldValueValid = (field: JsonValue, checkFunction: CheckFunction | Array<CheckFunction>): boolean => {\n\tlet checkFunctionList = checkFunction;\n\tif (Type.isUndefined(checkFunctionList))\n\t{\n\t\treturn true;\n\t}\n\n\tif (Type.isFunction(checkFunctionList))\n\t{\n\t\tcheckFunctionList = [checkFunctionList];\n\t}\n\n\treturn checkFunctionList.some((singleFunction) => singleFunction(field));\n};\n\ntype FormatFieldValueParams = {\n\tfieldValue: JsonValue,\n\tformatFunction: FormatFunction,\n\tcurrentResult: JsonObject,\n\trawFields: JsonObject\n};\nconst formatFieldValue = (params: FormatFieldValueParams) => {\n\tconst { fieldValue, formatFunction, currentResult, rawFields } = params;\n\tif (Type.isUndefined(formatFunction))\n\t{\n\t\treturn fieldValue;\n\t}\n\n\treturn formatFunction(fieldValue, currentResult, rawFields);\n};\n","import { BuilderModel, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport { Settings, DialogAlignment, NotificationSettingsMode, NotificationSettingsType, NotificationSettingsBlock } from 'im.v2.const';\nimport { settingsFieldsConfig } from './format/field-config';\nimport { formatFieldsWithConfig } from '../../../utils/validate';\n\nimport type { JsonObject } from 'main.core';\n\ntype SettingsState = {\n\t[settingName: string]: any,\n\tnotifications: {\n\t\t[moduleId: string]: NotificationSettingsBlock\n\t}\n};\ntype NotificationOptionPayload = {\n\tmoduleId: string,\n\toptionName: string,\n\ttype: $Values<typeof NotificationSettingsType>,\n\tvalue: boolean\n};\n\n/* eslint-disable no-param-reassign */\nexport class SettingsModel extends BuilderModel\n{\n\tgetState(): SettingsState\n\t{\n\t\treturn {\n\t\t\t[Settings.appearance.background]: 1,\n\t\t\t[Settings.appearance.alignment]: DialogAlignment.left,\n\n\t\t\t[Settings.notification.enableSound]: true,\n\t\t\t[Settings.notification.enableAutoRead]: true,\n\t\t\t[Settings.notification.mode]: NotificationSettingsMode.simple,\n\t\t\t[Settings.notification.enableWeb]: true,\n\t\t\t[Settings.notification.enableMail]: true,\n\t\t\t[Settings.notification.enablePush]: true,\n\t\t\tnotifications: {},\n\n\t\t\t[Settings.message.bigSmiles]: true,\n\n\t\t\t[Settings.recent.showBirthday]: true,\n\t\t\t[Settings.recent.showInvited]: true,\n\t\t\t[Settings.recent.showLastMessage]: true,\n\n\t\t\t[Settings.desktop.enableRedirect]: true,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/settings/get */\n\t\t\tget: (state: SettingsState) => (key: string): any => {\n\t\t\t\treturn state[key];\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/settings/set */\n\t\t\tset: (store, payload: {[settingName: string]: any}) => {\n\t\t\t\tstore.commit('set', this.formatFields(payload));\n\t\t\t},\n\t\t\t/** @function application/settings/setNotificationOption */\n\t\t\tsetNotificationOption: (store, payload: NotificationOptionPayload) => {\n\t\t\t\tstore.commit('setNotificationOption', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: SettingsState, payload: {[settingName: string]: any}) => {\n\t\t\t\tObject.entries(payload).forEach(([key, value]) => {\n\t\t\t\t\tstate[key] = value;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetNotificationOption: (state: SettingsState, payload: NotificationOptionPayload) => {\n\t\t\t\tconst { moduleId, optionName, type, value } = payload;\n\t\t\t\tconst moduleOptions = state.notifications[moduleId];\n\t\t\t\tif (!moduleOptions?.items?.[optionName])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tmoduleOptions.items[optionName][type] = value;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, settingsFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const tariffRestrictionsFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'fullChatHistory',\n\t\ttargetFieldName: 'fullChatHistory',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n];\n","import { BuilderModel, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport { tariffRestrictionsFieldsConfig } from './format/field-config';\nimport { formatFieldsWithConfig } from '../../../utils/validate';\n\nimport type { JsonObject } from 'main.core';\n\nexport type TariffRestrictions = {\n\tfullChatHistory: {\n\t\tisAvailable: boolean,\n\t\tlimitDays: number | null,\n\t}\n};\n\n/* eslint-disable no-param-reassign */\nexport class TariffRestrictionsModel extends BuilderModel\n{\n\tgetState(): TariffRestrictions\n\t{\n\t\treturn {\n\t\t\tfullChatHistory: {\n\t\t\t\tisAvailable: true,\n\t\t\t\tlimitDays: null,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/tariffRestrictions/get */\n\t\t\tget: (state: TariffRestrictions): TariffRestrictions => {\n\t\t\t\treturn state;\n\t\t\t},\n\t\t\t/** @function application/tariffRestrictions/isHistoryAvailable */\n\t\t\tisHistoryAvailable: (state: TariffRestrictions): boolean => {\n\t\t\t\treturn state.fullChatHistory?.isAvailable ?? false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/tariffRestrictions/set */\n\t\t\tset: (store, payload: JsonObject) => {\n\t\t\t\tstore.commit('set', this.formatFields(payload));\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: TariffRestrictions, payload: JsonObject) => {\n\t\t\t\tObject.entries(payload).forEach(([key, value]) => {\n\t\t\t\t\tstate[key] = value;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, tariffRestrictionsFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Layout, EventType } from 'im.v2.const';\nimport { LayoutManager } from 'im.v2.lib.layout';\n\nimport { SettingsModel } from './nested-modules/settings/settings';\nimport { TariffRestrictionsModel } from './nested-modules/tariff-restrictions/tariff-restrictions';\n\nimport type { ActionTree, GetterTree, MutationTree } from 'ui.vue3.vuex';\n\ntype ApplicationState = {\n\tlayout: {\n\t\tname: string,\n\t\tentityId: string,\n\t\tcontextId: number,\n\t},\n};\n\nexport class ApplicationModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'application';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tsettings: SettingsModel,\n\t\t\ttariffRestrictions: TariffRestrictionsModel,\n\t\t};\n\t}\n\n\tgetState(): ApplicationState\n\t{\n\t\treturn {\n\t\t\tlayout:\n\t\t\t{\n\t\t\t\tname: Layout.chat,\n\t\t\t\tentityId: '',\n\t\t\t\tcontextId: 0,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/getLayout */\n\t\t\tgetLayout: (state) => {\n\t\t\t\treturn state.layout;\n\t\t\t},\n\t\t\t/** @function application/isChatOpen */\n\t\t\tisChatOpen: (state) => (dialogId: string): boolean => {\n\t\t\t\tif (!LayoutManager.getInstance().isChatLayout(state.layout.name))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.layout.entityId === dialogId.toString();\n\t\t\t},\n\t\t\tisLinesChatOpen: (state) => (dialogId: string): boolean => {\n\t\t\t\tif (state.layout.name !== Layout.openlines && state.layout.name !== Layout.openlinesV2)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.layout.entityId === dialogId.toString();\n\t\t\t},\n\t\t\t/** @function application/areNotificationsOpen */\n\t\t\tareNotificationsOpen: (state) => {\n\t\t\t\treturn state.layout.name === Layout.notification;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function application/setLayout */\n\t\t\tsetLayout: (store, payload: {name: string, entityId?: string, contextId?: number}) => {\n\t\t\t\tconst { name, entityId = '', contextId = 0 } = payload;\n\t\t\t\tif (!Type.isStringFilled(name))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst previousLayout = { ...store.state.layout };\n\t\t\t\tconst newLayout = {\n\t\t\t\t\tname: this.validateLayout(name),\n\t\t\t\t\tentityId: this.validateLayoutEntityId(name, entityId),\n\t\t\t\t\tcontextId,\n\t\t\t\t};\n\n\t\t\t\tEventEmitter.emit(EventType.layout.onLayoutChange, {\n\t\t\t\t\tfrom: previousLayout,\n\t\t\t\t\tto: newLayout,\n\t\t\t\t});\n\n\t\t\t\tif (previousLayout.name === newLayout.name && previousLayout.entityId === newLayout.entityId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateLayout', {\n\t\t\t\t\tlayout: newLayout,\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tupdateLayout: (state, payload) => {\n\t\t\t\tstate.layout = { ...state.layout, ...payload.layout };\n\t\t\t},\n\t\t};\n\t}\n\n\tvalidateLayout(name: string): string\n\t{\n\t\tif (!LayoutManager.getInstance().isValidLayout(name))\n\t\t{\n\t\t\treturn Layout.chat;\n\t\t}\n\n\t\treturn name;\n\t}\n\n\tvalidateLayoutEntityId(name: string, entityId: string): string\n\t{\n\t\tif (!LayoutManager.getInstance().isValidLayout(name))\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\t// TODO check `entityId` by layout name\n\n\t\treturn entityId;\n\t}\n}\n","import { Type, type JsonObject } from 'main.core';\nimport { MessageComponent, type KeyboardButtonConfig } from 'im.v2.const';\n\nimport { convertToNumber } from '../../utils/format';\n\nexport const prepareComponentId = (componentId: string) => {\n\tconst supportedComponents = Object.values(MessageComponent);\n\tif (!supportedComponents.includes(componentId))\n\t{\n\t\treturn MessageComponent.unsupported;\n\t}\n\n\treturn componentId;\n};\n\nexport const prepareAuthorId = (target: number | string, currentResult: JsonObject, rawFields: JsonObject): number => {\n\tif (Type.isString(rawFields.system) && rawFields.system === 'Y')\n\t{\n\t\treturn 0;\n\t}\n\n\tif (Type.isBoolean(rawFields.isSystem) && rawFields.isSystem === true)\n\t{\n\t\treturn 0;\n\t}\n\n\treturn convertToNumber(target);\n};\n\nexport const prepareKeyboard = (rawKeyboardButtons: KeyboardButtonConfig[]): KeyboardButtonConfig[] => {\n\treturn rawKeyboardButtons.map((rawButton) => {\n\t\treturn {\n\t\t\t...rawButton,\n\t\t\tblock: rawButton.block === 'Y',\n\t\t\tdisabled: rawButton.disabled === 'Y',\n\t\t\tvote: rawButton.vote === 'Y',\n\t\t\twait: rawButton.wait === 'Y',\n\t\t};\n\t});\n};\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { prepareComponentId, prepareAuthorId, prepareKeyboard } from './format-functions';\nimport { convertToNumber, convertToString, isNumberOrString } from '../../utils/format';\n\nimport type { FieldsConfig } from 'im.v2.model';\n\nexport const messageFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: ['id', 'temporaryId'],\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: [Type.isNumber, Utils.text.isTempMessage],\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'date',\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: [Type.isString, Type.isDate],\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'text',\n\t\ttargetFieldName: 'text',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToString,\n\t},\n\t{\n\t\tfieldName: ['senderId', 'authorId'],\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: prepareAuthorId,\n\t},\n\t{\n\t\tfieldName: 'sending',\n\t\ttargetFieldName: 'sending',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'unread',\n\t\ttargetFieldName: 'unread',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'viewed',\n\t\ttargetFieldName: 'viewed',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'viewedByOthers',\n\t\ttargetFieldName: 'viewedByOthers',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'error',\n\t\ttargetFieldName: 'error',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'componentId',\n\t\ttargetFieldName: 'componentId',\n\t\tcheckFunction: (target): boolean => {\n\t\t\treturn Type.isString(target) && target !== '';\n\t\t},\n\t\tformatFunction: prepareComponentId,\n\t},\n\t{\n\t\tfieldName: 'componentParams',\n\t\ttargetFieldName: 'componentParams',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n\t{\n\t\tfieldName: ['files', 'fileId'],\n\t\ttargetFieldName: 'files',\n\t\tcheckFunction: Type.isArray,\n\t},\n\t{\n\t\tfieldName: 'attach',\n\t\ttargetFieldName: 'attach',\n\t\tcheckFunction: [Type.isArray, Type.isBoolean, Type.isString],\n\t},\n\t{\n\t\tfieldName: 'keyboard',\n\t\ttargetFieldName: 'keyboard',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: prepareKeyboard,\n\t},\n\t{\n\t\tfieldName: 'keyboard',\n\t\ttargetFieldName: 'keyboard',\n\t\tcheckFunction: (target): boolean => target === 'N',\n\t\tformatFunction: (): [] => [],\n\t},\n\t{\n\t\tfieldName: 'isEdited',\n\t\ttargetFieldName: 'isEdited',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: (target): boolean => target === 'Y',\n\t},\n\t{\n\t\tfieldName: 'isEdited',\n\t\ttargetFieldName: 'isEdited',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'isDeleted',\n\t\ttargetFieldName: 'isDeleted',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: (target): boolean => target === 'Y',\n\t},\n\t{\n\t\tfieldName: 'isDeleted',\n\t\ttargetFieldName: 'isDeleted',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'replyId',\n\t\ttargetFieldName: 'replyId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'forward',\n\t\ttargetFieldName: 'forward',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n];\n","import {BuilderModel} from 'ui.vue3.vuex';\n\nimport {Core} from 'im.v2.application.core';\nimport {Logger} from 'im.v2.lib.logger';\n\nimport type {ImModelMessage} from 'im.v2.model';\n\nexport class PinModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tgetPinned: (state: PinState) => (chatId: number): ImModelMessage[] =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t\tconst result = [];\n\t\t\t\t[...state.collection[chatId]].forEach((pinnedMessageId) => {\n\t\t\t\t\tconst message = Core.getStore().getters['messages/getById'](pinnedMessageId);\n\t\t\t\t\tif (message)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(message);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\tisPinned: (state: PinState) => (payload: {chatId: number, messageId: number}): boolean =>\n\t\t\t{\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].has(messageId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tsetPinned: (store, payload: {chatId: number, pinnedMessages: number[]}) =>\n\t\t\t{\n\t\t\t\tconst {chatId, pinnedMessages} = payload;\n\t\t\t\tif (pinnedMessages.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setPinned', {\n\t\t\t\t\tchatId,\n\t\t\t\t\tpinnedMessageIds: pinnedMessages\n\t\t\t\t});\n\t\t\t},\n\t\t\tset: (store, payload: {chatId: number, messageId: number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', payload);\n\t\t\t},\n\t\t\tadd: (store, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tstore.commit('add', payload);\n\t\t\t},\n\t\t\tdelete: (store, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): Object\n\t{\n\t\treturn {\n\t\t\tsetPinned: (state: PinState, payload: {chatId: number, pinnedMessageIds: number[]}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: setPinned mutation', payload);\n\t\t\t\tconst {chatId, pinnedMessageIds} = payload;\n\t\t\t\tstate.collection[chatId] = new Set(pinnedMessageIds.reverse());\n\t\t\t},\n\t\t\tadd: (state: PinState, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: add pin mutation', payload);\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = new Set();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].add(messageId);\n\t\t\t},\n\t\t\tdelete: (state: PinState, payload: {chatId: number, messageId: number}) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages/pin model: delete pin mutation', payload);\n\t\t\t\tconst {chatId, messageId} = payload;\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].delete(messageId);\n\t\t\t}\n\t\t};\n\t}\n}\n\ntype PinState = {\n\tcollection: {\n\t\t[chatId: string]: Set\n\t}\n};","import { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport type { Store, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { ImModelReactions } from 'im.v2.model';\n\ntype ReactionPayload = {\n\tmessageId: number,\n\tuserId: number,\n\treaction: string\n};\n\ntype SetReactionPayload = ReactionPayload & { withReplace?: boolean };\n\ntype RawReactions = {\n\tmessageId: number,\n\treactionCounters: ReactionCounters,\n\treactionUsers: ReactionUsers,\n\townReactions: string[],\n\townReactionsToRemove?: string[],\n};\ntype ReactionCounters = {[reactionType: string]: number};\ntype ReactionUsers = {[reactionType: string]: number[]};\ntype RawReactionsList = RawReactions[];\n\ntype ReactionsState = {\n\tcollection: {\n\t\t[messageId: string]: ImModelReactions\n\t}\n};\n\nconst USERS_TO_SHOW = 5;\n\nexport class ReactionsModel extends BuilderModel\n{\n\tgetState(): ReactionsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelReactions\n\t{\n\t\treturn {\n\t\t\treactionCounters: {},\n\t\t\treactionUsers: {},\n\t\t\townReactions: new Set(),\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/reactions/getByMessageId */\n\t\t\tgetByMessageId: (state: ReactionsState) => (messageId: number): ?ImModelReactions => {\n\t\t\t\treturn state.collection[messageId];\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/reactions/set */\n\t\t\tset: (store: Store, payload: RawReactionsList) => {\n\t\t\t\tstore.commit('set', this.prepareSetPayload(payload));\n\t\t\t},\n\t\t\t/** @function messages/reactions/setReaction */\n\t\t\tsetReaction: (store: Store, payload: ReactionPayload & { withReplace: boolean }) => {\n\t\t\t\tstore.commit('setReaction', payload);\n\t\t\t},\n\t\t\t/** @function messages/reactions/removeReaction */\n\t\t\tremoveReaction: (store: Store, payload: ReactionPayload) => {\n\t\t\t\tif (!store.state.collection[payload.messageId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('removeReaction', payload);\n\t\t\t},\n\t\t\t/** @function messages/reactions/clearCollection */\n\t\t\tclearCollection: (store: Store) => {\n\t\t\t\tstore.commit('clearCollection');\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: ReactionsState, payload: RawReactionsList) => {\n\t\t\t\tpayload.forEach((item) => {\n\t\t\t\t\tconst currentItem = state.collection[item.messageId];\n\t\t\t\t\tconst currentOwnReactions = currentItem ? currentItem.ownReactions : [];\n\n\t\t\t\t\tconst newOwnReactions = item.ownReactions ?? [];\n\t\t\t\t\tconst preparedOwnReactions = new Set([...newOwnReactions, ...currentOwnReactions]);\n\n\t\t\t\t\tif (item.ownReactionsToRemove)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.ownReactionsToRemove.forEach((reactionToRemove) => {\n\t\t\t\t\t\t\tpreparedOwnReactions.delete(reactionToRemove);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.collection[item.messageId] = {\n\t\t\t\t\t\treactionCounters: item.reactionCounters,\n\t\t\t\t\t\treactionUsers: item.reactionUsers,\n\t\t\t\t\t\townReactions: preparedOwnReactions,\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetReaction: (state: ReactionsState, payload: SetReactionPayload) => {\n\t\t\t\tconst { messageId, userId, reaction } = payload;\n\t\t\t\tif (!state.collection[messageId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[messageId] = this.getElementState();\n\t\t\t\t}\n\n\t\t\t\tconst reactions = state.collection[messageId];\n\n\t\t\t\tif (Core.getUserId() === userId)\n\t\t\t\t{\n\t\t\t\t\tthis.handleOwnReactions(reactions, payload);\n\t\t\t\t}\n\n\t\t\t\tif (!reactions.reactionCounters[reaction])\n\t\t\t\t{\n\t\t\t\t\treactions.reactionCounters[reaction] = 0;\n\t\t\t\t}\n\n\t\t\t\tconst currentReactionCounter = reactions.reactionCounters[reaction];\n\t\t\t\tconst newReactionCounter = currentReactionCounter + 1;\n\t\t\t\tif (newReactionCounter <= USERS_TO_SHOW)\n\t\t\t\t{\n\t\t\t\t\tthis.addUserToReaction(reactions, payload);\n\t\t\t\t}\n\n\t\t\t\treactions.reactionCounters[reaction] = newReactionCounter;\n\t\t\t},\n\t\t\tremoveReaction: (state: ReactionsState, payload: ReactionPayload) => {\n\t\t\t\tconst { messageId, userId, reaction } = payload;\n\t\t\t\tconst reactions = state.collection[messageId];\n\n\t\t\t\tif (Core.getUserId() === userId)\n\t\t\t\t{\n\t\t\t\t\treactions.ownReactions.delete(reaction);\n\t\t\t\t}\n\n\t\t\t\treactions.reactionUsers[reaction]?.delete(userId);\n\t\t\t\treactions.reactionCounters[reaction]--;\n\t\t\t\tif (reactions.reactionCounters[reaction] === 0)\n\t\t\t\t{\n\t\t\t\t\tdelete reactions.reactionCounters[reaction];\n\t\t\t\t}\n\t\t\t},\n\t\t\tclearCollection: (state: ReactionsState) => {\n\t\t\t\tstate.collection = {};\n\t\t\t},\n\t\t};\n\t}\n\n\thandleOwnReactions(reactions: ImModelReactions, payload: SetReactionPayload)\n\t{\n\t\tconst { reaction, withReplace = true } = payload;\n\t\tif (withReplace)\n\t\t{\n\t\t\tthis.removeAllCurrentUserReactions(reactions);\n\t\t}\n\n\t\treactions.ownReactions.add(reaction);\n\t}\n\n\taddUserToReaction(reactions: ImModelReactions, payload: SetReactionPayload)\n\t{\n\t\tconst { userId, reaction } = payload;\n\n\t\tif (!reactions.reactionUsers[reaction])\n\t\t{\n\t\t\treactions.reactionUsers[reaction] = new Set();\n\t\t}\n\n\t\treactions.reactionUsers[reaction].add(userId);\n\t}\n\n\tremoveAllCurrentUserReactions(reactions: ImModelReactions)\n\t{\n\t\treactions.ownReactions.forEach((reaction) => {\n\t\t\treactions.reactionUsers[reaction]?.delete(Core.getUserId());\n\t\t\treactions.reactionCounters[reaction]--;\n\t\t\tif (reactions.reactionCounters[reaction] === 0)\n\t\t\t{\n\t\t\t\tdelete reactions.reactionCounters[reaction];\n\t\t\t}\n\t\t});\n\n\t\treactions.ownReactions = new Set();\n\t}\n\n\tprepareSetPayload(payload: RawReactionsList): RawReactionsList\n\t{\n\t\treturn payload.map((item) => {\n\t\t\tconst reactionUsers = {};\n\t\t\tObject.entries(item.reactionUsers).forEach(([reaction, users]) => {\n\t\t\t\treactionUsers[reaction] = new Set(users);\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\t...item,\n\t\t\t\treactionUsers,\n\t\t\t};\n\t\t});\n\t}\n}\n","import { Type } from 'main.core';\n\nimport type { FieldsConfig } from 'im.v2.model';\n\nexport const commentFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'lastUserIds',\n\t\ttargetFieldName: 'lastUserIds',\n\t\tcheckFunction: Type.isArray,\n\t},\n\t{\n\t\tfieldName: 'messageCount',\n\t\ttargetFieldName: 'messageCount',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'isUserSubscribed',\n\t\ttargetFieldName: 'isUserSubscribed',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { commentFieldsConfig } from './format/field-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { ActionTree, MutationTree, GetterTree } from 'ui.vue3.vuex';\nimport type { ImModelCommentInfo, ImModelMessage } from 'im.v2.model';\nimport type { RawCommentInfo } from 'im.v2.provider.service.types';\n\nconst LAST_USERS_TO_SHOW = 3;\n\ntype CommentsState = {\n\tcollection: {\n\t\t[messageId: string]: ImModelCommentInfo\n\t},\n\tlayout: {\n\t\topened: boolean,\n\t\tchannelDialogId: string,\n\t\tpostId: number,\n\t}\n};\n\nexport class CommentsModel extends BuilderModel\n{\n\tgetState(): CommentsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tlayout: {\n\t\t\t\topened: false,\n\t\t\t\tchannelDialogId: '',\n\t\t\t\tpostId: 0,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelCommentInfo\n\t{\n\t\treturn {\n\t\t\tchatId: 0,\n\t\t\tlastUserIds: [],\n\t\t\tmessageCount: 0,\n\t\t\tmessageId: 0,\n\t\t\tisUserSubscribed: false,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/comments/getByMessageId */\n\t\t\tgetByMessageId: (state: CommentsState) => (messageId: number): ?ImModelCommentInfo => {\n\t\t\t\treturn state.collection[messageId] ?? this.getElementState();\n\t\t\t},\n\t\t\t/** @function messages/comments/getMessageIdByChatId */\n\t\t\tgetMessageIdByChatId: (state: CommentsState) => (chatId: number): ?number => {\n\t\t\t\tconst collection = Object.values(state.collection);\n\t\t\t\tconst foundItem = collection.find((item) => {\n\t\t\t\t\treturn item.chatId === chatId;\n\t\t\t\t});\n\n\t\t\t\treturn foundItem?.messageId;\n\t\t\t},\n\t\t\t/** @function messages/comments/isUserSubscribed */\n\t\t\tisUserSubscribed: (state: CommentsState) => (messageId: number): boolean => {\n\t\t\t\tconst element = state.collection[messageId];\n\t\t\t\tif (!element && this.#isMessageAuthor(messageId))\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn element?.isUserSubscribed ?? false;\n\t\t\t},\n\t\t\t/** @function messages/comments/areOpened */\n\t\t\tareOpened: (state: CommentsState): boolean => {\n\t\t\t\treturn state.layout.opened;\n\t\t\t},\n\t\t\t/** @function messages/comments/areOpenedForChannel */\n\t\t\tareOpenedForChannel: (state: CommentsState) => (channelDialogId: string): boolean => {\n\t\t\t\treturn state.layout.channelDialogId === channelDialogId;\n\t\t\t},\n\t\t\t/** @function messages/comments/areOpenedForChannelPost */\n\t\t\tareOpenedForChannelPost: (state: CommentsState) => (postId: number): boolean => {\n\t\t\t\treturn state.layout.postId === postId;\n\t\t\t},\n\t\t\t/** @function messages/comments/getOpenedChannelId */\n\t\t\tgetOpenedChannelId: (state: CommentsState): string => {\n\t\t\t\treturn state.layout.channelDialogId ?? '';\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/comments/set */\n\t\t\tset: (store, rawPayload: RawCommentInfo[] | RawCommentInfo) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!payload)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload = payload.map((item: RawCommentInfo) => {\n\t\t\t\t\tconst currentItem: ImModelCommentInfo = store.state.collection[item.messageId];\n\t\t\t\t\tif (currentItem)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn { ...currentItem, ...this.#formatFields(item) };\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t\tisUserSubscribed: this.#isMessageAuthor(item.messageId),\n\t\t\t\t\t\t...this.#formatFields(item),\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\t\tstore.commit('set', payload);\n\t\t\t},\n\t\t\t/** @function messages/comments/setLastUser */\n\t\t\tsetLastUser: (store, payload: { messageId: number, newUserId: number }) => {\n\t\t\t\tconst { messageId, newUserId } = payload;\n\t\t\t\tconst currentItem = store.state.collection[messageId];\n\t\t\t\tif (!currentItem || newUserId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setLastUser', payload);\n\t\t\t},\n\t\t\t/** @function messages/comments/subscribe */\n\t\t\tsubscribe: (store, messageId: number) => {\n\t\t\t\tCore.getStore().dispatch('messages/comments/set', {\n\t\t\t\t\tmessageId,\n\t\t\t\t\tisUserSubscribed: true,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/comments/unsubscribe */\n\t\t\tunsubscribe: (store, messageId: number) => {\n\t\t\t\tCore.getStore().dispatch('messages/comments/set', {\n\t\t\t\t\tmessageId,\n\t\t\t\t\tisUserSubscribed: false,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/comments/setOpened */\n\t\t\tsetOpened: (store, payload: { channelDialogId: string }) => {\n\t\t\t\tstore.commit('setOpened', payload);\n\t\t\t},\n\t\t\t/** @function messages/comments/setClosed */\n\t\t\tsetClosed: (store) => {\n\t\t\t\tstore.commit('setClosed');\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: CommentsState, payload: RawCommentInfo[]) => {\n\t\t\t\tpayload.forEach((item) => {\n\t\t\t\t\tstate.collection[item.messageId] = item;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetLastUser: (state: CommentsState, payload: { messageId: number, newUserId: number }) => {\n\t\t\t\tconst { messageId, newUserId } = payload;\n\t\t\t\tconst { lastUserIds: currentUsers } = state.collection[messageId];\n\t\t\t\tif (currentUsers.includes(newUserId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (currentUsers.length < LAST_USERS_TO_SHOW)\n\t\t\t\t{\n\t\t\t\t\tcurrentUsers.unshift(newUserId);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcurrentUsers.pop();\n\t\t\t\tcurrentUsers.unshift(newUserId);\n\t\t\t},\n\t\t\tsetOpened: (state: CommentsState, payload: { channelDialogId: string, commentsPostId: number }) => {\n\t\t\t\tconst { channelDialogId, commentsPostId } = payload;\n\n\t\t\t\tstate.layout = {\n\t\t\t\t\topened: true,\n\t\t\t\t\tchannelDialogId,\n\t\t\t\t\tpostId: commentsPostId,\n\t\t\t\t};\n\t\t\t},\n\t\t\tsetClosed: (state: CommentsState) => {\n\t\t\t\tstate.layout = {\n\t\t\t\t\topened: false,\n\t\t\t\t\tchannelDialogId: '',\n\t\t\t\t\tcommentsPostId: 0,\n\t\t\t\t};\n\t\t\t},\n\t\t};\n\t}\n\n\t#formatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, commentFieldsConfig);\n\t}\n\n\t#isMessageAuthor(messageId: number): boolean\n\t{\n\t\tconst message: ImModelMessage = Core.getStore().getters['messages/getById'](messageId);\n\n\t\treturn message?.authorId === Core.getUserId();\n\t}\n}\n","import { Core } from 'im.v2.application.core';\nimport { ActionTree, BuilderModel, MutationTree, GetterTree } from 'ui.vue3.vuex';\n\ntype SelectState = {\n\tcollection: {\n\t\t[dialogId: string]: Set<number>,\n\t},\n};\n\nexport class SelectModel extends BuilderModel\n{\n\tgetState(): SelectState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/select/getCollection */\n\t\t\tgetCollection: (state: SelectState) => (dialogId: string): ?Set<number> => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst preparedCollection = [...state.collection[dialogId]];\n\n\t\t\t\tconst filteredMessageIds = preparedCollection.filter((messageId) => {\n\t\t\t\t\treturn Core.getStore().getters['messages/isExists'](messageId);\n\t\t\t\t});\n\n\t\t\t\treturn new Set(filteredMessageIds);\n\t\t\t},\n\t\t\t/** @function messages/select/isBulkActionsModeActive */\n\t\t\tisBulkActionsModeActive: (state: SelectState) => (dialogId: string): boolean => {\n\t\t\t\treturn Boolean(state.collection[dialogId]);\n\t\t\t},\n\t\t\t/** @function messages/select/isMessageSelected */\n\t\t\tisMessageSelected: (state: SelectState) => (messageId: number, dialogId: string): boolean => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].has(messageId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/select/enableBulkMode */\n\t\t\tenableBulkMode: (store: Object, payload: {messageId: number, dialogId: string}) => {\n\t\t\t\tconst { messageId, dialogId } = payload;\n\n\t\t\t\tif (store.state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('enableBulkMode', {\n\t\t\t\t\tmessageId,\n\t\t\t\t\tdialogId,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/select/disableBulkMode */\n\t\t\tdisableBulkMode: (store: Object, payload: {dialogId: string}) => {\n\t\t\t\tconst { dialogId } = payload;\n\n\t\t\t\tif (!store.state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('disableBulkMode', {\n\t\t\t\t\tdialogId,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/select/toggleMessageSelection */\n\t\t\ttoggleMessageSelection: (store: Object, payload: {messageId: number, dialogId: string}) => {\n\t\t\t\tconst { messageId, dialogId } = payload;\n\n\t\t\t\tif (!store.state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('toggleMessageSelection', {\n\t\t\t\t\tmessageId,\n\t\t\t\t\tdialogId,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/select/clearCollection */\n\t\t\tclearCollection: (store: Object) => {\n\t\t\t\tstore.commit('clearCollection');\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tenableBulkMode: (state: SelectState, payload: {messageId: number, dialogId: string}) => {\n\t\t\t\tconst { messageId, dialogId } = payload;\n\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[dialogId] = new Set();\n\t\t\t\tstate.collection[dialogId].add(messageId);\n\t\t\t},\n\t\t\tdisableBulkMode: (state: SelectState, payload: {dialogId: string}) => {\n\t\t\t\tconst { dialogId } = payload;\n\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tdelete state.collection[dialogId];\n\t\t\t},\n\t\t\ttoggleMessageSelection: (state: SelectState, payload: {messageId: number, dialogId: string}) => {\n\t\t\t\tconst { messageId, dialogId } = payload;\n\n\t\t\t\tif (state.collection[dialogId].has(messageId))\n\t\t\t\t{\n\t\t\t\t\tstate.collection[dialogId].delete(messageId);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.collection[dialogId].add(messageId);\n\t\t\t},\n\t\t\tclearCollection: (state: SelectState) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection = {};\n\t\t\t},\n\t\t};\n\t}\n}\n","import type { AnchorType } from 'im.v2.const';\nimport type { Anchor } from '../../../type/anchor';\n\nexport function isAnchorsEqual(anchor1: Anchor, anchor2: Anchor): boolean\n{\n\treturn anchor1.messageId === anchor2.messageId\n\t\t&& anchor1.type === anchor2.type\n\t\t&& anchor1.fromUserId === anchor2.fromUserId\n\t;\n}\n\nexport function isAnchorWithTypeFromCurrentChat(anchor: Anchor, anchorType: AnchorType, chatId: number): boolean\n{\n\treturn anchor.chatId === chatId && anchor.type === anchorType\n\t;\n}\n","import { Type } from 'main.core';\nimport { BuilderModel, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { type AnchorType, ChatType } from 'im.v2.const';\n\nimport { isAnchorsEqual, isAnchorWithTypeFromCurrentChat } from './helpers';\n\nimport { type Anchor } from '../../../type/anchor';\n\ntype AnchorsState = {\n\tanchors: Anchor[];\n};\n\nexport class AnchorsModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'anchors';\n\t}\n\n\tgetState(): AnchorsState\n\t{\n\t\treturn {\n\t\t\tanchors: [],\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree {\n\t\treturn {\n\t\t\t/** @function messages/anchors/getChatMessageIdsWithAnchors */\n\t\t\tgetChatMessageIdsWithAnchors: (state: AnchorsState) => (\n\t\t\t\tchatId: number,\n\t\t\t): number[] => {\n\t\t\t\treturn [...state.anchors]\n\t\t\t\t\t.filter((anchor) => {\n\t\t\t\t\t\treturn anchor.chatId === chatId;\n\t\t\t\t\t})\n\t\t\t\t\t.map((anchor) => anchor.messageId)\n\t\t\t\t;\n\t\t\t},\n\t\t\t/** @function messages/anchors/isMessageHasAnchors */\n\t\t\tisMessageHasAnchors: (state: AnchorsState) => (\n\t\t\t\tmessageId: number,\n\t\t\t): boolean => {\n\t\t\t\treturn state.anchors.some((anchor) => {\n\t\t\t\t\treturn anchor.messageId === messageId;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/anchors/isChatHasAnchors */\n\t\t\tisChatHasAnchors: (state: AnchorsState) => (chatId: number): boolean => {\n\t\t\t\treturn state.anchors.some((anchor) => {\n\t\t\t\t\treturn anchor.chatId === chatId;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/anchors/isChatHasAnchorsWithType */\n\t\t\tisChatHasAnchorsWithType: (state: AnchorsState) => (\n\t\t\t\tchatId: number,\n\t\t\t\tanchorType: AnchorType,\n\t\t\t): boolean => {\n\t\t\t\treturn state.anchors.some((anchor) => {\n\t\t\t\t\treturn isAnchorWithTypeFromCurrentChat(anchor, anchorType, chatId);\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/anchors/getCounterInChatByType */\n\t\t\tgetCounterInChatByType: (state: AnchorsState) => (\n\t\t\t\tchatId: number,\n\t\t\t\tanchorType: AnchorType,\n\t\t\t): number => {\n\t\t\t\tconst chatAnchors = state.anchors.filter((anchor) => {\n\t\t\t\t\treturn isAnchorWithTypeFromCurrentChat(anchor, anchorType, chatId);\n\t\t\t\t});\n\n\t\t\t\treturn new Set(chatAnchors.map((chatAnchor) => chatAnchor.messageId)).size;\n\t\t\t},\n\t\t\t/** @function messages/anchors/getNextMessageIdWithAnchorType */\n\t\t\tgetNextMessageIdWithAnchorType: (state: AnchorsState) => (\n\t\t\t\tchatId: number,\n\t\t\t\tanchorType: AnchorType,\n\t\t\t): number | null => {\n\t\t\t\tconst anchors: Anchor[] = state.anchors\n\t\t\t\t\t.filter((anchor) => {\n\t\t\t\t\t\treturn isAnchorWithTypeFromCurrentChat(anchor, anchorType, chatId);\n\t\t\t\t\t})\n\t\t\t\t\t.sort((anchorOne, anchorTwo) => anchorOne.messageId - anchorTwo.messageId)\n\t\t\t\t;\n\n\t\t\t\treturn anchors.at(0)?.messageId;\n\t\t\t},\n\t\t\t/** @function messages/anchors/getAnchorsByChatType */\n\t\t\tgetAnchorsByChatType: (state: AnchorsState) => (chatType: $Values<typeof ChatType>) => {\n\t\t\t\treturn state.anchors.filter((anchor: Anchor) => {\n\t\t\t\t\tconst { type } = Core.getStore().getters['chats/getByChatId'](anchor.chatId, true);\n\n\t\t\t\t\treturn type === chatType;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/anchors/setAnchors */\n\t\t\tsetAnchors: (store, payload: { anchors: [] }) => {\n\t\t\t\tif (Type.isPlainObject(payload) === false)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setAnchors', { anchors: payload.anchors });\n\t\t\t},\n\t\t\t/** @function messages/anchors/addAnchor */\n\t\t\taddAnchor: (store, payload: {anchor: Anchor}) => {\n\t\t\t\tif (Type.isPlainObject(payload) === false)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst equalAnchor = store.state.anchors.find((anchor) => {\n\t\t\t\t\treturn isAnchorsEqual(anchor, payload.anchor);\n\t\t\t\t});\n\n\t\t\t\tif (!equalAnchor)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('addAnchor', payload);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/** @function messages/anchors/removeAnchor */\n\t\t\tremoveAnchor: (store, payload: {anchor: Anchor}) => {\n\t\t\t\tif (Type.isPlainObject(payload) === false)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('removeAnchor', payload);\n\t\t\t},\n\t\t\t/** @function messages/anchors/removeUserAnchorsFromMessage */\n\t\t\tremoveUserAnchorsFromMessage: (store, messageId: string) => {\n\t\t\t\tstore.state.anchors.forEach((anchor) => {\n\t\t\t\t\tif (anchor.messageId === messageId)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('removeAnchor', { anchor });\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/anchors/removeChatAnchors */\n\t\t\tremoveChatAnchors: (store, chatId: number) => {\n\t\t\t\tstore.commit('removeChatAnchors', chatId);\n\t\t\t},\n\t\t\t/** @function messages/anchors/removeAllAnchorsByChatType */\n\t\t\tremoveAllAnchorsByChatType: (store, payload: { type: $Values<typeof ChatType> }) => {\n\t\t\t\tstore.commit('removeAllAnchorsByChatType', payload);\n\t\t\t},\n\t\t\t/** @function messages/anchors/removeAllAnchors */\n\t\t\tremoveAllAnchors: (store) => {\n\t\t\t\tstore.commit('removeAllAnchors');\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetAnchors: (state: AnchorsState, payload: {anchors: Anchor[]}) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.anchors = [...payload.anchors];\n\t\t\t},\n\t\t\taddAnchor: (state: AnchorsState, payload: {anchor: Anchor}) => {\n\t\t\t\tstate.anchors.push(payload.anchor);\n\t\t\t},\n\t\t\tremoveAnchor: (state: AnchorsState, payload: {anchor: Anchor}) => {\n\t\t\t\tconst removedAnchorIndex = state.anchors.findIndex((anchor) => {\n\t\t\t\t\treturn isAnchorsEqual(anchor, payload.anchor);\n\t\t\t\t});\n\n\t\t\t\tif (removedAnchorIndex > -1)\n\t\t\t\t{\n\t\t\t\t\tstate.anchors.splice(removedAnchorIndex, 1);\n\t\t\t\t}\n\t\t\t},\n\t\t\tremoveChatAnchors: (state: AnchorsState, chatId: number) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.anchors = state.anchors.filter((anchor: Anchor) => {\n\t\t\t\t\treturn anchor.chatId !== chatId;\n\t\t\t\t});\n\t\t\t},\n\t\t\tremoveAllAnchorsByChatType: (state: AnchorsState, payload: { type: $Values<typeof ChatType> }) => {\n\t\t\t\tconst { type } = payload;\n\t\t\t\tconst anchors = Core.getStore().getters['messages/anchors/getAnchorsByChatType'](type);\n\t\t\t\tconst chatIds = new Set(anchors.map((anchor: Anchor) => anchor.chatId));\n\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.anchors = state.anchors.filter((anchor: Anchor) => {\n\t\t\t\t\treturn !chatIds.has(anchor.chatId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tremoveAllAnchors: (state: AnchorsState) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.anchors = [];\n\t\t\t},\n\t\t};\n\t}\n}\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Logger } from 'im.v2.lib.logger';\nimport { MessageComponent, MessageType, UserIdNetworkPrefix } from 'im.v2.const';\nimport { UserManager } from 'im.v2.lib.user';\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { convertToNumber } from '../utils/format';\nimport { messageFieldsConfig } from './format/field-config';\nimport { PinModel } from './nested-modules/pin';\nimport { ReactionsModel } from './nested-modules/reactions';\nimport { CommentsModel } from './nested-modules/comments/comments';\nimport { SelectModel } from './nested-modules/select';\nimport { AnchorsModel } from './nested-modules/anchors/anchors';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { JsonObject } from 'main.core';\nimport type { ImModelMessage, ImModelFile } from 'im.v2.model';\nimport type { AttachConfig } from 'im.v2.const';\nimport type { RawMessage } from '../type/message';\n\ntype MessageId = string | number;\n\ntype MessagesState = {\n\tcollection: {\n\t\t[messageId: string]: ImModelMessage\n\t},\n\tchatCollection: {\n\t\t[chatId: string]: Set<string | number>\n\t},\n\tloadingMessages: {\n\t\t[previousSibling: MessageId]: ImModelMessage,\n\t},\n};\n\nexport class MessagesModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'messages';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tpin: PinModel,\n\t\t\treactions: ReactionsModel,\n\t\t\tcomments: CommentsModel,\n\t\t\tselect: SelectModel,\n\t\t\tanchors: AnchorsModel,\n\t\t};\n\t}\n\n\tgetState(): MessagesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tchatCollection: {},\n\t\t\tloadingMessages: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelMessage\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\treplyId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttext: '',\n\t\t\tfiles: [],\n\t\t\tattach: [],\n\t\t\tkeyboard: [],\n\t\t\tunread: false,\n\t\t\tviewed: true,\n\t\t\tviewedByOthers: false,\n\t\t\tsending: false,\n\t\t\terror: false,\n\t\t\tcomponentId: MessageComponent.default,\n\t\t\tcomponentParams: {},\n\t\t\tforward: {\n\t\t\t\tid: '',\n\t\t\t\tuserId: 0,\n\t\t\t},\n\t\t\tisEdited: false,\n\t\t\tisDeleted: false,\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/getByChatId */\n\t\t\tgetByChatId: (state: MessagesState, getters) => (chatId: number) => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tconst fakeFirstMessage: { id: string } = { id: this.#makeFakePreviousSiblingId(chatId) };\n\t\t\t\tconst firstLoadingMessages: Array<ImModelMessage> = this.#findNextLoadingMessages(\n\t\t\t\t\tfakeFirstMessage,\n\t\t\t\t\tgetters,\n\t\t\t\t);\n\n\t\t\t\treturn [...state.chatCollection[chatId]]\n\t\t\t\t\t.map((messageId: number | string) => {\n\t\t\t\t\t\treturn state.collection[messageId];\n\t\t\t\t\t})\n\t\t\t\t\t.sort(this.#sortCollection)\n\t\t\t\t\t.reduce((acc: Array<ImModelMessage>, message: ImModelMessage) => {\n\t\t\t\t\t\tacc.push(message, ...this.#findNextLoadingMessages(message, getters));\n\n\t\t\t\t\t\treturn acc;\n\t\t\t\t\t}, [...firstLoadingMessages]);\n\t\t\t},\n\t\t\t/** @function messages/getById */\n\t\t\tgetById: (state: MessagesState) => (id: number | string): ?ImModelMessage => {\n\t\t\t\treturn state.collection[id];\n\t\t\t},\n\t\t\t/** @function messages/getByIdList */\n\t\t\tgetByIdList: (state: MessagesState) => (idList: number[]): ImModelMessage[] => {\n\t\t\t\tconst result = [];\n\t\t\t\tidList.forEach((id) => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\t/** @function messages/hasMessage */\n\t\t\thasMessage: (state: MessagesState) => ({ chatId, messageId }) => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.chatCollection[chatId].has(messageId);\n\t\t\t},\n\t\t\t/** @function messages/isForward */\n\t\t\tisForward: (state: MessagesState) => (id: number | string) => {\n\t\t\t\tconst message = state.collection[id];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn Type.isStringFilled(message.forward.id);\n\t\t\t},\n\t\t\t/** @function messages/isVideoNote */\n\t\t\tisVideoNote: (state: MessagesState, getters: GetterTree) => (id: number | string) => {\n\t\t\t\tconst message = state.collection[id];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn getters.getMessageFiles(id).some((file: ImModelFile) => file.isVideoNote);\n\t\t\t},\n\t\t\t/** @function messages/isExists */\n\t\t\tisExists: (state: MessagesState) => (id: number | string) => {\n\t\t\t\tconst message = state.collection[id];\n\n\t\t\t\treturn message && !message.isDeleted;\n\t\t\t},\n\t\t\t/** @function messages/isInChatCollection */\n\t\t\tisInChatCollection: (state: MessagesState) => (payload: {messageId: number}): boolean => {\n\t\t\t\tconst { messageId } = payload;\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst { chatId } = message;\n\n\t\t\t\treturn state.chatCollection[chatId]?.has(messageId);\n\t\t\t},\n\t\t\t/** @function messages/getFirstId */\n\t\t\tgetFirstId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findLowestMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getLastId */\n\t\t\tgetLastId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findMaxMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getLastOwnMessageId */\n\t\t\tgetLastOwnMessageId: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findLastOwnMessageId(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getFirstUnread */\n\t\t\tgetFirstUnread: (state: MessagesState) => (chatId: number): number => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#findFirstUnread(state, chatId);\n\t\t\t},\n\t\t\t/** @function messages/getChatUnreadMessages */\n\t\t\tgetChatUnreadMessages: (state: MessagesState) => (chatId: number): ImModelMessage[] => {\n\t\t\t\tif (!state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tconst messages = [...state.chatCollection[chatId]].map((messageId: number | string) => {\n\t\t\t\t\treturn state.collection[messageId];\n\t\t\t\t});\n\n\t\t\t\treturn messages.filter((message: ImModelMessage) => {\n\t\t\t\t\treturn message.unread === true;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/getMessageFiles */\n\t\t\tgetMessageFiles: (state: MessagesState) => (payload: number): ImModelFile[] => {\n\t\t\t\tconst messageId = payload;\n\t\t\t\tif (!state.collection[messageId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[messageId].files.map((fileId) => {\n\t\t\t\t\treturn this.store.getters['files/get'](fileId, true);\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/getMessageType */\n\t\t\tgetMessageType: (state: MessagesState) => (messageId: number): ?$Values<typeof MessageType> => {\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tif (message.authorId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn MessageType.system;\n\t\t\t\t}\n\n\t\t\t\tif (message.authorId === currentUserId)\n\t\t\t\t{\n\t\t\t\t\treturn MessageType.self;\n\t\t\t\t}\n\n\t\t\t\treturn MessageType.opponent;\n\t\t\t},\n\t\t\t/** @function messages/getPreviousMessage */\n\t\t\tgetPreviousMessage: (state: MessagesState) => (payload: {messageId: number, chatId: number}): ?ImModelMessage => {\n\t\t\t\tconst { messageId, chatId } = payload;\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst chatCollection = [...state.chatCollection[chatId]];\n\t\t\t\tconst initialMessageIndex = chatCollection.indexOf(messageId);\n\t\t\t\tconst desiredMessageId = chatCollection[initialMessageIndex - 1];\n\t\t\t\tif (!desiredMessageId)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[desiredMessageId];\n\t\t\t},\n\t\t\t/** @function messages/findPreviousMessageId */\n\t\t\tfindPreviousMessageId: (state, getters) => (payload: { messageId: MessageId, chatId: number }): MessageId => {\n\t\t\t\tconst chatCollection: Array<ImModelMessage> = getters.getByChatId(payload.chatId);\n\t\t\t\tconst currentMessageIndex: number = chatCollection.findIndex((message: ImModelMessage) => {\n\t\t\t\t\treturn message.id === payload.messageId;\n\t\t\t\t});\n\n\t\t\t\tif (currentMessageIndex > 0)\n\t\t\t\t{\n\t\t\t\t\treturn chatCollection[currentMessageIndex - 1].id;\n\t\t\t\t}\n\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\t/** @function messages/findLastChatMessageId */\n\t\t\tfindLastChatMessageId: (state, getters) => (chatId: number): MessageId | null => {\n\t\t\t\tconst lastMessage: ?ImModelMessage = getters.getByChatId(chatId).pop();\n\t\t\t\tif (lastMessage)\n\t\t\t\t{\n\t\t\t\t\treturn lastMessage.id;\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\t/** @function messages/hasLoadingMessageByPreviousSiblingId */\n\t\t\thasLoadingMessageByPreviousSiblingId: (state: MessagesState) => (messageId: MessageId): boolean => {\n\t\t\t\treturn Boolean(state.loadingMessages[messageId]);\n\t\t\t},\n\t\t\t/** @function messages/getLoadingMessageByPreviousSiblingId */\n\t\t\tgetLoadingMessageByPreviousSiblingId: (state: MessagesState) => (messageId: MessageId): ?ImModelMessage => {\n\t\t\t\treturn state.loadingMessages[messageId] ?? null;\n\t\t\t},\n\t\t\t/** @function messages/getLoadingMessageByMessageId */\n\t\t\tgetLoadingMessageByMessageId: (state: MessagesState) => (messageId: MessageId): ?ImModelMessage => {\n\t\t\t\tconst message: ImModelMessage = Object\n\t\t\t\t\t.values(state.loadingMessages)\n\t\t\t\t\t.find((currentMessage: ImModelMessage) => {\n\t\t\t\t\t\treturn currentMessage.id === messageId;\n\t\t\t\t\t});\n\n\t\t\t\tif (message)\n\t\t\t\t{\n\t\t\t\t\treturn message;\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\t/** @function messages/hasLoadingMessageByMessageId */\n\t\t\thasLoadingMessageByMessageId: (state: MessagesState, getters) => (messageId: MessageId): boolean => {\n\t\t\t\treturn getters.getLoadingMessageByMessageId(messageId) !== null;\n\t\t\t},\n\t\t\t/** @function messages/isRealMessage */\n\t\t\tisRealMessage: () => (messageId: MessageId): boolean => {\n\t\t\t\treturn !Utils.text.isTempMessage(messageId);\n\t\t\t},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function messages/setChatCollection */\n\t\t\tsetChatCollection: (store, payload: {messages: RawMessage | RawMessage[], clearCollection: boolean}) => {\n\t\t\t\tlet { messages, clearCollection } = payload;\n\t\t\t\tclearCollection = clearCollection ?? false;\n\t\t\t\tif (!Array.isArray(messages) && Type.isPlainObject(messages))\n\t\t\t\t{\n\t\t\t\t\tmessages = [messages];\n\t\t\t\t}\n\n\t\t\t\tmessages = messages.map((message: RawMessage) => {\n\t\t\t\t\treturn { ...this.getElementState(), ...this.#formatFields(message) };\n\t\t\t\t});\n\t\t\t\tconst chatId = messages[0]?.chatId;\n\t\t\t\tif (chatId && clearCollection)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('clearCollection', { chatId });\n\t\t\t\t}\n\n\t\t\t\tstore.commit('store', { messages });\n\t\t\t\tstore.commit('setChatCollection', { messages });\n\t\t\t},\n\t\t\t/** @function messages/store */\n\t\t\tstore: (store, payload: RawMessage | RawMessage[]) => {\n\t\t\t\tlet preparedMessages = payload;\n\t\t\t\tif (Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpreparedMessages = [payload];\n\t\t\t\t}\n\n\t\t\t\tpreparedMessages = preparedMessages.map((message: RawMessage) => {\n\t\t\t\t\tconst currentMessage: ImModelMessage = store.state.collection[message.id];\n\t\t\t\t\tif (currentMessage)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn { ...currentMessage, ...this.#formatFields(message) };\n\t\t\t\t\t}\n\n\t\t\t\t\treturn { ...this.getElementState(), ...this.#formatFields(message) };\n\t\t\t\t});\n\n\t\t\t\tif (preparedMessages.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('store', {\n\t\t\t\t\tmessages: preparedMessages,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/add */\n\t\t\tadd: (store, payload: RawMessage) => {\n\t\t\t\tconst message = {\n\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t...this.#formatFields(payload),\n\t\t\t\t};\n\t\t\t\tstore.commit('store', {\n\t\t\t\t\tmessages: [message],\n\t\t\t\t});\n\t\t\t\tstore.commit('setChatCollection', {\n\t\t\t\t\tmessages: [message],\n\t\t\t\t});\n\n\t\t\t\treturn message.id;\n\t\t\t},\n\t\t\t/** @function messages/updateWithId */\n\t\t\tupdateWithId: (store, payload: {id: string | number, fields: Object}) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateWithId', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: this.#formatFields(fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/update */\n\t\t\tupdate: (store, payload: {id: string | number, fields: Object}) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst currentMessage = store.state.collection[id];\n\t\t\t\tif (!currentMessage)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: { ...currentMessage, ...this.#formatFields(fields) },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/readMessages */\n\t\t\treadMessages: (store, payload: {chatId: number, messageIds: number[]}): number => {\n\t\t\t\tconst { chatId, messageIds } = payload;\n\t\t\t\tif (!store.state.chatCollection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst chatMessages = [...store.state.chatCollection[chatId]].map((messageId: number) => {\n\t\t\t\t\treturn store.state.collection[messageId];\n\t\t\t\t});\n\n\t\t\t\tlet messagesToReadCount = 0;\n\t\t\t\tconst maxMessageId = this.#getMaxMessageId(messageIds);\n\t\t\t\tconst messageIdsToView = messageIds;\n\t\t\t\tconst messageIdsToRead = [];\n\t\t\t\tchatMessages.forEach((chatMessage: ImModelMessage) => {\n\t\t\t\t\tif (!chatMessage.unread)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chatMessage.id <= maxMessageId)\n\t\t\t\t\t{\n\t\t\t\t\t\tmessagesToReadCount++;\n\t\t\t\t\t\tmessageIdsToRead.push(chatMessage.id);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tstore.commit('readMessages', {\n\t\t\t\t\tmessageIdsToRead,\n\t\t\t\t\tmessageIdsToView,\n\t\t\t\t});\n\n\t\t\t\treturn messagesToReadCount;\n\t\t\t},\n\t\t\t/** @function messages/setViewedByOthers */\n\t\t\tsetViewedByOthers: (store, payload: {ids: number[]}): number => {\n\t\t\t\tconst { ids } = payload;\n\t\t\t\tstore.commit('setViewedByOthers', {\n\t\t\t\t\tids,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/delete */\n\t\t\tdelete: (store, payload: {id: string | number}) => {\n\t\t\t\tconst { id } = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (store.getters.hasLoadingMessageByPreviousSiblingId(id))\n\t\t\t\t{\n\t\t\t\t\tconst currentMessage: ImModelMessage = store.state.collection[id];\n\t\t\t\t\tconst newPreviousMessageId: MessageId = store.getters.findPreviousMessageId({\n\t\t\t\t\t\tmessageId: currentMessage.id,\n\t\t\t\t\t\tchatId: currentMessage.chatId,\n\t\t\t\t\t});\n\n\t\t\t\t\tstore.commit('updateLoadingMessagePreviousSiblingId', {\n\t\t\t\t\t\toldId: currentMessage.id,\n\t\t\t\t\t\tnewId: newPreviousMessageId,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (store.getters.hasLoadingMessageByMessageId(id))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('deleteLoadingMessageByMessageId', {\n\t\t\t\t\t\tmessageId: id,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { id });\n\t\t\t},\n\t\t\t/** @function messages/clearChatCollection */\n\t\t\tclearChatCollection: (store, payload: {chatId: number}) => {\n\t\t\t\tconst { chatId } = payload;\n\t\t\t\tstore.commit('clearCollection', { chatId });\n\t\t\t},\n\t\t\t/** @function messages/deleteAttach */\n\t\t\tdeleteAttach: (store, payload: {messageId: number, attachId: string }) => {\n\t\t\t\tconst { messageId, attachId } = payload;\n\t\t\t\tconst message: ImModelMessage = store.state.collection[messageId];\n\t\t\t\tif (!message || !Type.isArray(message.attach))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst attach = message.attach.filter((attachItem: AttachConfig) => {\n\t\t\t\t\treturn attachId !== attachItem.id;\n\t\t\t\t});\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: messageId,\n\t\t\t\t\tfields: { ...message, ...this.#formatFields({ attach }) },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/addLoadingMessage */\n\t\t\taddLoadingMessage: (store, payload: { message: ImModelMessage }) => {\n\t\t\t\tconst message = {\n\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t...this.#formatFields(payload.message),\n\t\t\t\t};\n\n\t\t\t\tstore.commit('store', {\n\t\t\t\t\tmessages: [message],\n\t\t\t\t});\n\n\t\t\t\tif (!store.state.chatCollection[message.chatId])\n\t\t\t\t{\n\t\t\t\t\tstore.commit('initChatCollection', {\n\t\t\t\t\t\tchatId: message.chatId,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tconst previousSiblingId: ?MessageId = (() => {\n\t\t\t\t\tconst id: number | string | null = store.getters.findLastChatMessageId(message.chatId);\n\t\t\t\t\tif (Type.isNull(id))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this.#makeFakePreviousSiblingId(message.chatId);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn id;\n\t\t\t\t})();\n\n\t\t\t\tstore.commit('addLoadingMessage', {\n\t\t\t\t\tmessage,\n\t\t\t\t\tpreviousSiblingId,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function messages/deleteLoadingMessageByMessageId */\n\t\t\tdeleteLoadingMessageByMessageId: (store, payload: { messageId: string }) => {\n\t\t\t\tstore.commit('deleteLoadingMessageByMessageId', {\n\t\t\t\t\t...payload,\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\t// eslint-disable-next-line max-lines-per-function\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetChatCollection: (state: MessagesState, payload: {messages: ImModelMessage[]}) => {\n\t\t\t\tLogger.warn('Messages model: setChatCollection mutation', payload);\n\t\t\t\tpayload.messages.forEach((message) => {\n\t\t\t\t\tif (!state.chatCollection[message.chatId])\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.chatCollection[message.chatId] = new Set();\n\t\t\t\t\t}\n\t\t\t\t\tstate.chatCollection[message.chatId].add(message.id);\n\t\t\t\t});\n\t\t\t},\n\t\t\tinitChatCollection: (state: MessagesState, payload: { chatId: number }) => {\n\t\t\t\tif (!state.chatCollection[payload.chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.chatCollection[payload.chatId] = new Set();\n\t\t\t\t}\n\t\t\t},\n\t\t\tstore: (state: MessagesState, payload: {messages: ImModelMessage[]}) => {\n\t\t\t\tLogger.warn('Messages model: store mutation', payload);\n\t\t\t\tpayload.messages.forEach((message) => {\n\t\t\t\t\tstate.collection[message.id] = message;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateWithId: (state: MessagesState, payload: {id: number | string, fields: Object}) => {\n\t\t\t\tLogger.warn('Messages model: updateWithId mutation', payload);\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst currentMessage = { ...state.collection[id] };\n\n\t\t\t\tdelete state.collection[id];\n\t\t\t\tstate.collection[fields.id] = { ...currentMessage, ...fields, sending: false };\n\n\t\t\t\tif (state.chatCollection[currentMessage.chatId].has(id))\n\t\t\t\t{\n\t\t\t\t\tstate.chatCollection[currentMessage.chatId].delete(id);\n\t\t\t\t\tstate.chatCollection[currentMessage.chatId].add(fields.id);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: (state: MessagesState, payload: {id: number | string, fields: Object}) => {\n\t\t\t\tLogger.warn('Messages model: update mutation', payload);\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tstate.collection[id] = { ...state.collection[id], ...fields };\n\t\t\t},\n\t\t\tdelete: (state: MessagesState, payload: {id: number | string}) => {\n\t\t\t\tLogger.warn('Messages model: delete mutation', payload);\n\t\t\t\tconst { id } = payload;\n\t\t\t\tconst { chatId } = state.collection[id];\n\t\t\t\tstate.chatCollection[chatId]?.delete(id);\n\t\t\t\tdelete state.collection[id];\n\t\t\t},\n\t\t\tclearCollection: (state: MessagesState, payload: {chatId: number}) => {\n\t\t\t\tLogger.warn('Messages model: clear collection mutation', payload.chatId);\n\t\t\t\tstate.chatCollection[payload.chatId] = new Set();\n\t\t\t},\n\t\t\treadMessages: (state: MessagesState, payload: {messageIdsToRead: number[], messageIdsToView: number[]}) => {\n\t\t\t\tconst { messageIdsToRead, messageIdsToView } = payload;\n\t\t\t\tmessageIdsToRead.forEach((messageId) => {\n\t\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.unread = false;\n\t\t\t\t});\n\t\t\t\tmessageIdsToView.forEach((messageId) => {\n\t\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.viewed = true;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetViewedByOthers: (state: MessagesState, payload: {ids: number[]}) => {\n\t\t\t\tconst { ids } = payload;\n\t\t\t\tids.forEach((id) => {\n\t\t\t\t\tconst message = state.collection[id];\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst isOwnMessage = message.authorId === Core.getUserId();\n\t\t\t\t\tif (!isOwnMessage || message.viewedByOthers)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessage.viewedByOthers = true;\n\t\t\t\t});\n\t\t\t},\n\t\t\taddLoadingMessage: (\n\t\t\t\tstate: MessagesState,\n\t\t\t\tpayload: {\n\t\t\t\t\tmessage: ImModelMessage,\n\t\t\t\t\tpreviousSiblingId: MessageId,\n\t\t\t\t},\n\t\t\t) => {\n\t\t\t\tconst { message, previousSiblingId } = payload;\n\t\t\t\tstate.loadingMessages[previousSiblingId] = message;\n\t\t\t},\n\t\t\tdeleteLoadingMessageByMessageId: (state: MessagesState, payload: { messageId: MessageId }) => {\n\t\t\t\tconst entries: Array<Array<MessageId, ImModelMessage>> = Object.entries(state.loadingMessages);\n\t\t\t\tconst entry: ?Array<MessageId, ImModelMessage> = entries.find(([, message: ImModelMessage]) => {\n\t\t\t\t\treturn message.id === payload.messageId;\n\t\t\t\t});\n\n\t\t\t\tif (entry)\n\t\t\t\t{\n\t\t\t\t\tconst [previousSiblingId: MessageId] = entry;\n\t\t\t\t\tdelete state.loadingMessages[previousSiblingId];\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdateLoadingMessagePreviousSiblingId: (\n\t\t\t\tstate: MessagesState,\n\t\t\t\tpayload: {\n\t\t\t\t\toldId: MessageId,\n\t\t\t\t\tnewId: MessageId,\n\t\t\t\t},\n\t\t\t) => {\n\t\t\t\tconst { oldId, newId } = payload;\n\t\t\t\tconst loadingMessage: ImModelMessage = state.loadingMessages[oldId];\n\t\t\t\tif (loadingMessage)\n\t\t\t\t{\n\t\t\t\t\tdelete state.loadingMessages[oldId];\n\t\t\t\t\tstate.loadingMessages[newId] = loadingMessage;\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t}\n\n\t#findNextLoadingMessages(message: ImModelMessage, getters: JsonObject): Array<ImModelMessage>\n\t{\n\t\tif (getters.hasLoadingMessageByPreviousSiblingId(message.id))\n\t\t{\n\t\t\tconst loadingMessage: ImModelMessage = getters.getLoadingMessageByPreviousSiblingId(message.id);\n\n\t\t\treturn [\n\t\t\t\tloadingMessage,\n\t\t\t\t...this.#findNextLoadingMessages(loadingMessage, getters),\n\t\t\t];\n\t\t}\n\n\t\treturn [];\n\t}\n\n\t#formatFields(rawFields: JsonObject): JsonObject\n\t{\n\t\tconst messageParams = Type.isPlainObject(rawFields.params) ? rawFields.params : {};\n\t\tconst fields = { ...rawFields, ...messageParams };\n\n\t\tconst formattedFields: ImModelMessage = formatFieldsWithConfig(fields, messageFieldsConfig);\n\t\tif (this.#needToSwapAuthorId(formattedFields, messageParams))\n\t\t{\n\t\t\tformattedFields.authorId = this.#prepareSwapAuthorId(formattedFields, messageParams);\n\t\t}\n\n\t\treturn formattedFields;\n\t}\n\n\t#needToSwapAuthorId(formattedFields: ImModelMessage, messageParams: JsonObject): boolean\n\t{\n\t\tconst { NAME: name, USER_ID: userId } = messageParams;\n\n\t\treturn Boolean(name && userId && formattedFields.authorId);\n\t}\n\n\t#prepareSwapAuthorId(formattedFields: ImModelMessage, messageParams: JsonObject): string\n\t{\n\t\tconst { NAME: authorName, USER_ID: userId, AVATAR: avatar } = messageParams;\n\t\tconst originalAuthorId = formattedFields.authorId;\n\t\tconst fakeAuthorId = convertToNumber(userId);\n\t\tconst userManager = new UserManager();\n\t\tconst networkId = `${UserIdNetworkPrefix}-${originalAuthorId}-${fakeAuthorId}`;\n\t\tvoid userManager.setUsersToModel({\n\t\t\tnetworkId,\n\t\t\tname: authorName,\n\t\t\tavatar: avatar ?? '',\n\t\t});\n\n\t\treturn networkId;\n\t}\n\n\t#getMaxMessageId(messageIds: number[]): number\n\t{\n\t\tlet maxMessageId = 0;\n\t\tmessageIds.forEach((messageId) => {\n\t\t\tif (maxMessageId < messageId)\n\t\t\t{\n\t\t\t\tmaxMessageId = messageId;\n\t\t\t}\n\t\t});\n\n\t\treturn maxMessageId;\n\t}\n\n\t#findLowestMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet firstId = null;\n\t\tconst messages = [...state.chatCollection[chatId]];\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (!firstId)\n\t\t\t{\n\t\t\t\tfirstId = element.id;\n\t\t\t}\n\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.id < firstId)\n\t\t\t{\n\t\t\t\tfirstId = element.id;\n\t\t\t}\n\t\t}\n\n\t\treturn firstId;\n\t}\n\n\t#findMaxMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet lastId = 0;\n\t\tconst messages = [...state.chatCollection[chatId]];\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.id > lastId)\n\t\t\t{\n\t\t\t\tlastId = element.id;\n\t\t\t}\n\t\t}\n\n\t\treturn lastId;\n\t}\n\n\t#findLastOwnMessageId(state: MessagesState, chatId: number): number\n\t{\n\t\tlet lastOwnMessageId = 0;\n\t\tconst messages = [...state.chatCollection[chatId]].sort((a, z) => z - a);\n\t\tfor (const messageId of messages)\n\t\t{\n\t\t\tconst element = state.collection[messageId];\n\t\t\tif (Utils.text.isTempMessage(element.id))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (element.authorId === Core.getUserId())\n\t\t\t{\n\t\t\t\tlastOwnMessageId = element.id;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn lastOwnMessageId;\n\t}\n\n\t#findFirstUnread(state: MessagesState, chatId: number): number\n\t{\n\t\tlet resultId = 0;\n\t\tfor (const messageId of state.chatCollection[chatId])\n\t\t{\n\t\t\tconst message: ImModelMessage = state.collection[messageId];\n\t\t\tif (message.unread)\n\t\t\t{\n\t\t\t\tresultId = messageId;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn resultId;\n\t}\n\n\t#sortCollection(a: ImModelMessage, b: ImModelMessage): number\n\t{\n\t\tif (Utils.text.isUuidV4(a.id) && !Utils.text.isUuidV4(b.id))\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\n\t\tif (!Utils.text.isUuidV4(a.id) && Utils.text.isUuidV4(b.id))\n\t\t{\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (Utils.text.isUuidV4(a.id) && Utils.text.isUuidV4(b.id))\n\t\t{\n\t\t\treturn a.date.getTime() - b.date.getTime();\n\t\t}\n\n\t\treturn a.id - b.id;\n\t}\n\n\t#makeFakePreviousSiblingId(chatId: number): number\n\t{\n\t\treturn `${chatId}/-1`;\n\t}\n}\n","import { Core } from 'im.v2.application.core';\nimport { Utils } from 'im.v2.lib.utils';\nimport { Text, Type, type JsonObject } from 'main.core';\n\nexport const prepareManagerList = (managerList: number[] | string[]): number[] => {\n\tconst result = [];\n\n\tmanagerList.forEach((rawUserId) => {\n\t\tconst userId = Number.parseInt(rawUserId, 10);\n\t\tif (userId > 0)\n\t\t{\n\t\t\tresult.push(userId);\n\t\t}\n\t});\n\n\treturn result;\n};\n\nexport const prepareChatName = (chatName: string | number): string => {\n\treturn Text.decode(chatName.toString());\n};\n\nexport const prepareAvatar = (avatar: string): string => {\n\tlet result = '';\n\n\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t{\n\t\tresult = '';\n\t}\n\telse if (avatar.startsWith('http'))\n\t{\n\t\tresult = avatar;\n\t}\n\telse\n\t{\n\t\tresult = Core.getHost() + avatar;\n\t}\n\n\tif (result)\n\t{\n\t\tresult = encodeURI(result);\n\t}\n\n\treturn result;\n};\n\nexport const prepareMuteList = (muteList: Object[] | Object): Object[] => {\n\tconst result = [];\n\n\tif (Type.isArray(muteList))\n\t{\n\t\tmuteList.forEach((rawUserId) => {\n\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\t\t\tif (userId > 0)\n\t\t\t{\n\t\t\t\tresult.push(userId);\n\t\t\t}\n\t\t});\n\t}\n\telse if (Type.isPlainObject(muteList))\n\t{\n\t\tObject.entries(muteList).forEach(([key, value]) => {\n\t\t\tif (!value)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst userId = Number.parseInt(key, 10);\n\t\t\tif (userId > 0)\n\t\t\t{\n\t\t\t\tresult.push(userId);\n\t\t\t}\n\t\t});\n\t}\n\n\treturn result;\n};\n\ntype LastMessageViews = { countOfViewers: number, firstViewers: Object[], messageId: number };\nexport const prepareLastMessageViews = (rawLastMessageViews: JsonObject): LastMessageViews => {\n\tconst {\n\t\tcountOfViewers,\n\t\tfirstViewers: rawFirstViewers,\n\t\tmessageId,\n\t} = rawLastMessageViews;\n\n\tlet firstViewer = null;\n\tfor (const rawFirstViewer of rawFirstViewers)\n\t{\n\t\tif (rawFirstViewer.userId === Core.getUserId())\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\n\t\tfirstViewer = {\n\t\t\tuserId: rawFirstViewer.userId,\n\t\t\tuserName: rawFirstViewer.userName,\n\t\t\tdate: Utils.date.cast(rawFirstViewer.date),\n\t\t};\n\t\tbreak;\n\t}\n\n\tif (countOfViewers > 0 && !firstViewer)\n\t{\n\t\tthrow new Error('Chats model: no first viewer for message');\n\t}\n\n\treturn {\n\t\tcountOfViewers,\n\t\tfirstViewer,\n\t\tmessageId,\n\t};\n};\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { convertToNumber, convertToString, isNumberOrString } from '../../utils/format';\nimport {\n\tprepareAvatar,\n\tprepareChatName,\n\tprepareLastMessageViews,\n\tprepareManagerList,\n\tprepareMuteList,\n} from './format-functions';\n\nimport type { FieldsConfig } from 'im.v2.model';\n\nexport const chatFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'dialogId',\n\t\ttargetFieldName: 'dialogId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToString,\n\t},\n\t{\n\t\tfieldName: ['id', 'chatId'],\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'type',\n\t\ttargetFieldName: 'type',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'quoteId',\n\t\ttargetFieldName: 'quoteId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'counter',\n\t\ttargetFieldName: 'counter',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'userCounter',\n\t\ttargetFieldName: 'userCounter',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'lastId',\n\t\ttargetFieldName: 'lastReadId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'markedId',\n\t\ttargetFieldName: 'markedId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'lastMessageId',\n\t\ttargetFieldName: 'lastMessageId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'lastMessageViews',\n\t\ttargetFieldName: 'lastMessageViews',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: prepareLastMessageViews,\n\t},\n\t{\n\t\tfieldName: 'hasPrevPage',\n\t\ttargetFieldName: 'hasPrevPage',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'hasNextPage',\n\t\ttargetFieldName: 'hasNextPage',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'savedPositionMessageId',\n\t\ttargetFieldName: 'savedPositionMessageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: ['title', 'name'],\n\t\ttargetFieldName: 'name',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: prepareChatName,\n\t},\n\t{\n\t\tfieldName: ['owner', 'ownerId'],\n\t\ttargetFieldName: 'ownerId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'avatar',\n\t\ttargetFieldName: 'avatar',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: prepareAvatar,\n\t},\n\t{\n\t\tfieldName: 'color',\n\t\ttargetFieldName: 'color',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'extranet',\n\t\ttargetFieldName: 'extranet',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'containsCollaber',\n\t\ttargetFieldName: 'containsCollaber',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'entityLink',\n\t\ttargetFieldName: 'entityLink',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => {\n\t\t\treturn formatFieldsWithConfig(target, chatEntityFieldsConfig);\n\t\t},\n\t},\n\t{\n\t\tfieldName: 'dateCreate',\n\t\ttargetFieldName: 'dateCreate',\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'public',\n\t\ttargetFieldName: 'public',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n\t{\n\t\tfieldName: 'inputActionList',\n\t\ttargetFieldName: 'inputActionList',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n\t{\n\t\tfieldName: 'managerList',\n\t\ttargetFieldName: 'managerList',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: prepareManagerList,\n\t},\n\t{\n\t\tfieldName: 'muteList',\n\t\ttargetFieldName: 'muteList',\n\t\tcheckFunction: [Type.isArray, Type.isPlainObject],\n\t\tformatFunction: prepareMuteList,\n\t},\n\t{\n\t\tfieldName: 'inited',\n\t\ttargetFieldName: 'inited',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'loading',\n\t\ttargetFieldName: 'loading',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'description',\n\t\ttargetFieldName: 'description',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'diskFolderId',\n\t\ttargetFieldName: 'diskFolderId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'role',\n\t\ttargetFieldName: 'role',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: (target: string) => target.toLowerCase(),\n\t},\n\t{\n\t\tfieldName: 'permissions',\n\t\ttargetFieldName: 'permissions',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n\t{\n\t\tfieldName: 'tariffRestrictions',\n\t\ttargetFieldName: 'tariffRestrictions',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n\t{\n\t\tfieldName: 'parentChatId',\n\t\ttargetFieldName: 'parentChatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'backgroundId',\n\t\ttargetFieldName: 'backgroundId',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'textFieldEnabled',\n\t\ttargetFieldName: 'isTextareaEnabled',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n];\n\nexport const chatEntityFieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'type',\n\t\ttargetFieldName: 'type',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'url',\n\t\ttargetFieldName: 'url',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const autoDeleteFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'delay',\n\t\ttargetFieldName: 'delay',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { formatFieldsWithConfig } from 'im.v2.model';\nimport { AutoDeleteDelay } from 'im.v2.const';\n\nimport { autoDeleteFieldsConfig } from './format/fields-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { ActionTree, MutationTree, GetterTree } from 'ui.vue3.vuex';\n\ntype ChatId = number;\ntype Delay = number;\ntype AutoDeleteState = {\n\tcollection: Map<ChatId, Delay>\n};\n\ntype AutoDeletePayload = {\n\tchatId: number,\n\tdelay: number,\n};\n\nexport class AutoDeleteModel extends BuilderModel\n{\n\tgetState(): AutoDeleteState\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function chats/autoDelete/isEnabled */\n\t\t\tisEnabled: (state: AutoDeleteState) => (chatId: ChatId): boolean => {\n\t\t\t\treturn state.collection.has(chatId) ?? false;\n\t\t\t},\n\t\t\t/** @function chats/autoDelete/getDelay */\n\t\t\tgetDelay: (state: AutoDeleteState) => (chatId: ChatId): Delay => {\n\t\t\t\treturn state.collection.get(chatId) ?? AutoDeleteDelay.Off;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function chats/autoDelete/set */\n\t\t\tset: (store, rawPayload: AutoDeletePayload | AutoDeletePayload[]) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.forEach((element: AutoDeletePayload) => {\n\t\t\t\t\tconst formattedElement = this.#formatFields(element);\n\t\t\t\t\tconst { delay } = formattedElement;\n\t\t\t\t\tif (delay === AutoDeleteDelay.Off)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('delete', formattedElement);\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tstore.commit('set', formattedElement);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: AutoDeleteState, payload: { chatId: ChatId, delay: Delay }) => {\n\t\t\t\tconst { chatId, delay } = payload;\n\n\t\t\t\tstate.collection.set(chatId, delay);\n\t\t\t},\n\t\t\tdelete: (state: AutoDeleteState, payload: { chatId: ChatId, delay: Delay }) => {\n\t\t\t\tconst { chatId } = payload;\n\n\t\t\t\tstate.collection.delete(chatId);\n\t\t\t},\n\t\t};\n\t}\n\n\t#formatFields(fields: JsonObject): AutoDeletePayload\n\t{\n\t\treturn formatFieldsWithConfig(fields, autoDeleteFieldsConfig);\n\t}\n}\n","import { formatFieldsWithConfig } from 'im.v2.model';\nimport { Type } from 'main.core';\n\nimport type { FieldsConfig } from 'im.v2.model';\n\nexport const collabFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'collabId',\n\t\ttargetFieldName: 'collabId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'guestCount',\n\t\ttargetFieldName: 'guestCount',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'entities',\n\t\ttargetFieldName: 'entities',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => formatFieldsWithConfig(target, collabEntitiesFieldConfig),\n\t},\n];\n\nconst collabEntitiesFieldConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'tasks',\n\t\ttargetFieldName: 'tasks',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => formatFieldsWithConfig(target, collabEntityFieldConfig),\n\t},\n\t{\n\t\tfieldName: 'files',\n\t\ttargetFieldName: 'files',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => formatFieldsWithConfig(target, collabEntityFieldConfig),\n\t},\n\t{\n\t\tfieldName: 'calendar',\n\t\ttargetFieldName: 'calendar',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => formatFieldsWithConfig(target, collabEntityFieldConfig),\n\t},\n];\n\nconst collabEntityFieldConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'counter',\n\t\ttargetFieldName: 'counter',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'url',\n\t\ttargetFieldName: 'url',\n\t\tcheckFunction: Type.isStringFilled,\n\t},\n];\n","import { BuilderModel } from 'ui.vue3.vuex';\nimport { Type } from 'main.core';\n\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { collabFieldsConfig } from './format/field-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { ActionTree, MutationTree, GetterTree } from 'ui.vue3.vuex';\nimport type { ImModelCollabInfo } from 'im.v2.model';\n\ntype CollabsState = {\n\tcollection: {\n\t\t[chatId: string]: ImModelCollabInfo\n\t},\n};\n\ntype CollabCounterEntity = 'tasks' | 'calendar';\n\nexport class CollabsModel extends BuilderModel\n{\n\tgetState(): CollabsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelCollabInfo\n\t{\n\t\treturn {\n\t\t\tcollabId: 0,\n\t\t\tguestCount: 0,\n\t\t\tentities: {\n\t\t\t\ttasks: {\n\t\t\t\t\tcounter: 0,\n\t\t\t\t\turl: '',\n\t\t\t\t},\n\t\t\t\tfiles: {\n\t\t\t\t\tcounter: 0,\n\t\t\t\t\turl: '',\n\t\t\t\t},\n\t\t\t\tcalendar: {\n\t\t\t\t\tcounter: 0,\n\t\t\t\t\turl: '',\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function chats/collabs/getByChatId */\n\t\t\tgetByChatId: (state: CollabsState) => (chatId: number): ?ImModelCollabInfo => {\n\t\t\t\treturn state.collection[chatId] ?? this.getElementState();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function chats/collabs/set */\n\t\t\tset: (store, payload: { chatId: string, collabInfo: ImModelCollabInfo }) => {\n\t\t\t\tconst { chatId, collabInfo } = payload;\n\t\t\t\tif (!Type.isPlainObject(collabInfo))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tchatId,\n\t\t\t\t\tcollabInfo: this.#formatFields(collabInfo),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/collabs/setCounter */\n\t\t\tsetCounter: (store, payload: { chatId: string, entity: CollabCounterEntity, counter: number }) => {\n\t\t\t\tconst { chatId, entity, counter } = payload;\n\t\t\t\tconst state: CollabsState = store.state;\n\t\t\t\tconst currentRecord = state.collection[chatId];\n\t\t\t\tif (!currentRecord || !currentRecord.entities[entity])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCounter', { chatId, entity, counter });\n\t\t\t},\n\t\t\t/** @function chats/collabs/setGuestCount */\n\t\t\tsetGuestCount: (store, payload: { chatId: string, guestCount: number }) => {\n\t\t\t\tconst { chatId, guestCount } = payload;\n\t\t\t\tconst state: CollabsState = store.state;\n\t\t\t\tconst currentRecord = state.collection[chatId];\n\t\t\t\tif (!currentRecord)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setGuestCount', { chatId, guestCount });\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: CollabsState, payload: { chatId: string, collabInfo: ImModelCollabInfo }) => {\n\t\t\t\tconst { chatId, collabInfo } = payload;\n\n\t\t\t\tstate.collection[chatId] = collabInfo;\n\t\t\t},\n\t\t\tsetCounter: (state: CollabsState, payload: { chatId: string, entity: CollabCounterEntity, counter: number }) => {\n\t\t\t\tconst { chatId, entity, counter } = payload;\n\n\t\t\t\tconst currentRecord = state.collection[chatId];\n\t\t\t\tcurrentRecord.entities[entity].counter = counter;\n\t\t\t},\n\t\t\tsetGuestCount: (state: CollabsState, payload: { chatId: string, guestCount: number }) => {\n\t\t\t\tconst { chatId, guestCount } = payload;\n\n\t\t\t\tconst currentRecord = state.collection[chatId];\n\t\t\t\tcurrentRecord.guestCount = guestCount;\n\t\t\t},\n\t\t};\n\t}\n\n\t#formatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, collabFieldsConfig);\n\t}\n}\n","import { BuilderModel, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport type { InputActionType } from 'im.v2.lib.input-action';\n\nexport type InputActionState = {\n\tcollection: {\n\t\t[dialogId: string]: ChatInputActions,\n\t},\n};\n\nexport type ChatInputActions = InputActionUserRecord[];\n\ntype InputActionUserRecord = {\n\ttype: InputActionType,\n\tuserId: number,\n\tuserName: string,\n\tstatusMessageCode: string | null,\n\tduration: number | null,\n};\n\ntype InputActionPayload = {\n\ttype: InputActionType,\n\tdialogId: string,\n\tuserId: number,\n\tuserName?: string,\n\tstatusMessageCode: string | null,\n\tduration: number | null,\n};\n\n/* eslint-disable no-param-reassign */\nexport class InputActionsModel extends BuilderModel\n{\n\tgetState(): InputActionState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function chats/inputActions/getByDialogId */\n\t\t\tgetByDialogId: (state: InputActionState) => (dialogId: string): ?ChatInputActions => {\n\t\t\t\tconst chatActionList = state.collection[dialogId];\n\t\t\t\tif (!chatActionList || chatActionList.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn chatActionList;\n\t\t\t},\n\t\t\t/** @function chats/inputActions/isChatActive */\n\t\t\tisChatActive: (state: InputActionState) => (dialogId: string): boolean => {\n\t\t\t\tconst chatActionList = state.collection[dialogId];\n\t\t\t\tif (!chatActionList)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn chatActionList.length > 0;\n\t\t\t},\n\t\t\t/** @function chats/inputActions/isActionActive */\n\t\t\tisActionActive: (state: InputActionState) => (payload: InputActionPayload): boolean => {\n\t\t\t\tconst { dialogId, userId } = payload;\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst chatActionList = state.collection[dialogId];\n\n\t\t\t\treturn this.isAlreadyActive(chatActionList, userId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function chats/inputActions/start */\n\t\t\tstart: (store, payload: InputActionPayload) => {\n\t\t\t\tconst { dialogId, userId } = payload;\n\t\t\t\tif (!store.state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\tstore.commit('initCollection', dialogId);\n\t\t\t\t}\n\n\t\t\t\tconst chatActionList = store.state.collection[dialogId];\n\t\t\t\tconst isAlreadyActive = this.isAlreadyActive(chatActionList, userId);\n\t\t\t\tif (isAlreadyActive)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('start', payload);\n\t\t\t},\n\t\t\t/** @function chats/inputActions/stop */\n\t\t\tstop: (store, payload: InputActionPayload) => {\n\t\t\t\tconst { dialogId, userId } = payload;\n\t\t\t\tconst chatActionList = store.state.collection[dialogId];\n\t\t\t\tif (!chatActionList)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst isAlreadyActive = this.isAlreadyActive(chatActionList, userId);\n\t\t\t\tif (!isAlreadyActive)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('stop', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tstart: (state: InputActionState, payload: InputActionPayload) => {\n\t\t\t\tconst { dialogId, type, userId, userName, duration, statusMessageCode } = payload;\n\n\t\t\t\tconst chatActionList = state.collection[dialogId];\n\t\t\t\tchatActionList.push({\n\t\t\t\t\ttype,\n\t\t\t\t\tuserId,\n\t\t\t\t\tuserName,\n\t\t\t\t\tduration,\n\t\t\t\t\tstatusMessageCode,\n\t\t\t\t});\n\t\t\t},\n\t\t\tstop: (state: InputActionState, payload: InputActionPayload) => {\n\t\t\t\tconst { dialogId, userId } = payload;\n\n\t\t\t\tconst chatActionList = state.collection[dialogId];\n\t\t\t\tstate.collection[dialogId] = chatActionList.filter((userRecord) => {\n\t\t\t\t\treturn userRecord.userId !== userId;\n\t\t\t\t});\n\t\t\t},\n\t\t\tinitCollection: (state: InputActionState, dialogId: string) => {\n\t\t\t\tstate.collection[dialogId] = [];\n\t\t\t},\n\t\t};\n\t}\n\n\tisAlreadyActive(list: InputActionUserRecord[], userId: number): boolean\n\t{\n\t\treturn list.some((userRecord) => userRecord.userId === userId);\n\t}\n}\n","import { Type, type JsonObject } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { Color, ChatType, UserRole } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { chatFieldsConfig } from './format/field-config';\nimport { AutoDeleteModel } from './nested-modules/auto-delete/auto-delete';\nimport { CollabsModel } from './nested-modules/collabs/collabs';\nimport { InputActionsModel } from './nested-modules/input-actions';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { Chat as ImModelChat } from '../type/chat';\n\ntype ChatState = {\n\tcollection: {[dialogId: string]: ImModelChat},\n};\n\n/* eslint-disable no-param-reassign */\nexport class ChatsModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'chats';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tcollabs: CollabsModel,\n\t\t\tinputActions: InputActionsModel,\n\t\t\tautoDelete: AutoDeleteModel,\n\t\t};\n\t}\n\n\tgetState(): ChatState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelChat\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tchatId: 0,\n\t\t\ttype: ChatType.chat,\n\t\t\tname: '',\n\t\t\tdescription: '',\n\t\t\tavatar: '',\n\t\t\tcolor: Color.base,\n\t\t\textranet: false,\n\t\t\tcontainsCollaber: false,\n\t\t\tcounter: 0,\n\t\t\tuserCounter: 0,\n\t\t\tlastReadId: 0,\n\t\t\tmarkedId: 0,\n\t\t\tlastMessageId: 0,\n\t\t\tlastMessageViews: {\n\t\t\t\tcountOfViewers: 0,\n\t\t\t\tfirstViewer: null,\n\t\t\t\tmessageId: 0,\n\t\t\t},\n\t\t\tsavedPositionMessageId: 0,\n\t\t\tmanagerList: [],\n\t\t\tinputActionList: {},\n\t\t\tmuteList: [],\n\t\t\tquoteId: 0,\n\t\t\townerId: 0,\n\t\t\tentityLink: {},\n\t\t\tdateCreate: null,\n\t\t\tpublic: {\n\t\t\t\tcode: '',\n\t\t\t\tlink: '',\n\t\t\t},\n\t\t\tinited: false,\n\t\t\tloading: false,\n\t\t\thasPrevPage: false,\n\t\t\thasNextPage: false,\n\t\t\tdiskFolderId: 0,\n\t\t\trole: UserRole.member,\n\t\t\tpermissions: {\n\t\t\t\tmanageUi: UserRole.none,\n\t\t\t\tmanageSettings: UserRole.none,\n\t\t\t\tmanageUsersAdd: UserRole.none,\n\t\t\t\tmanageUsersDelete: UserRole.none,\n\t\t\t\tmanageMessages: UserRole.member,\n\t\t\t},\n\t\t\ttariffRestrictions: {\n\t\t\t\tisHistoryLimitExceeded: false,\n\t\t\t},\n\t\t\tparentChatId: 0,\n\t\t\tbackgroundId: '',\n\t\t\tisTextareaEnabled: true,\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function chats/get */\n\t\t\tget: (state: ChatState) => (dialogId: string, getBlank: boolean = false) => {\n\t\t\t\tif (!state.collection[dialogId] && getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState();\n\t\t\t\t}\n\n\t\t\t\tif (!state.collection[dialogId] && !getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId];\n\t\t\t},\n\t\t\t/** @function chats/getByChatId */\n\t\t\tgetByChatId: (state: ChatState) => (chatId: number | string, getBlank: boolean = false) => {\n\t\t\t\tconst preparedChatId = Number.parseInt(chatId, 10);\n\n\t\t\t\tconst chat = Object.values(state.collection).find((item) => {\n\t\t\t\t\treturn item.chatId === preparedChatId;\n\t\t\t\t});\n\n\t\t\t\tif (!chat && getBlank)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState();\n\t\t\t\t}\n\n\t\t\t\treturn chat;\n\t\t\t},\n\t\t\t/** @function chats/getQuoteId */\n\t\t\tgetQuoteId: (state: ChatState) => (dialogId: string) => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].quoteId;\n\t\t\t},\n\t\t\t/** @function chats/isUser */\n\t\t\tisUser: (state: ChatState) => (dialogId: string) => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].type === ChatType.user;\n\t\t\t},\n\t\t\t/** @function chats/getLastReadId */\n\t\t\tgetLastReadId: (state: ChatState) => (dialogId: string): number => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst { lastReadId } = state.collection[dialogId];\n\t\t\t\tconst lastReadIdMessage = Core.getStore().getters['messages/getById'](lastReadId);\n\t\t\t\tif (!lastReadIdMessage)\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn lastReadId;\n\t\t\t},\n\t\t\t/** @function chats/getInitialMessageId */\n\t\t\tgetInitialMessageId: (state: ChatState) => (dialogId: string): number => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tconst { lastReadId, markedId } = state.collection[dialogId];\n\t\t\t\tif (markedId === 0)\n\t\t\t\t{\n\t\t\t\t\treturn lastReadId;\n\t\t\t\t}\n\n\t\t\t\treturn Math.min(lastReadId, markedId);\n\t\t\t},\n\t\t\t/** @function chats/isSupport */\n\t\t\tisSupport: (state: ChatState) => (dialogId: string): boolean => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].type === ChatType.support24Question;\n\t\t\t},\n\t\t\t/** @function chats/isNotes */\n\t\t\tisNotes: () => (dialogId: string): boolean => {\n\t\t\t\treturn Core.getUserId().toString() === dialogId;\n\t\t\t},\n\t\t\t/** @function chats/getBackgroundId */\n\t\t\tgetBackgroundId: (state: ChatState) => (dialogId: string): string => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].backgroundId;\n\t\t\t},\n\t\t\t/** @function chats/getCollectionByChatType */\n\t\t\tgetCollectionByChatType: (state: ChatState) => (type: $Values<typeof ChatType>): ImModelChat[] => {\n\t\t\t\treturn Object.values(state.collection).filter((item) => {\n\t\t\t\t\treturn item.type === type;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function chats/set */\n\t\t\tset: (store, rawPayload: Array | Object) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map((element) => {\n\t\t\t\t\treturn this.formatFields(element);\n\t\t\t\t}).forEach((element) => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: element,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: { ...this.getElementState(), ...element },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/add */\n\t\t\tadd: (store, rawPayload: Array | Object) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map((element) => {\n\t\t\t\t\treturn this.formatFields(element);\n\t\t\t\t}).forEach((element) => {\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (!existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tdialogId: element.dialogId,\n\t\t\t\t\t\t\tfields: { ...this.getElementState(), ...element },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/update */\n\t\t\tupdate: (store, payload: {dialogId: string, fields: Object}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.formatFields(payload.fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/delete */\n\t\t\tdelete: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { dialogId: payload.dialogId });\n\t\t\t},\n\t\t\t/** @function chats/clearCountersByChatType */\n\t\t\tclearCountersByChatType: (store, payload: { type: $Values<typeof ChatType> }) => {\n\t\t\t\tstore.commit('clearCountersByChatType', payload);\n\t\t\t},\n\t\t\t/** @function chats/clearCounters */\n\t\t\tclearCounters: (store) => {\n\t\t\t\tstore.commit('clearCounters');\n\t\t\t},\n\t\t\t/** @function chats/mute */\n\t\t\tmute: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tif (existingItem.muteList.includes(currentUserId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst muteList = [...existingItem.muteList, currentUserId];\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'mute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.formatFields({ muteList }),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/unmute */\n\t\t\tunmute: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tconst muteList = existingItem.muteList.filter((item) => item !== currentUserId);\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'unmute',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: this.formatFields({ muteList }),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/setLastMessageViews */\n\t\t\tsetLastMessageViews: (store, payload: {\n\t\t\t\tdialogId: string,\n\t\t\t\tfields: {userId: number, userName: string, date: string, messageId: number}\n\t\t\t}) => {\n\t\t\t\tconst { dialogId, fields: { userId, userName, date, messageId } } = payload;\n\t\t\t\tconst existingItem: ImModelChat = store.state.collection[dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst newLastMessageViews = {\n\t\t\t\t\tcountOfViewers: 1,\n\t\t\t\t\tmessageId,\n\t\t\t\t\tfirstViewer: {\n\t\t\t\t\t\tuserId,\n\t\t\t\t\t\tuserName,\n\t\t\t\t\t\tdate: Utils.date.cast(date),\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'setLastMessageViews',\n\t\t\t\t\tdialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: newLastMessageViews,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/clearLastMessageViews */\n\t\t\tclearLastMessageViews: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst { lastMessageViews: defaultLastMessageViews } = this.getElementState();\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'clearLastMessageViews',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: defaultLastMessageViews,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function chats/incrementLastMessageViews */\n\t\t\tincrementLastMessageViews: (store, payload: {dialogId: string}) => {\n\t\t\t\tconst existingItem: ImModelChat = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst newCounter = existingItem.lastMessageViews.countOfViewers + 1;\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'incrementLastMessageViews',\n\t\t\t\t\tdialogId: payload.dialogId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tlastMessageViews: { ...existingItem.lastMessageViews, countOfViewers: newCounter },\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state: ChatState, payload) => {\n\t\t\t\tstate.collection[payload.dialogId] = payload.fields;\n\t\t\t},\n\t\t\tupdate: (state: ChatState, payload) => {\n\t\t\t\tstate.collection[payload.dialogId] = { ...state.collection[payload.dialogId], ...payload.fields };\n\t\t\t},\n\t\t\tdelete: (state: ChatState, payload) => {\n\t\t\t\tdelete state.collection[payload.dialogId];\n\t\t\t},\n\t\t\tclearCountersByChatType: (state: ChatState, payload: { type: $Values<typeof ChatType> }) => {\n\t\t\t\tconst { type } = payload;\n\t\t\t\tconst items = this.store.getters['chats/getCollectionByChatType'](type);\n\n\t\t\t\titems.forEach((item) => {\n\t\t\t\t\tstate.collection[item.dialogId].counter = 0;\n\t\t\t\t\tstate.collection[item.dialogId].markedId = 0;\n\t\t\t\t});\n\t\t\t},\n\t\t\tclearCounters: (state: ChatState) => {\n\t\t\t\tObject.keys(state.collection).forEach((key) => {\n\t\t\t\t\tstate.collection[key].counter = 0;\n\t\t\t\t\tstate.collection[key].markedId = 0;\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(rawFields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(rawFields, chatFieldsConfig);\n\t}\n}\n","import { Core } from 'im.v2.application.core';\nimport { Type } from 'main.core';\n\nexport const prepareAvatar = (avatar: string): string => {\n\tlet result = '';\n\n\tif (!avatar || avatar.endsWith('/js/im/images/blank.gif'))\n\t{\n\t\tresult = '';\n\t}\n\telse if (avatar.startsWith('http'))\n\t{\n\t\tresult = avatar;\n\t}\n\telse\n\t{\n\t\tresult = Core.getHost() + avatar;\n\t}\n\n\tif (result)\n\t{\n\t\tresult = encodeURI(result);\n\t}\n\n\treturn result;\n};\n\nexport const prepareDepartments = (departments: Array<number | string>): number[] => {\n\tconst result = [];\n\tdepartments.forEach((rawDepartmentId) => {\n\t\tconst departmentId = Number.parseInt(rawDepartmentId, 10);\n\t\tif (departmentId > 0)\n\t\t{\n\t\t\tresult.push(departmentId);\n\t\t}\n\t});\n\n\treturn result;\n};\n\nexport const preparePhones = (phones): Object => {\n\tconst result = {};\n\n\tif (Type.isStringFilled(phones.workPhone) || Type.isNumber(phones.workPhone))\n\t{\n\t\tresult.workPhone = phones.workPhone.toString();\n\t}\n\n\tif (Type.isStringFilled(phones.personalMobile) || Type.isNumber(phones.personalMobile))\n\t{\n\t\tresult.personalMobile = phones.personalMobile.toString();\n\t}\n\n\tif (Type.isStringFilled(phones.personalPhone) || Type.isNumber(phones.personalPhone))\n\t{\n\t\tresult.personalPhone = phones.personalPhone.toString();\n\t}\n\n\tif (Type.isStringFilled(phones.innerPhone) || Type.isNumber(phones.innerPhone))\n\t{\n\t\tresult.innerPhone = phones.innerPhone.toString();\n\t}\n\n\treturn result;\n};\n","import { Type, Text } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\nimport {\n\tconvertToNumber,\n\tconvertToDate,\n\tisNumberOrString,\n} from '../../utils/format';\nimport { prepareAvatar, prepareDepartments, preparePhones } from './format-functions';\n\nimport type { FieldsConfig } from '../../utils/validate';\n\nexport const userFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'networkId',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Utils.user.isNetworkUserId,\n\t},\n\t{\n\t\tfieldName: 'firstName',\n\t\ttargetFieldName: 'firstName',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Text.decode,\n\t},\n\t{\n\t\tfieldName: 'lastName',\n\t\ttargetFieldName: 'lastName',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Text.decode,\n\t},\n\t{\n\t\tfieldName: 'name',\n\t\ttargetFieldName: 'name',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Text.decode,\n\t},\n\t{\n\t\tfieldName: 'color',\n\t\ttargetFieldName: 'color',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'avatar',\n\t\ttargetFieldName: 'avatar',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: prepareAvatar,\n\t},\n\t{\n\t\tfieldName: 'workPosition',\n\t\ttargetFieldName: 'workPosition',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Text.decode,\n\t},\n\t{\n\t\tfieldName: 'gender',\n\t\ttargetFieldName: 'gender',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'birthday',\n\t\ttargetFieldName: 'birthday',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'isBirthday',\n\t\ttargetFieldName: 'isBirthday',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'type',\n\t\ttargetFieldName: 'type',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'network',\n\t\ttargetFieldName: 'network',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'connector',\n\t\ttargetFieldName: 'connector',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'externalAuthId',\n\t\ttargetFieldName: 'externalAuthId',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'status',\n\t\ttargetFieldName: 'status',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'idle',\n\t\ttargetFieldName: 'idle',\n\t\tformatFunction: convertToDate,\n\t},\n\t{\n\t\tfieldName: 'lastActivityDate',\n\t\ttargetFieldName: 'lastActivityDate',\n\t\tformatFunction: convertToDate,\n\t},\n\t{\n\t\tfieldName: 'mobileLastDate',\n\t\ttargetFieldName: 'mobileLastDate',\n\t\tformatFunction: convertToDate,\n\t},\n\t{\n\t\tfieldName: 'absent',\n\t\ttargetFieldName: 'absent',\n\t\tformatFunction: convertToDate,\n\t},\n\t{\n\t\tfieldName: 'isAbsent',\n\t\ttargetFieldName: 'isAbsent',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'departments',\n\t\ttargetFieldName: 'departments',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: prepareDepartments,\n\t},\n\t{\n\t\tfieldName: 'phones',\n\t\ttargetFieldName: 'phones',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: preparePhones,\n\t},\n\t{\n\t\tfieldName: 'email',\n\t\ttargetFieldName: 'email',\n\t\tcheckFunction: Type.isStringFilled,\n\t},\n\t{\n\t\tfieldName: 'website',\n\t\ttargetFieldName: 'website',\n\t\tcheckFunction: Type.isStringFilled,\n\t},\n];\n\nexport const botFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'appId',\n\t\ttargetFieldName: 'appId',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'type',\n\t\ttargetFieldName: 'type',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'code',\n\t\ttargetFieldName: 'code',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'isHidden',\n\t\ttargetFieldName: 'isHidden',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'isSupportOpenline',\n\t\ttargetFieldName: 'isHidden',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'isHuman',\n\t\ttargetFieldName: 'isHidden',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'backgroundId',\n\t\ttargetFieldName: 'backgroundId',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'reactionsEnabled',\n\t\ttargetFieldName: 'reactionsEnabled',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n];\n","import { BuilderModel, type GetterTree, type ActionTree, type MutationTree } from 'ui.vue3.vuex';\n\nimport { BotCode, BotType, RawBotType } from 'im.v2.const';\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { botFieldsConfig } from '../format/field-config';\nimport { convertObjectKeysToCamelCase } from '../../utils/format';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelBot } from 'im.v2.model';\n\ntype BotsState = {\n\tcollection: {[dialogId: string]: ImModelBot},\n};\n\ntype BotPayload = {\n\tuserId: string | number,\n\tbotData: ImModelBot,\n};\n\nexport class BotsModel extends BuilderModel\n{\n\tgetState(): BotsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelBot\n\t{\n\t\treturn {\n\t\t\tcode: '',\n\t\t\ttype: BotType.bot,\n\t\t\tappId: '',\n\t\t\tisHidden: false,\n\t\t\tisSupportOpenline: false,\n\t\t\tisHuman: false,\n\t\t\tbackgroundId: '',\n\t\t\treactionsEnabled: false,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function users/bots/getByUserId */\n\t\t\tgetByUserId: (state: BotsState) => (userId: string | number): ?ImModelBot => {\n\t\t\t\treturn state.collection[userId];\n\t\t\t},\n\t\t\t/** @function users/bots/isNetwork */\n\t\t\tisNetwork: (state: BotsState) => (userId: string | number): boolean => {\n\t\t\t\treturn state.collection[userId]?.type === BotType.network;\n\t\t\t},\n\t\t\t/** @function users/bots/isSupport */\n\t\t\tisSupport: (state: BotsState) => (userId: string | number): boolean => {\n\t\t\t\treturn state.collection[userId]?.type === BotType.support24;\n\t\t\t},\n\t\t\t/** @function users/bots/isAiAssistant */\n\t\t\tisAiAssistant: (state: BotsState) => (userId: string | number): boolean => {\n\t\t\t\treturn state.collection[userId]?.code === BotCode.aiAssistant;\n\t\t\t},\n\t\t\t/** @function users/bots/getCopilotBotDialogId */\n\t\t\tgetCopilotBotDialogId: (state: BotsState): ?string => {\n\t\t\t\tfor (const [userId, bot] of Object.entries(state.collection))\n\t\t\t\t{\n\t\t\t\t\tif (bot.code === BotCode.copilot)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn userId;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\t/** @function users/bots/isCopilot */\n\t\t\tisCopilot: (state: BotsState, getters) => (userId: number | string): boolean => {\n\t\t\t\tconst copilotUserId = Number(getters.getCopilotBotDialogId);\n\n\t\t\t\treturn copilotUserId === Number.parseInt(userId, 10);\n\t\t\t},\n\t\t\t/** @function users/bots/getBackgroundId */\n\t\t\tgetBackgroundId: (state: BotsState) => (dialogId: number | string): string => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].backgroundId;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function users/bots/set */\n\t\t\tset: (store, payload: BotPayload) => {\n\t\t\t\tconst { userId, botData } = payload;\n\t\t\t\tif (!botData)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tuserId,\n\t\t\t\t\tbotData: { ...this.getElementState(), ...this.formatFields(botData) },\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: BotsState, payload: BotPayload) => {\n\t\t\t\tconst { userId, botData } = payload;\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[userId] = botData;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): ImModelBot\n\t{\n\t\tconst result: ImModelBot = convertObjectKeysToCamelCase(fields);\n\t\tif (result.type === RawBotType.human)\n\t\t{\n\t\t\tresult.type = BotType.bot;\n\t\t\tresult.isHuman = true;\n\t\t}\n\n\t\tconst TYPES_MAPPED_TO_DEFAULT_BOT = [RawBotType.openline, RawBotType.supervisor];\n\t\tif (TYPES_MAPPED_TO_DEFAULT_BOT.includes(result.type))\n\t\t{\n\t\t\tresult.type = BotType.bot;\n\t\t}\n\n\t\treturn formatFieldsWithConfig(result, botFieldsConfig);\n\t}\n}\n","import { Type, Loc, type JsonObject } from 'main.core';\nimport { BuilderModel, type ActionTree, type GetterTree, type MutationTree } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { Utils } from 'im.v2.lib.utils';\nimport { UserStatusManager } from 'im.v2.lib.user-status';\nimport { Color, UserType } from 'im.v2.const';\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { BotsModel } from './nested-modules/bots';\nimport { userFieldsConfig } from './format/field-config';\n\nimport type { User as ImModelUser } from '../type/user';\n\ntype UsersState = {\n\tcollection: {[userId: string]: ImModelUser},\n\tabsentList: string[],\n\tabsentCheckInterval: number,\n\tisCurrentUserAdmin: boolean,\n};\n\nconst UserPositionByType = {\n\t[UserType.bot]: Loc.getMessage('IM_MODEL_USERS_CHAT_BOT'),\n\t[UserType.collaber]: Loc.getMessage('IM_MODEL_USERS_COLLABER'),\n\tdefault: Loc.getMessage('IM_MODEL_USERS_DEFAULT_NAME'),\n};\n\nexport class UsersModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'users';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tbots: BotsModel,\n\t\t};\n\t}\n\n\tgetState(): UsersState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tabsentList: [],\n\t\t\tabsentCheckInterval: null,\n\t\t\tisCurrentUserAdmin: false,\n\t\t};\n\t}\n\n\tgetElementState(params = {}): ImModelUser\n\t{\n\t\tconst { id = 0 } = params;\n\n\t\treturn {\n\t\t\tid,\n\t\t\tname: '',\n\t\t\tfirstName: '',\n\t\t\tlastName: '',\n\t\t\tavatar: '',\n\t\t\tcolor: Color.base,\n\t\t\tworkPosition: '',\n\t\t\tgender: 'M',\n\t\t\ttype: UserType.user,\n\t\t\tnetwork: false,\n\t\t\tconnector: false,\n\t\t\texternalAuthId: 'default',\n\t\t\tstatus: '',\n\t\t\tidle: false,\n\t\t\tlastActivityDate: false,\n\t\t\tmobileLastDate: false,\n\t\t\tbirthday: false,\n\t\t\tisBirthday: false,\n\t\t\tabsent: false,\n\t\t\tisAbsent: false,\n\t\t\tdepartments: [],\n\t\t\tphones: {\n\t\t\t\tworkPhone: '',\n\t\t\t\tpersonalMobile: '',\n\t\t\t\tpersonalPhone: '',\n\t\t\t\tinnerPhone: '',\n\t\t\t},\n\t\t\temail: '',\n\t\t\twebsite: '',\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function users/get */\n\t\t\tget: (state: UsersState) => (userId, getTemporary = false) => {\n\t\t\t\tconst user = state.collection[userId];\n\n\t\t\t\tif (!getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (getTemporary && !user)\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState({ id: userId });\n\t\t\t\t}\n\n\t\t\t\treturn user;\n\t\t\t},\n\t\t\t/** @function users/getBlank */\n\t\t\tgetBlank: () => (params) => {\n\t\t\t\treturn this.getElementState(params);\n\t\t\t},\n\t\t\t/** @function users/getList */\n\t\t\tgetList: (state: UsersState) => (userList) => {\n\t\t\t\tconst result = [];\n\n\t\t\t\tif (!Array.isArray(userList))\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tuserList.forEach((id) => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(this.getElementState({ id }));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\t/** @function users/hasBirthday */\n\t\t\thasBirthday: (state: UsersState) => (rawUserId) => {\n\t\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isBirthday;\n\t\t\t},\n\t\t\t/** @function users/hasVacation */\n\t\t\thasVacation: (state: UsersState) => (rawUserId) => {\n\t\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn user.isAbsent;\n\t\t\t},\n\t\t\t/** @function users/getLastOnline */\n\t\t\tgetLastOnline: (state: UsersState) => (rawUserId) => {\n\t\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\n\t\t\t\tconst user = state.collection[userId];\n\t\t\t\tif (userId <= 0 || !user)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn Utils.user.getLastDateText(user);\n\t\t\t},\n\t\t\t/** @function users/getPosition */\n\t\t\tgetPosition: (state: UsersState) => (rawUserId) => {\n\t\t\t\tconst userId = Number.parseInt(rawUserId, 10);\n\t\t\t\tconst user: ImModelUser = state.collection[userId];\n\t\t\t\tconst isSupportBot = Core.getStore().getters['users/bots/isSupport'](userId);\n\n\t\t\t\tif (userId <= 0 || !user || isSupportBot)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tif (user.workPosition)\n\t\t\t\t{\n\t\t\t\t\treturn user.workPosition;\n\t\t\t\t}\n\n\t\t\t\treturn UserPositionByType[user.type] ?? UserPositionByType.default;\n\t\t\t},\n\t\t\t/** @function users/isCurrentUserAdmin */\n\t\t\tisCurrentUserAdmin: (state: UsersState) => {\n\t\t\t\treturn state.isCurrentUserAdmin;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function users/set */\n\t\t\tset: (store, rawPayload) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map((user) => {\n\t\t\t\t\treturn this.formatFields(user);\n\t\t\t\t}).forEach((user) => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: user,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: { ...this.getElementState(), ...user },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/add */\n\t\t\tadd: (store, rawPayload) => {\n\t\t\t\tlet payload = rawPayload;\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tpayload.map((user) => {\n\t\t\t\t\treturn this.formatFields(user);\n\t\t\t\t}).forEach((user) => {\n\t\t\t\t\tconst existingUser = store.state.collection[user.id];\n\t\t\t\t\tif (!existingUser)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tfields: { ...this.getElementState(), ...user },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/update */\n\t\t\tupdate: (store, rawPayload) => {\n\t\t\t\tconst payload = rawPayload;\n\t\t\t\tpayload.id = Number.parseInt(payload.id, 10);\n\n\t\t\t\tconst user = store.state.collection[payload.id];\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst fields = { ...payload.fields, id: payload.id };\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: payload.id,\n\t\t\t\t\tfields: this.formatFields(fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tstore.commit('delete', payload.id);\n\t\t\t},\n\t\t\t/** @function users/setStatus */\n\t\t\tsetStatus: (store, payload: {status: string}) => {\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid: Core.getUserId(),\n\t\t\t\t\tfields: this.formatFields(payload),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function users/setCurrentUserAdminStatus */\n\t\t\tsetCurrentUserAdminStatus: (store, isAdmin: boolean) => {\n\t\t\t\tstore.commit('setCurrentUserAdminStatus', isAdmin);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state: UsersState, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[payload.id] = payload.fields;\n\n\t\t\t\tUserStatusManager.getInstance().onUserUpdate(payload.fields);\n\t\t\t},\n\t\t\tupdate: (state: UsersState, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.collection[payload.id] = { ...state.collection[payload.id], ...payload.fields };\n\n\t\t\t\tUserStatusManager.getInstance().onUserUpdate(payload.fields);\n\t\t\t},\n\t\t\tdelete: (state: UsersState, payload) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\t\t\tsetCurrentUserAdminStatus: (state: UsersState, isAdmin: boolean) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tstate.isCurrentUserAdmin = isAdmin;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\tconst preparedFields: ImModelUser = formatFieldsWithConfig(fields, userFieldsConfig);\n\t\tconst isBot = preparedFields.type === UserType.bot;\n\t\tif (isBot)\n\t\t{\n\t\t\tCore.getStore().dispatch('users/bots/set', {\n\t\t\t\tuserId: preparedFields.id,\n\t\t\t\tbotData: fields.botData || fields.bot_data,\n\t\t\t});\n\t\t}\n\n\t\treturn preparedFields;\n\t}\n\n\taddToAbsentList(id)\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (!state.absentList.includes(id))\n\t\t{\n\t\t\tstate.absentList.push(id);\n\t\t}\n\t}\n\n\tstartAbsentCheckInterval()\n\t{\n\t\tconst state = this.store.state.users;\n\t\tif (state.absentCheckInterval)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst TIME_TO_NEXT_DAY = 1000 * 60 * 60 * 24;\n\t\tstate.absentCheckInterval = setTimeout(() => {\n\t\t\tsetInterval(() => {\n\t\t\t\tstate.absentList.forEach((userId) => {\n\t\t\t\t\tconst user = state.collection[userId];\n\t\t\t\t\tif (!user)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst currentTime = Date.now();\n\t\t\t\t\tconst absentEnd = new Date(user.absent).getTime();\n\n\t\t\t\t\tif (absentEnd <= currentTime)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.absentList = state.absentList.filter((element) => {\n\t\t\t\t\t\t\treturn element !== userId;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tuser.isAbsent = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, TIME_TO_NEXT_DAY);\n\t\t}, Utils.date.getTimeToNextMidnight());\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport type { JsonObject } from 'main.core';\n\nexport const prepareIconType = (file: JsonObject): string => {\n\tconst extension = file.extension.toString();\n\n\tif (file.type === 'image')\n\t{\n\t\treturn 'img';\n\t}\n\n\tif (file.type === 'video')\n\t{\n\t\treturn 'mov';\n\t}\n\n\treturn Utils.file.getIconTypeByExtension(extension);\n};\n\nexport const prepareImage = (image: { width: number, height: number }): { width: number, height: number } | boolean => {\n\tlet result = {\n\t\twidth: 0,\n\t\theight: 0,\n\t};\n\n\tif (Type.isString(image.width) || Type.isNumber(image.width))\n\t{\n\t\tresult.width = Number.parseInt(image.width, 10);\n\t}\n\n\tif (Type.isString(image.height) || Type.isNumber(image.height))\n\t{\n\t\tresult.height = Number.parseInt(image.height, 10);\n\t}\n\n\tif (result.width <= 0 || result.height <= 0)\n\t{\n\t\tresult = false;\n\t}\n\n\treturn result;\n};\n\nexport const prepareUrl = (url: string): string => {\n\tif (\n\t\t!url\n\t\t|| url.startsWith('http')\n\t\t|| url.startsWith('bx')\n\t\t|| url.startsWith('file')\n\t\t|| url.startsWith('blob')\n\t)\n\t{\n\t\treturn url;\n\t}\n\n\treturn Core.getHost() + url;\n};\n","import { Type } from 'main.core';\n\nimport { FileStatus } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { prepareImage, prepareIconType, prepareUrl } from './format-functions';\nimport { convertToNumber, convertToString, isNumberOrString } from '../../utils/format';\n\nimport type { FieldsConfig } from 'im.v2.model';\nimport type { JsonObject, JsonValue } from 'main.core';\n\nexport const fileFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: isNumberOrString,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'date',\n\t\ttargetFieldName: 'date',\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'type',\n\t\ttargetFieldName: 'type',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'extension',\n\t\ttargetFieldName: 'icon',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: (target: JsonValue, currentResult: JsonObject, rawFields: JsonObject) => {\n\t\t\treturn prepareIconType(rawFields);\n\t\t},\n\t},\n\t{\n\t\tfieldName: 'name',\n\t\ttargetFieldName: 'name',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToString,\n\t},\n\t{\n\t\tfieldName: 'size',\n\t\ttargetFieldName: 'size',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'image',\n\t\ttargetFieldName: 'image',\n\t\tcheckFunction: [Type.isPlainObject, Type.isBoolean],\n\t\tformatFunction: (target: JsonValue) => {\n\t\t\tif (Type.isBoolean(target))\n\t\t\t{\n\t\t\t\treturn target;\n\t\t\t}\n\n\t\t\treturn prepareImage(target);\n\t\t},\n\t},\n\t{\n\t\tfieldName: 'status',\n\t\ttargetFieldName: 'status',\n\t\tcheckFunction: [Type.isString, (file) => !Type.isUndefined(FileStatus[file.status])],\n\t},\n\t{\n\t\tfieldName: 'progress',\n\t\ttargetFieldName: 'progress',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'isVideoNote',\n\t\ttargetFieldName: 'isVideoNote',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'authorId',\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToNumber,\n\t},\n\t{\n\t\tfieldName: 'authorName',\n\t\ttargetFieldName: 'authorName',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToString,\n\t},\n\t{\n\t\tfieldName: 'urlPreview',\n\t\ttargetFieldName: 'urlPreview',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: prepareUrl,\n\t},\n\t{\n\t\tfieldName: 'urlDownload',\n\t\ttargetFieldName: 'urlDownload',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: prepareUrl,\n\t},\n\t{\n\t\tfieldName: 'urlShow',\n\t\ttargetFieldName: 'urlShow',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: prepareUrl,\n\t},\n\t{\n\t\tfieldName: 'viewerAttrs',\n\t\ttargetFieldName: 'viewerAttrs',\n\t\tcheckFunction: Type.isPlainObject,\n\t},\n\t{\n\t\tfieldName: 'isTranscribable',\n\t\ttargetFieldName: 'isTranscribable',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n];\n","import { BuilderModel } from 'ui.vue3.vuex';\n\nimport { FileStatus } from 'im.v2.const';\nimport { Logger } from 'im.v2.lib.logger';\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { fileFieldsConfig } from './format/field-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelFile, ImModelTranscription } from 'im.v2.model';\n\ntype FilesState = {\n\tcollection: {\n\t\t[fileId: string]: ImModelFile\n\t},\n\ttemporaryFilesMap: Map<number, string>,\n\ttranscriptions: {\n\t\t[fileId: string]: ImModelTranscription,\n\t},\n};\n\nexport class FilesModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'files';\n\t}\n\n\tgetState(): FilesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\ttemporaryFilesMap: new Map(),\n\t\t\ttranscriptions: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelFile\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tname: 'File is deleted',\n\t\t\tdate: new Date(),\n\t\t\ttype: 'file',\n\t\t\textension: '',\n\t\t\ticon: 'empty',\n\t\t\tisTranscribable: false,\n\t\t\tsize: 0,\n\t\t\timage: null,\n\t\t\tstatus: FileStatus.done,\n\t\t\tprogress: 100,\n\t\t\tauthorId: 0,\n\t\t\tauthorName: '',\n\t\t\turlPreview: '',\n\t\t\turlShow: '',\n\t\t\turlDownload: '',\n\t\t\tviewerAttrs: null,\n\t\t\tisVideoNote: false,\n\t\t};\n\t}\n\n\tgetGetters(): JsonObject\n\t{\n\t\treturn {\n\t\t\t/** @function files/get */\n\t\t\tget: (state: FilesState, getters) => (fileId: number, getTemporary = false): ?ImModelFile => {\n\t\t\t\tif (!fileId)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (!getTemporary && !state.collection[fileId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst file: ?ImModelFile = state.collection[fileId];\n\t\t\t\tconst hasMappedTemporaryFile: boolean = getters.hasMappedTemporaryFile({ serverFileId: fileId });\n\t\t\t\tif (file && hasMappedTemporaryFile)\n\t\t\t\t{\n\t\t\t\t\tconst temporaryFile: ImModelFile = getters.getMappedTemporaryFile({ serverFileId: fileId });\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...file,\n\t\t\t\t\t\turlPreview: temporaryFile.urlPreview,\n\t\t\t\t\t\turlShow: temporaryFile.urlShow,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn file;\n\t\t\t},\n\t\t\t/** @function files/isInCollection */\n\t\t\tisInCollection: (state: FilesState) => (payload: {fileId: number | string}): boolean => {\n\t\t\t\tconst { fileId } = payload;\n\n\t\t\t\treturn Boolean(state.collection[fileId]);\n\t\t\t},\n\t\t\t/** @function files/hasMappedTemporaryFile */\n\t\t\thasMappedTemporaryFile: (state: FilesState) => (payload: {serverFileId: number | string}): boolean => {\n\t\t\t\tif (state.temporaryFilesMap.has(payload.serverFileId))\n\t\t\t\t{\n\t\t\t\t\tconst temporaryFileId: string = state.temporaryFilesMap.get(payload.serverFileId);\n\n\t\t\t\t\treturn Object.hasOwn(state.collection, temporaryFileId);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\t/** @function files/getMappedTemporaryFile */\n\t\t\tgetMappedTemporaryFile: (state: FilesState) => (payload: {serverFileId: number}): ?ImModelFile => {\n\t\t\t\tconst { serverFileId } = payload;\n\n\t\t\t\tif (state.temporaryFilesMap.has(serverFileId))\n\t\t\t\t{\n\t\t\t\t\tconst temporaryFileId: string = state.temporaryFilesMap.get(serverFileId);\n\n\t\t\t\t\treturn state.collection[temporaryFileId];\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\t/** @function files/getTranscription */\n\t\t\tgetTranscription: (state: FilesState) => (fileId: number): ?ImModelTranscription => {\n\t\t\t\treturn state.transcriptions[fileId] || null;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): JsonObject\n\t{\n\t\treturn {\n\t\t\t/** @function files/add */\n\t\t\tadd: (store, payload: Object) => {\n\t\t\t\tconst preparedFile = { ...this.getElementState(), ...this.formatFields(payload) };\n\n\t\t\t\tstore.commit('add', { files: [preparedFile] });\n\t\t\t},\n\t\t\t/** @function files/set */\n\t\t\tset: (store, ...payload: Array<JsonObject>) => {\n\t\t\t\tconst files: Array<ImModelFile> = payload.flat().map((file) => {\n\t\t\t\t\treturn { ...this.getElementState(), ...this.formatFields(file) };\n\t\t\t\t});\n\n\t\t\t\tstore.commit('add', { files });\n\t\t\t},\n\t\t\t/** @function files/update */\n\t\t\tupdate: (store, payload) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst existingItem = store.state.collection[id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: this.formatFields(fields),\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\t/** @function files/updateWithId */\n\t\t\tupdateWithId: (store, payload: {id: string | number, fields: Object}) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateWithId', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: this.formatFields(fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function files/delete */\n\t\t\tdelete: (store, payload: {id: string | number}) => {\n\t\t\t\tconst { id } = payload;\n\t\t\t\tif (!store.state.collection[id])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { id });\n\t\t\t},\n\t\t\t/** @function files/setTemporaryFileMapping */\n\t\t\tsetTemporaryFileMapping: (store, payload: {serverFileId: number, temporaryFileId: string}) => {\n\t\t\t\tstore.commit('setTemporaryFileMapping', payload);\n\t\t\t},\n\t\t\t/** @function files/setTranscription */\n\t\t\tsetTranscription: (store, payload: ImModelTranscription) => {\n\t\t\t\tconst { fileId, status, transcriptText, errorCode } = payload;\n\n\t\t\t\tstore.commit('setTranscription', {\n\t\t\t\t\tfileId,\n\t\t\t\t\tstatus,\n\t\t\t\t\ttranscriptText,\n\t\t\t\t\terrorCode,\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\tgetMutations(): JsonObject\n\t{\n\t\treturn {\n\t\t\tadd: (state: FilesState, payload: {files: ImModelFile[]}) => {\n\t\t\t\tpayload.files.forEach((file) => {\n\t\t\t\t\tstate.collection[file.id] = file;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (state: FilesState, payload) => {\n\t\t\t\tObject.entries(payload.fields).forEach(([key, value]) => {\n\t\t\t\t\tstate.collection[payload.id][key] = value;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateWithId: (state: FilesState, payload: {id: number | string, fields: Object}) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst currentFile = { ...state.collection[id] };\n\n\t\t\t\tdelete state.collection[id];\n\t\t\t\tstate.collection[fields.id] = { ...currentFile, ...fields };\n\t\t\t},\n\t\t\tdelete: (state: FilesState, payload: {id: number | string}) => {\n\t\t\t\tLogger.warn('Files model: delete mutation', payload);\n\t\t\t\tconst { id } = payload;\n\t\t\t\tdelete state.collection[id];\n\t\t\t},\n\t\t\tsetTemporaryFileMapping: (state: FilesState, payload: {serverFileId: number, temporaryFileId: string}) => {\n\t\t\t\tstate.temporaryFilesMap.set(payload.serverFileId, payload.temporaryFileId);\n\t\t\t},\n\t\t\tsetTranscription: (state: FilesState, payload: ImModelTranscription) => {\n\t\t\t\tstate.transcriptions[payload.fileId] = {\n\t\t\t\t\tstatus: payload.status,\n\t\t\t\t\ttranscriptText: payload.transcriptText,\n\t\t\t\t\terrorCode: payload.errorCode,\n\t\t\t\t};\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(rawFields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(rawFields, fileFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\n\ntype Draft = {\n\ttext: string,\n};\n\ntype PreparedDraft = {\n\ttext: string,\n\tdate: Date | null,\n};\n\ntype Invitation = Boolean | {\n\toriginatorId: number,\n\tcanResend: boolean,\n};\n\ntype PreparedInvitation = {\n\tisActive: boolean,\n\toriginator: number,\n\tcanResend: boolean,\n};\n\nexport const prepareDraft = (draft: Draft): PreparedDraft => {\n\tif (!draft.text || draft.text === '')\n\t{\n\t\treturn {\n\t\t\ttext: '',\n\t\t\tdate: null,\n\t\t};\n\t}\n\n\treturn {\n\t\ttext: draft.text,\n\t\tdate: new Date(),\n\t};\n};\n\nexport const prepareInvitation = (invited: Invitation): PreparedInvitation => {\n\tif (Type.isPlainObject(invited))\n\t{\n\t\treturn {\n\t\t\tisActive: true,\n\t\t\toriginator: invited.originatorId,\n\t\t\tcanResend: invited.canResend,\n\t\t};\n\t}\n\n\treturn {\n\t\tisActive: false,\n\t\toriginator: 0,\n\t\tcanResend: false,\n\t};\n};\n","import { Utils } from 'im.v2.lib.utils';\nimport { Type } from 'main.core';\n\nimport { convertToString, isNumberOrString } from '../../utils/format';\nimport { prepareDraft, prepareInvitation } from './format-functions';\n\nimport type { FieldsConfig } from '../../utils/validate';\n\nexport const recentFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: ['id', 'dialogId'],\n\t\ttargetFieldName: 'dialogId',\n\t\tcheckFunction: isNumberOrString,\n\t\tformatFunction: convertToString,\n\t},\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: isNumberOrString,\n\t},\n\t{\n\t\tfieldName: 'draft',\n\t\ttargetFieldName: 'draft',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: prepareDraft,\n\t},\n\t{\n\t\tfieldName: 'invited',\n\t\ttargetFieldName: 'invitation',\n\t\tcheckFunction: [Type.isPlainObject, Type.isBoolean],\n\t\tformatFunction: prepareInvitation,\n\t},\n\t{\n\t\tfieldName: 'unread',\n\t\ttargetFieldName: 'unread',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'pinned',\n\t\ttargetFieldName: 'pinned',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'liked',\n\t\ttargetFieldName: 'liked',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: ['defaultUserRecord', 'isFakeElement'],\n\t\ttargetFieldName: 'isFakeElement',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'isBirthdayPlaceholder',\n\t\ttargetFieldName: 'isBirthdayPlaceholder',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: ['dateLastActivity', 'lastActivityDate'],\n\t\ttargetFieldName: 'lastActivityDate',\n\t\tcheckFunction: [Type.isString, Type.isDate],\n\t\tformatFunction: Utils.date.cast,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport { RecentCallStatus } from 'im.v2.const';\n\nimport type { ImModelCallItem } from 'im.v2.model';\n\ntype CallsState = {\n\tcollection: {\n\t\t[dialogId: string]: ImModelCallItem\n\t}\n};\n\nexport class CallsModel extends BuilderModel\n{\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: {}\n\t\t};\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: 0,\n\t\t\tname: '',\n\t\t\tcall: {},\n\t\t\tstate: RecentCallStatus.waiting\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\tget: (state: CallsState): ImModelCallItem[] => {\n\t\t\t\treturn Object.values(state.collection);\n\t\t\t},\n\n\t\t\tgetCallByDialog: (state: CallsState) => (dialogId): ?ImModelCallItem => {\n\t\t\t\treturn state.collection[dialogId];\n\t\t\t},\n\n\t\t\thasActiveCall: (state: CallsState) => (dialogId): boolean => {\n\t\t\t\tif (Type.isUndefined(dialogId))\n\t\t\t\t{\n\t\t\t\t\tconst activeCall = Object.values(state.collection).find((item: ImModelCallItem) => {\n\t\t\t\t\t\treturn item.state === RecentCallStatus.joined;\n\t\t\t\t\t});\n\n\t\t\t\t\treturn Boolean(activeCall);\n\t\t\t\t}\n\n\t\t\t\tconst existingCall = Object.values(state.collection).find((item: ImModelCallItem) => {\n\t\t\t\t\treturn item.dialogId === dialogId;\n\t\t\t\t});\n\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn existingCall.state === RecentCallStatus.joined;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\taddActiveCall: (store, payload: ImModelCallItem) =>\n\t\t\t{\n\t\t\t\tconst existingCall = Object.values(store.state.collection).find((item: ImModelCallItem) => {\n\t\t\t\t\treturn item.dialogId === payload.dialogId || item.call.uuid === payload.call.uuid;\n\t\t\t\t});\n\n\t\t\t\tif (existingCall)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\t\tdialogId: existingCall.dialogId,\n\t\t\t\t\t\tfields: this.validateActiveCall(payload)\n\t\t\t\t\t});\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('addActiveCall', this.prepareActiveCall(payload));\n\t\t\t},\n\t\t\tupdateActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingCall = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateActiveCall', {\n\t\t\t\t\tdialogId: existingCall.dialogId,\n\t\t\t\t\tfields: this.validateActiveCall(payload.fields)\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteActiveCall: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingCall = store.state.collection[payload.dialogId];\n\t\t\t\tif (!existingCall)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('deleteActiveCall', {\n\t\t\t\t\tdialogId: existingCall.dialogId\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\taddActiveCall: (state: CallsState, payload: ImModelCallItem) => {\n\t\t\t\tstate.collection[payload.dialogId] = payload;\n\t\t\t},\n\t\t\tupdateActiveCall: (state: CallsState, payload) => {\n\t\t\t\tstate.collection[payload.dialogId] = {\n\t\t\t\t\t...state.collection[payload.dialogId],\n\t\t\t\t\t...payload.fields\n\t\t\t\t};\n\t\t\t},\n\t\t\tdeleteActiveCall: (state: CallsState, payload) => {\n\t\t\t\tdelete state.collection[payload.dialogId];\n\t\t\t},\n\t\t};\n\t}\n\n\tprepareActiveCall(call)\n\t{\n\t\treturn {...this.getElementState(), ...this.validateActiveCall(call)};\n\t}\n\n\tvalidateActiveCall(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isStringFilled(fields.dialogId) || Type.isNumber(fields.dialogId))\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId;\n\t\t}\n\n\t\tif (Type.isStringFilled(fields.name))\n\t\t{\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.call))\n\t\t{\n\t\t\tresult.call = fields.call;\n\n\t\t\tif (fields.call?.associatedEntity?.avatar === '/bitrix/js/im/images/blank.gif')\n\t\t\t{\n\t\t\t\tresult.call.associatedEntity.avatar = '';\n\t\t\t}\n\t\t}\n\n\t\tif (RecentCallStatus[fields.state])\n\t\t{\n\t\t\tresult.state = fields.state;\n\t\t}\n\n\t\treturn result;\n\t}\n}","import { Type, type JsonObject } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { ChatType, FakeDraftMessagePrefix, Settings } from 'im.v2.const';\nimport { Utils } from 'im.v2.lib.utils';\nimport { ChannelManager } from 'im.v2.lib.channel';\nimport { formatFieldsWithConfig, convertObjectKeysToCamelCase } from 'im.v2.model';\n\nimport { recentFieldsConfig } from './format/field-config';\nimport { CallsModel } from './nested-modules/calls';\n\nimport type { Store, GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { ImModelMessage, ImModelChat } from 'im.v2.model';\n\nimport type { RecentItem as ImModelRecentItem } from '../type/recent-item';\n\ntype RecentStore = Store<RecentState>;\n\ntype RecentState = {\n\tcollection: {[dialogId: string]: ImModelRecentItem},\n\trecentCollection: Set<string>,\n\tunreadCollection: Set<string>,\n\tcopilotCollection: Set<string>,\n\tchannelCollection: Set<string>,\n\tcollabCollection: Set<string>,\n\ttaskCollection: Set<string>,\n};\n\ntype SetDraftPayload = {\n\tid: string | number,\n\ttext: string,\n\taddFakeItems: boolean,\n};\n\nexport class RecentModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'recent';\n\t}\n\n\tgetNestedModules(): { [moduleName: string]: BuilderModel }\n\t{\n\t\treturn {\n\t\t\tcalls: CallsModel,\n\t\t};\n\t}\n\n\tgetState(): RecentState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\trecentCollection: new Set(),\n\t\t\tunreadCollection: new Set(),\n\t\t\tcopilotCollection: new Set(),\n\t\t\tchannelCollection: new Set(),\n\t\t\tcollabCollection: new Set(),\n\t\t\ttaskCollection: new Set(),\n\t\t};\n\t}\n\n\tgetElementState(): ImModelRecentItem\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tmessageId: 0,\n\t\t\tdraft: {\n\t\t\t\ttext: '',\n\t\t\t\tdate: null,\n\t\t\t},\n\t\t\tunread: false,\n\t\t\tpinned: false,\n\t\t\tliked: false,\n\t\t\tinvitation: {\n\t\t\t\tisActive: false,\n\t\t\t\toriginator: 0,\n\t\t\t\tcanResend: false,\n\t\t\t},\n\t\t\tisFakeElement: false,\n\t\t\tisBirthdayPlaceholder: false,\n\t\t\tlastActivityDate: null,\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function recent/getRecentCollection */\n\t\t\tgetRecentCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.recentCollection].filter((dialogId) => {\n\t\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\n\t\t\t\t\treturn Boolean(dialog);\n\t\t\t\t}).map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getUnreadCollection */\n\t\t\tgetUnreadCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.unreadCollection].map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getCopilotCollection */\n\t\t\tgetCopilotCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.copilotCollection].filter((dialogId) => {\n\t\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\n\t\t\t\t\treturn Boolean(dialog);\n\t\t\t\t}).map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getChannelCollection */\n\t\t\tgetChannelCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.channelCollection].filter((dialogId) => {\n\t\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\n\t\t\t\t\treturn Boolean(dialog);\n\t\t\t\t}).map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getCollabCollection */\n\t\t\tgetCollabCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.collabCollection].filter((dialogId) => {\n\t\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\n\t\t\t\t\treturn Boolean(dialog);\n\t\t\t\t}).map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getTaskCollection */\n\t\t\tgetTaskCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\treturn [...state.taskCollection].filter((dialogId) => {\n\t\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\n\t\t\t\t\treturn Boolean(dialog);\n\t\t\t\t}).map((id) => {\n\t\t\t\t\treturn state.collection[id];\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/getSortedCollection */\n\t\t\tgetSortedCollection: (state: RecentState): ImModelRecentItem[] => {\n\t\t\t\tconst recentCollectionAsArray = [...state.recentCollection].map((dialogId) => {\n\t\t\t\t\treturn state.collection[dialogId];\n\t\t\t\t});\n\n\t\t\t\treturn recentCollectionAsArray.sort((a, b) => {\n\t\t\t\t\tconst messageA: ImModelMessage = this.#getMessage(a.messageId);\n\t\t\t\t\tconst messageB: ImModelMessage = this.#getMessage(b.messageId);\n\n\t\t\t\t\treturn messageB.date - messageA.date;\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/get */\n\t\t\tget: (state: RecentState) => (dialogId: string): ImModelRecentItem | null => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId];\n\t\t\t},\n\t\t\t/** @function recent/getMessage */\n\t\t\tgetMessage: (state: RecentState) => (dialogId: string): ImModelMessage | null => {\n\t\t\t\tconst element = state.collection[dialogId];\n\t\t\t\tif (!element)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn this.#getMessage(element.messageId);\n\t\t\t},\n\t\t\t/** @function recent/needsBirthdayPlaceholder */\n\t\t\tneedsBirthdayPlaceholder: (state: RecentState) => (dialogId): boolean => {\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== ChatType.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst hasBirthday = this.store.getters['users/hasBirthday'](dialogId);\n\t\t\t\tif (!hasBirthday)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst isSelfChat = Number.parseInt(dialogId, 10) === Core.getUserId();\n\t\t\t\tif (isSelfChat)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst showBirthday = this.store.getters['application/settings/get'](Settings.recent.showBirthday);\n\t\t\t\tconst hasTodayMessage = this.#hasTodayMessage(currentItem.messageId);\n\n\t\t\t\treturn showBirthday && !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\t\t\t/** @function recent/needsVacationPlaceholder */\n\t\t\tneedsVacationPlaceholder: (state: RecentState) => (dialogId): boolean => {\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst isNotes = Core.getStore().getters['chats/isNotes'](dialogId);\n\t\t\t\tif (isNotes)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst dialog = this.store.getters['chats/get'](dialogId);\n\t\t\t\tif (!dialog || dialog.type !== ChatType.user)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst hasVacation = this.store.getters['users/hasVacation'](dialogId);\n\t\t\t\tif (!hasVacation)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst hasTodayMessage = this.#hasTodayMessage(currentItem.messageId);\n\n\t\t\t\treturn !hasTodayMessage && dialog.counter === 0;\n\t\t\t},\n\t\t\t/** @function recent/getSortDate */\n\t\t\tgetSortDate: (state: RecentState) => (dialogId): Date | null => {\n\t\t\t\tconst currentItem = state.collection[dialogId];\n\t\t\t\tif (!currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst message: ImModelMessage = this.#getMessage(currentItem.messageId);\n\n\t\t\t\tif (Type.isDate(currentItem.draft.date) && currentItem.draft.date > message.date)\n\t\t\t\t{\n\t\t\t\t\treturn currentItem.draft.date;\n\t\t\t\t}\n\n\t\t\t\tconst needsBirthdayPlaceholder = this.store.getters['recent/needsBirthdayPlaceholder'](currentItem.dialogId);\n\t\t\t\tif (needsBirthdayPlaceholder)\n\t\t\t\t{\n\t\t\t\t\treturn Utils.date.getStartOfTheDay();\n\t\t\t\t}\n\n\t\t\t\tconst lastActivity = currentItem.lastActivityDate;\n\t\t\t\tconst needToUseActivityDate = Type.isDate(lastActivity) && lastActivity > message.date;\n\t\t\t\tif (ChannelManager.isChannel(currentItem.dialogId) && needToUseActivityDate)\n\t\t\t\t{\n\t\t\t\t\treturn lastActivity;\n\t\t\t\t}\n\n\t\t\t\treturn message.date;\n\t\t\t},\n\t\t\t/** @function recent/isInRecentCollection */\n\t\t\tisInRecentCollection: (state: RecentState) => (dialogId: string): boolean => {\n\t\t\t\treturn state.recentCollection.has(dialogId);\n\t\t\t},\n\t\t\t/** @function recent/isInCollabCollection */\n\t\t\tisInCollabCollection: (state: RecentState) => (dialogId: string): boolean => {\n\t\t\t\treturn state.collabCollection.has(dialogId);\n\t\t\t},\n\t\t\t/** @function recent/isInTaskCollection */\n\t\t\tisInTaskCollection: (state: RecentState) => (dialogId: string): boolean => {\n\t\t\t\treturn state.taskCollection.has(dialogId);\n\t\t\t},\n\t\t\t/** @function recent/isInCopilotCollection */\n\t\t\tisInCopilotCollection: (state: RecentState) => (dialogId: string): boolean => {\n\t\t\t\treturn state.copilotCollection.has(dialogId);\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\t/* eslint-disable-next-line max-lines-per-function */\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function recent/setRecent */\n\t\t\tsetRecent: async (store: RecentStore, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await Core.getStore().dispatch('recent/store', payload);\n\n\t\t\t\tstore.commit('setRecentCollection', itemIds);\n\n\t\t\t\tthis.#updateUnloadedRecentCounters(payload);\n\t\t\t},\n\t\t\t/** @function recent/setUnread */\n\t\t\tsetUnread: async (store: RecentStore, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await this.store.dispatch('recent/store', payload);\n\t\t\t\tstore.commit('setUnreadCollection', itemIds);\n\t\t\t},\n\t\t\t/** @function recent/setCopilot */\n\t\t\tsetCopilot: async (store: RecentStore, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await this.store.dispatch('recent/store', payload);\n\t\t\t\tstore.commit('setCopilotCollection', itemIds);\n\n\t\t\t\tthis.#updateUnloadedCopilotCounters(payload);\n\t\t\t},\n\t\t\t/** @function recent/setChannel */\n\t\t\tsetChannel: async (store: RecentStore, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await this.store.dispatch('recent/store', payload);\n\t\t\t\tstore.commit('setChannelCollection', itemIds);\n\t\t\t},\n\t\t\t/** @function recent/setCollab */\n\t\t\tsetCollab: async (store: RecentStore, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await this.store.dispatch('recent/store', payload);\n\t\t\t\tstore.commit('setCollabCollection', itemIds);\n\n\t\t\t\tthis.#updateUnloadedCollabCounters(payload);\n\t\t\t},\n\t\t\t/** @function recent/setTask */\n\t\t\tsetTask: async (store: RecentStore, payload: Array | Object) => {\n\t\t\t\tconst itemIds = await this.store.dispatch('recent/store', payload);\n\t\t\t\tstore.commit('setTaskCollection', itemIds);\n\n\t\t\t\tthis.#updateUnloadedTaskCounters(payload);\n\t\t\t},\n\t\t\t/** @function recent/clearChannelCollection */\n\t\t\tclearChannelCollection: (store: RecentStore) => {\n\t\t\t\tstore.commit('clearChannelCollection');\n\t\t\t},\n\t\t\t/** @function recent/clearUnreadCollection */\n\t\t\tclearUnreadCollection: (store: RecentStore) => {\n\t\t\t\tstore.commit('clearUnreadCollection');\n\t\t\t},\n\t\t\t/** @function recent/store */\n\t\t\tstore: (store: RecentStore, payload: Array | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\t\t\t\tpayload.map((element) => {\n\t\t\t\t\treturn this.#formatFields(element);\n\t\t\t\t}).forEach((element) => {\n\t\t\t\t\tconst preparedElement = { ...element };\n\t\t\t\t\tconst existingItem = store.state.collection[element.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({ dialogId: existingItem.dialogId, fields: preparedElement });\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({ ...this.getElementState(), ...preparedElement });\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\n\t\t\t\treturn [...itemsToAdd, ...itemsToUpdate].map((item) => item.dialogId);\n\t\t\t},\n\t\t\t/** @function recent/update */\n\t\t\tupdate: (store: RecentStore, payload: { id: string | number, fields: Object }) => {\n\t\t\t\tconst { id, fields } = payload;\n\t\t\t\tconst existingItem: ImModelRecentItem = store.state.collection[id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: this.#formatFields(fields),\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/unread */\n\t\t\tunread: (store: RecentStore, payload: { id: string | number, action: boolean }) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: { unread: payload.action },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/pin */\n\t\t\tpin: (store: RecentStore, payload: { id: string | number, action: boolean }) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: { pinned: payload.action },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/like */\n\t\t\tlike: (store: RecentStore, payload: { id: string | number, messageId: number, liked: boolean }) => {\n\t\t\t\tconst existingItem: ImModelRecentItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst isLastMessage = existingItem.messageId === Number.parseInt(payload.messageId, 10);\n\t\t\t\tconst isExactMessageLiked = !Type.isUndefined(payload.messageId) && payload.liked === true;\n\t\t\t\tif (isExactMessageLiked && !isLastMessage)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId: existingItem.dialogId,\n\t\t\t\t\tfields: { liked: payload.liked === true },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/setDraft */\n\t\t\tsetDraft: (store: RecentStore, payload: SetDraftPayload) => {\n\t\t\t\tconst { id, text, addFakeItems = true } = payload;\n\t\t\t\tconst isRemovingDraft = !Type.isStringFilled(text);\n\t\t\t\tif (isRemovingDraft && this.#shouldDeleteItemWithDraft(payload))\n\t\t\t\t{\n\t\t\t\t\tvoid Core.getStore().dispatch('recent/hide', { id });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst existingCollectionItem = store.state.recentCollection.has(id);\n\t\t\t\tconst needsFakeItem = !existingCollectionItem && !isRemovingDraft;\n\t\t\t\tif (needsFakeItem && addFakeItems)\n\t\t\t\t{\n\t\t\t\t\tthis.#handleFakeItemWithDraft(payload, store);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = store.state.collection[id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvoid Core.getStore().dispatch('recent/update', {\n\t\t\t\t\tid,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tdraft: { text: text.toString() },\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/hide */\n\t\t\thide: (store: RecentStore, payload: { id: string | number }) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('deleteCollections', existingItem.dialogId);\n\n\t\t\t\tconst canDelete = this.#canDelete(existingItem.dialogId);\n\n\t\t\t\tif (!canDelete)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tid: existingItem.dialogId,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/delete */\n\t\t\tdelete: (store: RecentStore, payload: { id: string | number }) => {\n\t\t\t\tconst existingItem = store.state.collection[payload.id];\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('deleteCollections', existingItem.dialogId);\n\t\t\t\tstore.commit('deleteFromChannelCollection', existingItem.dialogId);\n\n\t\t\t\tconst canDelete = this.#canDelete(existingItem.dialogId);\n\n\t\t\t\tif (!canDelete)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tid: existingItem.dialogId,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function recent/resetTasksUnreadStatus */\n\t\t\tresetTasksUnreadStatus: (store: RecentStore) => {\n\t\t\t\tstore.commit('resetTasksUnreadStatus');\n\t\t\t},\n\t\t\t/** @function recent/resetUnreadStatus */\n\t\t\tresetUnreadStatus: (store: RecentStore) => {\n\t\t\t\tstore.commit('resetUnreadStatus');\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetRecentCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.recentCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetUnreadCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.unreadCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCopilotCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.copilotCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteFromChannelCollection: (state: RecentState, payload: string) => {\n\t\t\t\tstate.channelCollection.delete(payload);\n\t\t\t},\n\t\t\tsetChannelCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.channelCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tclearChannelCollection: (state: RecentState) => {\n\t\t\t\tstate.channelCollection = new Set();\n\t\t\t},\n\t\t\tclearUnreadCollection: (state: RecentState) => {\n\t\t\t\tstate.unreadCollection = new Set();\n\t\t\t},\n\t\t\tsetCollabCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.collabCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetTaskCollection: (state: RecentState, payload: string[]) => {\n\t\t\t\tpayload.forEach((dialogId) => {\n\t\t\t\t\tstate.taskCollection.add(dialogId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tadd: (state: RecentState, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach((item) => {\n\t\t\t\t\tstate.collection[item.dialogId] = item;\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (state: RecentState, payload: Object[] | Object) => {\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\t\t\t\tpayload.forEach(({ dialogId, fields }) => {\n\t\t\t\t\t// if we already got chat - we should not update it with fake user chat\n\t\t\t\t\t// (unless it's an accepted invitation or fake user with real message)\n\t\t\t\t\tconst elementIsInRecent = state.recentCollection.has(dialogId);\n\t\t\t\t\tconst isFakeElement = fields.isFakeElement && Utils.text.isTempMessage(fields.messageId);\n\t\t\t\t\tif (elementIsInRecent && isFakeElement && !fields.invitation)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst currentElement = state.collection[dialogId];\n\t\t\t\t\tstate.collection[dialogId] = { ...currentElement, ...fields };\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (state: RecentState, payload: {id: string}) => {\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t},\n\t\t\tresetTasksUnreadStatus: (state: RecentState) => {\n\t\t\t\t[...state.taskCollection].forEach((key) => {\n\t\t\t\t\tstate.collection[key].unread = false;\n\t\t\t\t});\n\t\t\t},\n\t\t\tresetUnreadStatus: (state: RecentState) => {\n\t\t\t\tObject.keys(state.collection).forEach((key) => {\n\t\t\t\t\tstate.collection[key].unread = false;\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteCollections: (state: RecentState, payload: string) => {\n\t\t\t\tstate.recentCollection.delete(payload);\n\t\t\t\tstate.copilotCollection.delete(payload);\n\t\t\t\tstate.collabCollection.delete(payload);\n\t\t\t\tstate.taskCollection.delete(payload);\n\t\t\t\tstate.unreadCollection.delete(payload);\n\t\t\t},\n\t\t};\n\t}\n\n\t#formatFields(rawFields: JsonObject): Partial<ImModelRecentItem>\n\t{\n\t\tconst options = Type.isPlainObject(rawFields.options) ? rawFields.options : {};\n\t\tconst fields = { ...rawFields, ...options };\n\n\t\treturn formatFieldsWithConfig(fields, recentFieldsConfig);\n\t}\n\n\t#updateUnloadedRecentCounters(payload: Array | Object)\n\t{\n\t\tthis.#updateUnloadedCounters(payload, 'counters/setUnloadedChatCounters');\n\t}\n\n\t#updateUnloadedCopilotCounters(payload: Array | Object)\n\t{\n\t\tthis.#updateUnloadedCounters(payload, 'counters/setUnloadedCopilotCounters');\n\t}\n\n\t#updateUnloadedCollabCounters(payload: Array | Object)\n\t{\n\t\tthis.#updateUnloadedCounters(payload, 'counters/setUnloadedCollabCounters');\n\t}\n\n\t#updateUnloadedTaskCounters(payload: Array | Object)\n\t{\n\t\tthis.#updateUnloadedCounters(payload, 'counters/setUnloadedTaskCounters');\n\t}\n\n\t#updateUnloadedCounters(payload: Array | Object, updateMethod: string)\n\t{\n\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t{\n\t\t\tpayload = [payload];\n\t\t}\n\t\tconst zeroedCountersForNewItems = {};\n\t\tconst preparedItems = payload.map((item) => convertObjectKeysToCamelCase(item));\n\n\t\tpreparedItems.forEach((item) => {\n\t\t\tzeroedCountersForNewItems[item.chatId] = 0;\n\t\t});\n\t\tvoid Core.getStore().dispatch(updateMethod, zeroedCountersForNewItems);\n\t}\n\n\t#getMessage(messageId: number | string): ImModelMessage\n\t{\n\t\treturn Core.getStore().getters['messages/getById'](messageId);\n\t}\n\n\t#getDialog(dialogId: string): ImModelChat\n\t{\n\t\treturn Core.getStore().getters['chats/get'](dialogId);\n\t}\n\n\t#hasTodayMessage(messageId: number | string): boolean\n\t{\n\t\tconst message: ImModelMessage = this.#getMessage(messageId);\n\t\tconst hasMessage = Utils.text.isUuidV4(message.id) || message.id > 0;\n\n\t\treturn hasMessage && Utils.date.isToday(message.date);\n\t}\n\n\t#canDelete(dialogId: string): boolean\n\t{\n\t\tconst NOT_DELETABLE_TYPES = [ChatType.openChannel];\n\t\tconst { type } = this.#getDialog(dialogId);\n\n\t\treturn !NOT_DELETABLE_TYPES.includes(type);\n\t}\n\n\t#handleFakeItemWithDraft(payload: SetDraftPayload, store: RecentStore): void\n\t{\n\t\tconst existingItem = store.state.collection[payload.id];\n\t\tif (!existingItem)\n\t\t{\n\t\t\tstore.commit('add', { ...this.getElementState(), ...this.#prepareFakeItemWithDraft(payload) });\n\t\t}\n\t\tstore.commit('setRecentCollection', [payload.id.toString()]);\n\t}\n\n\t#prepareFakeItemWithDraft(payload: SetDraftPayload): Partial<ImModelRecentItem>\n\t{\n\t\tconst messageId = this.#createFakeMessageForDraft(payload.id);\n\n\t\treturn this.#formatFields({\n\t\t\tdialogId: payload.id.toString(),\n\t\t\tdraft: {\n\t\t\t\ttext: payload.text.toString(),\n\t\t\t},\n\t\t\tmessageId,\n\t\t});\n\t}\n\n\t#createFakeMessageForDraft(dialogId: string): string\n\t{\n\t\tconst messageId = `${FakeDraftMessagePrefix}-${dialogId}`;\n\t\tvoid Core.getStore().dispatch('messages/store', { id: messageId, date: new Date() });\n\n\t\treturn messageId;\n\t}\n\n\t#shouldDeleteItemWithDraft(payload: SetDraftPayload): boolean\n\t{\n\t\tconst existingItem = Core.getStore().state.recent.collection[payload.id];\n\n\t\treturn existingItem\n\t\t\t&& !Type.isStringFilled(payload.text)\n\t\t\t&& existingItem.messageId.toString().startsWith(FakeDraftMessagePrefix)\n\t\t;\n\t}\n}\n","import { BuilderModel } from 'ui.vue3.vuex';\nimport { Type, Text } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\nimport { Utils } from 'im.v2.lib.utils';\nimport { NotificationTypesCodes } from 'im.v2.const';\n\nimport { convertObjectKeysToCamelCase } from '../utils/format';\n\nimport type { ImModelNotification } from '../registry';\n\nexport class NotificationsModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'notifications';\n\t}\n\n\tgetState(): Object\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t\tsearchCollection: new Map(),\n\t\t\tunreadCounter: 0,\n\t\t};\n\t}\n\n\tgetElementState(): Object\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttitle: '',\n\t\t\ttext: '',\n\t\t\tparams: {},\n\t\t\treplaces: [],\n\t\t\tnotifyButtons: [],\n\t\t\tsectionCode: NotificationTypesCodes.simple,\n\t\t\tread: false,\n\t\t\tsettingName: 'im|default',\n\t\t\tmoduleId: '',\n\t\t};\n\t}\n\n\tgetGetters(): Object\n\t{\n\t\treturn {\n\t\t\tgetSortedCollection: state =>\n\t\t\t{\n\t\t\t\treturn [...state.collection.values()].sort(this.sortByType);\n\t\t\t},\n\t\t\tgetSearchResultCollection: state =>\n\t\t\t{\n\t\t\t\treturn [...state.searchCollection.values()].sort(this.sortByType);\n\t\t\t},\n\t\t\tgetConfirmsCount: state =>\n\t\t\t{\n\t\t\t\treturn [...state.collection.values()].filter(notification => {\n\t\t\t\t\treturn notification.sectionCode === NotificationTypesCodes.confirm;\n\t\t\t\t}).length;\n\t\t\t},\n\t\t\tgetById: state => (notificationId) =>\n\t\t\t{\n\t\t\t\tif (Type.isString(notificationId))\n\t\t\t\t{\n\t\t\t\t\tnotificationId = Number.parseInt(notificationId, 10);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = state.collection.get(notificationId);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn existingItem;\n\t\t\t},\n\t\t\tgetSearchItemById: (state) => (notificationId: number | string): ?ImModelNotification => {\n\t\t\t\tif (Type.isString(notificationId))\n\t\t\t\t{\n\t\t\t\t\tconst id = Number.parseInt(notificationId, 10);\n\t\t\t\t\tconst existingItem = state.searchCollection.get(id);\n\n\t\t\t\t\treturn existingItem ?? null;\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = state.searchCollection.get(notificationId);\n\n\t\t\t\treturn existingItem ?? null;\n\t\t\t},\n\t\t\tgetCounter: (state): number =>\n\t\t\t{\n\t\t\t\treturn state.unreadCounter;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions(): Object\n\t{\n\t\treturn {\n\t\t\tinitialSet: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(payload.total_unread_count))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setCounter', payload.total_unread_count);\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isArrayFilled(payload.notifications))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tpayload.notifications.map(element => {\n\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!Array.isArray(payload) && Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\tpayload = [payload];\n\t\t\t\t}\n\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\tpayload.map(element => {\n\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t}).forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetSearchResult: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst itemsToUpdate = [];\n\t\t\t\tconst itemsToAdd = [];\n\n\t\t\t\tlet {notifications} = payload;\n\n\t\t\t\tconst skipValidation = !!payload.skipValidation;\n\t\t\t\tif (!skipValidation)\n\t\t\t\t{\n\t\t\t\t\tconst currentUserId = Core.getUserId();\n\t\t\t\t\tnotifications = notifications.map(element => {\n\t\t\t\t\t\treturn NotificationsModel.validate(element, currentUserId);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tnotifications.forEach(element => {\n\t\t\t\t\tconst existingItem = store.state.searchCollection.get(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToUpdate.push({id: existingItem.id, fields: {...element}});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titemsToAdd.push({...this.getElementState(), ...element});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (itemsToAdd.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('addSearchResult', itemsToAdd);\n\t\t\t\t}\n\t\t\t\tif (itemsToUpdate.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('updateSearchResult', itemsToUpdate);\n\t\t\t\t}\n\t\t\t},\n\t\t\tread: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.ids.forEach(notificationId => {\n\t\t\t\t\tconst existingItem = store.state.collection.get(notificationId);\n\t\t\t\t\tif (!existingItem || existingItem.read === payload.read)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (payload.read)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('decreaseCounter');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('increaseCounter');\n\t\t\t\t\t}\n\n\t\t\t\t\tstore.commit('read', {\n\t\t\t\t\t\tid: existingItem.id,\n\t\t\t\t\t\tread: payload.read,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\treadAllSimple: (store, payload = {}) =>\n\t\t\t{\n\t\t\t\tconst excludeIds = payload.excludeIds || [];\n\t\t\t\tconst excludeIdsSet = new Set(excludeIds);\n\n\t\t\t\tconst idsToMarkAsRead = [];\n\t\t\t\tstore.state.collection.forEach((item) => {\n\t\t\t\t\tif (!item.read && item.sectionCode === NotificationTypesCodes.simple && !excludeIdsSet.has(item.id))\n\t\t\t\t\t{\n\t\t\t\t\t\tidsToMarkAsRead.push(item.id);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (idsToMarkAsRead.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('markAsRead', idsToMarkAsRead);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingItem = store.state.collection.get(payload.id);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (existingItem.read === false)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('decreaseCounter');\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {id: existingItem.id});\n\t\t\t},\n\t\t\tdeleteFromSearch: (store, payload) => {\n\t\t\t\tconst existingItem = store.state.searchCollection.get(payload.id);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { id: existingItem.id });\n\t\t\t},\n\t\t\tclearSearchResult: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearSearchResult');\n\t\t\t},\n\t\t\tsetCounter: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t}\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection.set(item.id, item);\n\t\t\t\t});\n\t\t\t},\n\t\t\taddSearchResult: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.searchCollection.set(item.id, item);\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.collection.set(item.id, {\n\t\t\t\t\t\t...state.collection.get(item.id),\n\t\t\t\t\t\t...item.fields\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateSearchResult: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(item => {\n\t\t\t\t\tstate.searchCollection.set(item.id, {\n\t\t\t\t\t\t...state.searchCollection.get(item.id),\n\t\t\t\t\t\t...item.fields\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection.delete(payload.id);\n\t\t\t\tstate.searchCollection.delete(payload.id);\n\t\t\t},\n\t\t\tread: (state, payload) => {\n\t\t\t\tstate.collection.set(payload.id, {\n\t\t\t\t\t...state.collection.get(payload.id),\n\t\t\t\t\tread: payload.read,\n\t\t\t\t});\n\t\t\t\tstate.searchCollection.set(payload.id, {\n\t\t\t\t\t...state.collection.get(payload.id),\n\t\t\t\t\tread: payload.read,\n\t\t\t\t});\n\t\t\t},\n\t\t\treadAll: (state) =>\n\t\t\t{\n\t\t\t\t[...state.collection.values()].forEach(item => {\n\t\t\t\t\tif (!item.read)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.read = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tmarkAsRead: (state, payload) =>\n\t\t\t{\n\t\t\t\tpayload.forEach((id) => {\n\t\t\t\t\tconst item = state.collection.get(id);\n\t\t\t\t\tif (item)\n\t\t\t\t\t{\n\t\t\t\t\t\titem.read = true;\n\n\t\t\t\t\t\tconst searchItem = state.searchCollection.get(id);\n\t\t\t\t\t\tif (searchItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsearchItem.read = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCounter: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.unreadCounter = Number.parseInt(payload, 10);\n\t\t\t},\n\t\t\tdecreaseCounter: (state) =>\n\t\t\t{\n\t\t\t\tif (state.unreadCounter > 0)\n\t\t\t\t{\n\t\t\t\t\tstate.unreadCounter--;\n\t\t\t\t}\n\t\t\t},\n\t\t\tincreaseCounter: (state) =>\n\t\t\t{\n\t\t\t\tstate.unreadCounter++;\n\t\t\t},\n\t\t\tclearSearchResult: (state) =>\n\t\t\t{\n\t\t\t\tstate.searchCollection.clear();\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic validate(fields: Object)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isString(fields.id) || Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isNumber(fields.author_id))\n\t\t{\n\t\t\tresult.authorId = fields.author_id;\n\t\t}\n\t\telse if (Type.isNumber(fields.userId))\n\t\t{\n\t\t\tresult.authorId = fields.userId;\n\t\t}\n\n\t\tif (!Type.isNil(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tif (Type.isString(fields.notify_title))\n\t\t{\n\t\t\tresult.title = fields.notify_title;\n\t\t}\n\t\telse if (Type.isString(fields.title))\n\t\t{\n\t\t\tresult.title = fields.title;\n\t\t}\n\n\t\tif (Type.isString(fields.text) || Type.isNumber(fields.text))\n\t\t{\n\t\t\tresult.text = Text.decode(fields.text.toString());\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.params))\n\t\t{\n\t\t\tresult.params = convertObjectKeysToCamelCase(fields.params);\n\t\t}\n\n\t\tif (Type.isArray(fields.replaces))\n\t\t{\n\t\t\tresult.replaces = fields.replaces;\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_buttons))\n\t\t{\n\t\t\tresult.notifyButtons = JSON.parse(fields.notify_buttons);\n\t\t}\n\t\telse if (!Type.isNil(fields.buttons))\n\t\t{\n\t\t\tresult.notifyButtons = fields.buttons.map(button => {\n\t\t\t\treturn {\n\t\t\t\t\tCOMMAND: 'notifyConfirm',\n\t\t\t\t\tCOMMAND_PARAMS: `${result.id}|${button.VALUE}`,\n\t\t\t\t\tTEXT: `${button.TITLE}`,\n\t\t\t\t\tTYPE: 'BUTTON',\n\t\t\t\t\tDISPLAY: 'LINE',\n\t\t\t\t\tBG_COLOR: (button.VALUE === 'Y' ? '#8bc84b' : '#ef4b57'),\n\t\t\t\t\tTEXT_COLOR: '#fff',\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tif (fields.notify_type === NotificationTypesCodes.confirm || fields.type === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.confirm;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.simple;\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_read))\n\t\t{\n\t\t\tresult.read = fields.notify_read === 'Y';\n\t\t}\n\t\telse if (!Type.isNil(fields.read))\n\t\t{\n\t\t\tresult.read = fields.read === 'Y';\n\t\t}\n\n\t\tif (Type.isString(fields.setting_name))\n\t\t{\n\t\t\tresult.settingName = fields.setting_name;\n\t\t}\n\t\telse if (Type.isString(fields.settingName))\n\t\t{\n\t\t\tresult.settingName = fields.settingName;\n\t\t}\n\n\t\tif (Type.isString(fields.notify_module))\n\t\t{\n\t\t\tresult.moduleId = fields.notify_module;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsortByType(a, b)\n\t{\n\t\tif (a.sectionCode === NotificationTypesCodes.confirm && b.sectionCode !== NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn -1;\n\t\t}\n\t\telse if (a.sectionCode !== NotificationTypesCodes.confirm && b.sectionCode === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn b.id - a.id;\n\t\t}\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { formatFieldsWithConfig } from '../../../../utils/validate';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const sidebarLinksFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'authorId',\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'url',\n\t\ttargetFieldName: 'source',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => {\n\t\t\treturn target.source ?? '';\n\t\t},\n\t},\n\t{\n\t\tfieldName: 'dateCreate',\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'url',\n\t\ttargetFieldName: 'richData',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => {\n\t\t\treturn formatFieldsWithConfig(target.richData, richDataFieldsConfig);\n\t\t},\n\t},\n];\n\nexport const richDataFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'description',\n\t\ttargetFieldName: 'description',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'link',\n\t\ttargetFieldName: 'link',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'name',\n\t\ttargetFieldName: 'name',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'previewUrl',\n\t\ttargetFieldName: 'previewUrl',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'type',\n\t\ttargetFieldName: 'type',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport { sidebarLinksFieldsConfig } from './format/field-config';\nimport { formatFieldsWithConfig } from '../../../utils/validate';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelSidebarLinkItem } from '../../../registry';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype LinksState = {\n\tcollection: {\n\t\t[chatId: number]: ChatState\n\t},\n\tcounters: {[chatId: number]: number},\n};\n\ntype ChatState = {\n\thasNextPage: boolean,\n\titems: Map<ImModelSidebarLinkItem>,\n}\n\ntype LinksPayload = {\n\tchatId?: number,\n\tlinks?: Object[],\n\thasNextPage?: boolean,\n\tisHistoryLimitExceeded: boolean,\n}\n\n/* eslint-disable no-param-reassign */\nexport class LinksModel extends BuilderModel\n{\n\tgetState(): LinksState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcollectionSearch: {},\n\t\t\tcounters: {},\n\t\t\thistoryLimitExceededCollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarLinkItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tsource: '',\n\t\t\tdate: new Date(),\n\t\t\trichData: {\n\t\t\t\tid: null,\n\t\t\t\tdescription: null,\n\t\t\t\tlink: null,\n\t\t\t\tname: null,\n\t\t\t\tpreviewUrl: null,\n\t\t\t\ttype: null,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetChatState(): ChatState\n\t{\n\t\treturn {\n\t\t\titems: new Map(),\n\t\t\thasNextPage: true,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/links/get */\n\t\t\tget: (state) => (chatId: number): ImModelSidebarLinkItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/links/getSize */\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].items.size;\n\t\t\t},\n\t\t\t/** @function sidebar/links/getCounter */\n\t\t\tgetCounter: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.counters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.counters[chatId];\n\t\t\t},\n\t\t\t/** @function sidebar/links/hasNextPage */\n\t\t\thasNextPage: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/links/hasNextPageSearch */\n\t\t\thasNextPageSearch: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/links/getSearchResultCollectionSize */\n\t\t\tgetSearchResultCollectionSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId].items.size;\n\t\t\t},\n\t\t\t/** @function sidebar/links/getSearchResultCollection */\n\t\t\tgetSearchResultCollection: (state) => (chatId: number): ImModelSidebarLinkItem[] => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collectionSearch[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/links/isHistoryLimitExceeded */\n\t\t\tisHistoryLimitExceeded: (state) => (chatId: number): boolean => {\n\t\t\t\tconst isAvailable = Core.getStore().getters['application/tariffRestrictions/isHistoryAvailable'];\n\t\t\t\tif (isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.historyLimitExceededCollection[chatId] ?? false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/links/setCounter */\n\t\t\tsetCounter: (store, payload) => {\n\t\t\t\tif (!Type.isNumber(payload.counter) || !Type.isNumber(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t},\n\t\t\t/** @function sidebar/links/set */\n\t\t\tset: (store, payload: LinksPayload) => {\n\t\t\t\tconst { chatId, links, hasNextPage, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHasNextPage', { chatId, hasNextPage });\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\n\t\t\t\tlinks.forEach((link) => {\n\t\t\t\t\tconst preparedLink = { ...this.getElementState(), ...this.formatFields(link) };\n\t\t\t\t\tstore.commit('add', { chatId, link: preparedLink });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/links/setSearch */\n\t\t\tsetSearch: (store, payload: LinksPayload) => {\n\t\t\t\tconst { chatId, links, hasNextPage, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHasNextPageSearch', { chatId, hasNextPage });\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\n\t\t\t\tlinks.forEach((link) => {\n\t\t\t\t\tconst preparedLink = { ...this.getElementState(), ...this.formatFields(link) };\n\t\t\t\t\tstore.commit('addSearch', { chatId, link: preparedLink });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/links/clearSearch */\n\t\t\tclearSearch: (store) => {\n\t\t\t\tstore.commit('clearSearch', {});\n\t\t\t},\n\t\t\t/** @function sidebar/links/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId] || !store.state.collection[chatId].items.has(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { chatId, id });\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetHasNextPage: (state, payload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetHasNextPageSearch: (state, payload: LinksPayload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetHistoryLimitExceeded: (state, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded } = payload;\n\t\t\t\tif (state.historyLimitExceededCollection[chatId] && !isHistoryLimitExceeded)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.historyLimitExceededCollection[chatId] = isHistoryLimitExceeded;\n\t\t\t},\n\t\t\tsetCounter: (state, payload) => {\n\t\t\t\tconst { chatId, counter } = payload;\n\t\t\t\tstate.counters[chatId] = counter;\n\t\t\t},\n\t\t\tadd: (state, payload: {chatId: number, link: ImModelSidebarLinkItem}) => {\n\t\t\t\tconst { chatId, link } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].items.set(link.id, link);\n\t\t\t},\n\t\t\taddSearch: (state, payload: {chatId: number, link: ImModelSidebarLinkItem}) => {\n\t\t\t\tconst { chatId, link } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].items.set(link.id, link);\n\t\t\t},\n\t\t\tclearSearch: (state) => {\n\t\t\t\tstate.collectionSearch = {};\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tconst hasCollectionSearch = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (hasCollectionSearch)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId].items.delete(id);\n\t\t\t\t}\n\t\t\t\tstate.collection[chatId].items.delete(id);\n\t\t\t\tstate.counters[chatId]--;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, sidebarLinksFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const sidebarFavoritesFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'authorId',\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'dateCreate',\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n];\n","import type { JsonObject } from 'main.core';\nimport { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport { formatFieldsWithConfig } from '../../../utils/validate';\nimport { sidebarFavoritesFieldsConfig } from './format/field-config';\n\nimport type { ImModelSidebarFavoriteItem } from '../../../registry';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype FavoritesState = {\n\tcollection: {\n\t\t[chatId: number]: ChatState\n\t},\n\tcounters: {[chatId: number]: number},\n};\n\ntype ChatState = {\n\thasNextPage: boolean,\n\titems: Map<ImModelSidebarFavoriteItem>,\n\tlastId: number\n}\n\ntype FavoritesPayload = {\n\tchatId?: number,\n\tfavorites?: Object[],\n\thasNextPage?: boolean,\n\tlastId?: number,\n}\n\n/* eslint-disable no-param-reassign */\nexport class FavoritesModel extends BuilderModel\n{\n\tgetState(): FavoritesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcounters: {},\n\t\t\tcollectionSearch: {},\n\t\t\thistoryLimitExceededCollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarFavoriteItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t};\n\t}\n\n\tgetChatState(): ChatState\n\t{\n\t\treturn {\n\t\t\titems: new Map(),\n\t\t\thasNextPage: true,\n\t\t\tlastId: 0,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/favorites/get */\n\t\t\tget: (state) => (chatId: number): ImModelSidebarFavoriteItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/getSize */\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].items.size;\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/getCounter */\n\t\t\tgetCounter: (state) => (chatId: number): number => {\n\t\t\t\tif (state.counters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn state.counters[chatId];\n\t\t\t\t}\n\n\t\t\t\treturn 0;\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/isFavoriteMessage */\n\t\t\tisFavoriteMessage: (state) => (chatId: number, messageId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst chatFavorites = Object.fromEntries(state.collection[chatId].items);\n\t\t\t\tconst targetMessage = Object.values(chatFavorites).find((element) => element.messageId === messageId);\n\n\t\t\t\treturn Boolean(targetMessage);\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/hasNextPage */\n\t\t\thasNextPage: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/getLastId */\n\t\t\tgetLastId: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/getSearchResultCollectionLastId */\n\t\t\tgetSearchResultCollectionLastId: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/hasNextPageSearch */\n\t\t\thasNextPageSearch: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/getSearchResultCollection */\n\t\t\tgetSearchResultCollection: (state) => (chatId: number): ImModelSidebarFavoriteItem[] => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collectionSearch[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/isHistoryLimitExceeded */\n\t\t\tisHistoryLimitExceeded: (state) => (chatId: number): boolean => {\n\t\t\t\tconst isAvailable = Core.getStore().getters['application/tariffRestrictions/isHistoryAvailable'];\n\t\t\t\tif (isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.historyLimitExceededCollection[chatId] ?? false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/favorites/setCounter */\n\t\t\tsetCounter: (store, payload) => {\n\t\t\t\tif (!Type.isNumber(payload.counter) || !Type.isNumber(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCounter', payload);\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/set */\n\t\t\tset: (store, payload) => {\n\t\t\t\tif (Type.isNumber(payload.favorites))\n\t\t\t\t{\n\t\t\t\t\tpayload.favorites = [payload.favorites];\n\t\t\t\t}\n\t\t\t\tconst { chatId, favorites, hasNextPage, lastId, isHistoryLimitExceeded = false } = payload;\n\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\t\t\t\tstore.commit('setHasNextPage', { chatId, hasNextPage });\n\t\t\t\tstore.commit('setLastId', { chatId, lastId });\n\n\t\t\t\tfavorites.forEach((favorite) => {\n\t\t\t\t\tconst preparedFavoriteMessage = { ...this.getElementState(), ...this.formatFields(favorite) };\n\t\t\t\t\tstore.commit('add', { chatId, favorite: preparedFavoriteMessage });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId] || !store.state.collection[chatId].items.has(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { chatId, id });\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/deleteByMessageId */\n\t\t\tdeleteByMessageId: (store, payload: {chatId: number, messageId: number}) => {\n\t\t\t\tconst { chatId, messageId } = payload;\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst chatCollection = store.state.collection[chatId].items;\n\t\t\t\tlet targetLinkId = null;\n\t\t\t\tfor (const [linkId, linkObject] of chatCollection)\n\t\t\t\t{\n\t\t\t\t\tif (linkObject.messageId === messageId)\n\t\t\t\t\t{\n\t\t\t\t\t\ttargetLinkId = linkId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!targetLinkId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { chatId, id: targetLinkId });\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/setSearch */\n\t\t\tsetSearch: (store, payload: FavoritesPayload) => {\n\t\t\t\tconst { chatId, favorites, hasNextPage, lastId, isHistoryLimitExceeded = false } = payload;\n\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\t\t\t\tstore.commit('setHasNextPageSearch', { chatId, hasNextPage });\n\t\t\t\tstore.commit('setLastIdSearch', { chatId, lastId });\n\n\t\t\t\tfavorites.forEach((favorite) => {\n\t\t\t\t\tconst preparedFavoriteMessage = { ...this.getElementState(), ...this.formatFields(favorite) };\n\t\t\t\t\tstore.commit('addSearch', { chatId, favorite: preparedFavoriteMessage });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/favorites/clearSearch */\n\t\t\tclearSearch: (store) => {\n\t\t\t\tstore.commit('clearSearch', {});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetHasNextPage: (state, payload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetHasNextPageSearch: (state, payload: FavoritesPayload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetCounter: (state, payload) => {\n\t\t\t\tconst { chatId, counter } = payload;\n\t\t\t\tstate.counters[chatId] = counter;\n\t\t\t},\n\t\t\tsetLastId: (state, payload) => {\n\t\t\t\tconst { chatId, lastId } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].lastId = lastId;\n\t\t\t},\n\t\t\tadd: (state, payload: {chatId: number, favorite: ImModelSidebarFavoriteItem}) => {\n\t\t\t\tconst { chatId, favorite } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].items.set(favorite.id, favorite);\n\t\t\t},\n\t\t\taddSearch: (state, payload: {chatId: number, favorite: ImModelSidebarFavoriteItem}) => {\n\t\t\t\tconst { chatId, favorite } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].items.set(favorite.id, favorite);\n\t\t\t},\n\t\t\tclearSearch: (state) => {\n\t\t\t\tstate.collectionSearch = {};\n\t\t\t},\n\t\t\tsetLastIdSearch: (state, payload: FavoritesPayload) => {\n\t\t\t\tconst { chatId, lastId } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].lastId = lastId;\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tconst hasCollectionSearch = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (hasCollectionSearch)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId].items.delete(id);\n\t\t\t\t}\n\t\t\t\tstate.collection[chatId].items.delete(id);\n\t\t\t\tstate.counters[chatId]--;\n\t\t\t},\n\t\t\tsetHistoryLimitExceeded: (state, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded } = payload;\n\t\t\t\tif (state.historyLimitExceededCollection[chatId] && !isHistoryLimitExceeded)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.historyLimitExceededCollection[chatId] = isHistoryLimitExceeded;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, sidebarFavoritesFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport type { JsonObject } from 'main.core';\nimport type { ActionTree, MutationTree, GetterTree } from 'ui.vue3.vuex';\n\ntype MembersState = {\n\tcollection: { [chatId: number]: ChatState }\n};\n\ntype ChatState = {\n\tusers: Set<number>,\n\tinited: boolean,\n\thasNextPage: boolean,\n\tnextCursor: MembersPaginationCursor | null,\n};\n\ntype SetMembersPayload = {\n\tchatId: number,\n\tusers: number[],\n\thasNextPage?: boolean,\n};\n\ntype SetCursorPayload = {\n\tchatId: number,\n\tnextCursor: MembersPaginationCursor,\n};\n\ntype MembersPaginationCursor = JsonObject;\n\n/* eslint-disable no-param-reassign */\nexport class MembersModel extends BuilderModel\n{\n\tgetState(): MembersState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetChatState(): ChatState\n\t{\n\t\treturn {\n\t\t\tusers: new Set(),\n\t\t\thasNextPage: true,\n\t\t\tnextCursor: null,\n\t\t\tinited: false,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/members/get */\n\t\t\tget: (state: MembersState) => (chatId: number): number[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].users];\n\t\t\t},\n\t\t\t/** @function sidebar/members/getSize */\n\t\t\tgetSize: (state: MembersState) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].users.size;\n\t\t\t},\n\t\t\t/** @function sidebar/members/hasNextPage */\n\t\t\thasNextPage: (state: MembersState) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/members/getNextCursor */\n\t\t\tgetNextCursor: (state: MembersState) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].nextCursor;\n\t\t\t},\n\t\t\t/** @function sidebar/members/getInited */\n\t\t\tgetInited: (state: MembersState) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].inited;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/members/set */\n\t\t\tset: (store, payload: SetMembersPayload) => {\n\t\t\t\tconst { chatId, users, hasNextPage, nextCursor } = payload;\n\n\t\t\t\tif (!Type.isNil(hasNextPage))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setHasNextPage', { chatId, hasNextPage });\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setInited', { chatId, inited: true });\n\n\t\t\t\tif (users.length > 0)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('set', { chatId, users });\n\t\t\t\t}\n\t\t\t},\n\t\t\t/** @function sidebar/members/setNextCursor */\n\t\t\tsetNextCursor: (store, payload: SetCursorPayload) => {\n\t\t\t\tstore.commit('setNextCursor', payload);\n\t\t\t},\n\t\t\t/** @function sidebar/members/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst { chatId, userId } = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(userId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { userId, chatId });\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tset: (state: MembersState, payload) => {\n\t\t\t\tconst { chatId, users } = payload;\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tusers.forEach((id: number) => {\n\t\t\t\t\tstate.collection[chatId].users.add(id);\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetHasNextPage: (state: MembersState, payload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetNextCursor: (state: MembersState, payload: { chatId: number, nextCursor: MembersPaginationCursor }) => {\n\t\t\t\tconst { chatId, nextCursor } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].nextCursor = nextCursor;\n\t\t\t},\n\t\t\tsetInited: (state: MembersState, payload) => {\n\t\t\t\tconst { chatId, inited } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].inited = inited;\n\t\t\t},\n\t\t\tdelete: (state: MembersState, payload: {chatId: number, userId: number}) => {\n\t\t\t\tconst { chatId, userId } = payload;\n\t\t\t\tstate.collection[chatId].users.delete(userId);\n\t\t\t},\n\t\t};\n\t}\n}\n","import { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype MessageSearchState = {\n\thistoryLimitExceededCollection: {[chatId: number]: boolean},\n};\n\n/* eslint-disable no-param-reassign */\nexport class MessageSearchModel extends BuilderModel\n{\n\tgetState(): MessageSearchState\n\t{\n\t\treturn {\n\t\t\thistoryLimitExceededCollection: {},\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/messageSearch/isHistoryLimitExceeded */\n\t\t\tisHistoryLimitExceeded: (state) => (chatId: number): boolean => {\n\t\t\t\tconst isAvailable = Core.getStore().getters['application/tariffRestrictions/isHistoryAvailable'];\n\t\t\t\tif (isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.historyLimitExceededCollection[chatId] ?? false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/messageSearch/setHistoryLimitExceeded */\n\t\t\tsetHistoryLimitExceeded: (store, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetHistoryLimitExceeded: (state, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded } = payload;\n\t\t\t\tif (state.historyLimitExceededCollection[chatId] && !isHistoryLimitExceeded)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.historyLimitExceededCollection[chatId] = isHistoryLimitExceeded;\n\t\t\t},\n\t\t};\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { formatFieldsWithConfig } from '../../../../utils/validate';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const sidebarTaskFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'authorId',\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'dateCreate',\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'task',\n\t\ttargetFieldName: 'task',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => {\n\t\t\treturn formatFieldsWithConfig(target, taskFieldsConfig);\n\t\t},\n\t},\n];\n\nexport const taskFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'title',\n\t\ttargetFieldName: 'title',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'creatorId',\n\t\ttargetFieldName: 'creatorId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'responsibleId',\n\t\ttargetFieldName: 'responsibleId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'statusTitle',\n\t\ttargetFieldName: 'statusTitle',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'deadline',\n\t\ttargetFieldName: 'deadline',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'state',\n\t\ttargetFieldName: 'state',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'color',\n\t\ttargetFieldName: 'color',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'source',\n\t\ttargetFieldName: 'source',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport { sidebarTaskFieldsConfig } from './format/field-config';\nimport { formatFieldsWithConfig } from '../../../utils/validate';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelSidebarTaskItem } from '../../../registry';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype TasksState = {\n\tcollection: {\n\t\t[chatId: number]: ChatState\n\t},\n};\n\ntype ChatState = {\n\thasNextPage: boolean,\n\titems: Map<ImModelSidebarTaskItem>,\n\tlastId: number\n}\n\ntype TasksPayload = {\n\tchatId?: number,\n\ttasks?: Object[],\n\thasNextPage?: boolean,\n\tlastId?: number,\n}\n\n/* eslint-disable no-param-reassign */\nexport class TasksModel extends BuilderModel\n{\n\tgetState(): TasksState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcollectionSearch: {},\n\t\t\thistoryLimitExceededCollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarTaskItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttask: {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tcreatorId: 0,\n\t\t\t\tresponsibleId: 0,\n\t\t\t\tstatus: 0,\n\t\t\t\tstatusTitle: '',\n\t\t\t\tdeadline: new Date(),\n\t\t\t\tstate: '',\n\t\t\t\tcolor: '',\n\t\t\t\tsource: '',\n\t\t\t},\n\t\t};\n\t}\n\n\tgetChatState(): ChatState\n\t{\n\t\treturn {\n\t\t\titems: new Map(),\n\t\t\thasNextPage: true,\n\t\t\tlastId: 0,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/tasks/get */\n\t\t\tget: (state) => (chatId: number): ImModelSidebarTaskItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/getSearchResultCollection */\n\t\t\tgetSearchResultCollection: (state) => (chatId: number): ImModelSidebarTaskItem[] => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collectionSearch[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/getSize */\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].items.size;\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/hasNextPage */\n\t\t\thasNextPage: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/getLastId */\n\t\t\tgetLastId: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/getSearchResultCollectionLastId */\n\t\t\tgetSearchResultCollectionLastId: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/isHistoryLimitExceeded */\n\t\t\tisHistoryLimitExceeded: (state) => (chatId: number): boolean => {\n\t\t\t\tconst isAvailable = Core.getStore().getters['application/tariffRestrictions/isHistoryAvailable'];\n\t\t\t\tif (isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.historyLimitExceededCollection[chatId] ?? false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/tasks/set */\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst { chatId, tasks, hasNextPage, lastId, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\n\t\t\t\tif (!Type.isNil(hasNextPage))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setHasNextPage', { chatId, hasNextPage });\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isNil(lastId))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setLastId', { chatId, lastId });\n\t\t\t\t}\n\n\t\t\t\ttasks.forEach((task) => {\n\t\t\t\t\tconst preparedTask = { ...this.getElementState(), ...this.formatFields(task) };\n\t\t\t\t\tstore.commit('add', { chatId, task: preparedTask });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/clearSearch */\n\t\t\tclearSearch: (store) => {\n\t\t\t\tstore.commit('clearSearch', {});\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/setSearch */\n\t\t\tsetSearch: (store, payload: TasksPayload) => {\n\t\t\t\tconst { chatId, tasks, hasNextPage, lastId, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\t\t\t\tif (!Type.isNil(hasNextPage))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setHasNextPageSearch', { chatId, hasNextPage });\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isNil(lastId))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setLastIdSearch', { chatId, lastId });\n\t\t\t\t}\n\n\t\t\t\ttasks.forEach((task) => {\n\t\t\t\t\tconst preparedTask = { ...this.getElementState(), ...this.formatFields(task) };\n\t\t\t\t\tstore.commit('addSearch', { chatId, task: preparedTask });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/tasks/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { id, chatId });\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, task: ImModelSidebarTaskItem}) => {\n\t\t\t\tconst { chatId, task } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].items.set(task.id, task);\n\t\t\t},\n\t\t\taddSearch: (state, payload: {chatId: number, task: ImModelSidebarTaskItem}) => {\n\t\t\t\tconst { chatId, task } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].items.set(task.id, task);\n\t\t\t},\n\t\t\tdelete: (state, payload: {id: number, chatId: number}) => {\n\t\t\t\tconst { id, chatId } = payload;\n\t\t\t\tconst hasCollectionSearch = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (hasCollectionSearch)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId].items.delete(id);\n\t\t\t\t}\n\t\t\t\tstate.collection[chatId].items.delete(id);\n\t\t\t},\n\t\t\tsetHasNextPage: (state, payload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetHasNextPageSearch: (state, payload: TasksPayload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetLastId: (state, payload) => {\n\t\t\t\tconst { chatId, lastId } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].lastId = lastId;\n\t\t\t},\n\t\t\tsetLastIdSearch: (state, payload: TasksPayload) => {\n\t\t\t\tconst { chatId, lastId } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].lastId = lastId;\n\t\t\t},\n\t\t\tclearSearch: (state) => {\n\t\t\t\tstate.collectionSearch = {};\n\t\t\t},\n\t\t\tsetHistoryLimitExceeded: (state, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded } = payload;\n\t\t\t\tif (state.historyLimitExceededCollection[chatId] && !isHistoryLimitExceeded)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.historyLimitExceededCollection[chatId] = isHistoryLimitExceeded;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, sidebarTaskFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport { formatFieldsWithConfig } from '../../../../utils/validate';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const sidebarMeetingFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'authorId',\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'dateCreate',\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'calendar',\n\t\ttargetFieldName: 'meeting',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => {\n\t\t\treturn formatFieldsWithConfig(target, meetingFieldsConfig);\n\t\t},\n\t},\n];\n\nexport const meetingFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'title',\n\t\ttargetFieldName: 'title',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'dateFrom',\n\t\ttargetFieldName: 'dateFrom',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'dateTo',\n\t\ttargetFieldName: 'dateTo',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: 'source',\n\t\ttargetFieldName: 'source',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport { formatFieldsWithConfig } from '../../../utils/validate';\nimport { sidebarMeetingFieldsConfig } from './format/field-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelSidebarMeetingItem } from '../../../registry';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype MeetingsState = {\n\tcollection: {\n\t\t[chatId: number]: ChatState\n\t},\n};\n\ntype ChatState = {\n\thasNextPage: boolean,\n\titems: Map<ImModelSidebarMeetingItem>,\n\tlastId: number\n}\n\ntype MeetingsPayload = {\n\tchatId?: number,\n\tmeetings?: Object[],\n\thasNextPage?: boolean,\n\tlastId?: number,\n}\n\n/* eslint-disable no-param-reassign */\nexport class MeetingsModel extends BuilderModel\n{\n\tgetState(): MeetingsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcollectionSearch: {},\n\t\t\thistoryLimitExceededCollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarMeetingItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\tmeeting: {\n\t\t\t\tid: 0,\n\t\t\t\ttitle: '',\n\t\t\t\tdateFrom: new Date(),\n\t\t\t\tdateTo: new Date(),\n\t\t\t\tsource: '',\n\t\t\t},\n\t\t};\n\t}\n\n\tgetChatState(): ChatState\n\t{\n\t\treturn {\n\t\t\titems: new Map(),\n\t\t\thasNextPage: true,\n\t\t\tlastId: 0,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/meetings/get */\n\t\t\tget: (state) => (chatId: number): ImModelSidebarMeetingItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/getSearchResultCollection */\n\t\t\tgetSearchResultCollection: (state) => (chatId: number): ImModelSidebarMeetingItem[] => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collectionSearch[chatId].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/getSize */\n\t\t\tgetSize: (state) => (chatId: number): number => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].items.size;\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/hasNextPage */\n\t\t\thasNextPage: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/getLastId */\n\t\t\tgetLastId: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/getSearchResultCollectionLastId */\n\t\t\tgetSearchResultCollectionLastId: (state) => (chatId: number): boolean => {\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/isHistoryLimitExceeded */\n\t\t\tisHistoryLimitExceeded: (state) => (chatId: number): boolean => {\n\t\t\t\tconst isAvailable = Core.getStore().getters['application/tariffRestrictions/isHistoryAvailable'];\n\t\t\t\tif (isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.historyLimitExceededCollection[chatId] ?? false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/meetings/set */\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst { chatId, meetings, hasNextPage, lastId, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\t\t\t\tif (!Type.isNil(hasNextPage))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setHasNextPage', { chatId, hasNextPage });\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isNil(lastId))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setLastId', { chatId, lastId });\n\t\t\t\t}\n\n\t\t\t\tmeetings.forEach((meeting) => {\n\t\t\t\t\tconst preparedMeeting = { ...this.getElementState(), ...this.formatFields(meeting) };\n\t\t\t\t\tstore.commit('add', { chatId, meeting: preparedMeeting });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/setSearch */\n\t\t\tsetSearch: (store, payload: MeetingsPayload) => {\n\t\t\t\tconst { chatId, meetings, hasNextPage, lastId, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\t\t\t\tif (!Type.isNil(hasNextPage))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setHasNextPageSearch', { chatId, hasNextPage });\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isNil(lastId))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setLastIdSearch', { chatId, lastId });\n\t\t\t\t}\n\n\t\t\t\tmeetings.forEach((meeting) => {\n\t\t\t\t\tconst preparedMeeting = { ...this.getElementState(), ...this.formatFields(meeting) };\n\t\t\t\t\tstore.commit('addSearch', { chatId, meeting: preparedMeeting });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tif (!Type.isNumber(chatId) || !Type.isNumber(id))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { id, chatId });\n\t\t\t},\n\t\t\t/** @function sidebar/meetings/clearSearch */\n\t\t\tclearSearch: (store) => {\n\t\t\t\tstore.commit('clearSearch', {});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, meeting: ImModelSidebarMeetingItem}) => {\n\t\t\t\tconst { chatId, meeting } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].items.set(meeting.id, meeting);\n\t\t\t},\n\t\t\taddSearch: (state, payload: {chatId: number, meeting: ImModelSidebarMeetingItem}) => {\n\t\t\t\tconst { chatId, meeting } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].items.set(meeting.id, meeting);\n\t\t\t},\n\t\t\tdelete: (state, payload: {id: number, chatId: number}) => {\n\t\t\t\tconst { id, chatId } = payload;\n\t\t\t\tconst hasCollectionSearch = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (hasCollectionSearch)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId].items.delete(id);\n\t\t\t\t}\n\t\t\t\tstate.collection[chatId].items.delete(id);\n\t\t\t},\n\t\t\tsetHasNextPage: (state, payload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetHasNextPageSearch: (state, payload: MeetingsPayload) => {\n\t\t\t\tconst { chatId, hasNextPage } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetLastId: (state, payload) => {\n\t\t\t\tconst { chatId, lastId } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId].lastId = lastId;\n\t\t\t},\n\t\t\tsetLastIdSearch: (state, payload: MeetingsPayload) => {\n\t\t\t\tconst { chatId, lastId } = payload;\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId].lastId = lastId;\n\t\t\t},\n\t\t\tclearSearch: (state) => {\n\t\t\t\tstate.collectionSearch = {};\n\t\t\t},\n\t\t\tsetHistoryLimitExceeded: (state, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded } = payload;\n\t\t\t\tif (state.historyLimitExceededCollection[chatId] && !isHistoryLimitExceeded)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.historyLimitExceededCollection[chatId] = isHistoryLimitExceeded;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, sidebarMeetingFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const sidebarFilesFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'authorId',\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: ['dateCreate', 'date'],\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n\t{\n\t\tfieldName: ['fileId', 'id'],\n\t\ttargetFieldName: 'fileId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { SidebarFileGroups } from 'im.v2.const';\n\nimport { formatFieldsWithConfig } from '../../../utils/validate';\nimport { sidebarFilesFieldsConfig } from './format/field-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelSidebarFileItem } from '../../../registry';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype FilesState = {\n\tcollection: {\n\t\t[chatId: number]: {\n\t\t\t[string]: ChatState\n\t\t}\n\t},\n};\n\ntype ChatState = {\n\titems: Map<number, ImModelSidebarFileItem>,\n\thasNextPage: boolean,\n\tlastId: number,\n};\n\ntype FilesPayload = {\n\tchatId?: number,\n\tfiles?: Object[],\n\tgroup?: string,\n\thasNextPage?: boolean,\n}\n\n/* eslint-disable no-param-reassign */\nexport class FilesModel extends BuilderModel\n{\n\tgetState(): FilesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t\tcollectionSearch: {},\n\t\t\thistoryLimitExceededCollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarFileItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tmessageId: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\tfileId: 0,\n\t\t};\n\t}\n\n\tgetChatState(): ChatState\n\t{\n\t\treturn {\n\t\t\titems: new Map(),\n\t\t\thasNextPage: true,\n\t\t\tlastId: 0,\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/files/get */\n\t\t\tget: (state) => (chatId: number, group: string): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][group])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collection[chatId][group].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/files/getSearchResultCollection */\n\t\t\tgetSearchResultCollection: (state) => (chatId: number, group: string): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collectionSearch[chatId] || !state.collectionSearch[chatId][group])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn [...state.collectionSearch[chatId][group].items.values()].sort((a, b) => b.id - a.id);\n\t\t\t},\n\t\t\t/** @function sidebar/files/getLatest */\n\t\t\tgetLatest: (state, getters, rootState, rootGetters) => (chatId: number): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tlet media = [];\n\t\t\t\tlet audio = [];\n\t\t\t\tlet files = [];\n\t\t\t\tlet briefs = [];\n\n\t\t\t\tif (state.collection[chatId][SidebarFileGroups.media])\n\t\t\t\t{\n\t\t\t\t\tmedia = [...state.collection[chatId][SidebarFileGroups.media].items.values()];\n\t\t\t\t}\n\n\t\t\t\tif (state.collection[chatId][SidebarFileGroups.audio])\n\t\t\t\t{\n\t\t\t\t\taudio = [...state.collection[chatId][SidebarFileGroups.audio].items.values()];\n\t\t\t\t}\n\n\t\t\t\tif (state.collection[chatId][SidebarFileGroups.file])\n\t\t\t\t{\n\t\t\t\t\tfiles = [...state.collection[chatId][SidebarFileGroups.file].items.values()];\n\t\t\t\t}\n\n\t\t\t\tif (state.collection[chatId][SidebarFileGroups.brief])\n\t\t\t\t{\n\t\t\t\t\tbriefs = [...state.collection[chatId][SidebarFileGroups.brief].items.values()];\n\t\t\t\t}\n\n\t\t\t\tconst sortedFlatCollection = [media, audio, files, briefs]\n\t\t\t\t\t.flat()\n\t\t\t\t\t.sort((a, b) => b.id - a.id)\n\t\t\t\t;\n\n\t\t\t\treturn this.getTopThreeCompletedFiles(sortedFlatCollection, rootGetters);\n\t\t\t},\n\t\t\t/** @function sidebar/files/getLatestUnsorted */\n\t\t\tgetLatestUnsorted: (state, getters, rootState, rootGetters) => (chatId: number): ImModelSidebarFileItem[] => {\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\tlet unsorted = [];\n\n\t\t\t\tif (state.collection[chatId][SidebarFileGroups.fileUnsorted])\n\t\t\t\t{\n\t\t\t\t\tunsorted = [...state.collection[chatId][SidebarFileGroups.fileUnsorted].items.values()];\n\t\t\t\t}\n\n\t\t\t\tconst sortedCollection = unsorted.sort((a, b) => b.id - a.id);\n\n\t\t\t\treturn this.getTopThreeCompletedFiles(sortedCollection, rootGetters);\n\t\t\t},\n\t\t\t/** @function sidebar/files/getSize */\n\t\t\tgetSize: (state) => (chatId: number, group: string): number => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][group])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId][group].items.size;\n\t\t\t},\n\t\t\t/** @function sidebar/files/hasNextPage */\n\t\t\thasNextPage: (state) => (chatId: number, group: string): boolean => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][group])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId][group].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/files/hasNextPageSearch */\n\t\t\thasNextPageSearch: (state) => (chatId: number, group: string): boolean => {\n\t\t\t\tif (!state.collectionSearch[chatId] || !state.collectionSearch[chatId][group])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId][group].hasNextPage;\n\t\t\t},\n\t\t\t/** @function sidebar/files/getLastId */\n\t\t\tgetLastId: (state) => (chatId: number, group: string): boolean => {\n\t\t\t\tif (!state.collection[chatId] || !state.collection[chatId][group])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId][group].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/files/getSearchResultCollectionLastId */\n\t\t\tgetSearchResultCollectionLastId: (state) => (chatId: number, group: string): boolean => {\n\t\t\t\tif (!state.collectionSearch[chatId] || !state.collectionSearch[chatId][group])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collectionSearch[chatId][group].lastId;\n\t\t\t},\n\t\t\t/** @function sidebar/files/isHistoryLimitExceeded */\n\t\t\tisHistoryLimitExceeded: (state) => (chatId: number): boolean => {\n\t\t\t\tconst isAvailable = Core.getStore().getters['application/tariffRestrictions/isHistoryAvailable'];\n\t\t\t\tif (isAvailable)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.historyLimitExceededCollection[chatId] ?? false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/files/set */\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst { chatId, files, group } = payload;\n\t\t\t\tif (!Type.isArrayFilled(files) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfiles.forEach((file) => {\n\t\t\t\t\tconst preparedFile = { ...this.getElementState(), ...this.formatFields(file) };\n\t\t\t\t\tstore.commit('add', { chatId, group, file: preparedFile });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/files/setSearch */\n\t\t\tsetSearch: (store, payload: FilesPayload) => {\n\t\t\t\tconst { chatId, files, group } = payload;\n\t\t\t\tif (!Type.isArrayFilled(files) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfiles.forEach((file) => {\n\t\t\t\t\tconst preparedFile = { ...this.getElementState(), ...this.formatFields(file) };\n\t\t\t\t\tstore.commit('addSearch', { chatId, group, file: preparedFile });\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/files/delete */\n\t\t\tdelete: (store, payload) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tif (!Type.isNumber(id) || !Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', { chatId, id });\n\t\t\t},\n\t\t\t/** @function sidebar/files/setHasNextPage */\n\t\t\tsetHasNextPage: (store, payload) => {\n\t\t\t\tconst { chatId, group, hasNextPage } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHasNextPage', { chatId, group, hasNextPage });\n\t\t\t},\n\t\t\t/** @function sidebar/files/setHasNextPageSearch */\n\t\t\tsetHasNextPageSearch: (store, payload: FilesPayload) => {\n\t\t\t\tconst { chatId, group, hasNextPage } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setHasNextPageSearch', { chatId, group, hasNextPage });\n\t\t\t},\n\t\t\t/** @function sidebar/files/setLastId */\n\t\t\tsetLastId: (store, payload) => {\n\t\t\t\tconst { chatId, group, lastId } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setLastId', { chatId, group, lastId });\n\t\t\t},\n\t\t\t/** @function sidebar/files/setLastIdSearch */\n\t\t\tsetLastIdSearch: (store, payload) => {\n\t\t\t\tconst { chatId, group, lastId } = payload;\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!store.state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setLastIdSearch', { chatId, group, lastId });\n\t\t\t},\n\t\t\t/** @function sidebar/files/clearSearch */\n\t\t\tclearSearch: (store) => {\n\t\t\t\tstore.commit('clearSearch', {});\n\t\t\t},\n\t\t\t/** @function sidebar/files/setHistoryLimitExceeded */\n\t\t\tsetHistoryLimitExceeded: (store, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded = false } = payload;\n\t\t\t\tstore.commit('setHistoryLimitExceeded', { chatId, isHistoryLimitExceeded });\n\t\t\t},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {chatId: number, group: string, file: ImModelSidebarFileItem}) => {\n\t\t\t\tconst { chatId, file, group } = payload;\n\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tif (!state.collection[chatId][group])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId][group] = this.getChatState();\n\t\t\t\t}\n\t\t\t\tstate.collection[chatId][group].items.set(file.id, file);\n\t\t\t},\n\t\t\taddSearch: (state, payload: {chatId: number, group: string, file: ImModelSidebarFileItem}) => {\n\t\t\t\tconst { chatId, file, group } = payload;\n\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tif (!state.collectionSearch[chatId][group])\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId][group] = this.getChatState();\n\t\t\t\t}\n\t\t\t\tstate.collectionSearch[chatId][group].items.set(file.id, file);\n\t\t\t},\n\t\t\tdelete: (state, payload: {chatId: number, id: number}) => {\n\t\t\t\tconst { chatId, id } = payload;\n\t\t\t\tconst hasCollectionSearch = !Type.isNil(state.collectionSearch[chatId]);\n\t\t\t\tObject.values(SidebarFileGroups).forEach((group) => {\n\t\t\t\t\tif (state.collection[chatId][group] && state.collection[chatId][group].items.has(id))\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[chatId][group].items.delete(id);\n\t\t\t\t\t\tif (hasCollectionSearch)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.collectionSearch[chatId][group].items.delete(id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetHasNextPage: (state, payload) => {\n\t\t\t\tconst { chatId, group, hasNextPage } = payload;\n\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId][group]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId][group] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId][group].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetHasNextPageSearch: (state, payload) => {\n\t\t\t\tconst { chatId, group, hasNextPage } = payload;\n\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId][group]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId][group] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId][group].hasNextPage = hasNextPage;\n\t\t\t},\n\t\t\tsetLastId: (state, payload) => {\n\t\t\t\tconst { chatId, group, lastId } = payload;\n\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collection[chatId][group]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[chatId][group] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId][group].lastId = lastId;\n\t\t\t},\n\t\t\tsetLastIdSearch: (state, payload) => {\n\t\t\t\tconst { chatId, group, lastId } = payload;\n\n\t\t\t\tif (!state.collectionSearch[chatId])\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId] = {};\n\t\t\t\t}\n\n\t\t\t\tconst hasCollection = !Type.isNil(state.collectionSearch[chatId][group]);\n\t\t\t\tif (!hasCollection)\n\t\t\t\t{\n\t\t\t\t\tstate.collectionSearch[chatId][group] = this.getChatState();\n\t\t\t\t}\n\n\t\t\t\tstate.collectionSearch[chatId][group].lastId = lastId;\n\t\t\t},\n\t\t\tclearSearch: (state) => {\n\t\t\t\tstate.collectionSearch = {};\n\t\t\t},\n\t\t\tsetHistoryLimitExceeded: (state, payload) => {\n\t\t\t\tconst { chatId, isHistoryLimitExceeded } = payload;\n\t\t\t\tif (state.historyLimitExceededCollection[chatId] && !isHistoryLimitExceeded)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.historyLimitExceededCollection[chatId] = isHistoryLimitExceeded;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, sidebarFilesFieldsConfig);\n\t}\n\n\tgetTopThreeCompletedFiles(collection: ImModelSidebarFileItem[], rootGetters): ImModelSidebarFileItem[]\n\t{\n\t\treturn collection.filter((sidebarFile: ImModelSidebarFileItem) => {\n\t\t\tconst file = rootGetters['files/get'](sidebarFile.fileId, true);\n\n\t\t\treturn file.progress === 100;\n\t\t}).slice(0, 3);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { Utils } from 'im.v2.lib.utils';\n\nimport type { FieldsConfig } from '../../../../utils/validate';\n\nexport const sidebarMultidialogFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'dialogId',\n\t\ttargetFieldName: 'dialogId',\n\t\tcheckFunction: Type.String,\n\t},\n\t{\n\t\tfieldName: 'chatId',\n\t\ttargetFieldName: 'chatId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'openSessionsLimit',\n\t\ttargetFieldName: 'openSessionsLimit',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'status',\n\t\ttargetFieldName: 'status',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'dateMessage',\n\t\ttargetFieldName: 'date',\n\t\tcheckFunction: Type.isString,\n\t\tformatFunction: Utils.date.cast,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { MultidialogStatus } from 'im.v2.const';\nimport { Core } from 'im.v2.application.core';\n\nimport { formatFieldsWithConfig } from '../../../utils/validate';\nimport { sidebarMultidialogFieldsConfig } from './format/field-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { ImModelSidebarMultidialogItem } from '../../../registry';\n\ntype MultidialogModelState = {\n\tisInited: boolean,\n\tisInitedDetail: boolean,\n\tchatsCount: number,\n\tunreadChats: Set<number>,\n\topenSessionsLimit: number,\n\tmultidialogs: Record<string, ImModelSidebarMultidialogItem>\n}\ntype StatusType = $Values<typeof MultidialogStatus>\n\n/* eslint-disable no-param-reassign */\nexport class MultidialogModel extends BuilderModel\n{\n\tgetState(): MultidialogModelState\n\t{\n\t\treturn {\n\t\t\tisInited: false,\n\t\t\tisInitedDetail: false,\n\t\t\tchatsCount: 0,\n\t\t\tunreadChats: new Set(),\n\t\t\topenSessionsLimit: 0,\n\t\t\tmultidialogs: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelSidebarMultidialogItem\n\t{\n\t\treturn {\n\t\t\tdialogId: '',\n\t\t\tchatId: 0,\n\t\t\tstatus: '',\n\t\t\tdate: new Date(),\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/multidialog/isInited */\n\t\t\tisInited: ({ isInited }): boolean => {\n\t\t\t\treturn isInited;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/isInitedDetail */\n\t\t\tisInitedDetail: ({ isInitedDetail }): boolean => {\n\t\t\t\treturn isInitedDetail;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/getOpenSessionsLimit */\n\t\t\tgetOpenSessionsLimit: ({ openSessionsLimit }): number => {\n\t\t\t\treturn openSessionsLimit;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/getChatsCount */\n\t\t\tgetChatsCount: ({ chatsCount }): number => {\n\t\t\t\treturn chatsCount;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/getTotalChatCounter */\n\t\t\tgetTotalChatCounter: ({ unreadChats }): number => {\n\t\t\t\tlet count = 0;\n\t\t\t\tunreadChats.forEach((chatId: number) => {\n\t\t\t\t\tcount += Core.getStore().getters['counters/getChatCounterByChatId'](chatId);\n\t\t\t\t});\n\n\t\t\t\treturn count;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/get */\n\t\t\tget: ({ multidialogs }) => (chatId): ImModelSidebarMultidialogItem => {\n\t\t\t\treturn multidialogs[chatId];\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/isSupport */\n\t\t\tisSupport: () => (dialogId): boolean => {\n\t\t\t\tconst isSupportBot = Core.getStore().getters['users/bots/isSupport'](dialogId);\n\t\t\t\tconst isSupportChat = Core.getStore().getters['chats/isSupport'](dialogId);\n\n\t\t\t\treturn isSupportChat || isSupportBot;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/hasNextPage */\n\t\t\thasNextPage: ({ chatsCount, multidialogs }): boolean => {\n\t\t\t\treturn chatsCount > Object.keys(multidialogs).length;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/getNumberMultidialogs */\n\t\t\tgetNumberMultidialogs: ({ multidialogs }): number => {\n\t\t\t\treturn Object.keys(multidialogs).length;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/getMultidialogsByStatus */\n\t\t\tgetMultidialogsByStatus: ({ multidialogs }) => (status: StatusType[]): ImModelSidebarMultidialogItem[] => {\n\t\t\t\treturn Object.values(multidialogs)\n\t\t\t\t\t.filter((multidialog: ImModelSidebarMultidialogItem) => status.includes(multidialog.status));\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/multidialog/setInited */\n\t\t\tsetInited: (store, isInited: boolean) => {\n\t\t\t\tstore.commit('setInited', isInited);\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/setInitedDetail */\n\t\t\tsetInitedDetail: (store, isInitedDetail: boolean) => {\n\t\t\t\tstore.commit('setInitedDetail', isInitedDetail);\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/addMultidialogs */\n\t\t\taddMultidialogs: (store, multidialogs: ImModelSidebarMultidialogItem[]) => {\n\t\t\t\tif (!Type.isArray(multidialogs))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tmultidialogs.forEach((multidialog) => {\n\t\t\t\t\tconst preparedTicket = { ...this.getElementState(), ...this.formatFields(multidialog) };\n\t\t\t\t\tstore.commit('addMultidialog', preparedTicket);\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/setOpenSessionsLimit */\n\t\t\tsetOpenSessionsLimit: (store, openSessionsLimit: number) => {\n\t\t\t\tif (Type.isNumber(openSessionsLimit))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setOpenSessionsLimit', openSessionsLimit);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/setChatsCount */\n\t\t\tsetChatsCount: (store, chatsCount: number) => {\n\t\t\t\tif (Type.isNumber(chatsCount))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setChatsCount', chatsCount);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/setUnreadChats */\n\t\t\tsetUnreadChats: (store, unreadChats: number[]) => {\n\t\t\t\tif (Type.isArray(unreadChats))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setUnreadChats', unreadChats);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/set */\n\t\t\tset: (store, payload) => {\n\t\t\t\tconst { unreadChats, multidialogs, chatsCount, openSessionsLimit } = payload;\n\n\t\t\t\tstore.dispatch('setUnreadChats', unreadChats);\n\t\t\t\tstore.dispatch('setChatsCount', chatsCount);\n\t\t\t\tstore.dispatch('setOpenSessionsLimit', openSessionsLimit);\n\t\t\t\tstore.dispatch('addMultidialogs', multidialogs);\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/deleteUnreadChats */\n\t\t\tdeleteUnreadChats: (store, chatId: number) => {\n\t\t\t\tstore.commit('deleteUnreadChats', chatId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/multidialog/setInited */\n\t\t\tsetInited: (state, isInited) => {\n\t\t\t\tstate.isInited = isInited;\n\t\t\t},\n\t\t\t/** @function sidebar/multidialog/setInitedDetail */\n\t\t\tsetInitedDetail: (state, isInitedDetail) => {\n\t\t\t\tstate.isInitedDetail = isInitedDetail;\n\t\t\t},\n\t\t\taddMultidialog: (state, multidialog: ImModelSidebarMultidialogItem) => {\n\t\t\t\tstate.multidialogs[multidialog.chatId] = multidialog;\n\t\t\t},\n\t\t\tsetChatsCount: (state, chatsCount) => {\n\t\t\t\tstate.chatsCount = chatsCount;\n\t\t\t},\n\t\t\tsetOpenSessionsLimit: (state, openSessionsLimit) => {\n\t\t\t\tstate.openSessionsLimit = openSessionsLimit;\n\t\t\t},\n\t\t\tsetUnreadChats: (state, unreadChats) => {\n\t\t\t\tunreadChats.forEach((chatId) => {\n\t\t\t\t\tstate.unreadChats.add(chatId);\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteUnreadChats: ({ unreadChats }, chatId) => {\n\t\t\t\tunreadChats.delete(chatId);\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, sidebarMultidialogFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport { LinksModel } from './nested-modules/links/links';\nimport { FavoritesModel } from './nested-modules/favorites/favorites';\nimport { MembersModel } from './nested-modules/members';\nimport { MessageSearchModel } from './nested-modules/message-search/message-search';\nimport { TasksModel } from './nested-modules/tasks/tasks';\nimport { MeetingsModel } from './nested-modules/meeting/meeting';\nimport { FilesModel } from './nested-modules/files/files';\nimport { MultidialogModel } from './nested-modules/multidialog/multidialog';\n\nimport type { GetterTree, ActionTree, MutationTree, NestedModuleTree } from 'ui.vue3.vuex';\n\ntype SidebarState = {\n\tinitedList: Set<number>,\n\tisFilesMigrated: boolean,\n\tisLinksMigrated: boolean,\n};\n\n/* eslint-disable no-param-reassign */\nexport class SidebarModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'sidebar';\n\t}\n\n\tgetNestedModules(): NestedModuleTree\n\t{\n\t\treturn {\n\t\t\tmembers: MembersModel,\n\t\t\tlinks: LinksModel,\n\t\t\tfavorites: FavoritesModel,\n\t\t\ttasks: TasksModel,\n\t\t\tmeetings: MeetingsModel,\n\t\t\tfiles: FilesModel,\n\t\t\tmultidialog: MultidialogModel,\n\t\t\tmessageSearch: MessageSearchModel,\n\t\t};\n\t}\n\n\tgetState(): SidebarState\n\t{\n\t\treturn {\n\t\t\tinitedList: new Set(),\n\t\t\tisFilesMigrated: false,\n\t\t\tisLinksMigrated: false,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/isInited */\n\t\t\tisInited: (state: SidebarState) => (chatId: number): boolean => {\n\t\t\t\treturn state.initedList.has(chatId);\n\t\t\t},\n\t\t\t/** @function sidebar/hasHistoryLimit */\n\t\t\thasHistoryLimit: () => (chatId: number): boolean => {\n\t\t\t\tconst limitsByPanel = [\n\t\t\t\t\t'sidebar/links/isHistoryLimitExceeded',\n\t\t\t\t\t'sidebar/files/isHistoryLimitExceeded',\n\t\t\t\t\t'sidebar/favorites/isHistoryLimitExceeded',\n\t\t\t\t\t'sidebar/meetings/isHistoryLimitExceeded',\n\t\t\t\t\t'sidebar/tasks/isHistoryLimitExceeded',\n\t\t\t\t\t'sidebar/messageSearch/isHistoryLimitExceeded',\n\t\t\t\t].map((getterName) => Core.getStore().getters[getterName](chatId));\n\n\t\t\t\treturn limitsByPanel.some((hasLimit) => hasLimit);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function sidebar/setInited */\n\t\t\tsetInited: (store, chatId: number) => {\n\t\t\t\tif (!Type.isNumber(chatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setInited', chatId);\n\t\t\t},\n\t\t\t/** @function sidebar/setFilesMigrated */\n\t\t\tsetFilesMigrated: (store, value: boolean) => {\n\t\t\t\tif (!Type.isBoolean(value))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setFilesMigrated', value);\n\t\t\t},\n\t\t\t/** @function sidebar/setLinksMigrated */\n\t\t\tsetLinksMigrated: (store, value: boolean) => {\n\t\t\t\tif (!Type.isBoolean(value))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setLinksMigrated', value);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetInited: (state: SidebarState, chatId: number) => {\n\t\t\t\tstate.initedList.add(chatId);\n\t\t\t},\n\t\t\tsetFilesMigrated: (state: SidebarState, payload: boolean) => {\n\t\t\t\tstate.isFilesMigrated = payload;\n\t\t\t},\n\t\t\tsetLinksMigrated: (state: SidebarState, payload: boolean) => {\n\t\t\t\tstate.isLinksMigrated = payload;\n\t\t\t},\n\t\t};\n\t}\n}\n","import {Type} from 'main.core';\nimport {BuilderModel} from 'ui.vue3.vuex';\n\nimport {PlacementType} from 'im.v2.const';\n\nimport type {MarketApplication} from '../type/market';\n\nexport class MarketModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'market';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t\tplacementCollection: {\n\t\t\t\t[PlacementType.contextMenu]: new Set(),\n\t\t\t\t[PlacementType.navigation]: new Set(),\n\t\t\t\t[PlacementType.textarea]: new Set(),\n\t\t\t\t[PlacementType.sidebar]: new Set(),\n\t\t\t\t[PlacementType.smilesSelector]: new Set()\n\t\t\t},\n\t\t};\n\t}\n\n\tgetElementState(): MarketApplication\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\ttitle: '',\n\t\t\toptions: {\n\t\t\t\trole: '',\n\t\t\t\textranet: '',\n\t\t\t\tcontext: null,\n\t\t\t\twidth: null,\n\t\t\t\theight: null,\n\t\t\t\tcolor: null,\n\t\t\t\ticonName: null\n\t\t\t},\n\t\t\tplacement: '',\n\t\t\torder: 0,\n\t\t\tloadConfiguration: {\n\t\t\t\tID: 0,\n\t\t\t\tPLACEMENT: '',\n\t\t\t\tPLACEMENT_ID: 0,\n\t\t\t},\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tgetByPlacement: (state) => (placement: string): MarketApplication[] =>\n\t\t\t{\n\t\t\t\tconst appIds = [...state.placementCollection[placement].values()];\n\n\t\t\t\treturn appIds.map(id => {\n\t\t\t\t\treturn state.collection.get(id);\n\t\t\t\t});\n\t\t\t},\n\t\t\tgetById: (state) => (id: number): number =>\n\t\t\t{\n\t\t\t\treturn state.collection.get(id);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst {items} = payload;\n\n\t\t\t\titems.forEach((item: MarketApplication) => {\n\t\t\t\t\tstore.commit('setPlacementCollection', {placement: item.placement, id: item.id});\n\t\t\t\t\tstore.commit('setCollection', item);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tsetPlacementCollection: (state, payload: MarketApplication) =>\n\t\t\t{\n\t\t\t\tstate.placementCollection[payload.placement].add(payload.id);\n\t\t\t},\n\t\t\tsetCollection: (state, payload: MarketApplication) =>\n\t\t\t{\n\t\t\t\tstate.collection.set(payload.id, {...this.getElementState(), ...this.#validate(payload)});\n\t\t\t},\n\t\t};\n\t}\n\n\t#validate(app: Object): MarketApplication\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(app.id) || Type.isStringFilled(app.id))\n\t\t{\n\t\t\tresult.id = app.id.toString();\n\t\t}\n\n\t\tif (Type.isString(app.title))\n\t\t{\n\t\t\tresult.title = app.title;\n\t\t}\n\n\t\tresult.options = this.#validateOptions(app.options);\n\n\t\tif (Type.isString(app.placement))\n\t\t{\n\t\t\tresult.placement = app.placement;\n\t\t}\n\n\t\tif (Type.isNumber(app.order))\n\t\t{\n\t\t\tresult.order = app.order;\n\t\t}\n\n\t\tresult.loadConfiguration = this.#validateLoadConfiguration(app.loadConfiguration);\n\n\t\treturn result;\n\t}\n\n\t#validateOptions(options: Object)\n\t{\n\t\tconst result = {\n\t\t\tcontext: null,\n\t\t\twidth: null,\n\t\t\theight: null,\n\t\t\tcolor: null,\n\t\t\ticonName: null\n\t\t};\n\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isArrayFilled(options.context))\n\t\t{\n\t\t\tresult.context = options.context;\n\t\t}\n\t\tif (Type.isNumber(options.width))\n\t\t{\n\t\t\tresult.width = options.width;\n\t\t}\n\n\t\tif (Type.isNumber(options.height))\n\t\t{\n\t\t\tresult.height = options.height;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.color))\n\t\t{\n\t\t\tresult.color = options.color;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.iconName))\n\t\t{\n\t\t\tresult.iconName = options.iconName;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#validateLoadConfiguration(configuration: Object)\n\t{\n\t\tconst result = {\n\t\t\tID: 0,\n\t\t\tPLACEMENT: '',\n\t\t\tPLACEMENT_ID: 0,\n\t\t};\n\n\t\tif (!Type.isPlainObject(configuration))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isNumber(configuration.ID))\n\t\t{\n\t\t\tresult.ID = configuration.ID;\n\t\t}\n\n\t\tif (Type.isStringFilled(configuration.PLACEMENT))\n\t\t{\n\t\t\tresult.PLACEMENT = configuration.PLACEMENT;\n\t\t}\n\n\t\tif (Type.isNumber(configuration.PLACEMENT_ID))\n\t\t{\n\t\t\tresult.PLACEMENT_ID = configuration.PLACEMENT_ID;\n\t\t}\n\n\t\treturn result;\n\t}\n}","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\nimport type { RecentItem as ImModelRecentItem } from '../type/recent-item';\nimport type { Chat as ImModelChat } from '../type/chat';\n\ntype CountersState = {\n\tunloadedChatCounters: {[chatId: string]: number},\n\tunloadedLinesCounters: {[chatId: string]: number},\n\tunloadedCopilotCounters: {[chatId: string]: number},\n\tunloadedCollabCounters: {[chatId: string]: number},\n\tunloadedTaskCounters: {[chatId: string]: number},\n\tcommentCounters: CommentsCounters,\n};\n\ntype CommentsCounters = {\n\t[channelChatId: string]: {\n\t\t[commentChatId: string]: number,\n\t},\n}\n\ntype CommentsCounterPayload = {\n\tchannelId: number,\n\tcommentChatId: number\n};\n\nexport class CountersModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'counters';\n\t}\n\n\tgetState(): CountersState\n\t{\n\t\treturn {\n\t\t\tunloadedChatCounters: {},\n\t\t\tunloadedLinesCounters: {},\n\t\t\tunloadedCopilotCounters: {},\n\t\t\tunloadedCollabCounters: {},\n\t\t\tunloadedTaskCounters: {},\n\t\t\tcommentCounters: {},\n\t\t};\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function counters/getUnloadedChatCounters */\n\t\t\tgetUnloadedChatCounters: (state: CountersState): number => {\n\t\t\t\treturn state.unloadedChatCounters;\n\t\t\t},\n\t\t\t/** @function counters/getTotalChatCounter */\n\t\t\tgetTotalChatCounter: (state: CountersState): number => {\n\t\t\t\tconst recentCollection = Core.getStore().getters['recent/getRecentCollection'];\n\t\t\t\tconst loadedChatsCounter = this.#getLoadedChatsCounter(recentCollection);\n\n\t\t\t\tlet unloadedChatsCounter = 0;\n\t\t\t\tObject.values(state.unloadedChatCounters).forEach((counter) => {\n\t\t\t\t\tunloadedChatsCounter += counter;\n\t\t\t\t});\n\n\t\t\t\tconst channelCommentsCounter = Core.getStore().getters['counters/getTotalCommentsCounter'];\n\n\t\t\t\treturn loadedChatsCounter + unloadedChatsCounter + channelCommentsCounter;\n\t\t\t},\n\t\t\t/** @function counters/getTotalCopilotCounter */\n\t\t\tgetTotalCopilotCounter: (state: CountersState): number => {\n\t\t\t\tconst recentCollection = Core.getStore().getters['recent/getCopilotCollection'];\n\t\t\t\tconst loadedChatsCounter = this.#getLoadedChatsCounter(recentCollection);\n\n\t\t\t\tlet unloadedChatsCounter = 0;\n\t\t\t\tObject.values(state.unloadedCopilotCounters).forEach((counter) => {\n\t\t\t\t\tunloadedChatsCounter += counter;\n\t\t\t\t});\n\n\t\t\t\treturn loadedChatsCounter + unloadedChatsCounter;\n\t\t\t},\n\t\t\t/** @function counters/getTotalCollabCounter */\n\t\t\tgetTotalCollabCounter: (state: CountersState): number => {\n\t\t\t\tconst recentCollection = Core.getStore().getters['recent/getCollabCollection'];\n\t\t\t\tconst loadedChatsCounter = this.#getLoadedChatsCounter(recentCollection);\n\n\t\t\t\tlet unloadedChatsCounter = 0;\n\t\t\t\tObject.values(state.unloadedCollabCounters).forEach((counter) => {\n\t\t\t\t\tunloadedChatsCounter += counter;\n\t\t\t\t});\n\n\t\t\t\treturn loadedChatsCounter + unloadedChatsCounter;\n\t\t\t},\n\t\t\t/** @function counters/getTotalTaskCounter */\n\t\t\tgetTotalTaskCounter: (state: CountersState): number => {\n\t\t\t\tconst recentCollection = Core.getStore().getters['recent/getTaskCollection'];\n\t\t\t\tconst loadedChatsCounter = this.#getLoadedChatsCounter(recentCollection);\n\n\t\t\t\tlet unloadedChatsCounter = 0;\n\t\t\t\tObject.values(state.unloadedTaskCounters).forEach((counter) => {\n\t\t\t\t\tunloadedChatsCounter += counter;\n\t\t\t\t});\n\n\t\t\t\treturn loadedChatsCounter + unloadedChatsCounter;\n\t\t\t},\n\t\t\t/** @function counters/getTotalLinesCounter */\n\t\t\tgetTotalLinesCounter: (state: CountersState): number => {\n\t\t\t\tlet unloadedLinesCounter = 0;\n\t\t\t\tObject.values(state.unloadedLinesCounters).forEach((counter) => {\n\t\t\t\t\tunloadedLinesCounter += counter;\n\t\t\t\t});\n\n\t\t\t\treturn unloadedLinesCounter;\n\t\t\t},\n\t\t\t/** @function counters/getSpecificLinesCounter */\n\t\t\tgetSpecificLinesCounter: (state: CountersState) => (chatId: number): number => {\n\t\t\t\tif (!state.unloadedLinesCounters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.unloadedLinesCounters[chatId];\n\t\t\t},\n\t\t\t/** @function counters/getTotalCommentsCounter */\n\t\t\tgetTotalCommentsCounter: (state: CountersState): number => {\n\t\t\t\tlet totalCounter = 0;\n\t\t\t\tObject.entries(state.commentCounters).forEach(([channelChatId, channelCounters]) => {\n\t\t\t\t\tconst channel = this.#getChatByChatId(channelChatId);\n\t\t\t\t\tif (this.#isChatMuted(channel))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tObject.values(channelCounters).forEach((commentCounter) => {\n\t\t\t\t\t\ttotalCounter += commentCounter;\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\treturn totalCounter;\n\t\t\t},\n\t\t\t/** @function counters/getChannelComments */\n\t\t\tgetChannelComments: (state: CountersState) => (chatId: number): number[] => {\n\t\t\t\tif (!state.commentCounters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn state.commentCounters[chatId];\n\t\t\t},\n\t\t\t/** @function counters/getChannelCommentsCounter */\n\t\t\tgetChannelCommentsCounter: (state: CountersState) => (chatId: number): number => {\n\t\t\t\tif (!state.commentCounters[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tlet result = 0;\n\t\t\t\tObject.values(state.commentCounters[chatId]).forEach((counter) => {\n\t\t\t\t\tresult += counter;\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\t/** @function counters/getChatCounterByChatId */\n\t\t\tgetChatCounterByChatId: (state: CountersState) => (chatId: number): number => {\n\t\t\t\tconst recentCollection: ImModelRecentItem[] = Core.getStore().getters['recent/getRecentCollection'];\n\t\t\t\tconst recentItem = recentCollection.find((element) => {\n\t\t\t\t\tconst chat: ImModelChat = this.store.getters['chats/get'](element.dialogId, true);\n\n\t\t\t\t\treturn chat.chatId === chatId;\n\t\t\t\t});\n\n\t\t\t\tif (!recentItem)\n\t\t\t\t{\n\t\t\t\t\treturn state.unloadedChatCounters[chatId] ?? 0;\n\t\t\t\t}\n\n\t\t\t\treturn this.#getRecentItemCounter(recentItem);\n\t\t\t},\n\t\t\t/** @function counters/getSpecificCommentsCounter */\n\t\t\tgetSpecificCommentsCounter: (state: CountersState) => (payload: CommentsCounterPayload): number => {\n\t\t\t\tconst { channelId, commentChatId } = payload;\n\t\t\t\tif (!state.commentCounters[channelId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.commentCounters[channelId][commentChatId] ?? 0;\n\t\t\t},\n\t\t};\n\t}\n\n\t/* eslint-disable no-param-reassign */\n\t/* eslint-disable-next-line max-lines-per-function */\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function counters/setUnloadedChatCounters */\n\t\t\tsetUnloadedChatCounters: (store, payload: {[chatId: string]: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedChatCounters', payload);\n\t\t\t},\n\t\t\t/** @function counters/setUnloadedLinesCounters */\n\t\t\tsetUnloadedLinesCounters: (store, payload: {[chatId: string]: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedLinesCounters', payload);\n\t\t\t},\n\t\t\t/** @function counters/setUnloadedCopilotCounters */\n\t\t\tsetUnloadedCopilotCounters: (store, payload: {[chatId: string]: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedCopilotCounters', payload);\n\t\t\t},\n\t\t\t/** @function counters/setUnloadedCollabCounters */\n\t\t\tsetUnloadedCollabCounters: (store, payload: {[chatId: string]: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedCollabCounters', payload);\n\t\t\t},\n\t\t\t/** @function counters/setUnloadedTaskCounters */\n\t\t\tsetUnloadedTaskCounters: (store, payload: {[chatId: string]: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setUnloadedTaskCounters', payload);\n\t\t\t},\n\t\t\t/** @function counters/setCommentCounters */\n\t\t\tsetCommentCounters: (store, payload: CommentsCounters) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setCommentCounters', payload);\n\t\t\t},\n\t\t\t/** @function counters/readAllChannelComments */\n\t\t\treadAllChannelComments: (store, channelChatId: number) => {\n\t\t\t\tif (!Type.isNumber(channelChatId))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('readAllChannelComments', channelChatId);\n\t\t\t},\n\t\t\t/** @function counters/deleteForChannel */\n\t\t\tdeleteForChannel: (store, payload: {channelChatId: number, commentChatId?: number}) => {\n\t\t\t\tif (!Type.isPlainObject(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('deleteForChannel', payload);\n\t\t\t},\n\t\t\t/** @function counters/clearUnloadedTaskCounters */\n\t\t\tclearUnloadedTaskCounters: (store) => {\n\t\t\t\tstore.commit('clearUnloadedTaskCounters');\n\t\t\t},\n\t\t\t/** @function counters/clear */\n\t\t\tclear: (store) => {\n\t\t\t\tstore.commit('clear');\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetUnloadedChatCounters: (state: CountersState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedChatCounters[chatId];\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedChatCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetUnloadedLinesCounters: (state: CountersState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedLinesCounters[chatId];\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedLinesCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetUnloadedCopilotCounters: (state: CountersState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedCopilotCounters[chatId];\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedCopilotCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetUnloadedCollabCounters: (state: CountersState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedCollabCounters[chatId];\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedCollabCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetUnloadedTaskCounters: (state: CountersState, payload: {[chatId: string]: number}) => {\n\t\t\t\tObject.entries(payload).forEach(([chatId, counter]) => {\n\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete state.unloadedTaskCounters[chatId];\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tstate.unloadedTaskCounters[chatId] = counter;\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCommentCounters: (state: CountersState, payload: CommentsCounters) => {\n\t\t\t\tObject.entries(payload).forEach(([channelChatId, countersMap]) => {\n\t\t\t\t\tif (!state.commentCounters[channelChatId])\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.commentCounters[channelChatId] = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tconst channelMap = state.commentCounters[channelChatId];\n\t\t\t\t\tObject.entries(countersMap).forEach(([commentChatId, counter]) => {\n\t\t\t\t\t\tif (counter === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdelete channelMap[commentChatId];\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tchannelMap[commentChatId] = counter;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\treadAllChannelComments: (state: CountersState, channelChatId: number) => {\n\t\t\t\tdelete state.commentCounters[channelChatId];\n\t\t\t},\n\t\t\tdeleteForChannel: (state: CountersState, payload: {channelChatId: number, commentChatId?: number}) => {\n\t\t\t\tconst { channelChatId, commentChatId } = payload;\n\t\t\t\tif (!state.commentCounters[channelChatId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!commentChatId)\n\t\t\t\t{\n\t\t\t\t\tdelete state.commentCounters[channelChatId];\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tdelete state.commentCounters[channelChatId][commentChatId];\n\t\t\t},\n\t\t\tclearUnloadedTaskCounters: (state: CountersState) => {\n\t\t\t\tstate.unloadedTaskCounters = {};\n\t\t\t},\n\t\t\tclear: (state: CountersState) => {\n\t\t\t\tstate.unloadedChatCounters = {};\n\t\t\t\tstate.unloadedLinesCounters = {};\n\t\t\t\tstate.unloadedCopilotCounters = {};\n\t\t\t\tstate.unloadedCollabCounters = {};\n\t\t\t\tstate.unloadedTaskCounters = {};\n\t\t\t\tstate.commentCounters = {};\n\t\t\t},\n\t\t};\n\t}\n\n\t#getChat(dialogId): ImModelChat\n\t{\n\t\treturn Core.getStore().getters['chats/get'](dialogId, true);\n\t}\n\n\t#getChatByChatId(chatId): ImModelChat\n\t{\n\t\treturn Core.getStore().getters['chats/getByChatId'](chatId, true);\n\t}\n\n\t#isChatMuted(chat: ImModelChat): boolean\n\t{\n\t\treturn chat.muteList.includes(Core.getUserId());\n\t}\n\n\t#getRecentItemCounter(recentItem: ImModelRecentItem): number\n\t{\n\t\tconst chat = this.#getChat(recentItem.dialogId);\n\t\tif (this.#isChatMuted(chat))\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\t\tconst isMarked = recentItem.unread;\n\t\tif (chat.counter === 0 && isMarked)\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\n\t\treturn chat.counter;\n\t}\n\n\t#getLoadedChatsCounter(recentCollection: ImModelRecentItem[]): number\n\t{\n\t\tlet loadedChatsCounter = 0;\n\n\t\trecentCollection.forEach((recentItem: ImModelRecentItem) => {\n\t\t\tconst recentItemCounter = this.#getRecentItemCounter(recentItem);\n\t\t\tloadedChatsCounter += recentItemCounter;\n\t\t});\n\n\t\treturn loadedChatsCounter;\n\t}\n}\n","import { Type } from 'main.core';\n\nimport type { FieldsConfig } from '../../utils/validate';\n\nexport const copilotFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'code',\n\t\ttargetFieldName: 'code',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'default',\n\t\ttargetFieldName: 'default',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'recommended',\n\t\ttargetFieldName: 'recommended',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'supportsReasoning',\n\t\ttargetFieldName: 'supportsReasoning',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'name',\n\t\ttargetFieldName: 'name',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\n\nimport type { FieldsConfig } from 'im.v2.model';\n\nexport const chatFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'dialogId',\n\t\ttargetFieldName: 'dialogId',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'role',\n\t\ttargetFieldName: 'role',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'engine',\n\t\ttargetFieldName: 'aiModel',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\n\nimport { chatFieldsConfig } from './field-config';\nimport { formatFieldsWithConfig } from '../../../utils/validate';\n\nimport type { JsonObject } from 'main.core';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { ImModelCopilotAIModel, ImModelCopilotRole } from '../../../registry';\n\ntype ChatsState = {\n\tcollection: {[dialogId: string]: CopilotChat},\n}\n\ntype CopilotChat = {\n\tdialogId: string,\n\trole: string,\n\taiModel: string,\n\treasoningEnabled: boolean,\n}\n\nconst AI_MODEL_DEFAULT_NAME = 'none';\n\n/* eslint-disable no-param-reassign */\nexport class ChatsModel extends BuilderModel\n{\n\tgetState(): ChatsState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): CopilotChat\n\t{\n\t\treturn {\n\t\t\tdialogId: '',\n\t\t\trole: '',\n\t\t\taiModel: '',\n\t\t\treasoningEnabled: false,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/chats/getRole */\n\t\t\tgetRole: (state: ChatsState) => (dialogId: string): ?ImModelCopilotRole => {\n\t\t\t\tconst chat = state.collection[dialogId];\n\t\t\t\tif (!chat)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn Core.getStore().getters['copilot/roles/getByCode'](chat.role);\n\t\t\t},\n\t\t\t/** @function copilot/chats/getRoleAvatar */\n\t\t\tgetRoleAvatar: (state: ChatsState, getters) => (dialogId: string): string => {\n\t\t\t\tconst role = getters.getRole(dialogId);\n\t\t\t\tif (!role)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn Core.getStore().getters['copilot/roles/getAvatar'](role.code);\n\t\t\t},\n\t\t\t/** @function copilot/chats/getAIModel */\n\t\t\tgetAIModel: (state: ChatsState) => (dialogId: string): ?ImModelCopilotAIModel => {\n\t\t\t\tconst chat = state.collection[dialogId];\n\t\t\t\tif (!chat)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tconst aiModelList = Core.getStore().getters['copilot/getAIModels'];\n\n\t\t\t\tconst currentAiModel = aiModelList.find((aiModel) => aiModel.code === chat.aiModel);\n\n\t\t\t\treturn currentAiModel ?? AI_MODEL_DEFAULT_NAME;\n\t\t\t},\n\t\t\t/** @function copilot/chats/isReasoningEnabled */\n\t\t\tisReasoningEnabled: (state) => (dialogId: string): boolean => {\n\t\t\t\tconst chat = state.collection[dialogId];\n\t\t\t\tif (!chat)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].reasoningEnabled;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/chats/set */\n\t\t\tset: (store, payload) => {\n\t\t\t\tif (!payload)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst chatsToAdd = Type.isArrayFilled(payload) ? payload : [payload];\n\n\t\t\t\tconst preparedChats = chatsToAdd.map((chat) => {\n\t\t\t\t\treturn this.formatFields(chat);\n\t\t\t\t});\n\n\t\t\t\tpreparedChats.forEach((chat) => {\n\t\t\t\t\tconst existingItem = store.state.collection[chat.dialogId];\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tdialogId: chat.dialogId,\n\t\t\t\t\t\t\tfields: chat,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\tdialogId: chat.dialogId,\n\t\t\t\t\t\tfields: { ...this.getElementState(), ...chat },\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function copilot/chats/updateModel */\n\t\t\tupdateModel: (store, payload: { dialogId: string, aiModel: string }) => {\n\t\t\t\tif (!payload || !store.state.collection[payload.dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updateModel', payload);\n\t\t\t},\n\t\t\t/** @function copilot/chats/toggleReasoning */\n\t\t\ttoggleReasoning: (store, dialogId: string) => {\n\t\t\t\tif (!store.state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('toggleReasoning', dialogId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state: ChatsState, payload) => {\n\t\t\t\tconst { dialogId, fields } = payload;\n\t\t\t\tstate.collection[dialogId] = fields;\n\t\t\t},\n\t\t\tupdate: (state: ChatsState, payload) => {\n\t\t\t\tconst { dialogId, fields } = payload;\n\t\t\t\tstate.collection[dialogId] = { ...state.collection[dialogId], ...fields };\n\t\t\t},\n\t\t\tupdateModel: (state: ChatsState, payload) => {\n\t\t\t\tconst { dialogId, aiModel } = payload;\n\t\t\t\tstate.collection[dialogId].aiModel = aiModel;\n\t\t\t},\n\t\t\ttoggleReasoning: (state, dialogId: string) => {\n\t\t\t\tstate.collection[dialogId].reasoningEnabled = !state.collection[dialogId].reasoningEnabled;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, chatFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport type { FieldsConfig } from 'im.v2.model';\n\nexport const messagesFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'role',\n\t\ttargetFieldName: 'roleCode',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Core } from 'im.v2.application.core';\nimport { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { formatFieldsWithConfig } from '../../../utils/validate';\nimport { messagesFieldsConfig } from './field-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelCopilotPrompt, ImModelCopilotRole, ImModelCopilotRoleCode } from 'im.v2.model';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype MessagesState = {\n\tcollection: { [key: number]: ImModelCopilotRoleCode }\n}\n\ntype CopilotMessage = {\n\trole: string\n}\n\n/* eslint-disable no-param-reassign */\nexport class MessagesModel extends BuilderModel\n{\n\tgetState(): MessagesState\n\t{\n\t\treturn {\n\t\t\tcollection: {},\n\t\t};\n\t}\n\n\tgetElementState(): CopilotMessage\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\troleCode: '',\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/messages/getRole */\n\t\t\tgetRole: (state) => (messageId: number): ?ImModelCopilotRole => {\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn Core.getStore().getters['copilot/roles/getDefault'];\n\t\t\t\t}\n\n\t\t\t\treturn Core.getStore().getters['copilot/roles/getByCode'](message.roleCode);\n\t\t\t},\n\t\t\t/** @function copilot/messages/getPrompts */\n\t\t\tgetPrompts: (state) => (messageId: number): ImModelCopilotPrompt[] => {\n\t\t\t\tconst message = state.collection[messageId];\n\t\t\t\tif (!message)\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn Core.getStore().getters['copilot/roles/getPrompts'](message.roleCode);\n\t\t\t},\n\t\t\tgetAvatar: (state, getters) => (messageId: number): string => {\n\t\t\t\tconst role = getters.getRole(messageId);\n\t\t\t\tif (!role)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn Core.getStore().getters['copilot/roles/getAvatar'](role.code);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/messages/add */\n\t\t\tadd: (store, payload) => {\n\t\t\t\tif (!Type.isArrayFilled(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tpayload.forEach((message) => {\n\t\t\t\t\tconst preparedMessage = {\n\t\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t\t...this.formatFields(message),\n\t\t\t\t\t};\n\t\t\t\t\tstore.commit('add', preparedMessage);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) => {\n\t\t\t\tstate.collection[payload.id] = payload;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, messagesFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport type { FieldsConfig } from 'im.v2.model';\n\nexport const rolesFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'avatar',\n\t\ttargetFieldName: 'avatar',\n\t\tcheckFunction: Type.isPlainObject,\n\t\tformatFunction: (target) => {\n\t\t\treturn formatFieldsWithConfig(target, avatarFieldsConfig);\n\t\t},\n\t},\n\t{\n\t\tfieldName: 'code',\n\t\ttargetFieldName: 'code',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: ['desc', 'description'],\n\t\ttargetFieldName: 'desc',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'name',\n\t\ttargetFieldName: 'name',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'default',\n\t\ttargetFieldName: 'default',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n\t{\n\t\tfieldName: 'prompts',\n\t\ttargetFieldName: 'prompts',\n\t\tcheckFunction: Type.isArray,\n\t\tformatFunction: (target) => {\n\t\t\treturn target.map((prompt) => {\n\t\t\t\treturn formatFieldsWithConfig(prompt, promptsFieldsConfig);\n\t\t\t});\n\t\t},\n\t},\n];\n\nconst promptsFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'code',\n\t\ttargetFieldName: 'code',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'promptType',\n\t\ttargetFieldName: 'promptType',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'text',\n\t\ttargetFieldName: 'text',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'title',\n\t\ttargetFieldName: 'title',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n\nconst avatarFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'small',\n\t\ttargetFieldName: 'small',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'medium',\n\t\ttargetFieldName: 'medium',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'large',\n\t\ttargetFieldName: 'large',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { rolesFieldsConfig } from './field-config';\nimport { formatFieldsWithConfig } from '../../../utils/validate';\n\nimport type { JsonObject } from 'main.core';\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\nimport type { ImModelCopilotPrompt, ImModelCopilotRole, ImModelCopilotRoleCode, ImModelCopilotAvatarSize } from 'im.v2.model';\n\ntype RolesState = {\n\troles: {[ImModelCopilotRoleCode]: ImModelCopilotRole}\n}\nexport const AvatarSizes: {[ImModelCopilotAvatarSize]: string} = Object.freeze({\n\tS: 'small',\n\tM: 'medium',\n\tL: 'large',\n});\n\n/* eslint-disable no-param-reassign */\nexport class RolesModel extends BuilderModel\n{\n\tgetState(): RolesState\n\t{\n\t\treturn {\n\t\t\troles: {},\n\t\t};\n\t}\n\n\tgetElementState(): ImModelCopilotRole\n\t{\n\t\treturn {\n\t\t\tcode: '',\n\t\t\tname: '',\n\t\t\tdesc: '',\n\t\t\tdefault: false,\n\t\t\tavatar: {\n\t\t\t\tsmall: '',\n\t\t\t\tmedium: '',\n\t\t\t\tlarge: '',\n\t\t\t},\n\t\t\tprompts: [],\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/roles/get */\n\t\t\tget: (state) => (): ImModelCopilotRole[] => {\n\t\t\t\treturn Object.values(state.roles);\n\t\t\t},\n\t\t\t/** @function copilot/roles/getByCode */\n\t\t\tgetByCode: (state, getters) => (code: string): ImModelCopilotRole[] => {\n\t\t\t\treturn state.roles[code] ?? getters.getDefault;\n\t\t\t},\n\t\t\t/** @function copilot/roles/getPrompts */\n\t\t\tgetPrompts: (state, getters) => (roleCode: string): ImModelCopilotPrompt[] => {\n\t\t\t\tif (!state.roles[roleCode])\n\t\t\t\t{\n\t\t\t\t\treturn getters.getDefault?.prompts ?? [];\n\t\t\t\t}\n\n\t\t\t\treturn state.roles[roleCode].prompts;\n\t\t\t},\n\t\t\t/** @function copilot/roles/getDefault */\n\t\t\tgetDefault: (state): ImModelCopilotRole => {\n\t\t\t\treturn Object.values(state.roles).find((role: ImModelCopilotRole) => role.default);\n\t\t\t},\n\t\t\t/** @function copilot/roles/getDefaultAvatar */\n\t\t\tgetDefaultAvatar: (state, getters) => (size: ImModelCopilotAvatarSize = 'M'): string => {\n\t\t\t\tconst avatarSize = AvatarSizes[size];\n\n\t\t\t\treturn getters.getDefault?.avatar[avatarSize] ?? '';\n\t\t\t},\n\t\t\t/** @function copilot/roles/getAvatar */\n\t\t\tgetAvatar: (state, getters) => (roleCode: string, size: ImModelCopilotAvatarSize = 'M'): string => {\n\t\t\t\tconst avatarSize = AvatarSizes[size];\n\t\t\t\tif (!state.roles[roleCode])\n\t\t\t\t{\n\t\t\t\t\treturn getters.getDefault?.avatar[avatarSize] ?? '';\n\t\t\t\t}\n\n\t\t\t\treturn state.roles[roleCode].avatar[avatarSize];\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/roles/add */\n\t\t\tadd: (store, payload) => {\n\t\t\t\tconst roles = Object.values(payload);\n\t\t\t\tif (!Type.isArrayFilled(roles))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\troles.forEach((role) => {\n\t\t\t\t\tconst preparedRole = { ...this.getElementState(), ...this.formatFields(role) };\n\t\t\t\t\tstore.commit('add', preparedRole);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload) => {\n\t\t\t\tstate.roles[payload.code] = payload;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, rolesFieldsConfig);\n\t}\n}\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { Core } from 'im.v2.application.core';\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { copilotFieldsConfig } from './format/field-config';\nimport { ChatsModel } from './nested-modules/chats/chats';\nimport { MessagesModel } from './nested-modules/messages/messages';\nimport { RolesModel } from './nested-modules/roles/roles';\n\nimport type { JsonObject } from 'main.core';\nimport type { ImModelCopilotRole, ImModelCopilotAIModel } from '../registry';\nimport type { GetterTree, ActionTree, MutationTree, NestedModuleTree } from 'ui.vue3.vuex';\n\ntype CopilotModelState = {\n\trecommendedRoles: string[],\n\taiProvider: string,\n\tavailableAIModels: {\n\t\t[code: string]: ImModelCopilotAIModel[]\n\t},\n};\n\nconst RECOMMENDED_ROLES_LIMIT = 4;\n\n/* eslint-disable no-param-reassign */\nexport class CopilotModel extends BuilderModel\n{\n\tgetNestedModules(): NestedModuleTree\n\t{\n\t\treturn {\n\t\t\troles: RolesModel,\n\t\t\tmessages: MessagesModel,\n\t\t\tchats: ChatsModel,\n\t\t};\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn 'copilot';\n\t}\n\n\tgetState(): CopilotModelState\n\t{\n\t\treturn {\n\t\t\trecommendedRoles: [],\n\t\t\taiProvider: '',\n\t\t\tavailableAIModels: {},\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/getProvider */\n\t\t\tgetProvider: (state): string => {\n\t\t\t\treturn state.aiProvider;\n\t\t\t},\n\t\t\t/** @function copilot/getAIModels */\n\t\t\tgetAIModels: (state): ImModelCopilotAIModel[] => {\n\t\t\t\treturn Object.values(state.availableAIModels);\n\t\t\t},\n\t\t\t/** @function copilot/getRecommendedRoles */\n\t\t\tgetRecommendedRoles: (state) => (): ImModelCopilotRole[] => {\n\t\t\t\tconst roles = state.recommendedRoles.map((roleCode) => {\n\t\t\t\t\treturn Core.getStore().getters['copilot/roles/getByCode'](roleCode);\n\t\t\t\t});\n\n\t\t\t\treturn roles.slice(0, RECOMMENDED_ROLES_LIMIT);\n\t\t\t},\n\t\t\t/** @function copilot/getDefaultModelName */\n\t\t\tgetDefaultModelName: (state): string => {\n\t\t\t\tconst allModels = Object.values(state.availableAIModels);\n\t\t\t\tif (allModels.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tconst defaultModel: ?ImModelCopilotAIModel = allModels.find((model) => model.default === true);\n\t\t\t\tif (!defaultModel)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn defaultModel.name;\n\t\t\t},\n\t\t\t/** @function copilot/isReasoningAvailableInModel */\n\t\t\tisReasoningAvailableInModel: (state) => (code: string): boolean => {\n\t\t\t\treturn Boolean(state.availableAIModels[code]?.supportsReasoning);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function copilot/setRecommendedRoles */\n\t\t\tsetRecommendedRoles: (store, payload) => {\n\t\t\t\tif (!Type.isArrayFilled(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setRecommendedRoles', payload);\n\t\t\t},\n\t\t\t/** @function copilot/setProvider */\n\t\t\tsetProvider: (store, payload) => {\n\t\t\t\tif (!Type.isStringFilled(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setProvider', payload);\n\t\t\t},\n\t\t\t/** @function copilot/setAvailableAIModels */\n\t\t\tsetAvailableAIModels: (store, payload: ImModelCopilotAIModel[]) => {\n\t\t\t\tif (!Type.isArrayFilled(payload))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tpayload.forEach((model) => {\n\t\t\t\t\tstore.commit('setAvailableAIModel', this.formatFields(model));\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetRecommendedRoles: (state: CopilotModelState, payload) => {\n\t\t\t\tstate.recommendedRoles = payload;\n\t\t\t},\n\t\t\tsetProvider: (state: CopilotModelState, payload) => {\n\t\t\t\tstate.aiProvider = payload;\n\t\t\t},\n\t\t\tsetAvailableAIModel: (state: CopilotModelState, payload: ImModelCopilotAIModel) => {\n\t\t\t\tstate.availableAIModels[payload.code] = payload;\n\t\t\t},\n\t\t};\n\t}\n\n\tformatFields(fields: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(fields, copilotFieldsConfig);\n\t}\n}\n","import { BuilderModel } from 'ui.vue3.vuex';\n\nimport type { GetterTree, ActionTree, MutationTree } from 'ui.vue3.vuex';\n\ntype McpAuthId = number | null;\n\ntype AiAssistantState = {\n\tmcpAuthId: McpAuthId\n};\n\n/* eslint-disable no-param-reassign */\nexport class AiAssistantModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'aiAssistant';\n\t}\n\n\tgetState(): AiAssistantState\n\t{\n\t\treturn {\n\t\t\tmcpAuthId: null,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function aiAssistant/getMcpAuthId */\n\t\t\tgetMcpAuthId: (state: AiAssistantState): McpAuthId => {\n\t\t\t\treturn state.mcpAuthId;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function aiAssistant/setMcpAuthId */\n\t\t\tsetMcpAuthId: (store, mcpAuthId: McpAuthId) => {\n\t\t\t\tstore.commit('setMcpAuthId', mcpAuthId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tsetMcpAuthId: (state: AiAssistantState, mcpAuthId: McpAuthId) => {\n\t\t\t\tstate.mcpAuthId = mcpAuthId;\n\t\t\t},\n\t\t};\n\t}\n}\n","import { Type } from 'main.core';\n\nimport type { FieldsConfig } from 'im.v2.model';\n\nexport const stickerFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'packId',\n\t\ttargetFieldName: 'packId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'packType',\n\t\ttargetFieldName: 'packType',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'uri',\n\t\ttargetFieldName: 'uri',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'type',\n\t\ttargetFieldName: 'type',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'width',\n\t\ttargetFieldName: 'width',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'height',\n\t\ttargetFieldName: 'height',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'sort',\n\t\ttargetFieldName: 'sort',\n\t\tcheckFunction: Type.isNumber,\n\t},\n];\n","import { Type } from 'main.core';\n\nimport type { FieldsConfig } from 'im.v2.model';\n\nexport const recentStickerConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'packId',\n\t\ttargetFieldName: 'packId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'packType',\n\t\ttargetFieldName: 'packType',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { BuilderModel } from 'ui.vue3.vuex';\n\nimport { formatFieldsWithConfig } from '../../../utils/validate';\nimport { recentStickerConfig } from './field-config';\n\nimport type { Store, ActionTree, GetterTree, MutationTree } from 'ui.vue3.vuex';\nimport type { JsonObject } from 'main.core';\nimport type { StickerIdentifier, Sticker } from '../../../type/stickers';\n\ntype RecentState = {\n\tcollection: StickerIdentifier[],\n};\n\nconst RECENT_LIMIT = 12;\n\n/* eslint-disable no-param-reassign */\nexport class RecentStickersModel extends BuilderModel\n{\n\tgetState(): RecentState\n\t{\n\t\treturn {\n\t\t\tcollection: [],\n\t\t};\n\t}\n\n\tgetElementState(): StickerIdentifier\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tpackId: 0,\n\t\t\tpackType: '',\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function stickers/recent/get */\n\t\t\tget: (state: RecentState, getters, rootState, rootGetters): Sticker[] => {\n\t\t\t\treturn state.collection.map((recentSticker) => {\n\t\t\t\t\treturn rootGetters['stickers/get']({\n\t\t\t\t\t\tid: recentSticker.id,\n\t\t\t\t\t\tpackId: recentSticker.packId,\n\t\t\t\t\t\tpackType: recentSticker.packType,\n\t\t\t\t\t});\n\t\t\t\t}).filter((sticker) => Boolean(sticker));\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function stickers/recent/set */\n\t\t\tset: (store: Store, payload: StickerIdentifier[]) => {\n\t\t\t\tpayload.forEach((sticker) => {\n\t\t\t\t\tconst preparedRecentSticker = this.#formatFields(sticker);\n\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t\t...preparedRecentSticker,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function stickers/recent/update */\n\t\t\tupdate: (store: Store, payload: StickerIdentifier) => {\n\t\t\t\tconst preparedRecentSticker = this.#formatFields(payload);\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t...preparedRecentSticker,\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function stickers/recent/clear */\n\t\t\tclear: (store: Store) => {\n\t\t\t\tstore.commit('clear');\n\t\t\t},\n\t\t\t/** @function stickers/recent/delete */\n\t\t\tdelete: (store: Store, payload: StickerIdentifier) => {\n\t\t\t\tstore.commit('delete', payload);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state: RecentState, payload: StickerIdentifier) => {\n\t\t\t\tstate.collection.push(payload);\n\t\t\t\tthis.#applyLimit(state);\n\t\t\t},\n\t\t\tupdate: (state: RecentState, payload: StickerIdentifier) => {\n\t\t\t\tstate.collection = state.collection.filter((sticker) => {\n\t\t\t\t\treturn !this.#isEqual(sticker, payload);\n\t\t\t\t});\n\t\t\t\tstate.collection.unshift(payload);\n\t\t\t\tthis.#applyLimit(state);\n\t\t\t},\n\t\t\tclear: (state: RecentState) => {\n\t\t\t\tstate.collection = [];\n\t\t\t},\n\t\t\tdelete: (state: RecentState, payload: StickerIdentifier) => {\n\t\t\t\tstate.collection = state.collection.filter((sticker) => {\n\t\t\t\t\treturn !this.#isEqual(sticker, payload);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t#formatFields(sticker: JsonObject): StickerIdentifier\n\t{\n\t\treturn formatFieldsWithConfig(sticker, recentStickerConfig);\n\t}\n\n\t#applyLimit(state: RecentState)\n\t{\n\t\tif (state.collection.length > RECENT_LIMIT)\n\t\t{\n\t\t\tstate.collection = state.collection.slice(0, RECENT_LIMIT);\n\t\t}\n\t}\n\n\t#isEqual(firstSticker: StickerIdentifier, secondSticker: StickerIdentifier): boolean\n\t{\n\t\treturn firstSticker.id === secondSticker.id\n\t\t\t&& firstSticker.packId === secondSticker.packId\n\t\t\t&& firstSticker.packType === secondSticker.packType;\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { isNumberOrString, type FieldsConfig } from 'im.v2.model';\n\nexport const stickerMessagesConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'messageId',\n\t\ttargetFieldName: 'messageId',\n\t\tcheckFunction: isNumberOrString,\n\t},\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'packId',\n\t\ttargetFieldName: 'packId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'packType',\n\t\ttargetFieldName: 'packType',\n\t\tcheckFunction: Type.isString,\n\t},\n];\n","import { BuilderModel } from 'ui.vue3.vuex';\n\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { stickerMessagesConfig } from './field-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { Store, ActionTree, GetterTree, MutationTree } from 'ui.vue3.vuex';\nimport type { StickerIdentifier, RawStickerMessage } from '../../../type/stickers';\n\ntype MessagesState = {\n\tcollection: Map<string, StickerIdentifier>,\n};\n\n/* eslint-disable no-param-reassign */\nexport class StickerMessagesModel extends BuilderModel\n{\n\tgetState(): MessagesState\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t};\n\t}\n\n\tgetElementState(): StickerIdentifier\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tpackId: 0,\n\t\t\tpackType: '',\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function stickers/messages/isSticker */\n\t\t\tisSticker: (state: MessagesState) => (messageId: number | string): boolean => {\n\t\t\t\treturn state.collection.has(messageId);\n\t\t\t},\n\t\t\t/** @function stickers/messages/getStickerByMessageId */\n\t\t\tgetStickerByMessageId: (state: MessagesState) => (messageId: number | string): ?StickerIdentifier => {\n\t\t\t\treturn state.collection.get(messageId);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function stickers/messages/set */\n\t\t\tset: (store: Store, payload: RawStickerMessage[]) => {\n\t\t\t\tpayload.forEach((message) => {\n\t\t\t\t\tconst preparedStickerMessage = this.#formatFields(message);\n\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t\t...preparedStickerMessage,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function stickers/messages/updateWithId */\n\t\t\tupdateWithId: (store: Store, payload: { oldId: string, newId: number }) => {\n\t\t\t\tconst { oldId, newId } = payload;\n\t\t\t\tconst tempMessageStickerIdentifier = store.state.collection.get(oldId);\n\t\t\t\ttempMessageStickerIdentifier.messageId = newId;\n\t\t\t\tstore.commit('delete', oldId);\n\t\t\t\tstore.commit('add', tempMessageStickerIdentifier);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state: MessagesState, payload: RawStickerMessage) => {\n\t\t\t\tconst messageId = payload.messageId;\n\t\t\t\tdelete payload.messageId;\n\t\t\t\tstate.collection.set(messageId, payload);\n\t\t\t},\n\t\t\tdelete: (state: MessagesState, payload: string | number) => {\n\t\t\t\tstate.collection.delete(payload);\n\t\t\t},\n\t\t};\n\t}\n\n\t#formatFields(stickerMessage: RawStickerMessage): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(stickerMessage, stickerMessagesConfig);\n\t}\n}\n","import { Type } from 'main.core';\n\nimport type { FieldsConfig } from 'im.v2.model';\n\nexport const packFieldsConfig: FieldsConfig = [\n\t{\n\t\tfieldName: 'id',\n\t\ttargetFieldName: 'id',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'authorId',\n\t\ttargetFieldName: 'authorId',\n\t\tcheckFunction: Type.isNumber,\n\t},\n\t{\n\t\tfieldName: 'name',\n\t\ttargetFieldName: 'name',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'type',\n\t\ttargetFieldName: 'type',\n\t\tcheckFunction: Type.isString,\n\t},\n\t{\n\t\tfieldName: 'isAdded',\n\t\ttargetFieldName: 'isAdded',\n\t\tcheckFunction: Type.isBoolean,\n\t},\n];\n","import { Type } from 'main.core';\nimport { BuilderModel } from 'ui.vue3.vuex';\n\nimport { formatFieldsWithConfig } from 'im.v2.model';\n\nimport { packFieldsConfig } from './field-config';\n\nimport type { JsonObject } from 'main.core';\nimport type { Store, ActionTree, GetterTree, MutationTree } from 'ui.vue3.vuex';\nimport type { Pack, RawPack, PackIdentifier } from '../../../type/stickers';\n\ntype PacksState = {\n\tcollection: Map<string, Pack>,\n};\n\n/* eslint-disable no-param-reassign */\nexport class PacksModel extends BuilderModel\n{\n\tgetState(): PacksState\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t};\n\t}\n\n\tgetElementState(): Pack\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tkey: '',\n\t\t\ttype: '',\n\t\t\tname: '',\n\t\t\tauthorId: null,\n\t\t\tisAdded: false,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function stickers/packs/get */\n\t\t\tget: (state: PacksState): Pack[] => {\n\t\t\t\treturn [...state.collection.values()];\n\t\t\t},\n\t\t\t/** @function stickers/packs/getAddedPacks */\n\t\t\tgetAddedPacks: (state: PacksState): Pack[] => {\n\t\t\t\treturn [...state.collection.values()].filter((pack) => pack.isAdded);\n\t\t\t},\n\t\t\t/** @function stickers/packs/getByIdentifier */\n\t\t\tgetByIdentifier: (state: PacksState) => ({ id, type }: PackIdentifier): ?Pack => {\n\t\t\t\tconst packKey = this.#getPackKey({ id, type });\n\n\t\t\t\treturn state.collection.get(packKey);\n\t\t\t},\n\t\t\t/** @function stickers/packs/hasPack */\n\t\t\thasPack: (state: PacksState) => ({ id, type }: PackIdentifier): boolean => {\n\t\t\t\tconst packKey = this.#getPackKey({ id, type });\n\n\t\t\t\treturn state.collection.has(packKey);\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function stickers/packs/set */\n\t\t\tset: (store: Store, payload: RawPack[]) => {\n\t\t\t\tpayload.forEach((pack) => {\n\t\t\t\t\tconst preparedPack = this.#formatFields(pack);\n\t\t\t\t\tconst packKey = this.#getPackKey(preparedPack);\n\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\tkey: packKey,\n\t\t\t\t\t\tpack: {\n\t\t\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t\t\t...preparedPack,\n\t\t\t\t\t\t\tkey: packKey,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function stickers/packs/addNew */\n\t\t\taddNew: (store: Store, payload: RawPack) => {\n\t\t\t\tconst preparedPack = this.#formatFields(payload);\n\t\t\t\tconst packKey = this.#getPackKey(preparedPack);\n\t\t\t\tstore.commit('unshift', {\n\t\t\t\t\tkey: packKey,\n\t\t\t\t\tpack: {\n\t\t\t\t\t\t...this.getElementState(),\n\t\t\t\t\t\t...preparedPack,\n\t\t\t\t\t\tkey: packKey,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function stickers/packs/link */\n\t\t\tlink: (store: Store, payload: PackIdentifier) => {\n\t\t\t\tconst packKey = this.#getPackKey(payload);\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tkey: packKey,\n\t\t\t\t\tfields: { isAdded: true },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function stickers/packs/rename */\n\t\t\trename: (store: Store, payload: PackIdentifier & {name: string}) => {\n\t\t\t\tif (!Type.isStringFilled(payload.name))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst packKey = this.#getPackKey(payload);\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tkey: packKey,\n\t\t\t\t\tfields: { name: payload.name },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function stickers/packs/unlink */\n\t\t\tunlink: (store: Store, payload: PackIdentifier) => {\n\t\t\t\tconst packKey = this.#getPackKey(payload);\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tkey: packKey,\n\t\t\t\t\tfields: { isAdded: false },\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function stickers/packs/delete */\n\t\t\tdelete: (store: Store, payload: PackIdentifier) => {\n\t\t\t\tconst packKey = this.#getPackKey(payload);\n\t\t\t\tstore.commit('delete', { key: packKey });\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state: PacksState, payload: { key: string, pack: Pack }) => {\n\t\t\t\tconst { key, pack } = payload;\n\t\t\t\tstate.collection.set(key, pack);\n\t\t\t},\n\t\t\tdelete: (state: PacksState, payload: { key: string }) => {\n\t\t\t\tstate.collection.delete(payload.key);\n\t\t\t},\n\t\t\tupdate: (state: PacksState, payload: {key: string, fields: Partial<Pack>}) => {\n\t\t\t\tconst pack = state.collection.get(payload.key);\n\t\t\t\tif (!pack)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tstate.collection.set(payload.key, { ...pack, ...payload.fields });\n\t\t\t},\n\t\t\tunshift: (state: PacksState, payload: {key: string, pack: Pack }) => {\n\t\t\t\tconst collection = new Map([\n\t\t\t\t\t[payload.key, payload.pack],\n\t\t\t\t\t...state.collection,\n\t\t\t\t]);\n\n\t\t\t\tstate.collection.clear();\n\t\t\t\tcollection.forEach((value, key) => {\n\t\t\t\t\tstate.collection.set(key, value);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\t#formatFields(pack: JsonObject): JsonObject\n\t{\n\t\treturn formatFieldsWithConfig(pack, packFieldsConfig);\n\t}\n\n\t#getPackKey({ id, type }: PackIdentifier): string\n\t{\n\t\treturn `${id}:${type}`;\n\t}\n}\n","import { BuilderModel } from 'ui.vue3.vuex';\n\nimport { stickerFieldsConfig } from './format/field-config';\nimport { RecentStickersModel } from './nested-modules/recent/recent';\nimport { StickerMessagesModel } from './nested-modules/messages/messages';\nimport { PacksModel } from './nested-modules/packs/packs';\nimport { formatFieldsWithConfig } from '../utils/validate';\n\nimport type { Store, ActionTree, GetterTree, MutationTree, NestedModuleTree } from 'ui.vue3.vuex';\nimport type { JsonObject } from 'main.core';\nimport type { Sticker, StickerIdentifier, PackIdentifier, RawSticker } from '../type/stickers';\n\ntype StickersState = {\n\tcollection: Map<string, Sticker>,\n};\n\n/* eslint-disable no-param-reassign */\nexport class StickersModel extends BuilderModel\n{\n\tgetName(): string\n\t{\n\t\treturn 'stickers';\n\t}\n\n\tgetNestedModules(): NestedModuleTree\n\t{\n\t\treturn {\n\t\t\tpacks: PacksModel,\n\t\t\trecent: RecentStickersModel,\n\t\t\tmessages: StickerMessagesModel,\n\t\t};\n\t}\n\n\tgetState(): StickersState\n\t{\n\t\treturn {\n\t\t\tcollection: new Map(),\n\t\t};\n\t}\n\n\tgetElementState(): Sticker\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tpackId: 0,\n\t\t\tpackType: '',\n\t\t\ttype: 'image',\n\t\t\turi: '',\n\t\t\twidth: 0,\n\t\t\theight: 0,\n\t\t\tsort: 0,\n\t\t};\n\t}\n\n\tgetGetters(): GetterTree\n\t{\n\t\treturn {\n\t\t\t/** @function stickers/get */\n\t\t\tget: (state: StickersState) => ({ id, packId, packType }: StickerIdentifier): ?Sticker => {\n\t\t\t\tconst stickerKey = this.#getStickerKey({ id, packId, packType });\n\n\t\t\t\treturn state.collection.get(stickerKey);\n\t\t\t},\n\t\t\t/** @function stickers/getByPack */\n\t\t\tgetByPack: (state: StickersState) => ({ id, type }: PackIdentifier): Sticker[] => {\n\t\t\t\treturn [...state.collection.values()].filter((sticker) => {\n\t\t\t\t\treturn sticker.packId === id && sticker.packType === type;\n\t\t\t\t}).sort((sticker1, sticker2) => sticker1.sort - sticker2.sort);\n\t\t\t},\n\t\t\t/** @function stickers/getPackCover */\n\t\t\tgetPackCover: (state: StickersState, getters) => ({ id, type }: PackIdentifier): string => {\n\t\t\t\tconst packsStickers\t = getters.getByPack({ id, type });\n\t\t\t\tif (packsStickers.length > 0)\n\t\t\t\t{\n\t\t\t\t\treturn packsStickers[0].uri;\n\t\t\t\t}\n\n\t\t\t\treturn '';\n\t\t\t},\n\t\t};\n\t}\n\n\tgetActions(): ActionTree\n\t{\n\t\treturn {\n\t\t\t/** @function stickers/set */\n\t\t\tset: (store: Store, payload: RawSticker[]) => {\n\t\t\t\tpayload.forEach((sticker) => {\n\t\t\t\t\tconst preparedSticker = this.#formatFields(sticker);\n\t\t\t\t\tconst stickerKey = this.#getStickerKey(preparedSticker);\n\n\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\tkey: stickerKey,\n\t\t\t\t\t\tsticker: { ...this.getElementState(), ...preparedSticker },\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function stickers/delete */\n\t\t\tdelete: (store: Store, payload: { ids: number[], packId: number, packType: string }) => {\n\t\t\t\tconst { ids, packId, packType } = payload;\n\t\t\t\tids.forEach((id) => {\n\t\t\t\t\tconst stickerKey = this.#getStickerKey({ id, packId, packType });\n\t\t\t\t\tstore.commit('delete', stickerKey);\n\t\t\t\t});\n\t\t\t},\n\t\t\t/** @function stickers/deleteByPack */\n\t\t\tdeleteByPack: (store: Store, payload: PackIdentifier) => {\n\t\t\t\tconst { id: packId, type: packType } = payload;\n\t\t\t\t[...store.state.collection.values()].forEach((sticker) => {\n\t\t\t\t\tif (sticker.packId !== packId || sticker.packType !== packType)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst { id } = sticker;\n\t\t\t\t\tconst stickerKey = this.#getStickerKey({ id, packId, packType });\n\t\t\t\t\tstore.commit('delete', stickerKey);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations(): MutationTree\n\t{\n\t\treturn {\n\t\t\tadd: (state: StickersState, payload: { key: string, sticker: Sticker }) => {\n\t\t\t\tconst { key, sticker } = payload;\n\t\t\t\tstate.collection.set(key, sticker);\n\t\t\t},\n\t\t\tdelete: (state: StickersState, key) => {\n\t\t\t\tstate.collection.delete(key);\n\t\t\t},\n\t\t};\n\t}\n\n\t#formatFields(rawSticker: JsonObject): Sticker\n\t{\n\t\treturn formatFieldsWithConfig(rawSticker, stickerFieldsConfig);\n\t}\n\n\t#getStickerKey({ id, packId, packType }: StickerIdentifier): string\n\t{\n\t\treturn `${packId}:${packType}:${id}`;\n\t}\n}\n"],"names":["isNumberOrString","target","Type","isNumber","isString","convertToString","toString","convertToNumber","Number","parseInt","convertToDate","Utils","date","cast","SNAKE_CASE_REGEXP","convertObjectKeysToCamelCase","targetObject","resultObject","Object","entries","forEach","key","value","newKey","prepareKey","isPlainObject","isArray","convertArrayItemsKeysToCamelCase","rawKey","search","toLowerCase","Text","toCamelCase","targetArray","map","arrayItem","SortWeight","tasks","calendar","im","blog","vote","main","socialnetwork","bizproc","rpa","lists","mail","crm","sender","booking","voximplant","imopenlines","timeman","disk","bitrix24","sign","biconnector","rest","intranet","photogallery","wiki","forum","prepareNotificationSettings","result","sortedTarget","sortNotificationSettingsBlock","block","preparedItems","notices","item","id","label","items","sort","a","b","weightA","weightB","settingsFieldsConfig","fieldName","Settings","notification","enableSound","targetFieldName","checkFunction","isBoolean","enableAutoRead","mode","enableWeb","enableMail","enablePush","formatFunction","message","bigSmiles","appearance","background","alignment","recent","showBirthday","showInvited","showLastMessage","hotkey","sendByEnter","desktop","enableRedirect","user","status","formatFieldsWithConfig","fields","config","rawFields","fieldConfig","foundFieldName","getValidFieldName","isFieldValueValid","formatFieldValue","fieldValue","currentResult","fieldNameList","isStringFilled","singleField","isUndefined","field","checkFunctionList","isFunction","some","singleFunction","params","SettingsModel","BuilderModel","getState","DialogAlignment","left","NotificationSettingsMode","simple","notifications","getGetters","get","state","getActions","set","store","payload","commit","formatFields","setNotificationOption","getMutations","moduleId","optionName","type","moduleOptions","tariffRestrictionsFieldsConfig","TariffRestrictionsModel","fullChatHistory","isAvailable","limitDays","isHistoryAvailable","ApplicationModel","getName","getNestedModules","settings","tariffRestrictions","layout","name","Layout","chat","entityId","contextId","getLayout","isChatOpen","dialogId","LayoutManager","getInstance","isChatLayout","isLinesChatOpen","openlines","openlinesV2","areNotificationsOpen","setLayout","previousLayout","newLayout","validateLayout","validateLayoutEntityId","EventEmitter","emit","EventType","onLayoutChange","from","to","updateLayout","isValidLayout","prepareComponentId","componentId","supportedComponents","values","MessageComponent","includes","unsupported","prepareAuthorId","system","isSystem","prepareKeyboard","rawKeyboardButtons","rawButton","disabled","wait","messageFieldsConfig","text","isTempMessage","isDate","PinModel","collection","getPinned","chatId","pinnedMessageId","Core","getStore","getters","push","isPinned","messageId","has","setPinned","pinnedMessages","length","pinnedMessageIds","add","delete","Logger","warn","Set","reverse","USERS_TO_SHOW","ReactionsModel","getElementState","reactionCounters","reactionUsers","ownReactions","getByMessageId","prepareSetPayload","setReaction","removeReaction","clearCollection","currentItem","currentOwnReactions","newOwnReactions","preparedOwnReactions","ownReactionsToRemove","reactionToRemove","userId","reaction","reactions","getUserId","handleOwnReactions","currentReactionCounter","newReactionCounter","addUserToReaction","withReplace","removeAllCurrentUserReactions","users","commentFieldsConfig","LAST_USERS_TO_SHOW","CommentsModel","opened","channelDialogId","postId","lastUserIds","messageCount","isUserSubscribed","getMessageIdByChatId","foundItem","find","element","areOpened","areOpenedForChannel","areOpenedForChannelPost","getOpenedChannelId","rawPayload","Array","setLastUser","newUserId","subscribe","dispatch","unsubscribe","setOpened","setClosed","currentUsers","unshift","pop","commentsPostId","authorId","SelectModel","getCollection","preparedCollection","filteredMessageIds","filter","isBulkActionsModeActive","Boolean","isMessageSelected","enableBulkMode","disableBulkMode","toggleMessageSelection","isAnchorsEqual","anchor1","anchor2","fromUserId","isAnchorWithTypeFromCurrentChat","anchor","anchorType","AnchorsModel","anchors","getChatMessageIdsWithAnchors","isMessageHasAnchors","isChatHasAnchors","isChatHasAnchorsWithType","getCounterInChatByType","chatAnchors","chatAnchor","size","getNextMessageIdWithAnchorType","anchorOne","anchorTwo","at","getAnchorsByChatType","chatType","setAnchors","addAnchor","equalAnchor","removeAnchor","removeUserAnchorsFromMessage","removeChatAnchors","removeAllAnchorsByChatType","removeAllAnchors","removedAnchorIndex","findIndex","splice","chatIds","MessagesModel","pin","comments","select","chatCollection","loadingMessages","replyId","Date","files","attach","keyboard","unread","viewed","viewedByOthers","sending","error","default","componentParams","forward","isEdited","isDeleted","getByChatId","fakeFirstMessage","firstLoadingMessages","reduce","acc","getById","getByIdList","idList","hasMessage","isForward","isVideoNote","getMessageFiles","file","isExists","isInChatCollection","getFirstId","getLastId","getLastOwnMessageId","getFirstUnread","getChatUnreadMessages","messages","fileId","getMessageType","currentUserId","MessageType","self","opponent","getPreviousMessage","initialMessageIndex","indexOf","desiredMessageId","findPreviousMessageId","currentMessageIndex","findLastChatMessageId","lastMessage","hasLoadingMessageByPreviousSiblingId","getLoadingMessageByPreviousSiblingId","getLoadingMessageByMessageId","currentMessage","hasLoadingMessageByMessageId","isRealMessage","setChatCollection","preparedMessages","updateWithId","update","readMessages","messageIds","chatMessages","messagesToReadCount","maxMessageId","messageIdsToView","messageIdsToRead","chatMessage","setViewedByOthers","ids","newPreviousMessageId","oldId","newId","clearChatCollection","deleteAttach","attachId","attachItem","addLoadingMessage","previousSiblingId","isNull","deleteLoadingMessageByMessageId","initChatCollection","isOwnMessage","entry","updateLoadingMessagePreviousSiblingId","loadingMessage","messageParams","formattedFields","NAME","USER_ID","authorName","AVATAR","avatar","originalAuthorId","fakeAuthorId","userManager","UserManager","networkId","UserIdNetworkPrefix","setUsersToModel","firstId","lastId","lastOwnMessageId","z","resultId","isUuidV4","getTime","prepareManagerList","managerList","rawUserId","prepareChatName","chatName","decode","prepareAvatar","endsWith","startsWith","getHost","encodeURI","prepareMuteList","muteList","prepareLastMessageViews","rawLastMessageViews","countOfViewers","firstViewers","rawFirstViewers","firstViewer","rawFirstViewer","userName","Error","chatFieldsConfig","chatEntityFieldsConfig","autoDeleteFieldsConfig","AutoDeleteModel","Map","isEnabled","getDelay","AutoDeleteDelay","Off","formattedElement","delay","collabFieldsConfig","collabEntitiesFieldConfig","collabEntityFieldConfig","CollabsModel","collabId","guestCount","entities","counter","url","collabInfo","setCounter","entity","currentRecord","setGuestCount","InputActionsModel","getByDialogId","chatActionList","isChatActive","isActionActive","isAlreadyActive","start","stop","duration","statusMessageCode","userRecord","initCollection","list","ChatsModel","collabs","inputActions","autoDelete","ChatType","description","color","Color","base","extranet","containsCollaber","userCounter","lastReadId","markedId","lastMessageId","lastMessageViews","savedPositionMessageId","inputActionList","quoteId","ownerId","entityLink","dateCreate","public","code","link","inited","loading","hasPrevPage","hasNextPage","diskFolderId","role","UserRole","member","permissions","manageUi","none","manageSettings","manageUsersAdd","manageUsersDelete","manageMessages","isHistoryLimitExceeded","parentChatId","backgroundId","isTextareaEnabled","getBlank","preparedChatId","getQuoteId","isUser","getLastReadId","lastReadIdMessage","getInitialMessageId","Math","min","isSupport","support24Question","isNotes","getBackgroundId","getCollectionByChatType","existingItem","clearCountersByChatType","clearCounters","mute","actionName","unmute","setLastMessageViews","newLastMessageViews","clearLastMessageViews","defaultLastMessageViews","incrementLastMessageViews","newCounter","keys","prepareDepartments","departments","rawDepartmentId","departmentId","preparePhones","phones","workPhone","personalMobile","personalPhone","innerPhone","userFieldsConfig","isNetworkUserId","botFieldsConfig","BotsModel","BotType","bot","appId","isHidden","isSupportOpenline","isHuman","reactionsEnabled","getByUserId","isNetwork","network","support24","isAiAssistant","BotCode","aiAssistant","getCopilotBotDialogId","copilot","isCopilot","copilotUserId","botData","RawBotType","human","TYPES_MAPPED_TO_DEFAULT_BOT","openline","supervisor","UserPositionByType","UserType","Loc","getMessage","collaber","UsersModel","bots","absentList","absentCheckInterval","isCurrentUserAdmin","firstName","lastName","workPosition","gender","connector","externalAuthId","idle","lastActivityDate","mobileLastDate","birthday","isBirthday","absent","isAbsent","email","website","getTemporary","getList","userList","hasBirthday","hasVacation","getLastOnline","getLastDateText","getPosition","isSupportBot","existingUser","setStatus","setCurrentUserAdminStatus","isAdmin","UserStatusManager","onUserUpdate","preparedFields","isBot","bot_data","addToAbsentList","startAbsentCheckInterval","TIME_TO_NEXT_DAY","setTimeout","setInterval","currentTime","now","absentEnd","getTimeToNextMidnight","prepareIconType","extension","getIconTypeByExtension","prepareImage","image","width","height","prepareUrl","fileFieldsConfig","FileStatus","FilesModel","temporaryFilesMap","transcriptions","icon","isTranscribable","done","progress","urlPreview","urlShow","urlDownload","viewerAttrs","hasMappedTemporaryFile","serverFileId","temporaryFile","getMappedTemporaryFile","isInCollection","temporaryFileId","hasOwn","getTranscription","preparedFile","flat","setTemporaryFileMapping","setTranscription","transcriptText","errorCode","currentFile","prepareDraft","draft","prepareInvitation","invited","isActive","originator","originatorId","canResend","recentFieldsConfig","CallsModel","call","RecentCallStatus","waiting","getCallByDialog","hasActiveCall","activeCall","joined","existingCall","addActiveCall","uuid","validateActiveCall","prepareActiveCall","updateActiveCall","deleteActiveCall","isObjectLike","associatedEntity","RecentModel","calls","recentCollection","unreadCollection","copilotCollection","channelCollection","collabCollection","taskCollection","pinned","liked","invitation","isFakeElement","isBirthdayPlaceholder","getRecentCollection","dialog","getUnreadCollection","getCopilotCollection","getChannelCollection","getCollabCollection","getTaskCollection","getSortedCollection","recentCollectionAsArray","messageA","messageB","needsBirthdayPlaceholder","isSelfChat","hasTodayMessage","needsVacationPlaceholder","getSortDate","getStartOfTheDay","lastActivity","needToUseActivityDate","ChannelManager","isChannel","isInRecentCollection","isInCollabCollection","isInTaskCollection","isInCopilotCollection","setRecent","itemIds","setUnread","setCopilot","setChannel","setCollab","setTask","clearChannelCollection","clearUnreadCollection","itemsToUpdate","itemsToAdd","preparedElement","action","like","isLastMessage","isExactMessageLiked","setDraft","addFakeItems","isRemovingDraft","existingCollectionItem","needsFakeItem","hide","canDelete","resetTasksUnreadStatus","resetUnreadStatus","setRecentCollection","setUnreadCollection","setCopilotCollection","deleteFromChannelCollection","setChannelCollection","setCollabCollection","setTaskCollection","elementIsInRecent","currentElement","deleteCollections","options","updateMethod","zeroedCountersForNewItems","isToday","NOT_DELETABLE_TYPES","openChannel","FakeDraftMessagePrefix","NotificationsModel","searchCollection","unreadCounter","title","replaces","notifyButtons","sectionCode","NotificationTypesCodes","read","settingName","sortByType","getSearchResultCollection","getConfirmsCount","confirm","notificationId","getSearchItemById","getCounter","initialSet","total_unread_count","isArrayFilled","validate","setSearchResult","skipValidation","readAllSimple","excludeIds","excludeIdsSet","idsToMarkAsRead","deleteFromSearch","clearSearchResult","addSearchResult","updateSearchResult","readAll","markAsRead","searchItem","decreaseCounter","increaseCounter","clear","author_id","isNil","notify_title","notify_buttons","JSON","parse","buttons","button","COMMAND","COMMAND_PARAMS","VALUE","TEXT","TITLE","TYPE","DISPLAY","BG_COLOR","TEXT_COLOR","notify_type","notify_read","setting_name","notify_module","sidebarLinksFieldsConfig","source","richData","richDataFieldsConfig","LinksModel","collectionSearch","counters","historyLimitExceededCollection","previewUrl","getChatState","getSize","hasNextPageSearch","getSearchResultCollectionSize","links","preparedLink","setSearch","clearSearch","setHasNextPage","hasCollection","setHasNextPageSearch","setHistoryLimitExceeded","addSearch","hasCollectionSearch","sidebarFavoritesFieldsConfig","FavoritesModel","isFavoriteMessage","chatFavorites","fromEntries","targetMessage","getSearchResultCollectionLastId","favorites","favorite","preparedFavoriteMessage","deleteByMessageId","targetLinkId","linkId","linkObject","setLastId","setLastIdSearch","MembersModel","nextCursor","getNextCursor","getInited","setNextCursor","setInited","MessageSearchModel","sidebarTaskFieldsConfig","taskFieldsConfig","TasksModel","task","creatorId","responsibleId","statusTitle","deadline","preparedTask","sidebarMeetingFieldsConfig","meetingFieldsConfig","MeetingsModel","meeting","dateFrom","dateTo","meetings","preparedMeeting","sidebarFilesFieldsConfig","group","getLatest","rootState","rootGetters","media","audio","briefs","SidebarFileGroups","brief","sortedFlatCollection","getTopThreeCompletedFiles","getLatestUnsorted","unsorted","fileUnsorted","sortedCollection","sidebarFile","slice","sidebarMultidialogFieldsConfig","String","MultidialogModel","isInited","isInitedDetail","chatsCount","unreadChats","openSessionsLimit","multidialogs","getOpenSessionsLimit","getChatsCount","getTotalChatCounter","count","isSupportChat","getNumberMultidialogs","getMultidialogsByStatus","multidialog","setInitedDetail","addMultidialogs","preparedTicket","setOpenSessionsLimit","setChatsCount","setUnreadChats","deleteUnreadChats","addMultidialog","SidebarModel","members","messageSearch","initedList","isFilesMigrated","isLinksMigrated","hasHistoryLimit","limitsByPanel","getterName","hasLimit","setFilesMigrated","setLinksMigrated","MarketModel","placementCollection","PlacementType","contextMenu","navigation","textarea","sidebar","smilesSelector","context","iconName","placement","order","loadConfiguration","ID","PLACEMENT","PLACEMENT_ID","getByPlacement","appIds","setPlacementCollection","setCollection","app","configuration","CountersModel","unloadedChatCounters","unloadedLinesCounters","unloadedCopilotCounters","unloadedCollabCounters","unloadedTaskCounters","commentCounters","getUnloadedChatCounters","loadedChatsCounter","unloadedChatsCounter","channelCommentsCounter","getTotalCopilotCounter","getTotalCollabCounter","getTotalTaskCounter","getTotalLinesCounter","unloadedLinesCounter","getSpecificLinesCounter","getTotalCommentsCounter","totalCounter","channelChatId","channelCounters","channel","commentCounter","getChannelComments","getChannelCommentsCounter","getChatCounterByChatId","recentItem","getSpecificCommentsCounter","channelId","commentChatId","setUnloadedChatCounters","setUnloadedLinesCounters","setUnloadedCopilotCounters","setUnloadedCollabCounters","setUnloadedTaskCounters","setCommentCounters","readAllChannelComments","deleteForChannel","clearUnloadedTaskCounters","countersMap","channelMap","isMarked","recentItemCounter","copilotFieldsConfig","AI_MODEL_DEFAULT_NAME","aiModel","reasoningEnabled","getRole","getRoleAvatar","getAIModel","aiModelList","currentAiModel","isReasoningEnabled","chatsToAdd","preparedChats","updateModel","toggleReasoning","messagesFieldsConfig","roleCode","getPrompts","getAvatar","preparedMessage","rolesFieldsConfig","avatarFieldsConfig","prompt","promptsFieldsConfig","AvatarSizes","freeze","S","M","L","RolesModel","roles","desc","small","medium","large","prompts","getByCode","getDefault","getDefaultAvatar","avatarSize","preparedRole","RECOMMENDED_ROLES_LIMIT","CopilotModel","chats","recommendedRoles","aiProvider","availableAIModels","getProvider","getAIModels","getRecommendedRoles","getDefaultModelName","allModels","defaultModel","model","isReasoningAvailableInModel","supportsReasoning","setRecommendedRoles","setProvider","setAvailableAIModels","setAvailableAIModel","AiAssistantModel","mcpAuthId","getMcpAuthId","setMcpAuthId","stickerFieldsConfig","recentStickerConfig","RECENT_LIMIT","RecentStickersModel","packId","packType","recentSticker","sticker","preparedRecentSticker","firstSticker","secondSticker","stickerMessagesConfig","StickerMessagesModel","isSticker","getStickerByMessageId","preparedStickerMessage","tempMessageStickerIdentifier","stickerMessage","packFieldsConfig","PacksModel","isAdded","getAddedPacks","pack","getByIdentifier","packKey","hasPack","preparedPack","addNew","rename","unlink","StickersModel","packs","uri","stickerKey","getByPack","sticker1","sticker2","getPackCover","packsStickers","preparedSticker","deleteByPack","rawSticker"],"mappings":"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"}