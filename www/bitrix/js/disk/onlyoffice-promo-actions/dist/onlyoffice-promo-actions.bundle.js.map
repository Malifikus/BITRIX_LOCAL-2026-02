{"version":3,"file":"onlyoffice-promo-actions.bundle.js","sources":["../src/onlyoffice-promo-actions.js"],"sourcesContent":["import { Extension } from 'main.core';\nimport { InfoHelper } from 'ui.info-helper';\nimport { Form } from 'ui.feedback.form';\nimport { Factory } from 'disk.promo-boost';\n\nexport class OnlyOfficePromoActions\n{\n\taction: ?any = null;\n\n\tconstructor()\n\t{\n\t\tthis.action = this.#getExtensionParam('action');\n\t\tthis.documentEditSessionLimit = BX.Disk.OnlyOfficeSessionRestrictions.DocumentEditSessionLimit.getInstance();\n\t}\n\n\tshouldShow(): boolean\n\t{\n\t\treturn this.#isActionDefined()\n\t\t\t&& (this.#canEditBeRestrictedByTariff() || this.documentEditSessionLimit.isExceeded());\n\t}\n\n\t#canEditBeRestrictedByTariff(): boolean\n\t{\n\t\treturn !this.#getExtensionParam('canUseEditByTariff');\n\t}\n\n\tshow(target, needOverlay: boolean): void\n\t{\n\t\tif (!this.#isActionDefined())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst actionType = this.action?.type;\n\n\t\tswitch (actionType)\n\t\t{\n\t\t\tcase 'slider':\n\t\t\t\tthis.#showSlider();\n\t\t\t\tbreak;\n\t\t\tcase 'form':\n\t\t\t\tthis.#showForm();\n\t\t\t\tbreak;\n\t\t\tcase 'boost':\n\t\t\t\tthis.#showBoostPromo(target, needOverlay);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.error(`Unknown promo action type: ${actionType}`);\n\t\t}\n\t}\n\n\t#isActionDefined(): boolean\n\t{\n\t\treturn this.action !== null;\n\t}\n\n\t#showSlider(): void\n\t{\n\t\tconst sliderCode = this.action?.code || '';\n\t\tif (sliderCode === '')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tInfoHelper.show(sliderCode);\n\t}\n\n\t#showForm(): void\n\t{\n\t\tForm.open(this.action.params);\n\t}\n\n\t#showBoostPromo(target, needOverlay): void\n\t{\n\t\tif (target)\n\t\t{\n\t\t\tconst widget = Factory.getSessionBoostWidget()\n\t\t\t\t.bindTo(target);\n\n\t\t\tif (needOverlay)\n\t\t\t{\n\t\t\t\twidget.setOverlay();\n\t\t\t}\n\n\t\t\twidget.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error('OnlyofficePromoActions: target is not defined for boost promo action');\n\t\t}\n\t}\n\n\t#getExtensionParam(paramName: string): any\n\t{\n\t\treturn Extension.getSettings('disk.onlyoffice-promo-actions').get(paramName);\n\t}\n}\n"],"names":["this","action","sliderCode","_this$action2","code","InfoHelper","show","Form","open","params","target","needOverlay","widget","Factory","getSessionBoostWidget","bindTo","setOverlay","console","error","paramName","Extension","getSettings","get","constructor","Object","value","documentEditSessionLimit","BX","Disk","OnlyOfficeSessionRestrictions","DocumentEditSessionLimit","getInstance","shouldShow","babelHelpers","isExceeded","actionType","_this$action","type"],"mappings":"mFAG2C,6WA6F1C,aAzEC,+CAAQA,WAAwB,sBAChC,aA6BA,OAAuB,OAAhBA,KAAKC,OACZ,aAGD,MACC,MAAMC,iBAAkBD,eAALE,EAAaC,OAAQ,GACrB,KAAfF,GAKJG,aAAWC,KAAKJ,GAChB,aAIAK,OAAKC,KAAKR,KAAKC,OAAOQ,QACtB,WAEeC,EAAQC,GAEvB,GAAID,EACJ,CACC,MAAME,EAASC,UAAQC,wBACrBC,OAAOL,GAELC,GAEHC,EAAOI,aAGRJ,EAAON,YAIPW,QAAQC,MAAM,wEAEf,WAEkBC,GAElB,OAAOC,YAAUC,YAAY,iCAAiCC,IAAIH,4BAzF7D,MAINI,cACAC,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAD,8BAAAC,UAAAzB,KAHAC,OAAe,KAIdD,KAAKC,+CAASD,WAAwB,UACtCA,KAAK0B,yBAA2BC,GAAGC,KAAKC,8BAA8BC,yBAAyBC,cAGhGC,aAEC,OAAOC,uDACFA,sDAAuCjC,KAAK0B,yBAAyBQ,cAQ3E5B,KAAKI,EAAQC,GACb,MACC,4CAAKX,aAEJ,OAGD,MAAMmC,WAAanC,KAAKC,eAALmC,EAAaC,KAEhC,OAAQF,GAEP,IAAK,SACJF,qDACA,MACD,IAAK,OACJA,qDACA,MACD,IAAK,QACJA,mDAAqBvB,EAAQC,GAC7B,MACD,QACCM,QAAQC,MAAO,8BAA6BiB"}