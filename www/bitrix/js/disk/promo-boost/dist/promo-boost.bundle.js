this.BX=this.BX||{},this.BX.Disk=this.BX.Disk||{},function(e,s,t,i){"use strict";class a{static getSessionBoostServiceCode(){return this.getExtensionParam("sessionBoostServiceCode")}static getAvailableServices(){return this.getExtensionParam("availableServices")}static canDisplay(){return this.getExtensionParam("canDisplay")}static getExtensionParam(e){return i.Extension.getSettings("disk.promo-boost").get(e)}}class l{static isServiceAvailable(e){return a.getAvailableServices().includes(e)}static isSessionBoostAvailable(){return a.canDisplay()&&this.isServiceAvailable(a.getSessionBoostServiceCode())}static shouldShowPromoSessionBoost(){return this.isSessionBoostAvailable()&&t.DocumentEditSessionLimit.getInstance().isExceeded()}}var o=babelHelpers.classPrivateFieldLooseKey("instance"),r=babelHelpers.classPrivateFieldLooseKey("service"),b=babelHelpers.classPrivateFieldLooseKey("widgetInstance"),c=babelHelpers.classPrivateFieldLooseKey("getBaasWidget"),n=babelHelpers.classPrivateFieldLooseKey("errToConsole");class d{constructor(e){Object.defineProperty(this,n,{value:h}),Object.defineProperty(this,c,{value:v}),Object.defineProperty(this,r,{writable:!0,value:""}),Object.defineProperty(this,b,{writable:!0,value:null}),babelHelpers.classPrivateFieldLooseBase(this,r)[r]=e}static getInstance(e){return null===babelHelpers.classPrivateFieldLooseBase(this,o)[o]&&(babelHelpers.classPrivateFieldLooseBase(this,o)[o]=new d(e)),babelHelpers.classPrivateFieldLooseBase(this,o)[o]}bindTo(e){return babelHelpers.classPrivateFieldLooseBase(this,c)[c]().then(s=>{s.bind(e)}).catch(babelHelpers.classPrivateFieldLooseBase(this,n)[n]),this}show(){return babelHelpers.classPrivateFieldLooseBase(this,c)[c]().then(e=>{if(e.getPopup().isShown()){const s=()=>{e.show(),e.getPopup().unsubscribe("onAfterClose",s)};e.getPopup().subscribe("onAfterClose",s)}else e.show()}).catch(babelHelpers.classPrivateFieldLooseBase(this,n)[n]),this}toggle(){return babelHelpers.classPrivateFieldLooseBase(this,c)[c]().then(e=>{e.toggle()}).catch(babelHelpers.classPrivateFieldLooseBase(this,n)[n]),this}setOverlay(){return babelHelpers.classPrivateFieldLooseBase(this,c)[c]().then(e=>{e.getPopup().setOverlay({opacity:0})}).catch(babelHelpers.classPrivateFieldLooseBase(this,n)[n]),this}}function v(){return null!==babelHelpers.classPrivateFieldLooseBase(this,b)[b]?Promise.resolve(babelHelpers.classPrivateFieldLooseBase(this,b)[b]):i.loadExt("baas.store").then(e=>(babelHelpers.classPrivateFieldLooseBase(this,b)[b]=e.ServiceWidget.getInstanceByCode(babelHelpers.classPrivateFieldLooseBase(this,r)[r]),babelHelpers.classPrivateFieldLooseBase(this,b)[b])).catch(e=>{const s="Baas extension not loaded! Original error: "+e.message;throw new Error(s)})}function h(e){console.error(e.message)}Object.defineProperty(d,o,{writable:!0,value:null});let p,P=e=>e;var B=babelHelpers.classPrivateFieldLooseKey("service"),u=babelHelpers.classPrivateFieldLooseKey("container"),L=babelHelpers.classPrivateFieldLooseKey("uninitialized"),F=babelHelpers.classPrivateFieldLooseKey("button"),H=babelHelpers.classPrivateFieldLooseKey("widget"),g=babelHelpers.classPrivateFieldLooseKey("checkServiceAvailability"),y=babelHelpers.classPrivateFieldLooseKey("renderTo"),f=babelHelpers.classPrivateFieldLooseKey("bindEvent"),S=babelHelpers.classPrivateFieldLooseKey("click"),O=babelHelpers.classPrivateFieldLooseKey("getButton");class w{constructor(e={}){var s;Object.defineProperty(this,O,{value:T}),Object.defineProperty(this,S,{value:E}),Object.defineProperty(this,f,{value:j}),Object.defineProperty(this,y,{value:K}),Object.defineProperty(this,g,{value:m}),Object.defineProperty(this,B,{writable:!0,value:null}),Object.defineProperty(this,u,{writable:!0,value:null}),Object.defineProperty(this,L,{writable:!0,value:!0}),Object.defineProperty(this,F,{writable:!0,value:null}),Object.defineProperty(this,H,{writable:!0,value:void 0}),babelHelpers.classPrivateFieldLooseBase(this,B)[B]=null!=(s=e.service)?s:"",babelHelpers.classPrivateFieldLooseBase(this,u)[u]=document.getElementById(e.containerId),babelHelpers.classPrivateFieldLooseBase(this,H)[H]=e.widget}init(){babelHelpers.classPrivateFieldLooseBase(this,L)[L]&&babelHelpers.classPrivateFieldLooseBase(this,g)[g]()&&(babelHelpers.classPrivateFieldLooseBase(this,L)[L]=!1,babelHelpers.classPrivateFieldLooseBase(this,y)[y]()&&babelHelpers.classPrivateFieldLooseBase(this,f)[f]())}showWidget(){babelHelpers.classPrivateFieldLooseBase(this,H)[H].bindTo(babelHelpers.classPrivateFieldLooseBase(this,O)[O]()),babelHelpers.classPrivateFieldLooseBase(this,H)[H].show()}setOverlayToWidget(){babelHelpers.classPrivateFieldLooseBase(this,H)[H].setOverlay()}}function m(){return l.isServiceAvailable(babelHelpers.classPrivateFieldLooseBase(this,B)[B])}function K(){return i.Type.isElementNode(babelHelpers.classPrivateFieldLooseBase(this,u)[u])||console.error("Disk: BoostButton: Container for service does not exist!"),i.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,O)[O](),babelHelpers.classPrivateFieldLooseBase(this,u)[u]),!0}function j(){i.Event.bind(babelHelpers.classPrivateFieldLooseBase(this,O)[O](),"click",babelHelpers.classPrivateFieldLooseBase(this,S)[S].bind(this))}function E(){babelHelpers.classPrivateFieldLooseBase(this,H)[H].bindTo(babelHelpers.classPrivateFieldLooseBase(this,O)[O]()),babelHelpers.classPrivateFieldLooseBase(this,H)[H].show()}function T(){if(!babelHelpers.classPrivateFieldLooseBase(this,F)[F]){const e=i.Loc.getMessage("DISK_PROMO_BOOST_BUTTON_TEXT");babelHelpers.classPrivateFieldLooseBase(this,F)[F]=i.Tag.render(p||(p=P`<button class="bx-disk-promo-boost-button"><span>${0}</span></button>`),e)}return babelHelpers.classPrivateFieldLooseBase(this,F)[F]}e.Button=w,e.Checker=l,e.Widget=d,e.Factory=class{static getSessionBoostButton(e){return new w({containerId:e,service:a.getSessionBoostServiceCode(),widget:this.getSessionBoostWidget()})}static getSessionBoostWidget(){return d.getInstance(a.getSessionBoostServiceCode())}}}(this.BX.Disk.PromoBoost=this.BX.Disk.PromoBoost||{},BX,BX.Disk.OnlyOfficeSessionRestrictions,BX);
//# sourceMappingURL=promo-boost.bundle.js.map
