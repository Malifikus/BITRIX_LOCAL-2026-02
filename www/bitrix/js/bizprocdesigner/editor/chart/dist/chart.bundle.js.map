{"version":3,"file":"chart.bundle.js","sources":["../src/entities/ai-assistant/api/pull.js","../src/entities/ai-assistant/util/animation.js","../src/shared/composables/feature.js","../src/shared/composables/loc.js","../src/shared/composables/property-dialog.js","../src/shared/constants/index.js","../src/entities/blocks/constants/index.js","../src/shared/api/index.js","../src/entities/blocks/utils/blocks.js","../src/entities/blocks/utils/constant-helpers.js","../src/entities/blocks/utils/validate-connection-rules.js","../src/entities/blocks/utils/normalyze-connection.js","../src/shared/utils/create-unique-id.js","../src/shared/utils/url.js","../src/shared/utils/response.js","../src/entities/blocks/stores/diagram.js","../src/entities/blocks/ui/block-diagram/block-diagram.js","../src/entities/blocks/ui/block-container/block-container.js","../src/shared/ui/icon-button/icon-button.js","../src/shared/ui/icon-divider/icon-divider.js","../src/shared/ui/loader/loader.js","../src/shared/ui/menu-button/menu-button.js","../src/shared/ui/split-button/split-button.js","../src/entities/blocks/ui/block-layout/block-layout.js","../src/entities/blocks/ui/block-switcher/block-switcher.js","../src/entities/blocks/ui/block-header/block-header.js","../src/entities/blocks/ui/block-icon/block-icon.js","../src/entities/blocks/ui/ports-inout-center/ports-inout-center.js","../src/entities/blocks/ui/block-status-not-published/block-status-not-published.js","../src/entities/blocks/ui/block-complex/block-complex.js","../src/entities/blocks/ui/block-top-title/block-top-title.js","../src/entities/blocks/ui/template-name-input/template-name-input.js","../src/entities/blocks/ui/autosave-status/autosave-status.js","../src/entities/blocks/ui/dropdown-menu-button/dropdown-menu-button.js","../src/entities/blocks/ui/dropdown-menu-option/dropdown-menu-option.js","../src/entities/blocks/ui/workflow-icon/workflow-icon.js","../src/entities/blocks/ui/person-icon/person-icon.js","../src/entities/blocks/ui/stop-icon/stop-icon.js","../src/entities/blocks/ui/connection-aux/connection-aux.js","../src/entities/node-settings/api.js","../src/entities/node-settings/constants/index.js","../src/entities/node-settings/utils/index.js","../src/entities/node-settings/stores/node-settings-store.js","../src/entities/node-settings/ui/node-settings-layout/node-settings-layout.js","../src/entities/node-settings/ui/node-settings-variable/node-settings-variable.js","../src/entities/node-settings/ui/node-settings-rule/node-settings-rule.js","../src/entities/node-settings/directives/drag-rule-entity.js","../src/entities/node-settings/ui/node-settings-rules-layout/node-settings-rules-layout.js","../src/entities/node-settings/ui/rule-card/rule-card.js","../src/entities/node-settings/ui/rule-construction/rule-construction.js","../src/entities/app/stores/app.js","../src/entities/app/ui/app-layout/app-layout.js","../src/entities/app/ui/app-header/app-header.js","../src/entities/app/ui/logo-layout/logo-layout.js","../src/entities/app/ui/logo-back-btn/logo-back-btn.js","../src/entities/app/ui/logo-title/logo-title.js","../src/entities/app/ui/app-header-divider/app-header-divider.js","../src/features/node-settings/ui/edit-node-settings-form/edit-node-settings-form.js","../src/features/node-settings/ui/add-settings-item/add-settings-item.js","../src/features/node-settings/ui/edit-action-expression/document-selector.js","../src/features/node-settings/ui/edit-action-expression/edit-action-expression.js","../src/entities/common-node-settings/stores/common-node-settings.js","../src/entities/common-node-settings/ui/common-settings-form/value-selector.js","../src/entities/common-node-settings/ui/common-settings-form/common-settings-form.js","../src/features/node-settings/ui/edit-condition-expression/const.js","../src/features/node-settings/ui/edit-condition-expression/field-selector.js","../src/features/node-settings/ui/edit-condition-expression/edit-condition-expression.js","../src/features/node-settings/ui/add-construction/add-construction.js","../src/features/node-settings/ui/delete-construction/delete-construction.js","../src/features/node-settings/ui/select-boolean-type/select-boolean-type.js","../src/features/node-settings/ui/select-rule/select-rule.js","../src/features/node-settings/ui/save-settings-button.js","../src/features/node-settings/ui/cancel-settings-button.js","../src/features/node-settings/ui/delete-rule-card/delete-rule-card.js","../src/features/node-settings/ui/edit-extanded-action.js","../src/widgets/node-settings/ui/node-settings.js","../src/features/node-settings/ui/edit-output-expression/edit-output-expression.js","../src/widgets/node-settings/ui/node-settings-rules.js","../src/entities/catalog/stores/catalog.js","../src/entities/catalog/constants/index.js","../src/entities/catalog/utils/slot-names.js","../src/entities/catalog/ui/catalog-layout/catalog-layout.js","../src/entities/catalog/ui/header-layout/header-layout.js","../src/entities/catalog/ui/burger-btn/burger-btn.js","../src/entities/catalog/ui/header-logo/header-logo.js","../src/entities/catalog/ui/text-input/text-input.js","../src/entities/catalog/ui/catalog-group/catalog-group.js","../src/entities/catalog/ui/catalog-group-empty-label/catalog-group-empty-label.js","../src/entities/catalog/ui/catalog-group-icon/catalog-group-icon.js","../src/entities/catalog/ui/catalog-item/catalog-item.js","../src/entities/catalog/ui/catalog-group-list/catalog-group-list.js","../src/entities/catalog/ui/catalog-group-back-btn/catalog-group-back-btn.js","../src/entities/catalog/ui/search-results-label/search-results-label.js","../src/entities/catalog/ui/search-results-layout/search-results-layout.js","../src/entities/catalog/ui/search-results-empty-label/search-results-empty-label.js","../src/shared/ui/search-bar/search-bar.js","../src/entities/ai-assistant/api/api.js","../src/widgets/blocks/ui/block-diagram/block-diagram.js","../src/features/blocks/ui/delete-block-icon-btn/delete-block-icon-btn.js","../src/features/blocks/ui/update-published-status-label/update-published-status-label.js","../src/features/blocks/ui/add-complex-block-port/add-complex-block-port.js","../src/features/blocks/ui/edit-template-name/edit-template-name.js","../src/features/blocks/ui/publish-dropdown-button/publish-dropdown-button.js","../src/features/blocks/ui/publish-main-dropdown-option/publish-main-dropdown-option.js","../src/features/blocks/ui/publish-user-dropdown-option/publish-user-dropdown-option.js","../src/features/blocks/ui/publish-full-dropdown-option/publish-full-dropdown-option.js","../src/features/blocks/ui/autosize-block-container/autosize-block-container.js","../src/widgets/blocks/lib/block-mediator.js","../src/widgets/blocks/ui/block-simple/block-simple.js","../src/widgets/blocks/ui/block-trigger/block-trigger.js","../src/widgets/blocks/ui/block-complex/block-complex.js","../src/widgets/blocks/ui/block-tool/block-tool.js","../src/widgets/blocks/ui/block-frame/block-frame.js","../src/widgets/blocks/ui/diagram-menu/diagram-menu.js","../src/widgets/blocks/ui/autosave-status/autosave-status.js","../src/features/blocks/ui/edit-template-settings-dialog/edit-template-settings-dialog.js","../src/widgets/blocks/ui/template-name/template-name.js","../src/widgets/blocks/ui/publish-dropdown-button/publish-dropdown-button.js","../src/widgets/common-node-settings/ui/common-node-settings/common-node-settings.js","../src/features/catalog/ui/fixed-catalog-burger-btn/fixed-catalog-burger-btn.js","../src/features/catalog/ui/hover-catalog-layout/hover-catalog-layout.js","../src/features/catalog/ui/search-catalog-items-input/search-catalog-items-input.js","../src/features/catalog/ui/change-catalog-group/change-catalog-group.js","../src/features/catalog/ui/back-to-groups-btn/back-to-groups-btn.js","../src/features/catalog/ui/change-founded-catalog-item/change-founded-catalog-item.js","../src/features/catalog/ui/change-founded-catalog-group/change-founded-catalog-group.js","../src/widgets/catalog/ui/catalog/catalog.js","../src/widgets/app/ui/app-layout/app-layout.js","../src/widgets/app/ui/app-header/app-header.js","../src/app.js","../src/main.js"],"sourcesContent":["import { PULL } from 'pull.client';\nimport type { Block, Connection } from '../../../shared/types';\n\ntype AiDraftPushData = {\n\ttemplateId: number,\n\tdraftId: number,\n\tblocks: Array<Block>,\n\tconnections: Array<Connection>,\n};\n\nexport function initAiUpdatePull(callback: (params: {\n\tblocks: Array<Block>,\n\tconnections: Array<Connection>,\n\ttemplateId: number,\n\tdraftId: number,\n}) => void): void\n{\n\tPULL.subscribe({\n\t\tmoduleId: 'bizprocdesigner',\n\t\tcommand: 'bizprocdesigner_ai_draft_updated',\n\t\tcallback: async (pushData: AiDraftPushData): Promise<void> => {\n\t\t\tcallback(pushData);\n\t\t},\n\t});\n}\n","import type { AnimationItem } from 'ui.block-diagram';\nimport { ANIMATED_TYPES } from 'ui.block-diagram';\n\nimport type { Block, Connection } from '../../../shared/types';\n\nfunction getConnectionKey(connection: Connection): string\n{\n\treturn `${connection.sourceBlockId}_${connection.sourcePortId}_${connection.targetBlockId}_${connection.targetPortId}`;\n}\n\nfunction isBlockConnection(connection: Connection, block: Block): boolean\n{\n\treturn connection.sourceBlockId === block.id || connection.targetBlockId === block.id;\n}\n\nfunction getConnectionMap(connections: Array<Connection>): Map<string, Connection>\n{\n\treturn new Map(\n\t\tconnections.map((conn: Connection): [string, Connection] => [getConnectionKey(conn), conn]),\n\t);\n}\n\nexport function makeAnimationQueue(\n\tcurrentBlocks: Array<Block>,\n\tcurrentConnections: Array<Connection>,\n\tnewBlocks: Array<Block>,\n\tnewConnections: Array<Connection>,\n): Array<AnimationItem>\n{\n\tconst animatedItems: Array<AnimationItem> = [];\n\n\tconst currentBlockMap: Map<string, Block> = new Map(currentBlocks.map((block) => [block.id, block]));\n\tconst newBlockMap: Map<string, Block> = new Map(newBlocks.map((block) => [block.id, block]));\n\tconst currentConnectionMap: Map<string, Connection> = getConnectionMap(currentConnections);\n\tconst newConnectionMap: Map<string, Connection> = getConnectionMap(newConnections);\n\tconst handledConnections: Set<string> = new Set();\n\n\t// Remove not present in new blocks\n\tfor (const [id: string, block: Block] of currentBlockMap.entries())\n\t{\n\t\tif (!newBlockMap.has(id))\n\t\t{\n\t\t\tanimatedItems.push({ type: ANIMATED_TYPES.REMOVE_BLOCK, item: block });\n\t\t\t// Remove block dependent connections\n\t\t\tfor (const [connectionId: string, conn: Connection] of currentConnectionMap.entries())\n\t\t\t{\n\t\t\t\tif (!handledConnections.has(connectionId) && isBlockConnection(conn, block))\n\t\t\t\t{\n\t\t\t\t\thandledConnections.add(connectionId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// remove other not present connections\n\tfor (const [connectionId: string, conn: Connection] of currentConnectionMap.entries())\n\t{\n\t\tif (!handledConnections.has(connectionId) && !newConnectionMap.has(connectionId))\n\t\t{\n\t\t\tanimatedItems.push({ type: ANIMATED_TYPES.REMOVE_CONNECTION, item: conn });\n\t\t\thandledConnections.add(connectionId);\n\t\t}\n\t}\n\n\t// Append new blocks\n\tfor (const [id: string, block: Block] of newBlockMap.entries())\n\t{\n\t\tif (!currentBlockMap.has(id))\n\t\t{\n\t\t\tanimatedItems.push({ type: ANIMATED_TYPES.BLOCK, item: block });\n\t\t\t// append dependent block connections\n\t\t\tfor (const [connectionId: string, conn: Connection] of newConnectionMap.entries())\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\t!currentConnectionMap.has(connectionId)\n\t\t\t\t\t&& !handledConnections.has(connectionId)\n\t\t\t\t\t&& isBlockConnection(conn, block)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tanimatedItems.push({ type: ANIMATED_TYPES.CONNECTION, item: conn });\n\t\t\t\t\thandledConnections.add(connectionId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// append new connections for existed blocks\n\tfor (const [connectionId: string, conn: Connection] of newConnectionMap.entries())\n\t{\n\t\tif (!currentConnectionMap.has(connectionId)\t&& !handledConnections.has(connectionId))\n\t\t{\n\t\t\tanimatedItems.push({ type: ANIMATED_TYPES.CONNECTION, item: conn });\n\t\t\thandledConnections.add(connectionId);\n\t\t}\n\t}\n\n\treturn animatedItems;\n}\n","import { Feature, type FeatureCodeType } from 'bizprocdesigner.feature';\n\nexport type UseFeature = {\n\tisFeatureAvailable: (featureCode: FeatureCodeType) => boolean,\n};\n\nexport function useFeature(): UseFeature\n{\n\treturn {\n\t\tisFeatureAvailable: (featureCode: FeatureCodeType): boolean => {\n\t\t\treturn Feature.instance().isAvailable(featureCode);\n\t\t},\n\t};\n}\n","import { getCurrentInstance } from 'ui.vue3';\n\nexport type MessageId = string;\nexport type Replacements = string;\n\nexport type GetMessage = (messageId: MessageId, replacements: Replacements) => string;\n\nexport type UseLoc = {\n\tgetMessage: GetMessage,\n};\n\nexport function useLoc(): UseLoc\n{\n\tconst app = getCurrentInstance()?.appContext.app;\n\tconst bitrix = app?.config?.globalProperties?.$bitrix ?? null;\n\n\treturn {\n\t\tgetMessage: (messageId: MessageId, replacements: Replacements): string => {\n\t\t\treturn bitrix?.Loc?.getMessage(messageId, replacements);\n\t\t},\n\t};\n}\n","import { Dom, Runtime, Tag, Type } from 'main.core';\n\nimport { useLoc } from './loc';\n\ntype FormPayload = {\n\tid: string,\n\tdocumentType: Array<string>,\n\tactivity: string,\n\tworkflow: {\n\t\tparameters: Array<{...}>,\n\t\tvariables: Array<{...}>,\n\t\ttemplate: Array<{...}>,\n\t\tconstants: Array<{...}>\n\t},\n};\n\nconst renderPropertyDialog = async (contentContainer: HTMLElement, formData: FormData): Promise<void> => {\n\tif (Type.isUndefined(window.rootActivity))\n\t{\n\t\treturn null;\n\t}\n\n\tconst { getMessage } = useLoc();\n\tconst contentUrl = `/bitrix/tools/bizproc_activity_settings.php?mode=public&bxpublic=Y&lang=${getMessage('LANGUAGE_ID')}&app=vue`;\n\tconst content = await fetch(contentUrl, {\n\t\tmethod: 'POST',\n\t\tbody: formData,\n\t});\n\tconst form = Tag.render`\n\t\t<form\n\t\t\tid=\"form-settings\"\n\t\t\tclass=\"bx-core-adm-dialog node-settings-form\"\n\t\t\tname=\"bx_popup_form\">\n\t\t</form>\n\t`;\n\tDom.append(form, contentContainer);\n\tawait Runtime.html(form, await content.text());\n\n\treturn form;\n};\n\nconst createFormData = ({ id, documentType, activity, workflow }: FormPayload): FormData => {\n\tconst { parameters, variables, template, constants } = workflow;\n\tconst postData = {\n\t\tid,\n\t\tdecode: 'Y',\n\t\tmodule_id: documentType[0],\n\t\tentity: documentType[1],\n\t\tdocument_type: documentType[2],\n\t\tactivity,\n\t\tarWorkflowParameters: JSON.stringify(parameters),\n\t\tarWorkflowVariables: JSON.stringify(variables),\n\t\tarWorkflowTemplate: JSON.stringify(template),\n\t\tarWorkflowConstants: JSON.stringify(constants),\n\t\tcurrent_site_id: 's1',\n\t\tcan_be_activated: 'Y',\n\t\t// eslint-disable-next-line @bitrix24/bitrix24-rules/no-bx\n\t\tsessid: BX.bitrix_sessid(),\n\t};\n\tconst dialog = new BX.CDialog({ // temporary dialog\n\t\tcontent: '<div class=\"for-camp\"></div>',\n\t\twidth: 400,\n\t\theight: 200,\n\t});\n\tdialog.Show();\n\tconst formData = new FormData();\n\tObject.entries(postData).forEach(([key, value]) => {\n\t\tformData.append(key, value);\n\t});\n\n\treturn formData;\n};\n\nexport function usePropertyDialog(): { createFormData: Function; renderPropertyDialog: Function }\n{\n\treturn {\n\t\tcreateFormData,\n\t\trenderPropertyDialog,\n\t};\n}\n","export const BLOCK_TYPES: { [string]: string } = {\n\tSIMPLE: 'simple',\n\tTRIGGER: 'trigger',\n\tCOMPLEX: 'complex',\n\tTOOL: 'tool',\n\tFRAME: 'frame',\n};\n\nexport const PORT_TYPES = Object.freeze({\n\tinput: 'input',\n\toutput: 'output',\n\taux: 'aux',\n\ttopAux: 'topAux',\n});\n\nexport const ACTIVATION_STATUS = Object.freeze({\n\tACTIVE: 'Y',\n\tINACTIVE: 'N'\n});\n","export const BLOCK_TYPES: { [string]: string } = {\n\tSIMPLE: 'simple',\n\tTRIGGER: 'trigger',\n\tCOMPLEX: 'complex',\n\tFRAME: 'frame',\n\tTOOL: 'tool',\n};\n\nexport const BLOCK_SLOT_NAMES: { [string]: string } = {\n\tSIMPLE: `block:${BLOCK_TYPES.SIMPLE}`,\n\tTRIGGER: `block:${BLOCK_TYPES.TRIGGER}`,\n\tCOMPLEX: `block:${BLOCK_TYPES.COMPLEX}`,\n\tFRAME: `block:${BLOCK_TYPES.FRAME}`,\n\tTOOL: `block:${BLOCK_TYPES.TOOL}`,\n};\n\nexport const CONNECTION_SLOT_NAMES: { [string]: string } = {\n\tAUX: 'connection:aux',\n};\n\nexport const TEMPLATE_PUBLISH_STATUSES = {\n\tMAIN: 'main',\n\tUSER: 'user',\n\tFULL: 'full',\n};\n\nexport const BLOCK_COLOR_NAMES = {\n\tWHITE: 'white',\n\tORANGE: 'orange',\n\tBLUE: 'blue',\n};\n","import { ajax } from 'main.core';\nimport type { DiagramData, GetNodeSettingsControlsData, UpdateTemplateData } from '../types';\n\nconst post = async (action: string, data: Object): Promise => {\n\tconst response = await ajax.runAction(`bizprocdesigner.v2.${action}`, {\n\t\tmethod: 'POST',\n\t\tjson: data || {},\n\t});\n\n\tif (response.status === 'success')\n\t{\n\t\treturn response.data;\n\t}\n\n\treturn null;\n};\n\nconst editorAPI: {...} = {\n\tgetCatalogData: (): Promise<?Object> => {\n\t\treturn post('Catalog.get');\n\t},\n\tgetDiagramData: async (\n\t\tparams: {\n\t\t\ttemplateId: Number,\n\t\t\tdocumentType: ?Array,\n\t\t\tstartTrigger: ?string,\n\t\t},\n\t): Promise<?Object> => {\n\t\treturn post('Diagram.get', params);\n\t},\n\tupdateTemplateData: (data: UpdateTemplateData): Promise<?Object> => {\n\t\treturn post('Diagram.updateTemplate', data);\n\t},\n\tpublicDiagramData: (data: DiagramData): Promise<?Object> => {\n\t\treturn post('Diagram.publicate', data);\n\t},\n\tpublicDiagramDataDraft: (data: DiagramData): Promise<?Object> => {\n\t\treturn post('Diagram.publicateDraft', data);\n\t},\n\tgetNodeSettingsControls: (data: GetNodeSettingsControlsData): Promise<?Object> => {\n\t\treturn post('Activity.getSettingsControls', data);\n\t},\n\tsaveNodeSettings: (data: Object): Promise<?Object> => {\n\t\treturn post('Activity.SaveSettings', data);\n\t},\n};\n\nexport {\n\teditorAPI,\n\tpost,\n};\n","import { Type } from 'main.core';\nimport type { Block, BlockId } from '../../../shared/types';\n\nfunction deepEqual(a: any, b: any): boolean\n{\n\tif (a === b)\n\t{\n\t\treturn true;\n\t}\n\n\tif (!Type.isPlainObject(a) || !Type.isPlainObject(b))\n\t{\n\t\treturn false;\n\t}\n\n\tconst keysA = Object.keys(a);\n\tconst keysB = Object.keys(b);\n\tif (keysA.length !== keysB.length)\n\t{\n\t\treturn false;\n\t}\n\n\tfor (const key of keysA)\n\t{\n\t\tif (!deepEqual(a[key], b[key]))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nexport function isBlockPropertiesDifferent(currentBlock: Block, newBlock: Block): boolean\n{\n\tif (currentBlock.node.title !== newBlock.node.title)\n\t{\n\t\treturn true;\n\t}\n\n\tfor (const [key: string] of Object.entries(newBlock?.activity?.Properties ?? {}))\n\t{\n\t\tconst currentBlockProperty = currentBlock?.activity?.Properties?.[key] ?? null;\n\t\tconst newBlockProperty = newBlock.activity.Properties[key];\n\n\t\tif (!deepEqual(currentBlockProperty, newBlockProperty))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n\nexport function getBlockMap(blocks: Block[]): Map<BlockId, Block>\n{\n\treturn new Map(blocks.map((block: Block): [BlockId, Block] => [block.id, block]));\n}\n\nexport function getChangedPropertiesBlockIds(currentBlocks: Block[], newBlocks: Block[]): Set<BlockId>\n{\n\tconst currentBlocksMap: Map<BlockId, Block> = getBlockMap(currentBlocks);\n\tconst changedBlockIds: Set<BlockId> = new Set([]);\n\tfor (const newBlock: Block of newBlocks)\n\t{\n\t\tconst currentBlock: ?Block = currentBlocksMap.get(newBlock.id);\n\t\tif (currentBlock && isBlockPropertiesDifferent(currentBlock, newBlock))\n\t\t{\n\t\t\tchangedBlockIds.add(currentBlock.id);\n\t\t}\n\t}\n\n\treturn changedBlockIds;\n}\n\nexport function isBlockActivated(block: Block): boolean\n{\n\tif (!block?.activity?.Activated)\n\t{\n\t\treturn true;\n\t}\n\n\treturn block.activity.Activated !== 'N';\n}\n","import { Type } from 'main.core';\n\nfunction safeParse(input: string): any[] | null\n{\n\ttry\n\t{\n\t\treturn JSON.parse(input);\n\t}\n\tcatch (e)\n\t{\n\t\tconsole.error('JSON parse error', e);\n\n\t\treturn null;\n\t}\n}\n\nexport function parseItemsFromBlocksJson(input: any): Array<any>\n{\n\tlet blocks = input;\n\n\tif (Type.isStringFilled(input))\n\t{\n\t\tblocks = safeParse(input);\n\t}\n\n\tif (Type.isArray(blocks))\n\t{\n\t\treturn blocks.flatMap((block) => block.items || []);\n\t}\n\n\treturn [];\n}\n","import { PORT_TYPES } from '../../../shared/constants';\nimport type { DiagramNewConnection } from 'ui.block-diagram';\n\nexport const validationInputOutputRule = (newConnection: DiagramNewConnection): boolean => {\n\tconst { type: sourceType } = newConnection.sourcePort;\n\tconst { type: targetType } = newConnection.targetPort;\n\n\tconst isSourcePortInputOrOutput = sourceType === PORT_TYPES.input || sourceType === PORT_TYPES.output;\n\tconst isTargetPortInputOrOutput = targetType === PORT_TYPES.input || targetType === PORT_TYPES.output;\n\n\treturn isSourcePortInputOrOutput && isTargetPortInputOrOutput && sourceType !== targetType;\n};\n\nexport const validationAuxRule = (newConnection: DiagramNewConnection): boolean => {\n\tconst { type: sourceType } = newConnection.sourcePort;\n\tconst { type: targetType } = newConnection.targetPort;\n\n\tconst isSourcePortInputOrOutput = sourceType === PORT_TYPES.aux || sourceType === PORT_TYPES.topAux;\n\tconst isTargetPortInputOrOutput = targetType === PORT_TYPES.aux || targetType === PORT_TYPES.topAux;\n\n\treturn isSourcePortInputOrOutput && isTargetPortInputOrOutput && sourceType !== targetType;\n};\n","import { PORT_TYPES } from '../../../shared/constants';\nimport type { DiagramNewConnection, DiagramAddConnection } from 'ui.block-diagram';\n\nconst AUX = 'aux';\n\nexport function normalyzeInputOutputConnection(newConnection: DiagramNewConnection): DiagramAddConnection\n{\n\tconst {\n\t\tsourceBlockId,\n\t\tsourcePortId,\n\t\tsourcePort,\n\t\ttargetBlockId,\n\t\ttargetPortId,\n\t} = newConnection;\n\n\tif (sourcePort.type === PORT_TYPES.output)\n\t{\n\t\treturn {\n\t\t\tsourceBlockId,\n\t\t\tsourcePortId,\n\t\t\ttargetBlockId,\n\t\t\ttargetPortId,\n\t\t};\n\t}\n\n\treturn {\n\t\tsourceBlockId: targetBlockId,\n\t\tsourcePortId: targetPortId,\n\t\ttargetBlockId: sourceBlockId,\n\t\ttargetPortId: sourcePortId,\n\t};\n}\n\nexport function normalyzeAuxConnection(newConnection: DiagramNewConnection): DiagramAddConnection\n{\n\tconst {\n\t\tsourceBlockId,\n\t\tsourcePortId,\n\t\tsourcePort,\n\t\ttargetBlockId,\n\t\ttargetPortId,\n\t} = newConnection;\n\n\tif (sourcePort.type === PORT_TYPES.aux)\n\t{\n\t\treturn {\n\t\t\tsourceBlockId,\n\t\t\tsourcePortId,\n\t\t\ttargetBlockId,\n\t\t\ttargetPortId,\n\t\t\ttype: AUX,\n\t\t};\n\t}\n\n\treturn {\n\t\tsourceBlockId: targetBlockId,\n\t\tsourcePortId: targetPortId,\n\t\ttargetBlockId: sourceBlockId,\n\t\ttargetPortId: sourcePortId,\n\t\ttype: AUX,\n\t};\n}\n","export const createUniqueId = (): string => {\n\tconst randomNumber = (): number => Math.floor(1000 + Math.random() * 9000);\n\n\treturn `A${randomNumber()}_${randomNumber()}_${randomNumber()}_${randomNumber()}`;\n};\n","export function updateIdUrl(templateId): void\n{\n\tconst url = new URL(window.location.href);\n\turl.searchParams.set('ID', templateId);\n\turl.searchParams.delete('START_TRIGGER');\n\thistory.replaceState(null, '', url.toString());\n}\n","import { UI } from 'ui.notification';\nimport { Text } from 'main.core';\n\nexport function handleResponseError(response: Response): void\n{\n\tif (response.errors?.length > 0)\n\t{\n\t\tconst [error] = response.errors;\n\n\t\tUI.Notification.Center.notify({\n\t\t\tcontent: Text.encode(error.message),\n\t\t\tautoHideDelay: 4000,\n\t\t});\n\t}\n\telse\n\t{\n\t\tconsole.error(response);\n\t}\n}\n","import { Type, Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { defineStore } from 'ui.vue3.pinia';\nimport { UI } from 'ui.notification';\n\nimport { editorAPI } from '../../../shared/api';\nimport { getBlockMap, isBlockPropertiesDifferent } from '../utils';\nimport { handleResponseError } from '../../../shared/utils';\nimport { TEMPLATE_PUBLISH_STATUSES } from '../constants';\nimport { parseItemsFromBlocksJson } from '../utils/constant-helpers';\n\nimport type {\n\tActivityData,\n\tBlock,\n\tBlockId,\n\tDiagramData,\n\tConnection,\n\tPortId,\n\tPort,\n\tDiagramTemplate,\n} from '../../../shared/types';\nimport { PORT_TYPES } from '../../../shared/constants';\n\nexport type PortType = 'input' | 'output' | 'aux' | 'top_aux';\n\ntype PortParams = {\n\tportId: PortId,\n\ttype: PortType,\n\tlabel: string,\n\tportTitle?: string,\n};\n\nconst PORT_LABELS = Object.freeze({\n\tinput: 'G',\n\toutput: 'E',\n});\n\nconst PORT_POSITIONS = Object.freeze({\n\tleft: 'left',\n\tright: 'right',\n});\n\nconst BLOCK_TYPES = {\n\tSetupTemplateActivity: 'SetupTemplateActivity',\n};\n\nexport const diagramStore = defineStore('bizprocdesigner-editor-diagram', {\n\tstate: (): DiagramData => ({\n\t\ttemplateId: 0,\n\t\tdraftId: 0,\n\t\tdocumentType: [],\n\t\tdocumentTypeSigned: '',\n\t\tcompanyName: '',\n\t\ttemplate: {},\n\t\tblocks: [],\n\t\tconnections: [],\n\t\tisOnline: true,\n\t\tblockCurrentTimestamps: {},\n\t\tblockSavedTimestamps: {},\n\t\ttemplatePublishStatus: TEMPLATE_PUBLISH_STATUSES.MAIN,\n\t}),\n\tgetters: {\n\t\tdiagramData: (state): DiagramData => ({\n\t\t\ttemplateId: state.templateId,\n\t\t\tdraftId: state.draftId,\n\t\t\tdocumentType: state.documentType,\n\t\t\tdocumentTypeSigned: state.documentTypeSigned,\n\t\t\tcompanyName: state.companyName,\n\t\t\ttemplate: state.template,\n\t\t\tblocks: state.blocks,\n\t\t\tconnections: state.connections,\n\t\t\tisOnline: state.isOnline,\n\t\t\tblockCurrentTimestamps: state.blockCurrentTimestamps,\n\t\t\tblockSavedTimestamps: state.blockSavedTimestamps,\n\t\t}),\n\t},\n\tactions: {\n\t\tinitEventListeners(): void\n\t\t{\n\t\t\tEventEmitter.subscribe(\n\t\t\t\t'Bizproc:onConstantsUpdated',\n\t\t\t\tthis.updateTemplateConstants.bind(this),\n\t\t\t);\n\t\t},\n\t\tgetBlockAncestors(block: Block): Array<Block>\n\t\t{\n\t\t\tconst inputs = this.getInputConnections(block);\n\n\t\t\treturn inputs.map(\n\t\t\t\t(connection) => this.blocks.find((b) => b.id === connection.sourceBlockId),\n\t\t\t);\n\t\t},\n\t\tgetBlockAncestorsByInputPortId(block: Block, portId: PortId): Array<Block>\n\t\t{\n\t\t\treturn this.getInputConnections(block)\n\t\t\t\t.filter((connection) => connection.targetPortId === portId)\n\t\t\t\t.map((connection) => this.blocks.find((b) => b.id === connection.sourceBlockId))\n\t\t\t;\n\t\t},\n\t\tgetInputConnections(block: Block): Array<Connection>\n\t\t{\n\t\t\treturn this.connections.filter((connection) => connection.targetBlockId === block.id);\n\t\t},\n\t\tgetAllBlockAncestors(block: Block, targetPortId: ?PortId): Array<Block>\n\t\t{\n\t\t\tconst stack = [];\n\t\t\tconst blocks = new Map([[block.id, block]]);\n\t\t\tlet inputs = this.getInputConnections(block);\n\t\t\tif (targetPortId)\n\t\t\t{\n\t\t\t\tinputs = inputs.filter((connection) => connection.targetPortId === targetPortId);\n\t\t\t}\n\t\t\tstack.push(...inputs);\n\n\t\t\twhile (stack.length > 0)\n\t\t\t{\n\t\t\t\tconst connection = stack.shift();\n\t\t\t\tthis.blocks.filter((b) => b.id === connection.sourceBlockId).forEach((b) => {\n\t\t\t\t\tif (!blocks.has(b.id))\n\t\t\t\t\t{\n\t\t\t\t\t\tblocks.set(b.id, b);\n\t\t\t\t\t\tstack.push(...this.getInputConnections(b));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tblocks.delete(block.id);\n\n\t\t\treturn [...blocks.values()];\n\t\t},\n\t\tasync refreshDiagramData(\n\t\t\tparams: {\n\t\t\t\ttemplateId: Number,\n\t\t\t\tdocumentType: ?Array,\n\t\t\t\tstartTrigger: ?string,\n\t\t\t},\n\t\t): Promise<void>\n\t\t{\n\t\t\tconst diagramData = await editorAPI.getDiagramData(params);\n\t\t\tthis.templateId = diagramData?.templateId ?? 0;\n\t\t\tthis.draftId = diagramData?.draftId ?? 0;\n\t\t\tthis.companyName = diagramData?.companyName ?? '';\n\t\t\tthis.documentType = diagramData?.documentType ?? [];\n\t\t\tthis.documentTypeSigned = diagramData?.documentTypeSigned ?? '';\n\t\t\tthis.template = diagramData?.template ?? {};\n\t\t\tthis.blocks = this.normalyzeBlocks(diagramData?.blocks ?? []);\n\t\t\tthis.setConnections(diagramData?.connections ?? []);\n\n\t\t\tfor (const block of this.blocks)\n\t\t\t{\n\t\t\t\tconst now = Date.now();\n\t\t\t\tthis.blockCurrentTimestamps[block.id] = block.node.updated ?? now;\n\t\t\t\tthis.blockSavedTimestamps[block.id] = block.node.published ?? now;\n\t\t\t}\n\t\t},\n\t\tnormalyzeBlocks(blocks: Array<Block>): Array<Block>\n\t\t{\n\t\t\treturn blocks.map((block) => {\n\t\t\t\tconst groupedPorts = Object.entries(block.ports)\n\t\t\t\t\t.reduce((portsMap, [type, ports]) => {\n\t\t\t\t\t\tportsMap[type] = ports?.map((port) => ({ ...port, type })) ?? [];\n\n\t\t\t\t\t\treturn portsMap;\n\t\t\t\t\t}, {});\n\n\t\t\t\treturn {\n\t\t\t\t\t...block,\n\t\t\t\t\tports: groupedPorts,\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t\tgetDeleteHandlerForBlockType(blockType: string): ?Function\n\t\t{\n\t\t\tif (blockType === BLOCK_TYPES.SetupTemplateActivity)\n\t\t\t{\n\t\t\t\treturn this.handleDeletingConstants;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\thandleDeletingConstants(block: Block): void\n\t\t{\n\t\t\tconst rawConstants = block.activity?.Properties?.blocks;\n\t\t\tconst constants = this.template?.CONSTANTS;\n\n\t\t\tif (!constants)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst items = parseItemsFromBlocksJson(rawConstants);\n\n\t\t\titems\n\t\t\t\t.filter((item) => item?.itemType === 'constant' && item.id in constants)\n\t\t\t\t.forEach((item) => {\n\t\t\t\t\tdelete constants[item.id];\n\t\t\t\t});\n\t\t},\n\t\tdeleteConnectionByBlockIdAndPortId(blockId, portId): void\n\t\t{\n\t\t\tthis.connections = this.connections.filter((connection) => {\n\t\t\t\tconst {\n\t\t\t\t\tsourceBlockId,\n\t\t\t\t\tsourcePortId,\n\t\t\t\t\ttargetBlockId,\n\t\t\t\t\ttargetPortId,\n\t\t\t\t} = connection;\n\t\t\t\tconst isSource = sourceBlockId === blockId && sourcePortId === portId;\n\t\t\t\tconst isTarget = targetBlockId === blockId && targetPortId === portId;\n\n\t\t\t\treturn !isSource && !isTarget;\n\t\t\t});\n\t\t},\n\t\tdeleteBlockById(blockId): void\n\t\t{\n\t\t\tconst blockIndex = this.blocks.findIndex((block) => block.id === blockId);\n\n\t\t\tif (blockIndex === -1)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst blockToDelete = this.blocks[blockIndex];\n\t\t\tconst blockType = blockToDelete.activity?.Type;\n\n\t\t\tconst handler = this.getDeleteHandlerForBlockType(blockType);\n\n\t\t\tif (handler)\n\t\t\t{\n\t\t\t\thandler.call(this, blockToDelete);\n\t\t\t}\n\t\t\tObject.values(this.blocks[blockIndex].ports)\n\t\t\t\t.filter((ports): boolean => Type.isArray(ports))\n\t\t\t\t.forEach((ports: Array<Port>): void => {\n\t\t\t\t\tports.forEach(({ id }): void => {\n\t\t\t\t\t\tthis.deleteConnectionByBlockIdAndPortId(blockId, id);\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\tthis.blocks.splice(blockIndex, 1);\n\t\t},\n\t\tsetBlockCurrentTimestamp(block: Block): void\n\t\t{\n\t\t\tthis.blockCurrentTimestamps[block.id] = Date.now();\n\t\t},\n\t\tupdateBlockActivityField(id: string, activity: ActivityData): void\n\t\t{\n\t\t\tconst block = this.blocks.find((b) => b.id === id);\n\t\t\tif (block)\n\t\t\t{\n\t\t\t\tblock.activity = activity;\n\t\t\t}\n\t\t\tthis.updateBlockTimestamp(block);\n\t\t},\n\t\tupdateBlockId(oldId: string, newId: string): void\n\t\t{\n\t\t\tif (oldId === newId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst block = this.blocks.find((b) => b.id === oldId);\n\n\t\t\tif (block)\n\t\t\t{\n\t\t\t\tthis.blockCurrentTimestamps[newId] = this.blockCurrentTimestamps[block.id];\n\t\t\t\tthis.blockSavedTimestamps[newId] = this.blockSavedTimestamps[block.id];\n\n\t\t\t\tdelete this.blockCurrentTimestamps[block.id];\n\t\t\t\tdelete this.blockSavedTimestamps[block.id];\n\n\t\t\t\tblock.id = newId;\n\t\t\t}\n\n\t\t\tthis.connections.forEach((connection, index) => {\n\t\t\t\tlet updated = false;\n\n\t\t\t\tif (connection.sourceBlockId === oldId)\n\t\t\t\t{\n\t\t\t\t\tthis.connections[index].sourceBlockId = newId;\n\t\t\t\t\tupdated = true;\n\t\t\t\t}\n\n\t\t\t\tif (connection.targetBlockId === oldId)\n\t\t\t\t{\n\t\t\t\t\tthis.connections[index].targetBlockId = newId;\n\t\t\t\t\tupdated = true;\n\t\t\t\t}\n\n\t\t\t\tif (updated)\n\t\t\t\t{\n\t\t\t\t\tthis.connections[index].id = `${this.connections[index].sourceBlockId}_${this.connections[index].targetBlockId}`;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tupdateTitle(newTitle: string): void\n\t\t{\n\t\t\tthis.template.NAME = newTitle;\n\t\t},\n\t\tupdateDescription(newDescription: string): void\n\t\t{\n\t\t\tthis.template.DESCRIPTION = newDescription;\n\t\t},\n\t\tupdateTemplateId(templateId: number): void\n\t\t{\n\t\t\tthis.templateId = templateId;\n\t\t},\n\t\tsetBlocks(blocks: Block[]): void\n\t\t{\n\t\t\tthis.blocks = blocks;\n\t\t},\n\t\tsetConnections(connections: []): void\n\t\t{\n\t\t\tthis.connections = connections;\n\t\t},\n\t\tsetBlockUnpublished(needBlock: Block)\n\t\t{\n\t\t\tconst blockIndex = this.blocks.findIndex((block) => block.id === needBlock.id);\n\n\t\t\tif (blockIndex === -1)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.blocks[blockIndex].node.publicationState = false;\n\t\t},\n\t\tsetInputPorts(block: Block, inputPorts: Array<Port>): void\n\t\t{\n\t\t\tObject.assign(block.ports, { input: inputPorts });\n\t\t},\n\t\tasync updateTemplateData(data: DiagramTemplate)\n\t\t{\n\t\t\tawait editorAPI.updateTemplateData({\n\t\t\t\ttemplateId: this.templateId,\n\t\t\t\tdata,\n\t\t\t});\n\t\t},\n\t\tasync publicDraft()\n\t\t{\n\t\t\tconst requestData = {\n\t\t\t\t...this.diagramData,\n\t\t\t\tblocks: this.blocks.map((block) => ({\n\t\t\t\t\t...block,\n\t\t\t\t\tnode: {\n\t\t\t\t\t\t...block.node,\n\t\t\t\t\t\tupdated: this.blockCurrentTimestamps[block.id],\n\t\t\t\t\t\tpublished: this.blockSavedTimestamps[block.id],\n\t\t\t\t\t},\n\t\t\t\t})),\n\t\t\t};\n\n\t\t\tconst { templateDraftId } = await editorAPI.publicDiagramDataDraft(requestData);\n\t\t\tif (Type.isNumber(templateDraftId))\n\t\t\t{\n\t\t\t\tthis.draftId = templateDraftId;\n\t\t\t}\n\t\t},\n\t\tasync publicTemplate()\n\t\t{\n\t\t\tconst requestData = {\n\t\t\t\t...this.diagramData,\n\t\t\t\tblocks: this.blocks.map((block) => ({\n\t\t\t\t\t...block,\n\t\t\t\t\tnode: {\n\t\t\t\t\t\t...block.node,\n\t\t\t\t\t\tupdated: null,\n\t\t\t\t\t\tpublished: null,\n\t\t\t\t\t},\n\t\t\t\t})),\n\t\t\t};\n\n\t\t\tconst { templateId } = await editorAPI.publicDiagramData(requestData);\n\t\t\tif (Type.isNumber(templateId))\n\t\t\t{\n\t\t\t\tthis.blockSavedTimestamps = { ...this.blockCurrentTimestamps };\n\t\t\t\tthis.templateId = templateId;\n\t\t\t\tthis.draftId = 0;\n\t\t\t}\n\t\t},\n\t\tupdateStatus(isOnline: boolean)\n\t\t{\n\t\t\tthis.isOnline = isOnline;\n\t\t},\n\t\tupdateBlockTimestamp(block)\n\t\t{\n\t\t\tthis.blockCurrentTimestamps[block.id] = Date.now();\n\t\t},\n\t\tsetBlockCurrentTimestamps(blockCurrentTimestamps)\n\t\t{\n\t\t\tObject.assign(this.blockCurrentTimestamps, blockCurrentTimestamps);\n\t\t},\n\t\tupdateExistedBlockProperties(newBlocks: Block[]): void\n\t\t{\n\t\t\tconst currentBlockMap: Map<BlockId, Block> = getBlockMap(this.blocks);\n\t\t\tfor (const newBlock: Block of newBlocks)\n\t\t\t{\n\t\t\t\tconst currentBlock: ?Block = currentBlockMap.get(newBlock.id);\n\t\t\t\tif (\n\t\t\t\t\tcurrentBlock\n\t\t\t\t\t&& currentBlock.activity\n\t\t\t\t\t&& currentBlock.activity.Properties\n\t\t\t\t\t&& isBlockPropertiesDifferent(currentBlock, newBlock)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tfor (const [key: string] of Object.entries(newBlock.activity.Properties))\n\t\t\t\t\t{\n\t\t\t\t\t\tcurrentBlock.activity.Properties[key] = newBlock.activity.Properties[key];\n\t\t\t\t\t}\n\t\t\t\t\tcurrentBlock.node.title = newBlock.node.title;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tupdateNodeTitle(block: Block, title: string): void\n\t\t{\n\t\t\tObject.assign(block.node, { title });\n\t\t},\n\t\tcreatePort(ports: Array<Port>, { portId, type, label, portTitle }: PortParams): Port\n\t\t{\n\t\t\tconst lastPort = ports[ports.length - 1] ?? null;\n\t\t\tconst [, count] = (lastPort?.title?.split(label) ?? []);\n\t\t\tconst title = portTitle ?? `${label}${Number(count ?? 0) + 1}`;\n\n\t\t\treturn {\n\t\t\t\tid: portId,\n\t\t\t\ttitle,\n\t\t\t\ttype,\n\t\t\t\tposition: type === PORT_TYPES.input ? PORT_POSITIONS.left : PORT_POSITIONS.right,\n\t\t\t};\n\t\t},\n\t\taddRulePort(blockId: BlockId, portId: string, type: PortType, portTitle: ?string): void\n\t\t{\n\t\t\tconst block = this.blocks.find((b) => b.id === blockId);\n\t\t\tif (!block)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { ports } = block;\n\t\t\tlet currentPorts = ports.input;\n\t\t\tlet label = PORT_LABELS.input;\n\t\t\tif (type === PORT_TYPES.output)\n\t\t\t{\n\t\t\t\tcurrentPorts = ports.output;\n\t\t\t\tlabel = PORT_LABELS.output;\n\t\t\t}\n\n\t\t\tconst rulePorts = currentPorts.filter((p) => !p.isConnectionPort);\n\t\t\tconst port = this.createPort(rulePorts, { portId, type, label, portTitle });\n\t\t\tcurrentPorts.push(port);\n\t\t},\n\t\taddConnectionPort(blockId: BlockId, portId: string, type: PortType): void\n\t\t{\n\t\t\tconst block = this.blocks.find((b) => b.id === blockId);\n\t\t\tif (!block)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { ports } = block;\n\t\t\tconst currentPorts = type === PORT_TYPES.input ? ports.input : ports.output;\n\t\t\tconst connectionPorts = currentPorts.filter((p) => p.isConnectionPort);\n\t\t\tconst port = this.createPort(connectionPorts, { portId, type, label: 'NG' });\n\t\t\tcurrentPorts.push({ ...port, isConnectionPort: true });\n\t\t},\n\t\tdeletePort(blockId: BlockId, portId: string, type?: PortType): void\n\t\t{\n\t\t\tconst block = this.blocks.find((b) => b.id === blockId);\n\t\t\tif (!block)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { ports } = block;\n\t\t\tconst currentPorts = type === PORT_TYPES.output ? ports.output : ports.input;\n\n\t\t\tconst deletedPort = currentPorts.find((port) => portId === port.id);\n\t\t\tcurrentPorts.splice(currentPorts.indexOf(deletedPort), 1);\n\t\t},\n\t\tupdateTemplateConstants(event): void\n\t\t{\n\t\t\tconst { constantsToUpdate, deletedConstantIds } = event.getData();\n\n\t\t\tif (!this.template.CONSTANTS)\n\t\t\t{\n\t\t\t\tthis.template.CONSTANTS = {};\n\t\t\t}\n\n\t\t\tlet updatedConstants = { ...this.template.CONSTANTS };\n\n\t\t\tif (Type.isArrayFilled(deletedConstantIds))\n\t\t\t{\n\t\t\t\tfor (const id of deletedConstantIds)\n\t\t\t\t{\n\t\t\t\t\tdelete updatedConstants[id];\n\t\t\t\t}\n\t\t\t}\n\t\t\tupdatedConstants = {\n\t\t\t\t...updatedConstants,\n\t\t\t\t...constantsToUpdate,\n\t\t\t};\n\n\t\t\tthis.template.CONSTANTS = updatedConstants;\n\t\t},\n\t\tsetSizeAutosizedBlock(blockId: string, width: number, height: number): void\n\t\t{\n\t\t\tconst blockIndex = this.blocks.findIndex((block) => block.id === blockId);\n\n\t\t\tif (blockIndex < 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.blocks[blockIndex].dimensions.width = width;\n\t\t\tthis.blocks[blockIndex].dimensions.height = height;\n\t\t},\n\t\tasync toggleBlockActivation(blockId: BlockId, skipDraft: boolean = false): Promise<void>\n\t\t{\n\t\t\tconst block = this.blocks.find((b) => b.id === blockId);\n\t\t\tif (!block)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst newActivatedState = block.activity.Activated === 'Y' ? 'N' : 'Y';\n\t\t\tconst actionLabel =\tnewActivatedState === 'N'\n\t\t\t\t? (Loc.getMessage('BIZPROCDESIGNER_STORES_DIAGRAM_ACTIVATE_OFF') ?? '')\n\t\t\t\t: (Loc.getMessage('BIZPROCDESIGNER_STORES_DIAGRAM_ACTIVATE_ON') ?? '')\n\t\t\t;\n\t\t\tconst applyChanges = () => {\n\t\t\t\tblock.activity.Activated = newActivatedState;\n\t\t\t\tthis.updateBlockActivityField(blockId, block.activity);\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: actionLabel,\n\t\t\t\t\tautoHideDelay: 4000,\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tif (skipDraft)\n\t\t\t{\n\t\t\t\tapplyChanges();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tapplyChanges();\n\t\t\t\tawait this.publicDraft();\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\thandleResponseError(error);\n\t\t\t}\n\t\t},\n\t},\n});\n","import { BlockDiagram as UiBlockDiagram } from 'ui.block-diagram';\nimport { BLOCK_SLOT_NAMES, CONNECTION_SLOT_NAMES } from '../../constants';\n\ntype BlockDiagramSetup = {\n\tblockSlotNames: { [string]: string };\n};\n\n// @vue/component\nexport const BlockDiagram = {\n\tname: 'block-diagram',\n\tcomponents: {\n\t\tUiBlockDiagram,\n\t},\n\tprops: {\n\t\tblocks: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\tconnections: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: [\n\t\t'update:blocks',\n\t\t'update:connections',\n\t\t'blockTransitionEnd',\n\t],\n\tsetup(props): BlockDiagramSetup\n\t{\n\t\treturn {\n\t\t\tblockSlotNames: BLOCK_SLOT_NAMES,\n\t\t\tconnectionSlotNames: CONNECTION_SLOT_NAMES,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<UiBlockDiagram\n\t\t\t:blocks=\"blocks\"\n\t\t\t:connections=\"connections\"\n\t\t\t:disabled=\"disabled\"\n\t\t\t@update:blocks=\"$emit('update:blocks', $event)\"\n\t\t\t@update:connections=\"$emit('update:connections', $event)\"\n\t\t\t@blockTransitionEnd=\"$emit('blockTransitionEnd', $event)\"\n\t\t>\n\t\t\t<template #[blockSlotNames.SIMPLE]=\"{ block }\">\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"blockSlotNames.SIMPLE\"\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<template #[blockSlotNames.TRIGGER]=\"{ block }\">\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"blockSlotNames.TRIGGER\"\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<template #[blockSlotNames.COMPLEX]=\"{ block }\">\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"blockSlotNames.COMPLEX\"\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<template #[blockSlotNames.TOOL]=\"{ block }\">\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"blockSlotNames.TOOL\"\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<template #[blockSlotNames.FRAME]=\"{ block }\">\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"blockSlotNames.FRAME\"\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<template #[connectionSlotNames.AUX]=\"{ connection }\">\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"connectionSlotNames.AUX\"\n\t\t\t\t\t:connection=\"connection\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</UiBlockDiagram>\n\t`,\n};\n","import './block-container.css';\nimport { computed } from 'ui.vue3';\nimport { useContextMenu } from 'ui.block-diagram';\nimport { BLOCK_COLOR_NAMES } from '../../constants';\n// eslint-disable-next-line no-unused-vars\nimport type { MenuItemOptions } from 'ui.vue3.components.menu';\n\ntype BlockContainerSetup = {\n\tblockContainerClassNames: { [string]: boolean };\n\tblockContainerStyle: { [string]: string };\n};\n\nconst BLOCK_CONTAINER_CLASS_NAMES = {\n\tbase: 'editor-chart-block-container',\n\thighlighted: '--highlighted',\n\tdeactivated: '--deactivated',\n\t[BLOCK_COLOR_NAMES.WHITE]: '--white',\n\t[BLOCK_COLOR_NAMES.ORANGE]: '--orange',\n\t[BLOCK_COLOR_NAMES.BLUE]: '--blue',\n};\n\n// @vue/component\nexport const BlockContainer = {\n\tname: 'block-container',\n\tprops: {\n\t\t/** @type Array<MenuItemOptions> */\n\t\tcontextMenuItems: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\twidth: {\n\t\t\ttype: Number,\n\t\t\tdefault: null,\n\t\t},\n\t\theight: {\n\t\t\ttype: Number,\n\t\t\tdefault: null,\n\t\t},\n\t\thighlighted: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdeactivated: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tcolorName: {\n\t\t\ttype: String,\n\t\t\tdefault: BLOCK_COLOR_NAMES.WHITE,\n\t\t\tvalidator(name): boolean\n\t\t\t{\n\t\t\t\treturn Object.values(BLOCK_COLOR_NAMES).includes(name);\n\t\t\t},\n\t\t},\n\t},\n\tsetup(props): BlockContainerSetup\n\t{\n\t\tconst {\n\t\t\tisOpen: isOpenContextMenu,\n\t\t\tshowContextMenu,\n\t\t} = useContextMenu(props.contextMenuItems);\n\n\t\tconst blockContainerClassNames = computed((): { [string]: boolean } => ({\n\t\t\t[BLOCK_CONTAINER_CLASS_NAMES.base]: true,\n\t\t\t[BLOCK_CONTAINER_CLASS_NAMES.highlighted]: props.highlighted,\n\t\t\t[BLOCK_CONTAINER_CLASS_NAMES.deactivated]: props.deactivated,\n\t\t\t[BLOCK_CONTAINER_CLASS_NAMES[props.colorName]]: true,\n\t\t}));\n\n\t\tconst blockContainerStyle = computed((): { [string]: string } => {\n\t\t\tconst style: { [string]: string } = {};\n\n\t\t\tif (props.width !== null)\n\t\t\t{\n\t\t\t\tstyle.width = `${props.width}px`;\n\t\t\t}\n\n\t\t\tif (props.height !== null)\n\t\t\t{\n\t\t\t\tstyle.height = `${props.height}px`;\n\t\t\t}\n\n\t\t\treturn style;\n\t\t});\n\n\t\tfunction onShowContextMenu(event: MouseEvent): void\n\t\t{\n\t\t\tevent.preventDefault();\n\n\t\t\tif (props.disabled)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tshowContextMenu(event);\n\t\t}\n\n\t\treturn {\n\t\t\tisOpenContextMenu,\n\t\t\tblockContainerClassNames,\n\t\t\tblockContainerStyle,\n\t\t\tonShowContextMenu,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\t:class=\"blockContainerClassNames\"\n\t\t\t:style=\"blockContainerStyle\"\n\t\t\t@contextmenu=\"onShowContextMenu\"\n\t\t>\n\t\t\t<slot :isOpenContextMenu=\"isOpenContextMenu\"/>\n\t\t</div>\n\t`,\n};\n","import './icon-button.css';\nimport { computed, toRefs, toValue } from 'ui.vue3';\nimport { BIcon } from 'ui.icon-set.api.vue';\n\nexport type IconButtonSetup = {\n\ticonName: string,\n\tcolor: string,\n\tsize: number,\n\ticonButtonClassNames: { [string]: boolean },\n\ticonButtonStyle: { [string]: string },\n\ticonClassNames: { [string]: boolean },\n};\n\nconst ICON_BUTTON_CLASS_NAMES = {\n\tbase: 'editor-chart-icon-button',\n\tdisabled: '--disabled',\n};\n\nconst ICON_CLASS_NAMES = {\n\tbase: 'editor-chart-icon-button__icon',\n\tactive: '--active',\n};\n\n// @vue/component\nexport const IconButton = {\n\tname: 'icon-button',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\ticonName: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tsize: {\n\t\t\ttype: [Number, String],\n\t\t\tdefault: 16,\n\t\t},\n\t\tcolor: {\n\t\t\ttype: String,\n\t\t\tdefault: 'var(--ui-color-gray-60)',\n\t\t},\n\t\tactive: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(props): IconButtonSetup\n\t{\n\t\tconst { size, active, disabled } = toRefs(props);\n\n\t\tconst iconButtonClassNames = computed(() => ({\n\t\t\t[ICON_BUTTON_CLASS_NAMES.base]: true,\n\t\t\t[ICON_BUTTON_CLASS_NAMES.disabled]: toValue(disabled),\n\t\t}));\n\n\t\tconst iconButtonStyle = computed(() => ({\n\t\t\twidth: `${toValue(size)}px`,\n\t\t\theight: `${toValue(size)}px`,\n\t\t}));\n\n\t\tconst iconClassNames = computed(() => ({\n\t\t\t[ICON_CLASS_NAMES.base]: true,\n\t\t\t[ICON_CLASS_NAMES.active]: toValue(active),\n\t\t}));\n\n\t\treturn {\n\t\t\ticonButtonClassNames,\n\t\t\ticonButtonStyle,\n\t\t\ticonClassNames,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<button\n\t\t\t:class=\"iconButtonClassNames\"\n\t\t\t:style=\"iconButtonStyle\"\n\t\t>\n\t\t\t<slot>\n\t\t\t\t<BIcon\n\t\t\t\t\t:class=\"iconClassNames\"\n\t\t\t\t\t:name=\"iconName\"\n\t\t\t\t\t:color=\"color\"\n\t\t\t\t\t:size=\"size\"\n\t\t\t\t/>\n\t\t\t</slot>\n\t\t</button>\n\t`,\n};\n","import './icon-divider.css';\nimport { computed, toRefs, toValue } from 'ui.vue3';\n\nexport type IconDividerSetup = {\n\tcontainerStyle: { [string]: string },\n\tlineStyle: { [string]: string },\n};\n\n// @vue/component\nexport const IconDivider = {\n\tname: 'icon-divider',\n\tprops: {\n\t\tsize: {\n\t\t\ttype: [Number, String],\n\t\t\tdefault: 16,\n\t\t},\n\t\tcolor: {\n\t\t\ttype: String,\n\t\t\tdefault: 'var(--ui-color-gray-20)',\n\t\t},\n\t},\n\tsetup(props): IconDividerSetup\n\t{\n\t\tconst { size, color } = toRefs(props);\n\n\t\tconst containerStyle = computed(() => ({\n\t\t\theight: `${toValue(size)}px`,\n\t\t}));\n\n\t\tconst lineStyle = computed(() => ({\n\t\t\theight: `${Math.round(toValue(size) / 2)}px`,\n\t\t\tbackground: toValue(color),\n\t\t}));\n\n\t\treturn {\n\t\t\tcontainerStyle,\n\t\t\tlineStyle,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"ui-block-diagram-icon-divider\"\n\t\t\t:style=\"containerStyle\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"ui-block-diagram-icon-divider-line\"\n\t\t\t\t:style=\"lineStyle\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Loader as UILoader } from 'ui.loader';\n\nconst LOADER_TYPE = 'BULLET';\n\n// @vue/component\nexport const Loader = {\n\tname: 'EditorChartLoader',\n\tmounted(): void\n\t{\n\t\tthis.loader = new UILoader({\n\t\t\ttarget: this.$refs['editor-chart-loader'],\n\t\t\ttype: LOADER_TYPE,\n\t\t});\n\t\tthis.loader.render();\n\t\tthis.loader.show();\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.loader.hide();\n\t\tthis.loader = null;\n\t},\n\ttemplate: `\n\t\t<div ref=\"editor-chart-loader\"></div>\n\t`,\n};\n","import { Button as UiButton } from 'ui.vue3.components.button';\nimport { BMenu, type MenuOptions } from 'ui.vue3.components.menu';\n\n// @vue/component\nexport const MenuButton = {\n\tname: 'ui-top-panel-menu-button',\n\tcomponents: {\n\t\tUiButton,\n\t\tBMenu,\n\t},\n\tprops: {\n\t\ttext: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\ticon: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\tbuttonStyle: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\t/** @type MenuOptions */\n\t\toptions: {\n\t\t\ttype: {},\n\t\t\tdefault: () => ({}),\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tmenuOptions(): MenuOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tbindElement: this.$refs.button.button.button,\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetLeft: (this.$refs.button.button.button.offsetWidth / 2 - 120),\n\t\t\t\twidth: 240,\n\t\t\t\t...this.options,\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<UiButton\n\t\t\t:text=\"text\"\n\t\t\t:leftIcon=\"icon\"\n\t\t\t:style=\"buttonStyle\"\n\t\t\tref=\"button\"\n\t\t\t@click=\"isMenuShown = true\"\n\t\t/>\n\t\t<BMenu\n\t\t\tv-if=\"isMenuShown\"\n\t\t\t:options=\"menuOptions\"\n\t\t\t@close=\"isMenuShown = false\"\n\t\t/>\n\t`,\n};\n","import { Dom, Type } from 'main.core';\nimport { ButtonIcon } from 'ui.vue3.components.button';\nimport { SplitButton as UiSplitButton } from 'ui.buttons';\n\nimport { Set, Outline } from 'ui.icon-set.api.core';\nconst allIcons = { ...ButtonIcon, ...Set, ...Outline };\n\n// @vue/component\nexport const SplitButton = {\n\tname: 'split-button',\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\ttext: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\ticon: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\tloading: Boolean,\n\t},\n\temits: ['click', 'mainClick', 'menuClick'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisMounted: false,\n\t\t};\n\t},\n\twatch: {\n\t\ticon(icon): void\n\t\t{\n\t\t\tconst classes = this.button.getContainer().classList;\n\t\t\tclasses.forEach((className) => {\n\t\t\t\tif (className.startsWith('ui-btn-icon-'))\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(this.button.getContainer(), className);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (icon && !icon.startsWith('ui-btn-icon'))\n\t\t\t{\n\t\t\t\tDom.addClass(this.button.getContainer(), '--with-icon');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.button.setProperty('icon', icon, ButtonIcon);\n\n\t\t\tDom.removeClass(this.button.getContainer(), '--with-icon');\n\t\t\tDom.toggleClass(this.button.getContainer(), ['ui-icon-set__scope', icon], Boolean(icon));\n\t\t},\n\t\tloading: {\n\t\t\thandler(loading): void\n\t\t\t{\n\t\t\t\tif (loading !== this.button?.isWaiting())\n\t\t\t\t{\n\t\t\t\t\tthis.button?.setWaiting(loading);\n\t\t\t\t}\n\t\t\t},\n\t\t\timmediate: true,\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tconst button = new UiSplitButton({\n\t\t\tid: this.id,\n\t\t\ttext: this.text,\n\t\t\tuseAirDesign: true,\n\t\t\tonclick: () => {\n\t\t\t\tthis.$emit('click');\n\t\t\t},\n\t\t\tmainButton: {\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.$emit('mainClick');\n\t\t\t\t},\n\t\t\t},\n\t\t\tmenuButton: {\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.$emit('menuClick');\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tif (this.icon)\n\t\t{\n\t\t\tbutton.addClass(`${this.icon} ui-icon-set__scope --with-left-icon`);\n\t\t}\n\n\t\tthis.button = button;\n\t},\n\tmounted(): void\n\t{\n\t\tconst button = this.button?.render();\n\n\t\tthis.$refs.button.after(button);\n\n\t\tthis.isMounted = true;\n\t},\n\tunmounted(): void\n\t{\n\t\tthis.button?.getContainer()?.remove();\n\t},\n\ttemplate: `\n\t\t<button v-if=\"!isMounted\" ref=\"button\"></button>\n\t`,\n};\n","import './block-layout.css';\nimport { computed, toValue, useTemplateRef, useSlots, inject } from 'ui.vue3';\nimport { useContextMenu } from 'ui.block-diagram';\nimport { Outline } from 'ui.icon-set.api.vue';\nimport { IconButton } from '../../../../shared/ui';\nimport type { Block } from '../../../../shared/types';\nimport { ACTIVATION_STATUS } from '../../../../shared/constants';\n\ntype BlockLayoutSetup = {\n\ticonSet: { [string]: string };\n\tisOpen: boolean;\n\tisShowButtonMore: boolean;\n\ttopMenuClass: { [string]: boolean };\n\tonOpenMoreMenu: (event: MouseEvent) => void;\n\tonCloseMoreMenu: () => void;\n};\n\nconst TOP_MENU_CLASS_NAMES = {\n\tbase: 'editor-chart-block-layout__top-menu',\n\tshow: '--show',\n\thide: '--hide',\n};\n\nconst STATUS_CLASS_NAMES = {\n\tbase: 'editor-chart-block-layout__status',\n\thide: '--hide',\n};\n\nconst OFFSET_MORE_MENU_RIGHT = 15;\nconst OFFSET_MORE_MENU_TOP = 10;\n\n// @vue/component\nexport const BlockLayout = {\n\tname: 'block-layout',\n\tcomponents: {\n\t\tIconButton,\n\t},\n\tprops: {\n\t\t/** @type Block */\n\t\tblock: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmoreMenuItems: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\ttopMenuOpened: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdragged: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tresized: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tisActivationVisible: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\tsetup(props): BlockLayoutSetup\n\t{\n\t\tconst buttonMore = useTemplateRef('buttonMore');\n\t\tconst slots = useSlots();\n\t\tconst {\n\t\t\tisOpen,\n\t\t\tshowContextMenu,\n\t\t\tcloseContextMenu,\n\t\t} = useContextMenu(props.moreMenuItems);\n\n\t\tconst isShowButtonMore = computed(() => props.moreMenuItems.length > 0);\n\n\t\tconst topMenuClassNames = computed(() => ({\n\t\t\t[TOP_MENU_CLASS_NAMES.base]: true,\n\t\t\t[TOP_MENU_CLASS_NAMES.show]: toValue(isOpen) || props.topMenuOpened,\n\t\t\t[TOP_MENU_CLASS_NAMES.hide]: props.dragged || props.resized,\n\t\t}));\n\n\t\tconst statusClassNames = computed((): { [string]: boolean } => ({\n\t\t\t[STATUS_CLASS_NAMES.base]: true,\n\t\t\t[STATUS_CLASS_NAMES.hide]: props.dragged || props.resized || !slots.status,\n\t\t}));\n\n\t\tfunction onOpenMoreMenu(): void\n\t\t{\n\t\t\tconst { top = 0, right = 0 } = toValue(buttonMore)\n\t\t\t\t?.$el?.getBoundingClientRect() ?? {};\n\n\t\t\tshowContextMenu({\n\t\t\t\tclientX: right + OFFSET_MORE_MENU_RIGHT,\n\t\t\t\tclientY: top - OFFSET_MORE_MENU_TOP,\n\t\t\t});\n\t\t}\n\n\t\tconst onToggleBlockActivation = inject('onToggleBlockActivation');\n\t\tfunction handleIconClick(): void\n\t\t{\n\t\t\tif (!onToggleBlockActivation)\n\t\t\t{\n\t\t\t\tconsole.warn('onToggleBlockActivation is not provided');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tonToggleBlockActivation(props.block.id);\n\t\t}\n\n\t\tfunction onCloseMoreMenu(): void\n\t\t{\n\t\t\tcloseContextMenu();\n\t\t}\n\n\t\treturn {\n\t\t\ticonSet: Outline,\n\t\t\tisOpen,\n\t\t\tisShowButtonMore,\n\t\t\ttopMenuClassNames,\n\t\t\tstatusClassNames,\n\t\t\tonOpenMoreMenu,\n\t\t\tonCloseMoreMenu,\n\t\t\thandleIconClick,\n\t\t};\n\t},\n\tcomputed: {\n\t\tactivationIcon(): string\n\t\t{\n\t\t\treturn this.block.activity.Activated === ACTIVATION_STATUS.ACTIVE\n\t\t\t\t? this.iconSet.PAUSE_L\n\t\t\t\t: this.iconSet.PLAY_L;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"editor-chart-block-layout\"\n\t\t\tref=\"editorBlockMenu\"\n\t\t\t@mousedown=\"onCloseMoreMenu\"\n\t\t>\n\t\t\t<div \n\t\t\t\t:class=\"topMenuClassNames\"\n\t\t\t\t@mousedown.stop\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!disabled\"\n\t\t\t\t\tclass=\"editor-chart-block-layout__top-menu-title\"\n\t\t\t\t>\n\t\t\t\t\t<slot name=\"top-menu-title\"/>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!disabled\"\n\t\t\t\t\tclass=\"editor-chart-block-layout__top-menu-content\">\n\t\t\t\t\t<slot\n\t\t\t\t\t\tname=\"top-menu\"\n\t\t\t\t\t/>\n\t\t\t\t\t<IconButton\n\t\t\t\t\t\tv-if=\"isActivationVisible\"\n\t\t\t\t\t\t:icon-name=\"activationIcon\"\n\t\t\t\t\t\t@click=\"handleIconClick\"\n\t\t\t\t\t/>\n\t\t\t\t\t<IconButton\n\t\t\t\t\t\tv-if=\"isShowButtonMore\"\n\t\t\t\t\t\tref=\"buttonMore\"\n\t\t\t\t\t\t:active=\"isOpen\"\n\t\t\t\t\t\t:size=\"16\"\n\t\t\t\t\t\t:icon-name=\"iconSet.MORE_L\"\n\t\t\t\t\t\t@click=\"onOpenMoreMenu\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"editor-chart-block-layout__content\">\n\t\t\t\t<slot/>\n\t\t\t</div>\n\t\t\t<div class=\"editor-chart-block-layout__left-content\">\n\t\t\t\t<slot name=\"left\"/>\n\t\t\t</div>\n\t\t\t<div :class=\"statusClassNames\">\n\t\t\t\t<slot name=\"status\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import './block-switcher.css';\nimport { computed } from 'ui.vue3';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { hint } from 'ui.vue3.directives.hint';\n\ntype BlockSwitcherSetup = {\n\tblockSwitcherClassNames: { [string]: boolean };\n\ticonClassNames: { [string]: boolean };\n\tswitcherLabel: string;\n\thandleClick: () => void;\n}\n\nconst BLOCK_SWITCHER_CLASS_NAMES = {\n\tbase: 'editor-chart-block-switcher',\n\ton: 'editor-chart-block-switcher__on',\n};\n\nconst ICON_CLASS_NAMES = {\n\tbase: 'editor-chart-block-switcher__icon',\n\ton: '--on',\n};\n\nconst SWITCHER_LABEL_ON = 'on';\nconst SWITCHER_LABEL_OFF = 'off';\n\n// @vue/component\nexport const BlockSwitcher = {\n\tname: 'block-switcher',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tdirectives: {\n\t\thint,\n\t},\n\tprops: {\n\t\ton: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\temits: ['click'],\n\tsetup(props, { emit }): BlockSwitcherSetup\n\t{\n\t\tconst blockSwitcherClassNames = computed((): { [string]: boolean } => ({\n\t\t\t[BLOCK_SWITCHER_CLASS_NAMES.base]: true,\n\t\t\t[BLOCK_SWITCHER_CLASS_NAMES.on]: props.on,\n\t\t}));\n\n\t\tconst iconClassNames = computed((): { [string]: boolean } => ({\n\t\t\t[ICON_CLASS_NAMES.base]: true,\n\t\t\t[ICON_CLASS_NAMES.on]: props.on,\n\t\t}));\n\n\t\tconst switcherLabel = computed((): string => {\n\t\t\treturn props.on\n\t\t\t\t? SWITCHER_LABEL_ON\n\t\t\t\t: SWITCHER_LABEL_OFF;\n\t\t});\n\n\t\tconst handleClick = (): void => {\n\t\t\temit('click');\n\t\t};\n\n\t\treturn {\n\t\t\tblockSwitcherClassNames,\n\t\t\ticonClassNames,\n\t\t\tswitcherLabel,\n\t\t\thandleClick,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\t:class=\"blockSwitcherClassNames\"\n\t\t\t@click=\"handleClick\"\n\t\t>\n\t\t\t<BIcon\n\t\t\t\t:class=\"iconClassNames\"\n\t\t\t\t:size=\"12\"\n\t\t\t\tname=\"o-power\" \n\t\t\t/>\n\t\t\t<p class=\"editor-chart-block-switcher__label\">\n\t\t\t\t{{ switcherLabel }}\n\t\t\t</p>\n\t\t</div>\n\t`,\n};\n","import './block-header.css';\n\n// @vue/component\nexport const BlockHeader = {\n\tname: 'block-header',\n\tprops: {\n\t\tblock: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tsubIconExternal: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"editor-chart-block-header\">\n\t\t\t<div class=\"editor-chart-block-header__icon-wrapper\">\n\t\t\t\t<slot name=\"icon\"/>\n\t\t\t</div>\n\n\t\t\t<template v-if=\"$slots.subIcon\">\n\t\t\t\t<span class=\"editor-chart-block-header__divider\" aria-hidden=\"true\"></span>\n\t\t\t\t<div :class=\"[\n\t\t\t\t\t  'editor-chart-block-header__icon-wrapper',\n\t\t\t\t\t  'editor-chart-block-header__icon-wrapper--sub',\n\t\t\t\t\t  { 'editor-chart-block-header__icon-wrapper--sub-external': subIconExternal }\n\t\t\t\t\t]\">\n\t\t\t\t\t<slot name=\"subIcon\"/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<div class=\"editor-chart-block-header__title\">{{ block.node?.title }}</div>\n\t\t</div>\n\t`,\n};\n","import './block-icon.css';\nimport { computed } from 'ui.vue3';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\n\ntype BlockIconSetup = {\n\ticonClassNames: { [string]: boolean };\n\tgetIconName: (name: ?string) => string;\n\tgetIconColor: (colorIndex: ?Number) => ?string;\n};\n\nconst ICON_CLASS_NAMES = {\n\tbase: 'editor-chart-block-icon',\n\tbgColor_1: '--background-color-1',\n\tbgColor_2: '--background-color-2',\n\tbgColor_3: '--background-color-3',\n\tbgColor_4: '--background-color-4',\n\tbgColor_5: '--background-color-5',\n\tbgColor_6: '--background-color-6',\n\tbgColor_7: '--background-color-7',\n\tbgColor_8: '--background-color-8',\n};\n\nconst ICON_COLORS = {\n\t0: 'var(--designer-bp-ai-icons)',\n\t1: 'var(--designer-bp-entities-icons)',\n\t2: 'var(--designer-bp-employe-icons)',\n\t3: 'var(--designer-bp-technical-icons)',\n\t4: 'var(--designer-bp-communication-icons)',\n\t5: 'var(--designer-bp-storage-icons)',\n\t6: 'var(--designer-bp-afiliate-icons)',\n\t7: 'var(--ui-color-palette-white-base)',\n\t8: 'var(--ui-color-palette-white-base)',\n};\n\nconst DEFAULT_ICON_NAME = Outline.FILE;\n\n// @vue/component\nexport const BlockIcon = {\n\tname: 'block-icon',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\ticonName: {\n\t\t\ttype: String,\n\t\t\tdefault: DEFAULT_ICON_NAME,\n\t\t},\n\t\ticonColorIndex: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\tcustomColor: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\ticonSize: {\n\t\t\ttype: Number,\n\t\t\tdefault: 28,\n\t\t},\n\t},\n\tsetup(props): BlockIconSetup\n\t{\n\t\tconst iconSet = Outline;\n\n\t\tconst iconClassNames = computed(() => ({\n\t\t\t[ICON_CLASS_NAMES.base]: true,\n\t\t\t[ICON_CLASS_NAMES.bgColor_1]: props.iconColorIndex === 0,\n\t\t\t[ICON_CLASS_NAMES.bgColor_2]: props.iconColorIndex === 1,\n\t\t\t[ICON_CLASS_NAMES.bgColor_3]: props.iconColorIndex === 2,\n\t\t\t[ICON_CLASS_NAMES.bgColor_4]: props.iconColorIndex === 3,\n\t\t\t[ICON_CLASS_NAMES.bgColor_5]: props.iconColorIndex === 4,\n\t\t\t[ICON_CLASS_NAMES.bgColor_6]: props.iconColorIndex === 5,\n\t\t\t[ICON_CLASS_NAMES.bgColor_7]: props.iconColorIndex === 6,\n\t\t\t[ICON_CLASS_NAMES.bgColor_8]: props.iconColorIndex === 7,\n\t\t}));\n\n\t\tfunction getIconName(name: ?string): string\n\t\t{\n\t\t\tif (name && Object.prototype.hasOwnProperty.call(iconSet, name))\n\t\t\t{\n\t\t\t\treturn iconSet[name];\n\t\t\t}\n\n\t\t\treturn DEFAULT_ICON_NAME;\n\t\t}\n\n\t\tfunction getIconColor(colorIndex: ?Number): ?string\n\t\t{\n\t\t\tif (colorIndex !== false && ICON_COLORS[colorIndex])\n\t\t\t{\n\t\t\t\treturn ICON_COLORS[colorIndex];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ticonClassNames,\n\t\t\tgetIconName,\n\t\t\tgetIconColor,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div :class=\"iconClassNames\">\n\t\t\t<BIcon\n\t\t\t\t:name=\"getIconName(iconName)\" \n\t\t\t\t:size=\"iconSize\"\n\t\t\t\t:color=\"customColor || getIconColor(iconColorIndex)\"\n\t\t\t\tclass=\"editor-chart-block-icon__icon\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { computed } from 'ui.vue3';\nimport { Port } from 'ui.block-diagram';\nimport {\n\tvalidationInputOutputRule,\n\tvalidationAuxRule,\n\tnormalyzeInputOutputConnection,\n\tnormalyzeAuxConnection,\n} from '../../utils';\nimport './ports-inout-center.css';\nimport type { Port as TPort } from '../../../shared/types';\n\ntype PortsInOutCenterSetup = {\n\tinPort: TPort | null;\n\toutPort: TPort | null;\n\tauxPort: TPort | null;\n\ttopAuxPort: TPort | null;\n};\n\n// @vue/component\nexport const PortsInOutCenter = {\n\tname: 'PortsInOutCenter',\n\tcomponents: {\n\t\tPort,\n\t},\n\tprops: {\n\t\t/** @type Block */\n\t\tblock: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\thideInputPorts: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(props): PortsInOutCenterSetup\n\t{\n\t\tconst inPort = computed((): TPort | null => {\n\t\t\tif (props.hideInputPorts)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn props.block.ports?.input?.[0] ?? null;\n\t\t});\n\t\tconst outPort = computed((): TPort | null => {\n\t\t\treturn props.block.ports?.output?.[0] ?? null;\n\t\t});\n\t\tconst auxPort = computed((): TPort | null => {\n\t\t\treturn props.block.ports?.aux?.[0] ?? null;\n\t\t});\n\t\tconst topAuxPort = computed((): TPort | null => {\n\t\t\treturn props.block.ports?.topAux?.[0] ?? null;\n\t\t});\n\n\t\treturn {\n\t\t\tinPort,\n\t\t\toutPort,\n\t\t\tauxPort,\n\t\t\ttopAuxPort,\n\t\t\tvalidationInputOutputRule,\n\t\t\tvalidationAuxRule,\n\t\t\tnormalyzeInputOutputConnection,\n\t\t\tnormalyzeAuxConnection,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div class=\"editor-chart-ports-inout-center\">\n\t\t\t<slot/>\n\n\t\t\t<div\n\t\t\t\tv-if=\"inPort\"\n\t\t\t\tclass=\"editor-chart-ports-inout-center__port --input\"\n\t\t\t>\n\t\t\t\t<Port\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t:port=\"inPort\"\n\t\t\t\t\t:disabled=\"disabled\"\n\t\t\t\t\t:styled=\"false\"\n\t\t\t\t\t:validationRules=\"[validationInputOutputRule]\"\n\t\t\t\t\t:normalyzeConnectionFn=\"normalyzeInputOutputConnection\"\n\t\t\t\t\tposition=\"left\"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<div\n\t\t\t\tv-if=\"outPort\"\n\t\t\t\tclass=\"editor-chart-ports-inout-center__port --output\"\n\t\t\t>\n\t\t\t\t<Port\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t:port=\"outPort\"\n\t\t\t\t\t:disabled=\"disabled\"\n\t\t\t\t\t:styled=\"false\"\n\t\t\t\t\t:validationRules=\"[validationInputOutputRule]\"\n\t\t\t\t\t:normalyzeConnectionFn=\"normalyzeInputOutputConnection\"\n\t\t\t\t\tposition=\"right\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"auxPort\"\n\t\t\t\tclass=\"editor-chart-ports-bottom-center__port --bottom\"\n\t\t\t>\n\t\t\t\t<Port\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t:port=\"auxPort\"\n\t\t\t\t\t:disabled=\"disabled\"\n\t\t\t\t\t:styled=\"false\"\n\t\t\t\t\t:validationRules=\"[validationAuxRule]\"\n\t\t\t\t\t:normalyzeConnectionFn=\"normalyzeAuxConnection\"\n\t\t\t\t\tposition=\"bottom\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"topAuxPort\"\n\t\t\t\tclass=\"editor-chart-ports-top-center__port --top\"\n\t\t\t>\n\t\t\t\t<Port\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t:port=\"topAuxPort\"\n\t\t\t\t\t:disabled=\"disabled\"\n\t\t\t\t\t:styled=\"false\"\n\t\t\t\t\t:validationRules=\"[validationAuxRule]\"\n\t\t\t\t\t:normalyzeConnectionFn=\"normalyzeAuxConnection\"\n\t\t\t\t\tposition=\"top\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import './block-status-not-published.css';\nimport { useLoc } from '../../../../shared/composables';\nimport type { GetMessage } from '../../../../shared/composables';\n\ntype BlockStatusNotPublishedSetup = {\n\tgetMessage: GetMessage,\n}\n\n// @vue/component\nexport const BlockStatusNotPublished = {\n\tname: 'block-status-not-published',\n\tsetup(): BlockStatusNotPublishedSetup\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn {\n\t\t\tgetMessage,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<p class=\"editor-chart-block-status-not-published\">\n\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_BLOCK_NOT_PUBLISHED_STATUS') }}\n\t\t</p>\n\t`,\n};\n","import { useBlockDiagram, Port } from 'ui.block-diagram';\nimport { FeatureCode } from 'bizprocdesigner.feature';\n// eslint-disable-next-line no-unused-vars\nimport { validationInputOutputRule, normalyzeInputOutputConnection } from '../../utils';\nimport { useLoc, useFeature } from '../../../../shared/composables';\nimport './style.css';\nimport type { Port as TPort } from '../../../../shared/types';\n\ntype BlockComplexSetup = {\n\tupdatePortPosition: () => void;\n\tgetMessage: () => string;\n};\n\n// @vue/component\nexport const BlockComplexContent = {\n\tname: 'block-complex',\n\tcomponents: { Port },\n\tprops:\n\t{\n\t\t/** @type Block */\n\t\tblock:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(): BlockComplexSetup\n\t{\n\t\tconst { updatePortPosition } = useBlockDiagram();\n\t\tconst { getMessage } = useLoc();\n\t\tconst { isFeatureAvailable } = useFeature();\n\n\t\treturn {\n\t\t\tupdatePortPosition,\n\t\t\tgetMessage,\n\t\t\tisFeatureAvailable,\n\t\t\tnormalyzeInputOutputConnection,\n\t\t\tvalidationInputOutputRule,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\trulePorts(): Array<TPort>\n\t\t{\n\t\t\treturn this.block.ports.input.filter((port) => !port.isConnectionPort);\n\t\t},\n\t\tconnectionPorts(): Array<TPort>\n\t\t{\n\t\t\treturn this.block.ports.input.filter((port) => port.isConnectionPort);\n\t\t},\n\t\tinputPortsLength(): number\n\t\t{\n\t\t\treturn this.block.ports.input.length;\n\t\t},\n\t\toutputPortsLength(): number\n\t\t{\n\t\t\treturn this.block.ports.output.length;\n\t\t},\n\t\tareConnectionsAvailable(): boolean\n\t\t{\n\t\t\treturn this.isFeatureAvailable(FeatureCode.complexNodeConnections)\n\t\t\t\t&& this.connectionPorts.length > 0;\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tinputPortsLength(): void\n\t\t{\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.block.ports.input.forEach((port) => {\n\t\t\t\t\tthis.updatePortPosition(this.block.id, port.id);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\toutputPortsLength(): void\n\t\t{\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.block.ports.output.forEach((port) => {\n\t\t\t\t\tthis.updatePortPosition(this.block.id, port.id);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"block-complex\">\n\t\t\t<slot name=\"header\" />\n\t\t\t<div class=\"block-complex__content\">\n\t\t\t\t<div class=\"block-complex__content_row block-complex__content_rules\">\n\t\t\t\t\t<div class=\"block-complex__content_col\">\n\t\t\t\t\t\t<span class=\"block-complex__content_label\">\n\t\t\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_BLOCK_RULES_INPUT_TITLE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-for=\"port in rulePorts\"\n\t\t\t\t\t\t\t:key=\"port.id\"\n\t\t\t\t\t\t\tclass=\"block-complex__content_col-value\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Port\n\t\t\t\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t\t\t\t:port=\"port\"\n\t\t\t\t\t\t\t\t:disabled=\"disabled\"\n\t\t\t\t\t\t\t\t:validationRules=\"[validationInputOutputRule]\"\n\t\t\t\t\t\t\t\t:normalyzeConnectionFn=\"normalyzeInputOutputConnection\"\n\t\t\t\t\t\t\t\tposition=\"left\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<span class=\"block-complex__content_col-value-text\">{{ port.title }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<slot name=\"addPortPoint\" position=\"left\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"block-complex__content_col --right\">\n\t\t\t\t\t\t<span class=\"block-complex__content_label\">\n\t\t\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_BLOCK_RULES_OUTPUT_TITLE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-for=\"port in block.ports.output\"\n\t\t\t\t\t\t\t:key=\"port.id\"\n\t\t\t\t\t\t\tclass=\"block-complex__content_col-value\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span class=\"block-complex__content_col-value-text\">{{ port.title }}</span>\n\t\t\t\t\t\t\t<Port\n\t\t\t\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t\t\t\t:port=\"port\"\n\t\t\t\t\t\t\t\t:disabled=\"disabled\"\n\t\t\t\t\t\t\t\t:validationRules=\"[validationInputOutputRule]\"\n\t\t\t\t\t\t\t\t:normalyzeConnectionFn=\"normalyzeInputOutputConnection\"\n\t\t\t\t\t\t\t\tposition=\"right\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<slot name=\"addPortPoint\" position=\"right\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"areConnectionsAvailable\"\n\t\t\t\t\tclass=\"block-complex__content_connections\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"block-complex__content_label\">\n\t\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_BLOCK_CONNECTIONS_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<div class=\"block-complex__content_row\">\n\t\t\t\t\t\t<div class=\"block-complex__content_col\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-for=\"port in connectionPorts\"\n\t\t\t\t\t\t\t\t:key=\"port.id\"\n\t\t\t\t\t\t\t\tclass=\"block-complex__content_col-value\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Port\n\t\t\t\t\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t\t\t\t\t:port=\"port\"\n\t\t\t\t\t\t\t\t\t:disabled=\"disabled\"\n\t\t\t\t\t\t\t\t\tposition=\"left\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<span class=\"block-complex__content_col-value-text\">{{ port.title }}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<slot name=\"addPortPoint\" position=\"left\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"block-complex__content_col --right\">\n\t\t\t\t\t\t\t<slot name=\"addPortPoint\" position=\"right\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import './block-top-title.css';\n\n// @vue/component\nexport const BlockTopTitle = {\n\tname: 'block-top-title',\n\tprops:\n\t{\n\t\ttitle:\n\t\t{\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<h3 class=\"editor-chart-block-top-title\">{{ title }}</h3>\n\t`,\n};\n","import { Event, Type } from 'main.core';\nimport { Outline } from 'ui.icon-set.api.core';\nimport { AirButtonStyle, Button as UiButton, ButtonSize } from 'ui.vue3.components.button';\nimport { MenuButton } from '../../../../shared/ui';\nimport type { MenuOptions, MenuItemOptions } from 'ui.vue3.components.menu';\nimport './template-name-input.css';\n\ntype TemplateNameInputData = {\n\tisEditing: boolean,\n\teditedTitle: string,\n};\n\n// @vue/component\nexport const TemplateNameInput = {\n\tname: 'TemplateNameInput',\n\tcomponents:\n\t{\n\t\tUiButton,\n\t\tMenuButton,\n\t},\n\tprops:\n\t{\n\t\ttitle:\n\t\t{\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\t/** @type MenuOptions */\n\t\tdropdownOptions:\n\t\t{\n\t\t\ttype: [Object],\n\t\t\tdefault: () => ({}),\n\t\t},\n\t},\n\temits: ['update:title'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t\tAirButtonStyle,\n\t\t\tOutline,\n\t\t\tType,\n\t\t};\n\t},\n\tdata(): TemplateNameInputData\n\t{\n\t\treturn {\n\t\t\tisEditing: false,\n\t\t\teditedTitle: this.title,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tpreparedOptions(): MenuOptions\n\t\t{\n\t\t\tconst options = this.dropdownOptions;\n\t\t\tconst items = Type.isArrayFilled(options.items) ? options.items : [];\n\t\t\tconst preparedItems = Type.isArrayFilled(items)\n\t\t\t\t? this.prepareItems(items)\n\t\t\t\t: items;\n\n\t\t\treturn {\n\t\t\t\t...options,\n\t\t\t\titems: [\n\t\t\t\t\tthis.getEditingMenuItems(),\n\t\t\t\t\t...preparedItems,\n\t\t\t\t],\n\t\t\t};\n\t\t},\n\t},\n\twatch: {\n\t\tisEditing(isEditing: boolean): void\n\t\t{\n\t\t\tif (isEditing)\n\t\t\t{\n\t\t\t\tEvent.bind(document, 'click', this.onClickOutside, { capture: true });\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tEvent.unbind(document, 'click', this.onClickOutside, { capture: true });\n\t\t\t}\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tgetEditingMenuItems(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_TOP_PANEL_TITLE_ACTION_CHANGE'),\n\t\t\t\ticon: Outline.EDIT_M,\n\t\t\t\tonClick: this.onStartEditing,\n\t\t\t};\n\t\t},\n\t\tonStartEditing(): void\n\t\t{\n\t\t\tthis.isEditing = true;\n\t\t\tthis.editedTitle = this.title;\n\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.$refs?.editInput?.focus();\n\t\t\t});\n\t\t},\n\t\tonSaveTitle(): void\n\t\t{\n\t\t\tthis.$emit('update:title', this.editedTitle);\n\t\t\tthis.isEditing = false;\n\t\t},\n\t\tonCancelEditing(): void\n\t\t{\n\t\t\tthis.isEditing = false;\n\t\t},\n\t\tprepareItems(items: Array): Array<MenuItemOptions>\n\t\t{\n\t\t\treturn items.map((item) => {\n\t\t\t\tif (Type.isString(item.onClick) && Type.isFunction(this[item.onClick]))\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...item,\n\t\t\t\t\t\tonClick: this[item.onClick].bind(this),\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn item;\n\t\t\t});\n\t\t},\n\t\tonClickOutside(event: MouseEvent): void\n\t\t{\n\t\t\tif (!this.$el.contains(event.target))\n\t\t\t{\n\t\t\t\tthis.onCancelEditing();\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"!isEditing\"\n\t\t\tclass=\"ui-top-panel-editable-title-box\"\n\t\t>\n\t\t\t<div class=\"ui-top-panel-editable-title\">\n\t\t\t\t<span @click=\"onStartEditing\">{{ title }}</span>\n\t\t\t</div>\n\t\t\t<MenuButton\n\t\t\t\t:options=\"preparedOptions\"\n\t\t\t\t:icon=\"Outline.CHEVRON_DOWN_M\"\n\t\t\t\t:buttonStyle=\"AirButtonStyle.PLAIN_NO_ACCENT\"\n\t\t\t/>\n\t\t</div>\n\t\t<div\n\t\t\tv-else\n\t\t\tclass=\"ui-top-panel-editable-title-edit-box\"\n\t\t>\n\t\t\t<input\n\t\t\t\tv-model=\"editedTitle\"\n\t\t\t\tref=\"editInput\"\n\t\t\t\tclass=\"ui-top-panel-editable-title-edit-input\"\n\t\t\t/>\n\t\t\t<div class=\"ui-top-panel-editable-title-edit-buttons\">\n\t\t\t\t<UiButton\n\t\t\t\t\t:leftIcon=\"Outline.CHECK_M\"\n\t\t\t\t\t:size=\"ButtonSize.EXTRA_EXTRA_SMALL\"\n\t\t\t\t\t@click=\"onSaveTitle\"\n\t\t\t\t/>\n\t\t\t\t<UiButton\n\t\t\t\t\t:leftIcon=\"Outline.CROSS_L\"\n\t\t\t\t\t:size=\"ButtonSize.EXTRA_EXTRA_SMALL\"\n\t\t\t\t\t:style=\"AirButtonStyle.OUTLINE\"\n\t\t\t\t\t@click=\"onCancelEditing\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import './autosave-status.css';\nimport { hint } from 'ui.vue3.directives.hint';\n\n// @vue/component\nexport const AutosaveStatus = {\n\tname: 'bizprocdisginer-top-panel-autosave-status',\n\tdirectives: {\n\t\thint,\n\t},\n\tprops: {\n\t\tisOnline: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<div\n\t\t\t\tv-if=\"isOnline\"\n\t\t\t\tv-hint=\"{\n\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_TOP_PANEL_AUTOSAVE_STATUS_SAVED_HINT'),\n\t\t\t\t\tpopupOptions: {\n\t\t\t\t\t\twidth: 339,\n\t\t\t\t\t\toffsetTop: 20,\n\t\t\t\t\t\tbackground: '#085DC1',\n\t\t\t\t\t},\n\t\t\t\t}\"\n\t\t\t\tclass=\"bizprocdesigner-editor-header-save-status-box bizprocdesigner-editor-header-online\"\n\t\t\t>\n\t\t\t\t<div class=\"ui-icon-set --o-circle-check\"></div>\n\t\t\t\t{{$Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_TOP_PANEL_AUTOSAVE_STATUS_SAVED')}}\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-else\n\t\t\t\tv-hint=\"{\n\t\t\t\t\ttext: $Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_TOP_PANEL_AUTOSAVE_STATUS_NOT_SAVED_HINT'),\n\t\t\t\t\tpopupOptions: {\n\t\t\t\t\t\twidth: 339,\n\t\t\t\t\t\tbackground: '#085DC1',\n\t\t\t\t\t},\n\t\t\t\t}\"\n\t\t\t\tclass=\"bizprocdesigner-editor-header-save-status-box bizprocdesigner-editor-header-offline\"\n\t\t\t>\n\t\t\t\t<div class=\"ui-icon-set --o-circle-cross\"></div>\n\t\t\t\t{{$Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_TOP_PANEL_AUTOSAVE_STATUS_NOT_SAVED')}}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Event } from 'main.core';\nimport './dropdown-menu-button.css';\nimport { SplitButton } from '../../../../shared/ui';\n\ntype DropdownMenuButtonData = {\n\tisOpen: boolean,\n};\n\n// @vue/components\nexport const DropdownMenuButton = {\n\tname: 'DropdownMenuButton',\n\tcomponents: {\n\t\tSplitButton,\n\t},\n\tprops:\n\t{\n\t\ttext:\n\t\t{\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\ticon:\n\t\t{\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tloading:\n\t\t{\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['change'],\n\tdata(): DropdownMenuButtonData\n\t{\n\t\treturn {\n\t\t\tisOpen: false,\n\t\t};\n\t},\n\tmounted()\n\t{\n\t\tEvent.bind(document, 'mousedown', this.handleClickOutside);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEvent.unbind(document, 'mousedown', this.handleClickOutside);\n\t},\n\tmethods:\n\t{\n\t\tonToggleDropdown(): void\n\t\t{\n\t\t\tthis.isOpen = !this.isOpen;\n\t\t},\n\t\thandleClickOutside(event: MouseEvent): void\n\t\t{\n\t\t\tconst dropdown = this.$el;\n\n\t\t\tif (dropdown && !dropdown?.contains(event.target))\n\t\t\t{\n\t\t\t\tthis.isOpen = false;\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"editor-chart-dropdown-menu-button\">\n\t\t\t<SplitButton\n\t\t\t\t:text=\"text\"\n\t\t\t\t:icon=\"icon\"\n\t\t\t\t:loading=\"loading\"\n\t\t\t\t@mainClick=\"$emit('change')\"\n\t\t\t\t@menuClick=\"onToggleDropdown\"\n\t\t\t/>\n\t\t\t<transition name=\"slide-fade\">\n\t\t\t\t<div v-if=\"isOpen\"\n\t\t\t\t\tclass=\"editor-chart-dropdown-menu-button__menu-content\"\n\t\t\t\t\tref=\"dropdownMenu\"\n\t\t\t\t>\n\t\t\t\t\t<ul class=\"editor-chart-dropdown-menu-button__list\">\n\t\t\t\t\t\t<slot/>\n\t\t\t\t\t</ul>\n\t\t\t\t\t<div class=\"editor-chart-dropdown-menu-button__footer\">\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\thref=\"#\"\n\t\t\t\t\t\t\tclass=\"editor-chart-dropdown-menu-button__help-link\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_PUBLICATION_LINK') }}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t</div>\n\t`,\n};\n","import './dropdown-menu-option.css';\n\n// @vue/component\nexport const DropdownMenuOption = {\n\tname: 'DropdownMenuOption',\n\tprops:\n\t{\n\t\ttitle:\n\t\t{\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tdescription:\n\t\t{\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tisActive:\n\t\t{\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tnotReleased: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<li\n\t\t\tclass=\"editor-chart-dropdown-menu-option\"\n\t\t\t:class=\"{ '--selected': isActive }\"\n\t\t>\n\t\t\t<div class=\"editor-chart-dropdown-menu-option__content\">\n\t\t\t\t<div class=\"editor-chart-dropdown-menu-option__title\">\n\t\t\t\t\t{{ title }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"editor-chart-dropdown-menu-option__description\">\n\t\t\t\t\t{{ description }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"editor-chart-dropdown-menu-option__icon\">\n\t\t\t\t<slot name=\"icon\"/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"notReleased\"\n\t\t\t\t\tclass=\"editor-chart-dropdown-menu-option__not-released-badge\"\n\t\t\t\t>\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_NOT_RELEASE_BADGE') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</li>\n\t`,\n};\n","const COLORS = {\n\tactive: {\n\t\tlightBlue: '#C4E6FF',\n\t\tprimaryBlue: '#0075FF',\n\t\tsecondaryBlue: '#9BD4FF',\n\t\tsuccessGreen: '#1BCE7B',\n\t},\n\tinactive: {\n\t\tlightBlue: '#F0F0F0',\n\t\tprimaryBlue: '#C8C9CD',\n\t\tsecondaryBlue: '#C8C9CD',\n\t\tsuccessGreen: '#C8C9CD',\n\t},\n};\n\n// @vue/components\nexport const WorkflowIcon = {\n\tname: 'WorkflowIcon',\n\tprops:\n\t{\n\t\tactive:\n\t\t{\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tcolors(): { [string]: string }\n\t\t{\n\t\t\treturn this.active\n\t\t\t\t? COLORS.active\n\t\t\t\t: COLORS.inactive;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<svg\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\twidth=\"71\"\n\t\t\theight=\"67\"\n\t\t\tviewBox=\"0 0 71 67\"\n\t\t\tfill=\"none\"\n\t\t>\n\t\t\t<g opacity=\"0.8\">\n\t\t\t\t<path\n\t\t\t\t\td=\"M15.2749 17.5718C15.2749 14.8644 17.3577 12.724 19.9013 12.7906L51.5805 13.6078C53.7929 13.6655 55.5715 15.7302 55.5715 18.2217V45.8523C55.5715 48.3437 53.7929 50.4571 51.5805 50.5741L19.9013 52.2447C17.3559 52.3797 15.2749 50.2951 15.2749 47.5877V17.5718Z\"\n\t\t\t\t\t:fill=\"colors.lightBlue\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t\t<path\n\t\t\t\topacity=\"0.5\"\n\t\t\t\td=\"M26.2736 39.6436C26.2736 39.3952 26.549 39.2494 26.7362 39.3988L27.2439 39.8074V40.0649H27.3033C27.4563 40.0595 27.5805 40.1891 27.5805 40.3547C27.5805 40.5203 27.4563 40.6571 27.3033 40.6625H27.2439V40.9235L26.7362 41.361C26.5508 41.5212 26.2736 41.3934 26.2736 41.145V40.6823C26.1134 40.6769 25.9568 40.6607 25.8038 40.6319C25.6525 40.6049 25.5535 40.4483 25.5841 40.2863C25.6147 40.1225 25.7606 40.0127 25.9136 40.0415C26.0324 40.0631 26.153 40.0775 26.2754 40.0829V39.6418L26.2736 39.6436ZM29.6633 40.5923L28.8784 40.6157C28.7254 40.6211 28.6012 40.4897 28.6012 40.3259C28.6012 40.1621 28.7254 40.0235 28.8784 40.0199L29.6633 39.9965V40.5923ZM23.5536 38.6175C23.6832 38.5221 23.8578 38.5545 23.9442 38.6895C24.171 39.0442 24.4608 39.3484 24.7993 39.5806L24.8425 39.6184C24.9343 39.7156 24.9505 39.8722 24.8767 39.9947C24.7903 40.1351 24.6157 40.1765 24.486 40.0883L24.3384 39.9821C24.0018 39.7246 23.7084 39.4042 23.4744 39.0388C23.3879 38.902 23.4221 38.7147 23.5518 38.6175H23.5536ZM23.1395 35.8381C23.2961 35.8345 23.4221 35.9677 23.4221 36.1333V36.8606C23.4221 37.082 23.4419 37.298 23.4816 37.5068L23.487 37.568C23.487 37.7085 23.3933 37.8363 23.2583 37.8669C23.1053 37.9029 22.9559 37.8003 22.9271 37.6382L22.8965 37.451C22.8695 37.2638 22.8569 37.0694 22.8569 36.8732V36.1441C22.8569 35.9767 22.9829 35.8399 23.1395 35.8363V35.8381ZM23.1395 32.9236C23.2961 32.9218 23.4221 33.055 23.4221 33.2207V34.677L23.4167 34.7382C23.3897 34.8768 23.2763 34.9812 23.1395 34.9848C23.0027 34.9866 22.8893 34.8858 22.8623 34.749L22.8569 34.6878V33.2297C22.8569 33.0622 22.9829 32.9254 23.1395 32.9236ZM23.9136 30.3584C23.9136 30.695 23.7102 30.9831 23.4221 31.1001V31.7661L23.4167 31.8273C23.3897 31.9641 23.2763 32.0704 23.1395 32.0722C23.0027 32.0722 22.8893 31.9713 22.8623 31.8345L22.8569 31.7733V31.0983C22.5797 30.9831 22.3853 30.7022 22.3853 30.3728L23.9136 30.3584Z\"\n\t\t\t\t:fill=\"colors.primaryBlue\"\n\t\t\t\tfill-opacity=\"0.78\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M18.7524 21.2727C18.7524 19.5968 19.8703 18.2539 21.2403 18.2737L46.8331 18.6553C48.0608 18.6733 49.0527 19.9658 49.0527 21.5409V27.2709C49.0527 28.846 48.0626 30.1331 46.8331 30.1439L21.2403 30.3797C19.8685 30.3923 18.7524 29.044 18.7524 27.3663V21.2709V21.2727Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\topacity=\"0.5\"\n\t\t\t\td=\"M24.583 24.3347C24.583 23.6686 25.0733 23.1322 25.6766 23.1358L43.4199 23.233C43.9781 23.2366 44.4301 23.755 44.4301 24.3941C44.4301 25.0331 43.9781 25.548 43.4199 25.548L25.6766 25.5408C25.0733 25.5408 24.583 25.0007 24.583 24.3365V24.3347Z\"\n\t\t\t\t:fill=\"colors.secondaryBlue\"\n\t\t\t\tfill-opacity=\"var(--opacity-80)\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M27.2441 37.4979C27.2441 35.849 28.3242 34.4934 29.6492 34.47L50.3996 34.1028C51.6093 34.0812 52.585 35.3323 52.585 36.8967V42.5834C52.585 44.1477 51.6093 45.4564 50.3996 45.5068L29.6492 46.3763C28.3242 46.4321 27.2441 45.1414 27.2441 43.4924V37.4997V37.4979Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\topacity=\"0.5\"\n\t\t\t\td=\"M38.6587 40.1545C38.6587 39.5083 39.1375 38.9736 39.7244 38.9574L48.5362 38.7162C49.1014 38.7 49.5587 39.2004 49.5587 39.8305C49.5587 40.4606 49.1014 40.988 48.5362 41.006L39.7244 41.2904C39.1357 41.3102 38.6587 40.8008 38.6587 40.1563V40.1545Z\"\n\t\t\t\t:fill=\"colors.secondaryBlue\"\n\t\t\t\tfill-opacity=\"0.8\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\topacity=\"0.7\"\n\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\td=\"M33.2891 44.2326C33.2891 44.2321 33.2895 44.2317 33.29 44.2317C35.2698 44.1556 36.8624 42.3556 36.8624 40.2084C36.8624 38.0608 35.2693 36.356 33.2891 36.3992C31.3089 36.4424 29.6636 38.2444 29.6636 40.4244C29.6636 42.6041 31.2922 44.3068 33.2882 44.2336C33.2887 44.2336 33.2891 44.2331 33.2891 44.2326Z\"\n\t\t\t\t:fill=\"colors.successGreen\"\n\t\t\t\tfill-opacity=\"0.78\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\td=\"M35.057 38.7832C34.9022 38.6194 34.652 38.6248 34.4971 38.7976L32.7708 40.7274L32.0795 39.9965C31.9229 39.8309 31.6691 39.8381 31.5125 40.0127C31.3559 40.1873 31.3559 40.4628 31.5125 40.6284L32.4882 41.6581C32.6448 41.8219 32.8968 41.8147 33.0516 41.6401L35.057 39.3953C35.2118 39.2224 35.2118 38.9488 35.057 38.785V38.7832Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M47.9009 41.2902C47.9009 38.7574 49.7244 36.662 51.9548 36.6116L62.2716 36.3739C64.3849 36.3253 66.0843 38.2605 66.0843 40.6961V52.2712C66.0843 54.7068 64.3849 56.7968 62.2716 56.939L51.9548 57.6392C49.7244 57.7904 47.9009 55.8607 47.9009 53.3278V41.292V41.2902Z\"\n\t\t\t\t:fill=\"colors.primaryBlue\"\n\t\t\t\tfill-opacity=\"0.78\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\td=\"M47.8608 41.2382C47.8608 38.709 49.6808 36.6172 51.9076 36.5668L62.2063 36.331C64.3161 36.2824 66.0119 38.2157 66.0119 40.6478V52.2066C66.0119 54.6386 64.3161 56.725 62.2063 56.8672L51.9076 57.5621C49.6808 57.7115 47.8608 55.7853 47.8608 53.2561V41.2364V41.2382Z\"\n\t\t\t\t:fill=\"colors.primaryBlue\"\n\t\t\t\tfill-opacity=\"0.78\"\n\t\t\t/>\n\t\t\t<g filter=\"url(#filter1_d_2398_58856)\">\n\t\t\t\t<path\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\td=\"M59.0084 45.4018C59.0084 45.3644 59.0119 45.327 59.0191 45.2897C59.0725 45.0405 59.286 44.8803 59.4978 44.9337L61.3275 45.3947C61.5019 45.4392 61.6229 45.6171 61.6229 45.8289V50.072L62.091 50.0471C62.1907 50.0418 62.2726 50.1308 62.2726 50.2465V51.3589C62.2726 51.4745 62.1907 51.5724 62.091 51.5778L51.8482 52.1562C51.7431 52.1616 51.6577 52.0708 51.6577 51.9533V50.8142C51.6577 50.6968 51.7431 50.5953 51.8482 50.59L52.3358 50.5633V42.9812C52.3358 42.5968 52.5761 42.2622 52.9036 42.1892L57.5827 41.1445C57.6183 41.1373 57.6539 41.132 57.6895 41.1302C58.0544 41.1178 58.3498 41.4541 58.3498 41.8813V50.2447L59.0084 50.2091V45.4018ZM55.2369 50.3337V47.9434L54.0356 48.0003V50.3977L55.2369 50.3337ZM57.0577 49.2159V47.8562L55.8652 47.9131V49.2765L57.0577 49.2159ZM60.8612 47.6088L59.6883 47.6639V49.0166L60.8612 48.9579V47.6088ZM57.0577 43.7074L55.8652 43.7537V45.117L57.0577 45.0672V43.7074ZM55.2369 43.7786L54.0356 43.8249V45.1936L55.2369 45.1437V43.7786ZM57.0577 45.7827L55.8652 45.8343V47.1976L57.0577 47.1425V45.7827ZM55.2369 45.861L54.0356 45.9126V47.2813L55.2369 47.2261V45.861Z\"\n\t\t\t\t\tfill=\"white\"\n\t\t\t\t\tfill-opacity=\"0.9\"\n\t\t\t\t\tshape-rendering=\"crispEdges\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t\t<path\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\td=\"M65.3957 52.2278V40.6525C65.3957 38.54 63.9889 37.0067 62.3711 36.9481L62.2137 36.9466L51.8971 37.1845C50.068 37.2258 48.4456 38.9784 48.4456 41.2464V53.2839C48.4456 55.5388 50.0415 57.102 51.8413 56.98L62.158 56.2799L62.3184 56.2641C63.9682 56.0547 65.3955 54.3492 65.3957 52.2278ZM66.0122 52.2278L66.0077 52.4543C65.9062 54.7916 64.2469 56.7571 62.1994 56.8949L51.8828 57.5957L51.675 57.6033C49.6091 57.6243 47.9398 55.8574 47.8344 53.5195L47.8291 53.2839V41.2464C47.8291 38.7928 49.5404 36.7497 51.675 36.5785L51.8828 36.568L62.1994 36.3301L62.3966 36.3316C64.4177 36.4032 66.0122 38.293 66.0122 40.6525V52.2278Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t\tfill-opacity=\"0.18\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M5.479 6.25911C5.479 3.49227 7.6554 1.35548 10.3142 1.48509L22.0171 2.05574C24.5301 2.17815 26.5499 4.42835 26.5499 7.08359V19.0997C26.5499 21.7549 24.5301 23.8953 22.0171 23.8827L10.3142 23.8215C7.6554 23.8071 5.479 21.5533 5.479 18.7864V6.25911Z\"\n\t\t\t\t:fill=\"colors.successGreen\"\n\t\t\t\tfill-opacity=\"0.78\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M5.479 18.7867V6.25913C5.47916 3.49251 7.65539 1.3556 10.314 1.48508L22.0173 2.05643C24.5302 2.17897 26.5497 4.42901 26.5497 7.08416V19.0998L26.5437 19.3475C26.4228 21.8869 24.4516 23.895 22.0173 23.8829L22.0203 23.2664C24.157 23.277 25.9332 21.4487 25.9332 19.0998V7.08416C25.9332 4.79933 24.2507 2.89929 22.1882 2.68725L21.9872 2.67219L10.2839 2.10159C7.99746 1.99029 6.09568 3.82433 6.09552 6.25913V18.7867C6.09552 21.2337 8.01739 23.193 10.3178 23.2054L22.0203 23.2664L22.0173 23.8829L10.314 23.8219C7.73846 23.8079 5.61533 21.6924 5.48503 19.0449L5.479 18.7867Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t\tfill-opacity=\"0.24\"\n\t\t\t/>\n\t\t\t<g filter=\"url(#filter2_d_2398_58856)\">\n\t\t\t\t<path\n\t\t\t\t\td=\"M11.4088 14.3314L14.0622 15.0298C14.2548 15.0802 14.2963 15.3467 14.1306 15.4529L13.299 15.9767C14.037 16.8084 15.0811 17.3358 16.2332 17.3556C16.8021 17.3664 17.3403 17.253 17.8282 17.0388C17.9164 16.9992 18.0226 17.0226 18.0874 17.1L19.0577 18.2485C19.1495 18.3565 19.1261 18.5239 19.0055 18.5905C18.1846 19.0478 17.2413 19.2998 16.235 19.2854C14.4205 19.2602 12.7877 18.3709 11.6968 16.9902L10.8633 17.5158C10.6941 17.6221 10.4817 17.4618 10.5267 17.2602L11.1424 14.5006C11.1694 14.3764 11.29 14.3008 11.4106 14.3332L11.4088 14.3314ZM18.2098 7.78058C18.2098 7.62216 18.3592 7.51776 18.4978 7.58436C20.5698 8.58525 22.0153 10.7904 22.0153 13.3035C22.0153 14.0757 21.8785 14.812 21.6301 15.4853L22.5338 16.0163C22.7012 16.1153 22.6778 16.3781 22.4942 16.4339L19.974 17.1954C19.8605 17.2296 19.7381 17.1594 19.7039 17.0388L18.9335 14.344C18.8777 14.1477 19.0739 13.9839 19.2431 14.0829L20.0172 14.5384C20.1414 14.1351 20.2098 13.7049 20.2098 13.2549C20.2098 11.7499 19.4537 10.407 18.3178 9.63474C18.2512 9.58974 18.2098 9.51233 18.2098 9.43133V7.78238V7.78058ZM15.3998 6.11183C15.3998 5.90661 15.6374 5.813 15.776 5.96422L17.6716 8.0254C17.7562 8.11721 17.7562 8.26302 17.6716 8.34943L15.776 10.2738C15.6374 10.4142 15.3998 10.3044 15.3998 10.0992V9.00829H15.3908C13.7166 9.32512 12.4205 10.7454 12.2171 12.551C12.2081 12.6374 12.1541 12.713 12.0749 12.7436L10.6131 13.3125C10.4727 13.3665 10.3161 13.2621 10.3125 13.1037C10.3125 13.0676 10.3125 13.0316 10.3125 12.9956C10.3125 9.89397 12.4997 7.40615 15.3277 7.05691C15.3511 7.05331 15.3745 7.05691 15.398 7.06052V6.11183H15.3998Z\"\n\t\t\t\t\tfill=\"white\"\n\t\t\t\t\tfill-opacity=\"0.9\"\n\t\t\t\t\tshape-rendering=\"crispEdges\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t</svg>\n\t`,\n};\n","const COLORS = {\n\tactive: {\n\t\tlightBlue: '#C4E6FF',\n\t\tprimaryBlue: '#0075FF',\n\t\tsecondaryBlue: '#9BD4FF',\n\t\tsuccessGreen: '#1BCE7B',\n\t},\n\tinactive: {\n\t\tlightBlue: '#F0F0F0',\n\t\tprimaryBlue: '#C8C9CD',\n\t\tsecondaryBlue: '#C8C9CD',\n\t\tsuccessGreen: '#C8C9CD',\n\t},\n};\n\n// @vue/component\nexport const PersonIcon = {\n\tname: 'PersonIcon',\n\tprops:\n\t{\n\t\tactive:\n\t\t{\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tcolors(): { [string]: string }\n\t\t{\n\t\t\treturn this.active\n\t\t\t\t? COLORS.active\n\t\t\t\t: COLORS.inactive;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<svg\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\twidth=\"71\"\n\t\t\theight=\"67\"\n\t\t\tviewBox=\"0 0 71 67\"\n\t\t\tfill=\"none\"\n\t\t>\n\t\t\t<g opacity=\"0.8\">\n\t\t\t\t<path\n\t\t\t\t\td=\"M15.2749 17.5718C15.2749 14.8644 17.3577 12.724 19.9013 12.7906L51.5805 13.6078C53.7929 13.6655 55.5715 15.7302 55.5715 18.2217V45.8523C55.5715 48.3437 53.7929 50.4571 51.5805 50.5741L19.9013 52.2447C17.3559 52.3797 15.2749 50.2951 15.2749 47.5877V17.5718Z\"\n\t\t\t\t\t:fill=\"colors.lightBlue\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t\t<path\n\t\t\t\topacity=\"0.5\"\n\t\t\t\td=\"M26.2736 39.6436C26.2736 39.3952 26.549 39.2494 26.7362 39.3988L27.2439 39.8074V40.0649H27.3033C27.4563 40.0595 27.5805 40.1891 27.5805 40.3547C27.5805 40.5203 27.4563 40.6571 27.3033 40.6625H27.2439V40.9235L26.7362 41.361C26.5508 41.5212 26.2736 41.3934 26.2736 41.145V40.6823C26.1134 40.6769 25.9568 40.6607 25.8038 40.6319C25.6525 40.6049 25.5535 40.4483 25.5841 40.2863C25.6147 40.1225 25.7606 40.0127 25.9136 40.0415C26.0324 40.0631 26.153 40.0775 26.2754 40.0829V39.6418L26.2736 39.6436ZM29.6633 40.5923L28.8784 40.6157C28.7254 40.6211 28.6012 40.4897 28.6012 40.3259C28.6012 40.1621 28.7254 40.0235 28.8784 40.0199L29.6633 39.9965V40.5923ZM23.5536 38.6175C23.6832 38.5221 23.8578 38.5545 23.9442 38.6895C24.171 39.0442 24.4608 39.3484 24.7993 39.5806L24.8425 39.6184C24.9343 39.7156 24.9505 39.8722 24.8767 39.9947C24.7903 40.1351 24.6157 40.1765 24.486 40.0883L24.3384 39.9821C24.0018 39.7246 23.7084 39.4042 23.4744 39.0388C23.3879 38.902 23.4221 38.7147 23.5518 38.6175H23.5536ZM23.1395 35.8381C23.2961 35.8345 23.4221 35.9677 23.4221 36.1333V36.8606C23.4221 37.082 23.4419 37.298 23.4816 37.5068L23.487 37.568C23.487 37.7085 23.3933 37.8363 23.2583 37.8669C23.1053 37.9029 22.9559 37.8003 22.9271 37.6382L22.8965 37.451C22.8695 37.2638 22.8569 37.0694 22.8569 36.8732V36.1441C22.8569 35.9767 22.9829 35.8399 23.1395 35.8363V35.8381ZM23.1395 32.9236C23.2961 32.9218 23.4221 33.055 23.4221 33.2207V34.677L23.4167 34.7382C23.3897 34.8768 23.2763 34.9812 23.1395 34.9848C23.0027 34.9866 22.8893 34.8858 22.8623 34.749L22.8569 34.6878V33.2297C22.8569 33.0622 22.9829 32.9254 23.1395 32.9236ZM23.9136 30.3584C23.9136 30.695 23.7102 30.9831 23.4221 31.1001V31.7661L23.4167 31.8273C23.3897 31.9641 23.2763 32.0704 23.1395 32.0722C23.0027 32.0722 22.8893 31.9713 22.8623 31.8345L22.8569 31.7733V31.0983C22.5797 30.9831 22.3853 30.7022 22.3853 30.3728L23.9136 30.3584Z\"\n\t\t\t\t:fill=\"colors.primaryBlue\"\n\t\t\t\tfill-opacity=\"0.78\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M18.7524 21.2727C18.7524 19.5968 19.8703 18.2539 21.2403 18.2737L46.8331 18.6553C48.0608 18.6733 49.0527 19.9658 49.0527 21.5409V27.2709C49.0527 28.846 48.0626 30.1331 46.8331 30.1439L21.2403 30.3797C19.8685 30.3923 18.7524 29.044 18.7524 27.3663V21.2709V21.2727Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\topacity=\"0.5\"\n\t\t\t\td=\"M24.583 24.3347C24.583 23.6686 25.0733 23.1322 25.6766 23.1358L43.4199 23.233C43.9781 23.2366 44.4301 23.755 44.4301 24.3941C44.4301 25.0331 43.9781 25.548 43.4199 25.548L25.6766 25.5408C25.0733 25.5408 24.583 25.0007 24.583 24.3365V24.3347Z\"\n\t\t\t\t:fill=\"colors.secondaryBlue\"\n\t\t\t\tfill-opacity=\"var(--opacity-80)\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M27.2441 37.4979C27.2441 35.849 28.3242 34.4934 29.6492 34.47L50.3996 34.1028C51.6093 34.0812 52.585 35.3323 52.585 36.8967V42.5834C52.585 44.1477 51.6093 45.4564 50.3996 45.5068L29.6492 46.3763C28.3242 46.4321 27.2441 45.1414 27.2441 43.4924V37.4997V37.4979Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\topacity=\"0.5\"\n\t\t\t\td=\"M38.6587 40.1545C38.6587 39.5083 39.1375 38.9736 39.7244 38.9574L48.5362 38.7162C49.1014 38.7 49.5587 39.2004 49.5587 39.8305C49.5587 40.4606 49.1014 40.988 48.5362 41.006L39.7244 41.2904C39.1357 41.3102 38.6587 40.8008 38.6587 40.1563V40.1545Z\"\n\t\t\t\t:fill=\"colors.secondaryBlue\"\n\t\t\t\tfill-opacity=\"0.8\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\topacity=\"0.7\"\n\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\td=\"M33.2891 44.2326C33.2891 44.2321 33.2895 44.2317 33.29 44.2317C35.2698 44.1556 36.8624 42.3556 36.8624 40.2084C36.8624 38.0608 35.2693 36.356 33.2891 36.3992C31.3089 36.4424 29.6636 38.2444 29.6636 40.4244C29.6636 42.6041 31.2922 44.3068 33.2882 44.2336C33.2887 44.2336 33.2891 44.2331 33.2891 44.2326Z\"\n\t\t\t\t:fill=\"colors.successGreen\"\n\t\t\t\tfill-opacity=\"0.78\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\td=\"M35.057 38.7832C34.9022 38.6194 34.652 38.6248 34.4971 38.7976L32.7708 40.7274L32.0795 39.9965C31.9229 39.8309 31.6691 39.8381 31.5125 40.0127C31.3559 40.1873 31.3559 40.4628 31.5125 40.6284L32.4882 41.6581C32.6448 41.8219 32.8968 41.8147 33.0516 41.6401L35.057 39.3953C35.2118 39.2224 35.2118 38.9488 35.057 38.785V38.7832Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M47.9009 41.2902C47.9009 38.7574 49.7244 36.662 51.9548 36.6116L62.2716 36.3739C64.3849 36.3253 66.0843 38.2605 66.0843 40.6961V52.2712C66.0843 54.7068 64.3849 56.7968 62.2716 56.939L51.9548 57.6392C49.7244 57.7904 47.9009 55.8607 47.9009 53.3278V41.292V41.2902Z\"\n\t\t\t\t:fill=\"colors.primaryBlue\"\n\t\t\t\tfill-opacity=\"0.78\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M65.4675 52.2717V40.6964C65.4675 38.584 64.0607 37.0506 62.4428 36.992L62.2855 36.9905L51.9688 37.2284C50.1397 37.2697 48.5174 39.0223 48.5174 41.2903V53.3278C48.5174 55.5828 50.1133 57.1459 51.9131 57.0239L62.2298 56.3238L62.3901 56.308C64.04 56.0986 65.4673 54.3931 65.4675 52.2717ZM66.084 52.2717L66.0795 52.4983C65.9779 54.8355 64.3187 56.8011 62.2712 56.9389L51.9545 57.6397L51.7468 57.6472C49.6809 57.6683 48.0116 55.9013 47.9061 53.5635L47.9009 53.3278V41.2903C47.9009 38.8368 49.6122 36.7937 51.7468 36.6224L51.9545 36.6119L62.2712 36.374L62.4684 36.3755C64.4895 36.4472 66.084 38.3369 66.084 40.6964V52.2717Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t\tfill-opacity=\"0.18\"\n\t\t\t/>\n\t\t\t<g filter=\"url(#filter1_d_2398_58856)\">\n\t\t\t\t<path\n\t\t\t\t\td=\"M55.5823 41.3313C55.5985 41.3115 55.6183 41.2917 55.6381 41.2755C55.7929 41.1476 56.0143 41.0144 56.2772 40.9082C56.5346 40.8038 56.8064 40.7372 57.0476 40.73C57.9189 40.7012 58.549 41.0936 58.9594 41.6877C59.368 42.2853 59.5588 43.0936 59.5444 43.9073C59.53 44.721 59.3068 45.5472 58.882 46.1755C58.4625 46.8073 57.8433 47.2394 57.0476 47.2754C55.7119 47.3366 54.882 46.2583 54.621 44.9442C54.369 43.6625 54.675 42.1647 55.5823 41.3295V41.3313Z\"\n\t\t\t\t\tfill=\"white\"\n\t\t\t\t\tfill-opacity=\"0.9\"\n\t\t\t\t/>\n\t\t\t\t<path\n\t\t\t\t\td=\"M57.0548 48.4957C59.0565 48.3985 61.2599 49.0267 61.4328 51.9034C61.4328 52.114 61.2833 52.2922 61.0997 52.303L52.9306 52.7729C52.7398 52.7837 52.585 52.6198 52.585 52.4056C52.765 49.4552 55.035 48.5947 57.0548 48.4957Z\"\n\t\t\t\t\tfill=\"white\"\n\t\t\t\t\tfill-opacity=\"0.9\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t\t<path\n\t\t\t\td=\"M5.479 6.25911C5.479 3.49227 7.6554 1.35548 10.3142 1.48509L22.0171 2.05574C24.5301 2.17815 26.5499 4.42835 26.5499 7.08359V19.0997C26.5499 21.7549 24.5301 23.8953 22.0171 23.8827L10.3142 23.8215C7.6554 23.8071 5.479 21.5533 5.479 18.7864V6.25911Z\"\n\t\t\t\t:fill=\"colors.successGreen\"\n\t\t\t\tfill-opacity=\"0.78\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M5.479 18.7867V6.25913C5.47916 3.49251 7.65539 1.3556 10.314 1.48508L22.0173 2.05643C24.5302 2.17897 26.5497 4.42901 26.5497 7.08416V19.0998L26.5437 19.3475C26.4228 21.8869 24.4516 23.895 22.0173 23.8829L22.0203 23.2664C24.157 23.277 25.9332 21.4487 25.9332 19.0998V7.08416C25.9332 4.79933 24.2507 2.89929 22.1882 2.68725L21.9872 2.67219L10.2839 2.10159C7.99746 1.99029 6.09568 3.82433 6.09552 6.25913V18.7867C6.09552 21.2337 8.01739 23.193 10.3178 23.2054L22.0203 23.2664L22.0173 23.8829L10.314 23.8219C7.73846 23.8079 5.61533 21.6924 5.48503 19.0449L5.479 18.7867Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t\tfill-opacity=\"0.24\"\n\t\t\t/>\n\t\t\t<g filter=\"url(#filter2_d_2398_58856)\">\n\t\t\t\t<path\n\t\t\t\t\td=\"M11.4088 14.3314L14.0622 15.0298C14.2548 15.0802 14.2963 15.3467 14.1306 15.4529L13.299 15.9767C14.037 16.8084 15.0811 17.3358 16.2332 17.3556C16.8021 17.3664 17.3403 17.253 17.8282 17.0388C17.9164 16.9992 18.0226 17.0226 18.0874 17.1L19.0577 18.2485C19.1495 18.3565 19.1261 18.5239 19.0055 18.5905C18.1846 19.0478 17.2413 19.2998 16.235 19.2854C14.4205 19.2602 12.7877 18.3709 11.6968 16.9902L10.8633 17.5158C10.6941 17.6221 10.4817 17.4618 10.5267 17.2602L11.1424 14.5006C11.1694 14.3764 11.29 14.3008 11.4106 14.3332L11.4088 14.3314ZM18.2098 7.78058C18.2098 7.62216 18.3592 7.51776 18.4978 7.58436C20.5698 8.58525 22.0153 10.7904 22.0153 13.3035C22.0153 14.0757 21.8785 14.812 21.6301 15.4853L22.5338 16.0163C22.7012 16.1153 22.6778 16.3781 22.4942 16.4339L19.974 17.1954C19.8605 17.2296 19.7381 17.1594 19.7039 17.0388L18.9335 14.344C18.8777 14.1477 19.0739 13.9839 19.2431 14.0829L20.0172 14.5384C20.1414 14.1351 20.2098 13.7049 20.2098 13.2549C20.2098 11.7499 19.4537 10.407 18.3178 9.63474C18.2512 9.58974 18.2098 9.51233 18.2098 9.43133V7.78238V7.78058ZM15.3998 6.11183C15.3998 5.90661 15.6374 5.813 15.776 5.96422L17.6716 8.0254C17.7562 8.11721 17.7562 8.26302 17.6716 8.34943L15.776 10.2738C15.6374 10.4142 15.3998 10.3044 15.3998 10.0992V9.00829H15.3908C13.7166 9.32512 12.4205 10.7454 12.2171 12.551C12.2081 12.6374 12.1541 12.713 12.0749 12.7436L10.6131 13.3125C10.4727 13.3665 10.3161 13.2621 10.3125 13.1037C10.3125 13.0676 10.3125 13.0316 10.3125 12.9956C10.3125 9.89397 12.4997 7.40615 15.3277 7.05691C15.3511 7.05331 15.3745 7.05691 15.398 7.06052V6.11183H15.3998Z\"\n\t\t\t\t\tfill=\"white\"\n\t\t\t\t\tfill-opacity=\"0.9\"\n\t\t\t\t\tshape-rendering=\"crispEdges\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t</svg>\n\t`,\n};\n","const COLORS = {\n\tactive: {\n\t\tlightBlue: '#C4E6FF',\n\t\tprimaryBlue: '#0075FF',\n\t\tsecondaryBlue: '#9BD4FF',\n\t\tsuccessGreen: '#1BCE7B',\n\t},\n\tinactive: {\n\t\tlightBlue: '#F0F0F0',\n\t\tprimaryBlue: '#C8C9CD',\n\t\tsecondaryBlue: '#C8C9CD',\n\t\tsuccessGreen: '#C8C9CD',\n\t},\n};\n\n// @vue/components\nexport const StopIcon = {\n\tname: 'StopIcon',\n\tprops:\n\t{\n\t\tactive:\n\t\t{\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tcolors(): { [string]: string }\n\t\t{\n\t\t\treturn this.active\n\t\t\t\t? COLORS.active\n\t\t\t\t: COLORS.inactive;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<svg\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\twidth=\"71\"\n\t\t\theight=\"67\"\n\t\t\tviewBox=\"0 0 71 67\"\n\t\t\tfill=\"none\"\n\t\t>\n\t\t\t<g opacity=\"0.8\">\n\t\t\t\t<path\n\t\t\t\t\td=\"M15.2749 17.5718C15.2749 14.8644 17.3577 12.724 19.9013 12.7906L51.5805 13.6078C53.7929 13.6655 55.5715 15.7302 55.5715 18.2217V45.8523C55.5715 48.3437 53.7929 50.4571 51.5805 50.5741L19.9013 52.2447C17.3559 52.3797 15.2749 50.2951 15.2749 47.5877V17.5718Z\"\n\t\t\t\t\t:fill=\"colors.lightBlue\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t\t<path\n\t\t\t\topacity=\"0.5\"\n\t\t\t\td=\"M26.2736 39.6436C26.2736 39.3952 26.549 39.2494 26.7362 39.3988L27.2439 39.8074V40.0649H27.3033C27.4563 40.0595 27.5805 40.1891 27.5805 40.3547C27.5805 40.5203 27.4563 40.6571 27.3033 40.6625H27.2439V40.9235L26.7362 41.361C26.5508 41.5212 26.2736 41.3934 26.2736 41.145V40.6823C26.1134 40.6769 25.9568 40.6607 25.8038 40.6319C25.6525 40.6049 25.5535 40.4483 25.5841 40.2863C25.6147 40.1225 25.7606 40.0127 25.9136 40.0415C26.0324 40.0631 26.153 40.0775 26.2754 40.0829V39.6418L26.2736 39.6436ZM29.6633 40.5923L28.8784 40.6157C28.7254 40.6211 28.6012 40.4897 28.6012 40.3259C28.6012 40.1621 28.7254 40.0235 28.8784 40.0199L29.6633 39.9965V40.5923ZM23.5536 38.6175C23.6832 38.5221 23.8578 38.5545 23.9442 38.6895C24.171 39.0442 24.4608 39.3484 24.7993 39.5806L24.8425 39.6184C24.9343 39.7156 24.9505 39.8722 24.8767 39.9947C24.7903 40.1351 24.6157 40.1765 24.486 40.0883L24.3384 39.9821C24.0018 39.7246 23.7084 39.4042 23.4744 39.0388C23.3879 38.902 23.4221 38.7147 23.5518 38.6175H23.5536ZM23.1395 35.8381C23.2961 35.8345 23.4221 35.9677 23.4221 36.1333V36.8606C23.4221 37.082 23.4419 37.298 23.4816 37.5068L23.487 37.568C23.487 37.7085 23.3933 37.8363 23.2583 37.8669C23.1053 37.9029 22.9559 37.8003 22.9271 37.6382L22.8965 37.451C22.8695 37.2638 22.8569 37.0694 22.8569 36.8732V36.1441C22.8569 35.9767 22.9829 35.8399 23.1395 35.8363V35.8381ZM23.1395 32.9236C23.2961 32.9218 23.4221 33.055 23.4221 33.2207V34.677L23.4167 34.7382C23.3897 34.8768 23.2763 34.9812 23.1395 34.9848C23.0027 34.9866 22.8893 34.8858 22.8623 34.749L22.8569 34.6878V33.2297C22.8569 33.0622 22.9829 32.9254 23.1395 32.9236ZM23.9136 30.3584C23.9136 30.695 23.7102 30.9831 23.4221 31.1001V31.7661L23.4167 31.8273C23.3897 31.9641 23.2763 32.0704 23.1395 32.0722C23.0027 32.0722 22.8893 31.9713 22.8623 31.8345L22.8569 31.7733V31.0983C22.5797 30.9831 22.3853 30.7022 22.3853 30.3728L23.9136 30.3584Z\"\n\t\t\t\t:fill=\"colors.primaryBlue\"\n\t\t\t\tfill-opacity=\"0.78\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M18.7524 21.2727C18.7524 19.5968 19.8703 18.2539 21.2403 18.2737L46.8331 18.6553C48.0608 18.6733 49.0527 19.9658 49.0527 21.5409V27.2709C49.0527 28.846 48.0626 30.1331 46.8331 30.1439L21.2403 30.3797C19.8685 30.3923 18.7524 29.044 18.7524 27.3663V21.2709V21.2727Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\topacity=\"0.5\"\n\t\t\t\td=\"M24.583 24.3347C24.583 23.6686 25.0733 23.1322 25.6766 23.1358L43.4199 23.233C43.9781 23.2366 44.4301 23.755 44.4301 24.3941C44.4301 25.0331 43.9781 25.548 43.4199 25.548L25.6766 25.5408C25.0733 25.5408 24.583 25.0007 24.583 24.3365V24.3347Z\"\n\t\t\t\t:fill=\"colors.secondaryBlue\"\n\t\t\t\tfill-opacity=\"var(--opacity-80)\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M27.2441 37.4979C27.2441 35.849 28.3242 34.4934 29.6492 34.47L50.3996 34.1028C51.6093 34.0812 52.585 35.3323 52.585 36.8967V42.5834C52.585 44.1477 51.6093 45.4564 50.3996 45.5068L29.6492 46.3763C28.3242 46.4321 27.2441 45.1414 27.2441 43.4924V37.4997V37.4979Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\topacity=\"0.5\"\n\t\t\t\td=\"M38.6587 40.1545C38.6587 39.5083 39.1375 38.9736 39.7244 38.9574L48.5362 38.7162C49.1014 38.7 49.5587 39.2004 49.5587 39.8305C49.5587 40.4606 49.1014 40.988 48.5362 41.006L39.7244 41.2904C39.1357 41.3102 38.6587 40.8008 38.6587 40.1563V40.1545Z\"\n\t\t\t\t:fill=\"colors.secondaryBlue\"\n\t\t\t\tfill-opacity=\"0.8\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\topacity=\"0.7\"\n\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\td=\"M33.2891 44.2326C33.2891 44.2321 33.2895 44.2317 33.29 44.2317C35.2698 44.1556 36.8624 42.3556 36.8624 40.2084C36.8624 38.0608 35.2693 36.356 33.2891 36.3992C31.3089 36.4424 29.6636 38.2444 29.6636 40.4244C29.6636 42.6041 31.2922 44.3068 33.2882 44.2336C33.2887 44.2336 33.2891 44.2331 33.2891 44.2326Z\"\n\t\t\t\t:fill=\"colors.successGreen\"\n\t\t\t\tfill-opacity=\"0.78\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\td=\"M35.057 38.7832C34.9022 38.6194 34.652 38.6248 34.4971 38.7976L32.7708 40.7274L32.0795 39.9965C31.9229 39.8309 31.6691 39.8381 31.5125 40.0127C31.3559 40.1873 31.3559 40.4628 31.5125 40.6284L32.4882 41.6581C32.6448 41.8219 32.8968 41.8147 33.0516 41.6401L35.057 39.3953C35.2118 39.2224 35.2118 38.9488 35.057 38.785V38.7832Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\td=\"M47.9009 41.2902C47.9009 38.7574 49.7244 36.662 51.9548 36.6116L62.2716 36.3739C64.3849 36.3253 66.0843 38.2605 66.0843 40.6961V52.2712C66.0843 54.7068 64.3849 56.7968 62.2716 56.939L51.9548 57.6392C49.7244 57.7904 47.9009 55.8607 47.9009 53.3278V41.292V41.2902Z\"\n\t\t\t\t:fill=\"colors.primaryBlue\"\n\t\t\t\tfill-opacity=\"0.78\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\td=\"M47.8608 41.2382C47.8608 38.709 49.6808 36.6172 51.9076 36.5668L62.2063 36.331C64.3161 36.2824 66.0119 38.2157 66.0119 40.6478V52.2066C66.0119 54.6386 64.3161 56.725 62.2063 56.8672L51.9076 57.5621C49.6808 57.7115 47.8608 55.7853 47.8608 53.2561V41.2364V41.2382Z\"\n\t\t\t\t:fill=\"colors.primaryBlue\"\n\t\t\t\tfill-opacity=\"0.78\"\n\t\t\t/>\n\t\t\t<g filter=\"url(#filter1_d_2398_58856)\">\n\t\t\t\t<path\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\t\td=\"M59.0084 45.4018C59.0084 45.3644 59.0119 45.327 59.0191 45.2897C59.0725 45.0405 59.286 44.8803 59.4978 44.9337L61.3275 45.3947C61.5019 45.4392 61.6229 45.6171 61.6229 45.8289V50.072L62.091 50.0471C62.1907 50.0418 62.2726 50.1308 62.2726 50.2465V51.3589C62.2726 51.4745 62.1907 51.5724 62.091 51.5778L51.8482 52.1562C51.7431 52.1616 51.6577 52.0708 51.6577 51.9533V50.8142C51.6577 50.6968 51.7431 50.5953 51.8482 50.59L52.3358 50.5633V42.9812C52.3358 42.5968 52.5761 42.2622 52.9036 42.1892L57.5827 41.1445C57.6183 41.1373 57.6539 41.132 57.6895 41.1302C58.0544 41.1178 58.3498 41.4541 58.3498 41.8813V50.2447L59.0084 50.2091V45.4018ZM55.2369 50.3337V47.9434L54.0356 48.0003V50.3977L55.2369 50.3337ZM57.0577 49.2159V47.8562L55.8652 47.9131V49.2765L57.0577 49.2159ZM60.8612 47.6088L59.6883 47.6639V49.0166L60.8612 48.9579V47.6088ZM57.0577 43.7074L55.8652 43.7537V45.117L57.0577 45.0672V43.7074ZM55.2369 43.7786L54.0356 43.8249V45.1936L55.2369 45.1437V43.7786ZM57.0577 45.7827L55.8652 45.8343V47.1976L57.0577 47.1425V45.7827ZM55.2369 45.861L54.0356 45.9126V47.2813L55.2369 47.2261V45.861Z\"\n\t\t\t\t\tfill=\"white\"\n\t\t\t\t\tfill-opacity=\"0.9\"\n\t\t\t\t\tshape-rendering=\"crispEdges\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t\t<path\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\td=\"M65.3957 52.2278V40.6525C65.3957 38.54 63.9889 37.0067 62.3711 36.9481L62.2137 36.9466L51.8971 37.1845C50.068 37.2258 48.4456 38.9784 48.4456 41.2464V53.2839C48.4456 55.5388 50.0415 57.102 51.8413 56.98L62.158 56.2799L62.3184 56.2641C63.9682 56.0547 65.3955 54.3492 65.3957 52.2278ZM66.0122 52.2278L66.0077 52.4543C65.9062 54.7916 64.2469 56.7571 62.1994 56.8949L51.8828 57.5957L51.675 57.6033C49.6091 57.6243 47.9398 55.8574 47.8344 53.5195L47.8291 53.2839V41.2464C47.8291 38.7928 49.5404 36.7497 51.675 36.5785L51.8828 36.568L62.1994 36.3301L62.3966 36.3316C64.4177 36.4032 66.0122 38.293 66.0122 40.6525V52.2278Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t\tfill-opacity=\"0.18\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\td=\"M5.479 6.24833C5.479 3.48688 7.6482 1.35549 10.3016 1.4851L21.9721 2.05395C24.4797 2.17637 26.4923 4.42116 26.4923 7.0692V19.0547C26.4923 21.7027 24.4779 23.8377 21.9721 23.8251L10.3016 23.7639C7.65 23.7495 5.479 21.5011 5.479 18.7414L5.479 6.24833Z\"\n\t\t\t\t:fill=\"colors.successGreen\"\n\t\t\t\tfill-opacity=\"0.78\"\n\t\t\t/>\n\t\t\t<path\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\td=\"M5.479 18.7415V6.24861C5.47903 3.48719 7.64856 1.35549 10.302 1.4851L21.9721 2.05419C24.4797 2.17663 26.4925 4.42186 26.4925 7.06988V19.0547L26.4865 19.3016C26.366 21.8343 24.3997 23.8379 21.9721 23.8257L21.9751 23.2085C24.1046 23.2192 25.876 21.3965 25.876 19.0547V7.06988C25.876 4.79165 24.1994 2.89728 22.1423 2.68577L21.942 2.66996L10.2719 2.10162C7.99098 1.9902 6.09555 3.81866 6.09552 6.24861V18.7415C6.09552 21.1815 8.01184 23.135 10.305 23.1475L21.9751 23.2085L21.9721 23.8257L10.302 23.764C7.73322 23.75 5.61488 21.6398 5.48503 18.999L5.479 18.7415Z\"\n\t\t\t\tfill=\"white\"\n\t\t\t\tfill-opacity=\"0.24\"\n\t\t\t/>\n\t\t\t<g\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\tfilter=\"url(#filter1_d_2398_60753)\"\n\t\t\t>\n\t\t\t\t<path\n\t\t\t\t\td=\"M11.3891 14.2954L11.3928 14.2969L13.2537 14.7869C13.4103 15.0803 13.6068 15.3503 13.8318 15.5879L13.277 15.9387C14.0132 16.7667 15.0539 17.2941 16.2023 17.314C16.7693 17.3248 17.3061 17.212 17.7921 16.9978C17.8802 16.9582 17.9847 16.9811 18.0495 17.0565L19.0161 18.2015C19.1079 18.3095 19.0847 18.4774 18.9642 18.544C18.1451 18.9994 17.2052 19.2509 16.2007 19.2365C14.3917 19.2113 12.7624 18.3244 11.6751 16.9474L10.8456 17.4713C10.6764 17.5775 10.4634 17.4169 10.5083 17.2154L11.1226 14.4625C11.1497 14.3385 11.2704 14.2648 11.3891 14.2954Z\"\n\t\t\t\t\tfill=\"white\"\n\t\t\t\t\tfill-opacity=\"0.9\"\n\t\t\t\t\tshape-rendering=\"crispEdges\"\n\t\t\t\t/>\n\t\t\t\t<path\n\t\t\t\t\td=\"M18.1753 7.76436C18.1753 7.60604 18.325 7.50141 18.4636 7.56789C20.5301 8.56514 21.9721 10.767 21.9722 13.2709C21.9722 14.0413 21.8349 14.7764 21.5883 15.4479L22.4901 15.977C22.6575 16.076 22.6327 16.3367 22.451 16.3926L19.9382 17.1521C19.8248 17.1863 19.7037 17.1162 19.6695 16.9955L19.0899 14.9721C19.2303 14.7237 19.3422 14.4556 19.4196 14.1712L19.9811 14.5024C20.1053 14.101 20.1716 13.6708 20.1716 13.2227C20.1716 11.7214 19.4176 10.3821 18.2837 9.61165C18.217 9.56665 18.1753 9.48866 18.1753 9.40765V7.76436Z\"\n\t\t\t\t\tfill=\"white\"\n\t\t\t\t\tfill-opacity=\"0.9\"\n\t\t\t\t\tshape-rendering=\"crispEdges\"\n\t\t\t\t/>\n\t\t\t\t<path\n\t\t\t\t\td=\"M17.4315 11.2376C17.723 11.2464 17.9547 11.4857 17.9547 11.7774V14.5144C17.9547 14.8162 17.7069 15.0596 17.4052 15.0542L14.9798 15.0105C14.6857 15.005 14.4506 14.7649 14.4506 14.4708V11.7043C14.4506 11.4 14.7019 11.1554 15.0061 11.1646L17.4315 11.2376Z\"\n\t\t\t\t\tfill=\"white\"\n\t\t\t\t\tfill-opacity=\"0.9\"\n\t\t\t\t\tshape-rendering=\"crispEdges\"\n\t\t\t\t/>\n\t\t\t\t<path\n\t\t\t\t\td=\"M15.3712 6.09924C15.3712 5.89407 15.6067 5.8023 15.7453 5.9517L17.6355 8.00751C17.72 8.09925 17.7199 8.24478 17.6355 8.3312L16.3844 9.60036C16.3232 9.59496 16.2637 9.59162 16.2007 9.58982C15.9145 9.58082 15.6354 9.60812 15.3689 9.67112V8.98836H15.3599C13.6912 9.30522 12.3969 10.7203 12.1953 12.5203C12.1863 12.6067 12.1326 12.6809 12.0553 12.7115L10.5987 13.2784C10.4583 13.3324 10.3016 13.228 10.2998 13.0714V12.9652C10.2998 9.87256 12.4818 7.39018 15.3027 7.04095C15.326 7.03741 15.3497 7.04113 15.3712 7.04472V6.09924Z\"\n\t\t\t\t\tfill=\"white\"\n\t\t\t\t\tfill-opacity=\"0.9\"\n\t\t\t\t\tshape-rendering=\"crispEdges\"\n\t\t\t\t/>\n\t\t\t</g>\n\t\t</svg>\n\t`,\n};\n","import { Connection, DeleteConnectionBtn } from 'ui.block-diagram';\n\n// eslint-disable-next-line no-unused-vars\nimport type { Connection as TConnection } from '../../../../shared/types';\n\n// @vue/components\nexport const ConnectionAux = {\n\tname: 'connection-aux',\n\tcomponents: { Connection, DeleteConnectionBtn },\n\tprops:\n\t{\n\t\t/** @type TConnection */\n\t\tconnection:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Connection\n\t\t\t:stroke-dasharray=\"5\"\n\t\t\t:connection=\"connection\"\n\t\t\t:key=\"connection.id\"\n\t\t>\n\t\t\t<template #default=\"{ isDisabled }\">\n\t\t\t\t<DeleteConnectionBtn\n\t\t\t\t\t:connectionId=\"connection.id\"\n\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</Connection>\n\t`,\n};\n","import { ajax } from 'main.core';\nimport type { ActivityData } from '../../shared/types';\nimport type { ActionDictEntry, NodeSettings, Rule } from './types';\n\nconst post = async (action: string, data: Object): Promise<Object | null> => {\n\tconst response = await ajax.runAction(`bizprocdesigner.v2.${action}`, {\n\t\tmethod: 'POST',\n\t\tjson: data,\n\t});\n\n\tif (response.status === 'success')\n\t{\n\t\treturn response.data;\n\t}\n\n\treturn null;\n};\n\nexport type ComplexNodeLoadSettingsPayload = {\n\ttitle: string,\n\tdescription: string,\n\trules: Record<Rule[\"portId\"], Rule>,\n\tactionDictionary: Record<string, ActionDictEntry>,\n}\n\nexport const complexNodeApi = Object.freeze({\n\tloadSettings: async (activity: ActivityData): ComplexNodeLoadSettingsPayload | null => {\n\t\tconst data = await post('Activity.Complex.loadSettings', { activity });\n\t\tif (!data)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn data;\n\t},\n\tsaveSettings: async (\n\t\tsettings: NodeSettings,\n\t\tactivity: ActivityData,\n\t\tdocumentType,\n\t): ActivityData | null => {\n\t\tconst nodeSettingsPayload = {\n\t\t\t...settings,\n\t\t\trules: Object.fromEntries(settings.rules),\n\t\t\tactions: Object.fromEntries(settings.actions),\n\t\t};\n\n\t\tconst data = await post('Activity.Complex.saveSettings', {\n\t\t\tsaveSettingsRequest: nodeSettingsPayload,\n\t\t\tactivity,\n\t\t\tdocumentType,\n\t\t});\n\t\tif (!data?.activity)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn data.activity;\n\t},\n\tsaveRuleSettings: async (rule: Rule, documentType): Promise<Rule | null> => {\n\t\tconst data = await post('Activity.Complex.saveRule', {\n\t\t\tportRule: rule,\n\t\t\tdocumentType,\n\t\t});\n\t\tif (!data)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn data;\n\t},\n});\n","export const CONSTRUCTION_TYPES = Object.freeze({\n\tIF_CONDITION: 'condition:if',\n\tAND_CONDITION: 'condition:and',\n\tOR_CONDITION: 'condition:or',\n\tACTION: 'action',\n\tOUTPUT: 'output',\n});\n\nexport const CONSTRUCTION_LABELS = Object.freeze({\n\t[CONSTRUCTION_TYPES.IF_CONDITION]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_IF_CONDITION',\n\t[CONSTRUCTION_TYPES.AND_CONDITION]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_AND_CONDITION',\n\t[CONSTRUCTION_TYPES.OR_CONDITION]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_OR_CONDITION',\n\t[CONSTRUCTION_TYPES.ACTION]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ACTION',\n\t[CONSTRUCTION_TYPES.OUTPUT]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_OUTPUT',\n});\n\nexport const GENERAL_CONSTRUCTION_TYPES = Object.freeze({\n\t[CONSTRUCTION_TYPES.IF_CONDITION]: 'condition',\n\t[CONSTRUCTION_TYPES.AND_CONDITION]: 'condition',\n\t[CONSTRUCTION_TYPES.OR_CONDITION]: 'condition',\n\t[CONSTRUCTION_TYPES.ACTION]: 'action',\n\t[CONSTRUCTION_TYPES.OUTPUT]: 'output',\n});\n\nexport const CONSTRUCTION_OPERATORS = Object.freeze({\n\tequal: '=',\n\tnotEqual: '!=',\n\tempty: 'empty',\n\tnotEmpty: '!empty',\n\tcontain: 'contain',\n\tnotContain: '!contain',\n\tin: 'in',\n\tnotIn: '!in',\n\tgreaterThan: '>',\n\tgreaterThanOrEqual: '>=',\n\tlessThan: '<',\n\tlessThanOrEqual: '<=',\n});\n\nexport const FIELD_OBJECT_TYPES = Object.freeze({\n\tDOCUMENT: 'Document',\n\tCONSTANT: 'Constant',\n\tPARAMETER: 'Template',\n\tVARIABLE: 'Variable',\n});\n\nexport const EVENT_NAMES = Object.freeze({\n\tBEFORE_SUBMIT_EVENT: 'BizprocDesigner.NodeSettings.BeforeSubmit',\n});\n","import { Loc, Type } from 'main.core';\nimport type { ActivityData, Port, Ports } from '../../../shared/types';\nimport { diagramStore } from '../../blocks';\nimport { FIELD_OBJECT_TYPES } from '../constants';\nimport { type ConditionExpressionField } from '../types';\n\nexport const generateNextInputPortId = (ports: Array<Ports>) => {\n\tconst nextPortNumber = ports.reduce(\n\t\t(acc, currentValue: Port) => Math.max(acc, parseInt(currentValue.id.slice(1), 10)),\n\t\t0,\n\t) + 1;\n\n\treturn `i${nextPortNumber}`;\n};\n\nexport const evaluateConditionExpressionFieldTitle = (\n\tconnectedBlocks: Block[],\n\tfield: ConditionExpressionField,\n): string => {\n\tconst store = diagramStore();\n\n\tconst { object, fieldId } = field;\n\n\tconst fieldIdParts = fieldId.split('.');\n\tconst fieldIdProperty = fieldIdParts[0] ?? null;\n\tconst makeTitle = (parts: Array<?string>) => (parts.filter(Boolean).join(' / '));\n\n\tconst failoverTitle = makeTitle([object, fieldId]);\n\n\t/** @todo optimize this logic later */\n\tif (!Object.values(FIELD_OBJECT_TYPES).includes(object))\n\t{\n\t\tconst [foundBlock, foundActivity] = (() => {\n\t\t\tfor (const block of connectedBlocks)\n\t\t\t{\n\t\t\t\tconst { activity } = block;\n\t\t\t\tif (activity?.Name === object)\n\t\t\t\t{\n\t\t\t\t\treturn [block, activity];\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isArrayFilled(activity?.Children))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst childrenActivity = activity.Children.find((child: ActivityData) => {\n\t\t\t\t\treturn child.Name === object;\n\t\t\t\t});\n\n\t\t\t\tif (childrenActivity)\n\t\t\t\t{\n\t\t\t\t\treturn [block, childrenActivity];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn [null, null];\n\t\t})();\n\n\t\tif (!foundBlock || !foundActivity)\n\t\t{\n\t\t\treturn failoverTitle;\n\t\t}\n\t\tconst foundProperty = (foundActivity.ReturnProperties ?? []).find((prop) => prop.Id === fieldIdProperty);\n\t\tif (!foundProperty)\n\t\t{\n\t\t\treturn failoverTitle;\n\t\t}\n\n\t\treturn makeTitle([\n\t\t\tfoundActivity.Properties?.Title ?? foundBlock.node.title,\n\t\t\tfoundProperty.Name,\n\t\t\t...fieldIdParts.slice(1),\n\t\t]);\n\t}\n\n\tconst map = [\n\t\t{\n\t\t\tkey: 'PARAMETERS',\n\t\t\tidKey: 'Template',\n\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_FIELD_PARAMETER_OBJECT'),\n\t\t},\n\t\t{\n\t\t\tkey: 'VARIABLES',\n\t\t\tidKey: 'Variable',\n\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_FIELD_VARIABLE_OBJECT'),\n\t\t},\n\t\t{\n\t\t\tkey: 'CONSTANTS',\n\t\t\tidKey: 'Constant',\n\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_FIELD_CONSTANT_OBJECT'),\n\t\t},\n\t];\n\n\tconst foundObject = map.find((elem) => elem.idKey === object);\n\tif (!foundObject)\n\t{\n\t\treturn failoverTitle;\n\t}\n\n\tconst fieldName = (store.template[foundObject.key] ?? {})[fieldId]?.Name;\n\tif (fieldName)\n\t{\n\t\treturn makeTitle([foundObject.title, fieldName]);\n\t}\n\n\treturn failoverTitle;\n};\n\nexport const evaluateActionExpressionDocumentTitle = (\n\tconnectedBlocks: Block[],\n\tdocument: string | null,\n): string => {\n\tif (!document)\n\t{\n\t\treturn Loc.getMessage('BIZPROCDESIGNER_EDITOR_TEMPLATE_DOCUMENT');\n\t}\n\n\tconst [object, fieldId] = document\n\t\t.replaceAll(/^{=|}$/g, '')\n\t\t.split(':')\n\t;\n\tif (!Type.isStringFilled(object) || !Type.isStringFilled(fieldId))\n\t{\n\t\treturn Loc.getMessage('BIZPROCDESIGNER_EDITOR_UNKNOWN_DOCUMENT');\n\t}\n\n\tconst [foundBlock, foundActivity] = (() => {\n\t\tfor (const block of connectedBlocks)\n\t\t{\n\t\t\tconst { activity } = block;\n\t\t\tif (activity?.Name === object)\n\t\t\t{\n\t\t\t\treturn [block, activity];\n\t\t\t}\n\n\t\t\tif (!Type.isArrayFilled(activity?.Children))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst childrenActivity = activity.Children.find((child: ActivityData) => {\n\t\t\t\treturn child.Name === object;\n\t\t\t});\n\n\t\t\tif (childrenActivity)\n\t\t\t{\n\t\t\t\treturn [block, childrenActivity];\n\t\t\t}\n\t\t}\n\n\t\treturn [null, null];\n\t})();\n\tif (!foundActivity)\n\t{\n\t\treturn Loc.getMessage('BIZPROCDESIGNER_EDITOR_UNKNOWN_DOCUMENT');\n\t}\n\n\tconst property = (foundActivity.ReturnProperties ?? []).find((prop) => prop.Id === fieldId);\n\tif (!property)\n\t{\n\t\treturn Loc.getMessage('BIZPROCDESIGNER_EDITOR_UNKNOWN_DOCUMENT');\n\t}\n\n\tconst objectTitle = foundActivity.Properties?.Title ?? foundBlock.node.title;\n\n\treturn `${property.Name} (${objectTitle})`;\n};\n","import { defineStore } from 'ui.vue3.pinia';\nimport { Runtime, Type } from 'main.core';\n\nimport type { Block, PortId, Port, ActivityData } from '../../../shared/types';\n\nimport { createUniqueId } from '../../../shared/utils';\nimport { complexNodeApi } from '../api';\nimport { CONSTRUCTION_TYPES } from '../constants';\n\nimport type { Construction, TRuleCard, NodeSettings, OrderPayload, OutputConstruction } from '../types';\nimport { generateNextInputPortId } from '../utils';\n\ntype NodesSettingsState = {\n\tisLoading: boolean;\n\tisShown: boolean;\n\tisRuleSettingsShown: boolean;\n\tcurrentRuleId: string;\n\tnodeSettings: NodeSettings | null;\n\tblock: Block | null,\n};\n\ntype SyncOutputPorts = {\n\toutputPortsToAdd: Map<PortId, Partial<Port>>,\n\toutputPortsToDelete: Set<PortId>,\n};\n\ntype SavedRule = {\n\toutputPortsToAdd: Map<PortId, { portId: PortId, title: string; }>,\n\toutputPortsToDelete: Set<PortId>,\n};\n\nexport const useNodeSettingsStore = defineStore('bizprocdesigner-editor-node-settings', {\n\tstate: (): NodesSettingsState => ({\n\t\tisLoading: false,\n\t\tisSaving: false,\n\t\tisShown: false,\n\t\tisRuleSettingsShown: false,\n\t\tcurrentRuleId: '',\n\t\tprevSavedNodeSettings: null,\n\t\tsavedBlockInputPorts: null,\n\t\tnodeSettings: null,\n\t\tblock: null,\n\t}),\n\tactions:\n\t{\n\t\tasync fetchNodeSettings(block: Block): Promise<void>\n\t\t{\n\t\t\tthis.nodeSettings = {\n\t\t\t\ttitle: block.node.title,\n\t\t\t\tdescription: '',\n\t\t\t\trules: new Map(),\n\t\t\t\tblockId: block.id,\n\t\t\t};\n\t\t\tthis.isLoading = true;\n\t\t\tconst {\n\t\t\t\tactions,\n\t\t\t\trules,\n\t\t\t\tfixedDocumentType,\n\t\t\t\ttitle: loadedTitle,\n\t\t\t\tdescription,\n\t\t\t} = await complexNodeApi.loadSettings(block.activity);\n\n\t\t\tif (Type.isStringFilled(loadedTitle))\n\t\t\t{\n\t\t\t\tthis.nodeSettings.title = loadedTitle;\n\t\t\t}\n\n\t\t\tthis.nodeSettings = {\n\t\t\t\t...this.nodeSettings,\n\t\t\t\tactions: new Map(Object.entries(actions)),\n\t\t\t\trules: new Map(\n\t\t\t\t\tObject.entries(rules).map(([id, rule]) => {\n\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\tid, {\n\t\t\t\t\t\t\t\t...rule,\n\t\t\t\t\t\t\t\tisFilled: rule.ruleCards.some((ruleCard) => {\n\t\t\t\t\t\t\t\t\treturn ruleCard.constructions?.length > 0;\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t];\n\t\t\t\t\t}),\n\t\t\t\t),\n\t\t\t\tfixedDocumentType,\n\t\t\t\tdescription,\n\t\t\t};\n\t\t\tthis.prevSavedNodeSettings = Runtime.clone(this.nodeSettings);\n\t\t\tthis.savedBlockInputPorts = block.ports.input.map((port) => {\n\t\t\t\treturn { ...port };\n\t\t\t});\n\t\t\tthis.block = block;\n\t\t\tthis.isLoading = false;\n\t\t},\n\t\tisCurrentBlock(blockId: string): boolean\n\t\t{\n\t\t\treturn this.nodeSettings?.blockId === blockId;\n\t\t},\n\t\treset(): void\n\t\t{\n\t\t\tthis.currentRuleId = '';\n\t\t\tthis.nodeSettings = null;\n\t\t\tthis.block = null;\n\t\t},\n\t\ttoggleVisibility(isShown: boolean): void\n\t\t{\n\t\t\tthis.isShown = isShown;\n\t\t},\n\t\ttoggleRuleSettingsVisibility(isShown: boolean): void\n\t\t{\n\t\t\tthis.isRuleSettingsShown = isShown;\n\t\t},\n\t\tsetCurrentRuleId(ruleId: string): void\n\t\t{\n\t\t\tthis.currentRuleId = ruleId;\n\t\t},\n\t\taddRule(): string\n\t\t{\n\t\t\tconst nextPortId = generateNextInputPortId(this.block.ports.input);\n\n\t\t\tthis.nodeSettings.rules.set(nextPortId, {\n\t\t\t\tisFilled: false,\n\t\t\t\tportId: nextPortId,\n\t\t\t\truleCards: [],\n\t\t\t});\n\n\t\t\treturn nextPortId;\n\t\t},\n\t\taddConstruction(ruleCard: TRuleCard, constructionType: string, position: ?number): void\n\t\t{\n\t\t\tconst newConstruction = {\n\t\t\t\tid: createUniqueId(),\n\t\t\t\ttype: constructionType,\n\t\t\t\texpression: {\n\t\t\t\t\ttitle: '',\n\t\t\t\t\tvalueId: '',\n\t\t\t\t\tvalue: '',\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tif (constructionType === CONSTRUCTION_TYPES.ACTION)\n\t\t\t{\n\t\t\t\tnewConstruction.expression.value = {};\n\t\t\t\tnewConstruction.expression.actionId = '';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnewConstruction.expression.operator = '';\n\t\t\t\tnewConstruction.expression.field = null;\n\t\t\t}\n\n\t\t\tif (constructionType === CONSTRUCTION_TYPES.OUTPUT)\n\t\t\t{\n\t\t\t\tnewConstruction.expression = {\n\t\t\t\t\tportId: null,\n\t\t\t\t\ttitle: null,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (position)\n\t\t\t{\n\t\t\t\truleCard.constructions.splice(position, 0, newConstruction);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\truleCard.constructions.push(newConstruction);\n\t\t\t}\n\t\t},\n\t\tdeleteConstruction(ruleCard: TRuleCard, construction: Construction): void\n\t\t{\n\t\t\truleCard.constructions.splice(ruleCard.constructions.indexOf(construction), 1);\n\t\t\tif (ruleCard.constructions.length === 0)\n\t\t\t{\n\t\t\t\tthis.deleteRuleCard(ruleCard);\n\t\t\t}\n\t\t},\n\t\tdeleteRuleSettings(ruleId: string): SyncOutputPorts | null\n\t\t{\n\t\t\tthis.nodeSettings.rules.delete(ruleId);\n\n\t\t\treturn this.syncOutputPortsWithRules();\n\t\t},\n\t\tselectBooleanType(construction: Construction, type: string): void\n\t\t{\n\t\t\tObject.assign(construction, { type });\n\t\t},\n\t\tchangeRuleExpression(construction: Construction, props: Partial<Construction['expression']>): void\n\t\t{\n\t\t\tObject.assign(construction.expression, props);\n\t\t},\n\t\tdeleteRuleCard(ruleCard: TRuleCard): void\n\t\t{\n\t\t\tconst rule = this.nodeSettings.rules.get(this.currentRuleId);\n\t\t\trule.ruleCards.splice(rule.ruleCards.indexOf(ruleCard), 1);\n\t\t},\n\t\taddRuleCard(): TRuleCard\n\t\t{\n\t\t\tconst rule = this.nodeSettings.rules.get(this.currentRuleId);\n\t\t\tconst ruleCard = {\n\t\t\t\tid: createUniqueId(),\n\t\t\t\tconstructions: [],\n\t\t\t};\n\t\t\trule.ruleCards.push(ruleCard);\n\n\t\t\treturn ruleCard;\n\t\t},\n\t\treorder(payload: OrderPayload): void\n\t\t{\n\t\t\tconst { draggedId, targetId, insertion, ruleCardId } = payload;\n\t\t\tconst rule = this.nodeSettings.rules.get(this.currentRuleId);\n\t\t\tlet collection = rule.ruleCards;\n\t\t\tif (ruleCardId)\n\t\t\t{\n\t\t\t\tconst ruleCard = rule.ruleCards.find((currentRuleCard) => currentRuleCard.id === ruleCardId);\n\t\t\t\tcollection = ruleCard.constructions;\n\t\t\t}\n\n\t\t\tconst draggedItem = collection.find((item) => item.id === draggedId);\n\t\t\tconst targetItem = collection.find((item) => item.id === targetId);\n\t\t\tconst draggedIndex = collection.indexOf(draggedItem);\n\t\t\tcollection.splice(draggedIndex, 1);\n\t\t\tconst targetIndex = collection.indexOf(targetItem);\n\t\t\tconst newDraggedIndex = insertion === 'over' ? targetIndex : targetIndex + 1;\n\t\t\tcollection.splice(newDraggedIndex, 0, draggedItem);\n\t\t},\n\t\tasync savePortRule(ruleId: string, documentType: Array<string>): Promise<SyncOutputPorts | null>\n\t\t{\n\t\t\tconst rule = this.nodeSettings.rules.get(ruleId);\n\t\t\tif (!rule)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst transformedPortRule = await complexNodeApi.saveRuleSettings(rule, documentType);\n\t\t\ttransformedPortRule.isFilled = transformedPortRule.ruleCards.some((ruleCard) => {\n\t\t\t\treturn ruleCard.constructions?.length > 0;\n\t\t\t});\n\t\t\tthis.nodeSettings.rules.set(ruleId, transformedPortRule);\n\t\t\tthis.prevSavedNodeSettings.rules.set(ruleId, Runtime.clone(transformedPortRule));\n\n\t\t\treturn this.syncOutputPortsWithRules();\n\t\t},\n\t\tsyncOutputPortsWithRules(): SyncOutputPorts | null\n\t\t{\n\t\t\tif (!this.block)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst outputConstructions = [...this.nodeSettings.rules.values()].flatMap((r) => {\n\t\t\t\treturn r.ruleCards.flatMap((ruleCard) => {\n\t\t\t\t\treturn ruleCard.constructions.filter((construction) => construction.type === CONSTRUCTION_TYPES.OUTPUT);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst allExistingOutputPortIds = new Set(this.block.ports.output.map((port) => port.id));\n\t\t\tconst toDeletePortIds = new Set(allExistingOutputPortIds);\n\t\t\tconst toAddPortsMap: Map<string, { portId: string, title: string }> = new Map();\n\n\t\t\toutputConstructions.forEach((construction: OutputConstruction) => {\n\t\t\t\tconst { portId, title } = construction.expression;\n\t\t\t\tif (!portId || !title)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst isPortExist = allExistingOutputPortIds.has(portId);\n\t\t\t\tif (!isPortExist)\n\t\t\t\t{\n\t\t\t\t\ttoAddPortsMap.set(portId, { portId, title });\n\t\t\t\t}\n\n\t\t\t\ttoDeletePortIds.delete(portId);\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\toutputPortsToAdd: toAddPortsMap,\n\t\t\t\toutputPortsToDelete: toDeletePortIds,\n\t\t\t};\n\t\t},\n\t\tasync saveRule(documentType: Array<string>): Promise<SavedRule>\n\t\t{\n\t\t\tconst {\n\t\t\t\toutputPortsToAdd,\n\t\t\t\toutputPortsToDelete,\n\t\t\t} = await this.savePortRule(this.currentRuleId, documentType);\n\t\t\tthis.toggleRuleSettingsVisibility(false);\n\n\t\t\treturn {\n\t\t\t\toutputPortsToAdd,\n\t\t\t\toutputPortsToDelete,\n\t\t\t};\n\t\t},\n\t\tasync saveForm(documentType: string): Promise<ActivityData>\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\treturn await complexNodeApi.saveSettings(\n\t\t\t\t\tthis.nodeSettings,\n\t\t\t\t\tthis.block.activity,\n\t\t\t\t\tdocumentType,\n\t\t\t\t);\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\tconsole.error(e);\n\t\t\t\tthrow e;\n\t\t\t}\n\t\t},\n\t\tdiscardFormSettings(): void\n\t\t{\n\t\t\tthis.nodeSettings = Runtime.clone(this.prevSavedNodeSettings);\n\t\t},\n\t\tdiscardRuleSettings(): void\n\t\t{\n\t\t\tconst { rules: prevSavedRules } = this.prevSavedNodeSettings;\n\t\t\tif (!prevSavedRules.has(this.currentRuleId))\n\t\t\t{\n\t\t\t\tconst currentRule = this.nodeSettings.rules.get(this.currentRuleId);\n\t\t\t\tcurrentRule.isFilled = false;\n\t\t\t\tcurrentRule.ruleCards = [];\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst copyRule = Runtime.clone(prevSavedRules.get(this.currentRuleId));\n\t\t\tthis.nodeSettings.rules.set(this.currentRuleId, copyRule);\n\t\t},\n\t\tupdateSettings(settings: Partial<NodeSettings>): void\n\t\t{\n\t\t\tthis.nodeSettings = {\n\t\t\t\t...this.nodeSettings,\n\t\t\t\t...settings,\n\t\t\t};\n\t\t},\n\t},\n});\n","import './style.css';\n\nimport { BIcon } from 'ui.icon-set.api.vue';\n\nimport { useLoc } from '../../../../shared/composables';\n\n// @vue/component\nexport const NodeSettingsLayout = {\n\tname: 'node-settings-layout',\n\tcomponents: { BIcon },\n\tprops:\n\t{\n\t\tisLoading:\n\t\t{\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tisSaving:\n\t\t{\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tisShown:\n\t\t{\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tsetup(): { getMessage: () => string; }\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn { getMessage };\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"isShown\"\n\t\t\tclass=\"node-settings\"\n\t\t\t:class=\"{ '--saving': isSaving, '--loading': isLoading }\"\n\t\t>\n\t\t\t<template v-if=\"!isLoading\">\n\t\t\t\t<div class=\"node-settings__header\">\n\t\t\t\t\t<span>{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_TITLE') }}</span>\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\tclass=\"node-settings__header_close-icon\"\n\t\t\t\t\t\tname=\"cross-m\"\n\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\t:data-test-id=\"$testId('complexNodeSettingsClose')\"\n\t\t\t\t\t\tcolor=\"#828b95\"\n\t\t\t\t\t\t@click=\"$emit('close')\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<slot />\n\t\t\t</template>\n\t\t\t<div class=\"node-settings__footer\">\n\t\t\t\t<slot\n\t\t\t\t\tv-if=\"!isLoading\"\n\t\t\t\t\tname=\"actions\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import './style.css';\n\n// @vue/component\nexport const NodeSettingsVariable = {\n\tname: 'node-settings-variable',\n\tprops:\n\t{\n\t\tvariableName:\n\t\t{\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tvariableValue:\n\t\t{\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"node-settings-variable\">\n\t\t\t<span class=\"node-settings-variable_name\">\n\t\t\t\t{{ variableName }}\n\t\t\t</span>\n\t\t\t<span class=\"node-settings-variable_eq\">=</span>\n\t\t\t<span class=\"node-settings-variable_value\">\n\t\t\t\t{{ variableValue }}\n\t\t\t</span>\n\t\t</div>\n\t`,\n};\n","import './style.css';\n\nimport { BIcon } from 'ui.icon-set.api.vue';\n\nimport { useLoc } from '../../../../shared/composables';\n// eslint-disable-next-line no-unused-vars\nimport { Port, Block } from '../../../../shared/types';\n\nimport { CONSTRUCTION_LABELS, GENERAL_CONSTRUCTION_TYPES } from '../../constants';\nimport { evaluateConditionExpressionFieldTitle } from '../../utils';\n\nimport type {\n\tRule,\n\t// eslint-disable-next-line no-unused-vars\n\tNodeSettings,\n\tGeneralConstructionTypes,\n\tonstructionLabels,\n\tConstruction,\n} from '../types';\n\n// @vue/component\nexport const NodeSettingsRule = {\n\tname: 'node-settings-rule',\n\tcomponents: { BIcon },\n\tprops:\n\t{\n\t\t/** @type Port */\n\t\tport:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\t/** @type NodeSettings */\n\t\tnodeSettings:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\t/** @type Block */\n\t\tconnectedBlocks:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['showRuleConstructions', 'deleteRule'],\n\tsetup(): { getMessage: () => string; }\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn { getMessage };\n\t},\n\tcomputed:\n\t{\n\t\truleId(): string\n\t\t{\n\t\t\treturn this.port.id;\n\t\t},\n\t\trule(): Rule\n\t\t{\n\t\t\treturn this.nodeSettings.rules.get(this.ruleId);\n\t\t},\n\t\tisRuleFilled(): boolean\n\t\t{\n\t\t\treturn this.rule?.isFilled;\n\t\t},\n\t\tconstructionLabels(): onstructionLabels\n\t\t{\n\t\t\treturn CONSTRUCTION_LABELS;\n\t\t},\n\t\tgeneralConstructionTypes(): GeneralConstructionTypes\n\t\t{\n\t\t\treturn GENERAL_CONSTRUCTION_TYPES;\n\t\t},\n\t\tifLabel(): string\n\t\t{\n\t\t\treturn this.getMessage(CONSTRUCTION_LABELS['condition:if']);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonRuleClick(): void\n\t\t{\n\t\t\tthis.$emit('showRuleConstructions', this.ruleId);\n\t\t},\n\t\tonDeleteRule(): void\n\t\t{\n\t\t\tthis.$emit('deleteRule', this.ruleId);\n\t\t},\n\t\tgetExpressionTitle({ expression, type }: Construction): string\n\t\t{\n\t\t\tconst { actions } = this.nodeSettings;\n\t\t\tif (type === GENERAL_CONSTRUCTION_TYPES.action)\n\t\t\t{\n\t\t\t\tif (!expression.actionId)\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn actions.get(expression.actionId).title;\n\t\t\t}\n\n\t\t\tif (type === GENERAL_CONSTRUCTION_TYPES.output || !expression.field)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn evaluateConditionExpressionFieldTitle(this.connectedBlocks, expression.field);\n\t\t},\n\t\tgetExpressionValue({ expression: { value, title }, type }: Construction): string\n\t\t{\n\t\t\tif (type === GENERAL_CONSTRUCTION_TYPES.output)\n\t\t\t{\n\t\t\t\treturn title;\n\t\t\t}\n\n\t\t\treturn value;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"node-settings-rule\"\n\t\t\t:data-test-id=\"$testId('complexNodeSettingsRulePreview', ruleId)\"\n\t\t\t@click=\"onRuleClick\"\n\t\t>\n\t\t\t<BIcon\n\t\t\t\tclass=\"node-settings-rule__dnd-icon\"\n\t\t\t\t:size=\"20\"\n\t\t\t\tname=\"drag-m\"\n\t\t\t\tcolor=\"#828b95\"\n\t\t\t/>\n\t\t\t<span class=\"node-settings-rule__title\">\n\t\t\t\t{{ port.title }}\n\t\t\t</span>\n\t\t\t<div\n\t\t\t\tv-if=\"isRuleFilled\"\n\t\t\t\tclass=\"node-settings-rule__card-container\"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"ruleCard in rule.ruleCards\"\n\t\t\t\t\t:key=\"ruleCard.id\"\n\t\t\t\t\tclass=\"node-settings-rule__card\"\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-for=\"construction in ruleCard.constructions\"\n\t\t\t\t\t\t:key=\"construction.id\"\n\t\t\t\t\t\tclass=\"node-settings-rule__construction\"\n\t\t\t\t\t\t:class=\"['--' + generalConstructionTypes[construction.type]]\"\n\t\t\t\t\t\t:data-if-indent=\"ifLabel\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class=\"node-settings-rule__construction_type\">\n\t\t\t\t\t\t\t{{ getMessage(constructionLabels[construction.type]) }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"node-settings-rule__expression-part\">\n\t\t\t\t\t\t\t{{ getExpressionTitle(construction) }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"construction.expression.operator\"\n\t\t\t\t\t\t\tclass=\"node-settings-rule__expression-part\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ construction.expression.operator }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"generalConstructionTypes[construction.type] !== generalConstructionTypes.action\"\n\t\t\t\t\t\t\tclass=\"node-settings-rule__expression-part\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ getExpressionValue(construction) }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<span\n\t\t\t\tclass=\"node-settings-rule__construction --empty\"\n\t\t\t\tv-else\n\t\t\t>\n\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_RULE_EMPTY') }}\n\t\t\t</span>\n\t\t\t<div class=\"node-settings-rule__actions\">\n\t\t\t\t<BIcon\n\t\t\t\t\t:size=\"20\"\n\t\t\t\t\tclass=\"node-settings-rule__edit-icon\"\n\t\t\t\t\tname=\"edit-m\"\n\t\t\t\t\tcolor=\"#c9ccd0\"\n\t\t\t\t/>\n\t\t\t\t<BIcon\n\t\t\t\t\tclass=\"node-settings-rule__close-icon\"\n\t\t\t\t\tname=\"cross-m\"\n\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t:data-test-id=\"$testId('complexNodeSettingsRulePreview', ruleId, 'delete')\"\n\t\t\t\t\tcolor=\"#c9ccd0\"\n\t\t\t\t\t@click.stop=\"onDeleteRule\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Event, Dom } from 'main.core';\n\nconst DRAG_ENTITIES = Object.freeze({\n\truleConstruction: 'rule-construction',\n\truleCard: 'rule-card',\n});\n\nconst INSERTION = Object.freeze({\n\tover: 'over',\n\tunder: 'under',\n});\n\nconst createGhost = (el: HTMLElement): HTMLElement => {\n\tconst ghost = el.cloneNode(true);\n\tDom.style(ghost, {\n\t\tposition: 'fixed',\n\t\tleft: '-100%',\n\t\ttop: '-100%',\n\t});\n\tDom.append(ghost, el.parentElement);\n\n\treturn ghost;\n};\n\nconst checkForDragTarget = (draggedItem: HTMLElement, event: DragEvent): HTMLElement | null => {\n\tconst closestNode = event.target.closest(`[data-name=${draggedItem.dataset.name}]`);\n\tconst isDragAllowed = closestNode\n\t\t&& closestNode !== draggedItem && closestNode.parentElement === draggedItem.parentElement;\n\tif (isDragAllowed)\n\t{\n\t\treturn closestNode;\n\t}\n\n\treturn null;\n};\n\nconst dragStartHandler = (dragStartEvent: DragEvent, onDrop: () => void): void => {\n\tconst { dataTransfer, currentTarget: container, target } = dragStartEvent;\n\tconst draggedItem = target.closest(`[data-name=${DRAG_ENTITIES.ruleConstruction}], [data-name=${DRAG_ENTITIES.ruleCard}]`);\n\tconst ghost = createGhost(draggedItem);\n\tlet dragTarget = null;\n\tdataTransfer.setDragImage(ghost, 0, 0);\n\tdataTransfer.effectAllowed = 'move';\n\tconst handlers = {\n\t\tdragover: (dragOverEvent: DragEvent) => {\n\t\t\tdragTarget = checkForDragTarget(draggedItem, dragOverEvent);\n\t\t\tif (dragTarget)\n\t\t\t{\n\t\t\t\tdragOverEvent.preventDefault();\n\t\t\t}\n\t\t},\n\t\tdragend: () => {\n\t\t\tDom.remove(ghost);\n\t\t\tentries.forEach(([currentEvent, handler]) => {\n\t\t\t\tEvent.unbind(container, currentEvent, handler);\n\t\t\t});\n\t\t},\n\t\tdragenter: (dragEnterEvent: DragEvent) => {\n\t\t\tif (dragTarget)\n\t\t\t{\n\t\t\t\tdragEnterEvent.preventDefault();\n\t\t\t}\n\t\t},\n\t\tdrop: (dropEvent: DragEvent) => {\n\t\t\tif (!dragTarget)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { top } = dragTarget.getBoundingClientRect();\n\t\t\tconst insertion = dropEvent.clientY < top + dragTarget.offsetHeight / 2\n\t\t\t\t? INSERTION.over : INSERTION.under;\n\t\t\tconst payload = {\n\t\t\t\tdraggedId: draggedItem.dataset.id,\n\t\t\t\ttargetId: dragTarget.dataset.id,\n\t\t\t\tinsertion,\n\t\t\t};\n\t\t\tif (draggedItem.dataset.ruleCardId)\n\t\t\t{\n\t\t\t\tpayload.ruleCardId = draggedItem.dataset.ruleCardId;\n\t\t\t}\n\n\t\t\tonDrop(payload);\n\t\t},\n\t};\n\tconst entries = Object.entries(handlers);\n\tentries.forEach(([currentEvent, handler]) => {\n\t\tEvent.bind(container, currentEvent, handler);\n\t});\n};\n\nexport const DragRuleEntity = {\n\tmounted(el: HTMLElement, { value: onDrop }: Object): void\n\t{\n\t\tEvent.bind(el, 'dragstart', (event: DragEvent) => {\n\t\t\tdragStartHandler(event, onDrop);\n\t\t});\n\t},\n\tunmounted(el: HTMLElement): void\n\t{\n\t\tEvent.unbindAll(el, 'dragstart');\n\t},\n};\n","import './style.css';\n\nimport { BIcon } from 'ui.icon-set.api.vue';\n\nimport { useLoc } from '../../../../shared/composables';\n\nimport { DragRuleEntity } from '../../directives/drag-rule-entity';\n\n// eslint-disable-next-line no-unused-vars\nimport type { TRuleCard, NodeSettings } from '../types';\n\n// @vue/component\nexport const NodeSettingsRulesLayout = {\n\tname: 'node-settings-rules-layout',\n\tcomponents: { BIcon },\n\tdirectives: { 'drag-construction': DragRuleEntity },\n\tprops:\n\t{\n\t\t/** @type NodeSettings */\n\t\tnodeSettings:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcurrentRuleId:\n\t\t{\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisSaving:\n\t\t{\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tisRuleSettingsShown:\n\t\t{\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close', 'drop', 'scroll-layout'],\n\tsetup(): { getMessage: () => string; }\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn { getMessage };\n\t},\n\tcomputed:\n\t{\n\t\truleCards(): Array<TRuleCard>\n\t\t{\n\t\t\treturn this.nodeSettings.rules.get(this.currentRuleId)?.ruleCards ?? [];\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonDrop(payload: OrderPayload): void\n\t\t{\n\t\t\tthis.$emit('drop', payload);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition-group name=\"slide-rule-panel\">\n\t\t\t<div\n\t\t\t\tv-if=\"isRuleSettingsShown\"\n\t\t\t\tclass=\"node-settings-rules-panel\"\n\t\t\t\t:class=\"{ '--saving': isSaving }\"\n\t\t\t>\n\t\t\t\t<div class=\"node-settings-rules-panel__header\">\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\t:data-test-id=\"$testId('complexNodeRuleSettingsClose')\"\n\t\t\t\t\t\tname=\"arrow-left-l\"\n\t\t\t\t\t\tcolor=\"#828b95\"\n\t\t\t\t\t\tclass=\"node-settings-rules-panel__header_back\"\n\t\t\t\t\t\t@click=\"$emit('close')\"\n\t\t\t\t\t/>\n\t\t\t\t\t<span class=\"node-settings-rules-panel__header_label\">\n\t\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_RULES_LAYOUT_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<slot name=\"rules-dropdown\" />\n\t\t\t\t\t<!--\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\tname=\"o-question\"\n\t\t\t\t\t\tcolor=\"#a8adb4\"\n\t\t\t\t\t\tclass=\"node-settings-rules-panel__header_question\"\n\t\t\t\t\t/>\n\t\t\t\t\t-->\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"node-settings-rules-panel__content\"\n\t\t\t\t\tv-drag-construction=\"onDrop\"\n\t\t\t\t\t@scroll=\"$emit('scroll-layout')\"\n\t\t\t\t>\n\t\t\t\t\t<slot\n\t\t\t\t\t\tv-for=\"ruleCard in ruleCards\"\n\t\t\t\t\t\t:key=\"ruleCard.id\"\n\t\t\t\t\t\t:ruleCard=\"ruleCard\"\n\t\t\t\t\t\tname=\"ruleCard\"\n\t\t\t\t\t/>\n\t\t\t\t\t<slot v-if=\"ruleCards.length === 0\"\n\t\t\t\t\t\tname=\"addRuleCardButton\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"node-settings-rules-panel__footer\">\n\t\t\t\t\t<slot name=\"actions\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"isRuleSettingsShown\"\n\t\t\t\tclass=\"node-settings-rules-layout__back\"\n\t\t\t></div>\n\t\t</transition-group>\n\t`,\n};\n","import './style.css';\n\nimport { BIcon } from 'ui.icon-set.api.vue';\n\n// eslint-disable-next-line no-unused-vars\nimport type { TRuleCard } from '../types';\n\n// @vue/component\nexport const RuleCard = {\n\tname: 'rule-card',\n\tcomponents: { BIcon },\n\tprops:\n\t{\n\t\t/** @type TRuleCard */\n\t\truleCard:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.iconColor = 'var(--ui-color-palette-gray-50)';\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tdata-name=\"rule-card\"\n\t\t\tclass=\"rule-card\"\n\t\t\t:data-id=\"ruleCard.id\"\n\t\t>\n\t\t\t<div class=\"rule-card__top\">\n\t\t\t\t<BIcon\n\t\t\t\t\tname=\"drag-s\"\n\t\t\t\t\tclass=\"rule-card__dnd-icon\"\n\t\t\t\t\tdraggable=\"true\"\n\t\t\t\t\t:color=\"iconColor\"\n\t\t\t\t/>\n\t\t\t\t<slot name=\"deleteRuleCard\" />\n\t\t\t\t<!--\n\t\t\t\t<div class=\"rule-card__top_delimeter\"></div>\n\t\t\t\t<BIcon\n\t\t\t\t\t:size=\"20\"\n\t\t\t\t\tname=\"o-question\"\n\t\t\t\t\t:color=\"iconColor\"\n\t\t\t\t/>\n\t\t\t\t-->\n\t\t\t</div>\n\t\t\t<slot\n\t\t\t\tv-for=\"(construction, index) in ruleCard.constructions\"\n\t\t\t\t:key=\"construction.id\"\n\t\t\t\t:construction=\"construction\"\n\t\t\t\t:position=\"index\"\n\t\t\t/>\n\t\t\t<slot\n\t\t\t\tname=\"addConstructionButton\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import './style.css';\n\nimport { BIcon } from 'ui.icon-set.api.vue';\n\nimport { useLoc } from '../../../../shared/composables';\n\nimport { CONSTRUCTION_LABELS, GENERAL_CONSTRUCTION_TYPES, CONSTRUCTION_TYPES } from '../../constants/index';\n\n// eslint-disable-next-line no-unused-vars\nimport type { onstructionLabels, Construction, GeneralConstructionTypes, OrderParams } from '../types';\n\ntype RuleConstructionSetup = {\n\tgetMessage: () => string;\n\tonstructionModes: { standard: string; expert: string; };\n};\n\nconst RULE_CONSTRUCTION_MODES = {\n\tstandard: 'standard',\n\texpert: 'expert',\n};\n\nconst ICON_COLORS = {\n\tcondition: '#b7d7ff',\n\taction: '#4de39e',\n\toutput: '#d5d7db',\n};\n\n// @vue/component\nexport const RuleConstruction = {\n\tname: 'rule-construction',\n\tcomponents: { BIcon },\n\tprops:\n\t{\n\t\t/** @type Construction */\n\t\tconstruction:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tposition:\n\t\t{\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\truleCardId:\n\t\t{\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): RuleConstructionSetup\n\t{\n\t\tconst { getMessage } = useLoc();\n\t\tconst onstructionModes = Object.freeze({\n\t\t\tstandard: getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_EXPRESSION_STANDARD_MODE'),\n\t\t\texpert: getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_EXPRESSION_EXPERT_MODE'),\n\t\t});\n\n\t\treturn {\n\t\t\tgetMessage,\n\t\t\tonstructionModes,\n\t\t};\n\t},\n\tdata(): { selectedMode: string; }\n\t{\n\t\treturn {\n\t\t\tselectedMode: RULE_CONSTRUCTION_MODES.expert,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tconstractionClassName(): { [key: string]: string; }\n\t\t{\n\t\t\treturn {\n\t\t\t\t'--condition': GENERAL_CONSTRUCTION_TYPES[this.construction.type] === GENERAL_CONSTRUCTION_TYPES['condition:if'],\n\t\t\t\t'--action': GENERAL_CONSTRUCTION_TYPES[this.construction.type] === GENERAL_CONSTRUCTION_TYPES.action,\n\t\t\t\t'--first': this.position === 0,\n\t\t\t\t'--output': GENERAL_CONSTRUCTION_TYPES[this.construction.type] === GENERAL_CONSTRUCTION_TYPES.output,\n\t\t\t};\n\t\t},\n\t\tgeneralConstructionTypes(): GeneralConstructionTypes\n\t\t{\n\t\t\treturn GENERAL_CONSTRUCTION_TYPES;\n\t\t},\n\t\tisBooleanType(): boolean\n\t\t{\n\t\t\treturn this.booleanTypes.includes(this.construction.type);\n\t\t},\n\t\tbooleanTypes(): Array<$Values<typeof CONSTRUCTION_TYPES>>\n\t\t{\n\t\t\treturn [\n\t\t\t\tCONSTRUCTION_TYPES.AND_CONDITION,\n\t\t\t\tCONSTRUCTION_TYPES.OR_CONDITION,\n\t\t\t];\n\t\t},\n\t\ticonColor(): string\n\t\t{\n\t\t\tif (GENERAL_CONSTRUCTION_TYPES.action === this.generalConstructionTypes[this.construction.type])\n\t\t\t{\n\t\t\t\treturn ICON_COLORS.action;\n\t\t\t}\n\n\t\t\tif (GENERAL_CONSTRUCTION_TYPES.output === this.generalConstructionTypes[this.construction.type])\n\t\t\t{\n\t\t\t\treturn ICON_COLORS.output;\n\t\t\t}\n\n\t\t\treturn ICON_COLORS.condition;\n\t\t},\n\t\tisExpertMode(): boolean\n\t\t{\n\t\t\treturn this.selectedMode === RULE_CONSTRUCTION_MODES.expert;\n\t\t},\n\t\tparsedMessage(): string\n\t\t{\n\t\t\treturn this.construction.type === GENERAL_CONSTRUCTION_TYPES.action\n\t\t\t\t? this.getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ACTION_THEN')\n\t\t\t\t: this.getMessage(CONSTRUCTION_LABELS[this.construction.type])\n\t\t\t;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tdata-name=\"rule-construction\"\n\t\t\tclass=\"rule-construction\"\n\t\t\t:class=\"constractionClassName\"\n\t\t\t:data-id=\"construction.id\"\n\t\t\t:data-rule-card-id=\"ruleCardId\"\n\t\t>\n\t\t\t<div class=\"rule-construction__operator\">\n\t\t\t\t<slot\n\t\t\t\t\tv-if=\"isBooleanType\"\n\t\t\t\t\tname=\"booleanTypeSwitcher\"\n\t\t\t\t/>\n\t\t\t\t<span\n\t\t\t\t\tv-else\n\t\t\t\t\tclass=\"rule-construction__operator_label\"\n\t\t\t\t>\n\t\t\t\t\t{{ parsedMessage }}\n\t\t\t\t</span>\n\t\t\t\t<slot\n\t\t\t\t\tv-if=\"position > 0\"\n\t\t\t\t\tname=\"addConstructionButton\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"rule-construction__content\">\n\t\t\t\t<div class=\"rule-construction__content_top\">\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\t:color=\"iconColor\"\n\t\t\t\t\t\tclass=\"rule-construction__dnd-icon\"\n\t\t\t\t\t\tname=\"drag-s\"\n\t\t\t\t\t\tdraggable=\"true\"\n\t\t\t\t\t/>\n\t\t\t\t\t<!--\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"generalConstructionTypes[construction.type] === generalConstructionTypes.action\"\n\t\t\t\t\t\tclass=\"rule-construction__content_mode\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-for=\"(label, mode) in onstructionModes\"\n\t\t\t\t\t\t\tclass=\"rule-construction__content_mode-text\"\n\t\t\t\t\t\t\t:class=\"{ '--selected': selectedMode === mode }\"\n\t\t\t\t\t\t\t@click=\"selectedMode = mode\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ label }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t-->\n\t\t\t\t\t<slot\n\t\t\t\t\t\tname=\"deleteConstructionButton\"\n\t\t\t\t\t\t:iconColor=\"iconColor\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"rule-construction__expression-form\">\n\t\t\t\t\t<slot\n\t\t\t\t\t\t:name=\"generalConstructionTypes[construction.type]\"\n\t\t\t\t\t\t:isExpertMode=\"isExpertMode\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { defineStore } from 'ui.vue3.pinia';\n\ntype AppState = {\n\tisShowRightPanel: boolean;\n};\n\nexport const useAppStore = defineStore('bizprocdesigner-app-store', {\n\tstate: (): AppState => ({\n\t\tisShownRightPanel: false,\n\t\tisShownPreviewPanel: false,\n\t}),\n\tactions:\n\t{\n\t\tshowRightPanel(): void\n\t\t{\n\t\t\tthis.isShownRightPanel = true;\n\t\t},\n\t\thideRightPanel(): void\n\t\t{\n\t\t\tthis.isShownRightPanel = false;\n\t\t\tthis.isShownPreviewPanel = false;\n\t\t},\n\t\tsetShowPreviewPanel(isShow: boolean): void\n\t\t{\n\t\t\tthis.isShownPreviewPanel = isShow;\n\t\t},\n\t\tshowPreviewPanel(): void\n\t\t{\n\t\t\tthis.isShownPreviewPanel = true;\n\t\t},\n\t\thidePreviewPanel(): void\n\t\t{\n\t\t\tthis.isShownPreviewPanel = false;\n\t\t},\n\t},\n});\n","import './app-layout.css';\n\nconst SETTINGS_PANEL_CLASSNAMES = {\n\tbase: 'editor-chart-app-layout__settings',\n\twithPreviewPanel: '--with-preview-panel',\n};\n\nconst TOP_RIGHT_TOOLBAR_CLASSNAMES = {\n\tbase: 'editor-chart-app-layout__top-right-toolbar',\n\tshifted: '--shifted',\n};\n\nconst BOTTOM_RIGHT_TOOLBAR_CLASSNAMES = {\n\tbase: 'editor-chart-app-layout__bottom-right-toolbar',\n\tshifted: '--shifted',\n};\n\n// @vue/component\nexport const AppLayout = {\n\tname: 'AppLayout',\n\tprops: {\n\t\tshowSettings: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tshowPreviewPanel: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\ttopRightClassNames(): { [string]: boolean }\n\t\t{\n\t\t\treturn {\n\t\t\t\t[TOP_RIGHT_TOOLBAR_CLASSNAMES.base]: true,\n\t\t\t\t[TOP_RIGHT_TOOLBAR_CLASSNAMES.shifted]: this.showSettings,\n\t\t\t};\n\t\t},\n\t\tbottomRightClassNames(): { [string]: boolean }\n\t\t{\n\t\t\treturn {\n\t\t\t\t[BOTTOM_RIGHT_TOOLBAR_CLASSNAMES.base]: true,\n\t\t\t\t[BOTTOM_RIGHT_TOOLBAR_CLASSNAMES.shifted]: this.showSettings,\n\t\t\t};\n\t\t},\n\t\tsettingsClassNames(): { [string]: boolean }\n\t\t{\n\t\t\treturn {\n\t\t\t\t[SETTINGS_PANEL_CLASSNAMES.base]: true,\n\t\t\t\t[SETTINGS_PANEL_CLASSNAMES.withPreviewPanel]: this.showPreviewPanel,\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"editor-chart-app-layout\">\n\t\t\t<section class=\"editor-chart-app-layout__header\">\n\t\t\t\t<slot name=\"header\"/>\n\t\t\t</section>\n\t\t\t<main class=\"editor-chart-app-layout__content\">\n\t\t\t\t<slot name=\"diagram\"/>\n\n\t\t\t\t<section class=\"editor-chart-app-layout__catalog\">\n\t\t\t\t\t<slot name=\"catalog\"/>\n\t\t\t\t</section>\n\n\t\t\t\t<section :class=\"topRightClassNames\">\n\t\t\t\t\t<slot name=\"top-right-toolbar\"/>\n\t\t\t\t</section>\n\n\t\t\t\t<section :class=\"bottomRightClassNames\">\n\t\t\t\t\t<slot name=\"bottom-right-toolbar\"/>\n\t\t\t\t</section>\n\n\t\t\t\t<transition\n\t\t\t\t\tname=\"fade-settings-panel\"\n\t\t\t\t\tenter-active-class=\"fade-settings-panel-enter-active\"\n\t\t\t\t\tleave-active-class=\"fade-settings-panel-leave-active\"\n\t\t\t\t>\n\t\t\t\t\t<section\n\t\t\t\t\t\tv-if=\"showSettings\"\n\t\t\t\t\t\t:class=\"settingsClassNames\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<slot name=\"settings\"/>\n\t\t\t\t\t</section>\n\t\t\t\t</transition>\n\n\t\t\t\t<transition name=\"fade-preview-panel\">\n\t\t\t\t\t<section\n\t\t\t\t\t\tv-show=\"showPreviewPanel\"\n\t\t\t\t\t\tclass=\"editor-chart-app-layout__preview-panel\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"editor-chart-app-layout__preview-panel-conatiner\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tid=\"preview-panel\"\n\t\t\t\t\t\t\t\tclass=\"editor-chart-app-layout__preview-panel-content\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</section>\n\t\t\t\t</transition>\n\t\t\t</main>\n\t\t</div>\n\t`,\n};\n","import './app-header.css';\n\n// @vue/component\nexport const AppHeader = {\n\tname: 'AppHeader',\n\ttemplate: `\n\t\t<header class=\"editor-chart-app-header\">\n\t\t\t<div class=\"editor-chart-app-header__left-column\">\n\t\t\t\t<slot name=\"left\"/>\n\t\t\t</div>\n\t\t\t<div class=\"editor-chart-app-header__right-column\">\n\t\t\t\t<slot name=\"right\"/>\n\t\t\t</div>\n\t\t</header>\n\t`,\n};\n","import './logo-layout.css';\n\n// @vue/component\nexport const LogoLayout = {\n\tname: 'LogoLayout',\n\ttemplate: `\n\t\t<div class=\"editor-chart-logo-layout\">\n\t\t\t<div class=\"editor-chart-logo-layout__back-btn\">\n\t\t\t\t<slot name=\"back-btn\"/>\n\t\t\t</div>\n\t\t\t<div class=\"editor-chart-logo-layout__logo-title\">\n\t\t\t\t<slot name=\"title\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Button as UiButton, AirButtonStyle } from 'ui.vue3.components.button';\nimport { Outline } from 'ui.icon-set.api.core';\n\nconst DEFAULT_BACK_URL = '/bizproc/templateprocesses/';\n\n// @vue/component\nexport const LogoBackBtn = {\n\tname: 'LogoBackBtn',\n\tcomponents: {\n\t\tUiButton,\n\t},\n\tprops: {\n\t\tbackUrl: {\n\t\t\ttype: String,\n\t\t\tdefault: DEFAULT_BACK_URL,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t\tOutline,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<UiButton\n\t\t\t:leftIcon=\"Outline.HOME\"\n\t\t\t:style=\"AirButtonStyle.PLAIN\"\n\t\t\t:link=\"backUrl\"\n\t\t/>\n\t`,\n};\n","import './logo-title.css';\n\n// @vue/component\nexport const LogoTitle = {\n\tname: 'LogoTitle',\n\tprops: {\n\t\tcompanyName: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"editor-chart-logo-title\">\n\t\t\t<span class=\"editor-chart-logo-title__company-name\">\n\t\t\t\t{{ companyName }}\n\t\t\t</span>\n\t\t\t<span class=\"editor-chart-logo-title__tool-name\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_TOP_PANEL_TOOLNAME') }}\n\t\t\t</span>\n\t\t</div>\n\t`,\n};\n","import './app-header-divider.css';\n\n// @vue/component\nexport const AppHeaderDivider = {\n\tname: 'AppHeaderDivider',\n\ttemplate: `\n\t\t<div class=\"editor-chart-app-header-divider\"/>\n\t`,\n};\n","import './style.css';\nimport { Type } from 'main.core';\n\nimport { mapState } from 'ui.vue3.pinia';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport { FeatureCode } from 'bizprocdesigner.feature';\n\nimport { useLoc, useFeature } from '../../../../shared/composables';\n\nimport { useNodeSettingsStore } from '../../../../entities/node-settings';\nimport { diagramStore, BlockHeader, BlockIcon } from '../../../../entities/blocks';\nimport { BLOCK_TYPES, ACTIVATION_STATUS } from '../../../../shared/constants';\n\n// eslint-disable-next-line no-unused-vars\nimport type { Block } from '../../../../shared/types';\nimport { IconButton } from '../../../../shared/ui';\n\n// @vue/component\nexport const EditNodeSettingsForm = {\n\tname: 'edit-node-settings-form',\n\tcomponents: {\n\t\tBIcon,\n\t\tIconButton,\n\t\tBlockHeader,\n\t\tBlockIcon,\n\t},\n\tprops:\n\t{\n\t\t/** @type Block */\n\t\tblock:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['updateTitle', 'updateDescription'],\n\tsetup(): { getMessage: () => string; }\n\t{\n\t\tconst store: diagramStore = diagramStore();\n\t\tconst { getMessage } = useLoc();\n\t\tconst { isFeatureAvailable } = useFeature();\n\n\t\treturn {\n\t\t\ticonSet: Outline,\n\t\t\tgetMessage,\n\t\t\tisFeatureAvailable,\n\t\t\tstore,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\t...mapState(useNodeSettingsStore, ['nodeSettings']),\n\t\ticonName(): string\n\t\t{\n\t\t\treturn Outline[this.block?.node?.icon] ?? Outline.FILE;\n\t\t},\n\t\trulePorts(): Array<TPort>\n\t\t{\n\t\t\treturn this.block.ports.input.filter((port) => !port.isConnectionPort);\n\t\t},\n\t\tareConnectionsAvailable(): boolean\n\t\t{\n\t\t\treturn this.isFeatureAvailable(FeatureCode.complexNodeConnections);\n\t\t},\n\t\tisSubIcon(): boolean\n\t\t{\n\t\t\treturn this.block.node?.type === BLOCK_TYPES.TOOL\n\t\t\t\t&& this.block.node?.icon && Outline[this.block.node.icon] !== Outline.DATABASE;\n\t\t},\n\t\tactivationIcon(): string\n\t\t{\n\t\t\treturn this.block.activity.Activated === ACTIVATION_STATUS.ACTIVE\n\t\t\t\t? this.iconSet.PAUSE_L\n\t\t\t\t: this.iconSet.PLAY_L;\n\t\t},\n\t\ticon(): string\n\t\t{\n\t\t\tif (this.block.node?.type === BLOCK_TYPES.TOOL)\n\t\t\t{\n\t\t\t\tconst mcpLettersKey = 'MCP_LETTERS';\n\n\t\t\t\treturn Outline[this.block.node.icon] === Outline.DATABASE\n\t\t\t\t\t? this.block.node.icon\n\t\t\t\t\t: mcpLettersKey;\n\t\t\t}\n\n\t\t\treturn this.block.node?.icon;\n\t\t},\n\t\tcolorIndex(): number\n\t\t{\n\t\t\treturn this.block.node?.type === BLOCK_TYPES.TOOL ? 0 : this.block.node?.colorIndex;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonChangeTitle({ target: { value: title } }: InputEvent): void\n\t\t{\n\t\t\tthis.$emit('updateTitle', title);\n\t\t},\n\t\tonChangeDescription({ target: { value: description } }: InputEvent): void\n\t\t{\n\t\t\tthis.$emit('updateDescription', description);\n\t\t},\n\t\tisUrl(value: string): boolean\n\t\t{\n\t\t\tif (!value || !Type.isString(value))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst u = new URL(value);\n\n\t\t\t\treturn u.protocol === 'https:';\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\ttoggleActivation(event: MouseEvent): void\n\t\t{\n\t\t\tthis.store.toggleBlockActivation(this.block.id, true);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"node-settings-form\">\n\t\t\t<div class=\"node-settings-form__node-brief\">\n\t\t\t\t<BlockHeader :block=\"block\" :subIconExternal=\"isUrl(block.node?.icon)\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<BlockIcon\n\t\t\t\t\t\t\t:iconName=\"icon\"\n\t\t\t\t\t\t\t:iconColorIndex=\"colorIndex\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template #subIcon\n\t\t\t\t\t\t\t  v-if=\"isSubIcon\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"isUrl(block.node.icon)\"\n\t\t\t\t\t\t\t:style=\"getBackgroundImage(block.node.icon)\"\n\t\t\t\t\t\t\tclass=\"ui-selector-item-avatar\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<BlockIcon\n\t\t\t\t\t\t\tv-else\n\t\t\t\t\t\t\t:iconName=\"block.node.icon\"\n\t\t\t\t\t\t\t:iconColorIndex=\"7\"\n\t\t\t\t\t\t\t:iconSize=\"24\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</BlockHeader>\n\t\t\t\t<IconButton\n\t\t\t\t\t:icon-name=\"activationIcon\"\n\t\t\t\t\t@click=\"toggleActivation\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"node-settings-form__section-delimeter\"></div>\n\t\t\t<div class=\"node-settings-form__section\">\n\t\t\t\t<div>\n\t\t\t\t\t<span class=\"node-settings-form__label\">\n\t\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_NODE_NAME_LABEL') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox node-settings-form__node-name-input\">\n\t\t\t\t\t\t<input type=\"text\"\n\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t:placeholder=\"getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_NODE_NAME_PLACEHOLDER')\"\n\t\t\t\t\t\t\t:value=\"block.node.title\"\n\t\t\t\t\t\t\t:data-test-id=\"$testId('complexNodeName')\"\n\t\t\t\t\t\t\t@input=\"onChangeTitle\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"node-settings-form__node-description\">\n\t\t\t\t\t<span class=\"node-settings-form__label\">\n\t\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_NODE_DESCRIPTION_LABEL') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textarea node-settings-form__node-description_textarea\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\trows=\"1\"\n\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t:placeholder=\"getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_NODE_DESCRIPTION_PLACEHOLDER')\"\n\t\t\t\t\t\t\t:value=\"nodeSettings.description\"\n\t\t\t\t\t\t\t:data-test-id=\"$testId('complexNodeDescription')\"\n\t\t\t\t\t\t\t@input=\"onChangeDescription\"\n\t\t\t\t\t\t></textarea>\n\t\t\t\t\t</div>\n\t\t\t\t\t<p class=\"node-settings-form__node-description_text\">\n\t\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_NODE_DESCRIPTION_TEXT') }}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"node-settings-form__section-delimeter\"></div>\n\t\t\t<div\n\t\t\t\tclass=\"node-settings-form__section --data\"\n\t\t\t\tref=\"node-settings-form-data-section\"\n\t\t\t>\n\t\t\t\t<!--\n\t\t\t\t<span\n\t\t\t\t\tclass=\"node-settings-form__section-title\"\n\t\t\t\t>\n\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_DATA_SECTION_TITLE') }}\n\t\t\t\t</span>\n\t\t\t\t-->\n\t\t\t\t<slot\n\t\t\t\t\tv-for=\"[variableName, variableValue] in nodeSettings.variables\"\n\t\t\t\t\t:key=\"variableName\"\n\t\t\t\t\t:variableName=\"variableName\"\n\t\t\t\t\t:variableValue=\"variableValue\"\n\t\t\t\t\tname=\"variable\"\n\t\t\t\t/>\n\t\t\t\t<slot name=\"addElement\" itemType=\"element\" />\n\t\t\t</div>\n\t\t\t<div class=\"node-settings-form__section\">\n\t\t\t\t<p class=\"node-settings-form__section-title\">\n\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_RULE_SECTION_TITLE') }}\n\t\t\t\t</p>\n\t\t\t\t<slot\n\t\t\t\t\tv-for=\"port in rulePorts\"\n\t\t\t\t\t:key=\"port.id\"\n\t\t\t\t\t:port=\"port\"\n\t\t\t\t\tname=\"rule\"\n\t\t\t\t/>\n\t\t\t\t<slot name=\"addRule\" itemType=\"rule\" />\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"areConnectionsAvailable\"\n\t\t\t\tclass=\"node-settings-form__section\"\n\t\t\t>\n\t\t\t\t<p class=\"node-settings-form__section-title\">\n\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONNECTION_SECTION_TITLE') }}\n\t\t\t\t</p>\n\t\t\t\t<slot name=\"addConnection\" itemType=\"connection\" />\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import './style.css';\n\nimport { BIcon } from 'ui.icon-set.api.vue';\n\nimport { useLoc } from '../../../../shared/composables';\n\nimport { useNodeSettingsStore, generateNextInputPortId } from '../../../../entities/node-settings';\n\ntype AddSettingsItemSetup = {\n\tgetMessage: () => string;\n\tactions: {\n\t\trule: () => void;\n\t},\n};\n\n// @vue/component\nexport const AddSettingsItem = {\n\tname: 'add-settings-item',\n\tcomponents: { BIcon },\n\tprops:\n\t{\n\t\titemType:\n\t\t{\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['addItem'],\n\tsetup(): AddSettingsItemSetup\n\t{\n\t\tconst { getMessage } = useLoc();\n\t\tconst store = useNodeSettingsStore();\n\t\tconst actions = {\n\t\t\trule: () => store.addRule(),\n\t\t\tconnection: () => generateNextInputPortId(store.block.ports.input),\n\t\t};\n\n\t\treturn {\n\t\t\tgetMessage,\n\t\t\tactions,\n\t\t};\n\t},\n\tmethods:\n\t{\n\t\tonClick(): void\n\t\t{\n\t\t\tconst itemId = this.actions[this.itemType]();\n\t\t\tthis.$emit('addItem', itemId);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"node-settings-add-item-button\"\n\t\t\t:data-test-id=\"$testId('complexNodeSettingsAdd', itemType)\"\n\t\t\t@click=\"onClick\"\n\t\t>\n\t\t\t<BIcon\n\t\t\t\tclass=\"node-settings-add-item-button__plus\"\n\t\t\t\tname=\"plus-m\"\n\t\t\t\t:size=\"20\"\n\t\t\t\tcolor=\"#828b95\"\n\t\t\t/>\n\t\t\t<span>\n\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ADD_SETTINGS_ITEM') }}\n\t\t\t\t<slot />\n\t\t\t</span>\n\t\t</div>\n\t`,\n};\n","import { Loc, Type } from 'main.core';\nimport { MenuManager } from 'main.popup';\nimport type { MenuItem } from 'main.popup';\nimport { Dialog, EntityOptions, Item, ItemOptions, TabOptions } from 'ui.entity-selector';\nimport { diagramStore } from '../../../../entities/blocks';\nimport type { Block, PortId } from '../../../../shared/types';\n\nconst CurrentDocumentId = '@';\n\nexport class DocumentSelector\n{\n\t#store: diagramStore;\n\t#currentPortId: PortId | null = null;\n\t#currentBlock : Block;\n\t#fixedDocumentType: Array<string> | null = null;\n\n\tconstructor(\n\t\tcurrentBlock: Block,\n\t\tcurrentPortId: PortId | null = null,\n\t\tfixedDocumentType: Array<string> | null = null,\n\t)\n\t{\n\t\tthis.#store = diagramStore();\n\t\tthis.#currentBlock = currentBlock;\n\t\tthis.#currentPortId = currentPortId;\n\t\tthis.#fixedDocumentType = fixedDocumentType;\n\t}\n\n\tshow(target: HTMLElement): Promise<string | null>\n\t{\n\t\tconst documentItems: ItemOptions[] = [\n\t\t\t{\n\t\t\t\tid: CurrentDocumentId,\n\t\t\t\tentityId: 'bizproc-document',\n\t\t\t\tentityType: 'document',\n\t\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_EDITOR_TEMPLATE_DOCUMENT'),\n\t\t\t\tnodeOptions: {\n\t\t\t\t\topen: false,\n\t\t\t\t\tdynamic: false,\n\t\t\t\t},\n\t\t\t\ttabs: 'documents',\n\t\t\t},\n\t\t\t...this.#getDocuments(),\n\t\t];\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst dialog = new Dialog({\n\t\t\t\ttargetNode: target,\n\t\t\t\twidth: 500,\n\t\t\t\theight: 300,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tenableSearch: true,\n\t\t\t\titems: documentItems,\n\t\t\t\ttabs: this.#getTabs(),\n\t\t\t\tentities: this.#getEntities(),\n\t\t\t\tcacheable: false,\n\t\t\t\tshowAvatars: false,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tresolve(this.#getReturnValue(event.getData().item));\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tcompactView: true,\n\t\t\t});\n\n\t\t\tdialog.show();\n\t\t});\n\t}\n\n\t#getTabs(): TabOptions[]\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: 'documents',\n\t\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_EDITOR_DOCUMENT_MULTIPLE'),\n\t\t\t\ticon: 'elements',\n\t\t\t},\n\t\t];\n\t}\n\n\t#getReturnValue(item: Item): string | null\n\t{\n\t\treturn item.getId() === CurrentDocumentId ? null : item.getId();\n\t}\n\n\t#getEntities(): EntityOptions[]\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: 'bizproc-document',\n\t\t\t},\n\t\t];\n\t}\n\n\t#processChildrenProperties(block: Block): ItemOptions[]\n\t{\n\t\tconst childrenProperties = [];\n\t\tblock.activity.Children.forEach((activity) => {\n\t\t\tif (Type.isArrayFilled(activity.ReturnProperties))\n\t\t\t{\n\t\t\t\tconst properties = this.#processReturnProperties({ id: activity.Name, activity });\n\t\t\t\tif (Type.isArrayFilled(properties))\n\t\t\t\t{\n\t\t\t\t\tchildrenProperties.push(...properties);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst properties = [];\n\t\tif (Type.isArrayFilled(childrenProperties))\n\t\t{\n\t\t\tproperties.push({\n\t\t\t\tid: block.id,\n\t\t\t\tentityId: 'block-node',\n\t\t\t\ttabs: 'documents',\n\t\t\t\ttitle: block.activity.Properties.Title,\n\t\t\t\tchildren: childrenProperties,\n\t\t\t\tsearchable: false,\n\t\t\t});\n\t\t}\n\n\t\treturn properties;\n\t}\n\n\t#processReturnProperties(block: Block): ItemOptions[]\n\t{\n\t\tconst properties = [];\n\n\t\tblock.activity.ReturnProperties\n\t\t\t.filter((property) => {\n\t\t\t\tif (property.Type !== 'document')\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isArrayFilled(property.Default))\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tif (!Type.isArrayFilled(this.#fixedDocumentType))\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn JSON.stringify(property.Default) === JSON.stringify(this.#fixedDocumentType);\n\t\t\t})\n\t\t\t.forEach((property) => {\n\t\t\t\tconst id = `{=${block.id}:${property.Id}}`;\n\n\t\t\t\tproperties.push({\n\t\t\t\t\tid,\n\t\t\t\t\tentityId: 'bizproc-document',\n\t\t\t\t\tentityType: 'document',\n\t\t\t\t\ttitle: `${property.Name} (${block.activity.Properties.Title})`,\n\t\t\t\t\tnodeOptions: {\n\t\t\t\t\t\topen: false,\n\t\t\t\t\t\tdynamic: false,\n\t\t\t\t\t},\n\t\t\t\t\ttabs: 'documents',\n\t\t\t\t});\n\t\t\t})\n\t\t;\n\n\t\treturn properties;\n\t}\n\n\t#getDocuments(): ItemOptions[]\n\t{\n\t\tconst blocks = this.#store.getAllBlockAncestors(this.#currentBlock, this.#currentPortId);\n\n\t\treturn blocks.reduce((acc, block: Block) => {\n\t\t\tif (Type.isArrayFilled(block.activity.Children))\n\t\t\t{\n\t\t\t\tconst properties = this.#processChildrenProperties(block);\n\t\t\t\tif (Type.isArrayFilled(properties))\n\t\t\t\t{\n\t\t\t\t\tacc.push(...properties);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Type.isArrayFilled(block.activity.ReturnProperties))\n\t\t\t{\n\t\t\t\tconst properties = this.#processReturnProperties(block);\n\t\t\t\tif (Type.isArrayFilled(properties))\n\t\t\t\t{\n\t\t\t\t\tacc.push(...properties);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t}, []);\n\t}\n}\n","import './style.css';\n\nimport { mapState, mapActions } from 'ui.vue3.pinia';\nimport { MenuManager, type MenuItem } from 'main.popup';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { diagramStore } from '../../../../entities/blocks';\nimport { evaluateActionExpressionDocumentTitle } from '../../../../entities/node-settings/utils';\n\nimport { useLoc } from '../../../../shared/composables';\n\n// eslint-disable-next-line no-unused-vars\nimport { useNodeSettingsStore, type Action, type Construction } from '../../../../entities/node-settings';\nimport type { ActivityData } from '../../../../shared/types';\nimport { DocumentSelector } from './document-selector';\n\n// @vue/component\nexport const EditActionExpression = {\n\tname: 'edit-action-expression',\n\tcomponents: { BIcon },\n\tprops:\n\t{\n\t\t/** @type ActionConstruction */\n\t\tconstruction:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tisExpertMode:\n\t\t{\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): { getMessage: () => string; }\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn { getMessage };\n\t},\n\tdata(): { isExpanded: boolean; }\n\t{\n\t\treturn {\n\t\t\tisExpanded: true,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\t...mapState(useNodeSettingsStore, ['nodeSettings', 'block', 'currentRuleId']),\n\t\tconnectedBlocks(): Array<Block>\n\t\t{\n\t\t\t/** @todo Get rid of store usage here */\n\t\t\tconst store = diagramStore();\n\n\t\t\treturn store.getAllBlockAncestors(this.block, this.currentRuleId);\n\t\t},\n\t\tselectedAction(): Action\n\t\t{\n\t\t\treturn this.nodeSettings.actions.get(this.selectedActionId);\n\t\t},\n\t\tselectedActionId:\n\t\t{\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\treturn this.construction.expression.actionId ?? '';\n\t\t\t},\n\t\t\tset(actionId: string): void\n\t\t\t{\n\t\t\t\tthis.changeRuleExpression(this.construction, {\n\t\t\t\t\tactionId,\n\t\t\t\t\tactivityData: null,\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\t\tactionValue(): ?ActivityData\n\t\t{\n\t\t\treturn this.construction.expression.activityData;\n\t\t},\n\t\tnotSelectedMessage(): string\n\t\t{\n\t\t\treturn this.getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_EXPRESSION_ITEM_NOT_SELECTED');\n\t\t},\n\t\tcurrentActionTitle(): string\n\t\t{\n\t\t\tconst action = this.nodeSettings.actions.get(this.selectedActionId);\n\n\t\t\treturn action?.title ?? this.notSelectedMessage;\n\t\t},\n\t\tselectedDocument:\n\t\t\t{\n\t\t\t\tget(): string\n\t\t\t\t{\n\t\t\t\t\treturn this.construction.expression.document;\n\t\t\t\t},\n\t\t\t\tset(document: string | null): void\n\t\t\t\t{\n\t\t\t\t\tthis.changeRuleExpression(this.construction, {\n\t\t\t\t\t\tdocument,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t},\n\t\tselectedDocumentTitle(): string\n\t\t{\n\t\t\treturn evaluateActionExpressionDocumentTitle(\n\t\t\t\tthis.connectedBlocks,\n\t\t\t\tthis.selectedDocument,\n\t\t\t);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\t...mapActions(useNodeSettingsStore, ['changeRuleExpression']),\n\t\tgetMenuItems(): Array<MenuItem>\n\t\t{\n\t\t\treturn [...this.nodeSettings.actions.values()].map(({ id, title }) => {\n\t\t\t\treturn {\n\t\t\t\t\tid,\n\t\t\t\t\ttext: title,\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.selectedActionId = id;\n\t\t\t\t\t\tthis.menu.close();\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t\tonShowMenu({ currentTarget }: PointerEvent): void\n\t\t{\n\t\t\tthis.menu = MenuManager.create(\n\t\t\t\t{\n\t\t\t\t\tid: 'edit-actions-menu',\n\t\t\t\t\tbindElement: currentTarget,\n\t\t\t\t\titems: this.getMenuItems(),\n\t\t\t\t\tmaxHeight: 200,\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t},\n\t\t\t);\n\t\t\tthis.menu.show();\n\t\t},\n\t\tonChooseDocument(event: Event): void\n\t\t{\n\t\t\tconst selector = new DocumentSelector(\n\t\t\t\tthis.block,\n\t\t\t\tthis.currentRuleId,\n\t\t\t\tthis.nodeSettings.fixedDocumentType,\n\t\t\t);\n\n\t\t\tvoid selector\n\t\t\t\t.show(event.target)\n\t\t\t\t.then((document) => {\n\t\t\t\t\tthis.selectedDocument = document;\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"edit-action-expression-form\">\n\t\t\t<div class=\"edit-action-expression-form__item\">\n\t\t\t\t<span class=\"edit-action-expression-form__label\">\n\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ACTION_EXPRESSION_NAME') }}\n\t\t\t\t</span>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown edit-action-expression-form__dropdown\"\n\t\t\t\t\t@click=\"onShowMenu\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t<div class=\"ui-ctl-element\">\n\t\t\t\t\t\t{{ currentActionTitle }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"selectedAction && selectedAction.handlesDocument\"\n\t\t\t\t class=\"edit-action-expression-form__item\"\n\t\t\t>\n\t\t\t\t<span class=\"edit-action-expression-form__label\">\n\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_DOCUMENT') }}\n\t\t\t\t</span>\n\t\t\t\t<div\n\t\t\t\t\t class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown edit-action-expression-form__dropdown\"\n\t\t\t\t\t @click=\"onChooseDocument\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t<div class=\"ui-ctl-element\">\n\t\t\t\t\t\t{{ selectedDocumentTitle }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"edit-action-expression-form__item\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"selectedActionId\"\n\t\t\t\t\tclass=\"edit-action-expression-form__label\"\n\t\t\t\t>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_EXPRESSION_VALUE') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\tv-if=\"isExpanded\"\n\t\t\t\t\t\tname=\"minus-20\"\n\t\t\t\t\t\tcolor=\"#828b95\"\n\t\t\t\t\t\t@click=\"isExpanded=false\"\n\t\t\t\t\t/>\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\tname=\"plus-20\"\n\t\t\t\t\t\tcolor=\"#828b95\"\n\t\t\t\t\t\t@click=\"isExpanded=true\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-show=\"isExpanded\"\n\t\t\t\t\tclass=\"edit-action-expression-form__settings node-settings-panel\"\n\t\t\t\t>\n\t\t\t\t\t<slot\n\t\t\t\t\t\t:actionId=\"selectedActionId\"\n\t\t\t\t\t\t:activityData=\"actionValue\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { defineStore } from 'ui.vue3.pinia';\n\ntype SettingsState = {\n\tisLoading: boolean;\n};\n\nexport const useCommonNodeSettingsStore = defineStore('bizprocdesigner-common-node-settings-store', {\n\tstate: (): SettingsState => ({\n\t\tisLoading: false,\n\t\tblock: null,\n\t}),\n\tgetters:\n\t{\n\t\tisVisible: (state) => {\n\t\t\treturn state.block !== null;\n\t\t},\n\t},\n\tactions:\n\t{\n\t\tisCurrentBlock(blockId): boolean\n\t\t{\n\t\t\treturn this.block?.id === blockId;\n\t\t},\n\t\tshowSettings(block): void\n\t\t{\n\t\t\tthis.block = block;\n\t\t},\n\t\thideSettings(): void\n\t\t{\n\t\t\tthis.block = null;\n\t\t},\n\t},\n});\n","import { Type, Loc } from 'main.core';\nimport { Dialog, Item, ItemOptions, TabOptions, EntityOptions } from 'ui.entity-selector';\nimport type { Block, PortId } from '../../../../shared/types';\nimport { diagramStore } from '../../../blocks';\n\nexport class ValueSelector\n{\n\tstore: diagramStore;\n\tcurrentBlock: Block;\n\tcurrentPortId: PortId | null = null;\n\n\tconstructor(\n\t\tstore: diagramStore,\n\t\tcurrentBlock: Block,\n\t\tcurrentPortId: PortId | null = null,\n\t)\n\t{\n\t\tthis.store = store;\n\t\tthis.currentBlock = currentBlock;\n\t\tthis.currentPortId = currentPortId;\n\t}\n\n\tshow(targetElement: Element): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst dialog = new Dialog({\n\t\t\t\ttargetNode: targetElement,\n\t\t\t\twidth: 500,\n\t\t\t\theight: 300,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tenableSearch: true,\n\t\t\t\titems: this.#getItems(),\n\t\t\t\ttabs: this.#getTabs(),\n\t\t\t\tentities: this.#getEntities(),\n\t\t\t\tcacheable: false,\n\t\t\t\tshowAvatars: false,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tresolve(this.#getValue(event.getData().item));\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tcompactView: true,\n\t\t\t});\n\n\t\t\tdialog.show();\n\t\t});\n\t}\n\n\t#getEntities(): EntityOptions[]\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: 'bizproc-document',\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'bizproc-system',\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'structure-node',\n\t\t\t\toptions: {\n\t\t\t\t\tselectMode: 'usersAndDepartments',\n\t\t\t\t\tallowFlatDepartments: true,\n\t\t\t\t\tallowSelectRootDepartment: true,\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t}\n\n\t#getTabs(): TabOptions[]\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: 'documents',\n\t\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_SELECTOR_TAB_DOCUMENTS'),\n\t\t\t\ticon: 'elements',\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'returns',\n\t\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_SELECTOR_TAB_RETURNS'),\n\t\t\t\ticon: 'flag-1',\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'template',\n\t\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_SELECTOR_TAB_TEMPLATE'),\n\t\t\t\ticon: 'disk',\n\t\t\t},\n\t\t];\n\t}\n\n\t#getValue(item: Item): string\n\t{\n\t\tif (item.getEntityId() === 'user')\n\t\t{\n\t\t\treturn `${item.getTitle()} [${item.getId()}]`;\n\t\t}\n\n\t\tif (item.getEntityId() === 'structure-node')\n\t\t{\n\t\t\tconst id = String(item.getId());\n\t\t\tif (id.indexOf(':') > 0)\n\t\t\t{\n\t\t\t\treturn `${item.getTitle()} [HR${id.split(':')[0]}]`;\n\t\t\t}\n\n\t\t\treturn `${item.getTitle()} [HRR${id}]`;\n\t\t}\n\n\t\treturn item.getId();\n\t}\n\n\t#getItems(): ItemOptions[]\n\t{\n\t\tconst items = this.getReturnItems();\n\n\t\tthis.#addDocumentItem(items);\n\t\tthis.addTemplateItems(items);\n\n\t\treturn items;\n\t}\n\n\t#addDocumentItem(items: ItemOptions[]): void\n\t{\n\t\t// compatible document\n\t\titems.push({\n\t\t\tid: 'template-document',\n\t\t\tentityId: 'bizproc-document',\n\t\t\tentityType: 'document',\n\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_SELECTOR_DOCUMENT_FIELDS'),\n\t\t\tcustomData: {\n\t\t\t\tdocument: this.store.documentType,\n\t\t\t\tidTemplate: '{{ #FIELD_NAME# }}',\n\t\t\t\tsupertitle: Loc.getMessage('BIZPROCDESIGNER_SELECTOR_DOCUMENT_FIELDS'),\n\t\t\t},\n\t\t\ttabs: ['documents'],\n\t\t\tnodeOptions: {\n\t\t\t\topen: false,\n\t\t\t\tdynamic: true,\n\t\t\t},\n\t\t});\n\t}\n\n\taddTemplateItems(items: ItemOptions[]): void\n\t{\n\t\tconst map = [\n\t\t\t{\n\t\t\t\tkey: 'PARAMETERS',\n\t\t\t\tidKey: 'Template',\n\t\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_SELECTOR_ITEM_PARAMETERS'),\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'VARIABLES',\n\t\t\t\tidKey: 'Variable',\n\t\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_SELECTOR_ITEM_VARIABLES'),\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'CONSTANTS',\n\t\t\t\tidKey: 'Constant',\n\t\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_SELECTOR_ITEM_CONSTANTS'),\n\t\t\t},\n\t\t];\n\n\t\tmap.forEach((elem) => {\n\t\t\tconst collection = this.store.template[elem.key];\n\t\t\tif (Type.isObject(collection) && Object.keys(collection).length > 0)\n\t\t\t{\n\t\t\t\tconst children = [];\n\t\t\t\tObject.keys(collection).forEach((key) => {\n\t\t\t\t\tconst item = collection[key];\n\t\t\t\t\tconst id = `{=${elem.idKey}:${key}}`;\n\t\t\t\t\tchildren.push({\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tentityId: elem.key,\n\t\t\t\t\t\ttitle: item.Name,\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\titems.push({\n\t\t\t\t\tid: elem.idKey,\n\t\t\t\t\tentityId: 'template',\n\t\t\t\t\ttitle: elem.title,\n\t\t\t\t\ttabs: 'template',\n\t\t\t\t\tchildren,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tgetReturnItems(): ItemOptions[]\n\t{\n\t\tconst blocks = this.store.getAllBlockAncestors(\n\t\t\tthis.currentBlock,\n\t\t\tthis.currentPortId,\n\t\t);\n\n\t\treturn blocks.reduce((acc, block: Block) => {\n\t\t\tif (Type.isArrayFilled(block.activity.Children))\n\t\t\t{\n\t\t\t\tconst properties = this.#processChildrenProperties(block);\n\t\t\t\tif (Type.isArrayFilled(properties))\n\t\t\t\t{\n\t\t\t\t\tacc.push(...properties);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Type.isArrayFilled(block.activity.ReturnProperties))\n\t\t\t{\n\t\t\t\tconst properties = this.#processReturnProperties(block);\n\t\t\t\tif (Type.isArrayFilled(properties))\n\t\t\t\t{\n\t\t\t\t\tacc.push(...properties);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t}, []);\n\t}\n\n\t#processChildrenProperties(block: Block): ItemOptions[]\n\t{\n\t\tconst childrenProperties = [];\n\t\tblock.activity.Children.forEach((activity) => {\n\t\t\tif (Type.isArrayFilled(activity.ReturnProperties))\n\t\t\t{\n\t\t\t\tconst properties = this.#processReturnProperties({ id: activity.Name, activity });\n\t\t\t\tif (Type.isArrayFilled(properties))\n\t\t\t\t{\n\t\t\t\t\tchildrenProperties.push(...properties);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst { documents, activities } = childrenProperties.reduce(\n\t\t\t(res, child) => {\n\t\t\t\tif (child)\n\t\t\t\t{\n\t\t\t\t\tif (child.entityId === 'bizproc-document')\n\t\t\t\t\t{\n\t\t\t\t\t\tres.documents.push(child);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tres.activities.push(child);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn res;\n\t\t\t},\n\t\t\t{ documents: [], activities: [] },\n\t\t);\n\n\t\tconst properties = [];\n\n\t\tif (Type.isArrayFilled(documents))\n\t\t{\n\t\t\tproperties.push({\n\t\t\t\tid: block.id,\n\t\t\t\tentityId: 'block-node',\n\t\t\t\ttabs: 'documents',\n\t\t\t\ttitle: block.activity.Properties.Title,\n\t\t\t\tchildren: documents,\n\t\t\t\tnodeOptions: {\n\t\t\t\t\topen: false,\n\t\t\t\t\tdynamic: false,\n\t\t\t\t},\n\t\t\t\tsearchable: false,\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isArrayFilled(activities))\n\t\t{\n\t\t\tproperties.push({\n\t\t\t\tid: block.id,\n\t\t\t\tentityId: 'block-node',\n\t\t\t\ttabs: 'returns',\n\t\t\t\ttitle: block.activity.Properties.Title,\n\t\t\t\tchildren: activities,\n\t\t\t\tsearchable: false,\n\t\t\t});\n\t\t}\n\n\t\treturn properties;\n\t}\n\n\t#processReturnProperties(block: Block): ItemOptions[]\n\t{\n\t\tconst fullTitle = block.activity.Properties.Title;\n\n\t\tconst { documents, properties } = block.activity.ReturnProperties.reduce(\n\t\t\t(res, property) => {\n\t\t\t\tconst id = `{=${block.id}:${property.Id}}`;\n\t\t\t\tif (property.Type === 'document')\n\t\t\t\t{\n\t\t\t\t\tres.documents.push({\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tentityId: 'bizproc-document',\n\t\t\t\t\t\tentityType: 'document',\n\t\t\t\t\t\ttitle: `${property.Name} (${fullTitle})`,\n\t\t\t\t\t\tcustomData: {\n\t\t\t\t\t\t\tdocument: property.Default,\n\t\t\t\t\t\t\tidTemplate: `{=${block.id}:${property.Id}.#FIELD#}`,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnodeOptions: {\n\t\t\t\t\t\t\topen: false,\n\t\t\t\t\t\t\tdynamic: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttabs: 'documents',\n\t\t\t\t\t\tsearchable: false,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tres.properties.push({\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tentityId: 'block-node-property',\n\t\t\t\t\t\ttitle: property.Name,\n\t\t\t\t\t\tproperty,\n\t\t\t\t\t\tblock,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn res;\n\t\t\t},\n\t\t\t{ documents: [], properties: [] },\n\t\t);\n\n\t\tconst result = [];\n\n\t\tif (Type.isArrayFilled(documents))\n\t\t{\n\t\t\tresult.push(...documents);\n\t\t}\n\n\t\tif (Type.isArrayFilled(properties))\n\t\t{\n\t\t\tresult.push({\n\t\t\t\tid: block.id,\n\t\t\t\tentityId: 'block-node',\n\t\t\t\ttabs: 'returns',\n\t\t\t\ttitle: fullTitle,\n\t\t\t\tchildren: properties,\n\t\t\t\tsearchable: false,\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import './style.css';\nimport 'window';\n\nimport { Dom, Tag, Type, Event, Loc, ajax } from 'main.core';\nimport { MenuManager, type MenuItem } from 'main.popup';\nimport { EventEmitter } from 'main.core.events';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport { editorAPI } from '../../../../shared/api';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\n\nimport { IconButton } from '../../../../shared/ui';\nimport type { Block } from '../../../../shared/types';\nimport { BLOCK_TYPES, ACTIVATION_STATUS } from '../../../../shared/constants';\nimport { handleResponseError } from '../../../../shared/utils';\nimport { usePropertyDialog } from '../../../../shared/composables';\n\nimport { diagramStore, BlockHeader, BlockIcon } from '../../../../entities/blocks';\nimport { ValueSelector } from './value-selector';\n\n// @vue/component\nexport const CommonNodeSettingsForm = {\n\tname: 'CommonNodeSettingsForm',\n\tcomponents: {\n\t\tBIcon,\n\t\tBlockHeader,\n\t\tBlockIcon,\n\t\tIconButton,\n\t},\n\tprops:\n\t{\n\t\tblock:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdocumentType:\n\t\t{\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['showPreview'],\n\tsetup(): Object\n\t{\n\t\tconst store: diagramStore = diagramStore();\n\n\t\treturn {\n\t\t\ticonSet: Outline,\n\t\t\tstore,\n\t\t};\n\t},\n\tdata(): {\n\t\tisLoading: boolean,\n\t\tisVisible: boolean,\n\t\thasErrors: boolean,\n\t\tisSubmitting: boolean,\n\t\thasSettings: boolean,\n\t\tcurrentBlock: Block,\n\t\tsettingsForm: HTMLElement | null,\n\t\tnodeControls: Array<any> | null,\n\t\tinputListeners: [],\n\t\tshouldShowWithTransition: boolean,\n\t\t}\n\t{\n\t\treturn {\n\t\t\tisLoading: false,\n\t\t\tisVisible: false,\n\t\t\thasErrors: false,\n\t\t\tisSubmitting: false,\n\t\t\thasSettings: false,\n\t\t\tuseDocumentContext: false,\n\t\t\tsettingsForm: null,\n\t\t\tnodeControls: null,\n\t\t\tinputListeners: [],\n\t\t\tshouldShowWithTransition: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\ticon(): string\n\t\t{\n\t\t\tif (this.block.node?.type === BLOCK_TYPES.TOOL)\n\t\t\t{\n\t\t\t\tconst mcpLettersKey = 'MCP_LETTERS';\n\n\t\t\t\treturn Outline[this.block.node.icon] === Outline.DATABASE\n\t\t\t\t\t? this.block.node.icon\n\t\t\t\t\t: mcpLettersKey;\n\t\t\t}\n\n\t\t\treturn this.block.node?.icon;\n\t\t},\n\t\tcolorIndex(): number\n\t\t{\n\t\t\treturn this.block.node?.type === BLOCK_TYPES.TOOL ? 0 : this.block.node?.colorIndex;\n\t\t},\n\t\tisSubIcon(): boolean\n\t\t{\n\t\t\treturn this.block.node?.type === BLOCK_TYPES.TOOL\n\t\t\t&& this.block.node?.icon && Outline[this.block.node.icon] !== Outline.DATABASE;\n\t\t},\n\t\tactivationIcon(): string\n\t\t{\n\t\t\treturn this.block.activity.Activated === ACTIVATION_STATUS.ACTIVE\n\t\t\t\t? this.iconSet.PAUSE_L\n\t\t\t\t: this.iconSet.PLAY_L;\n\t\t},\n\t},\n\tasync mounted()\n\t{\n\t\tthis.isVisible = true;\n\t\tthis.currentBlock = this.block;\n\t\tawait this.$nextTick();\n\t\tawait this.renderControls();\n\t\tEvent.bind(document, 'mousedown', this.multiSelectMouseHandler);\n\n\t\tEventEmitter.subscribe('BX.Bizproc:setuptemplateactivity:preview', this.showPreview);\n\n\t\twindow.BPAShowSelector = this.showSelector;\n\t\twindow.HideShow = this.hideShow;\n\t},\n\tunmounted(): void\n\t{\n\t\tif (this.inputListeners && this.handleFieldInput)\n\t\t{\n\t\t\tthis.inputListeners.forEach((input) => {\n\t\t\t\tEvent.unbind(input, 'input', this.handleFieldInput);\n\t\t\t});\n\t\t\tthis.inputListeners = [];\n\t\t}\n\t\tEvent.unbind(document, 'mousedown', this.multiSelectMouseHandler);\n\n\t\tEventEmitter.unsubscribe('BX.Bizproc:setuptemplateactivity:preview', this.showPreview);\n\t\tEventEmitter.emit('BX.Bizproc.Activity.unmount');\n\t\t// console.log('UNMOUNT');\n\t},\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tmultiSelectMouseHandler(event: MouseEvent): void\n\t\t{\n\t\t\tif (!event.isTrusted || event.button !== 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst opt = event.target;\n\t\t\tconst select = opt.parentElement;\n\t\t\tif (opt.tagName === 'OPTION' && select?.multiple)\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\t\t\t\tconst scroll = select.scrollTop;\n\t\t\t\topt.selected = !opt.selected;\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tselect.scrollTop = scroll;\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t},\n\t\tshowPreview(event: boolean): void\n\t\t{\n\t\t\tthis.$emit('showPreview', event.data);\n\t\t},\n\t\tasync showSettings(node: Block, shouldShowWithTransition: boolean): Promise<void>\n\t\t{\n\t\t\tthis.isVisible = true;\n\t\t\tthis.currentBlock = node;\n\t\t\tthis.shouldShowWithTransition = shouldShowWithTransition;\n\t\t\tawait this.$nextTick();\n\t\t\tawait this.renderControls();\n\n\t\t\twindow.BPAShowSelector = this.showSelector;\n\t\t\twindow.HideShow = this.hideShow;\n\t\t},\n\t\textractFormData(form: HTMLElement): { [key: string]: any }\n\t\t{\n\t\t\tconst formData = ajax.prepareForm(form).data;\n\n\t\t\tformData.documentType = this.documentType;\n\t\t\tformData.activityType = this.currentBlock.activity?.Type ?? '';\n\t\t\tformData.id = this.currentBlock.activity?.Name ?? '';\n\t\t\tformData.arWorkflowTemplate = JSON.stringify([this.currentBlock.activity]);\n\n\t\t\treturn formData;\n\t\t},\n\t\tasync submitForm(formData: { [key: string]: any }): Promise<void>\n\t\t{\n\t\t\tthis.isSubmitting = true;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tthis.validateForm(formData);\n\t\t\t\tif (this.hasErrors)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tEventEmitter.emit('Bizproc.NodeSettings:nodeSettingsSaving', { formData });\n\n\t\t\t\tconst preparedSettingsData = { ...formData };\n\t\t\t\tpreparedSettingsData.arWorkflowConstants = JSON.stringify(this.store.template.CONSTANTS ?? {});\n\n\t\t\t\tconst compatibleTemplate = [{ Type: 'NodeWorkflowActivity', Children: [], Name: 'Template' }];\n\t\t\t\tcompatibleTemplate[0].Children.push(\n\t\t\t\t\tthis.currentBlock.activity,\n\t\t\t\t\t...this.store.getAllBlockAncestors(this.currentBlock).map((b) => b.activity),\n\t\t\t\t);\n\n\t\t\t\tpreparedSettingsData.arWorkflowTemplate = JSON.stringify(compatibleTemplate);\n\n\t\t\t\tpreparedSettingsData.activated = this.currentBlock.activity.Activated;\n\t\t\t\tconst settingControls = await editorAPI.saveNodeSettings(preparedSettingsData);\n\t\t\t\tif (settingControls)\n\t\t\t\t{\n\t\t\t\t\tthis.store.updateBlockActivityField(this.currentBlock.id, settingControls);\n\n\t\t\t\t\tif (formData.activity_id !== this.currentBlock.id)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.store.updateBlockId(this.currentBlock.id, preparedSettingsData.activity_id);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.store.publicDraft();\n\n\t\t\t\t\tthis.handleFormCancel();\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tif (error.errors && error.errors[0] && error.errors[0].message)\n\t\t\t\t{\n\t\t\t\t\tMessageBox.alert(error.errors[0].message);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tthis.isSubmitting = false;\n\t\t\t}\n\t\t},\n\t\thandleFormSave(): void\n\t\t{\n\t\t\tif (this.isSubmitting)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.settingsForm)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst formData = this.extractFormData(this.settingsForm);\n\t\t\tthis.submitForm(formData);\n\t\t},\n\t\thandleFormCancel(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t\tthis.isVisible = false;\n\t\t\tthis.$refs.contentContainer.innerHTML = '';\n\t\t},\n\t\thandleDocumentSelector(event): void\n\t\t{\n\t\t\tconst documents: MenuItem[] = [\n\t\t\t\t{\n\t\t\t\t\tid: '@',\n\t\t\t\t\ttext: Loc.getMessage('BIZPROCDESIGNER_EDITOR_TEMPLATE_DOCUMENT'),\n\t\t\t\t},\n\t\t\t\t...this.getDocuments(),\n\t\t\t];\n\n\t\t\tconst selectedDocument = this.currentBlock.activity?.Document ?? '@';\n\t\t\tconst menuItems = documents.map((item: MenuItem) => {\n\t\t\t\tconst text = item.id === selectedDocument ? `* ${item.text}` : item.text;\n\t\t\t\tconst onclick = this.handleSelectDocument.bind(this);\n\n\t\t\t\treturn { ...item, text, onclick };\n\t\t\t});\n\n\t\t\tMenuManager.show(\n\t\t\t\t'node-settings-document-selector',\n\t\t\t\tevent.target,\n\t\t\t\tmenuItems,\n\t\t\t\t{\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\thandleSelectDocument(event, item: MenuItem): void\n\t\t{\n\t\t\titem.menuWindow.close();\n\t\t\tconst selected = item.getId();\n\t\t\tif (selected === '@')\n\t\t\t{\n\t\t\t\tthis.currentBlock.activity.Document = null;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.currentBlock.activity.Document = selected;\n\t\t},\n\t\thideShow(id: string = 'row_activity_id'): void\n\t\t{\n\t\t\tconst formRow = BX(id);\n\t\t\tif (formRow)\n\t\t\t{\n\t\t\t\tDom.toggleClass(formRow, 'hidden');\n\t\t\t}\n\t\t},\n\t\tshowSelector(id: string, type: string): void\n\t\t{\n\t\t\tconst selector = new ValueSelector(this.store, this.currentBlock);\n\t\t\tconst targetElement = document.getElementById(id);\n\n\t\t\tselector\n\t\t\t\t.show(targetElement)\n\t\t\t\t.then((value) => {\n\t\t\t\t\tconst beforePart = targetElement.selectionStart\n\t\t\t\t\t\t? targetElement.value.slice(0, targetElement.selectionStart)\n\t\t\t\t\t\t: targetElement.value\n\t\t\t\t\t;\n\t\t\t\t\tlet middlePart = value;\n\t\t\t\t\tconst afterPart = targetElement.selectionEnd\n\t\t\t\t\t\t? targetElement.value.slice(targetElement.selectionEnd)\n\t\t\t\t\t\t: ''\n\t\t\t\t\t;\n\n\t\t\t\t\tif (type === 'user')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (beforePart.trim().length > 0 && beforePart.trim().slice(-1) !== ';')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmiddlePart = `; ${middlePart}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmiddlePart += '; ';\n\t\t\t\t\t}\n\n\t\t\t\t\ttargetElement.value = beforePart + middlePart + afterPart;\n\t\t\t\t\ttargetElement.selectionEnd = beforePart.length + middlePart.length;\n\t\t\t\t\ttargetElement.focus();\n\t\t\t\t\ttargetElement.dispatchEvent(new window.Event('change'));\n\t\t\t\t})\n\t\t\t\t.catch((error) => console.error(error));\n\t\t},\n\t\trenderField(fieldProps: ?HTMLElement, field: Object): HTMLElement | null\n\t\t{\n\t\t\tconst control = Type.isDomNode(fieldProps) ? fieldProps : null;\n\t\t\tif (!control)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst error = Tag.render`\n\t\t\t\t<div class=\"node-settings-alert-text\">\n\t\t\t\t\t${this.loc(\n\t\t\t\t'BIZPROCDESIGNER_EDITOR_REQUIRED_FIELD_ERROR',\n\t\t\t\t{ '#FIELD#': field.property.Name },\n\t\t\t)}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tDom.append(error, control.parentNode);\n\n\t\t\tlet className = 'node-settings-edit-box';\n\t\t\tif (field.property.Hidden)\n\t\t\t{\n\t\t\t\tclassName += ' hidden';\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"${className}\" id=\"row_${field.fieldName}\">\n\t\t\t\t    <div class=\"node-settings-edit-caption\">${field.property.Name}</div>\n\t\t\t\t    <div class=\"field-row\">\n\t\t\t\t        ${control}\n\t\t\t\t        ${field.fieldName === 'title' ? `\n\t\t\t\t        \t<a href=\"#\" onclick=\"HideShow('row_activity_id'); return false;\">\n\t\t\t\t        \t\t${this.loc('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ID')}\n\t\t\t\t        \t</a>\n\t\t\t\t        \t\t\t<a href=\"#\" onclick=\"HideShow('row_activity_editor_comment'); return false;\">\n\t\t\t\t        \t\t${this.loc('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_COMMENT')}\n\t\t\t\t        \t</a>\n\t\t\t\t        ` : null}\n\t\t\t\t    </div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t},\n\t\tasync renderControls(): void\n\t\t{\n\t\t\tthis.isLoading = true;\n\t\t\tconst id = this.currentBlock.activity.Name ?? '';\n\t\t\tconst activity = this.currentBlock.activity.Type ?? '';\n\t\t\tconst compatibleTemplate = [{ Type: 'NodeWorkflowActivity', Children: [], Name: 'Template' }];\n\t\t\tcompatibleTemplate[0].Children.push(\n\t\t\t\tthis.currentBlock?.activity,\n\t\t\t\t...this.store.getAllBlockAncestors(this.currentBlock).map((b) => b.activity),\n\t\t\t);\n\t\t\tconst workflowParameters = this.store.template.PARAMETERS;\n\t\t\tconst workflowVariables = this.store.template.VARIABLES;\n\t\t\tconst workflowConstants = this.store.template.CONSTANTS;\n\n\t\t\tif (window.CreateActivity)\n\t\t\t{\n\t\t\t\twindow.arAllId = {};\n\t\t\t\twindow.arWorkflowTemplate = compatibleTemplate;\n\t\t\t\twindow.rootActivity = window.CreateActivity(compatibleTemplate[0]);\n\t\t\t\twindow.arWorkflowParameters = workflowParameters;\n\t\t\t\twindow.arWorkflowVariables = workflowVariables;\n\t\t\t\twindow.arWorkflowConstants = workflowConstants;\n\t\t\t}\n\n\t\t\tconst { createFormData } = usePropertyDialog();\n\t\t\tconst formData = createFormData({\n\t\t\t\tid,\n\t\t\t\tdocumentType: this.documentType,\n\t\t\t\tactivity,\n\t\t\t\tworkflow: {\n\t\t\t\t\tparameters: workflowParameters,\n\t\t\t\t\tvariables: workflowVariables,\n\t\t\t\t\ttemplate: compatibleTemplate,\n\t\t\t\t\tconstants: workflowConstants,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.isLoading = true;\n\n\t\t\tthis.$refs.contentContainer.innerHTML = '';\n\t\t\tthis.hasErrors = false;\n\t\t\tthis.nodeControls = [];\n\n\t\t\tlet settingControls = null;\n\t\t\ttry\n\t\t\t{\n\t\t\t\tsettingControls = await editorAPI.getNodeSettingsControls({\n\t\t\t\t\tdocumentType: this.documentType,\n\t\t\t\t\tactivity: this.currentBlock?.activity,\n\t\t\t\t});\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\thandleResponseError(error);\n\t\t\t}\n\n\t\t\tthis.useDocumentContext = Boolean(settingControls?.useDocumentContext);\n\t\t\tif (settingControls && Type.isArray(settingControls.controls))\n\t\t\t{\n\t\t\t\tawait this.renderNodeControls(settingControls.controls);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tawait this.renderPropertyDialog(formData);\n\t\t\t}\n\t\t},\n\t\trenderNodeControls(settingControls: Array): void\n\t\t{\n\t\t\tthis.nodeControls = settingControls;\n\t\t\tconst eventName = 'BX.Bizproc.FieldType.onCollectionRenderControlFinished';\n\n\t\t\tthis.nodeControls = this.nodeControls.map((property) => ({\n\t\t\t\t...property,\n\t\t\t\tcontrolId: property.fieldName.toLowerCase(),\n\t\t\t}));\n\n\t\t\tconst renderedControls = BX.Bizproc.FieldType.renderControlCollection(\n\t\t\t\tthis.documentType,\n\t\t\t\tthis.nodeControls.filter((field) => field.property.Type !== 'Custom'),\n\t\t\t\t'designer',\n\t\t\t);\n\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tEvent.EventEmitter.subscribeOnce(eventName, () => {\n\t\t\t\t\tconst form = Tag.render`<form id=\"form-settings\"></form>`;\n\t\t\t\t\tthis.settingsForm = form;\n\t\t\t\t\tconst activityTypeName = this.currentBlock.activity?.Type ?? '';\n\t\t\t\t\tconst rendererName = `${activityTypeName}Renderer`;\n\t\t\t\t\tconst RendererClass = Type.isFunction(window[rendererName]) ? window[rendererName] : null;\n\n\t\t\t\t\tlet customRenderers = null;\n\t\t\t\t\tlet instance = null;\n\t\t\t\t\tif (RendererClass)\n\t\t\t\t\t{\n\t\t\t\t\t\tinstance = RendererClass ? new RendererClass() : null;\n\t\t\t\t\t\tcustomRenderers = (instance && Type.isFunction(instance.getControlRenderers))\n\t\t\t\t\t\t\t? instance.getControlRenderers()\n\t\t\t\t\t\t\t: null;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.nodeControls.forEach((field) => {\n\t\t\t\t\t\tlet control = renderedControls[field.controlId];\n\n\t\t\t\t\t\tif (field.property.Type === 'custom' && instance && customRenderers)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst renderer = customRenderers?.[field?.property?.CustomType];\n\t\t\t\t\t\t\tif (Type.isFunction(renderer))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcontrol = renderer(field);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (control)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst row = this.renderField(control, field);\n\t\t\t\t\t\t\tconst escapedFieldName = field.fieldName.replace(/[!\"#$%&'()*+,.\\/:;<=>?@[\\\\\\]^`{|}~]/g, '\\\\$&');\n\t\t\t\t\t\t\tconst input = row.querySelector(`[name^=\"${escapedFieldName}\"]`);\n\t\t\t\t\t\t\tEvent.bind(input, 'input', this.handleFieldInput);\n\t\t\t\t\t\t\tthis.inputListeners.push(input);\n\n\t\t\t\t\t\t\tif (field.property.Type !== 'custom' && input?.tagName === 'SELECT')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.addClass(input, 'ui-ctl-element');\n\t\t\t\t\t\t\t\tconst wrapper = Tag.render`\n\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100${field.property.Multiple === true ? ' ui-ctl-multiple-select' : ''}\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t\t\t\t${input}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t`;\n\t\t\t\t\t\t\t\tDom.append(wrapper, row);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst selectorInput = row.querySelector('input[data-role=\"bp-selector-button\"]');\n\t\t\t\t\t\t\tif (selectorInput)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst span = document.createElement('span');\n\t\t\t\t\t\t\t\tspan.className = 'node-settings-select-dotted';\n\n\t\t\t\t\t\t\t\tfor (const attr of selectorInput.attributes)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst attrName = attr.name;\n\t\t\t\t\t\t\t\t\tconst attrValue = attr.value;\n\t\t\t\t\t\t\t\t\tspan.setAttribute(attrName, attrValue);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tDom.replace(selectorInput, span);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tDom.append(row, form);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.$refs.contentContainer.innerHTML = '';\n\t\t\t\t\tDom.append(form, this.$refs.contentContainer);\n\t\t\t\t\tthis.hasSettings = true;\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tasync renderPropertyDialog(formData: FormData): Promise<void>\n\t\t{\n\t\t\tconst { renderPropertyDialog } = usePropertyDialog();\n\t\t\tconst form = await renderPropertyDialog(this.$refs.contentContainer, formData);\n\t\t\tif (!form)\n\t\t\t{\n\t\t\t\tthis.isLoading = false;\n\t\t\t\tthis.hasSettings = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.settingsForm = form;\n\t\t\tthis.hasSettings = true;\n\t\t\tthis.isLoading = false;\n\t\t},\n\t\tgetDocuments(): [{ id: string, text: string }]\n\t\t{\n\t\t\treturn this.store.getAllBlockAncestors(this.currentBlock).reduce((acc, block: Block) => {\n\t\t\t\tif (Type.isArrayFilled(block.activity.ReturnProperties))\n\t\t\t\t{\n\t\t\t\t\tblock.activity.ReturnProperties.forEach((property) => {\n\t\t\t\t\t\tconst id = `{=${block.id}:${property.Id}}`;\n\n\t\t\t\t\t\tif (property.Type === 'document')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tacc.push({\n\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\ttext: `${property.Name} (${block.activity.Properties.Title})`,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn acc;\n\t\t\t}, []);\n\t\t},\n\t\tvalidateForm(formData: Object): void\n\t\t{\n\t\t\tif (!this.nodeControls)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.hasErrors = false;\n\t\t\tthis.nodeControls.forEach((field) => {\n\t\t\t\tconst value = formData[field.fieldName];\n\t\t\t\tconst required = false; // field.property.Required;\n\t\t\t\tconst escapedFieldName = field.fieldName.replace(/[!\"#$%&'()*+,.\\/:;<=>?@[\\\\\\]^`{|}~]/g, '\\\\$&');\n\t\t\t\tconst input = document.querySelector(`[name^=\"${escapedFieldName}\"]`);\n\n\t\t\t\tif (!input)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (required && (!value || (Type.isString(value) && value.trim() === '')))\n\t\t\t\t{\n\t\t\t\t\tthis.hasErrors = true;\n\n\t\t\t\t\tlet highlightElement = input;\n\t\t\t\t\tif (input.type === 'hidden')\n\t\t\t\t\t{\n\t\t\t\t\t\tconst wrapperDiv = input.closest(`div[id*=\"${escapedFieldName}\"]`);\n\t\t\t\t\t\tif (wrapperDiv)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thighlightElement = wrapperDiv;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tDom.addClass(highlightElement, 'has-error');\n\t\t\t\t\tif (input.type !== 'hidden')\n\t\t\t\t\t{\n\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(input, 'has-error');\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\thandleFieldInput(event: InputEvent): void\n\t\t{\n\t\t\tif (this.hasErrors)\n\t\t\t{\n\t\t\t\tDom.removeClass(event.target, 'has-error');\n\t\t\t}\n\t\t},\n\n\t\tisUrl(value: string): boolean\n\t\t{\n\t\t\tif (!value || !Type.isString(value))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst u = new URL(value);\n\n\t\t\t\treturn u.protocol === 'https:';\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\n\t\tgetSafeUrl(url: string): string\n\t\t{\n\t\t\tif (!url || !Type.isString(url))\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst u = new URL(url.trim());\n\t\t\t\tif (u.protocol !== 'https:')\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn u.href;\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\t\t},\n\n\t\tgetBackgroundImage(url: string): Object\n\t\t{\n\t\t\tconst safeUrl = this.getSafeUrl(url);\n\t\t\tif (!safeUrl)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t'background-image': `url('${safeUrl}')`,\n\t\t\t};\n\t\t},\n\n\t\ttoggleActivation(event: MouseEvent): void\n\t\t{\n\t\t\tthis.store.toggleBlockActivation(this.currentBlock.id, true);\n\t\t},\n\n\t\tsyncActivatedField(): void\n\t\t{\n\t\t\tconst activatedInput = document.getElementsByName('activated')[0];\n\t\t\tif (activatedInput)\n\t\t\t{\n\t\t\t\tactivatedInput.value = activatedInput.value === 'Y' ? 'N' : 'Y';\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<transition name=\"slide-fade\">\n\t\t\t<div v-if=\"isVisible\" class=\"node-settings-panel\" ref=\"settingsPanel\">\n\t\t\t\t<div class=\"node-settings-header\">\n\t\t\t\t\t<h3 class=\"node-settings-title\">{{loc('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_TITLE')}}</h3>\n\t\t\t\t\t<span class=\"node-settings-title-close-icon\" @click=\"handleFormCancel\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"node-settings-form__node-brief\">\n\t\t\t\t\t<BlockHeader :block=\"block\" :subIconExternal=\"isUrl(block.node?.icon)\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<BlockIcon\n\t\t\t\t\t\t\t\t:iconName=\"icon\"\n\t\t\t\t\t\t\t\t:iconColorIndex=\"colorIndex\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #subIcon\n\t\t\t\t\t\t\t\t  v-if=\"isSubIcon\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-if=\"isUrl(block.node.icon)\"\n\t\t\t\t\t\t\t\t:style=\"getBackgroundImage(block.node.icon)\"\n\t\t\t\t\t\t\t\tclass=\"ui-selector-item-avatar\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<BlockIcon\n\t\t\t\t\t\t\t\tv-else\n\t\t\t\t\t\t\t\t:iconName=\"block.node.icon\"\n\t\t\t\t\t\t\t\t:iconColorIndex=\"7\"\n\t\t\t\t\t\t\t\t:iconSize=\"24\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</BlockHeader>\n\t\t\t\t\t<IconButton\n\t\t\t\t\t\t:icon-name=\"activationIcon\"\n\t\t\t\t\t\t@click=\"toggleActivation\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"node-settings-form__section-delimeter\"></div>\n\t\t\t\t<Transition\n\t\t\t\t\t:css=\"shouldShowWithTransition\"\n\t\t\t\t\tname=\"node-settings-transition\"\n\t\t\t\t>\n\t\t\t\t\t<div v-show=\"!isLoading\" class=\"node-settings-content\">\n\t\t\t\t\t\t<div class=\"temp-block\" v-show=\"!hasSettings\">\n\t\t\t\t\t\t\t<svg width=\"330\" height=\"162\" viewBox=\"0 0 330 162\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t<g opacity=\"0.8\">\n\t\t\t\t\t\t\t\t\t<g opacity=\"0.8\" filter=\"url(#filter0_d_348_93445)\">\n\t\t\t\t\t\t\t\t\t\t<path d=\"M87.0298 24.5516C87.0298 15.9188 93.507 9.42059 101.372 10.041L225.88 19.8304C231.526 20.272 236.027 26.4233 236.027 33.5839V117.788C236.027 124.938 231.516 131.079 225.88 131.499L101.372 140.752C93.507 141.341 87.0298 134.822 87.0298 126.179V24.5516Z\" fill=\"#C4E6FF\"/>\n\t\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t</g>\n\t\t\t\t\t\t\t\t<path opacity=\"0.05\" fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M107.155 46.8539C107.155 46.4964 106.893 46.1915 106.556 46.1809C106.22 46.1704 105.957 46.4543 105.957 46.8118V56.5592L96.9034 56.3384C96.5669 56.3384 96.2935 56.6223 96.2935 56.9798C96.2935 57.3373 96.5669 57.6422 96.9034 57.6528L105.957 57.8631V77.3683H96.9034C96.5669 77.3683 96.2935 77.6627 96.2935 78.0307C96.2935 78.3988 96.5669 78.6827 96.9034 78.6827H105.957V98.1669L96.9034 98.3877C96.5669 98.3877 96.2935 98.6926 96.2935 99.0606C96.2935 99.4287 96.5669 99.7126 96.9034 99.702L105.957 99.4602V118.965L96.9034 119.407C96.5669 119.428 96.2935 119.733 96.2935 120.091C96.2935 120.448 96.5669 120.732 96.9034 120.721L105.957 120.259V130.006C105.957 130.364 106.22 130.637 106.556 130.616C106.893 130.595 107.155 130.29 107.155 129.933V120.196L124.663 119.312V128.849C124.663 129.196 124.915 129.47 125.231 129.449C125.546 129.428 125.798 129.133 125.798 128.776V119.249L142.549 118.398V127.724C142.549 128.071 142.791 128.334 143.096 128.313C143.4 128.292 143.642 127.998 143.642 127.661V118.345L159.688 117.535V126.673C159.688 127.009 159.919 127.272 160.214 127.251C160.508 127.23 160.74 126.946 160.74 126.61V117.483L176.123 116.705V125.653C176.123 125.979 176.344 126.231 176.628 126.221C176.912 126.21 177.132 125.926 177.132 125.59V116.652L191.895 115.906V124.675C191.895 125.001 192.116 125.243 192.379 125.232C192.642 125.222 192.863 124.938 192.863 124.622V115.864L207.037 115.149V123.739C207.037 124.055 207.247 124.297 207.5 124.286C207.752 124.275 207.962 124.002 207.962 123.687V115.106L221.59 114.412V122.835C221.59 123.14 221.789 123.382 222.031 123.371C222.273 123.361 222.473 123.087 222.473 122.782V114.37L228.214 114.076C228.456 114.065 228.656 113.803 228.656 113.498C228.656 113.193 228.456 112.951 228.214 112.961L222.473 113.245V96.4214L228.214 96.2742C228.456 96.2742 228.656 96.0113 228.656 95.7064C228.656 95.4014 228.456 95.1596 228.214 95.1596L222.473 95.2963V78.4724H228.214C228.456 78.4724 228.656 78.2095 228.656 77.9045C228.656 77.5996 228.456 77.3473 228.214 77.3473H222.473V60.5233L228.214 60.6495C228.456 60.6495 228.656 60.4077 228.656 60.1027C228.656 59.7978 228.456 59.5454 228.214 59.5349L222.473 59.3982V50.9863C222.473 50.6813 222.273 50.4185 222.031 50.408C221.789 50.3974 221.59 50.6393 221.59 50.9547V59.3772L207.962 59.0407V50.4605C207.962 50.1451 207.752 49.8822 207.5 49.8717C207.247 49.8612 207.037 50.1135 207.037 50.429V59.0197L192.863 58.6727V49.9138C192.863 49.5878 192.642 49.3249 192.379 49.3144C192.116 49.3039 191.895 49.5562 191.895 49.8822V58.6517L177.132 58.2942V49.3565C177.132 49.0305 176.912 48.7571 176.628 48.7466C176.344 48.7361 176.123 48.999 176.123 49.3249V58.2731L160.74 57.8946V48.7676C160.74 48.4311 160.508 48.1472 160.214 48.1367C159.919 48.1262 159.688 48.3891 159.688 48.7256V57.8631L143.642 57.474V48.1578C143.642 47.8108 143.4 47.5269 143.096 47.5163C142.791 47.5058 142.549 47.7792 142.549 48.1157V57.4425L125.798 57.0324V47.5058C125.798 47.1588 125.546 46.8644 125.231 46.8539C124.915 46.8434 124.663 47.1168 124.663 47.4638V57.0008L107.155 56.5802V46.8434V46.8539ZM221.6 113.287V96.4424L207.973 96.7999V113.96L221.6 113.287ZM207.047 114.002V96.8209L192.873 97.189V114.696L207.047 114.002ZM191.906 114.738V97.21L177.143 97.5991V115.464L191.906 114.738ZM176.134 115.517V97.6201L160.75 98.0197V116.263L176.134 115.506V115.517ZM159.699 116.326V98.0617L143.653 98.4823V117.115L159.699 116.326ZM142.559 117.167V98.5033L125.809 98.945V117.988L142.559 117.167ZM124.663 118.04V98.966L107.155 99.4287V118.902L124.663 118.04ZM124.663 97.7042L107.155 98.1353V78.6616L124.663 78.6301V97.7042ZM142.559 97.2626L125.809 97.6727V78.6301L142.559 78.5985V97.2626ZM159.699 96.842L143.653 97.2416V78.6091L159.699 78.5775V96.842ZM176.134 96.4319L160.75 96.8104V78.567L176.134 78.546V96.4424V96.4319ZM191.906 96.0428L177.143 96.4109V78.546L191.906 78.5249V96.0534V96.0428ZM207.047 95.6748L192.873 96.0218V78.5144L207.047 78.4934V95.6748ZM221.6 95.3173L207.973 95.6538V78.4934L221.6 78.4724V95.3173ZM221.6 77.3367V60.4918L207.973 60.1763V77.3367H221.6ZM207.047 77.3473V60.1658L192.873 59.8399V77.3473H207.047ZM191.906 77.3473V59.8188L177.143 59.4824V77.3473H191.906ZM176.134 77.3473V59.4508L160.75 59.1038V77.3473H176.134ZM159.699 77.3473V59.0828L143.653 58.7148V77.3473H159.699ZM142.559 77.3578V58.6937L125.809 58.3152V77.3578H142.559ZM124.663 77.3578V58.2837L107.155 57.8841V77.3578H124.663Z\" fill=\"#1F86FF\"/>\n\t\t\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M225.88 20.9239L101.372 11.3238C94.1694 10.7665 88.2495 16.718 88.2495 24.6252V126.116C88.2495 134.023 94.18 139.995 101.372 139.469L225.88 130.395C231.053 130.017 235.196 124.391 235.196 117.83V33.5314C235.196 26.97 231.053 21.3235 225.88 20.9239ZM101.372 10.041C93.507 9.42059 87.0298 15.9188 87.0298 24.5516V126.189C87.0298 134.822 93.507 141.341 101.372 140.763L225.88 131.51C231.526 131.089 236.027 124.959 236.027 117.798V33.5839C236.027 26.4338 231.516 20.272 225.88 19.8304L101.372 10.041Z\" fill=\"#9BD4FF\" fill-opacity=\"0.8\"/>\n\t\t\t\t\t\t\t\t<path opacity=\"0.1\" d=\"M87.0298 24.867C87.0298 16.0555 93.507 9.43103 101.372 10.0409L225.88 19.8303C231.526 20.2719 236.027 26.5494 236.027 33.8467V42.6583L87.0298 35.4976V24.867Z\" fill=\"#0075FF\"/>\n\t\t\t\t\t\t\t\t<path d=\"M96.9034 54.3721C96.9034 50.0189 100.174 46.6015 104.169 46.7487L147.459 48.2944C151.024 48.4206 153.894 51.8169 153.894 55.8862V119.68C153.894 123.75 151.024 127.22 147.459 127.44L104.169 130.132C100.174 130.385 96.9034 127.051 96.9034 122.698V54.3721Z\" fill=\"white\"/>\n\t\t\t\t\t\t\t\t<path d=\"M122.949 61.1113C122.949 59.881 123.843 58.9031 124.957 58.9242L144.473 59.3553C145.525 59.3763 146.376 60.3647 146.376 61.5634C146.376 62.7621 145.525 63.719 144.473 63.6979L124.957 63.372C123.853 63.351 122.949 62.3415 122.949 61.1113Z\" fill=\"#DFE0E3\" fill-opacity=\"0.68\"/>\n\t\t\t\t\t\t\t\t<path opacity=\"0.8\" d=\"M101.761 57.1054C101.761 54.2243 103.917 51.9425 106.567 52.0267L113.664 52.237C116.251 52.3106 118.333 54.6659 118.333 57.505V65.1914C118.333 68.0199 116.251 70.3017 113.664 70.2806L106.567 70.2175C103.928 70.1965 101.761 67.8412 101.761 64.9495V57.1054Z\" fill=\"#59FBB0\" fill-opacity=\"0.74\"/>\n\t\t\t\t\t\t\t\t<path opacity=\"0.3\" d=\"M96.9037 75.3916L153.884 75.5178V119.681C153.884 123.75 151.014 127.22 147.449 127.441L104.159 130.132C100.163 130.385 96.8932 127.052 96.8932 122.698V75.3916H96.9037Z\" fill=\"#D7EFFF\" fill-opacity=\"0.8\"/>\n\t\t\t\t\t\t\t\t<path d=\"M134.274 90.5539C134.274 89.3342 135.146 88.3458 136.219 88.3247L144.473 88.2091C145.525 88.1986 146.376 89.1554 146.376 90.3541C146.376 91.5528 145.525 92.5412 144.473 92.5623L136.219 92.72C135.146 92.741 134.274 91.7736 134.274 90.5539Z\" fill=\"#DFE0E3\" fill-opacity=\"0.68\"/>\n\t\t\t\t\t\t\t\t<path d=\"M134.274 113.171C134.274 111.952 135.146 110.932 136.219 110.89L144.473 110.553C145.525 110.511 146.376 111.447 146.376 112.646C146.376 113.844 145.525 114.854 144.473 114.896L136.219 115.274C135.146 115.327 134.274 114.381 134.274 113.161V113.171Z\" fill=\"#DFE0E3\" fill-opacity=\"0.68\"/>\n\t\t\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M129.08 90.2276L123.612 85.9375C123.486 85.8323 123.317 85.8218 123.17 85.9164C123.033 86.0006 122.939 86.1688 122.949 86.3581V95.1275C122.949 95.3168 123.033 95.4745 123.17 95.5586C123.307 95.6428 123.475 95.6217 123.612 95.5166L129.08 91.0477C129.195 90.9531 129.258 90.8059 129.258 90.6376C129.258 90.4694 129.185 90.3222 129.08 90.2381V90.2276Z\" fill=\"#0075FF\" fill-opacity=\"0.78\"/>\n\t\t\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M110.583 90.5222L104.863 86.1374C104.727 86.0323 104.548 86.0218 104.401 86.1059C104.253 86.19 104.159 86.3688 104.169 86.558V95.5273C104.169 95.7165 104.253 95.8848 104.401 95.9689C104.548 96.053 104.727 96.032 104.863 95.9269L110.583 91.3528C110.699 91.2582 110.773 91.1005 110.773 90.9323C110.773 90.764 110.699 90.6168 110.583 90.5222Z\" fill=\"#DFE0E3\" fill-opacity=\"0.68\"/>\n\t\t\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M129.08 112.993L123.612 108.85C123.486 108.755 123.317 108.745 123.17 108.839C123.033 108.934 122.939 109.102 122.949 109.292V118.061C122.949 118.25 123.033 118.408 123.17 118.492C123.307 118.576 123.475 118.555 123.612 118.44L129.08 113.813C129.195 113.718 129.258 113.561 129.258 113.403C129.258 113.245 129.185 113.087 129.08 113.003V112.993Z\" fill=\"#0075FF\" fill-opacity=\"0.78\"/>\n\t\t\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M110.583 113.792L104.863 109.565C104.727 109.459 104.548 109.459 104.401 109.554C104.253 109.649 104.159 109.827 104.169 110.017V118.986C104.169 119.175 104.253 119.344 104.401 119.428C104.548 119.512 104.727 119.491 104.863 119.375L110.583 114.643C110.699 114.549 110.773 114.391 110.773 114.223C110.773 114.054 110.699 113.907 110.583 113.813V113.792Z\" fill=\"#DFE0E3\" fill-opacity=\"0.68\"/>\n\t\t\t\t\t\t\t\t<path d=\"M171.581 63.5515C171.581 60.2393 173.852 57.6105 176.638 57.6841L223.829 58.8723C226.269 58.9354 228.235 61.4695 228.235 64.5504V75.6857C228.235 78.7561 226.269 81.2586 223.829 81.2797L176.638 81.5425C173.852 81.5531 171.581 78.8823 171.581 75.5701V63.5725V63.5515Z\" fill=\"white\"/>\n\t\t\t\t\t\t\t\t<path d=\"M193.347 69.7651C193.347 68.64 194.104 67.7357 195.029 67.7462L217.794 68.0301C218.667 68.0406 219.371 68.9344 219.371 70.0174C219.371 71.1005 218.667 71.9837 217.794 71.9732L195.029 71.8155C194.104 71.8155 193.347 70.8902 193.347 69.7651Z\" fill=\"#DFE0E3\" fill-opacity=\"0.68\"/>\n\t\t\t\t\t\t\t\t<path opacity=\"0.3\" d=\"M175.629 66.0119C175.629 63.3727 177.427 61.2697 179.635 61.3223L185.566 61.4484C187.732 61.4905 189.477 63.625 189.477 66.2222V73.2567C189.477 75.8434 187.732 77.9464 185.566 77.9464H179.635C177.427 77.9464 175.629 75.8224 175.629 73.1831V66.0224V66.0119Z\" fill=\"#44B0FF\" fill-opacity=\"0.74\"/>\n\t\t\t\t\t\t\t\t<path d=\"M177.638 93.4241C177.638 90.1329 179.877 87.4411 182.611 87.4095L220.255 86.9153C222.715 86.8838 224.702 89.3653 224.702 92.4462V103.634C224.702 106.725 222.715 109.312 220.255 109.417L182.611 111.068C179.867 111.184 177.638 108.618 177.638 105.338V93.4346V93.4241Z\" fill=\"white\"/>\n\t\t\t\t\t\t\t\t<path d=\"M199.077 98.7659C199.077 97.6513 199.824 96.726 200.728 96.6944L216.889 96.2738C217.762 96.2528 218.467 97.115 218.467 98.2086C218.467 99.3021 217.762 100.206 216.889 100.227L200.728 100.732C199.813 100.764 199.077 99.8804 199.077 98.7553V98.7659Z\" fill=\"#DFE0E3\" fill-opacity=\"0.68\"/>\n\t\t\t\t\t\t\t\t<path opacity=\"0.3\" d=\"M181.633 95.706C181.633 93.0878 183.41 90.9322 185.576 90.9007L191.422 90.7956C193.557 90.7535 195.271 92.8144 195.271 95.3801V102.362C195.271 104.928 193.557 107.083 191.422 107.167L185.576 107.399C183.4 107.483 181.633 105.432 181.633 102.814V95.706Z\" fill=\"#FAA72C\" fill-opacity=\"0.78\"/>\n\t\t\t\t\t\t\t\t<path d=\"M213.03 113.14C213.03 107.493 216.689 102.783 221.158 102.635L243.524 101.857C247.677 101.71 251 105.948 251 111.3V139.154C251 144.516 247.667 149.196 243.524 149.616L221.158 151.887C216.689 152.34 213.03 148.134 213.03 142.487V113.129V113.14Z\" fill=\"#1BCE7B\" fill-opacity=\"0.78\"/>\n\t\t\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M243.524 102.94L221.158 103.75C217.194 103.897 213.945 108.072 213.945 113.087V142.403C213.945 147.419 217.194 151.162 221.158 150.762L243.524 148.523C247.214 148.155 250.18 143.991 250.18 139.217V111.331C250.18 106.557 247.214 102.804 243.524 102.94ZM221.158 102.625C216.689 102.783 213.03 107.483 213.03 113.129V142.487C213.03 148.134 216.689 152.34 221.158 151.887L243.524 149.616C247.677 149.196 251 144.506 251 139.154V111.3C251 105.937 247.667 101.71 243.524 101.857L221.158 102.635V102.625Z\" fill=\"white\" fill-opacity=\"0.18\"/>\n\t\t\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M224.082 136.314L222.368 136.451C221.558 136.514 220.896 135.736 220.896 134.716C220.896 133.696 221.558 132.813 222.368 132.75L224.082 132.624C224.681 130.426 226.301 128.765 228.204 128.628C230.107 128.491 231.684 129.911 232.273 132.003L241 131.341C241.768 131.278 242.399 132.045 242.399 133.034C242.399 134.022 241.779 134.884 241 134.948L232.273 135.652C231.684 137.829 230.086 139.5 228.204 139.658C226.322 139.816 224.692 138.417 224.082 136.314ZM231.327 122.908L222.357 123.476C221.548 123.528 220.885 122.74 220.885 121.709C220.885 120.679 221.548 119.817 222.357 119.764L231.327 119.249C231.916 117.083 233.503 115.474 235.364 115.369C237.226 115.264 238.782 116.704 239.36 118.776L241 118.681C241.768 118.639 242.399 119.406 242.399 120.405C242.399 121.404 241.779 122.245 241 122.298L239.36 122.403C238.782 124.548 237.215 126.168 235.364 126.294C233.514 126.42 231.916 125 231.327 122.908ZM235.364 122.645C236.143 122.592 236.784 121.741 236.784 120.742C236.784 119.743 236.153 118.965 235.364 119.007C234.576 119.049 233.945 119.911 233.945 120.91C233.945 121.909 234.586 122.698 235.364 122.645ZM228.193 135.978C228.992 135.915 229.634 135.042 229.634 134.022C229.634 133.002 228.992 132.235 228.193 132.298C227.394 132.361 226.742 133.234 226.742 134.254C226.742 135.273 227.394 136.041 228.193 135.978Z\" fill=\"white\" fill-opacity=\"0.9\"/>\n\t\t\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M165.945 70.1017C164.515 70.0912 163.358 71.4371 163.358 73.109V86.442C163.358 88.7868 161.728 90.7111 159.709 90.7426L153.895 90.8372V89.607L159.709 89.5123C161.15 89.4913 162.328 88.1139 162.328 86.442V73.088C162.328 70.7432 163.958 68.861 165.955 68.882L171.591 68.9451V70.1438L165.955 70.0912L165.945 70.1017Z\" fill=\"#44B0FF\" fill-opacity=\"0.74\"/>\n\t\t\t\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M168.784 100.227C167.364 100.269 166.218 101.657 166.218 103.319V108.156C166.218 110.49 164.599 112.456 162.59 112.54L153.905 112.929V111.699L162.59 111.321C164.02 111.258 165.188 109.859 165.188 108.187V103.35C165.188 101.016 166.807 99.0708 168.794 99.0182L177.658 98.7764V99.9646L168.794 100.227H168.784Z\" fill=\"#44B0FF\" fill-opacity=\"0.74\"/>\n\t\t\t\t\t\t\t\t<defs>\n\t\t\t\t\t\t\t\t\t<filter id=\"filter0_d_348_93445\" x=\"79.4698\" y=\"4.6\" width=\"164.117\" height=\"145.909\" filterUnits=\"userSpaceOnUse\" color-interpolation-filters=\"sRGB\">\n\t\t\t\t\t\t\t\t\t\t<feFlood flood-opacity=\"0\" result=\"BackgroundImageFix\"/>\n\t\t\t\t\t\t\t\t\t\t<feColorMatrix in=\"SourceAlpha\" type=\"matrix\" values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0\" result=\"hardAlpha\"/>\n\t\t\t\t\t\t\t\t\t\t<feOffset dy=\"2.16\"/>\n\t\t\t\t\t\t\t\t\t\t<feGaussianBlur stdDeviation=\"3.78\"/>\n\t\t\t\t\t\t\t\t\t\t<feComposite in2=\"hardAlpha\" operator=\"out\"/>\n\t\t\t\t\t\t\t\t\t\t<feColorMatrix type=\"matrix\" values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.02 0\"/>\n\t\t\t\t\t\t\t\t\t\t<feBlend mode=\"normal\" in2=\"BackgroundImageFix\" result=\"effect1_dropShadow_348_93445\"/>\n\t\t\t\t\t\t\t\t\t\t<feBlend mode=\"normal\" in=\"SourceGraphic\" in2=\"effect1_dropShadow_348_93445\" result=\"shape\"/>\n\t\t\t\t\t\t\t\t\t</filter>\n\t\t\t\t\t\t\t\t</defs>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<p>{{loc('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_TEXT')}}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ref=\"contentContainer\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</Transition>\n\t\t\t\t<div v-if=\"isLoading\" class=\"loader-spinner node-settings-content\">\n\t\t\t\t\t<span class=\"dot dot1\"></span>\n\t\t\t\t\t<span class=\"dot dot2\"></span>\n\t\t\t\t\t<span class=\"dot dot3\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"node-settings-footer\" v-show=\"hasSettings\">\n\t\t\t\t\t<button class=\"ui-btn --air ui-btn-lg --style-outline-fill-accent ui-btn-no-caps\" @click=\"handleFormSave\">\n\t\t\t\t\t\t{{loc('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_SAVE')}}\n\t\t\t\t\t</button>\n\t\t\t\t\t<button class=\"ui-btn --air ui-btn-lg --style-outline ui-btn-no-caps\" @click=\"handleFormCancel\">\n\t\t\t\t\t\t{{loc('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CANCEL')}}\n\t\t\t\t\t</button>\n\n\t\t\t\t\t<div class=\"node-settings-document-selector\" v-show=\"useDocumentContext\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\tname=\"document\"\n\t\t\t\t\t\t\t:size=\"24\"\n\t\t\t\t\t\t\t@click=\"handleDocumentSelector\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`,\n};\n","import { CONSTRUCTION_OPERATORS } from '../../../../entities/node-settings';\nexport const OperatorPhraseCodes = Object.freeze({\n\t[CONSTRUCTION_OPERATORS.equal]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_OPERATOR_EQUAL',\n\t[CONSTRUCTION_OPERATORS.notEqual]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_OPERATOR_NOT_EQUAL',\n\t[CONSTRUCTION_OPERATORS.empty]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_OPERATOR_EMPTY',\n\t[CONSTRUCTION_OPERATORS.notEmpty]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_OPERATOR_NOT_EMPTY',\n\t[CONSTRUCTION_OPERATORS.contain]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_OPERATOR_CONTAIN',\n\t[CONSTRUCTION_OPERATORS.notContain]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_OPERATOR_NOT_CONTAIN',\n\t[CONSTRUCTION_OPERATORS.in]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_OPERATOR_IN',\n\t[CONSTRUCTION_OPERATORS.notIn]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_OPERATOR_NOT_IN',\n\t[CONSTRUCTION_OPERATORS.greaterThan]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_OPERATOR_GREATER_THAN',\n\t[CONSTRUCTION_OPERATORS.greaterThanOrEqual]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_OPERATOR_GREATER_THAN_OR_EQUAL',\n\t[CONSTRUCTION_OPERATORS.lessThan]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_OPERATOR_LESS_THAN',\n\t[CONSTRUCTION_OPERATORS.lessThanOrEqual]: 'BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_OPERATOR_LESS_THAN_OR_EQUAL',\n});\n\nexport const OperatorRequiresValue = (operator: $Values<CONSTRUCTION_OPERATORS>): boolean => {\n\tswitch (operator)\n\t{\n\t\tcase CONSTRUCTION_OPERATORS.empty:\n\t\tcase CONSTRUCTION_OPERATORS.notEmpty:\n\t\t\treturn false;\n\t\tdefault:\n\t\t\treturn true;\n\t}\n};\n","import { Loc, Type } from 'main.core';\nimport { Dialog, EntityOptions, Item, ItemOptions, TabOptions } from 'ui.entity-selector';\nimport { diagramStore } from '../../../../entities/blocks';\nimport type { ConditionExpressionField } from '../../../../entities/node-settings';\nimport { type PortId, Block } from '../../../../shared/types';\n\nconst CustomDataFieldKey = 'field';\n\nexport class FieldSelector\n{\n\tstore: diagramStore;\n\tcurrentBlock: Block;\n\n\tcurrentPortId: PortId;\n\n\tconstructor(\n\t\tcurrentBlock: Block,\n\t\tcurrentPortId: PortId,\n\t)\n\t{\n\t\tthis.store = diagramStore();\n\t\tthis.currentBlock = currentBlock;\n\t\tthis.currentPortId = currentPortId;\n\t}\n\n\tshow(targetElement: Element): Promise<ConditionExpressionField>\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tconst dialog = new Dialog({\n\t\t\t\ttargetNode: targetElement,\n\t\t\t\twidth: 500,\n\t\t\t\theight: 300,\n\t\t\t\tmultiple: false,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tenableSearch: true,\n\t\t\t\titems: this.#getItems(),\n\t\t\t\ttabs: this.#getTabs(),\n\t\t\t\tentities: this.#getEntities(),\n\t\t\t\tcacheable: false,\n\t\t\t\tshowAvatars: false,\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event) => {\n\t\t\t\t\t\tresolve(this.#getValue(event.getData().item));\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tcompactView: true,\n\t\t\t});\n\n\t\t\tdialog.show();\n\t\t});\n\t}\n\n\t#getValue(item: Item): ConditionExpressionField\n\t{\n\t\tconst field = { ...item.getCustomData().get(CustomDataFieldKey) };\n\n\t\tif (item.getEntityId() === 'bizproc-document')\n\t\t{\n\t\t\treturn {\n\t\t\t\t...field,\n\t\t\t\tfieldId: item.getId(),\n\t\t\t};\n\t\t}\n\n\t\treturn field;\n\t}\n\n\t#getEntities(): EntityOptions[]\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: 'bizproc-document',\n\t\t\t},\n\t\t];\n\t}\n\n\t#getTabs(): TabOptions[]\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: 'documents',\n\t\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_SELECTOR_TAB_DOCUMENTS'),\n\t\t\t\ticon: 'elements',\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'returns',\n\t\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_SELECTOR_TAB_RETURNS'),\n\t\t\t\ticon: 'flag-1',\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'template',\n\t\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_SELECTOR_TAB_TEMPLATE'),\n\t\t\t\ticon: 'disk',\n\t\t\t},\n\t\t];\n\t}\n\n\t#getItems(): ItemOptions[]\n\t{\n\t\tconst items = this.getReturnItems();\n\t\tthis.addTemplateItems(items);\n\n\t\treturn items;\n\t}\n\n\taddTemplateItems(items: ItemOptions[]): void\n\t{\n\t\tconst map = [\n\t\t\t{\n\t\t\t\tkey: 'PARAMETERS',\n\t\t\t\tidKey: 'Template',\n\t\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_SELECTOR_ITEM_PARAMETERS'),\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'VARIABLES',\n\t\t\t\tidKey: 'Variable',\n\t\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_SELECTOR_ITEM_VARIABLES'),\n\t\t\t},\n\t\t\t{\n\t\t\t\tkey: 'CONSTANTS',\n\t\t\t\tidKey: 'Constant',\n\t\t\t\ttitle: Loc.getMessage('BIZPROCDESIGNER_SELECTOR_ITEM_CONSTANTS'),\n\t\t\t},\n\t\t];\n\n\t\tmap.forEach((elem) => {\n\t\t\tconst collection = this.store.template[elem.key];\n\t\t\tif (Type.isObject(collection) && Object.keys(collection).length > 0)\n\t\t\t{\n\t\t\t\tconst children = [];\n\t\t\t\tObject.keys(collection).forEach((key) => {\n\t\t\t\t\tconst item = collection[key];\n\t\t\t\t\tconst id = `${elem.idKey}:${key}`;\n\t\t\t\t\tchildren.push({\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tentityId: elem.key,\n\t\t\t\t\t\ttitle: item.Name,\n\t\t\t\t\t\tcustomData: {\n\t\t\t\t\t\t\t[CustomDataFieldKey]: {\n\t\t\t\t\t\t\t\tobject: elem.idKey,\n\t\t\t\t\t\t\t\tfieldId: key,\n\t\t\t\t\t\t\t\ttype: item.Type,\n\t\t\t\t\t\t\t\tmultiple: item.Multiple,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\titems.push({\n\t\t\t\t\tid: elem.idKey,\n\t\t\t\t\tentityId: 'template',\n\t\t\t\t\ttitle: elem.title,\n\t\t\t\t\ttabs: 'template',\n\t\t\t\t\tchildren,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tgetReturnItems(): ItemOptions[]\n\t{\n\t\tconst blocks = this.store.getBlockAncestorsByInputPortId(this.currentBlock, this.currentPortId);\n\n\t\treturn blocks.reduce((acc, block: Block) => {\n\t\t\tif (Type.isArrayFilled(block.activity.Children))\n\t\t\t{\n\t\t\t\tconst properties = this.#processChildrenProperties(block);\n\t\t\t\tif (Type.isArrayFilled(properties))\n\t\t\t\t{\n\t\t\t\t\tacc.push(...properties);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (Type.isArrayFilled(block.activity.ReturnProperties))\n\t\t\t{\n\t\t\t\tconst properties = this.#processReturnProperties(block);\n\t\t\t\tif (Type.isArrayFilled(properties))\n\t\t\t\t{\n\t\t\t\t\tacc.push(...properties);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn acc;\n\t\t}, []);\n\t}\n\n\t#processReturnProperties(block: Block): ItemOptions[]\n\t{\n\t\tconst fullTitle = block.activity.Properties.Title;\n\n\t\tconst { documents, properties } = block.activity.ReturnProperties.reduce(\n\t\t\t(res, property) => {\n\t\t\t\tconst activityName = block.activity?.Name || block.id;\n\t\t\t\tconst id = `${block.id}:${property.Id}`;\n\t\t\t\tif (property.Type === 'document')\n\t\t\t\t{\n\t\t\t\t\tres.documents.push({\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tentityId: 'bizproc-document',\n\t\t\t\t\t\tentityType: 'document',\n\t\t\t\t\t\ttitle: fullTitle,\n\t\t\t\t\t\tcustomData: {\n\t\t\t\t\t\t\tidTemplate: `${property.Id}.#FIELD#`,\n\t\t\t\t\t\t\tdocument: property.Default,\n\t\t\t\t\t\t\t[CustomDataFieldKey]: {\n\t\t\t\t\t\t\t\tobject: activityName,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnodeOptions: {\n\t\t\t\t\t\t\topen: false,\n\t\t\t\t\t\t\tdynamic: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsearchable: false,\n\t\t\t\t\t\ttabs: 'documents',\n\t\t\t\t\t});\n\n\t\t\t\t\treturn res;\n\t\t\t\t}\n\n\t\t\t\tres.properties.push({\n\t\t\t\t\tid,\n\t\t\t\t\tentityId: 'block-node-property',\n\t\t\t\t\ttitle: property.Name,\n\t\t\t\t\tproperty,\n\t\t\t\t\tblock,\n\t\t\t\t\tcustomData: {\n\t\t\t\t\t\t[CustomDataFieldKey]: {\n\t\t\t\t\t\t\tobject: activityName,\n\t\t\t\t\t\t\tfieldId: property.Id,\n\t\t\t\t\t\t\ttype: property.Type,\n\t\t\t\t\t\t\tmultiple: property.Multiple,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\treturn res;\n\t\t\t},\n\t\t\t{ documents: [], properties: [] },\n\t\t);\n\n\t\tconst result = [];\n\n\t\tif (Type.isArrayFilled(documents))\n\t\t{\n\t\t\tresult.push(...documents);\n\t\t}\n\n\t\tif (Type.isArrayFilled(properties))\n\t\t{\n\t\t\tresult.push({\n\t\t\t\tid: block.id,\n\t\t\t\tentityId: 'block-node',\n\t\t\t\ttabs: 'returns',\n\t\t\t\ttitle: fullTitle,\n\t\t\t\tchildren: properties,\n\t\t\t\tsearchable: false,\n\t\t\t});\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#processChildrenProperties(block: Block): ItemOptions[]\n\t{\n\t\tconst childrenProperties = [];\n\t\tblock.activity.Children.forEach((activity) => {\n\t\t\tif (Type.isArrayFilled(activity.ReturnProperties))\n\t\t\t{\n\t\t\t\tconst properties = this.#processReturnProperties({ id: activity.Name, activity });\n\t\t\t\tif (Type.isArrayFilled(properties))\n\t\t\t\t{\n\t\t\t\t\tchildrenProperties.push(...properties);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst { documents, activities } = childrenProperties.reduce(\n\t\t\t(res, child) => {\n\t\t\t\tif (child)\n\t\t\t\t{\n\t\t\t\t\tif (child.entityId === 'bizproc-document')\n\t\t\t\t\t{\n\t\t\t\t\t\tres.documents.push(child);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tres.activities.push(child);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn res;\n\t\t\t},\n\t\t\t{ documents: [], activities: [] },\n\t\t);\n\n\t\tconst properties = [];\n\n\t\tif (Type.isArrayFilled(documents))\n\t\t{\n\t\t\tproperties.push({\n\t\t\t\tid: block.id,\n\t\t\t\tentityId: 'block-node',\n\t\t\t\ttabs: 'documents',\n\t\t\t\ttitle: block.activity.Properties.Title,\n\t\t\t\tchildren: documents,\n\t\t\t\tsearchable: false,\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isArrayFilled(activities))\n\t\t{\n\t\t\tproperties.push({\n\t\t\t\tid: block.id,\n\t\t\t\tentityId: 'block-node',\n\t\t\t\ttabs: 'returns',\n\t\t\t\ttitle: block.activity.Properties.Title,\n\t\t\t\tchildren: activities,\n\t\t\t\tsearchable: false,\n\t\t\t});\n\t\t}\n\n\t\treturn properties;\n\t}\n}\n","import { MenuManager } from 'main.popup';\nimport { mapState, mapActions } from 'ui.vue3.pinia';\nimport { diagramStore } from '../../../../entities/blocks';\nimport { ValueSelector } from '../../../../entities/common-node-settings';\n// eslint-disable-next-line no-unused-vars\nimport type { ConditionConstruction, ConditionExpressionField } from '../../../../entities/node-settings';\nimport { evaluateConditionExpressionFieldTitle } from '../../../../entities/node-settings/utils';\nimport { useLoc } from '../../../../shared/composables';\n\n// eslint-disable-next-line no-unused-vars\nimport {\n\tuseNodeSettingsStore,\n\tCONSTRUCTION_OPERATORS,\n} from '../../../../entities/node-settings';\nimport { OperatorPhraseCodes, OperatorRequiresValue } from './const';\nimport { FieldSelector } from './field-selector';\n\nimport './style.css';\n\n// @vue/component\nexport const EditConditionExpression = {\n\tname: 'edit-condition-expression',\n\tprops:\n\t{\n\t\t/** @type ConditionConstruction */\n\t\tconstruction:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): { getMessage: () => string; }\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn { getMessage };\n\t},\n\tcomputed:\n\t{\n\t\t...mapState(useNodeSettingsStore, ['nodeSettings', 'block', 'currentRuleId']),\n\t\tavailableOperators(): Array<{ id: string, title: string }>\n\t\t{\n\t\t\treturn Object.values(CONSTRUCTION_OPERATORS).map((operator) => ({\n\t\t\t\tid: operator,\n\t\t\t\ttitle: this.getMessage(OperatorPhraseCodes[operator] ?? ''),\n\t\t\t}));\n\t\t},\n\t\tselectedField:\n\t\t{\n\t\t\tget(): ?ConditionExpressionField\n\t\t\t{\n\t\t\t\treturn this.construction.expression.field;\n\t\t\t},\n\t\t\tset(field: ConditionExpressionField): void\n\t\t\t{\n\t\t\t\tthis.changeRuleExpression(this.construction, {\n\t\t\t\t\tfield,\n\t\t\t\t\tvalue: '',\n\t\t\t\t\toperator: '',\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\t\tselectedFieldTitle(): string\n\t\t{\n\t\t\tif (!this.selectedField)\n\t\t\t{\n\t\t\t\treturn this.getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_EXPRESSION_ITEM_NOT_SELECTED');\n\t\t\t}\n\n\t\t\tconst store = diagramStore();\n\t\t\tconst connectedBlocks = store.getBlockAncestorsByInputPortId(this.block, this.currentRuleId);\n\n\t\t\treturn evaluateConditionExpressionFieldTitle(connectedBlocks, this.selectedField);\n\t\t},\n\t\tselectedValue:\n\t\t{\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\treturn this.construction.expression.value;\n\t\t\t},\n\t\t\tset(value: string): void\n\t\t\t{\n\t\t\t\tthis.changeRuleExpression(this.construction, {\n\t\t\t\t\tvalue,\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\t\tselectedOperatorTitle(): string\n\t\t{\n\t\t\treturn this.availableOperators.find(({ id }) => id === this.selectedOperator)?.title\n\t\t\t\t?? this.getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_EXPRESSION_ITEM_NOT_SELECTED')\n\t\t\t;\n\t\t},\n\t\tselectedOperator:\n\t\t{\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\treturn this.construction.expression.operator;\n\t\t\t},\n\t\t\tset(operator: string): void\n\t\t\t{\n\t\t\t\tthis.changeRuleExpression(this.construction, {\n\t\t\t\t\toperator,\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\t\tisShowValueEditor(): boolean\n\t\t{\n\t\t\tif (!this.selectedOperator)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn OperatorRequiresValue(this.selectedOperator);\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\t...mapActions(useNodeSettingsStore, ['changeRuleExpression']),\n\t\tonShowFieldChooseMenu(event: Event): void\n\t\t{\n\t\t\tconst fieldSelector = (new FieldSelector(this.block, this.currentRuleId));\n\n\t\t\tvoid fieldSelector.show(event.target).then((field: ConditionExpressionField) => {\n\t\t\t\tthis.selectedField = field;\n\t\t\t});\n\t\t},\n\t\tonShowValueMenu(event: Event): void\n\t\t{\n\t\t\tif (!this.block)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst valueSelector = new ValueSelector(\n\t\t\t\tdiagramStore(),\n\t\t\t\tthis.block,\n\t\t\t\tthis.currentRuleId,\n\t\t\t);\n\t\t\tvoid valueSelector.show(event.target).then((value: string) => {\n\t\t\t\tthis.selectedValue += value;\n\t\t\t});\n\t\t},\n\t\tonShowOperatorMenu(event: Event): void\n\t\t{\n\t\t\tconst items = this.availableOperators.map(({ id, title }) => {\n\t\t\t\treturn {\n\t\t\t\t\tid,\n\t\t\t\t\ttext: title,\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.selectedOperator = id;\n\t\t\t\t\t\tthis.operatorMenu?.close();\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t});\n\t\t\tthis.operatorMenu = MenuManager.create({\n\t\t\t\tid: 'operator-menu',\n\t\t\t\tbindElement: event.target,\n\t\t\t\titems,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tcacheable: false,\n\t\t\t\tmaxHeight: 200,\n\t\t\t});\n\n\t\t\tthis.operatorMenu.show();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"edit-condition-expression-form\">\n\t\t\t<div class=\"edit-condition-expression-form__item\">\n\t\t\t\t<span class=\"edit-condition-expression-form__label\">\n\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_FIELD') }}\n\t\t\t\t</span>\n\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown edit-condition-expression-form__dropdown\">\n\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tref=\"fieldChooseMenu\"\n\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t:title=\"selectedFieldTitle\"\n\t\t\t\t\t\t@click=\"onShowFieldChooseMenu\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ selectedFieldTitle }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"edit-condition-expression-form__item\">\n\t\t\t\t<span class=\"edit-condition-expression-form__label\">\n\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_EXPRESSION_OPERATOR') }}\n\t\t\t\t</span>\n\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown edit-condition-expression-form__dropdown\"\n\t\t\t\t\t @click=\"onShowOperatorMenu\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ selectedOperatorTitle }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"isShowValueEditor\"\n\t\t\t\tclass=\"edit-condition-expression-form__item\"\n\t\t\t>\n\t\t\t\t<span class=\"edit-condition-expression-form__label\">\n\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_EXPRESSION_VALUE') }}\n\t\t\t\t</span>\n\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown edit-condition-expression-form__dropdown\">\n\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-dots\" style=\"pointer-events: all\"\n\t\t\t\t\t\t @click=\"onShowValueMenu\"\n\t\t\t\t\t></div>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\tv-model=\"selectedValue\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import './style.css';\n\nimport { MenuManager, type MenuItem } from 'main.popup';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { mapActions } from 'ui.vue3.pinia';\n\nimport { useLoc } from '../../../../shared/composables';\n\n// eslint-disable-next-line no-unused-vars\nimport { CONSTRUCTION_TYPES, useNodeSettingsStore, type TRuleCard } from '../../../../entities/node-settings';\n\n// @vue/component\nexport const AddConstruction = {\n\tname: 'add-construction',\n\tcomponents: { BIcon },\n\tprops:\n\t{\n\t\t/** @type TRuleCard */\n\t\truleCard:\n\t\t{\n\t\t\ttype: [Object, null],\n\t\t\tdefault: null,\n\t\t},\n\t\tposition:\n\t\t{\n\t\t\ttype: [Number, undefined],\n\t\t\tdefault: undefined,\n\t\t},\n\t},\n\tsetup(): { getMessage: () => string; }\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn { getMessage };\n\t},\n\tmethods:\n\t{\n\t\t...mapActions(useNodeSettingsStore, ['addConstruction', 'addRuleCard']),\n\t\tonShowMenu(): void\n\t\t{\n\t\t\tthis.menu = MenuManager.create(\n\t\t\t\t'constructions-menu',\n\t\t\t\tthis.$refs.constructionsMenu,\n\t\t\t\tthis.getMenuItems(),\n\t\t\t\t{\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\toffsetLeft: -50,\n\t\t\t\t\toffsetTop: 7,\n\t\t\t\t},\n\t\t\t);\n\t\t\tthis.menu.show();\n\t\t},\n\t\tgetMenuItems(): Array<MenuItem>\n\t\t{\n\t\t\t// temporary\n\t\t\tconst isActionCardExists = (this.ruleCard?.constructions ?? []).some(\n\t\t\t\t(construction) => construction.type === CONSTRUCTION_TYPES.ACTION,\n\t\t\t);\n\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid: CONSTRUCTION_TYPES.AND_CONDITION,\n\t\t\t\t\ttext: this.getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_BOOLEAN_MENU_ITEM'),\n\t\t\t\t\tonclick: this.onClickMenuItem,\n\t\t\t\t\tdataset: { testId: 'complexNodeRuleSettingsMenuItemConstructionAnd' },\n\t\t\t\t\tdisabled: this.isIfConditionNotExist(this.ruleCard),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: CONSTRUCTION_TYPES.IF_CONDITION,\n\t\t\t\t\ttext: this.getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_CONDITION_MENU_ITEM'),\n\t\t\t\t\tdataset: { testId: 'complexNodeRuleSettingsMenuItemConstructionIf' },\n\t\t\t\t\tonclick: this.onClickMenuItem,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: CONSTRUCTION_TYPES.ACTION,\n\t\t\t\t\ttext: this.getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ACTION_MENU_ITEM'),\n\t\t\t\t\tdataset: { testId: 'complexNodeRuleSettingsMenuItemConstructionAction' },\n\t\t\t\t\tonclick: this.onClickMenuItem,\n\t\t\t\t\tdisabled: isActionCardExists,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: CONSTRUCTION_TYPES.OUTPUT,\n\t\t\t\t\ttext: this.getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_OUTPUT_MENU_ITEM'),\n\t\t\t\t\tdataset: { testId: 'complexNodeRuleSettingsMenuItemConstructionOutput' },\n\t\t\t\t\tonclick: this.onClickMenuItem,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tonClickMenuItem(...args): void\n\t\t{\n\t\t\tconst [, menuItem] = args;\n\t\t\tconst ruleCard = this.ruleCard ?? this.addRuleCard();\n\t\t\tthis.addConstruction(ruleCard, menuItem.id, this.position);\n\t\t\tthis.menu.close();\n\t\t},\n\t\tisIfConditionNotExist(ruleCard: TRuleCard): boolean\n\t\t{\n\t\t\tif (!ruleCard)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn ruleCard.constructions.every((construction) => {\n\t\t\t\treturn construction.type === CONSTRUCTION_TYPES.ACTION;\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"add-construction\"\n\t\t\t@click=\"onShowMenu\"\n\t\t>\n\t\t\t<BIcon\n\t\t\t\tname=\"plus-m\"\n\t\t\t\t:size=\"20\"\n\t\t\t\tcolor=\"#828b95\"\n\t\t\t/>\n\t\t\t<span ref=\"constructionsMenu\">\n\t\t\t\t<slot>\n\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ADD_CONSTRUCTION_LABEL') }}\n\t\t\t\t</slot>\n\t\t\t</span>\n\t\t</div>\n\t`,\n};\n","import './style.css';\n\nimport { BIcon } from 'ui.icon-set.api.vue';\n\nimport { mapActions } from 'ui.vue3.pinia';\n\n// eslint-disable-next-line no-unused-vars\nimport { useNodeSettingsStore, type TRuleCard, type Construction } from '../../../../entities/node-settings';\n\n// @vue/component\nexport const DeleteConstruction = {\n\tname: 'delete-construction',\n\tcomponents: { BIcon },\n\tprops:\n\t{\n\t\ticonColor:\n\t\t{\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\t/** @type TRuleCard */\n\t\truleCard:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\t/** @type Construction */\n\t\tconstruction:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\t...mapActions(useNodeSettingsStore, ['deleteConstruction']),\n\t},\n\ttemplate: `\n\t\t<BIcon\n\t\t\t:color=\"iconColor\"\n\t\t\t:data-test-id=\"$testId('complexNodeRuleSettingsDeleteConstruction', construction.id)\"\n\t\t\tclass=\"delete-construction\"\n\t\t\tname=\"cross-s\"\n\t\t\t@click=\"deleteConstruction(ruleCard, construction)\"\n\t\t/>\n\t`,\n};\n","import './style.css';\n\nimport { mapActions } from 'ui.vue3.pinia';\n\nimport { useLoc } from '../../../../shared/composables';\n\nimport {\n\tuseNodeSettingsStore,\n\tCONSTRUCTION_TYPES,\n\tCONSTRUCTION_LABELS,\n\ttype onstructionLabels,\n\t// eslint-disable-next-line no-unused-vars\n\ttype Construction,\n} from '../../../../entities/node-settings';\n\n// @vue/component\nexport const SelectBooleanType = {\n\tname: 'select-boolean-type',\n\tprops:\n\t{\n\t\t/** @type Construction */\n\t\tconstruction:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): { getMessage: () => string; }\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn { getMessage };\n\t},\n\tdata(): { selectedType: string; }\n\t{\n\t\treturn {\n\t\t\tselectedType: CONSTRUCTION_TYPES.AND_CONDITION,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tbooleanTypes(): Array<$Values<typeof CONSTRUCTION_TYPES>>\n\t\t{\n\t\t\treturn [\n\t\t\t\tCONSTRUCTION_TYPES.AND_CONDITION,\n\t\t\t\tCONSTRUCTION_TYPES.OR_CONDITION,\n\t\t\t];\n\t\t},\n\t\tconstructionLabels(): onstructionLabels\n\t\t{\n\t\t\treturn CONSTRUCTION_LABELS;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\t...mapActions(useNodeSettingsStore, ['selectBooleanType']),\n\t\tonClick(booleanType: string): void\n\t\t{\n\t\t\tthis.selectedType = booleanType;\n\t\t\tthis.selectBooleanType(this.construction, booleanType);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"node-settings-boolean-type-switcher\">\n\t\t\t<span\n\t\t\t\tv-for=\"booleanType in booleanTypes\"\n\t\t\t\tclass=\"node-settings-boolean-type-switcher_tab\"\n\t\t\t\t:class=\"{ '--selected': selectedType === booleanType }\"\n\t\t\t\t@click=\"onClick(booleanType)\"\n\t\t\t>\n\t\t\t\t{{ getMessage(constructionLabels[booleanType]) }}\n\t\t\t</span>\n\t\t</div>\n\t`,\n};\n","import './style.css';\n\nimport { MenuManager, type MenuItem } from 'main.popup';\n\nimport { BIcon } from 'ui.icon-set.api.vue';\n\nimport { mapState, mapActions } from 'ui.vue3.pinia';\n\nimport { useNodeSettingsStore } from '../../../../entities/node-settings';\n\n// eslint-disable-next-line no-unused-vars\nimport type { Block } from '../../../../shared/types';\n\nexport const SelectRule = {\n\tname: 'select-rule',\n\tcomponents: { BIcon },\n\tprops:\n\t{\n\t\t/** @type Block */\n\t\tblock:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\t...mapState(useNodeSettingsStore, ['currentRuleId']),\n\t\tcurrentRuleTitle(): string\n\t\t{\n\t\t\tconst ports = this.block.ports.input;\n\t\t\tconst { title } = ports.find((port) => port.id === this.currentRuleId);\n\n\t\t\treturn title;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\t...mapActions(useNodeSettingsStore, ['setCurrentRuleId']),\n\t\tgetMenuItems(): Array<MenuItem>\n\t\t{\n\t\t\treturn this.block.ports.input.map((port) => {\n\t\t\t\treturn {\n\t\t\t\t\tid: port.id,\n\t\t\t\t\ttext: port.title,\n\t\t\t\t\tdataset: { testId: `menuItemRule-${port.id}` },\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.setCurrentRuleId(port.id);\n\t\t\t\t\t\tthis.menu.close();\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t\tonShowMenu(): void\n\t\t{\n\t\t\tthis.menu = MenuManager.create(\n\t\t\t\t'constructions-menu',\n\t\t\t\tthis.$refs.nodeSettingsRulesDropdown,\n\t\t\t\tthis.getMenuItems(),\n\t\t\t\t{\n\t\t\t\t\twidth: 100,\n\t\t\t\t\tmaxHeight: 200,\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t},\n\t\t\t);\n\t\t\tthis.menu.show();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"node-settings-rules-dropdown\"\n\t\t\tref=\"nodeSettingsRulesDropdown\"\n\t\t\t:data-test-id=\"$testId('complexNodeRuleSettingsDropdown')\"\n\t\t\t@click=\"onShowMenu\"\n\t\t>\n\t\t\t<span class=\"node-settings-rules-dropdown__value\">\n\t\t\t\t{{ currentRuleTitle }}\n\t\t\t</span>\n\t\t\t<BIcon\n\t\t\t\t:size=\"14\"\n\t\t\t\tname=\"chevron-down\"\n\t\t\t\tcolor=\"#525C69\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { useLoc } from '../../../shared/composables';\n\n// @vue/component\nexport const SaveSettingsButton = {\n\tname: 'save-settings-button',\n\tprops:\n\t{\n\t\tisSaving:\n\t\t{\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): { getMessage: () => string; }\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn { getMessage };\n\t},\n\ttemplate: `\n\t\t<button\n\t\t\tclass=\"ui-btn --air ui-btn-lg ui-btn-no-caps\"\n\t\t\t:class=\"{'ui-btn-wait': isSaving }\"\n\t\t>\n\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_SAVE') }}\n\t\t</button>\n\t`,\n};\n","import { useLoc } from '../../../shared/composables';\n\n// @vue/component\nexport const CancelSettingsButton = {\n\tname: 'cancel-settings-button',\n\tsetup(): { getMessage: () => string; }\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn { getMessage };\n\t},\n\ttemplate: `\n\t\t<button class=\"ui-btn ui-btn-lg ui-btn-link ui-btn-no-caps\">\n\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_DISCARD') }}\n\t\t</button>\n\t`,\n};\n","import './style.css';\n\nimport { BIcon } from 'ui.icon-set.api.vue';\n\nimport { mapActions } from 'ui.vue3.pinia';\n\n// eslint-disable-next-line no-unused-vars\nimport { useNodeSettingsStore, type TRuleCard } from '../../../../entities/node-settings';\n\n// @vue/component\nexport const DeleteRuleCard = {\n\tname: 'delete-rule-card',\n\tcomponents: { BIcon },\n\tprops:\n\t{\n\t\t/** @type TRuleCard */\n\t\truleCard:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\t...mapActions(useNodeSettingsStore, ['deleteRuleCard']),\n\t},\n\ttemplate: `\n\t\t<BIcon\n\t\t\tclass=\"delete-rule-card\"\n\t\t\tname=\"cross-m\"\n\t\t\t:size=\"20\"\n\t\t\t:data-test-id=\"$testId('complexNodeRuleSettingsDeleteRuleCard', ruleCard.id)\"\n\t\t\tcolor=\"#a8adb4\"\n\t\t\t@click=\"deleteRuleCard(ruleCard)\"\n\t\t/>\n\t`,\n};\n","import { Type, ajax } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { ValueSelector } from '../../../entities/common-node-settings';\nimport { mapActions, mapState } from 'ui.vue3.pinia';\nimport { diagramStore } from '../../../entities/blocks';\nimport type { Action } from '../../../entities/node-settings';\n\n// eslint-disable-next-line no-unused-vars\nimport type { ActivityData, DiagramTemplate } from '../../../shared/types';\nimport { createUniqueId } from '../../../shared/utils';\nimport { Loader } from '../../../shared/ui';\nimport { usePropertyDialog } from '../../../shared/composables';\n\n// eslint-disable-next-line no-unused-vars\nimport { useNodeSettingsStore, type Construction } from '../../../entities/node-settings';\nimport { EVENT_NAMES } from '../../../entities/node-settings/constants/index';\n\ntype StatusType = $Values<Status>;\nconst Status: Record<string, StatusType> = Object.freeze({\n\tLoading: 'loading',\n\tLoaded: 'loaded',\n\tError: 'error',\n});\n\n// @vue/component\nexport const EditExtandedAction = {\n\tname: 'action-settings-form',\n\tcomponents: { Loader },\n\tprops: {\n\t\t/** @type Construction */\n\t\tconstruction: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tactionId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\t/** @type DiagramTemplate | null */\n\t\ttemplate: {\n\t\t\ttype: [Object, null],\n\t\t\trequired: true,\n\t\t},\n\t\tdocumentType: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\t/** @type ActivityData | null */\n\t\tactivityData: {\n\t\t\ttype: [Object, null],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): { getMessage: () => string; }\n\t{\n\t\tconst store: diagramStore = diagramStore();\n\n\t\treturn { store };\n\t},\n\tdata(): { status: StatusType, settingsForm: { [key: string]: any } | null }\n\t{\n\t\treturn {\n\t\t\tstatus: '',\n\t\t\tsettingsForm: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapState(useNodeSettingsStore, ['block', 'currentRuleId', 'nodeSettings']),\n\t\tStatus: (): Status => Status,\n\t\taction(): Action\n\t\t{\n\t\t\treturn this.nodeSettings.actions.get(this.actionId);\n\t\t},\n\t},\n\twatch: {\n\t\tactionId(newVal: string, oldVal: string): void\n\t\t{\n\t\t\tif (newVal === oldVal)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.init();\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.init();\n\t},\n\tunmounted(): void\n\t{\n\t\tthis.unsubscribe();\n\t},\n\tmethods: {\n\t\t...mapActions(useNodeSettingsStore, ['changeRuleExpression']),\n\t\tasync init(): void\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait this.loadForm();\n\t\t\t\twindow.BPAShowSelector = this.showSelector;\n\t\t\t\twindow.HideShow = this.hideShow;\n\t\t\t\tthis.subscribeOnBeforeSubmit();\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tthis.status = Status.Error;\n\t\t\t\tconsole.error(error);\n\t\t\t}\n\t\t},\n\t\tsubscribeOnBeforeSubmit(): void\n\t\t{\n\t\t\tthis.unsubscribe();\n\n\t\t\tthis.onChangeCallback = () => this.onChange();\n\t\t\tEventEmitter.subscribe(EVENT_NAMES.BEFORE_SUBMIT_EVENT, this.onChangeCallback);\n\t\t},\n\t\tunsubscribe(): void\n\t\t{\n\t\t\tif (this.onChangeCallback)\n\t\t\t{\n\t\t\t\tEventEmitter.unsubscribe(EVENT_NAMES.BEFORE_SUBMIT_EVENT, this.onChangeCallback);\n\t\t\t}\n\t\t},\n\t\tasync showSelector(id: string): Promise<void>\n\t\t{\n\t\t\tconst selector = new ValueSelector(\n\t\t\t\tthis.store,\n\t\t\t\tthis.block,\n\t\t\t\tthis.currentRuleId,\n\t\t\t);\n\t\t\tconst targetElement = document.getElementById(id);\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst value = await selector.show(targetElement);\n\t\t\t\tconst beforePart = targetElement.value.slice(0, targetElement.selectionEnd);\n\t\t\t\tconst middlePart = value;\n\t\t\t\tconst afterPart = targetElement.value.slice(targetElement.selectionEnd);\n\t\t\t\ttargetElement.value = beforePart + middlePart + afterPart;\n\t\t\t\ttargetElement.selectionEnd = beforePart.length + middlePart.length + 1;\n\t\t\t\ttargetElement.focus();\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tconsole.error(error);\n\t\t\t}\n\t\t},\n\t\tgetFormData(): { [key: string]: any }\n\t\t{\n\t\t\treturn this.extractFormData(this.settingsForm);\n\t\t},\n\t\tonChange(): void\n\t\t{\n\t\t\tthis.changeRuleExpression(this.construction, {\n\t\t\t\trawActivityData: this.getFormData(),\n\t\t\t});\n\t\t},\n\t\textractFormData(form: HTMLElement): { [key: string]: any }\n\t\t{\n\t\t\tconst formData = ajax.prepareForm(form).data;\n\n\t\t\tformData.documentType = this.documentType;\n\t\t\tformData.activityType = this.actionId;\n\n\t\t\tformData.id = Type.isStringFilled(formData.activity_id) ? formData.activity_id : createUniqueId();\n\n\t\t\treturn formData;\n\t\t},\n\t\tasync loadForm(): Promise<void> {\n\t\t\tthis.$refs.contentContainer.innerHTML = '';\n\n\t\t\tthis.status = Status.Loading;\n\n\t\t\tlet activity: ActivityData = this.activityData;\n\t\t\tif (!activity)\n\t\t\t{\n\t\t\t\tactivity = {\n\t\t\t\t\tName: createUniqueId(),\n\t\t\t\t\tType: this.actionId,\n\t\t\t\t\tActivated: 'Y',\n\t\t\t\t\tProperties: {\n\t\t\t\t\t\tTitle: this.action.title,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst compatibleTemplate = [{ Type: 'NodeWorkflowActivity', Children: [], Name: 'Template' }];\n\t\t\tcompatibleTemplate[0].Children.push(\n\t\t\t\tactivity,\n\t\t\t\t...this.store.getAllBlockAncestors(this.block, this.currentRuleId).map((b) => b.activity),\n\t\t\t);\n\n\t\t\tif (window.CreateActivity)\n\t\t\t{\n\t\t\t\twindow.arAllId = {};\n\t\t\t\twindow.arWorkflowTemplate = compatibleTemplate;\n\t\t\t\twindow.rootActivity = window.CreateActivity(compatibleTemplate[0]);\n\t\t\t}\n\n\t\t\tconst { createFormData } = usePropertyDialog();\n\t\t\tconst formData = createFormData({\n\t\t\t\tid: activity.Name,\n\t\t\t\tdocumentType: this.documentType,\n\t\t\t\tactivity: this.actionId,\n\t\t\t\tworkflow: {\n\t\t\t\t\tparameters: this.template?.PARAMETERS ?? [],\n\t\t\t\t\tvariables: this.template?.VARIABLES ?? [],\n\t\t\t\t\ttemplate: compatibleTemplate,\n\t\t\t\t\tconstants: this.template?.CONSTANTS ?? [],\n\t\t\t\t},\n\t\t\t});\n\t\t\tawait this.renderPropertyDialog(formData);\n\n\t\t\tthis.status = Status.Loaded;\n\t\t},\n\n\t\tasync renderPropertyDialog(formData: FormData): Promise<void>\n\t\t{\n\t\t\tconst { renderPropertyDialog } = usePropertyDialog();\n\t\t\tconst form = await renderPropertyDialog(this.$refs.contentContainer, formData);\n\t\t\tif (!form)\n\t\t\t{\n\t\t\t\tthis.hasSettings = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.settingsForm = form;\n\t\t\tthis.hasSettings = true;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Loader v-if=\"status === Status.Loading\" />\n\t\t<div\n\t\t\tref=\"contentContainer\"\n\t\t></div>\n\t`,\n};\n","import { mapState, mapWritableState, mapActions } from 'ui.vue3.pinia';\n\nimport { useLoc } from '../../../shared/composables';\nimport { PORT_TYPES } from '../../../shared/constants';\n\nimport { diagramStore as useDiagramStore } from '../../../entities/blocks';\nimport {\n\tNodeSettingsLayout,\n\tuseNodeSettingsStore,\n\tNodeSettingsVariable,\n\tNodeSettingsRule,\n} from '../../../entities/node-settings';\nimport { useAppStore } from '../../../entities/app';\nimport {\n\tEditNodeSettingsForm,\n\tAddSettingsItem,\n\tCancelSettingsButton,\n\tSaveSettingsButton,\n} from '../../../features/node-settings';\nimport type { Block } from '../../../shared/types';\n\n// @vue/component\nexport const NodeSettings = {\n\tname: 'NodeSettings',\n\tcomponents: {\n\t\tNodeSettingsLayout,\n\t\tEditNodeSettingsForm,\n\t\tCancelSettingsButton,\n\t\tSaveSettingsButton,\n\t\tNodeSettingsVariable,\n\t\tNodeSettingsRule,\n\t\tAddSettingsItem,\n\t},\n\tsetup(): { getMessage: () => string; }\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn {\n\t\t\tgetMessage,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\t...mapState(useDiagramStore, ['documentType']),\n\t\t...mapState(useNodeSettingsStore, [\n\t\t\t'block',\n\t\t\t'isShown',\n\t\t\t'isRuleSettingsShown',\n\t\t\t'nodeSettings',\n\t\t\t'isLoading',\n\t\t\t'isSaving',\n\t\t\t'savedBlockInputPorts',\n\t\t]),\n\t\t...mapWritableState(useNodeSettingsStore, ['isSaving']),\n\t},\n\tmethods:\n\t{\n\t\t...mapActions(useNodeSettingsStore, [\n\t\t\t'toggleVisibility',\n\t\t\t'toggleRuleSettingsVisibility',\n\t\t\t'reset',\n\t\t\t'setCurrentRuleId',\n\t\t\t'deleteRuleSettings',\n\t\t\t'saveForm',\n\t\t\t'discardFormSettings',\n\t\t\t'updateSettings',\n\t\t]),\n\t\t...mapActions(useDiagramStore, [\n\t\t\t'updateNodeTitle',\n\t\t\t'addRulePort',\n\t\t\t'addConnectionPort',\n\t\t\t'deletePort',\n\t\t\t'publicDraft',\n\t\t\t'updateBlockActivityField',\n\t\t\t'setInputPorts',\n\t\t\t'getBlockAncestorsByInputPortId',\n\t\t]),\n\t\t...mapActions(useAppStore, [\n\t\t\t'hideRightPanel',\n\t\t]),\n\t\tonShowRuleConstructions(ruleId: string): void\n\t\t{\n\t\t\tthis.toggleRuleSettingsVisibility(true);\n\t\t\tthis.setCurrentRuleId(ruleId);\n\t\t},\n\t\tonAddRule(ruleId: string): void\n\t\t{\n\t\t\tthis.addRulePort(this.block.id, ruleId, PORT_TYPES.input);\n\t\t},\n\t\tonDeleteRule(ruleId: string): void\n\t\t{\n\t\t\tthis.deletePort(this.block.id, ruleId);\n\t\t\tconst { outputPortsToAdd, outputPortsToDelete } = this.deleteRuleSettings(ruleId);\n\t\t\toutputPortsToAdd.values().forEach(({ portId, title }) => {\n\t\t\t\tthis.addRulePort(this.block, portId, PORT_TYPES.output, title);\n\t\t\t});\n\t\t\toutputPortsToDelete.keys().forEach((portId) => {\n\t\t\t\tthis.deletePort(this.block.id, portId, PORT_TYPES.output);\n\t\t\t});\n\t\t},\n\t\tonAddConnection(connectionId: string): void\n\t\t{\n\t\t\tthis.addConnectionPort(this.block.id, connectionId, PORT_TYPES.input);\n\t\t},\n\t\tasync onSaveForm(): Promise<void>\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tthis.isSaving = true;\n\t\t\t\tconst activityData = await this.saveForm(this.documentType);\n\t\t\t\tthis.updateBlockActivityField(this.block.id, activityData);\n\t\t\t\tawait this.publicDraft();\n\t\t\t\tthis.hideSettings();\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tthis.isSaving = false;\n\t\t\t}\n\t\t},\n\t\thideSettings(): void\n\t\t{\n\t\t\tthis.hideRightPanel();\n\t\t\tthis.toggleVisibility(false);\n\t\t\tthis.reset();\n\t\t},\n\t\tonClose(): void\n\t\t{\n\t\t\tthis.discardFormSettings();\n\t\t\tconst { title } = this.nodeSettings;\n\t\t\tthis.updateNodeTitle(this.block, title);\n\t\t\tthis.setInputPorts(this.block, this.savedBlockInputPorts);\n\t\t\tthis.hideSettings();\n\t\t},\n\t\tonUpdateTitle(block: Block, title: string): void\n\t\t{\n\t\t\tthis.updateNodeTitle(block, title);\n\t\t\tthis.updateSettings({ title });\n\t\t},\n\t\tonUpdateDescription(description: string): void\n\t\t{\n\t\t\tthis.updateSettings({ description });\n\t\t},\n\t},\n\ttemplate: `\n\t\t<NodeSettingsLayout\n\t\t\t:isLoading=\"isLoading\"\n\t\t\t:isSaving=\"isSaving\"\n\t\t\t:isShown=\"isShown\"\n\t\t\t@close=\"onClose\"\n\t\t>\n\t\t\t<template #default>\n\t\t\t\t<EditNodeSettingsForm\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t@updateTitle=\"onUpdateTitle(block, $event)\"\n\t\t\t\t\t@updateDescription=\"onUpdateDescription($event)\"\n\t\t\t\t>\n\t\t\t\t\t<!--\n\t\t\t\t\t<template #variable=\"{ variableName, variableValue }\">\n\t\t\t\t\t\t<NodeSettingsVariable\n\t\t\t\t\t\t\t:variableName=\"variableName\"\n\t\t\t\t\t\t\t:variableValue=\"variableValue\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template #addElement=\"{ itemType }\">\n\t\t\t\t\t\t<AddSettingsItem :itemType=\"itemType\">\n\t\t\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ITEM_ELEMENT') }}\n\t\t\t\t\t\t</AddSettingsItem>\n\t\t\t\t\t</template>\n\t\t\t\t\t-->\n\n\t\t\t\t\t<template #rule=\"{ port }\">\n\t\t\t\t\t\t<NodeSettingsRule\n\t\t\t\t\t\t\t:port=\"port\"\n\t\t\t\t\t\t\t:nodeSettings=\"nodeSettings\"\n\t\t\t\t\t\t\t:connectedBlocks=\"getBlockAncestorsByInputPortId(block, port.id)\"\n\t\t\t\t\t\t\t@showRuleConstructions=\"onShowRuleConstructions\"\n\t\t\t\t\t\t\t@deleteRule=\"onDeleteRule\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template #addRule=\"{ itemType }\">\n\t\t\t\t\t\t<AddSettingsItem\n\t\t\t\t\t\t\t:itemType=\"itemType\"\n\t\t\t\t\t\t\t@addItem=\"onAddRule\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ITEM_RULE') }}\n\t\t\t\t\t\t</AddSettingsItem>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template #addConnection=\"{ itemType }\">\n\t\t\t\t\t\t<AddSettingsItem\n\t\t\t\t\t\t\t:itemType=\"itemType\"\n\t\t\t\t\t\t\t@addItem=\"onAddConnection\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ITEM_CONNECTION') }}\n\t\t\t\t\t\t</AddSettingsItem>\n\t\t\t\t\t</template>\n\t\t\t\t</EditNodeSettingsForm>\n\t\t\t</template>\n\n\t\t\t<template #actions>\n\t\t\t\t<SaveSettingsButton\n\t\t\t\t\t:isSaving=\"isSaving\"\n\t\t\t\t\t:data-test-id=\"$testId('complexNodeSettingsSave')\"\n\t\t\t\t\t@click=\"onSaveForm\"\n\t\t\t\t/>\n\t\t\t\t<CancelSettingsButton\n\t\t\t\t\t:data-test-id=\"$testId('complexNodeSettingsDiscard')\"\n\t\t\t\t\t@click=\"onClose\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</NodeSettingsLayout>\n\t\t<slot v-if=\"isShown\" />\n\t`,\n};\n","import './style.css';\n\nimport { mapActions, mapState } from 'ui.vue3.pinia';\nimport { Popup } from 'ui.vue3.components.popup';\nimport { BIcon } from 'ui.icon-set.api.vue';\n\nimport { useNodeSettingsStore } from '../../../../entities/node-settings';\nimport { useLoc } from '../../../../shared/composables';\n\nimport type { Port } from '../../../../shared/types';\n\n// @vue/component\nexport const EditOutputExpression = {\n\tname: 'edit-output-expression',\n\tcomponents: { BIcon, Popup },\n\tprops:\n\t{\n\t\t/** @type OutputConstruction */\n\t\tconstruction:\n\t\t{\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tscrolling:\n\t\t{\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): { getMessage: () => string; }\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn { getMessage };\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t\tchangedOutputPorts: [],\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\t...mapState(useNodeSettingsStore, ['nodeSettings', 'block']),\n\t\tsavedOutputPorts(): Array\n\t\t{\n\t\t\treturn this.block?.ports.output.map((port) => ({\n\t\t\t\tportId: port.id,\n\t\t\t\ttitle: port.title,\n\t\t\t})) ?? [];\n\t\t},\n\t\tselectedPort:\n\t\t{\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\tconst { portId, title } = this.construction.expression;\n\n\t\t\t\treturn {\n\t\t\t\t\ttitle,\n\t\t\t\t\tportId,\n\t\t\t\t};\n\t\t\t},\n\t\t\tset(output: { portId: string, title: string }): void\n\t\t\t{\n\t\t\t\tconst { portId, title } = output;\n\t\t\t\tthis.changeRuleExpression(this.construction, {\n\t\t\t\t\tportId,\n\t\t\t\t\ttitle,\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\t\tnotSelectedMessage(): string\n\t\t{\n\t\t\treturn this.getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_EXPRESSION_ITEM_NOT_SELECTED');\n\t\t},\n\t\tpopupOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: 'edit-output-expression-popup',\n\t\t\t\tbindElement: this.$refs.nodeSettingsRuleOutputDropdown,\n\t\t\t\tminHeight: 100,\n\t\t\t\tmaxHeight: 200,\n\t\t\t\tpadding: 0,\n\t\t\t\twidth: 200,\n\t\t\t};\n\t\t},\n\t},\n\twatch:\n\t{\n\t\tscrolling(scrolling: boolean)\n\t\t{\n\t\t\tif (scrolling && this.isPopupShown)\n\t\t\t{\n\t\t\t\tthis.isPopupShown = false;\n\t\t\t}\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.changedOutputPorts = [...this.savedOutputPorts];\n\t\tif (this.changedOutputPorts.length === 0)\n\t\t{\n\t\t\tthis.addNewPort();\n\t\t}\n\t},\n\tmethods: {\n\t\t...mapActions(useNodeSettingsStore, ['changeRuleExpression']),\n\t\tselectPort(port: Port): void\n\t\t{\n\t\t\tthis.selectedPort = port;\n\t\t\tthis.isPopupShown = false;\n\t\t},\n\t\taddNewPort(): void\n\t\t{\n\t\t\tconst lastPort = this.changedOutputPorts[this.changedOutputPorts.length - 1] ?? null;\n\t\t\tconst lastPortIdNumber = lastPort ? parseInt(lastPort.portId.replace('o', ''), 10) : 0;\n\t\t\tthis.changedOutputPorts.push({\n\t\t\t\tportId: `o${lastPortIdNumber + 1}`,\n\t\t\t\ttitle: `E${lastPortIdNumber + 1}`,\n\t\t\t});\n\t\t},\n\t\tdeletePort(portId: string): void\n\t\t{\n\t\t\tthis.changedOutputPorts = this.changedOutputPorts.filter((port) => {\n\t\t\t\treturn port.portId !== portId;\n\t\t\t});\n\t\t\tif (portId === this.selectedPort.portId)\n\t\t\t{\n\t\t\t\tthis.selectedPort = {\n\t\t\t\t\tportId: null,\n\t\t\t\t\ttitle: null,\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t\tasync tryToScrollBottom(): void\n\t\t{\n\t\t\tawait this.$nextTick();\n\t\t\tconst dropDownContent = this.$refs.nodeSettingsRuleOutputDropdownContent;\n\t\t\tconst { scrollHeight, clientHeight } = dropDownContent;\n\t\t\tif (scrollHeight > clientHeight)\n\t\t\t{\n\t\t\t\tdropDownContent.scrollTop = scrollHeight - clientHeight;\n\t\t\t}\n\t\t},\n\t\tonAddButtonClick(): void\n\t\t{\n\t\t\tthis.addNewPort();\n\t\t\tthis.tryToScrollBottom();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"edit-output-expression-form\">\n\t\t\t<div class=\"edit-output-expression-form__item\">\n\t\t\t\t<span class=\"edit-output-expression-form__label\">\n\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ACTION_EXPRESSION_NAME') }}\n\t\t\t\t</span>\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox\">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\treadonly\n\t\t\t\t\t\t:value=\"getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ACTION_OUTPUT_TITLE')\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"edit-output-expression-form__item\">\n\t\t\t\t<span class=\"edit-output-expression-form__label\">\n\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_EXPRESSION_VALUE') }}\n\t\t\t\t</span>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown edit-output-expression-form__dropdown\"\n\t\t\t\t\tref=\"nodeSettingsRuleOutputDropdown\"\n\t\t\t\t\t@click=\"isPopupShown = true\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\tref=\"nodeSettingsRuleOutputDropdownValue\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ selectedPort.title ?? notSelectedMessage }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<Popup\n\t\t\t\t\t\tv-if=\"isPopupShown\"\n\t\t\t\t\t\t:options=\"popupOptions\"\n\t\t\t\t\t\t@close=\"isPopupShown = false\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"edit-output-expression-form__dropdown_popup\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"edit-output-expression-form__dropdown_popup-content\"\n\t\t\t\t\t\t\t\tref=\"nodeSettingsRuleOutputDropdownContent\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-for=\"outputPort in changedOutputPorts\"\n\t\t\t\t\t\t\t\t\tclass=\"edit-output-expression-form__dropdown_popup-item\"\n\t\t\t\t\t\t\t\t\t@click=\"selectPort(outputPort)\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<span>{{ outputPort.title }}</span>\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclass=\"ui-btn ui-btn-xss --style-outline-no-accent ui-btn-no-caps --air\"\n\t\t\t\t\t\t\t\t\t\t@click.stop=\"deletePort(outputPort.portId)\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ACTION_OUTPUT_REMOVE') }}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"edit-output-expression-form__dropdown_popup-footer\">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass=\"edit-output-expression-form__dropdown_popup-footer-content\"\n\t\t\t\t\t\t\t\t\t@click=\"onAddButtonClick\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t\t\t\t:size=\"24\"\n\t\t\t\t\t\t\t\t\t\tname=\"circle-plus\"\n\t\t\t\t\t\t\t\t\t\tcolor=\"#0075ff\"\n\t\t\t\t\t\t\t\t\t\tclass=\"edit-output-expression-form__dropdown_popup-footer-icon\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<span>{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ACTION_OUTPUT_ADD') }}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Popup>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\nimport { mapState, mapWritableState, mapActions } from 'ui.vue3.pinia';\nimport { Type, Text } from 'main.core';\nimport { MessageBox } from 'ui.dialogs.messagebox';\n\nimport { useLoc } from '../../../shared/composables';\nimport { PORT_TYPES } from '../../../shared/constants';\n\nimport { EditOutputExpression } from '../../../features/node-settings/ui/edit-output-expression/edit-output-expression';\n\nimport { diagramStore as useDiagramStore } from '../../../entities/blocks';\nimport {\n\tuseNodeSettingsStore,\n\tNodeSettingsRulesLayout,\n\tRuleCard,\n\tRuleConstruction, EVENT_NAMES,\n} from '../../../entities/node-settings';\nimport {\n\tEditActionExpression,\n\tEditConditionExpression,\n\tAddConstruction,\n\tDeleteConstruction,\n\tCancelSettingsButton,\n\tSaveSettingsButton,\n\tSelectBooleanType,\n\tSelectRule,\n\tDeleteRuleCard,\n\tEditExtandedAction,\n} from '../../../features/node-settings';\n\n// eslint-disable-next-line no-unused-vars\nimport type { Block } from '../../../shared/types';\n\n// @vue/component\nexport const NodeSettingsRules = {\n\tname: 'node-settings-rules',\n\tcomponents: {\n\t\tCancelSettingsButton,\n\t\tSaveSettingsButton,\n\t\tNodeSettingsRulesLayout,\n\t\tRuleCard,\n\t\tEditActionExpression,\n\t\tEditOutputExpression,\n\t\tEditConditionExpression,\n\t\tAddConstruction,\n\t\tDeleteConstruction,\n\t\tRuleConstruction,\n\t\tSelectBooleanType,\n\t\tSelectRule,\n\t\tDeleteRuleCard,\n\t\tEditExtandedAction,\n\t},\n\tsetup(): { getMessage: () => string; }\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn {\n\t\t\tgetMessage,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tscrolling: false,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\t...mapState(useNodeSettingsStore, ['nodeSettings', 'currentRuleId', 'block', 'isRuleSettingsShown']),\n\t\t...mapWritableState(useNodeSettingsStore, ['isSaving']),\n\t\t...mapState(useDiagramStore, ['documentTypeSigned', 'documentType', 'template']),\n\t\tdocumentTypeForActionSettings(): Array\n\t\t{\n\t\t\tif (Type.isArrayFilled(this.nodeSettings.fixedDocumentType))\n\t\t\t{\n\t\t\t\treturn this.nodeSettings.fixedDocumentType;\n\t\t\t}\n\n\t\t\treturn this.documentType;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\t...mapActions(useNodeSettingsStore, [\n\t\t\t'toggleRuleSettingsVisibility',\n\t\t\t'reorder',\n\t\t\t'saveRule',\n\t\t\t'discardRuleSettings',\n\t\t]),\n\t\t...mapActions(useDiagramStore, ['addRulePort', 'deletePort']),\n\t\tonRulesLayoutClose(): void\n\t\t{\n\t\t\tthis.discardRuleSettings();\n\t\t\tthis.toggleRuleSettingsVisibility(false);\n\t\t},\n\t\tasync onSaveRule(): Promise<void>\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tthis.isSaving = true;\n\n\t\t\t\tawait EventEmitter.emitAsync(EVENT_NAMES.BEFORE_SUBMIT_EVENT);\n\t\t\t\tconst { outputPortsToAdd, outputPortsToDelete } = await this.saveRule(this.documentType);\n\t\t\t\toutputPortsToAdd.values().forEach(({ portId, title }) => {\n\t\t\t\t\tthis.addRulePort(this.block.id, portId, PORT_TYPES.output, title);\n\t\t\t\t});\n\t\t\t\toutputPortsToDelete.keys().forEach((portId) => {\n\t\t\t\t\tthis.deletePort(this.block.id, portId, PORT_TYPES.output);\n\t\t\t\t});\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tif (error.errors && error.errors[0] && error.errors[0].message)\n\t\t\t\t{\n\t\t\t\t\tMessageBox.alert(Text.encode(error.errors[0].message));\n\t\t\t\t}\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tthis.isSaving = false;\n\t\t\t}\n\t\t},\n\t\tonScroll(): void\n\t\t{\n\t\t\tthis.scrolling = true;\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.scrolling = false;\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<NodeSettingsRulesLayout\n\t\t\t:isRuleSettingsShown=\"isRuleSettingsShown\"\n\t\t\t:nodeSettings=\"nodeSettings\"\n\t\t\t:currentRuleId=\"currentRuleId\"\n\t\t\t:isSaving=\"isSaving\"\n\t\t\t@close=\"onRulesLayoutClose\"\n\t\t\t@drop=\"reorder\"\n\t\t\t@scroll-layout=\"onScroll\"\n\t\t>\n\t\t\t<template #rules-dropdown>\n\t\t\t\t<SelectRule :block=\"block\" />\n\t\t\t</template>\n\n\t\t\t<template #ruleCard=\"{ ruleCard }\">\n\t\t\t\t<RuleCard :ruleCard=\"ruleCard\">\n\t\t\t\t\t<template #deleteRuleCard>\n\t\t\t\t\t\t<DeleteRuleCard :ruleCard=\"ruleCard\" />\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #default=\"{ construction, position }\">\n\t\t\t\t\t\t<RuleConstruction\n\t\t\t\t\t\t\t:ruleCardId=\"ruleCard.id\"\n\t\t\t\t\t\t\t:construction=\"construction\"\n\t\t\t\t\t\t\t:position=\"position\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<template #addConstructionButton>\n\t\t\t\t\t\t\t\t<AddConstruction\n\t\t\t\t\t\t\t\t\t:position=\"position\"\n\t\t\t\t\t\t\t\t\t:ruleCard=\"ruleCard\"\n\t\t\t\t\t\t\t\t\t:data-test-id=\"$testId('complexNodeRuleSettingsAddConstruction')\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t\t<template #deleteConstructionButton=\"{ iconColor }\">\n\t\t\t\t\t\t\t\t<DeleteConstruction\n\t\t\t\t\t\t\t\t\t:iconColor=\"iconColor\"\n\t\t\t\t\t\t\t\t\t:ruleCard=\"ruleCard\"\n\t\t\t\t\t\t\t\t\t:construction=\"construction\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t\t<template #action=\"{ isExpertMode }\">\n\t\t\t\t\t\t\t\t<EditActionExpression\n\t\t\t\t\t\t\t\t\t:construction=\"construction\"\n\t\t\t\t\t\t\t\t\t:isExpertMode=\"isExpertMode\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<template #default=\"{ actionId, activityData }\">\n\t\t\t\t\t\t\t\t\t\t<EditExtandedAction\n\t\t\t\t\t\t\t\t\t\t\tv-if=\"actionId\"\n\t\t\t\t\t\t\t\t\t\t\t:actionId=\"actionId\"\n\t\t\t\t\t\t\t\t\t\t\t:activityData=\"activityData\"\n\t\t\t\t\t\t\t\t\t\t\t:construction=\"construction\"\n\t\t\t\t\t\t\t\t\t\t\t:documentType=\"documentTypeForActionSettings\"\n\t\t\t\t\t\t\t\t\t\t\t:template=\"template\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</EditActionExpression>\n\t\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t\t<template #booleanTypeSwitcher>\n\t\t\t\t\t\t\t\t<SelectBooleanType :construction=\"construction\" />\n\t\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t\t<template #condition>\n\t\t\t\t\t\t\t\t<EditConditionExpression :construction=\"construction\" />\n\t\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t\t<template #output>\n\t\t\t\t\t\t\t\t<EditOutputExpression\n\t\t\t\t\t\t\t\t\t:construction=\"construction\"\n\t\t\t\t\t\t\t\t\t:scrolling=\"scrolling\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</RuleConstruction>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #addConstructionButton>\n\t\t\t\t\t\t<AddConstruction\n\t\t\t\t\t\t\t:ruleCard=\"ruleCard\"\n\t\t\t\t\t\t\t:data-test-id=\"$testId('complexNodeRuleSettingsAddConstruction')\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</RuleCard>\n\t\t\t</template>\n\n\t\t\t<template #addRuleCardButton>\n\t\t\t\t<AddConstruction\n\t\t\t\t\tclass=\"add-rule-card\"\n\t\t\t\t\t:data-test-id=\"$testId('complexNodeRuleSettingsAddRuleCard')\"\n\t\t\t\t>\n\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_NODE_SETTINGS_ADD_RULE_CARD_LABEL') }}\n\t\t\t\t</AddConstruction>\n\t\t\t</template>\n\n\t\t\t<template #actions>\n\t\t\t\t<SaveSettingsButton\n\t\t\t\t\t:isSaving=\"isSaving\"\n\t\t\t\t\t:data-test-id=\"$testId('complexNodeRuleSettingsSave')\"\n\t\t\t\t\t@click=\"onSaveRule\"\n\t\t\t\t/>\n\t\t\t\t<CancelSettingsButton\n\t\t\t\t\t:data-test-id=\"$testId('complexNodeRuleSettingsDiscard')\"\n\t\t\t\t\t@click=\"onRulesLayoutClose\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</NodeSettingsRulesLayout>\n\t`,\n};\n","import { defineStore } from 'ui.vue3.pinia';\nimport { editorAPI } from '../../../shared/api';\nimport type {\n\tCatalogMenuGroup,\n\tCatalogMenuItem,\n\tCatalogMenuItemId,\n} from '../types';\n\ntype CatalogState = {\n\tgroups: Array<CatalogMenuGroup>,\n\tsearchText: string,\n\tcurrentGroup: CatalogMenuGroup | null,\n\tcurrentItem: CatalogMenuItem | null,\n\thighlightedItems: Set<CatalogMenuItemId>,\n\tisShowFoundedGroupItems: boolean,\n\tisShowSearch: boolean,\n\tisExpandedCatalog: boolean,\n\tisFixedCatalog: boolean,\n};\n\nexport type SearchResults = {\n\tgroups: Array<CatalogMenuGroup>,\n\titems: Array<CatalogMenuItem>,\n}\n\nexport const useCatalogStore = defineStore('bizprocdesigner-editor-catalog', {\n\tstate: (): CatalogState => ({\n\t\tgroups: [],\n\t\tsearchText: '',\n\t\tcurrentGroup: null,\n\t\tcurrentItem: null,\n\t\thighlightedItems: new Set(),\n\t\tisShowFoundedGroupItems: false,\n\t\tisShowSearch: false,\n\t\tisExpandedCatalog: true,\n\t\tisFixedCatalog: true,\n\t}),\n\tgetters: {\n\t\tcanSearch: (state: CatalogState): boolean => {\n\t\t\treturn state.searchText.length > 2;\n\t\t},\n\t\tisShowSearchResults: (state: CatalogState): boolean => {\n\t\t\treturn state.canSearch && !state.isShowFoundedGroupItems;\n\t\t},\n\t\tsearchResults: (state: CatalogState): SearchResults => {\n\t\t\tconst preSearchText = state.searchText.toLowerCase();\n\n\t\t\tconst foundedGroups = state.groups\n\t\t\t\t.filter((group) => {\n\t\t\t\t\treturn group.title\n\t\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t\t.includes(preSearchText);\n\t\t\t\t});\n\n\t\t\tconst foundedItems = [...new Map(\n\t\t\t\tstate.groups.flatMap((group) => group.items\n\t\t\t\t\t.filter((item) => item.title.toLowerCase().includes(preSearchText))\n\t\t\t\t\t.map((item) => [item.id, { ...item, parentGroup: group }])),\n\t\t\t).values()];\n\n\t\t\treturn {\n\t\t\t\tgroups: foundedGroups,\n\t\t\t\titems: foundedItems,\n\t\t\t};\n\t\t},\n\t\tsearchResultsCount: (state: CatalogState): number => {\n\t\t\tconst { groups, items } = state.searchResults;\n\n\t\t\treturn groups.length + items.length;\n\t\t},\n\t},\n\tactions: {\n\t\tasync init(): Promise<void>\n\t\t{\n\t\t\tawait this.fetchCatalogData();\n\t\t},\n\t\tasync fetchCatalogData(): Promise<void>\n\t\t{\n\t\t\tconst { groups = [] } = await editorAPI.getCatalogData();\n\n\t\t\tgroups.forEach((group, groupIdx) => {\n\t\t\t\tgroup.items.forEach((item, itemIdx) => {\n\t\t\t\t\titem.defaultSettings.ports = Object.entries(item.defaultSettings.ports)\n\t\t\t\t\t\t.reduce((portsMap, [type, ports]) => {\n\t\t\t\t\t\t\tportsMap[type] = ports?.map((port) => ({ ...port, type })) ?? [];\n\n\t\t\t\t\t\t\treturn portsMap;\n\t\t\t\t\t\t}, {});\n\n\t\t\t\t\tif (item.type === 'simple' || item.type === 'trigger')\n\t\t\t\t\t{\n\t\t\t\t\t\tgroups[groupIdx].items[itemIdx].defaultSettings.width = 200;\n\t\t\t\t\t\tgroups[groupIdx].items[itemIdx].defaultSettings.height = 48;\n\t\t\t\t\t}\n\t\t\t\t\telse if (item.type === 'complex')\n\t\t\t\t\t{\n\t\t\t\t\t\tgroups[groupIdx].items[itemIdx].defaultSettings.width = 200;\n\t\t\t\t\t\tgroups[groupIdx].items[itemIdx].defaultSettings.height = 176;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.groups = groups;\n\t\t},\n\t\ttoggleFixedCatalog(): void\n\t\t{\n\t\t\tthis.isFixedCatalog = !this.isFixedCatalog;\n\t\t},\n\t\texpandCatalog(): void\n\t\t{\n\t\t\tif (!this.isFixedCatalog)\n\t\t\t{\n\t\t\t\tthis.isExpandedCatalog = true;\n\t\t\t}\n\t\t},\n\t\tcollapseCatalog(): void\n\t\t{\n\t\t\tif (!this.isFixedCatalog)\n\t\t\t{\n\t\t\t\tthis.isExpandedCatalog = false;\n\t\t\t}\n\t\t},\n\t\tclearSearchText(): void\n\t\t{\n\t\t\tthis.searchText = '';\n\t\t},\n\t\tchangeCurrentGroup(group): void\n\t\t{\n\t\t\tthis.currentGroup = group;\n\t\t},\n\t\tresetCurrentGroup(): void\n\t\t{\n\t\t\tthis.currentGroup = null;\n\t\t},\n\t\tchangeCurrentItem(item): void\n\t\t{\n\t\t\tthis.currentItem = item;\n\t\t},\n\t\tresetCurrentItem(): void\n\t\t{\n\t\t\tthis.currentItem = null;\n\t\t},\n\t\tsetHighlightedItem(ids: Array<CatalogMenuItemId> | CatalogMenuItemId): void\n\t\t{\n\t\t\tthis.highlightedItems = new Set(\n\t\t\t\tArray.isArray(ids) ? ids : [ids],\n\t\t\t);\n\t\t},\n\t\tresetHighlightedItem(): void\n\t\t{\n\t\t\tthis.highlightedItems = new Set();\n\t\t},\n\t\tshowFoundedGroupItems(): void\n\t\t{\n\t\t\tthis.isShowFoundedGroupItems = true;\n\t\t},\n\t\thideFoundedGroupItems(): void\n\t\t{\n\t\t\tthis.isShowFoundedGroupItems = false;\n\t\t},\n\t\taddDevGroup(): void\n\t\t{\n\t\t\tthis.groups.push({\n\t\t\t\tid: 'dev',\n\t\t\t\ticon: '',\n\t\t\t\ttitle: ' ',\n\t\t\t\titems: [\n\t\t\t\t\tthis.getFrameNode(),\n\t\t\t\t],\n\t\t\t});\n\t\t},\n\t\tgetFrameNode(): {...}\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: 'frame',\n\t\t\t\ttype: 'frame',\n\t\t\t\ttitle: '',\n\t\t\t\tsubtitle: ' ',\n\t\t\t\ticonPath: 'BOTTLENECK',\n\t\t\t\tcolorIndex: 1,\n\t\t\t\tdefaultSettings: {\n\t\t\t\t\twidth: 200,\n\t\t\t\t\theight: 200,\n\t\t\t\t\tports: {\n\t\t\t\t\t\tinput: [],\n\t\t\t\t\t\toutput: [],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n});\n","import { BLOCK_TYPES } from '../../../shared/constants';\n\nexport const DRAG_ITEM_SLOT_NAMES: { [string]: string } = {\n\tdefault: 'drag-item',\n\t[BLOCK_TYPES.SIMPLE]: `drag-item:${BLOCK_TYPES.SIMPLE}`,\n\t[BLOCK_TYPES.TRIGGER]: `drag-item:${BLOCK_TYPES.TRIGGER}`,\n\t[BLOCK_TYPES.COMPLEX]: `drag-item:${BLOCK_TYPES.COMPLEX}`,\n\t[BLOCK_TYPES.FRAME]: `drag-item:${BLOCK_TYPES.FRAME}`,\n\t[BLOCK_TYPES.TOOL]: `drag-item:${BLOCK_TYPES.TOOL}`,\n};\n","import { DRAG_ITEM_SLOT_NAMES } from '../constants';\n\nexport type GetDragItemSlotName = (itemType: string) => string;\n\nexport function getDragItemSlotName(itemType: string): string\n{\n\treturn DRAG_ITEM_SLOT_NAMES?.[itemType] ?? DRAG_ITEM_SLOT_NAMES.default;\n}\n","import './catalog-layout.css';\n\nconst CATALOG_CLASS_NAMES = {\n\tbase: 'editor-chart-catalog',\n\texpanded: '--expanded',\n};\n\n// @vue/component\nexport const CatalogLayout = {\n\tname: 'CatalogLayout',\n\tprops: {\n\t\thasSearchResults: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\texpanded: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tcatalogClassNames(): { [string]: boolean }\n\t\t{\n\t\t\treturn {\n\t\t\t\t[CATALOG_CLASS_NAMES.base]: true,\n\t\t\t\t[CATALOG_CLASS_NAMES.expanded]: this.expanded,\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<section :class=\"catalogClassNames\">\n\t\t\t<div class=\"editor-chart-catalog__container\">\n\t\t\t\t<div class=\"editor-chart-catalog__header\">\n\t\t\t\t\t<slot name=\"header\"/>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"editor-chart-catalog__search\">\n\t\t\t\t\t<slot name=\"search\"/>\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!hasSearchResults\"\n\t\t\t\t\tclass=\"editor-chart-catalog__content\"\n\t\t\t\t>\n\t\t\t\t\t<slot name=\"content\"/>\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"hasSearchResults\"\n\t\t\t\t\tclass=\"editor-chart-catalog__search-results\"\n\t\t\t\t>\n\t\t\t\t\t<slot name=\"search-results\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"editor-chart-catalog__footer\">\n\t\t\t\t<slot name=\"footer\"/>\n\t\t\t</div>\n\t\t</section>\n\t`,\n};\n","import './header-layout.css';\n\n// @vue/component\nexport const HeaderLayout = {\n\tname: 'header-layout',\n\tprops: {\n\t\texpanded: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<header class=\"editor-chart-catalog-header-layout\">\n\t\t\t<div class=\"editor-chart-catalog-header-layout__switcher-btn\">\n\t\t\t<slot name=\"switcher\"/>\n\t\t</div>\n\t\t\t<div\n\t\t\t\tclass=\"editor-chart-catalog-header-layout__logo\"\n\t\t\t>\n\t\t\t\t<slot name=\"logo\"/>\n\t\t\t</div>\n\t\t</header>\n\t`,\n};\n","import { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport './burger-btn.css';\n\nexport type BurgerBtnSetup = {\n\ticonSet: { [string]: string };\n};\n\nconst BURGER_BTN_CLASS_NAMES = {\n\tbase: 'editor-chart-burger-btn',\n\topenend: '--opened',\n};\n\n// @vue/component\nexport const BurgerBtn = {\n\tname: 'BurgerBtn',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\topened: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(): BurgerBtnSetup\n\t{\n\t\treturn {\n\t\t\ticonSet: Outline,\n\t\t};\n\t},\n\tcomputed: {\n\t\tburgerBtnClassNames(): { [string]: boolean }\n\t\t{\n\t\t\treturn {\n\t\t\t\t[BURGER_BTN_CLASS_NAMES.base]: true,\n\t\t\t\t[BURGER_BTN_CLASS_NAMES.opened]: this.opened,\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<button\n\t\t\t:class=\"burgerBtnClassNames\"\n\t\t\t:data-test-id=\"$testId('catalogBurger')\"\n\t\t>\n\t\t\t<BIcon\n\t\t\t\t:name=\"iconSet.ALIGN_JUSTIFY\"\n\t\t\t\t:size=\"24\"\n\t\t\t\tclass=\"editor-chart-burger-btn__icon\"\n\t\t\t/>\n\t\t</button>\n\t`,\n};\n","import './header-logo.css';\nimport { useLoc } from '../../../../shared/composables';\nimport type { GetMessage } from '../../../../shared/composables';\n\ntype HeaderLogoSetup = {\n\tgetMessage: GetMessage\n};\n\n// @vue/component\nexport const HeaderLogo = {\n\tname: 'header-logo',\n\tsetup(): HeaderLogoSetup\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn {\n\t\t\tgetMessage,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div class=\"editor-chart-catalog-header-logo\">\n\t\t\t<span class=\"ui-node-catalog-header__logo-text\">\n\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_LOGO_TEXT') }}\n\t\t\t</span>\n\t\t</div>\n\t`,\n};\n","import './text-input.css';\nimport { onMounted, useTemplateRef, toValue } from 'ui.vue3';\nimport { useLoc } from '../../../../shared/composables';\nimport type { GetMessage } from '../../../../shared/composables';\n\nexport type TextInputSetup = {\n\tgetMessage: GetMessage,\n};\n\n// @vue/component\nexport const TextInput = {\n\tname: 'catalog-input',\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tfocusable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(props): {...}\n\t{\n\t\tconst textInput = useTemplateRef('textInput');\n\t\tconst { getMessage } = useLoc();\n\n\t\tonMounted(() => {\n\t\t\tif (props.focusable)\n\t\t\t{\n\t\t\t\ttoValue(textInput)?.focus();\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\tgetMessage,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div class=\"editor-chart-catalog-input\">\n\t\t\t<input\n\t\t\t\tref=\"textInput\"\n\t\t\t\t:value=\"modelValue\"\n\t\t\t\t:placeholder=\"getMessage('BIZPROCDESIGNER_EDITOR_SEARCH_PLACEHOLDER')\"\n\t\t\t\t:data-test-id=\"$testId('catalogSearchInput')\"\n\t\t\t\t:class=\"{\n\t\t\t\t\t'editor-chart-catalog-input__input': true,\n\t\t\t\t\t'editor-chart-catalog-input__input--has-text': modelValue.length > 0\n\t\t\t\t}\"\n\t\t\t\ttype=\"text\"\n\t\t\t\t@input=\"$emit('update:modelValue', $event.target.value)\"\n\t\t\t\t@focus=\"$emit('focus', $event)\"\n\t\t\t\t@blur=\"$emit('blur', $event)\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport './catalog-group.css';\n// eslint-disable-next-line no-unused-vars\nimport type { CatalogMenuGroup } from '../types';\n\n// @vue/component\nexport const CatalogGroup = {\n\tname: 'CatalogGroup',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\t/** @type CatalogMenuGroup */\n\t\tgroup: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tshowItems: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['changeGroup'],\n\tsetup(): { iconSet: { [string]: string } }\n\t{\n\t\treturn { iconSet: Outline };\n\t},\n\ttemplate: `\n\t\t<div class=\"editor-chart-catalog-group\">\n\t\t\t<div\n\t\t\t\t:data-test-id=\"$testId('catalogGroup', group.id)\"\n\t\t\t\tclass=\"editor-chart-catalog-group__header\"\n\t\t\t\t@click=\"$emit('changeGroup', group)\"\n\t\t\t>\n\t\t\t\t<div class=\"editor-chart-catalog-group__icon-wrapper\">\n\t\t\t\t\t<slot name=\"icon\"/>\n\t\t\t\t</div>\n\n\t\t\t\t<p class=\"editor-chart-catalog-group__title\">{{ group.title }}</p>\n\n\t\t\t\t<BIcon\n\t\t\t\t\t:name=\"iconSet.ARROW_RIGHT_XS\"\n\t\t\t\t\t:size=\"30\"\n\t\t\t\t\tclass=\"editor-chart-catalog-group__arrow\"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<Transition name=\"catalog-items-transition\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"showItems\"\n\t\t\t\t\tclass=\"editor-chart-catalog-group__content\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"editor-chart-catalog-group__back-groups\">\n\t\t\t\t\t\t<slot name=\"back\"/>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"group.items.length > 0\"\n\t\t\t\t\t\tclass=\"editor-chart-catalog-group__items\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<slot name=\"items\"/>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\tclass=\"editor-chart-catalog-group__empty-label\">\n\t\t\t\t\t\t<slot name=\"empty-label\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Transition>\n\t\t</div>\n\t`,\n};\n","import './catalog-group-empty-label.css';\nimport { useLoc } from '../../../../shared/composables';\nimport type { GetMessage } from '../../../../shared/composables';\n\ntype CatalogGroupEmptyLabelSetup = {\n\tgetMessage: GetMessage,\n};\n\n// @vue/component\nexport const CatalogGroupEmptyLabel = {\n\tname: 'catalog-group-empty-label',\n\tsetup(): CatalogGroupEmptyLabelSetup\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\treturn { getMessage };\n\t},\n\ttemplate: `\n\t\t<div class=\"editor-chart-catalog-group-empty-label\">\n\t\t\t<h2>{{ getMessage('BIZPROCDESIGNER_EDITOR_EMPTY_GROUP_TITLE') }}</h2>\n\t\t\t<p>{{ getMessage('BIZPROCDESIGNER_EDITOR_EMPTY_GROUP_DESCRIPTION') }}</p>\n\t\t</div>\n\t`,\n};\n","import './catalog-group-icon.css';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\n\ntype CatalogGroupIconSetup = {\n\tgetIconName: (name: ?string) => string,\n};\n\nconst DEFAULT_ICON_NAME = 'o-folder';\n\n// @vue/component\nexport const CatalogGroupIcon = {\n\tname: 'catalog-group-icon',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\ticonName: {\n\t\t\ttype: String,\n\t\t\tdefault: DEFAULT_ICON_NAME,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): CatalogGroupIconSetup\n\t{\n\t\tconst iconSet = Outline;\n\n\t\tfunction getIconName(name: ?string): string\n\t\t{\n\t\t\tif (name && Object.prototype.hasOwnProperty.call(iconSet, name))\n\t\t\t{\n\t\t\t\treturn iconSet[name];\n\t\t\t}\n\n\t\t\treturn DEFAULT_ICON_NAME;\n\t\t}\n\n\t\treturn {\n\t\t\tgetIconName,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<BIcon\n\t\t\t:name=\"getIconName(iconName)\"\n\t\t\t:size=\"30\"\n\t\t\tclass=\"editor-chart-catalog-group-icon\"\n\t\t/>\n\t`,\n};\n","import './catalog-item.css';\nimport { computed, ref, useTemplateRef, toValue } from 'ui.vue3';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport { DragBlock } from 'ui.block-diagram';\nimport { Type } from 'main.core';\nimport type { DragData } from 'ui.block-diagram';\nimport { createUniqueId } from '../../../../shared/utils';\nimport type { Block } from '../../../../shared/types';\nimport { getDragItemSlotName } from '../../utils';\nimport type { GetDragItemSlotName } from '../../utils';\nimport type { CatalogMenuItem } from '../../types';\nimport { BLOCK_TYPES } from '../../../../entities/blocks';\n\ntype CatalogItemSetup = {\n\tpreparedBlock: Block,\n\tcatalogItemClassNames: { [string]: boolean },\n\ticonWrapperClassNames: { [string]: boolean },\n\tgetDragItemSlotName: GetDragItemSlotName,\n\tgetIconName: (name: ?string) => string,\n\tgetIconColor: (colorIndex: ?Number) => ?string;\n\tisUrl: (value: string) => boolean,\n\tgetSafeUrl: (url: string) => string | null,\n\tgetBackgroundImage: (value: string) => Object,\n\tonDragStart: (event: DragEvent) => void,\n\tonDragEnd: (event: DragEvent) => void,\n};\n\nconst CATALOG_ITEM_CLASS_NAMES = {\n\tbase: 'editor-chart-catalog-item',\n\tactive: '--active',\n\tdrag: '--drag',\n};\n\nconst ICON_WRAPPER_CLASS_NAMES = {\n\tbase: 'editor-chart-catalog-item__icon-wrapper',\n\tbg_0: '--bg-0',\n\tbg_1: '--bg-1',\n\tbg_2: '--bg-2',\n\tbg_3: '--bg-3',\n\tbg_4: '--bg-4',\n\tbg_5: '--bg-5',\n\tbg_6: '--bg-6',\n\tbg_7: '--bg-7',\n\tbg_8: '--bg-8',\n};\n\nconst ICON_COLORS = {\n\t0: 'var(--designer-bp-ai-icons)',\n\t1: 'var(--designer-bp-entities-icons)',\n\t2: 'var(--designer-bp-employe-icons)',\n\t3: 'var(--designer-bp-technical-icons)',\n\t4: 'var(--designer-bp-communication-icons)',\n\t5: 'var(--designer-bp-storage-icons)',\n\t6: 'var(--designer-bp-afiliate-icons)',\n\t7: 'var(--ui-color-palette-white-base)',\n\t8: 'var(--ui-color-palette-white-base)',\n};\n\nconst DEFAULT_ICON_NAME = Outline.FOLDER;\n\n// @vue/component\nexport const CatalogItem = {\n\tname: 'catalog-item',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tdirectives: {\n\t\tDragBlock,\n\t},\n\tprops: {\n\t\t/** @type CatalogMenuItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tactive: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\t// eslint-disable-next-line max-lines-per-function\n\tsetup(props): CatalogItemSetup\n\t{\n\t\tconst iconSet = Outline;\n\t\tconst draggedItem = useTemplateRef('draggedItem');\n\t\tconst preparedBlock: Block = ref(getPreparedNewBlock(props.item));\n\n\t\tconst catalogItemClassNames = computed((): { [string]: boolean } => ({\n\t\t\t[CATALOG_ITEM_CLASS_NAMES.base]: true,\n\t\t\t[CATALOG_ITEM_CLASS_NAMES.active]: props.active,\n\t\t}));\n\n\t\tconst iconWrapperClassNames = computed((): { [string]: boolean } => {\n\t\t\tif (isUrl(props.item.icon))\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\t[ICON_WRAPPER_CLASS_NAMES.base]: true,\n\t\t\t\t\t'--custom': true,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst baseStyles = {\n\t\t\t\t[ICON_WRAPPER_CLASS_NAMES.base]: true,\n\t\t\t\t[ICON_WRAPPER_CLASS_NAMES.bg_0]: props.item.colorIndex === 0,\n\t\t\t\t[ICON_WRAPPER_CLASS_NAMES.bg_1]: props.item.colorIndex === 1,\n\t\t\t\t[ICON_WRAPPER_CLASS_NAMES.bg_2]: props.item.colorIndex === 2,\n\t\t\t\t[ICON_WRAPPER_CLASS_NAMES.bg_3]: props.item.colorIndex === 3,\n\t\t\t\t[ICON_WRAPPER_CLASS_NAMES.bg_4]: props.item.colorIndex === 4,\n\t\t\t\t[ICON_WRAPPER_CLASS_NAMES.bg_5]: props.item.colorIndex === 5,\n\t\t\t\t[ICON_WRAPPER_CLASS_NAMES.bg_6]: props.item.colorIndex === 6,\n\t\t\t\t[ICON_WRAPPER_CLASS_NAMES.bg_7]: props.item.colorIndex === 7,\n\t\t\t\t[ICON_WRAPPER_CLASS_NAMES.bg_8]: props.item.colorIndex === 8,\n\t\t\t};\n\n\t\t\tif (props.item.type === BLOCK_TYPES.TOOL)\n\t\t\t{\n\t\t\t\tbaseStyles['--rounded'] = true;\n\t\t\t}\n\n\t\t\treturn baseStyles;\n\t\t});\n\n\t\tconst dragPayload = computed(() => ({\n\t\t\tdragData: preparedBlock,\n\t\t\tdragImage: draggedItem,\n\t\t}));\n\n\t\tfunction getIconName(name: ?string): string\n\t\t{\n\t\t\tif (name && Object.prototype.hasOwnProperty.call(iconSet, name))\n\t\t\t{\n\t\t\t\treturn iconSet[name];\n\t\t\t}\n\n\t\t\treturn DEFAULT_ICON_NAME;\n\t\t}\n\n\t\tfunction getIconColor(colorIndex: ?Number): ?string\n\t\t{\n\t\t\tif (colorIndex !== false && ICON_COLORS[colorIndex])\n\t\t\t{\n\t\t\t\treturn ICON_COLORS[colorIndex];\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction getBackgroundImage(url: string): Object\n\t\t{\n\t\t\tconst safeUrl = getSafeUrl(url);\n\t\t\tif (!safeUrl)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t'background-image': `url('${safeUrl}')`,\n\t\t\t};\n\t\t}\n\n\t\tfunction getPreparedNewBlock(item: CatalogMenuItem): Block\n\t\t{\n\t\t\tconst id = createUniqueId();\n\t\t\tconst {\n\t\t\t\tid: itemId,\n\t\t\t\ttype,\n\t\t\t\tpresetId,\n\t\t\t\ttitle,\n\t\t\t\tproperties = {},\n\t\t\t\treturnProperties = [],\n\t\t\t\tcolorIndex,\n\t\t\t\ticon = DEFAULT_ICON_NAME,\n\t\t\t\tdefaultSettings: { width, height, ports = { input: [], output: [], aux: [], topAux: [] } },\n\t\t\t} = toValue(item);\n\n\t\t\treturn {\n\t\t\t\tid,\n\t\t\t\ttype,\n\t\t\t\tactivity: {\n\t\t\t\t\tName: id,\n\t\t\t\t\tType: itemId,\n\t\t\t\t\tPresetId: presetId,\n\t\t\t\t\tProperties: {\n\t\t\t\t\t\tTitle: title,\n\t\t\t\t\t\t...properties,\n\t\t\t\t\t},\n\t\t\t\t\tReturnProperties: returnProperties || [],\n\t\t\t\t\tActivated: 'Y',\n\t\t\t\t},\n\t\t\t\tdimensions: {\n\t\t\t\t\twidth,\n\t\t\t\t\theight,\n\t\t\t\t},\n\t\t\t\tposition: {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t},\n\t\t\t\tports,\n\t\t\t\tnode: {\n\t\t\t\t\tcolorIndex,\n\t\t\t\t\ticon,\n\t\t\t\t\ttitle,\n\t\t\t\t\ttype,\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\n\t\tfunction getDragPayload(): DragData\n\t\t{\n\t\t\treturn {\n\t\t\t\tdragData: getPreparedNewBlock(props.item),\n\t\t\t\tdragImage: draggedItem,\n\t\t\t};\n\t\t}\n\n\t\tfunction isUrl(value: string): boolean\n\t\t{\n\t\t\tif (!value || !Type.isString(value))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn value.startsWith('https://');\n\t\t}\n\n\t\tfunction getSafeUrl(url: string): string | null\n\t\t{\n\t\t\tif (!url || !Type.isString(url))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst trimmedUrl = url.trim();\n\n\t\t\tconst allowedProtocols = ['https://',];\n\t\t\tconst isSafeProtocol = allowedProtocols.some((protocol) => trimmedUrl.startsWith(protocol));\n\n\t\t\tif (!isSafeProtocol)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn trimmedUrl;\n\t\t}\n\n\t\treturn {\n\t\t\tdragPayload,\n\t\t\tpreparedBlock,\n\t\t\tcatalogItemClassNames,\n\t\t\ticonWrapperClassNames,\n\t\t\tgetDragItemSlotName,\n\t\t\tgetDragPayload,\n\t\t\tgetIconName,\n\t\t\tgetIconColor,\n\t\t\tisUrl,\n\t\t\tgetBackgroundImage,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tv-drag-block=\"getDragPayload\"\n\t\t\t:class=\"catalogItemClassNames\"\n\t\t\t:data-test-id=\"$testId('catalogItem', item.id)\"\n\t\t>\n\t\t\t<div\n\t\t\t\tref=\"draggedItem\"\n\t\t\t\tclass=\"editor-chart-catalog-item__drag-item\"\n\t\t\t>\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"getDragItemSlotName(preparedBlock.type)\"\n\t\t\t\t\t:item=\"preparedBlock\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div :class=\"iconWrapperClassNames\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"isUrl(item.icon)\"\n\t\t\t\t\t:style=\"getBackgroundImage(item.icon)\"\n\t\t\t\t\tclass=\"ui-selector-item-avatar\"\n\t\t\t\t/>\n\t\t\t\t<BIcon\n\t\t\t\t\tv-else\n\t\t\t\t\t:name=\"getIconName(item.icon)\"\n\t\t\t\t\t:color=\"getIconColor(item.colorIndex)\"\n\t\t\t\t\t:size=\"28\"\n\t\t\t\t\tclass=\"editor-chart-catalog-item__icon\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"editor-chart-catalog-item__content\">\n\t\t\t\t<div class=\"editor-chart-catalog-item__title\">\n\t\t\t\t\t{{ item.title }}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"item.subtitle\"\n\t\t\t\t\tclass=\"editor-chart-catalog-item__subtitle\">\n\t\t\t\t\t{{ item.subtitle }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import './catalog-group-list.css';\n// eslint-disable-next-line no-unused-vars\nimport type { CatalogMenuGroup } from '../../types';\n\nconst CATALOG_GROUP_LIST_CLASS_NAMES = {\n\tbase: 'editor-chart-catalog-group-list',\n\twithoutScroll: '--withoutScroll',\n};\n\n// @vue/component\nexport const CatalogGroupList = {\n\tname: 'CatalogGroupList',\n\tprops: {\n\t\t/** @type Array<CatalogMenuGroup> */\n\t\tgroups: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\t/** @type CatalogMenuGroup | null */\n\t\tcurrentGroup: {\n\t\t\ttype: Object,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tcomputed: {\n\t\tcatalogGroupListClassNames(): { [string]: boolean }\n\t\t{\n\t\t\treturn {\n\t\t\t\t[CATALOG_GROUP_LIST_CLASS_NAMES.base]: true,\n\t\t\t\t[CATALOG_GROUP_LIST_CLASS_NAMES.withoutScroll]: this.currentGroup !== null,\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ul :class=\"catalogGroupListClassNames\">\n\t\t\t<li\n\t\t\t\tv-for=\"group in groups\"\n\t\t\t\t:key=\"group.id\"\n\t\t\t\tclass=\"editor-chart-catalog-group-list__group\"\n\t\t\t>\n\t\t\t\t<slot\n\t\t\t\t\t:group=\"group\"\n\t\t\t\t\tname=\"group\"\n\t\t\t\t/>\n\t\t\t</li>\n\t\t</ul>\n\t`,\n};\n","import { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport './catalog-group-back-btn.css';\n\nconst GROUP_BACK_BTN_CLASS_NAMES = {\n\tbase: 'editor-chart-group-back-btn',\n\tcollapsed: '--collapsed',\n};\n\nconst ICON_CLASS_NAMES = {\n\tbase: 'editor-chart-group-back-btn__icon',\n\tcollapsed: '--collapsed',\n};\n\n// @vue/component\nexport const CatalogGroupBackBtn = {\n\tname: 'CatalogGroupBackBtn',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tgroupTitle: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tcollapsed: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(): { iconSet: { [string]: string } }\n\t{\n\t\treturn { iconSet: Outline };\n\t},\n\tcomputed: {\n\t\tgroupBackBtnCalssNames(): { [string]: boolean }\n\t\t{\n\t\t\treturn {\n\t\t\t\t[GROUP_BACK_BTN_CLASS_NAMES.base]: true,\n\t\t\t\t[GROUP_BACK_BTN_CLASS_NAMES.collapsed]: this.collapsed,\n\t\t\t};\n\t\t},\n\t\ticonClassNames(): { [string]: boolean }\n\t\t{\n\t\t\treturn {\n\t\t\t\t[ICON_CLASS_NAMES.base]: true,\n\t\t\t\t[ICON_CLASS_NAMES.collapsed]: this.collapsed,\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<button\n\t\t\t:class=\"groupBackBtnCalssNames\"\n\t\t\t:data-test-id=\"$testId('catalogGroupBackBtn')\"\n\t\t>\n\t\t\t<div\n\t\t\t\tv-if=\"!collapsed\"\n\t\t\t\tclass=\"editor-chart-group-back-btn__back-wrapper\"\n\t\t\t>\n\t\t\t\t<BIcon\n\t\t\t\t\t:name=\"iconSet.ARROW_LEFT_XS\"\n\t\t\t\t\t:size=\"30\"\n\t\t\t\t\tclass=\"editor-chart-group-back-btn__back\"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<div :class=\"iconClassNames\">\n\t\t\t\t<slot name=\"icon\"/>\n\t\t\t</div>\n\n\t\t\t<p class=\"editor-chart-group-back-btn__title\">\n\t\t\t\t{{ groupTitle }}\n\t\t\t</p>\n\t\t</button>\n\t`,\n};\n","import './search-results-label.css';\nimport { computed } from 'ui.vue3';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport { useLoc } from '../../../../shared/composables';\nimport type { GetMessage } from '../../../../shared/composables';\n\nexport type SearchResultsLabelSetup = {\n\ticonSet: { [string]: string },\n\tsearchResultsLablelClassNames: { [string]: boolean },\n\tcountLabel: string,\n\tgetMessage: GetMessage,\n}\n\nconst SEARCH_RESULTS_LABEL_CLASS_NAMES = {\n\tbase: 'editor-chart-search-results-label',\n\tcollapsed: '--collapsed',\n};\n\n// @vue/component\nexport const SearchResultsLabel = {\n\tname: 'search-results-label',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tcount: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\tcollapsed: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(props): SearchResultsLabelSetup\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\tconst searchResultsLablelClassNames = computed((): { [string]: boolean } => ({\n\t\t\t[SEARCH_RESULTS_LABEL_CLASS_NAMES.base]: true,\n\t\t\t[SEARCH_RESULTS_LABEL_CLASS_NAMES.collapsed]: props.collapsed,\n\t\t}));\n\n\t\tconst countLabel = computed((): string => {\n\t\t\treturn props.count === 0\n\t\t\t\t? getMessage('BIZPROCDESIGNER_EDITOR_NOT_FOUND')\n\t\t\t\t: getMessage('BIZPROCDESIGNER_EDITOR_FOUND', { '#count#': props.count });\n\t\t});\n\n\t\treturn {\n\t\t\ticonSet: Outline,\n\t\t\tsearchResultsLablelClassNames,\n\t\t\tcountLabel,\n\t\t\tgetMessage,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div :class=\"searchResultsLablelClassNames\">\n\t\t\t<BIcon\n\t\t\t\tv-if=\"collapsed\"\n\t\t\t\t:name=\"iconSet.SEARCH\"\n\t\t\t\t:size=\"20\"\n\t\t\t\tclass=\"editor-chart-search-results-label__icon\"\n\t\t\t/>\n\t\t\t<p\n\t\t\t\tv-if=\"!collapsed\"\n\t\t\t\tclass=\"editor-chart-search-results-label__count\"\n\t\t\t>\n\t\t\t\t{{ countLabel }}\n\t\t\t</p>\n\t\t\t<p\n\t\t\t\tv-if=\"!collapsed\"\n\t\t\t\tclass=\"editor-chart-search-results-label__location\"\n\t\t\t>\n\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_EVERYWHERE') }}\n\t\t\t</p>\n\t\t</div>\n\t`,\n};\n","import './search-results-layout.css';\nimport { computed } from 'ui.vue3';\nimport { useLoc } from '../../../../shared/composables';\nimport type { GetMessage } from '../../../../shared/composables';\nimport type { CatalogMenuGroup, CatalogMenuItem } from '../../types';\n\nexport type SearchResultsLayoutSetup = {\n\ttitleClassNames: { [string]: boolean },\n\tgetMessage: GetMessage,\n}\n\nconst TITLE_CLASS_NAMES = {\n\tbase: 'editor-chart-search-results-layout__title',\n\tcollapsed: '--collapsed',\n};\n\n// @vue/component\nexport const SearchResultsLayout = {\n\tname: 'search-results-layout',\n\tprops: {\n\t\t/** @type Array<CatalogMenuGroup> */\n\t\tgroups: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\t/** @type Array<CatalogMenuItem> */\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\tcollapsed: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(props): SearchResultsLayoutSetup\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\tconst titleClassNames = computed((): { [string]: boolean } => ({\n\t\t\t[TITLE_CLASS_NAMES.base]: true,\n\t\t\t[TITLE_CLASS_NAMES.collapsed]: props.collapsed,\n\t\t}));\n\n\t\treturn {\n\t\t\tgetMessage,\n\t\t\ttitleClassNames,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div class=\"editor-chart-search-results-layout\">\n\n\t\t\t<div\n\t\t\t\tv-if=\"groups.length > 0 || items.length > 0\"\n\t\t\t\tclass=\"editor-chart-search-results-layout__content\"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"groups.length > 0\"\n\t\t\t\t\tclass=\"editor-chart-search-results-layout__groups\">\n\t\t\t\t\t<h2 :class=\"titleClassNames\">\n\t\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_SEARCH_GROUPS') }}\n\t\t\t\t\t</h2>\n\t\t\t\t\t<slot\n\t\t\t\t\t\tv-for=\"group in groups\"\n\t\t\t\t\t\t:key=\"group.id\"\n\t\t\t\t\t\t:group=\"group\"\n\t\t\t\t\t\tname=\"group\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"items.length > 0\"\n\t\t\t\t\tclass=\"editor-chart-search-results-layout__items\"\n\t\t\t\t>\n\t\t\t\t\t<h2 :class=\"titleClassNames\">\n\t\t\t\t\t\t{{ getMessage('BIZPROCDESIGNER_EDITOR_SEARCH_NODES') }}\n\t\t\t\t\t</h2>\n\t\t\t\t\t<slot\n\t\t\t\t\t\tv-for=\"item in items\"\n\t\t\t\t\t\t:key=\"item.id\"\n\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\tname=\"item\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div\n\t\t\t\tv-else-if=\"!collapsed\"\n\t\t\t\tclass=\"editor-chart-search-results-layout__empty\"\n\t\t\t>\n\t\t\t\t<slot name=\"empty-label\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import './search-results-empty-label.css';\nimport { Form } from 'ui.feedback.form';\nimport { useLoc } from '../../../../shared/composables';\nimport type { GetMessage } from '../../../../shared/composables';\n\nexport type SearchResultsEmptyLabelSetup = {\n\tgetMessage: GetMessage,\n\tbefore: string,\n\tlink: string,\n\tafter: string,\n\tonFeedbackLinkClick: () => void,\n};\n\n// @vue/component\nexport const SearchResultsEmptyLabel = {\n\tname: 'search-results-empty-label',\n\tsetup(): SearchResultsEmptyLabelSetup\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\tconst description = getMessage(\n\t\t\t'BIZPROCDESIGNER_EDITOR_EMPTY_SEARCH_DESCRIPTION',\n\t\t);\n\t\tconst [before, link, after] = description.split(/\\[feedback]|\\[\\/feedback]/);\n\n\t\tfunction onFeedbackLinkClick(event): void\n\t\t{\n\t\t\tevent.preventDefault();\n\n\t\t\tForm.open(\n\t\t\t\t{\n\t\t\t\t\tid: String(Math.random()),\n\t\t\t\t\tforms: [\n\t\t\t\t\t\t{ zones: ['by', 'kz', 'ru'], id: 438, lang: 'ru', sec: 'odyyl1' },\n\t\t\t\t\t\t{ zones: ['com.br'], id: 436, lang: 'br', sec: '8fb4et' },\n\t\t\t\t\t\t{ zones: ['la', 'co', 'mx'], id: 434, lang: 'es', sec: 'ze9mqq' },\n\t\t\t\t\t\t{ zones: ['de'], id: 432, lang: 'de', sec: 'm8isto' },\n\t\t\t\t\t\t{ zones: ['en', 'eu', 'in', 'uk'], id: 430, lang: 'en', sec: 'etg2n4' },\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\treturn {\n\t\t\tgetMessage,\n\t\t\tbefore,\n\t\t\tlink,\n\t\t\tafter,\n\t\t\tonFeedbackLinkClick,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div class=\"editor-chart-search-results-empty-label\">\n\t\t\t<h2>{{ getMessage('BIZPROCDESIGNER_EDITOR_EMPTY_SEARCH_TITLE') }}</h2>\n\t\t\t<p>{{ before }} <a href=\"#\" @click=\"onFeedbackLinkClick\">{{ link }}</a> {{ after }}</p>\n\t\t</div>\n\t`,\n};\n","import { SearchBar as DiagramSearchBar } from 'ui.block-diagram';\nimport { useLoc } from '../../composables';\nimport type { Block } from '../../types';\n\n// @vue/component\nexport const SearchBar = {\n\tname: 'SearchBar',\n\tcomponents: {\n\t\tDiagramSearchBar,\n\t},\n\tsetup(): {...}\n\t{\n\t\tconst { getMessage } = useLoc();\n\n\t\tfunction searchCallback(block: Block, text: string): boolean\n\t\t{\n\t\t\treturn block.node.title\n\t\t\t\t.toLowerCase()\n\t\t\t\t.includes(text.toLowerCase());\n\t\t}\n\n\t\treturn {\n\t\t\tgetMessage,\n\t\t\tsearchCallback,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<DiagramSearchBar\n\t\t\t:searchResultTitle=\"getMessage('BIZPROCDESIGNER_EDITOR_SEARCH_RESULTS')\"\n\t\t\t:placeholder=\"getMessage('BIZPROCDESIGNER_EDITOR_SEARCH_PLACEHOLDER')\"\n\t\t\t:searchCallback=\"searchCallback\"\n\t\t/>\n\t`,\n};\n","import { post } from '../../../shared/api';\nimport { Type } from 'main.core';\n\nexport const setUserSelectedBlock = (blockId: ?string = null): Promise<void> => {\n\tRequestQueue.add(() => post('Integration.AiAssistant.Block.set', { blockId }));\n};\n\nexport class RequestQueue\n{\n\tstatic processingRequest: ?Promise = null;\n\tstatic nextRequest: ?Function = null;\n\n\tstatic add(request: () => Promise): void\n\t{\n\t\tif (this.processingRequest)\n\t\t{\n\t\t\tthis.nextRequest = request;\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.processingRequest = request()\n\t\t\t.finally(() => {\n\t\t\t\tthis.processingRequest = null;\n\t\t\t\tif (Type.isFunction(this.nextRequest))\n\t\t\t\t{\n\t\t\t\t\tconst next = this.nextRequest;\n\t\t\t\t\tthis.nextRequest = null;\n\t\t\t\t\tthis.add(next);\n\t\t\t\t}\n\t\t\t});\n\t}\n}\n","import { FeatureCode } from 'bizprocdesigner.feature';\nimport { computed, toValue, inject } from 'ui.vue3';\nimport { storeToRefs } from 'ui.vue3.pinia';\nimport { Runtime } from 'main.core';\nimport { UI } from 'ui.notification';\nimport { useAnimationQueue, useHighlightedBlocks } from 'ui.block-diagram';\nimport { setUserSelectedBlock } from '../../../../entities/ai-assistant/api/api';\nimport { useFeature, useLoc } from '../../../../shared/composables';\nimport type { Block, Connection } from '../../../../shared/composables';\nimport {\n\tBlockDiagram as BlockDiagramEntity,\n\tdiagramStore as useDiagramStore,\n\tBLOCK_SLOT_NAMES,\n\tCONNECTION_SLOT_NAMES,\n} from '../../../../entities/blocks';\n\n// @vue/component\nexport const BlockDiagram = {\n\tname: 'BlockDiagramWidget',\n\tcomponents: {\n\t\tBlockDiagramEntity,\n\t},\n\tprops: {\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(): {...}\n\t{\n\t\tconst showBlockSettings = inject('showBlockSettings');\n\t\tconst animationQueue = useAnimationQueue();\n\t\tconst diagramStore = useDiagramStore();\n\t\tconst { blocks: blocksInStore, connections: connectionsInStore } = storeToRefs(diagramStore);\n\t\tconst { getMessage } = useLoc();\n\t\tconst highlightedBlocks = useHighlightedBlocks();\n\t\tconst highlitedBlockIds = highlightedBlocks.highlitedBlockIds;\n\t\tconst { isFeatureAvailable } = useFeature();\n\n\t\tconst blocks = computed({\n\t\t\tget(): Block[]\n\t\t\t{\n\t\t\t\treturn toValue(blocksInStore);\n\t\t\t},\n\t\t\tset(newBlocks: Block[])\n\t\t\t{\n\t\t\t\tdiagramStore.setBlocks(newBlocks);\n\t\t\t\tfetchUpdateDiagram();\n\t\t\t},\n\t\t});\n\t\tconst connections = computed({\n\t\t\tget(): Connection[]\n\t\t\t{\n\t\t\t\treturn toValue(connectionsInStore);\n\t\t\t},\n\t\t\tset(newConnections: Connection[]): void\n\t\t\t{\n\t\t\t\tdiagramStore.setConnections(newConnections);\n\t\t\t\tfetchUpdateDiagram();\n\t\t\t},\n\t\t});\n\n\t\tconst fetchUpdateDiagram = Runtime.debounce(updateDiagramData, 700);\n\n\t\tasync function updateDiagramData(): Promise<void>\n\t\t{\n\t\t\tconst maxAttempts = 3;\n\t\t\tlet attempt = 0;\n\n\t\t\twhile (attempt < maxAttempts)\n\t\t\t{\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\t// eslint-disable-next-line no-await-in-loop\n\t\t\t\t\tawait diagramStore.publicDraft();\n\t\t\t\t\tdiagramStore.updateStatus(true);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcatch\n\t\t\t\t{\n\t\t\t\t\tattempt++;\n\t\t\t\t\tif (attempt >= maxAttempts)\n\t\t\t\t\t{\n\t\t\t\t\t\tdiagramStore.updateStatus(false);\n\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: getMessage('BIZPROCDESIGNER_EDITOR_TOP_PANEL_AUTOSAVE_STATUS_NOT_SAVED_HINT'),\n\t\t\t\t\t\t\tautoHideDelay: 4000,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction onDropNewBlock(block: Block): void\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tdiagramStore.setBlockCurrentTimestamp(block);\n\t\t\t\tdiagramStore.publicDraft();\n\t\t\t\tdiagramStore.updateStatus(true);\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\tdiagramStore.updateStatus(false);\n\t\t\t}\n\t\t}\n\n\t\tasync function onBlockTransitionEnd(block: Block): Promise<void>\n\t\t{\n\t\t\tif (!block || !block.position)\n\t\t\t{\n\t\t\t\tconsole.warn('Incorrect object for block transition end event', block);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tanimationQueue.pause();\n\t\t\ttry\n\t\t\t{\n\t\t\t\t// TODO: replace the method showBlockSettings with honey from slices app and settings\n\t\t\t\tawait showBlockSettings(block, true);\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tanimationQueue.play();\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tblocks,\n\t\t\tconnections,\n\t\t\tblockSlotNames: BLOCK_SLOT_NAMES,\n\t\t\tconnectionSlotNames: CONNECTION_SLOT_NAMES,\n\t\t\tonBlockTransitionEnd,\n\t\t\tonDropNewBlock,\n\t\t\thighlitedBlockIds,\n\t\t\tisFeatureAvailable,\n\t\t};\n\t},\n\t// @todo to widget\n\twatch: {\n\t\thighlitedBlockIds: {\n\t\t\tdeep: true,\n\t\t\thandler(newIds: string[], oldIds: string[]): void\n\t\t\t{\n\t\t\t\tif (!this.isFeatureAvailable(FeatureCode.aiAssistant))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (oldIds.length > 0 && newIds.length === 0)\n\t\t\t\t{\n\t\t\t\t\tsetUserSelectedBlock();\n\t\t\t\t}\n\n\t\t\t\tif (newIds.length === 1)\n\t\t\t\t{\n\t\t\t\t\tconst id = newIds[0];\n\t\t\t\t\tconst existedBlock = this.blocks.find((block) => block.id === id);\n\t\t\t\t\tif (existedBlock)\n\t\t\t\t\t{\n\t\t\t\t\t\tsetUserSelectedBlock(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BlockDiagramEntity\n\t\t\tv-model:blocks=\"blocks\"\n\t\t\tv-model:connections=\"connections\"\n\t\t\t:disabled=\"disabled\"\n\t\t\t@blockTransitionEnd=\"onBlockTransitionEnd\"\n\t\t\t@dropNewBlock=\"onDropNewBlock\"\n\t\t>\n\t\t\t<template #[blockSlotNames.SIMPLE]=\"{ block }\">\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"blockSlotNames.SIMPLE\"\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<template #[blockSlotNames.TRIGGER]=\"{ block }\">\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"blockSlotNames.TRIGGER\"\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<template #[blockSlotNames.COMPLEX]=\"{ block }\">\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"blockSlotNames.COMPLEX\"\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<template #[blockSlotNames.COMPLEX]=\"{ block }\">\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"blockSlotNames.COMPLEX\"\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<template #[blockSlotNames.TOOL]=\"{ block }\">\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"blockSlotNames.TOOL\"\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<template #[blockSlotNames.FRAME]=\"{ block }\">\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"blockSlotNames.FRAME\"\n\t\t\t\t\t:block=\"block\"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<template #[connectionSlotNames.AUX]=\"{ connection }\">\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"connectionSlotNames.AUX\"\n\t\t\t\t\t:connection=\"connection\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</BlockDiagramEntity>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.vue';\nimport { useHistory } from 'ui.block-diagram';\nimport { IconButton } from '../../../../shared/ui';\n// eslint-disable-next-line no-unused-vars\nimport type { BlockId } from '../../../../shared/types';\nimport { diagramStore as useDiagramStore } from '../../../../entities/blocks';\n\ntype DeleteBlockIconBtnSetup = {\n\tonDeleteBlock: () => void;\n};\n\n// @vue/component\nexport const DeleteBlockIconBtn = {\n\tname: 'DeleteBlockIconBtn',\n\tcomponents: {\n\t\tIconButton,\n\t},\n\tprops: {\n\t\t/** @type BlockId */\n\t\tblockId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['deletedBlock'],\n\tsetup(props, { emit }): DeleteBlockIconBtnSetup\n\t{\n\t\tconst history = useHistory();\n\t\tconst { deleteBlockById, publicDraft, updateStatus } = useDiagramStore();\n\n\t\tfunction tryPublicDraft(): void\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tpublicDraft();\n\t\t\t\tupdateStatus(true);\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\tupdateStatus(false);\n\t\t\t}\n\t\t}\n\n\t\tfunction onDeleteBlock(): void\n\t\t{\n\t\t\tif (props.disabled)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdeleteBlockById(props.blockId);\n\t\t\thistory.makeSnapshot();\n\t\t\temit('deletedBlock', props.blockId);\n\t\t\ttryPublicDraft();\n\t\t}\n\n\t\treturn {\n\t\t\ticonSet: Outline,\n\t\t\tonDeleteBlock,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<IconButton\n\t\t\t:icon-name=\"iconSet.TRASHCAN\"\n\t\t\t:color=\"'var(--ui-color-palette-gray-40)'\"\n\t\t\t:data-test-id=\"$testId('blockDelete', blockId)\"\n\t\t\t@click=\"onDeleteBlock\"\n\t\t/>\n\t`,\n};\n","import { computed } from 'ui.vue3';\nimport type { Block } from '../../../../shared/types';\nimport {\n\tBlockStatusNotPublished,\n\tdiagramStore as useDiagramStore,\n} from '../../../../entities/blocks';\n\n// @vue/component\nexport const UpdatePublishedStatusLabel = {\n\tname: 'UpdatePublishedStatusLabel',\n\tcomponents: {\n\t\tBlockStatusNotPublished,\n\t},\n\tprops: {\n\t\t/** @type Block */\n\t\tblock: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(props): {...}\n\t{\n\t\tconst diagramStore = useDiagramStore();\n\n\t\tconst isPublished = computed((): boolean => {\n\t\t\tconst updated = diagramStore.blockCurrentTimestamps[props.block.id];\n\t\t\tconst published = diagramStore.blockSavedTimestamps[props.block.id];\n\n\t\t\treturn updated === published;\n\t\t});\n\n\t\treturn {\n\t\t\tisPublished,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<BlockStatusNotPublished v-if=\"!isPublished\"/>\n\t`,\n};\n","import './style.css';\n\nconst PORT_POSITIONS = {\n\tright: 'right',\n};\n\nexport const AddComplexBlockPort = {\n\tname: 'add-complex-block-port',\n\tprops:\n\t{\n\t\tposition:\n\t\t{\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\thighlighted:\n\t\t{\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed:\n\t{\n\t\tpointClasses(): { [key: string]: boolean }\n\t\t{\n\t\t\treturn {\n\t\t\t\t'--right': this.position === PORT_POSITIONS.right,\n\t\t\t\t'--highlighted': this.highlighted,\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<svg\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\twidth=\"9\"\n\t\t\theight=\"9\"\n\t\t\tviewBox=\"0 0 9 9\"\n\t\t\tfill=\"none\"\n\t\t\tclass=\"complex-block-port-add-point\"\n\t\t\t:class=\"pointClasses\"\n\t\t>\n\t\t\t<circle cx=\"4.5\" cy=\"4.5\" r=\"4\" fill=\"white\" stroke=\"#DFE0E3\"/>\n\t\t\t<rect x=\"4\" y=\"2\" width=\"1\" height=\"5\" rx=\"0.5\" fill=\"#DFE0E3\"/>\n\t\t\t<rect x=\"2\" y=\"5\" width=\"1\" height=\"5\" rx=\"0.5\" transform=\"rotate(-90 2 5)\" fill=\"#DFE0E3\"/>\n\t\t</svg>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { mapWritableState, mapActions } from 'ui.vue3.pinia';\n// eslint-disable-next-line no-unused-vars\nimport type { MenuOptions } from 'ui.vue3.components.menu';\nimport {\n\tTemplateNameInput,\n\tdiagramStore as useDiagramStore,\n} from '../../../../entities/blocks';\n\n// @vue/component\nexport const EditTemplateName = {\n\tname: 'EditTemplateName',\n\tcomponents: {\n\t\tTemplateNameInput,\n\t},\n\tprops: {\n\t\t/** @type MenuOptions */\n\t\tdropdownOptions:\n\t\t{\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapWritableState(useDiagramStore, [\n\t\t\t'template',\n\t\t]),\n\t\ttemplateName:\n\t\t{\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\treturn this.template?.NAME ?? '';\n\t\t\t},\n\t\t\tset(name: string): void\n\t\t\t{\n\t\t\t\tthis.template.NAME =\n\t\t\t\t\tType.isStringFilled(name)\n\t\t\t\t\t\t? name\n\t\t\t\t\t\t: this.loc('BIZPROCDESIGNER_EDITOR_DEFAULT_TITLE')\n\t\t\t\t;\n\n\t\t\t\tthis.updateTemplateData({\n\t\t\t\t\tNAME: this.template.NAME,\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\t},\n\tmethods: {\n\t\t...mapActions(useDiagramStore, [\n\t\t\t'updateTemplateData',\n\t\t]),\n\t\tloc(locString: string): string\n\t\t{\n\t\t\treturn this.$bitrix.Loc.getMessage(locString);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<TemplateNameInput\n\t\t\tv-model:title=\"templateName\"\n\t\t\t:dropdownOptions=\"dropdownOptions\"\n\t\t/>\n\t`,\n};\n","import { mapState, mapActions } from 'ui.vue3.pinia';\nimport { UI } from 'ui.notification';\nimport { handleResponseError } from '../../../../shared/utils';\nimport {\n\tDropdownMenuButton,\n\tdiagramStore as useDiagramStore,\n\tTEMPLATE_PUBLISH_STATUSES,\n} from '../../../../entities/blocks';\n\ntype PublishDropdownButtonData = {\n\tisLoading: boolean,\n};\n\n// @vue/component\nexport const PublishDropdownButton = {\n\tname: 'PublishDropdownButton',\n\tcomponents: {\n\t\tDropdownMenuButton,\n\t},\n\tdata(): PublishDropdownButtonData\n\t{\n\t\treturn {\n\t\t\tisLoading: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapState(useDiagramStore, ['templatePublishStatus']),\n\t\ticon(): string\n\t\t{\n\t\t\tconst icons = {\n\t\t\t\t[TEMPLATE_PUBLISH_STATUSES.MAIN]: 'ui-btn-icon-workflow',\n\t\t\t\t[TEMPLATE_PUBLISH_STATUSES.USER]: 'ui-btn-icon-person',\n\t\t\t\t[TEMPLATE_PUBLISH_STATUSES.FULL]: 'ui-btn-icon-workflow-stop',\n\t\t\t};\n\n\t\t\treturn icons[this.templatePublishStatus];\n\t\t},\n\t},\n\tmethods: {\n\t\t...mapActions(useDiagramStore, [\n\t\t\t'publicTemplate',\n\t\t]),\n\t\tpublishTemplate(): void\n\t\t{\n\t\t\t({\n\t\t\t\t[TEMPLATE_PUBLISH_STATUSES.MAIN]: this.fetchPublishMainTemplate,\n\t\t\t\t[TEMPLATE_PUBLISH_STATUSES.USER]: this.fetchPublishUserTemplate,\n\t\t\t\t[TEMPLATE_PUBLISH_STATUSES.FULL]: this.fetchPublishFullTemplate,\n\t\t\t})[this.templatePublishStatus]();\n\t\t},\n\t\tasync fetchPublishMainTemplate()\n\t\t{\n\t\t\tthis.isLoading = true;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait this.publicTemplate();\n\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_MENU_SAVE_SUCCESS') ?? '',\n\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t});\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\thandleResponseError(error);\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tthis.isLoading = false;\n\t\t\t}\n\t\t},\n\t\tfetchPublishUserTemplate(): void\n\t\t{\n\t\t\talert('doUserPublication');\n\t\t\tthis.loading = false;\n\t\t},\n\t\tfetchPublishFullTemplate(): void\n\t\t{\n\t\t\talert('doFullPublication');\n\t\t\tthis.loading = false;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<DropdownMenuButton\n\t\t\t:text=\"$Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_PUBLISH')\"\n\t\t\t:icon=\"icon\"\n\t\t\t:loading=\"isLoading\"\n\t\t\t@change=\"publishTemplate\"\n\t\t>\n\t\t\t<template #default>\n\t\t\t\t<slot/>\n\t\t\t</template>\n\t\t</DropdownMenuButton>\n\t`,\n};\n","import { mapWritableState } from 'ui.vue3.pinia';\nimport {\n\tDropdownMenuOption,\n\tWorkflowIcon,\n\tdiagramStore as useDiagramStore,\n\tTEMPLATE_PUBLISH_STATUSES,\n} from '../../../../entities/blocks';\n\n// @vue/components\nexport const PublishMainDropdownOption = {\n\tname: 'PublishMainDropdownOption',\n\tcomponents:\n\t{\n\t\tDropdownMenuOption,\n\t\tWorkflowIcon,\n\t},\n\tcomputed:\n\t{\n\t\t...mapWritableState(useDiagramStore, ['templatePublishStatus']),\n\t\tisActive(): boolean\n\t\t{\n\t\t\treturn this.templatePublishStatus === TEMPLATE_PUBLISH_STATUSES.MAIN;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonChangeOption()\n\t\t{\n\t\t\tthis.templatePublishStatus = TEMPLATE_PUBLISH_STATUSES.MAIN;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<DropdownMenuOption\n\t\t\t:title=\"$Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_MENU_MAIN_TITLE')\"\n\t\t\t:description=\"$Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_MENU_MAIN_DESCR')\"\n\t\t\t:isActive=\"isActive\"\n\t\t\t@click=\"onChangeOption\"\n\t\t>\n\t\t\t<template #icon>\n\t\t\t\t<WorkflowIcon :active=\"isActive\"/>\n\t\t\t</template>\n\t\t</DropdownMenuOption>\n\t`,\n};\n","import { mapWritableState } from 'ui.vue3.pinia';\nimport {\n\tDropdownMenuOption,\n\tPersonIcon,\n\tdiagramStore as useDiagramStore,\n\tTEMPLATE_PUBLISH_STATUSES,\n} from '../../../../entities/blocks';\n\n// @vue/components\nexport const PublishUserDropdownOption = {\n\tname: 'PublishUserDropdownOption',\n\tcomponents:\n\t{\n\t\tDropdownMenuOption,\n\t\tPersonIcon,\n\t},\n\tcomputed:\n\t{\n\t\t...mapWritableState(useDiagramStore, ['templatePublishStatus']),\n\t\tisActive(): boolean\n\t\t{\n\t\t\treturn this.templatePublishStatus === TEMPLATE_PUBLISH_STATUSES.USER;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonChangeOption()\n\t\t{\n\t\t\tthis.templatePublishStatus = TEMPLATE_PUBLISH_STATUSES.USER;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<DropdownMenuOption\n\t\t\t:title=\"$Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_MENU_PERSONAL_TITLE')\"\n\t\t\t:description=\"$Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_MENU_PERSONAL_DESCR')\"\n\t\t\t:isActive=\"false\"\n\t\t\t:notReleased=\"true\"\n\t\t>\n\t\t\t<template #icon>\n\t\t\t\t<PersonIcon :active=\"isActive\"/>\n\t\t\t</template>\n\t\t</DropdownMenuOption>\n\t`,\n};\n","import { mapWritableState } from 'ui.vue3.pinia';\nimport {\n\tDropdownMenuOption,\n\tStopIcon,\n\tdiagramStore as useDiagramStore,\n\tTEMPLATE_PUBLISH_STATUSES,\n} from '../../../../entities/blocks';\n\n// @vue/components\nexport const PublishFullDropdownOption = {\n\tname: 'PublishFullDropdownOption',\n\tcomponents:\n\t{\n\t\tDropdownMenuOption,\n\t\tStopIcon,\n\t},\n\tcomputed:\n\t{\n\t\t...mapWritableState(useDiagramStore, ['templatePublishStatus']),\n\t\tisActive(): boolean\n\t\t{\n\t\t\treturn this.templatePublishStatus === TEMPLATE_PUBLISH_STATUSES.FULL;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonChangeOption()\n\t\t{\n\t\t\tthis.templatePublishStatus = TEMPLATE_PUBLISH_STATUSES.FULL;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<DropdownMenuOption\n\t\t\t:title=\"$Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_MENU_FULL_TITLE')\"\n\t\t\t:description=\"$Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_MENU_FULL_DESCR')\"\n\t\t\t:isActive=\"false\"\n\t\t\t:notReleased=\"true\"\n\t\t>\n\t\t\t<template #icon>\n\t\t\t\t<StopIcon :active=\"isActive\"/>\n\t\t\t</template>\n\t\t</DropdownMenuOption>\n\t`,\n};\n","import { mapActions } from 'ui.vue3.pinia';\nimport {\n\tBlockContainer,\n\tdiagramStore as useDiagramStore,\n\tBLOCK_COLOR_NAMES,\n} from '../../../../entities/blocks';\n// eslint-disable-next-line no-unused-vars\nimport type { BlockId } from '../../../../shared/types';\n// eslint-disable-next-line no-unused-vars\nimport type { MenuItemOptions } from 'ui.vue3.components.menu';\n\n// @vue/component\nexport const AutosizeBlockContainer = {\n\tname: 'AutosizeBlockContainer',\n\tcomponents: {\n\t\tBlockContainer,\n\t},\n\tprops: {\n\t\t/** @type BlockId */\n\t\tblockId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\t/** @type Array<MenuItemOptions> */\n\t\tcontextMenuItems: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\twidth: {\n\t\t\ttype: Number,\n\t\t\tdefault: null,\n\t\t},\n\t\theight: {\n\t\t\ttype: Number,\n\t\t\tdefault: null,\n\t\t},\n\t\tautosize: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\thighlighted: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tcolorName: {\n\t\t\ttype: String,\n\t\t\tdefault: BLOCK_COLOR_NAMES.WHITE,\n\t\t\tvalidator(name): boolean\n\t\t\t{\n\t\t\t\treturn Object.values(BLOCK_COLOR_NAMES).includes(name);\n\t\t\t},\n\t\t},\n\t},\n\tcomputed: {\n\t\tsize(): { width: number, height: number } | {}\n\t\t{\n\t\t\tif (this.autosize)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\twidth: this.width,\n\t\t\t\theight: this.height,\n\t\t\t};\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tif (this.autosize)\n\t\t{\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tconst { width, height } = this.$refs.blockContainer?.$el?.getBoundingClientRect() ?? {};\n\t\t\t\tthis.setSizeAutosizedBlock(this.blockId, width, height);\n\t\t\t});\n\t\t}\n\t},\n\tmethods: {\n\t\t...mapActions(useDiagramStore, ['setSizeAutosizedBlock']),\n\t},\n\ttemplate: `\n\t\t<BlockContainer\n\t\t\tref=\"blockContainer\"\n\t\t\tv-bind=\"size\"\n\t\t\t:contextMenuItems=\"contextMenuItems\"\n\t\t\t:highlighted=\"highlighted\"\n\t\t\t:disabled=\"disabled\"\n\t\t\t:colorName=\"colorName\"\n\t\t>\n\t\t\t<template #default=\"{ isOpenContextMenu }\">\n\t\t\t\t<slot :isOpenContextMenu=\"isOpenContextMenu\"/>\n\t\t\t</template>\n\t\t</BlockContainer>\n\t`,\n};\n","import { useAppStore } from '../../../entities/app';\nimport { useCommonNodeSettingsStore } from '../../../entities/common-node-settings';\nimport { useNodeSettingsStore } from '../../../entities/node-settings';\nimport { diagramStore as useDiagramStore } from '../../../entities/blocks';\nimport { useLoc } from '../../../shared/composables';\nimport { useHistory } from 'ui.block-diagram';\nimport type { MenuItemOptions } from 'ui.vue3.components.menu';\nimport type { Block, BlockId } from '../../../shared/types';\nimport { BLOCK_TYPES } from '../../../entities/blocks';\n\nconst HIDE_SETTINGS_DELAY = 300;\n\nexport class BlockMediator\n{\n\t#loc = null;\n\t#history = null;\n\t#appStore = null;\n\t#commonNodeSettingsStore = null;\n\t#complexNodeSettingsStore = null;\n\t#diagramStore = null;\n\n\tconstructor()\n\t{\n\t\tthis.#loc = useLoc();\n\t\tthis.#history = useHistory();\n\t\tthis.#appStore = useAppStore();\n\t\tthis.#commonNodeSettingsStore = useCommonNodeSettingsStore();\n\t\tthis.#complexNodeSettingsStore = useNodeSettingsStore();\n\t\tthis.#diagramStore = useDiagramStore();\n\t}\n\n\tisCurrentBlock(blockId: BlockId): boolean\n\t{\n\t\treturn this.#commonNodeSettingsStore.isCurrentBlock(blockId)\n\t\t\t|| this.#complexNodeSettingsStore.isCurrentBlock(blockId);\n\t}\n\n\thideAllSettings(): Promise<void>\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.#appStore.hideRightPanel();\n\t\t\tthis.#commonNodeSettingsStore.hideSettings();\n\t\t\tthis.#complexNodeSettingsStore.toggleVisibility(false);\n\n\t\t\tsetTimeout(() => resolve(), HIDE_SETTINGS_DELAY);\n\t\t});\n\t}\n\n\thideCurrentBlockSettings(blockId: BlockId): void\n\t{\n\t\tif (this.isCurrentBlock(blockId))\n\t\t{\n\t\t\tthis.hideAllSettings();\n\t\t}\n\t}\n\n\tasync showNodeSettings(block: Block): void\n\t{\n\t\tconst notReallyComplexBlock = ['ForEachActivity', 'IfElseBranchActivity'];\n\n\t\tif (block.type === BLOCK_TYPES.COMPLEX && !notReallyComplexBlock.includes(block.activity.Type))\n\t\t{\n\t\t\tthis.showComplexNodeSettings(block);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.showCommonNodeSettings(block);\n\t}\n\n\tasync showCommonNodeSettings(block: Block): void\n\t{\n\t\tawait this.hideAllSettings();\n\t\tthis.#appStore.showRightPanel();\n\t\tthis.#commonNodeSettingsStore.showSettings(block);\n\t}\n\n\tasync showComplexNodeSettings(block: Block): void\n\t{\n\t\tawait this.hideAllSettings();\n\t\tthis.#appStore.showRightPanel();\n\t\tthis.#complexNodeSettingsStore.toggleVisibility(true);\n\t\tawait this.#complexNodeSettingsStore.fetchNodeSettings(block);\n\t}\n\n\tgetCtxMenuItemShowSimpleSettings(block: Block): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\tid: 'showSimpleSettings',\n\t\t\ttext: this.#loc.getMessage('BIZPROCDESIGNER_EDITOR_BLOCK_CONTEXT_MENU_ITEM_OPEN'),\n\t\t\tonclick: () => this.showNodeSettings(block),\n\t\t};\n\t}\n\n\tgetCtxMenuItemShowComplexSettings(block: Block): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\tid: 'showComplexSettings',\n\t\t\ttext: this.#loc.getMessage('BIZPROCDESIGNER_EDITOR_BLOCK_CONTEXT_MENU_ITEM_OPEN'),\n\t\t\tonclick: () => this.showNodeSettings(block),\n\t\t};\n\t}\n\n\tgetCtxMenuItemDeleteBlock(block: Block): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\tid: 'deleteBlock',\n\t\t\ttext: this.#loc.getMessage('BIZPROCDESIGNER_EDITOR_BLOCK_CONTEXT_MENU_ITEM_DELETE'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.hideCurrentBlockSettings(block.id);\n\t\t\t\tthis.#diagramStore.deleteBlockById(block.id);\n\t\t\t\tthis.#history.makeSnapshot();\n\t\t\t},\n\t\t};\n\t}\n}\n","import { MoveableBlock } from 'ui.block-diagram';\nimport { Outline } from 'ui.icon-set.api.vue';\nimport { isBlockActivated } from '../../../../entities/blocks/utils';\nimport { IconDivider, IconButton } from '../../../../shared/ui';\n// eslint-disable-next-line no-unused-vars\nimport type { Block, BlockId } from '../../../../shared/types';\nimport {\n\tBlockLayout,\n\tBlockHeader,\n\tBlockIcon,\n\tPortsInOutCenter,\n} from '../../../../entities/blocks';\nimport {\n\tAutosizeBlockContainer,\n\tDeleteBlockIconBtn,\n\tUpdatePublishedStatusLabel,\n} from '../../../../features/blocks';\n\nimport { BlockMediator } from '../../lib';\n\ntype BlockSimpleSetup = {\n\ticonSet: { [string]: string };\n\tonOpenBlockSettings: (event: MouseEvent) => void;\n};\n\n// @vue/component\nexport const BlockSimple = {\n\tname: 'BlockSimple',\n\tcomponents: {\n\t\tMoveableBlock,\n\t\tAutosizeBlockContainer,\n\t\tBlockLayout,\n\t\tBlockHeader,\n\t\tBlockIcon,\n\t\tDeleteBlockIconBtn,\n\t\tUpdatePublishedStatusLabel,\n\t\tIconDivider,\n\t\tIconButton,\n\t\tPortsInOutCenter,\n\t},\n\tprops: {\n\t\t/** @type Block */\n\t\tblock: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tautosize: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tisBlockActivated(): boolean\n\t\t{\n\t\t\treturn isBlockActivated(this.block);\n\t\t}\n\t},\n\tsetup(props): BlockSimpleSetup\n\t{\n\t\treturn {\n\t\t\ticonSet: Outline,\n\t\t\tblockMediator: new BlockMediator(),\n\t\t};\n\t},\n\ttemplate: `\n\t\t<MoveableBlock :block=\"block\">\n\t\t\t<template #default=\"{ isHighlighted, isDragged, isDisabled, isActivated }\">\n\t\t\t\t<AutosizeBlockContainer\n\t\t\t\t\t:blockId=\"block.id\"\n\t\t\t\t\t:autosize=\"autosize\"\n\t\t\t\t\t:width=\"block.dimensions.width\"\n\t\t\t\t\t:height=\"block.dimensions.height\"\n\t\t\t\t\t:highlighted=\"isHighlighted\"\n\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t:deactivated=\"!isBlockActivated\"\n\t\t\t\t\t:contextMenuItems=\"[\n\t\t\t\t\t\tblockMediator.getCtxMenuItemShowSimpleSettings(block),\n\t\t\t\t\t\tblockMediator.getCtxMenuItemDeleteBlock(block),\n\t\t\t\t\t]\"\n\t\t\t\t\t@dblclick.stop=\"blockMediator.showNodeSettings(block)\"\n\t\t\t\t>\n\t\t\t\t\t<BlockLayout\n\t\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t\t:moreMenuItems=\"[\n\t\t\t\t\t\t\tblockMediator.getCtxMenuItemShowSimpleSettings(block),\n\t\t\t\t\t\t\tblockMediator.getCtxMenuItemDeleteBlock(block),\n\t\t\t\t\t\t]\"\n\t\t\t\t\t\t:dragged=\"isDragged\"\n\t\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #top-menu>\n\t\t\t\t\t\t\t<DeleteBlockIconBtn\n\t\t\t\t\t\t\t\t:blockId=\"block.id\"\n\t\t\t\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t\t\t\t@deletedBlock=\"blockMediator.hideCurrentBlockSettings($event)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<IconDivider/>\n\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t<template #default>\n\t\t\t\t\t\t\t<PortsInOutCenter\n\t\t\t\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<BlockHeader :block=\"block\">\n\t\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t\t<BlockIcon\n\t\t\t\t\t\t\t\t\t\t\t:iconName=\"block.node.icon\"\n\t\t\t\t\t\t\t\t\t\t\t:iconColorIndex=\"block.node.colorIndex\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</BlockHeader>\n\t\t\t\t\t\t\t</PortsInOutCenter>\n\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t<template #status>\n\t\t\t\t\t\t\t<UpdatePublishedStatusLabel :block=\"block\"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</BlockLayout>\n\t\t\t\t</AutosizeBlockContainer>\n\t\t\t</template>\n\t\t</MoveableBlock>\n\t`,\n};\n","import { MoveableBlock } from 'ui.block-diagram';\nimport { inject } from 'ui.vue3';\nimport { Outline } from 'ui.icon-set.api.vue';\nimport { isBlockActivated } from '../../../../entities/blocks/utils';\nimport { IconDivider, IconButton } from '../../../../shared/ui';\n// eslint-disable-next-line no-unused-vars\nimport type { Block, BlockId } from '../../../../shared/types';\nimport {\n\tBlockLayout,\n\tBlockHeader,\n\tBlockIcon,\n\tPortsInOutCenter,\n\tBlockSwitcher,\n} from '../../../../entities/blocks';\nimport {\n\tAutosizeBlockContainer,\n\tDeleteBlockIconBtn,\n\tUpdatePublishedStatusLabel,\n} from '../../../../features/blocks';\n\nimport { BlockMediator } from '../../lib';\n\ntype BlockTriggerSetup = {\n\ticonSet: { [string]: string };\n\tonOpenBlockSettings: (event: MouseEvent) => void;\n};\n\n// @vue/component\nexport const BlockTrigger = {\n\tname: 'BlockTrigger',\n\tcomponents: {\n\t\tMoveableBlock,\n\t\tAutosizeBlockContainer,\n\t\tBlockLayout,\n\t\tBlockHeader,\n\t\tBlockIcon,\n\t\tDeleteBlockIconBtn,\n\t\tUpdatePublishedStatusLabel,\n\t\tIconDivider,\n\t\tIconButton,\n\t\tPortsInOutCenter,\n\t\tBlockSwitcher,\n\t},\n\tprops: {\n\t\t/** @type Block */\n\t\tblock: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tautosize: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tisBlockActivated(): boolean\n\t\t{\n\t\t\treturn isBlockActivated(this.block);\n\t\t}\n\t},\n\tsetup(props): BlockTriggerSetup\n\t{\n\t\tconst onToggleBlockActivation = inject('onToggleBlockActivation');\n\t\tfunction toggleBlock(): void\n\t\t{\n\t\t\tif (!onToggleBlockActivation)\n\t\t\t{\n\t\t\t\tconsole.warn('onToggleBlockActivation is not provided');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tonToggleBlockActivation(props.block.id);\n\t\t}\n\n\t\treturn {\n\t\t\ticonSet: Outline,\n\t\t\tblockMediator: new BlockMediator(),\n\t\t\ttoggleBlock,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<MoveableBlock :block=\"block\">\n\t\t\t<template #default=\"{ isHighlighted, isDragged, isDisabled }\">\n\t\t\t\t<AutosizeBlockContainer\n\t\t\t\t\t:blockId=\"block.id\"\n\t\t\t\t\t:autosize=\"autosize\"\n\t\t\t\t\t:width=\"block.dimensions.width\"\n\t\t\t\t\t:height=\"block.dimensions.height\"\n\t\t\t\t\t:highlighted=\"isHighlighted\"\n\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t:deactivated=\"!isBlockActivated\"\n\t\t\t\t\t:contextMenuItems=\"[\n\t\t\t\t\t\tblockMediator.getCtxMenuItemShowSimpleSettings(block),\n\t\t\t\t\t\tblockMediator.getCtxMenuItemDeleteBlock(block),\n\t\t\t\t\t]\"\n\t\t\t\t\t@dblclick.stop=\"blockMediator.showNodeSettings(block)\"\n\t\t\t\t>\n\t\t\t\t\t<BlockLayout\n\t\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t\t:moreMenuItems=\"[\n\t\t\t\t\t\t\tblockMediator.getCtxMenuItemShowSimpleSettings(block),\n\t\t\t\t\t\t\tblockMediator.getCtxMenuItemDeleteBlock(block),\n\t\t\t\t\t\t]\"\n\t\t\t\t\t\t:dragged=\"isDragged\"\n\t\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #top-menu>\n\t\t\t\t\t\t\t<DeleteBlockIconBtn\n\t\t\t\t\t\t\t\t:blockId=\"block.id\"\n\t\t\t\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t\t\t\t@deletedBlock=\"blockMediator.hideCurrentBlockSettings($event)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<IconDivider/>\n\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t<template #default>\n\t\t\t\t\t\t\t<PortsInOutCenter\n\t\t\t\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t\t\t\thideInputPorts\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<BlockHeader :block=\"block\">\n\t\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t\t<BlockIcon\n\t\t\t\t\t\t\t\t\t\t\t:iconName=\"block.node.icon\"\n\t\t\t\t\t\t\t\t\t\t\t:iconColorIndex=\"block.node.colorIndex\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</BlockHeader>\n\t\t\t\t\t\t\t</PortsInOutCenter>\n\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t<template #left>\n\t\t\t\t\t\t\t<BlockSwitcher\n\t\t\t\t\t\t\t\t:on=\"isBlockActivated\"\n\t\t\t\t\t\t\t\t@click=\"toggleBlock\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t<template #status>\n\t\t\t\t\t\t\t<UpdatePublishedStatusLabel :block=\"block\"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</BlockLayout>\n\t\t\t\t</AutosizeBlockContainer\n\t\t\t\t\t:blockId=\"block.id\"\n\t\t\t\t\t:autosize=\"block.node.autosize\"\n\t\t\t\t\t:width=\"block.dimensions.width\"\n\t\t\t\t\t:height=\"block.dimensions.height\">\n\t\t\t</template>\n\t\t</MoveableBlock>\n\t`,\n};\n","import { mapActions } from 'ui.vue3.pinia';\n\nimport { MoveableBlock } from 'ui.block-diagram';\nimport { Outline } from 'ui.icon-set.api.vue';\n\nimport { IconDivider, IconButton } from '../../../../shared/ui';\nimport {\n\tBlockContainer,\n\tBlockLayout,\n\tBlockHeader,\n\tBlockIcon,\n\tBlockComplexContent,\n\tPortsInOutCenter,\n} from '../../../../entities/blocks';\nimport { DeleteBlockIconBtn, AddComplexBlockPort, UpdatePublishedStatusLabel } from '../../../../features/blocks';\nimport { useNodeSettingsStore } from '../../../../entities/node-settings';\nimport { isBlockActivated } from '../../../../entities/blocks/utils';\n\nimport { BlockMediator } from '../../lib';\n\n// @vue/component\nexport const BlockComplex = {\n\tname: 'block-complex',\n\tcomponents: {\n\t\tMoveableBlock,\n\t\tBlockContainer,\n\t\tBlockLayout,\n\t\tBlockHeader,\n\t\tBlockIcon,\n\t\tDeleteBlockIconBtn,\n\t\tIconDivider,\n\t\tIconButton,\n\t\tPortsInOutCenter,\n\t\tBlockComplexContent,\n\t\tAddComplexBlockPort,\n\t\tUpdatePublishedStatusLabel,\n\t},\n\tprops: {\n\t\t/** @type Block */\n\t\tblock: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(props): {...}\n\t{\n\t\treturn {\n\t\t\ticonSet: Outline,\n\t\t\tblockMediator: new BlockMediator(),\n\t\t};\n\t},\n\tmethods:\n\t{\n\n\t\t...mapActions(useNodeSettingsStore, ['fetchNodeSettings', 'toggleVisibility']),\n\t\tonBlockDblClick(): void\n\t\t{\n\t\t\tthis.toggleVisibility(true);\n\t\t\tthis.fetchNodeSettings(this.block);\n\t\t},\n\t},\n\tcomputed: {\n\t\tisBlockActivated(): boolean\n\t\t{\n\t\t\treturn isBlockActivated(this.block);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<MoveableBlock :block=\"block\">\n\t\t\t<template #default=\"{ isHighlighted, isDragged, isDisabled }\">\n\t\t\t\t<BlockContainer\n\t\t\t\t\t:width=\"200\"\n\t\t\t\t\t:contextMenuItems=\"[\n\t\t\t\t\t\tblockMediator.getCtxMenuItemShowComplexSettings(block),\n\t\t\t\t\t\tblockMediator.getCtxMenuItemDeleteBlock(block),\n\t\t\t\t\t]\"\n\t\t\t\t\t:highlighted=\"isHighlighted\"\n\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t:deactivated=\"!isBlockActivated\"\n\t\t\t\t\t@dblclick.stop=\"blockMediator.showNodeSettings(block)\"\n\t\t\t\t>\n\t\t\t\t\t<BlockLayout\n\t\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t\t:moreMenuItems=\"[\n\t\t\t\t\t\t\tblockMediator.getCtxMenuItemShowComplexSettings(block),\n\t\t\t\t\t\t\tblockMediator.getCtxMenuItemDeleteBlock(block),\n\t\t\t\t\t\t]\"\n\t\t\t\t\t\t:dragged=\"isDragged\"\n\t\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #top-menu>\n\t\t\t\t\t\t\t<DeleteBlockIconBtn\n\t\t\t\t\t\t\t\t:blockId=\"block.id\"\n\t\t\t\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t\t\t\t@deletedBlock=\"blockMediator.hideCurrentBlockSettings($event)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<IconDivider/>\n\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t<template #default>\n\t\t\t\t\t\t\t<BlockComplexContent\n\t\t\t\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<template #header>\n\t\t\t\t\t\t\t\t\t<BlockHeader :block=\"block\">\n\t\t\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t\t\t<BlockIcon\n\t\t\t\t\t\t\t\t\t\t\t\t:iconName=\"block.node.icon\"\n\t\t\t\t\t\t\t\t\t\t\t\t:iconColorIndex=\"block.node.colorIndex\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t</BlockHeader>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<!--\n\t\t\t\t\t\t\t\t<template #addPortPoint=\"{ position }\">\n\t\t\t\t\t\t\t\t\t<AddComplexBlockPort\n\t\t\t\t\t\t\t\t\t\t:position=\"position\"\n\t\t\t\t\t\t\t\t\t\t:highlighted=\"isHighlighted\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t-->\n\t\t\t\t\t\t\t</BlockComplexContent>\n\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t<template #status>\n\t\t\t\t\t\t\t<UpdatePublishedStatusLabel :block=\"block\"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</BlockLayout>\n\t\t\t\t</BlockContainer>\n\t\t\t</template>\n\t\t</MoveableBlock>\n\t`,\n};\n","import { MoveableBlock } from 'ui.block-diagram';\nimport { Outline } from 'ui.icon-set.api.vue';\nimport { Type } from 'main.core';\nimport { isBlockActivated } from '../../../../entities/blocks/utils';\nimport { IconDivider, IconButton } from '../../../../shared/ui';\n// eslint-disable-next-line no-unused-vars\nimport type { Block, BlockId } from '../../../../shared/types';\nimport {\n\tBlockContainer,\n\tBlockLayout,\n\tBlockHeader,\n\tBlockIcon,\n\tPortsInOutCenter,\n} from '../../../../entities/blocks';\nimport {\n\tDeleteBlockIconBtn,\n\tUpdatePublishedStatusLabel,\n} from '../../../../features/blocks';\n\nimport { BlockMediator } from '../../lib';\n\ntype BlockToolSetup = {\n\ticonSet: { [string]: string };\n\tonOpenBlockSettings: (event: MouseEvent) => void;\n};\n\n// @vue/component\nexport const BlockTool = {\n\tname: 'BlockTool',\n\tcomponents: {\n\t\tMoveableBlock,\n\t\tBlockContainer,\n\t\tBlockLayout,\n\t\tBlockHeader,\n\t\tBlockIcon,\n\t\tDeleteBlockIconBtn,\n\t\tUpdatePublishedStatusLabel,\n\t\tIconDivider,\n\t\tIconButton,\n\t\tPortsInOutCenter,\n\t},\n\tprops: {\n\t\t/** @type Block */\n\t\tblock: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(props): BlockToolSetup\n\t{\n\t\treturn {\n\t\t\ticonSet: Outline,\n\t\t\tblockMediator: new BlockMediator(),\n\t\t};\n\t},\n\tmethods: {\n\t\tisUrl(value: string): boolean\n\t\t{\n\t\t\tif (!value || !Type.isString(value))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst u = new URL(value);\n\n\t\t\t\treturn u.protocol === 'https:';\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\n\t\tgetSafeUrl(url: string): string\n\t\t{\n\t\t\tif (!url || !Type.isString(url))\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst u = new URL(url.trim());\n\t\t\t\tif (u.protocol !== 'https:')\n\t\t\t\t{\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\treturn u.href;\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\t\t},\n\n\t\tgetBackgroundImage(url: string): Object\n\t\t{\n\t\t\tconst safeUrl = this.getSafeUrl(url);\n\t\t\tif (!safeUrl)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\t'background-image': `url('${safeUrl}')`,\n\t\t\t};\n\t\t},\n\t},\n\tcomputed: {\n\t\tisBlockActivated(): boolean\n\t\t{\n\t\t\treturn isBlockActivated(this.block);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<MoveableBlock :block=\"block\">\n\t\t\t<template #default=\"{ isHighlighted, isDragged, isDisabled }\">\n\t\t\t\t<BlockContainer\n\t\t\t\t\t:width=\"200\"\n\t\t\t\t\t:highlighted=\"isHighlighted\"\n\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t:deactivated=\"!isBlockActivated\"\n\t\t\t\t\t:contextMenuItems=\"[\n\t\t\t\t\t\tblockMediator.getCtxMenuItemShowSimpleSettings(block),\n\t\t\t\t\t\tblockMediator.getCtxMenuItemDeleteBlock(block),\n\t\t\t\t\t]\"\n\t\t\t\t\t@dblclick.stop=\"blockMediator.showCommonNodeSettings(block)\"\n\t\t\t\t>\n\t\t\t\t\t<BlockLayout\n\t\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t\t:moreMenuItems=\"[\n\t\t\t\t\t\t\tblockMediator.getCtxMenuItemShowSimpleSettings(block),\n\t\t\t\t\t\t\tblockMediator.getCtxMenuItemDeleteBlock(block),\n\t\t\t\t\t\t]\"\n\t\t\t\t\t\t:dragged=\"isDragged\"\n\t\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #top-menu>\n\t\t\t\t\t\t\t<DeleteBlockIconBtn\n\t\t\t\t\t\t\t\t:blockId=\"block.id\"\n\t\t\t\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t\t\t\t@deletedBlock=\"blockMediator.hideCurrentBlockSettings($event)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<IconDivider/>\n\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t<template #default>\n\t\t\t\t\t\t\t<PortsInOutCenter\n\t\t\t\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<BlockHeader :block=\"block\" :subIconExternal=\"isUrl(block.node?.icon)\">\n\t\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t\t<BlockIcon\n\t\t\t\t\t\t\t\t\t\t\t:iconName=\"block.node.icon === 'DATABASE' ? block.node.icon : 'MCP_LETTERS'\"\n\t\t\t\t\t\t\t\t\t\t\t:iconColorIndex=\"0\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t<template #subIcon v-if=\"block.node?.icon && block.node.icon !== 'DATABASE'\">\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tv-if=\"isUrl(block.node.icon)\"\n\t\t\t\t\t\t\t\t\t\t\t:style=\"getBackgroundImage(block.node.icon)\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-selector-item-avatar\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<BlockIcon\n\t\t\t\t\t\t\t\t\t\t\tv-else\n\t\t\t\t\t\t\t\t\t\t\t:iconName=\"block.node.icon\"\n\t\t\t\t\t\t\t\t\t\t\t:iconColorIndex=\"7\"\n\t\t\t\t\t\t\t\t\t\t\t:iconSize=\"24\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</BlockHeader>\n\t\t\t\t\t\t\t</PortsInOutCenter>\n\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t<template #status>\n\t\t\t\t\t\t\t<UpdatePublishedStatusLabel :block=\"block\"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</BlockLayout>\n\t\t\t\t</BlockContainer>\n\t\t\t</template>\n\t\t</MoveableBlock>\n\t`,\n};\n","import { ResizableBlock } from 'ui.block-diagram';\nimport { Outline } from 'ui.icon-set.api.vue';\nimport { isBlockActivated } from '../../../../entities/blocks/utils';\nimport { IconDivider, IconButton } from '../../../../shared/ui';\n// eslint-disable-next-line no-unused-vars\nimport type { Block, BlockId } from '../../../../shared/types';\nimport {\n\tBlockContainer,\n\tBlockLayout,\n\tBlockTopTitle,\n} from '../../../../entities/blocks';\nimport {\n\tDeleteBlockIconBtn,\n\tUpdatePublishedStatusLabel,\n} from '../../../../features/blocks';\n\nimport { BlockMediator } from '../../lib';\n\nexport const BlockFrame = {\n\tname: 'BlockFrame',\n\tcomponents: {\n\t\tResizableBlock,\n\t\tBlockContainer,\n\t\tBlockLayout,\n\t\tBlockTopTitle,\n\t\tDeleteBlockIconBtn,\n\t\tUpdatePublishedStatusLabel,\n\t\tIconDivider,\n\t\tIconButton,\n\t},\n\tprops: {\n\t\t/** @type Block */\n\t\tblock: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(props): {...}\n\t{\n\t\treturn {\n\t\t\ticonSet: Outline,\n\t\t\tblockMediator: new BlockMediator(),\n\t\t};\n\t},\n\tcomputed: {\n\t\tisBlockActivated(): boolean\n\t\t{\n\t\t\treturn isBlockActivated(this.block);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<ResizableBlock :block=\"block\">\n\t\t\t<template #default=\"{ isHighlighted, isResize, isDragged, isDisabled }\">\n\t\t\t\t<BlockContainer\n\t\t\t\t\t:highlighted=\"isHighlighted\"\n\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t:deactivated=\"!isBlockActivated\"\n\t\t\t\t\t:contextMenuItems=\"[\n\t\t\t\t\t\tblockMediator.getCtxMenuItemDeleteBlock(block)\n\t\t\t\t\t]\"\n\t\t\t\t\tcolorName=\"orange\"\n\t\t\t\t>\n\t\t\t\t\t<BlockLayout\n\t\t\t\t\t\t:block=\"block\"\n\t\t\t\t\t\t:moreMenuItems=\"[\n\t\t\t\t\t\t\tblockMediator.getCtxMenuItemDeleteBlock(block)\n\t\t\t\t\t\t]\"\n\t\t\t\t\t\t:dragged=\"isDragged\"\n\t\t\t\t\t\t:resized=\"isResize\"\n\t\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t\t:isActivationVisible=\"false\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #top-menu-title>\n\t\t\t\t\t\t\t<BlockTopTitle :title=\"block.node.title\"/>\n\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t<template #top-menu>\n\t\t\t\t\t\t\t<DeleteBlockIconBtn\n\t\t\t\t\t\t\t\t:blockId=\"block.id\"\n\t\t\t\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t\t\t\t@deletedBlock=\"blockMediator.hideCurrentBlockSettings($event)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<IconDivider/>\n\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t<template #default>\n\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t<template #status>\n\t\t\t\t\t\t\t<UpdatePublishedStatusLabel :block=\"block\"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</BlockLayout>\n\t\t\t\t</BlockContainer>\n\t\t\t</template>\n\t\t</ResizableBlock>\n\t`,\n};\n","import { Outline, Main } from 'ui.icon-set.api.core';\nimport { AirButtonStyle } from 'ui.vue3.components.button';\nimport type { MenuOptions } from 'ui.vue3.components.menu';\nimport { MenuButton } from '../../../../shared/ui';\n\n// @vue/component\nexport const DiagramMenu = {\n\tname: 'DiagramMenu',\n\tcomponents: {\n\t\tMenuButton,\n\t},\n\tsetup(): {...}\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t};\n\t},\n\tmethods: {\n\t\tloc(locString: string): string\n\t\t{\n\t\t\treturn this.$bitrix.Loc.getMessage(locString);\n\t\t},\n\t\tgetDiagramMenu(): MenuOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.loc('BIZPROCDESIGNER_EDITOR_TOP_PANEL_MENU_ACTION_MARKET'),\n\t\t\t\t\t\ticon: Outline.MARKET,\n\t\t\t\t\t\tdesign: 'disabled',\n\t\t\t\t\t\tdisabled: true,\n\t\t\t\t\t\tbadgeText: '',\n\t\t\t\t\t\t// uiButtonOptions: {\n\t\t\t\t\t\t// \tdisabled: true,\n\t\t\t\t\t\t// },\n\t\t\t\t\t},\n\t\t\t\t\t// {\n\t\t\t\t\t// \ttitle: this.loc('BIZPROCDESIGNER_EDITOR_TOP_PANEL_MENU_ACTION_IMPORT_EXPORT'),\n\t\t\t\t\t// \ticon: Main.EXPAND,\n\t\t\t\t\t// \tonClick: () => alert(this.loc('BIZPROCDESIGNER_EDITOR_TOP_PANEL_MENU_ACTION_IMPORT_EXPORT')),\n\t\t\t\t\t// },\n\t\t\t\t],\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<MenuButton\n\t\t\t:buttonStyle=\"AirButtonStyle.OUTLINE_ACCENT_2\"\n\t\t\t:text=\"loc('BIZPROCDESIGNER_EDITOR_TOP_PANEL_MENU_BUTTON')\"\n\t\t\t:options=\"getDiagramMenu()\"\n\t\t/>\n\t`,\n};\n","import { mapState } from 'ui.vue3.pinia';\nimport {\n\tdiagramStore as useDiagramStore,\n\tAutosaveStatus as AutosaveStatusEntity,\n} from '../../../../entities/blocks';\n\n// @vue/component\nexport const AutosaveStatus = {\n\tname: 'AutosaveStatus',\n\tcomponents: {\n\t\tAutosaveStatusEntity,\n\t},\n\tcomputed:\n\t{\n\t\t...mapState(useDiagramStore, ['isOnline']),\n\t},\n\ttemplate: `\n\t\t<AutosaveStatusEntity :isOnline=\"isOnline\"/>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { AirButtonStyle, Button } from 'ui.buttons';\nimport { Dialog } from 'ui.system.dialog';\nimport { mapActions, mapWritableState } from 'ui.vue3.pinia';\nimport { diagramStore as useDiagramStore } from '../../../../entities/blocks';\nimport './style.css';\n\n// @vue/component\nexport const EditTemplateSettingsDialog = {\n\tname: 'EditTemplateSettingsDialog',\n\temits: ['close'],\n\tcomputed: {\n\t\t...mapWritableState(useDiagramStore, [\n\t\t\t'template',\n\t\t]),\n\t},\n\tbeforeMount(): void\n\t{\n\t\tthis.localName = this.template?.NAME ?? '';\n\t\tthis.localDescription = this.template?.DESCRIPTION ?? '';\n\t},\n\tmounted(): void\n\t{\n\t\tthis.getDialog().setContent(this.$refs.content);\n\t\tthis.getDialog().show();\n\t},\n\tunmounted(): void\n\t{\n\t\tthis.instance?.hide();\n\t},\n\tmethods: {\n\t\t...mapActions(useDiagramStore, [\n\t\t\t'updateTemplateData',\n\t\t]),\n\t\tloc(locString: string): string\n\t\t{\n\t\t\treturn this.$bitrix.Loc.getMessage(locString);\n\t\t},\n\t\tgetDialog(): Dialog\n\t\t{\n\t\t\tif (!this.instance)\n\t\t\t{\n\t\t\t\tthis.instance = this.createDialog();\n\t\t\t}\n\n\t\t\treturn this.instance;\n\t\t},\n\t\tcreateDialog(): Dialog\n\t\t{\n\t\t\tconst confirm = new Button({\n\t\t\t\ttext: this.loc('BIZPROCDESIGNER_EDITOR_SETTINGS_BUTTON_SAVE'),\n\t\t\t\tuseAirDesign: true,\n\t\t\t\tstyle: AirButtonStyle.FILLED,\n\t\t\t});\n\n\t\t\tconst cancel = new Button({\n\t\t\t\ttext: this.loc('BIZPROCDESIGNER_EDITOR_SETTINGS_BUTTON_CANCEL'),\n\t\t\t\tuseAirDesign: true,\n\t\t\t\tstyle: AirButtonStyle.OUTLINE,\n\t\t\t});\n\n\t\t\tconst options = {\n\t\t\t\ttitle: this.loc('BIZPROCDESIGNER_EDITOR_SETTINGS_TITLE'),\n\t\t\t\tsubtitle: this.loc('BIZPROCDESIGNER_EDITOR_SETTINGS_DESCRIPTION'),\n\t\t\t\tcenterButtons: [\n\t\t\t\t\tconfirm,\n\t\t\t\t\tcancel,\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\tonHide: this.closePopup,\n\t\t\t\t},\n\t\t\t\twidth: 495,\n\t\t\t};\n\t\t\tconst dialog = new Dialog(options);\n\t\t\tcancel.bindEvent('click', () => {\n\t\t\t\tdialog.hide();\n\t\t\t});\n\t\t\tconfirm.bindEvent('click', () => {\n\t\t\t\tthis.template.NAME =\n\t\t\t\t\tType.isStringFilled(this.localName)\n\t\t\t\t\t\t? this.localName\n\t\t\t\t\t\t: this.loc('BIZPROCDESIGNER_EDITOR_DEFAULT_TITLE')\n\t\t\t\t;\n\t\t\t\tthis.template.DESCRIPTION = this.localDescription;\n\t\t\t\tthis.updateTemplateData({\n\t\t\t\t\tNAME: this.template.NAME,\n\t\t\t\t\tDESCRIPTION: this.template.DESCRIPTION,\n\t\t\t\t});\n\n\t\t\t\tdialog.hide();\n\t\t\t});\n\n\t\t\treturn dialog;\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div ref=\"content\">\n\t\t\t<div class=\"bizproc-template-settings-lable\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_SETTINGS_LABEL') }}\n\t\t\t</div>\n\t\t\t<div class=\"bizproc-template-settings-title\">\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox\">\n\t\t\t\t\t<input\n\t\t\t\t\t\tv-model=\"localName\"\n\t\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_DEFAULT_TITLE')\"\n\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"bizproc-template-settings-description\">\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textarea\">\n\t\t\t\t\t<textarea\n\t\t\t\t\t\tv-model=\"localDescription\"\n\t\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('BIZPROCDESIGNER_EDITOR_DESCRIPTION_PLACEHOLDER')\"\n\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.core';\nimport type { MenuOptions } from 'ui.vue3.components.menu';\nimport { EditTemplateName } from '../../../../features/blocks';\nimport { EditTemplateSettingsDialog } from '../../../../features/blocks/ui/edit-template-settings-dialog/edit-template-settings-dialog';\nconst SECTION_CODE = 'space';\n\n// @vue/component\nexport const TemplateName = {\n\tname: 'TemplateName',\n\tcomponents:\n\t{\n\t\tEditTemplateName,\n\t\tEditTemplateSettingsDialog,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tmethods:\n\t{\n\t\tloc(locString: string): string\n\t\t{\n\t\t\treturn this.$bitrix.Loc.getMessage(locString);\n\t\t},\n\t\tgetMenuItems(): MenuOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsections: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: SECTION_CODE,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.loc('BIZPROCDESIGNER_EDITOR_TOP_PANEL_TITLE_ACTION_SETTINGS'),\n\t\t\t\t\t\ticon: Outline.SETTINGS,\n\t\t\t\t\t\tonClick: this.onOpenSettingsPopup,\n\t\t\t\t\t},\n\t\t\t\t\t// {\n\t\t\t\t\t// \ttitle: this.loc('BIZPROCDESIGNER_EDITOR_TOP_PANEL_TITLE_ACTION_OPEN'),\n\t\t\t\t\t// \ticon: Outline.BULLETED_LIST,\n\t\t\t\t\t// \tsectionCode: SECTION_CODE,\n\t\t\t\t\t// \tonClick: () => alert(this.loc('BIZPROCDESIGNER_EDITOR_TOP_PANEL_TITLE_ACTION_OPEN')),\n\t\t\t\t\t// },\n\t\t\t\t\t// {\n\t\t\t\t\t// \ttitle: this.loc('BIZPROCDESIGNER_EDITOR_TOP_PANEL_TITLE_ACTION_CREATE'),\n\t\t\t\t\t// \ticon: Outline.PLUS_M,\n\t\t\t\t\t// \tsectionCode: SECTION_CODE,\n\t\t\t\t\t// \tonClick: () => alert(this.loc('BIZPROCDESIGNER_EDITOR_TOP_PANEL_TITLE_ACTION_CREATE')),\n\t\t\t\t\t// },\n\t\t\t\t],\n\t\t\t};\n\t\t},\n\t\tonOpenSettingsPopup(): void\n\t\t{\n\t\t\tthis.isPopupShown = true;\n\t\t},\n\t\tonCloseSettingsPopup(): void\n\t\t{\n\t\t\tthis.isPopupShown = false;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<EditTemplateName :dropdownOptions=\"getMenuItems()\"/>\n\t\t<EditTemplateSettingsDialog\n\t\t\tv-if=\"isPopupShown\"\n\t\t\t@close=\"onCloseSettingsPopup\"\n\t\t/>\n\t`,\n};\n","import {\n\tPublishDropdownButton as PublishDropdownButtonFeature,\n\tPublishMainDropdownOption,\n\tPublishUserDropdownOption,\n\tPublishFullDropdownOption,\n} from '../../../../features/blocks';\n\n// @vue/component\nexport const PublishDropdownButton = {\n\tname: 'PublishDropdownButton',\n\tcomponents:\n\t{\n\t\tPublishDropdownButtonFeature,\n\t\tPublishMainDropdownOption,\n\t\tPublishUserDropdownOption,\n\t\tPublishFullDropdownOption,\n\t},\n\ttemplate: `\n\t\t<PublishDropdownButtonFeature>\n\t\t\t<PublishMainDropdownOption/>\n\t\t\t<PublishUserDropdownOption/>\n\t\t\t<PublishFullDropdownOption/>\n\t\t</PublishDropdownButtonFeature>\n\t`,\n};\n","import { mapState, mapActions } from 'ui.vue3.pinia';\nimport {\n\tCommonNodeSettingsForm,\n\tuseCommonNodeSettingsStore,\n} from '../../../../entities/common-node-settings';\nimport {\n\tdiagramStore as useDiagramStore,\n\tBlockIcon,\n} from '../../../../entities/blocks';\nimport { useAppStore } from '../../../../entities/app';\n\n// @vue/components\nexport const CommonNodeSettings = {\n\tname: 'CommonNodeSettings',\n\tcomponents: {\n\t\tCommonNodeSettingsForm,\n\t\tBlockIcon,\n\t},\n\tcomputed: {\n\t\t...mapState(useCommonNodeSettingsStore, [\n\t\t\t'isVisible',\n\t\t\t'block',\n\t\t]),\n\t\t...mapState(useDiagramStore, [\n\t\t\t'documentType',\n\t\t]),\n\t},\n\tmethods: {\n\t\t...mapActions(useAppStore, ['hideRightPanel', 'setShowPreviewPanel']),\n\t\t...mapActions(useCommonNodeSettingsStore, ['hideSettings']),\n\t\tonCloseSettings(): void\n\t\t{\n\t\t\tthis.hideSettings();\n\t\t\tthis.hideRightPanel();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<CommonNodeSettingsForm\n\t\t\tv-if=\"isVisible\"\n\t\t\t:block=\"block\"\n\t\t\t:documentType=\"documentType\"\n\t\t\t@close=\"onCloseSettings\"\n\t\t\t@showPreview=\"setShowPreviewPanel\"\n\t\t>\n\t\t\t<template #header-icon>\n\t\t\t\t<BlockIcon\n\t\t\t\t\t:iconName=\"block?.node?.icon\"\n\t\t\t\t\t:iconColorIndex=\"block?.node?.colorIndex\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</CommonNodeSettingsForm>\n\t`,\n};\n","import { storeToRefs } from 'ui.vue3.pinia';\nimport { BurgerBtn, useCatalogStore } from '../../../../entities/catalog';\n\ntype FixedCatalogBurgerBtnSetup = {\n\tisFixedCatalog: boolean,\n\ttoggleFixedCatalog: () => void,\n};\n\n// @vue/component\nexport const FixedCatalogBurgerBtn = {\n\tname: 'fixed-catalog-burger-btn',\n\tcomponents: {\n\t\tBurgerBtn,\n\t},\n\tsetup(): FixedCatalogBurgerBtnSetup\n\t{\n\t\tconst catalogStore = useCatalogStore();\n\t\tconst { isFixedCatalog } = storeToRefs(catalogStore);\n\n\t\treturn {\n\t\t\tisFixedCatalog,\n\t\t\ttoggleFixedCatalog: catalogStore.toggleFixedCatalog,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<BurgerBtn\n\t\t\t:opened=\"isFixedCatalog\"\n\t\t\t@click=\"toggleFixedCatalog\"\n\t\t/>\n\t`,\n};\n","import { storeToRefs } from 'ui.vue3.pinia';\nimport {\n\tCatalogLayout,\n\tuseCatalogStore,\n} from '../../../../entities/catalog';\n\ntype HoverCatalogLayoutSetup = {\n\tisExpandedCatalog: boolean,\n\tisShowSearchResults: boolean,\n\tonMouseOver: () => void,\n\tonMouseLeave: () => void,\n};\n\n// @vue/component\nexport const HoverCatalogLayout = {\n\tname: 'HoverCatalogLayout',\n\tcomponents: {\n\t\tCatalogLayout,\n\t},\n\tsetup(): HoverCatalogLayoutSetup\n\t{\n\t\tconst catalogStore = useCatalogStore();\n\t\tconst { isExpandedCatalog, isShowSearchResults } = storeToRefs(catalogStore);\n\n\t\tfunction onMouseOver(): void\n\t\t{\n\t\t\tcatalogStore.expandCatalog();\n\t\t}\n\n\t\tfunction onMouseLeave(): void\n\t\t{\n\t\t\tcatalogStore.collapseCatalog();\n\t\t}\n\n\t\treturn {\n\t\t\tisExpandedCatalog,\n\t\t\tisShowSearchResults,\n\t\t\tonMouseOver,\n\t\t\tonMouseLeave,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<CatalogLayout\n\t\t\t:hasSearchResults=\"isShowSearchResults\"\n\t\t\t:expanded=\"isExpandedCatalog\"\n\t\t\t@mouseover=\"onMouseOver\"\n\t\t\t@mouseleave=\"onMouseLeave\"\n\t\t>\n\t\t\t<template #header>\n\t\t\t\t<slot name=\"header\"/>\n\t\t\t</template>\n\n\t\t\t<template #search>\n\t\t\t\t<slot name=\"search\"/>\n\t\t\t</template>\n\n\t\t\t<template #content>\n\t\t\t\t<slot name=\"content\"/>\n\t\t\t</template>\n\n\t\t\t<template #search-results>\n\t\t\t\t<slot name=\"search-results\"/>\n\t\t\t</template>\n\n\t\t\t<template #footer>\n\t\t\t\t<slot name=\"footer\"/>\n\t\t\t</template>\n\t\t</CatalogLayout>\n\t`,\n};\n","import './search-catalog-items-input.css';\nimport {\n\tmapWritableState,\n\tmapActions,\n} from 'ui.vue3.pinia';\nimport {\n\tHeaderSearchLayoutSetup,\n\tTextInput,\n\tuseCatalogStore,\n} from '../../../../entities/catalog';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\n\n// @vue/component\nexport const SearchCatalogItemsInput = {\n\tname: 'SearchCatalogItemsInput',\n\tcomponents: {\n\t\tTextInput,\n\t\tBIcon,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tisFocused: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapWritableState(useCatalogStore, [\n\t\t\t'searchText',\n\t\t\t'canSearch',\n\t\t]),\n\t\ticonColor(): string\n\t\t{\n\t\t\treturn this.isFocused || this.searchText.length > 0\n\t\t\t\t? 'var(--ui-color-accent-main-primary)'\n\t\t\t\t: 'var(--ui-color-gray-50)'\n\t\t\t;\n\t\t},\n\t\tshowClearButton(): boolean\n\t\t{\n\t\t\treturn this.isFocused || this.searchText.length > 0;\n\t\t},\n\t},\n\twatch: {\n\t\tcanSearch(value: boolean): void\n\t\t{\n\t\t\tif (!value)\n\t\t\t{\n\t\t\t\tthis.hideFoundedGroupItems();\n\t\t\t\tthis.resetCurrentGroup();\n\t\t\t}\n\t\t},\n\t},\n\tsetup(props)\n\t{\n\t\treturn {\n\t\t\ticonSet: Outline,\n\t\t};\n\t},\n\tmethods: {\n\t\t...mapActions(useCatalogStore, [\n\t\t\t'hideFoundedGroupItems',\n\t\t\t'resetCurrentGroup',\n\t\t]),\n\t\tonInputSearchText(input: string): void\n\t\t{\n\t\t\tthis.searchText = input;\n\t\t},\n\t\tonClear(): void\n\t\t{\n\t\t\tthis.searchText = '';\n\t\t},\n\t\tonFocus(): void\n\t\t{\n\t\t\tthis.isFocused = true;\n\t\t},\n\t\tonBlur(): void\n\t\t{\n\t\t\tthis.isFocused = false;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BIcon\n\t\t\t:name=\"iconSet.SEARCH\"\n\t\t\t:size=\"24\"\n\t\t\t:color=\"iconColor\"\n\t\t\tclass=\"ui-node-catalog-icon\"\n\t\t/>\n\t\t<TextInput\n\t\t\t:modelValue=\"searchText\"\n\t\t\t@update:modelValue=\"onInputSearchText\"\n\t\t\t@focus=\"onFocus\"\n\t\t\t@blur=\"onBlur\"\n\t\t/>\n\t\t<button\n\t\t\tv-if=\"showClearButton\"\n\t\t\tclass=\"editor-chart-catalog-input__clear-btn\"\n\t\t\t@click=\"onClear\"\n\t\t>\n\t\t\t<BIcon\n\t\t\t\t:name=\"iconSet.CROSS_L\"\n\t\t\t\t:size=\"24\"\n\t\t\t\tclass=\"ui-block-diagram-search-input__clear-btn-icon\"\n\t\t\t/>\n\t\t</button>\n\t`,\n};\n","import { storeToRefs } from 'ui.vue3.pinia';\nimport { computed } from 'ui.vue3';\nimport {\n\tCatalogGroup,\n\tuseCatalogStore,\n} from '../../../../entities/catalog';\nimport type { CatalogMenuGroup } from '../../../../entities/catalog';\n\ntype ChangeCatalogGroupSetup = {\n\tisShowItems: boolean,\n\tonChangeGroup: (group: CatalogMenuGroup) => void,\n};\n\n// @vue/component\nexport const ChangeCatalogGroup = {\n\tname: 'ChangeCatalogGroup',\n\tcomponents: {\n\t\tCatalogGroup,\n\t},\n\tprops: {\n\t\t/** @type CatalogMenuGroup */\n\t\tgroup: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(props): ChangeCatalogGroupSetup\n\t{\n\t\tconst catalogStore = useCatalogStore();\n\t\tconst { currentGroup } = storeToRefs(catalogStore);\n\n\t\tconst isShowItems = computed((): boolean => {\n\t\t\treturn props.group.id === currentGroup?.value?.id;\n\t\t});\n\n\t\treturn {\n\t\t\tisShowItems,\n\t\t\tonChangeGroup: catalogStore.changeCurrentGroup,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<CatalogGroup\n\t\t\t:group=\"group\"\n\t\t\t:showItems=\"isShowItems\"\n\t\t\t@changeGroup=\"onChangeGroup\"\n\t\t>\n\t\t\t<template #icon>\n\t\t\t\t<slot name=\"icon\"/>\n\t\t\t</template>\n\n\t\t\t<template #back>\n\t\t\t\t<slot name=\"back\"/>\n\t\t\t</template>\n\n\t\t\t<template #items>\n\t\t\t\t<slot name=\"items\"/>\n\t\t\t</template>\n\n\t\t\t<template #empty-label>\n\t\t\t\t<slot name=\"empty-label\"/>\n\t\t\t</template>\n\t\t</CatalogGroup>\n\t`,\n};\n","import {\n\tCatalogGroupBackBtn,\n\tuseCatalogStore,\n} from '../../../../entities/catalog';\n\ntype BackToGroupsBtnSetup = {\n\tonResetCurrentGroup: () => void,\n};\n\n// @vue/component\nexport const BackToGroupsBtn = {\n\tname: 'back-to-groups-btn',\n\tcomponents: {\n\t\tCatalogGroupBackBtn,\n\t},\n\tprops: {\n\t\tgroupTitle: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tcollapsed: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(): BackToGroupsBtnSetup\n\t{\n\t\tconst catalogStore = useCatalogStore();\n\n\t\tfunction onResetCurrentGroup(): void\n\t\t{\n\t\t\tcatalogStore.resetCurrentGroup();\n\t\t\tcatalogStore.resetHighlightedItem();\n\t\t\tcatalogStore.hideFoundedGroupItems();\n\t\t}\n\n\t\treturn {\n\t\t\tonResetCurrentGroup,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<CatalogGroupBackBtn\n\t\t\t:groupTitle=\"groupTitle\"\n\t\t\t:collapsed=\"collapsed\"\n\t\t\t@click=\"onResetCurrentGroup\"\n\t\t>\n\t\t\t<template #icon>\n\t\t\t\t<slot name=\"icon\"/>\n\t\t\t</template>\n\t\t</CatalogGroupBackBtn>\n\t`,\n};\n","import { mapActions } from 'ui.vue3.pinia';\nimport {\n\tCatalogItem,\n\tuseCatalogStore,\n\tgetDragItemSlotName,\n} from '../../../../entities/catalog';\nimport type {\n\tGetDragItemSlotName,\n\t// eslint-disable-next-line no-unused-vars\n\tCatalogMenuItem,\n} from '../../../../entities/catalog';\n\n// @vue/component\nexport const ChangeFoundedCatalogItem = {\n\tname: 'ChangeFoundedCatalogItem',\n\tcomponents: {\n\t\tCatalogItem,\n\t},\n\tprops: {\n\t\t/** @type CatalogMenuItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Record<string, GetDragItemSlotName>\n\t{\n\t\treturn {\n\t\t\tgetDragItemSlotName,\n\t\t};\n\t},\n\tmethods: {\n\t\t...mapActions(useCatalogStore, [\n\t\t\t'changeCurrentGroup',\n\t\t\t'showFoundedGroupItems',\n\t\t\t'setHighlightedItem',\n\t\t]),\n\t\tonChangeItem(): void\n\t\t{\n\t\t\tthis.changeCurrentGroup(this.item.parentGroup);\n\t\t\tthis.showFoundedGroupItems();\n\t\t\tthis.setHighlightedItem(this.item.id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<CatalogItem\n\t\t\t:item=\"item\"\n\t\t\t@dblclick=\"onChangeItem\"\n\t\t>\n\t\t\t<template #[getDragItemSlotName(item.type)]=\"{ item }\">\n\t\t\t\t<slot\n\t\t\t\t\t:name=\"getDragItemSlotName(item.type)\"\n\t\t\t\t\t:item=\"item\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</CatalogItem>\n\t`,\n};\n","import { mapActions, mapGetters } from 'ui.vue3.pinia';\nimport { CatalogGroup, useCatalogStore } from '../../../../entities/catalog';\n// eslint-disable-next-line no-unused-vars\nimport type { CatalogMenuGroup } from '../../../../entities/catalog';\n\n// @vue/component\nexport const ChangeFoundedCatalogGroup = {\n\tname: 'ChangeFoundedCatalogGroup',\n\tcomponents: {\n\t\tCatalogGroup,\n\t},\n\tprops: {\n\t\t/** @type CatalogMenuGroup */\n\t\tgroup: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters(useCatalogStore, [\n\t\t\t'searchResults',\n\t\t]),\n\t},\n\tmethods: {\n\t\t...mapActions(useCatalogStore, [\n\t\t\t'showFoundedGroupItems',\n\t\t\t'changeCurrentGroup',\n\t\t\t'setHighlightedItem',\n\t\t]),\n\t\tonChangeGroup(): void\n\t\t{\n\t\t\tthis.showFoundedGroupItems();\n\t\t\tthis.changeCurrentGroup(this.group);\n\t\t\tthis.setHighlightedItem(\n\t\t\t\tthis.searchResults.items.map((item) => item.id),\n\t\t\t);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<CatalogGroup\n\t\t\t:group=\"group\"\n\t\t\t:showItems=\"false\"\n\t\t\t@changeGroup=\"onChangeGroup\"\n\t\t>\n\t\t\t<template #icon>\n\t\t\t\t<slot name=\"icon\"/>\n\t\t\t</template>\n\t\t</CatalogGroup>\n\t`,\n};\n","import { storeToRefs } from 'ui.vue3.pinia';\nimport {\n\tHeaderLayout,\n\tHeaderLogo,\n\tCatalogGroupList,\n\tCatalogGroup,\n\tCatalogGroupEmptyLabel,\n\tCatalogGroupIcon,\n\tCatalogItem,\n\tSearchResultsLayout,\n\tSearchResultsLabel,\n\tSearchResultsEmptyLabel,\n\tuseCatalogStore,\n\tgetDragItemSlotName,\n} from '../../../../entities/catalog';\nimport type {\n\tCatalogMenuGroup,\n\tCatalogMenuItem,\n\tCatalogMenuItemId,\n\tGetDragItemSlotName,\n\tSearchResults,\n} from '../../../../entities/catalog';\nimport {\n\tHoverCatalogLayout,\n\tFixedCatalogBurgerBtn,\n\tSearchCatalogItemsInput,\n\tChangeCatalogGroup,\n\tChangeFoundedCatalogGroup,\n\tChangeFoundedCatalogItem,\n\tBackToGroupsBtn,\n} from '../../../../features/catalog';\n\ntype CatalogSetup = {\n\tisExpandedCatalog: boolean,\n\tsearchResultsCount: number,\n\tsearchResults: SearchResults,\n\tcurrentGroup: CatalogMenuGroup | null,\n\tcurrentItem: CatalogMenuItem | null,\n\tgroups: Array<CatalogMenuGroup>,\n\thighlightedItems: Set<CatalogMenuItemId>,\n\tgetDragItemSlotName: GetDragItemSlotName,\n};\n\n// @vue/component\nexport const Catalog = {\n\tname: 'CatalogWidget',\n\tcomponents: {\n\t\tHoverCatalogLayout,\n\t\tHeaderLogo,\n\t\tHeaderLayout,\n\t\tCatalogGroupList,\n\t\tCatalogGroup,\n\t\tCatalogGroupEmptyLabel,\n\t\tCatalogGroupIcon,\n\t\tCatalogItem,\n\t\tSearchResultsLayout,\n\t\tSearchResultsLabel,\n\t\tSearchResultsEmptyLabel,\n\t\tFixedCatalogBurgerBtn,\n\t\tSearchCatalogItemsInput,\n\t\tChangeCatalogGroup,\n\t\tChangeFoundedCatalogGroup,\n\t\tChangeFoundedCatalogItem,\n\t\tBackToGroupsBtn,\n\t},\n\tsetup(): CatalogSetup\n\t{\n\t\tconst catalogStore = useCatalogStore();\n\t\tconst {\n\t\t\tisExpandedCatalog,\n\t\t\tgroups,\n\t\t\tcurrentGroup,\n\t\t\tcurrentItem,\n\t\t\tsearchResultsCount,\n\t\t\tsearchResults,\n\t\t\thighlightedItems,\n\t\t} = storeToRefs(catalogStore);\n\n\t\treturn {\n\t\t\tisExpandedCatalog,\n\t\t\tsearchResultsCount,\n\t\t\tsearchResults,\n\t\t\tcurrentGroup,\n\t\t\tcurrentItem,\n\t\t\tgroups,\n\t\t\thighlightedItems,\n\t\t\tgetDragItemSlotName,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<HoverCatalogLayout>\n\t\t\t<template #header>\n\t\t\t\t<HeaderLayout :expanded=\"isExpandedCatalog\">\n\t\t\t\t\t<template #switcher>\n\t\t\t\t\t\t<FixedCatalogBurgerBtn/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template #logo>\n\t\t\t\t\t\t<HeaderLogo/>\n\t\t\t\t\t</template>\n\t\t\t\t</HeaderLayout>\n\t\t\t</template>\n\n\t\t\t<template #search>\n\t\t\t\t<SearchCatalogItemsInput/>\n\t\t\t</template>\n\n\t\t\t<template #content>\n\t\t\t\t<CatalogGroupList\n\t\t\t\t\t:groups=\"groups\"\n\t\t\t\t\t:currentGroup=\"currentGroup\"\n\t\t\t\t>\n\t\t\t\t\t<template #group=\"{ group }\">\n\t\t\t\t\t\t<ChangeCatalogGroup :group=\"group\">\n\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t<CatalogGroupIcon :iconName=\"group.icon\"/>\n\t\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t\t<template #back>\n\t\t\t\t\t\t\t\t<BackToGroupsBtn\n\t\t\t\t\t\t\t\t\t:groupTitle=\"group.title\"\n\t\t\t\t\t\t\t\t\t:collapsed=\"!isExpandedCatalog\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t\t<CatalogGroupIcon :iconName=\"group.icon\"/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</BackToGroupsBtn>\n\t\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t\t<template #items>\n\t\t\t\t\t\t\t\t<CatalogItem\n\t\t\t\t\t\t\t\t\tv-for=\"item in group.items\"\n\t\t\t\t\t\t\t\t\t:key=\"item.id\"\n\t\t\t\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t\t\t\t:active=\"highlightedItems.has(item.id) && isExpandedCatalog\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<template #[getDragItemSlotName(item.type)]=\"{ item }\">\n\t\t\t\t\t\t\t\t\t\t<slot\n\t\t\t\t\t\t\t\t\t\t\t:name=\"getDragItemSlotName(item.type)\"\n\t\t\t\t\t\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</CatalogItem>\n\t\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t\t<template #empty-label>\n\t\t\t\t\t\t\t\t<CatalogGroupEmptyLabel/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</ChangeCatalogGroup>\n\t\t\t\t\t</template>\n\t\t\t\t</CatalogGroupList>\n\t\t\t</template>\n\n\t\t\t<template #search-results>\n\t\t\t\t<SearchResultsLayout\n\t\t\t\t\t:groups=\"searchResults.groups\"\n\t\t\t\t\t:items=\"searchResults.items\"\n\t\t\t\t\t:collapsed=\"!isExpandedCatalog\"\n\t\t\t\t>\n\n\t\t\t\t\t<template #group=\"{ group }\">\n\t\t\t\t\t\t<ChangeFoundedCatalogGroup :group=\"group\">\n\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t<CatalogGroupIcon :iconName=\"group.icon\"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</ChangeFoundedCatalogGroup>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #item=\"{ item }\">\n\t\t\t\t\t\t<ChangeFoundedCatalogItem :item=\"item\">\n\t\t\t\t\t\t\t<template #[getDragItemSlotName(item.type)]=\"{ item }\">\n\t\t\t\t\t\t\t\t<slot\n\t\t\t\t\t\t\t\t\t:name=\"getDragItemSlotName(item.type)\"\n\t\t\t\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</ChangeFoundedCatalogItem>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #empty-label>\n\t\t\t\t\t\t<SearchResultsEmptyLabel/>\n\t\t\t\t\t</template>\n\t\t\t\t</SearchResultsLayout>\n\t\t\t</template>\n\n\t\t\t<template #footer>\n\t\t\t\t<slot name=\"footer\"/>\n\t\t\t</template>\n\t\t</HoverCatalogLayout>\n\t`,\n};\n","import { mapState } from 'ui.vue3.pinia';\nimport {\n\tAppLayout as AppLayoutEntity,\n\tuseAppStore,\n} from '../../../../entities/app';\n\n// @vue/component\nexport const AppLayout = {\n\tname: 'AppLayoutWidget',\n\tcomponents: {\n\t\tAppLayoutEntity,\n\t},\n\tcomputed: {\n\t\t...mapState(useAppStore, [\n\t\t\t'isShownRightPanel',\n\t\t\t'isShownPreviewPanel',\n\t\t]),\n\t},\n\ttemplate: `\n\t\t<AppLayoutEntity\n\t\t\t:showSettings=\"isShownRightPanel\"\n\t\t\t:showPreviewPanel=\"isShownPreviewPanel\"\n\t\t>\n\t\t\t<template #header>\n\t\t\t\t<slot name=\"header\"/>\n\t\t\t</template>\n\n\t\t\t<template #diagram>\n\t\t\t\t<slot name=\"diagram\"/>\n\t\t\t</template>\n\n\t\t\t<template #catalog>\n\t\t\t\t<slot name=\"catalog\"/>\n\t\t\t</template>\n\n\t\t\t<template #top-right-toolbar>\n\t\t\t\t<slot name=\"top-right-toolbar\"/>\n\t\t\t</template>\n\n\t\t\t<template #bottom-right-toolbar>\n\t\t\t\t<slot name=\"bottom-right-toolbar\"/>\n\t\t\t</template>\n\n\t\t\t<template #settings>\n\t\t\t\t<slot name=\"settings\"/>\n\t\t\t</template>\n\t\t</AppLayoutEntity>\n\t`,\n};\n","import { storeToRefs } from 'ui.vue3.pinia';\nimport {\n\tAppHeader as AppHeaderEntity,\n\tAppHeaderDivider,\n\tLogoLayout,\n\tLogoBackBtn,\n\tLogoTitle,\n} from '../../../../entities/app';\nimport {\n\tdiagramStore as useDiagramStore,\n} from '../../../../entities/blocks';\n\n// @vue/component\nexport const AppHeader = {\n\tname: 'AppHeader',\n\tcomponents: {\n\t\tAppHeaderEntity,\n\t\tAppHeaderDivider,\n\t\tLogoLayout,\n\t\tLogoBackBtn,\n\t\tLogoTitle,\n\t},\n\tsetup(): {...}\n\t{\n\t\tconst diagramStore = useDiagramStore();\n\t\tconst { companyName } = storeToRefs(diagramStore);\n\n\t\treturn {\n\t\t\tcompanyName,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<AppHeaderEntity>\n\t\t\t<template #left>\n\t\t\t\t<LogoLayout>\n\t\t\t\t\t<template #back-btn>\n\t\t\t\t\t\t<LogoBackBtn/>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #title>\n\t\t\t\t\t\t<LogoTitle :companyName=\"companyName\"/>\n\t\t\t\t\t</template>\n\t\t\t\t</LogoLayout>\n\t\t\t</template>\n\n\t\t\t<template #right>\n\t\t\t\t<slot name=\"templateName\"/>\n\t\t\t\t<AppHeaderDivider/>\n\t\t\t\t<slot name=\"autosaveStatus\"/>\n\t\t\t\t<AppHeaderDivider/>\n\t\t\t\t<slot name=\"diagramMenu\"/>\n\t\t\t\t<slot name=\"publishButton\"/>\n\t\t\t</template>\n\t\t</AppHeaderEntity>\n\t`,\n};\n","import './design-tokens.css';\nimport { markRaw, ref } from 'ui.vue3';\nimport {\n\tZoomBar,\n\tHistoryBar,\n\tuseHistory,\n\tuseAnimationQueue,\n} from 'ui.block-diagram';\nimport { mapWritableState } from 'ui.vue3.pinia';\nimport { FeatureCode } from 'bizprocdesigner.feature';\nimport { initAiUpdatePull } from './entities/ai-assistant/api/pull';\nimport { makeAnimationQueue } from './entities/ai-assistant/util/animation';\nimport { NodeSettings as ComplexNodeSettings, NodeSettingsRules } from './widgets/node-settings';\nimport { diagramStore, BLOCK_SLOT_NAMES, CONNECTION_SLOT_NAMES, ConnectionAux } from './entities/blocks';\nimport { useCatalogStore, DRAG_ITEM_SLOT_NAMES } from './entities/catalog';\nimport { SearchBar } from './shared/ui/search-bar/search-bar';\n\nimport type { BlockId } from './entities/blocks';\n\nimport {\n\tBlockDiagram,\n\tBlockSimple,\n\tBlockTrigger,\n\tBlockComplex,\n\tBlockTool,\n\tBlockFrame,\n\tDiagramMenu,\n\tAutosaveStatus,\n\tTemplateName,\n\tPublishDropdownButton,\n} from './widgets/blocks';\nimport {\n\tCommonNodeSettings,\n} from './widgets/common-node-settings';\nimport { Catalog } from './widgets/catalog';\nimport { AppLayout, AppHeader } from './widgets/app';\n\nimport 'ui.icon-set.outline';\nimport { updateIdUrl, handleResponseError } from './shared/utils';\n\nimport 'ui.design-tokens';\n\n// @vue/component\nexport const Chart = {\n\tcomponents: {\n\t\tAppLayout,\n\t\tAppHeader,\n\t\tBlockDiagram,\n\t\tBlockSimple,\n\t\tBlockTrigger,\n\t\tBlockComplex,\n\t\tBlockTool,\n\t\tBlockFrame,\n\t\tDiagramMenu,\n\t\tAutosaveStatus,\n\t\tTemplateName,\n\t\tPublishDropdownButton,\n\t\tZoomBar,\n\t\tComplexNodeSettings,\n\t\tNodeSettingsRules,\n\t\tHistoryBar,\n\t\tSearchBar,\n\t\tCatalog,\n\t\tCommonNodeSettings,\n\t\tConnectionAux,\n\t},\n\tprovide(): {onBlockClick: (event: Event) => void}\n\t{\n\t\treturn {\n\t\t\tonBlockClick: this.handleBlockClick,\n\t\t\tshowBlockSettings: this.showBlockSettings,\n\t\t\tonToggleBlockActivation: this.handleToggleBlockActivation,\n\t\t};\n\t},\n\tprops: {\n\t\tinitTemplateId: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\tinitDocumentType: {\n\t\t\ttype: Array, // todo: add type\n\t\t\tdefault: null,\n\t\t},\n\t\tinitStartTrigger: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tsetup(props): {...}\n\t{\n\t\tconst catalogStore = useCatalogStore();\n\t\tdiagramStore().initEventListeners();\n\t\tconst { makeSnapshot, setHandlers, commonSnapshotHandler, commonRevertHandler } = useHistory();\n\t\tconst isDiagramDisabled = ref(true);\n\t\tconst snapshotHandler = (newState) => {\n\t\t\treturn {\n\t\t\t\t...commonSnapshotHandler(newState),\n\t\t\t\tblockCurrentTimestamps: markRaw(JSON.parse(JSON.stringify(diagramStore().blockCurrentTimestamps))),\n\t\t\t};\n\t\t};\n\n\t\tconst revertHandler = (snapshot) => {\n\t\t\tcommonRevertHandler(snapshot);\n\t\t\tdiagramStore().setBlockCurrentTimestamps(snapshot.blockCurrentTimestamps);\n\t\t};\n\t\tsetHandlers({ snapshotHandler, revertHandler });\n\n\t\tconst animationQueue = useAnimationQueue();\n\n\t\tasync function initApp()\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait Promise.all([\n\t\t\t\t\tdiagramStore().refreshDiagramData(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttemplateId: props.initTemplateId,\n\t\t\t\t\t\t\tdocumentType: props.initDocumentType,\n\t\t\t\t\t\t\tstartTrigger: props.initStartTrigger,\n\t\t\t\t\t\t},\n\t\t\t\t\t),\n\t\t\t\t\tcatalogStore.init(),\n\t\t\t\t]);\n\n\t\t\t\tinitAiUpdatePull(({ blocks, connections, draftId, templateId }) => {\n\t\t\t\t\tif (diagramStore().draftId === 0 && diagramStore().templateId === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (draftId !== diagramStore().draftId || templateId !== diagramStore().templateId)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tdiagramStore().updateExistedBlockProperties(blocks);\n\t\t\t\t\tconst animatedItems = makeAnimationQueue(\n\t\t\t\t\t\tdiagramStore().blocks,\n\t\t\t\t\t\tdiagramStore().connections,\n\t\t\t\t\t\tblocks,\n\t\t\t\t\t\tconnections,\n\t\t\t\t\t);\n\n\t\t\t\t\tanimationQueue.start({ items: animatedItems });\n\t\t\t\t});\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\thandleResponseError(error);\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tisDiagramDisabled.value = false;\n\t\t\t}\n\n\t\t\tmakeSnapshot();\n\t\t}\n\n\t\tinitApp();\n\n\t\treturn {\n\t\t\tisDiagramDisabled,\n\t\t\tmakeSnapshot,\n\t\t\tFeatureCode,\n\t\t\tblockDiagramSlotNames: BLOCK_SLOT_NAMES,\n\t\t\tconnectionSlotNames: CONNECTION_SLOT_NAMES,\n\t\t\tdragItemSlotNames: DRAG_ITEM_SLOT_NAMES,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\t...mapWritableState(\n\t\t\tdiagramStore,\n\t\t\t[\n\t\t\t\t'documentTypeSigned',\n\t\t\t\t'templateId',\n\t\t\t],\n\t\t),\n\t},\n\twatch: {\n\t\ttemplateId(value)\n\t\t{\n\t\t\tif (value > 0)\n\t\t\t{\n\t\t\t\tupdateIdUrl(value);\n\t\t\t}\n\t\t},\n\t},\n\tmethods: {\n\t\thandleToggleBlockActivation(blockId: BlockId): void\n\t\t{\n\t\t\tdiagramStore().toggleBlockActivation(blockId);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<AppLayout>\n\t\t\t<template #header>\n\t\t\t\t<AppHeader>\n\t\t\t\t\t<template #templateName>\n\t\t\t\t\t\t<TemplateName/>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #autosaveStatus>\n\t\t\t\t\t\t<AutosaveStatus/>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #diagramMenu>\n\t\t\t\t\t\t<DiagramMenu/>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #publishButton>\n\t\t\t\t\t\t<PublishDropdownButton/>\n\t\t\t\t\t</template>\n\t\t\t\t</AppHeader>\n\t\t\t</template>\n\n\t\t\t<template #diagram>\n\t\t\t\t<BlockDiagram :disabled=\"isDiagramDisabled\">\n\t\t\t\t\t<template #[blockDiagramSlotNames.SIMPLE]=\"{ block }\">\n\t\t\t\t\t\t<BlockSimple :block=\"block\"/>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #[blockDiagramSlotNames.TRIGGER]=\"{ block }\">\n\t\t\t\t\t\t<BlockTrigger :block=\"block\"/>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #[blockDiagramSlotNames.COMPLEX]=\"{ block }\">\n\t\t\t\t\t\t<BlockComplex :block=\"block\"/>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #[blockDiagramSlotNames.TOOL]=\"{ block }\">\n\t\t\t\t\t\t<BlockTool :block=\"block\"/>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #[blockDiagramSlotNames.FRAME]=\"{ block }\">\n\t\t\t\t\t\t<BlockFrame :block=\"block\"/>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #[connectionSlotNames.AUX]=\"{ connection }\">\n\t\t\t\t\t\t<ConnectionAux :connection=\"connection\" />\n\t\t\t\t\t</template>\n\t\t\t\t</BlockDiagram>\n\t\t\t</template>\n\n\t\t\t<template #catalog>\n\t\t\t\t<Catalog>\n\t\t\t\t\t<template #[dragItemSlotNames.simple]=\"{ item }\">\n\t\t\t\t\t\t<BlockSimple\n\t\t\t\t\t\t\t:block=\"item\"\n\t\t\t\t\t\t\tautosize\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #[dragItemSlotNames.trigger]=\"{ item }\">\n\t\t\t\t\t\t<BlockTrigger\n\t\t\t\t\t\t\t:block=\"item\"\n\t\t\t\t\t\t\tautosize\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #[dragItemSlotNames.complex]=\"{ item }\">\n\t\t\t\t\t\t<BlockComplex :block=\"item\"/>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #[dragItemSlotNames.tool]=\"{ item }\">\n\t\t\t\t\t\t<BlockTool :block=\"item\"/>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #[dragItemSlotNames.frame]=\"{ item }\">\n\t\t\t\t\t\t<BlockFrame :block=\"item\"/>\n\t\t\t\t\t</template>\n\t\t\t\t</Catalog>\n\t\t\t</template>\n\n\t\t\t<template #top-right-toolbar>\n\t\t\t\t<HistoryBar/>\n\t\t\t\t<SearchBar/>\n\t\t\t</template>\n\n\t\t\t<template #bottom-right-toolbar>\n\t\t\t\t<ZoomBar :stepZoom=\"0.2\"/>\n\t\t\t</template>\n\n\t\t\t<template #settings>\n\t\t\t\t<CommonNodeSettings/>\n\n\t\t\t\t<ComplexNodeSettings>\n\t\t\t\t\t<NodeSettingsRules />\n\t\t\t\t</ComplexNodeSettings>\n\t\t\t</template>\n\t\t</AppLayout>\n\t`,\n};\n","import { BitrixVue } from 'ui.vue3';\nimport { createPinia } from 'ui.vue3.pinia';\nimport { Chart } from './app';\n\nconst TestId = {\n\tinstall(app) {\n\t\t// eslint-disable-next-line no-param-reassign\n\t\tapp.config.globalProperties.$testId = (id: string, ...args: Array<string>): string => {\n\t\t\tif (!id)\n\t\t\t{\n\t\t\t\tthrow new Error('bizprocdesiner: not found test id');\n\t\t\t}\n\n\t\t\tconst preparedArgs = args.reduce((acc, arg) => {\n\t\t\t\treturn `${acc}-${arg}`;\n\t\t\t}, '');\n\n\t\t\treturn `${id}${preparedArgs}`;\n\t\t};\n\t},\n};\n\nexport class App\n{\n\tstatic mount(containerId: string, rootProps?: {[key: string]: any} | null): void\n\t{\n\t\tconst container = document.getElementById(containerId);\n\t\tconst app = BitrixVue.createApp(Chart, rootProps);\n\t\tconst store = createPinia();\n\t\tapp.use(store);\n\t\tapp.use(TestId);\n\t\tapp.provide('debug', false);\n\t\tapp.mount(container);\n\t}\n}\n"],"names":["initAiUpdatePull","callback","PULL","subscribe","moduleId","command","pushData","getConnectionKey","connection","sourceBlockId","sourcePortId","targetBlockId","targetPortId","isBlockConnection","block","id","getConnectionMap","connections","Map","map","conn","makeAnimationQueue","currentBlocks","currentConnections","newBlocks","newConnections","animatedItems","currentBlockMap","newBlockMap","currentConnectionMap","newConnectionMap","handledConnections","Set","entries","has","push","type","ANIMATED_TYPES","REMOVE_BLOCK","item","connectionId","add","REMOVE_CONNECTION","BLOCK","CONNECTION","useFeature","isFeatureAvailable","featureCode","Feature","instance","isAvailable","useLoc","app","getCurrentInstance","appContext","bitrix","config","globalProperties","$bitrix","getMessage","messageId","replacements","Loc","renderPropertyDialog","contentContainer","formData","Type","isUndefined","window","rootActivity","contentUrl","content","fetch","method","body","form","Tag","render","Dom","append","Runtime","html","text","createFormData","documentType","activity","workflow","parameters","variables","template","constants","postData","decode","module_id","entity","document_type","arWorkflowParameters","JSON","stringify","arWorkflowVariables","arWorkflowTemplate","arWorkflowConstants","current_site_id","can_be_activated","sessid","BX","bitrix_sessid","dialog","CDialog","width","height","Show","FormData","Object","forEach","key","value","usePropertyDialog","BLOCK_TYPES","SIMPLE","TRIGGER","COMPLEX","TOOL","FRAME","PORT_TYPES","freeze","input","output","aux","topAux","ACTIVATION_STATUS","ACTIVE","INACTIVE","BLOCK_SLOT_NAMES","CONNECTION_SLOT_NAMES","AUX","TEMPLATE_PUBLISH_STATUSES","MAIN","USER","FULL","BLOCK_COLOR_NAMES","WHITE","ORANGE","BLUE","post","action","data","response","ajax","runAction","json","status","editorAPI","getCatalogData","getDiagramData","params","updateTemplateData","publicDiagramData","publicDiagramDataDraft","getNodeSettingsControls","saveNodeSettings","deepEqual","a","b","isPlainObject","keysA","keys","keysB","length","isBlockPropertiesDifferent","currentBlock","newBlock","node","title","Properties","currentBlockProperty","newBlockProperty","getBlockMap","blocks","isBlockActivated","Activated","safeParse","parse","e","console","error","parseItemsFromBlocksJson","isStringFilled","isArray","flatMap","items","validationInputOutputRule","newConnection","sourceType","sourcePort","targetType","targetPort","isSourcePortInputOrOutput","isTargetPortInputOrOutput","validationAuxRule","normalyzeInputOutputConnection","normalyzeAuxConnection","createUniqueId","randomNumber","Math","floor","random","updateIdUrl","templateId","url","URL","location","href","searchParams","set","delete","history","replaceState","toString","handleResponseError","errors","UI","Notification","Center","notify","Text","encode","message","autoHideDelay","PORT_LABELS","PORT_POSITIONS","left","right","SetupTemplateActivity","diagramStore","defineStore","state","draftId","documentTypeSigned","companyName","isOnline","blockCurrentTimestamps","blockSavedTimestamps","templatePublishStatus","getters","diagramData","actions","initEventListeners","EventEmitter","updateTemplateConstants","bind","getBlockAncestors","inputs","getInputConnections","find","getBlockAncestorsByInputPortId","portId","filter","getAllBlockAncestors","stack","shift","values","refreshDiagramData","normalyzeBlocks","setConnections","now","Date","updated","published","groupedPorts","ports","reduce","portsMap","port","getDeleteHandlerForBlockType","blockType","handleDeletingConstants","rawConstants","CONSTANTS","itemType","deleteConnectionByBlockIdAndPortId","blockId","isSource","isTarget","deleteBlockById","blockIndex","findIndex","blockToDelete","handler","call","splice","setBlockCurrentTimestamp","updateBlockActivityField","updateBlockTimestamp","updateBlockId","oldId","newId","index","updateTitle","newTitle","NAME","updateDescription","newDescription","DESCRIPTION","updateTemplateId","setBlocks","setBlockUnpublished","needBlock","publicationState","setInputPorts","inputPorts","assign","publicDraft","requestData","templateDraftId","isNumber","publicTemplate","updateStatus","setBlockCurrentTimestamps","updateExistedBlockProperties","get","updateNodeTitle","createPort","label","portTitle","lastPort","count","split","Number","position","addRulePort","currentPorts","rulePorts","p","isConnectionPort","addConnectionPort","connectionPorts","deletePort","deletedPort","indexOf","event","constantsToUpdate","deletedConstantIds","getData","updatedConstants","isArrayFilled","setSizeAutosizedBlock","dimensions","toggleBlockActivation","skipDraft","newActivatedState","actionLabel","applyChanges","BlockDiagram","name","components","UiBlockDiagram","props","Array","default","disabled","Boolean","emits","setup","blockSlotNames","connectionSlotNames","BLOCK_CONTAINER_CLASS_NAMES","base","highlighted","deactivated","BlockContainer","contextMenuItems","colorName","String","validator","includes","isOpen","isOpenContextMenu","showContextMenu","useContextMenu","blockContainerClassNames","computed","blockContainerStyle","style","onShowContextMenu","preventDefault","ICON_BUTTON_CLASS_NAMES","ICON_CLASS_NAMES","active","IconButton","BIcon","iconName","size","color","toRefs","iconButtonClassNames","toValue","iconButtonStyle","iconClassNames","IconDivider","containerStyle","lineStyle","round","background","LOADER_TYPE","Loader","mounted","loader","UILoader","target","$refs","show","beforeUnmount","hide","MenuButton","UiButton","BMenu","icon","buttonStyle","options","isMenuShown","menuOptions","bindElement","button","autoHide","offsetLeft","offsetWidth","SplitButton","loading","isMounted","watch","classes","getContainer","classList","className","startsWith","removeClass","addClass","setProperty","ButtonIcon","toggleClass","isWaiting","setWaiting","immediate","created","UiSplitButton","useAirDesign","onclick","$emit","mainButton","menuButton","after","unmounted","remove","TOP_MENU_CLASS_NAMES","STATUS_CLASS_NAMES","OFFSET_MORE_MENU_RIGHT","OFFSET_MORE_MENU_TOP","BlockLayout","required","moreMenuItems","topMenuOpened","dragged","resized","isActivationVisible","buttonMore","useTemplateRef","slots","useSlots","closeContextMenu","isShowButtonMore","topMenuClassNames","statusClassNames","onOpenMoreMenu","top","$el","getBoundingClientRect","clientX","clientY","onToggleBlockActivation","inject","handleIconClick","warn","onCloseMoreMenu","iconSet","Outline","activationIcon","PAUSE_L","PLAY_L","BLOCK_SWITCHER_CLASS_NAMES","on","SWITCHER_LABEL_ON","SWITCHER_LABEL_OFF","BlockSwitcher","directives","hint","emit","blockSwitcherClassNames","switcherLabel","handleClick","BlockHeader","subIconExternal","bgColor_1","bgColor_2","bgColor_3","bgColor_4","bgColor_5","bgColor_6","bgColor_7","bgColor_8","ICON_COLORS","DEFAULT_ICON_NAME","FILE","BlockIcon","iconColorIndex","customColor","iconSize","getIconName","prototype","hasOwnProperty","getIconColor","colorIndex","PortsInOutCenter","Port","hideInputPorts","inPort","outPort","auxPort","topAuxPort","BlockStatusNotPublished","BlockComplexContent","updatePortPosition","useBlockDiagram","inputPortsLength","outputPortsLength","areConnectionsAvailable","FeatureCode","complexNodeConnections","$nextTick","BlockTopTitle","TemplateNameInput","dropdownOptions","ButtonSize","AirButtonStyle","isEditing","editedTitle","preparedOptions","preparedItems","prepareItems","getEditingMenuItems","Event","document","onClickOutside","capture","unbind","methods","$Bitrix","EDIT_M","onClick","onStartEditing","editInput","focus","onSaveTitle","onCancelEditing","isString","isFunction","contains","AutosaveStatus","DropdownMenuButton","handleClickOutside","onToggleDropdown","dropdown","DropdownMenuOption","description","isActive","notReleased","COLORS","lightBlue","primaryBlue","secondaryBlue","successGreen","inactive","WorkflowIcon","colors","PersonIcon","StopIcon","ConnectionAux","Connection","DeleteConnectionBtn","complexNodeApi","loadSettings","saveSettings","settings","nodeSettingsPayload","rules","fromEntries","saveSettingsRequest","saveRuleSettings","rule","portRule","CONSTRUCTION_TYPES","IF_CONDITION","AND_CONDITION","OR_CONDITION","ACTION","OUTPUT","CONSTRUCTION_LABELS","GENERAL_CONSTRUCTION_TYPES","CONSTRUCTION_OPERATORS","equal","notEqual","empty","notEmpty","contain","notContain","in","notIn","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","FIELD_OBJECT_TYPES","DOCUMENT","CONSTANT","PARAMETER","VARIABLE","EVENT_NAMES","BEFORE_SUBMIT_EVENT","generateNextInputPortId","nextPortNumber","acc","currentValue","max","parseInt","slice","evaluateConditionExpressionFieldTitle","connectedBlocks","field","store","object","fieldId","fieldIdParts","fieldIdProperty","makeTitle","parts","join","failoverTitle","foundBlock","foundActivity","Name","Children","childrenActivity","child","foundProperty","ReturnProperties","prop","Id","Title","idKey","foundObject","elem","fieldName","evaluateActionExpressionDocumentTitle","replaceAll","property","objectTitle","useNodeSettingsStore","isLoading","isSaving","isShown","isRuleSettingsShown","currentRuleId","prevSavedNodeSettings","savedBlockInputPorts","nodeSettings","fetchNodeSettings","fixedDocumentType","loadedTitle","isFilled","ruleCards","some","ruleCard","constructions","clone","isCurrentBlock","reset","toggleVisibility","toggleRuleSettingsVisibility","setCurrentRuleId","ruleId","addRule","nextPortId","addConstruction","constructionType","newConstruction","expression","valueId","actionId","operator","deleteConstruction","construction","deleteRuleCard","deleteRuleSettings","syncOutputPortsWithRules","selectBooleanType","changeRuleExpression","addRuleCard","reorder","payload","draggedId","targetId","insertion","ruleCardId","collection","currentRuleCard","draggedItem","targetItem","draggedIndex","targetIndex","newDraggedIndex","savePortRule","transformedPortRule","outputConstructions","r","allExistingOutputPortIds","toDeletePortIds","toAddPortsMap","isPortExist","outputPortsToAdd","outputPortsToDelete","saveRule","saveForm","discardFormSettings","discardRuleSettings","prevSavedRules","currentRule","copyRule","updateSettings","NodeSettingsLayout","NodeSettingsVariable","variableName","variableValue","NodeSettingsRule","isRuleFilled","constructionLabels","generalConstructionTypes","ifLabel","onRuleClick","onDeleteRule","getExpressionTitle","getExpressionValue","DRAG_ENTITIES","ruleConstruction","INSERTION","over","under","createGhost","el","ghost","cloneNode","parentElement","checkForDragTarget","closestNode","closest","dataset","isDragAllowed","dragStartHandler","dragStartEvent","onDrop","dataTransfer","currentTarget","container","dragTarget","setDragImage","effectAllowed","handlers","dragover","dragOverEvent","dragend","currentEvent","dragenter","dragEnterEvent","drop","dropEvent","offsetHeight","DragRuleEntity","unbindAll","NodeSettingsRulesLayout","RuleCard","iconColor","RULE_CONSTRUCTION_MODES","standard","expert","condition","RuleConstruction","onstructionModes","selectedMode","constractionClassName","isBooleanType","booleanTypes","isExpertMode","parsedMessage","useAppStore","isShownRightPanel","isShownPreviewPanel","showRightPanel","hideRightPanel","setShowPreviewPanel","isShow","showPreviewPanel","hidePreviewPanel","SETTINGS_PANEL_CLASSNAMES","withPreviewPanel","TOP_RIGHT_TOOLBAR_CLASSNAMES","shifted","BOTTOM_RIGHT_TOOLBAR_CLASSNAMES","AppLayout","showSettings","topRightClassNames","bottomRightClassNames","settingsClassNames","AppHeader","LogoLayout","DEFAULT_BACK_URL","LogoBackBtn","backUrl","LogoTitle","AppHeaderDivider","EditNodeSettingsForm","mapState","isSubIcon","DATABASE","mcpLettersKey","onChangeTitle","onChangeDescription","isUrl","u","protocol","toggleActivation","AddSettingsItem","itemId","CurrentDocumentId","DocumentSelector","constructor","currentPortId","documentItems","entityId","entityType","nodeOptions","open","dynamic","tabs","Promise","resolve","Dialog","targetNode","multiple","dropdownMode","enableSearch","entities","cacheable","showAvatars","events","compactView","getId","childrenProperties","properties","children","searchable","Default","EditActionExpression","isExpanded","selectedAction","selectedActionId","activityData","actionValue","notSelectedMessage","currentActionTitle","selectedDocument","selectedDocumentTitle","mapActions","getMenuItems","menu","close","onShowMenu","MenuManager","create","maxHeight","closeByEsc","onChooseDocument","selector","then","useCommonNodeSettingsStore","isVisible","hideSettings","ValueSelector","targetElement","addTemplateItems","isObject","getReturnItems","selectMode","allowFlatDepartments","allowSelectRootDepartment","getEntityId","getTitle","customData","idTemplate","supertitle","documents","activities","res","fullTitle","result","CommonNodeSettingsForm","hasErrors","isSubmitting","hasSettings","useDocumentContext","settingsForm","nodeControls","inputListeners","shouldShowWithTransition","renderControls","multiSelectMouseHandler","showPreview","BPAShowSelector","showSelector","HideShow","hideShow","handleFieldInput","unsubscribe","loc","phraseCode","isTrusted","opt","select","tagName","scroll","scrollTop","selected","setTimeout","extractFormData","prepareForm","activityType","submitForm","validateForm","preparedSettingsData","compatibleTemplate","activated","settingControls","activity_id","handleFormCancel","MessageBox","alert","handleFormSave","innerHTML","handleDocumentSelector","getDocuments","Document","menuItems","handleSelectDocument","menuWindow","formRow","getElementById","beforePart","selectionStart","middlePart","afterPart","selectionEnd","trim","dispatchEvent","catch","renderField","fieldProps","control","isDomNode","parentNode","Hidden","workflowParameters","PARAMETERS","workflowVariables","VARIABLES","workflowConstants","CreateActivity","arAllId","controls","renderNodeControls","eventName","controlId","toLowerCase","renderedControls","Bizproc","FieldType","renderControlCollection","subscribeOnce","activityTypeName","rendererName","RendererClass","customRenderers","getControlRenderers","renderer","CustomType","row","escapedFieldName","replace","querySelector","wrapper","Multiple","selectorInput","span","createElement","attr","attributes","attrName","attrValue","setAttribute","getSafeUrl","getBackgroundImage","safeUrl","syncActivatedField","activatedInput","getElementsByName","OperatorPhraseCodes","OperatorRequiresValue","CustomDataFieldKey","FieldSelector","getCustomData","activityName","EditConditionExpression","availableOperators","selectedField","selectedFieldTitle","selectedValue","selectedOperatorTitle","selectedOperator","isShowValueEditor","onShowFieldChooseMenu","fieldSelector","onShowValueMenu","valueSelector","onShowOperatorMenu","operatorMenu","AddConstruction","undefined","constructionsMenu","offsetTop","isActionCardExists","onClickMenuItem","testId","isIfConditionNotExist","args","menuItem","every","DeleteConstruction","SelectBooleanType","selectedType","booleanType","SelectRule","currentRuleTitle","nodeSettingsRulesDropdown","SaveSettingsButton","CancelSettingsButton","DeleteRuleCard","Status","Loading","Loaded","Error","EditExtandedAction","newVal","oldVal","init","loadForm","subscribeOnBeforeSubmit","onChangeCallback","onChange","getFormData","rawActivityData","NodeSettings","useDiagramStore","mapWritableState","onShowRuleConstructions","onAddRule","onAddConnection","onSaveForm","onClose","onUpdateTitle","onUpdateDescription","EditOutputExpression","Popup","scrolling","isPopupShown","changedOutputPorts","savedOutputPorts","selectedPort","popupOptions","nodeSettingsRuleOutputDropdown","minHeight","padding","addNewPort","selectPort","lastPortIdNumber","tryToScrollBottom","dropDownContent","nodeSettingsRuleOutputDropdownContent","scrollHeight","clientHeight","onAddButtonClick","NodeSettingsRules","documentTypeForActionSettings","onRulesLayoutClose","onSaveRule","emitAsync","onScroll","useCatalogStore","groups","searchText","currentGroup","currentItem","highlightedItems","isShowFoundedGroupItems","isShowSearch","isExpandedCatalog","isFixedCatalog","canSearch","isShowSearchResults","searchResults","preSearchText","foundedGroups","group","foundedItems","parentGroup","searchResultsCount","fetchCatalogData","groupIdx","itemIdx","defaultSettings","toggleFixedCatalog","expandCatalog","collapseCatalog","clearSearchText","changeCurrentGroup","resetCurrentGroup","changeCurrentItem","resetCurrentItem","setHighlightedItem","ids","resetHighlightedItem","showFoundedGroupItems","hideFoundedGroupItems","addDevGroup","getFrameNode","subtitle","iconPath","DRAG_ITEM_SLOT_NAMES","getDragItemSlotName","CATALOG_CLASS_NAMES","expanded","CatalogLayout","hasSearchResults","catalogClassNames","HeaderLayout","BURGER_BTN_CLASS_NAMES","openend","BurgerBtn","opened","burgerBtnClassNames","HeaderLogo","TextInput","modelValue","focusable","textInput","onMounted","CatalogGroup","showItems","CatalogGroupEmptyLabel","CatalogGroupIcon","CATALOG_ITEM_CLASS_NAMES","drag","ICON_WRAPPER_CLASS_NAMES","bg_0","bg_1","bg_2","bg_3","bg_4","bg_5","bg_6","bg_7","bg_8","FOLDER","CatalogItem","DragBlock","preparedBlock","ref","getPreparedNewBlock","catalogItemClassNames","iconWrapperClassNames","baseStyles","dragPayload","dragData","dragImage","presetId","returnProperties","PresetId","x","y","getDragPayload","trimmedUrl","allowedProtocols","isSafeProtocol","CATALOG_GROUP_LIST_CLASS_NAMES","withoutScroll","CatalogGroupList","catalogGroupListClassNames","GROUP_BACK_BTN_CLASS_NAMES","collapsed","CatalogGroupBackBtn","groupTitle","groupBackBtnCalssNames","SEARCH_RESULTS_LABEL_CLASS_NAMES","SearchResultsLabel","searchResultsLablelClassNames","countLabel","TITLE_CLASS_NAMES","SearchResultsLayout","titleClassNames","SearchResultsEmptyLabel","before","link","onFeedbackLinkClick","Form","forms","zones","lang","sec","SearchBar","DiagramSearchBar","searchCallback","setUserSelectedBlock","RequestQueue","request","processingRequest","nextRequest","finally","next","BlockDiagramEntity","showBlockSettings","animationQueue","useAnimationQueue","blocksInStore","connectionsInStore","storeToRefs","highlightedBlocks","useHighlightedBlocks","highlitedBlockIds","fetchUpdateDiagram","debounce","updateDiagramData","maxAttempts","attempt","onDropNewBlock","onBlockTransitionEnd","pause","play","deep","newIds","oldIds","aiAssistant","existedBlock","DeleteBlockIconBtn","useHistory","tryPublicDraft","onDeleteBlock","makeSnapshot","UpdatePublishedStatusLabel","isPublished","AddComplexBlockPort","pointClasses","EditTemplateName","templateName","locString","PublishDropdownButton","icons","publishTemplate","fetchPublishMainTemplate","fetchPublishUserTemplate","fetchPublishFullTemplate","PublishMainDropdownOption","onChangeOption","PublishUserDropdownOption","PublishFullDropdownOption","AutosizeBlockContainer","autosize","blockContainer","HIDE_SETTINGS_DELAY","BlockMediator","hideAllSettings","hideCurrentBlockSettings","showNodeSettings","notReallyComplexBlock","showComplexNodeSettings","showCommonNodeSettings","getCtxMenuItemShowSimpleSettings","getCtxMenuItemShowComplexSettings","getCtxMenuItemDeleteBlock","BlockSimple","MoveableBlock","blockMediator","BlockTrigger","toggleBlock","BlockComplex","onBlockDblClick","BlockTool","BlockFrame","ResizableBlock","DiagramMenu","getDiagramMenu","MARKET","design","badgeText","AutosaveStatusEntity","EditTemplateSettingsDialog","beforeMount","localName","localDescription","getDialog","setContent","createDialog","confirm","Button","FILLED","cancel","OUTLINE","centerButtons","onHide","closePopup","bindEvent","SECTION_CODE","TemplateName","sections","code","SETTINGS","onOpenSettingsPopup","onCloseSettingsPopup","PublishDropdownButtonFeature","CommonNodeSettings","onCloseSettings","FixedCatalogBurgerBtn","catalogStore","HoverCatalogLayout","onMouseOver","onMouseLeave","SearchCatalogItemsInput","isFocused","showClearButton","onInputSearchText","onClear","onFocus","onBlur","ChangeCatalogGroup","isShowItems","onChangeGroup","BackToGroupsBtn","onResetCurrentGroup","ChangeFoundedCatalogItem","onChangeItem","ChangeFoundedCatalogGroup","mapGetters","Catalog","AppLayoutEntity","AppHeaderEntity","Chart","ZoomBar","ComplexNodeSettings","HistoryBar","provide","onBlockClick","handleBlockClick","handleToggleBlockActivation","initTemplateId","initDocumentType","initStartTrigger","setHandlers","commonSnapshotHandler","commonRevertHandler","isDiagramDisabled","snapshotHandler","newState","markRaw","revertHandler","snapshot","initApp","all","startTrigger","start","blockDiagramSlotNames","dragItemSlotNames","TestId","install","$testId","preparedArgs","arg","App","mount","containerId","rootProps","BitrixVue","createApp","createPinia","use"],"mappings":"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"}