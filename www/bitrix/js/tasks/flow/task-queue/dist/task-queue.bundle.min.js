this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};(function(e,s,a,l,t){"use strict";let i=e=>e,r,o;var b=babelHelpers.classPrivateFieldLooseKey("id");var p=babelHelpers.classPrivateFieldLooseKey("name");var d=babelHelpers.classPrivateFieldLooseKey("avatar");var n=babelHelpers.classPrivateFieldLooseKey("workPosition");var c=babelHelpers.classPrivateFieldLooseKey("pathToProfile");var v=babelHelpers.classPrivateFieldLooseKey("renderAvatar");class u{constructor(e){Object.defineProperty(this,v,{value:P});Object.defineProperty(this,b,{writable:true,value:void 0});Object.defineProperty(this,p,{writable:true,value:void 0});Object.defineProperty(this,d,{writable:true,value:void 0});Object.defineProperty(this,n,{writable:true,value:void 0});Object.defineProperty(this,c,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,b)[b]=parseInt(e.id,10);babelHelpers.classPrivateFieldLooseBase(this,p)[p]=e.name;babelHelpers.classPrivateFieldLooseBase(this,d)[d]=e.avatar;babelHelpers.classPrivateFieldLooseBase(this,n)[n]=e.workPosition;babelHelpers.classPrivateFieldLooseBase(this,c)[c]=e.pathToProfile}render(){return t.Tag.render(r||(r=i`
			<div class="tasks-flow__task-queue-member" data-id="tasks-flow-task-queue-member-${0}">
				${0}
			</div>
		`),this.getId(),babelHelpers.classPrivateFieldLooseBase(this,v)[v]())}getId(){return babelHelpers.classPrivateFieldLooseBase(this,b)[b]}getName(){return babelHelpers.classPrivateFieldLooseBase(this,p)[p]}getAvatar(){return babelHelpers.classPrivateFieldLooseBase(this,d)[d]}getPathToProfile(){return babelHelpers.classPrivateFieldLooseBase(this,c)[c]}}function P(){let e="<i></i>";if(this.getAvatar()){e=`<i style="background-image: url('${encodeURI(this.getAvatar())}')"></i>`}return t.Tag.render(o||(o=i`
			<a 
				href="${0}"
				class="tasks-flow__task-queue-member_avatar ui-icon ui-icon-common-user"
			>
				${0}
			</a>
		`),t.Text.encode(this.getPathToProfile()),e)}let h=e=>e,L,F,H,B;var f=babelHelpers.classPrivateFieldLooseKey("serial");var y=babelHelpers.classPrivateFieldLooseKey("title");var _=babelHelpers.classPrivateFieldLooseKey("url");var w=babelHelpers.classPrivateFieldLooseKey("createdBy");var k=babelHelpers.classPrivateFieldLooseKey("creator");var T=babelHelpers.classPrivateFieldLooseKey("responsibleId");var g=babelHelpers.classPrivateFieldLooseKey("responsible");var O=babelHelpers.classPrivateFieldLooseKey("timeInStatus");var K=babelHelpers.classPrivateFieldLooseKey("canRead");var j=babelHelpers.classPrivateFieldLooseKey("getTitleElement");var m=babelHelpers.classPrivateFieldLooseKey("getSerialElement");var $=babelHelpers.classPrivateFieldLooseKey("getSerial");class I{constructor(e){Object.defineProperty(this,$,{value:S});Object.defineProperty(this,m,{value:C});Object.defineProperty(this,j,{value:E});Object.defineProperty(this,f,{writable:true,value:void 0});Object.defineProperty(this,y,{writable:true,value:void 0});Object.defineProperty(this,_,{writable:true,value:void 0});Object.defineProperty(this,w,{writable:true,value:void 0});Object.defineProperty(this,k,{writable:true,value:void 0});Object.defineProperty(this,T,{writable:true,value:void 0});Object.defineProperty(this,g,{writable:true,value:void 0});Object.defineProperty(this,O,{writable:true,value:void 0});Object.defineProperty(this,K,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,f)[f]=parseInt(e.serial,10);babelHelpers.classPrivateFieldLooseBase(this,w)[w]=parseInt(e.createdBy,10);babelHelpers.classPrivateFieldLooseBase(this,k)[k]=new u(e.creator);babelHelpers.classPrivateFieldLooseBase(this,T)[T]=parseInt(e.responsibleId,10);babelHelpers.classPrivateFieldLooseBase(this,g)[g]=new u(e.responsible);babelHelpers.classPrivateFieldLooseBase(this,O)[O]=e.timeInStatus.formatted;babelHelpers.classPrivateFieldLooseBase(this,y)[y]=e.title;babelHelpers.classPrivateFieldLooseBase(this,_)[_]=e.url;babelHelpers.classPrivateFieldLooseBase(this,K)[K]=Boolean(e.canRead)}render(){return t.Tag.render(L||(L=h`
			<div class="tasks-flow__task-queue-line-container">
				<div class="tasks-flow__task-queue-line">
					${0}
					${0}
					<div class="tasks-flow__task-queue-line_time" title="${0}">${0}</div>
				</div>
				
				<div class="tasks-flow__task-queue-line-avatars">
					<div class="tasks-flow__task-queue-line_avatar">${0}</div>
					<div class="ui-icon-set --chevron-right" style="--ui-icon-set__icon-size: 14px; color: #A8ADB4"></div>
					<div class="tasks-flow__task-queue-line_avatar">${0}</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,m)[m](),babelHelpers.classPrivateFieldLooseBase(this,j)[j](),babelHelpers.classPrivateFieldLooseBase(this,O)[O],babelHelpers.classPrivateFieldLooseBase(this,O)[O],babelHelpers.classPrivateFieldLooseBase(this,k)[k].render(),babelHelpers.classPrivateFieldLooseBase(this,g)[g].render())}}function E(){if(babelHelpers.classPrivateFieldLooseBase(this,K)[K]){return t.Tag.render(F||(F=h`
				<a class="tasks-flow__task-queue-line_title-access" href="${0}">${0}</a>
			`),babelHelpers.classPrivateFieldLooseBase(this,_)[_],t.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,y)[y]))}return t.Tag.render(H||(H=h`
			<div class="tasks-flow__task-queue-line_title">${0}</div>
		`),t.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,y)[y]))}function C(){return t.Tag.render(B||(B=h`
			<div class="tasks-flow__task-queue-line_number">${0}</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,$)[$]())}function S(){if(babelHelpers.classPrivateFieldLooseBase(this,f)[f]<10){return`0${babelHelpers.classPrivateFieldLooseBase(this,f)[f]}`}return babelHelpers.classPrivateFieldLooseBase(this,f)[f]}let q=e=>e,A,U,D,x;var M=babelHelpers.classPrivateFieldLooseKey("params");var N=babelHelpers.classPrivateFieldLooseKey("flowId");var X=babelHelpers.classPrivateFieldLooseKey("type");var W=babelHelpers.classPrivateFieldLooseKey("pageSize");var Q=babelHelpers.classPrivateFieldLooseKey("pageNum");var R=babelHelpers.classPrivateFieldLooseKey("pending");var z=babelHelpers.classPrivateFieldLooseKey("pages");var G=babelHelpers.classPrivateFieldLooseKey("totalTaskCount");var Y=babelHelpers.classPrivateFieldLooseKey("popup");var J=babelHelpers.classPrivateFieldLooseKey("loader");var V=babelHelpers.classPrivateFieldLooseKey("layout");var Z=babelHelpers.classPrivateFieldLooseKey("getList");var ee=babelHelpers.classPrivateFieldLooseKey("renderContent");var se=babelHelpers.classPrivateFieldLooseKey("renderCounterContainer");var ae=babelHelpers.classPrivateFieldLooseKey("renderTotalTaskCounter");var le=babelHelpers.classPrivateFieldLooseKey("renderLines");var te=babelHelpers.classPrivateFieldLooseKey("showLines");var ie=babelHelpers.classPrivateFieldLooseKey("appendLines");var re=babelHelpers.classPrivateFieldLooseKey("setTotalTaskCount");var oe=babelHelpers.classPrivateFieldLooseKey("showLoader");var be=babelHelpers.classPrivateFieldLooseKey("destroyLoader");var pe=babelHelpers.classPrivateFieldLooseKey("consoleError");class de{constructor(e){Object.defineProperty(this,pe,{value:fe});Object.defineProperty(this,be,{value:Be});Object.defineProperty(this,oe,{value:He});Object.defineProperty(this,re,{value:Fe});Object.defineProperty(this,ie,{value:Le});Object.defineProperty(this,te,{value:he});Object.defineProperty(this,le,{value:Pe});Object.defineProperty(this,ae,{value:ue});Object.defineProperty(this,se,{value:ve});Object.defineProperty(this,ee,{value:ce});Object.defineProperty(this,Z,{value:ne});Object.defineProperty(this,M,{writable:true,value:void 0});Object.defineProperty(this,N,{writable:true,value:void 0});Object.defineProperty(this,X,{writable:true,value:void 0});Object.defineProperty(this,W,{writable:true,value:10});Object.defineProperty(this,Q,{writable:true,value:1});Object.defineProperty(this,R,{writable:true,value:false});Object.defineProperty(this,z,{writable:true,value:void 0});Object.defineProperty(this,G,{writable:true,value:void 0});Object.defineProperty(this,Y,{writable:true,value:void 0});Object.defineProperty(this,J,{writable:true,value:void 0});Object.defineProperty(this,V,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,M)[M]=e;babelHelpers.classPrivateFieldLooseBase(this,N)[N]=parseInt(e.flowId,10);if(!(e.type in de.TYPES)){throw new Error("The specified queue type is incorrect")}babelHelpers.classPrivateFieldLooseBase(this,X)[X]=e.type;babelHelpers.classPrivateFieldLooseBase(this,z)[z]={};babelHelpers.classPrivateFieldLooseBase(this,V)[V]={}}static showInstance(e){new this(e).show(e.bindElement)}show(e){babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]=this.getPopup();babelHelpers.classPrivateFieldLooseBase(this,Y)[Y].setContent(babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]());babelHelpers.classPrivateFieldLooseBase(this,Y)[Y].setBindElement(e);babelHelpers.classPrivateFieldLooseBase(this,Y)[Y].show()}getPopup(){const e=babelHelpers.classPrivateFieldLooseBase(this,M)[M].flowId+babelHelpers.classPrivateFieldLooseBase(this,M)[M].type;const s=`tasks-flow-task-queue-popup-${e}`;if(a.PopupManager.getPopupById(s)){return a.PopupManager.getPopupById(s)}const t=new a.Popup({id:s,className:"tasks-flow__task-queue-popup",padding:2,autoHide:true,closeByEsc:true,events:{onFirstShow:()=>{babelHelpers.classPrivateFieldLooseBase(this,te)[te]()},onClose:()=>{t.destroy()}}});new l.SidePanelIntegration(t);return t}}function ne(e){babelHelpers.classPrivateFieldLooseBase(this,R)[R]=true;const s={PENDING:"Pending",AT_WORK:"Progress",COMPLETED:"Completed"};return new Promise((a=>{t.ajax.runAction(`tasks.flow.Task.${s[babelHelpers.classPrivateFieldLooseBase(this,X)[X]]}.list`,{data:{flowData:{id:babelHelpers.classPrivateFieldLooseBase(this,N)[N]},ago:{days:30}},navigation:{page:e,size:babelHelpers.classPrivateFieldLooseBase(this,W)[W]}}).then((e=>{babelHelpers.classPrivateFieldLooseBase(this,R)[R]=false;if(e.data.tasks.length>=babelHelpers.classPrivateFieldLooseBase(this,W)[W]){babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]++}a({lines:e.data.tasks,totalTaskCount:e.data.totalCount})})).catch((e=>{babelHelpers.classPrivateFieldLooseBase(this,pe)[pe]("getList",e)}))}))}function ce(){const{popupContainer:e,popupContent:s}=t.Tag.render(A||(A=q`
			<div ref="popupContainer" class="tasks-flow__task-queue-popup_container">
				<div ref="listContainer" class="tasks-flow__task-queue-popup_content">
					<div class="tasks-flow__task-queue-popup_content-box">
						<span class="tasks-flow__task-queue-popup_label">
							<span class="tasks-flow__task-queue-popup_label-text" title="${0}">
								${0}
							</span>
						</span>
						<div class="tasks-flow__task-queue-popup_status-counter-box">
							<span class="tasks-flow__task-queue-popup_status" title="${0}">
								${0}
							</span>
							${0}
						</div>
							<div class="tasks-flow__task-queue-popup_delimiter"></div>
						${0}
					</div>
				</div>
			</div>
		`),t.Loc.getMessage(`TASKS_FLOW_TASK_QUEUE_POPUP_LABEL_${babelHelpers.classPrivateFieldLooseBase(this,X)[X]}`),t.Loc.getMessage(`TASKS_FLOW_TASK_QUEUE_POPUP_LABEL_${babelHelpers.classPrivateFieldLooseBase(this,X)[X]}`),t.Loc.getMessage(`TASKS_FLOW_TASK_QUEUE_POPUP_STATUS_${babelHelpers.classPrivateFieldLooseBase(this,X)[X]}`),t.Loc.getMessage(`TASKS_FLOW_TASK_QUEUE_POPUP_STATUS_${babelHelpers.classPrivateFieldLooseBase(this,X)[X]}`),babelHelpers.classPrivateFieldLooseBase(this,se)[se](),babelHelpers.classPrivateFieldLooseBase(this,le)[le]());babelHelpers.classPrivateFieldLooseBase(this,V)[V].popupContainer=e;babelHelpers.classPrivateFieldLooseBase(this,V)[V].popupContent=s;return babelHelpers.classPrivateFieldLooseBase(this,V)[V].popupContainer}function ve(){babelHelpers.classPrivateFieldLooseBase(this,V)[V].counterContainer=t.Tag.render(U||(U=q`
			<div class="tasks-flow__total-task-counter-container ui-counter">
					${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]());t.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,V)[V].counterContainer,"display","none");return babelHelpers.classPrivateFieldLooseBase(this,V)[V].counterContainer}function ue(){babelHelpers.classPrivateFieldLooseBase(this,V)[V].totalTaskCounter=t.Tag.render(D||(D=q`
			<div class="tasks-flow__total-task-counter ui-counter-inner"></div>
		`));return babelHelpers.classPrivateFieldLooseBase(this,V)[V].totalTaskCounter}function Pe(){babelHelpers.classPrivateFieldLooseBase(this,V)[V].popupInner=t.Tag.render(x||(x=q`
			<div class="tasks-flow__task-queue-popup_inner">
				${0}
			</div>
		`),Object.values(babelHelpers.classPrivateFieldLooseBase(this,z)[z]).flat().map((e=>e.render())));t.Event.bind(babelHelpers.classPrivateFieldLooseBase(this,V)[V].popupInner,"scroll",(()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,V)[V].popupInner.scrollTop;const s=babelHelpers.classPrivateFieldLooseBase(this,V)[V].popupInner.scrollHeight-babelHelpers.classPrivateFieldLooseBase(this,V)[V].popupInner.offsetHeight;if(Math.abs(e-s)<1&&babelHelpers.classPrivateFieldLooseBase(this,R)[R]===false){babelHelpers.classPrivateFieldLooseBase(this,te)[te]()}}));return babelHelpers.classPrivateFieldLooseBase(this,V)[V].popupInner}function he(){babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]();babelHelpers.classPrivateFieldLooseBase(this,ie)[ie](babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,be)[be]();babelHelpers.classPrivateFieldLooseBase(this,re)[re]()}))}function Le(e){if(babelHelpers.classPrivateFieldLooseBase(this,z)[z][e]){return Promise.resolve()}const s=babelHelpers.classPrivateFieldLooseBase(this,V)[V].popupInner;return babelHelpers.classPrivateFieldLooseBase(this,Z)[Z](e).then((({lines:a,totalTaskCount:l})=>{babelHelpers.classPrivateFieldLooseBase(this,G)[G]=l;t.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,V)[V].counterContainer,"display","inline-flex");babelHelpers.classPrivateFieldLooseBase(this,z)[z][e]=a.map((e=>new I(e)));babelHelpers.classPrivateFieldLooseBase(this,z)[z][e].forEach((e=>t.Dom.append(e.render(),s)))}))}function Fe(){if(!t.Type.isNil(babelHelpers.classPrivateFieldLooseBase(this,G)[G])){babelHelpers.classPrivateFieldLooseBase(this,V)[V].totalTaskCounter.innerText=babelHelpers.classPrivateFieldLooseBase(this,G)[G]>99?"99+":babelHelpers.classPrivateFieldLooseBase(this,G)[G]}}function He(){const e=t.Dom.getPosition(babelHelpers.classPrivateFieldLooseBase(this,V)[V].popupInner);const a=40;babelHelpers.classPrivateFieldLooseBase(this,J)[J]=new s.Loader({target:babelHelpers.classPrivateFieldLooseBase(this,V)[V].popupInner,size:a,mode:"inline",offset:{left:`${e.width/2-a/2}px`}});babelHelpers.classPrivateFieldLooseBase(this,J)[J].show()}function Be(){babelHelpers.classPrivateFieldLooseBase(this,J)[J].destroy()}function fe(e,s){console.error(`TaskQueue: ${e} error`,s)}de.TYPES={PENDING:"PENDING",AT_WORK:"AT_WORK",COMPLETED:"COMPLETED"};e.TaskQueue=de})(this.BX.Tasks.Flow=this.BX.Tasks.Flow||{},BX,BX.Main,BX.Tasks,BX);
//# sourceMappingURL=task-queue.bundle.map.js