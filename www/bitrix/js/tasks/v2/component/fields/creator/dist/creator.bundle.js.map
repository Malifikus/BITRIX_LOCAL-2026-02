{"version":3,"file":"creator.bundle.js","sources":["../src/creator-meta.js","../src/creator.js"],"sourcesContent":["import { Loc } from 'main.core';\nimport { TaskField } from 'tasks.v2.const';\n\nexport const creatorMeta = Object.freeze({\n\tid: TaskField.Creator,\n\ttitle: Loc.getMessage('TASKS_V2_CREATOR_TITLE'),\n});\n","import { Core } from 'tasks.v2.core';\nimport { Participants } from 'tasks.v2.component.elements.participants';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { creatorMeta } from './creator-meta';\n\n// @vue/component\nexport const Creator = {\n\tname: 'TaskCreator',\n\tcomponents: {\n\t\tParticipants,\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t\tisEdit: {},\n\t},\n\tsetup(): { task: TaskModel }\n\t{\n\t\treturn {\n\t\t\tcreatorMeta,\n\t\t};\n\t},\n\tcomputed: {\n\t\tcurrentUserId(): number\n\t\t{\n\t\t\treturn Core.getParams().currentUser.id;\n\t\t},\n\t\thintText(): string\n\t\t{\n\t\t\tif (this.task.flowId > 0)\n\t\t\t{\n\t\t\t\treturn this.loc('TASKS_V2_CREATOR_CANT_CHANGE_FLOW');\n\t\t\t}\n\n\t\t\tif (this.task.responsibleIds.length > 1)\n\t\t\t{\n\t\t\t\treturn this.loc('TASKS_V2_CREATOR_CANT_CHANGE_MANY');\n\t\t\t}\n\n\t\t\treturn this.loc('TASKS_V2_CREATOR_CANT_CHANGE');\n\t\t},\n\t\tdataset(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'data-task-id': this.taskId,\n\t\t\t\t'data-task-field-id': creatorMeta.id,\n\t\t\t\t'data-task-field-value': this.task.creatorId,\n\t\t\t};\n\t\t},\n\t\tisAdmin(): boolean\n\t\t{\n\t\t\treturn Core.getParams().rights.user.admin;\n\t\t},\n\t},\n\tmethods: {\n\t\tupdateTask(userIds: number[]): void\n\t\t{\n\t\t\tconst creatorId = userIds[0] || this.task.creatorId;\n\n\t\t\tvoid taskService.update(this.taskId, { creatorId });\n\t\t},\n\t\thandleHintClick(): void\n\t\t{\n\t\t\tvoid taskService.update(this.taskId, { responsibleIds: [this.currentUserId] });\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Participants\n\t\t\t:taskId\n\t\t\t:context=\"creatorMeta.id\"\n\t\t\t:userIds=\"[task.creatorId || currentUserId]\"\n\t\t\t:canAdd=\"task.rights.edit\"\n\t\t\t:canRemove=\"task.rights.edit\"\n\t\t\t:withHint=\"!isAdmin && !isEdit && (task.responsibleIds.length > 1 || task.responsibleIds[0] !== currentUserId)\"\n\t\t\t:hintText\n\t\t\tsingle\n\t\t\tinline\n\t\t\t:dataset\n\t\t\t:showMenu=\"false\"\n\t\t\t@hintClick=\"handleHintClick\"\n\t\t\t@update=\"updateTask\"\n\t\t/>\n\t`,\n};\n"],"names":["creatorMeta","Object","freeze","id","TaskField","Creator","title","Loc","getMessage","name","components","Participants","inject","task","taskId","isEdit","setup","computed","currentUserId","Core","getParams","currentUser","hintText","flowId","loc","responsibleIds","length","dataset","creatorId","isAdmin","rights","user","admin","methods","updateTask","userIds","taskService","update","handleHintClick","template"],"mappings":";;;;;;;;OAGaA,WAAW,GAAGC,MAAM,CAACC,MAAM,CAAC;GACxCC,EAAE,EAAEC,wBAAS,CAACC,OAAO;GACrBC,KAAK,EAAEC,aAAG,CAACC,UAAU,CAAC,wBAAwB;CAC/C,CAAC,CAAC;;CCCF;AACA,OAAaH,OAAO,GAAG;GACtBI,IAAI,EAAE,aAAa;GACnBC,UAAU,EAAE;mBACXC;IACA;GACDC,MAAM,EAAE;KACPC,IAAI,EAAE,EAAE;KACRC,MAAM,EAAE,EAAE;KACVC,MAAM,EAAE;IACR;GACDC,KAAK,GACL;KACC,OAAO;OACNhB;MACA;IACD;GACDiB,QAAQ,EAAE;KACTC,aAAa,GACb;OACC,OAAOC,kBAAI,CAACC,SAAS,EAAE,CAACC,WAAW,CAAClB,EAAE;MACtC;KACDmB,QAAQ,GACR;OACC,IAAI,IAAI,CAACT,IAAI,CAACU,MAAM,GAAG,CAAC,EACxB;SACC,OAAO,IAAI,CAACC,GAAG,CAAC,mCAAmC,CAAC;;OAGrD,IAAI,IAAI,CAACX,IAAI,CAACY,cAAc,CAACC,MAAM,GAAG,CAAC,EACvC;SACC,OAAO,IAAI,CAACF,GAAG,CAAC,mCAAmC,CAAC;;OAGrD,OAAO,IAAI,CAACA,GAAG,CAAC,8BAA8B,CAAC;MAC/C;KACDG,OAAO,GACP;OACC,OAAO;SACN,cAAc,EAAE,IAAI,CAACb,MAAM;SAC3B,oBAAoB,EAAEd,WAAW,CAACG,EAAE;SACpC,uBAAuB,EAAE,IAAI,CAACU,IAAI,CAACe;QACnC;MACD;KACDC,OAAO,GACP;OACC,OAAOV,kBAAI,CAACC,SAAS,EAAE,CAACU,MAAM,CAACC,IAAI,CAACC,KAAK;;IAE1C;GACDC,OAAO,EAAE;KACRC,UAAU,CAACC,OAAiB,EAC5B;OACC,MAAMP,SAAS,GAAGO,OAAO,CAAC,CAAC,CAAC,IAAI,IAAI,CAACtB,IAAI,CAACe,SAAS;OAEnD,KAAKQ,iDAAW,CAACC,MAAM,CAAC,IAAI,CAACvB,MAAM,EAAE;SAAEc;QAAW,CAAC;MACnD;KACDU,eAAe,GACf;OACC,KAAKF,iDAAW,CAACC,MAAM,CAAC,IAAI,CAACvB,MAAM,EAAE;SAAEW,cAAc,EAAE,CAAC,IAAI,CAACP,aAAa;QAAG,CAAC;;IAE/E;GACDqB,QAAQ,EAAG;;;;;;;;;;;;;;;;;CAiBZ,CAAC;;;;;;;;;"}