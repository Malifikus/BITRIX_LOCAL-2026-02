{"version":3,"file":"flow.bundle.js","sources":["../src/flow-meta.js","../src/flow-dialog.js","../src/flow.js","../src/flow-chip.js"],"sourcesContent":["import { Loc } from 'main.core';\nimport { TaskField } from 'tasks.v2.const';\n\nexport const flowMeta = Object.freeze({\n\tid: TaskField.Flow,\n\ttitle: Loc.getMessage('TASKS_V2_FLOW_TITLE'),\n});\n","import { Extension, Runtime } from 'main.core';\n\nimport { Core } from 'tasks.v2.core';\nimport { EntitySelectorEntity, Model } from 'tasks.v2.const';\nimport { EntitySelectorDialog, type ItemId } from 'tasks.v2.lib.entity-selector-dialog';\nimport { groupService } from 'tasks.v2.provider.service.group-service';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { FlowModel } from 'tasks.v2.model.flows';\n\ntype Params = {\n\ttargetNode: HTMLElement,\n\ttaskId: number | string,\n\tonClose: Function,\n};\n\nclass FlowDialog\n{\n\t#dialog: EntitySelectorDialog;\n\t#taskId: number | string;\n\t#onClose: Function | null;\n\n\tshow(params: Params): void\n\t{\n\t\tthis.#taskId = params.taskId;\n\t\tthis.#onClose = params.onClose;\n\n\t\tthis.#dialog ??= this.#createDialog();\n\t\tthis.#dialog.selectItemsByIds(this.#items);\n\t\tthis.#dialog.showTo(params.targetNode);\n\t}\n\n\t#createDialog(): EntitySelectorDialog\n\t{\n\t\tconst dialog = new EntitySelectorDialog({\n\t\t\tcontext: 'tasks-card',\n\t\t\twidth: 380,\n\t\t\theight: 370,\n\t\t\tmultiple: false,\n\t\t\thideOnDeselect: true,\n\t\t\tenableSearch: true,\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: EntitySelectorEntity.Flow,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tonlyActive: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tpreselectedItems: this.#items,\n\t\t\tevents: {\n\t\t\t\tonLoad: this.#fillStore,\n\t\t\t},\n\t\t\tpopupOptions: {\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: async (): Promise<void> => {\n\t\t\t\t\t\tconst flow = await this.#fillStore();\n\n\t\t\t\t\t\tif (flow)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst { id: flowId, templateId, groupId } = flow;\n\t\t\t\t\t\t\tgroupService.setHasScrumInfo(this.#taskId);\n\t\t\t\t\t\t\tvoid taskService.update(this.#taskId, { flowId, templateId, groupId, stageId: 0 });\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.#onClose?.();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tif (Core.getParams().rights.flow.create)\n\t\t{\n\t\t\tconst isFeatureTriable = Extension.getSettings('tasks.v2.component.fields.flow').get('isFeatureTriable');\n\n\t\t\tvoid Runtime.loadExtension('tasks.flow.entity-selector').then(({ EmptyStub, Footer }) => {\n\t\t\t\tdialog.setFooter(new Footer(dialog, { isFeatureTriable }).render());\n\t\t\t\tdialog.getRecentTab().getStub().hide();\n\t\t\t\tdialog.getRecentTab().setStub(EmptyStub, { showArrow: false });\n\t\t\t\tdialog.getRecentTab().render();\n\t\t\t});\n\t\t}\n\n\t\treturn dialog;\n\t}\n\n\t#fillStore = async (): Promise<?FlowModel> => {\n\t\tconst item = this.#dialog.getSelectedItems()[0];\n\t\tif (!item)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst flow = {\n\t\t\tid: item.getId(),\n\t\t\tname: item.getTitle(),\n\t\t\tgroupId: item.getCustomData().get('groupId'),\n\t\t\ttemplateId: item.getCustomData().get('templateId'),\n\t\t};\n\n\t\tif (!Core.getStore().getters[`${Model.Groups}/getById`](flow.groupId))\n\t\t{\n\t\t\tawait groupService.getGroup(flow.groupId);\n\t\t}\n\n\t\tawait Core.getStore().dispatch(`${Model.Flows}/insert`, flow);\n\n\t\treturn flow;\n\t};\n\n\tget #items(): ItemId[]\n\t{\n\t\treturn [[EntitySelectorEntity.Flow, taskService.getStoreTask(this.#taskId).flowId]];\n\t}\n}\n\nexport const flowDialog = new FlowDialog();\n","import { SidePanel } from 'main.sidepanel';\nimport { BMenu, MenuItemDesign, type MenuOptions } from 'ui.system.menu.vue';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport { Core } from 'tasks.v2.core';\nimport { Model } from 'tasks.v2.const';\nimport { HoverPill } from 'tasks.v2.component.elements.hover-pill';\nimport { FieldAdd } from 'tasks.v2.component.elements.field-add';\nimport { flowService } from 'tasks.v2.provider.service.flow-service';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { FlowModel } from 'tasks.v2.model.flows';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { flowMeta } from './flow-meta';\nimport { flowDialog } from './flow-dialog';\nimport './flow.css';\n\n// @vue/component\nexport const Flow = {\n\tname: 'TaskFlow',\n\tcomponents: {\n\t\tBIcon,\n\t\tBMenu,\n\t\tHoverPill,\n\t\tFieldAdd,\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t\tisEdit: {},\n\t},\n\tsetup(): { task: TaskModel }\n\t{\n\t\treturn {\n\t\t\tflowMeta,\n\t\t\tOutline,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tflow(): FlowModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Flows}/getById`](this.task.flowId);\n\t\t},\n\t\tmenuOptions(): MenuOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: 'tasks-field-flow-menu',\n\t\t\t\tbindElement: this.$refs.container,\n\t\t\t\toffsetTop: 8,\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.loc('TASKS_V2_FLOW_ABOUT'),\n\t\t\t\t\t\ticon: Outline.BOTTLENECK,\n\t\t\t\t\t\tonClick: this.openFlow,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.loc('TASKS_V2_FLOW_CHANGE'),\n\t\t\t\t\t\ticon: Outline.EDIT_L,\n\t\t\t\t\t\tonClick: this.showDialog,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tdesign: MenuItemDesign.Alert,\n\t\t\t\t\t\ttitle: this.loc('TASKS_V2_FLOW_DETACH'),\n\t\t\t\t\t\ticon: Outline.CROSS_L,\n\t\t\t\t\t\tonClick: this.clearField,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttargetContainer: document.body,\n\t\t\t};\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tif (this.flow && this.readonly)\n\t\t\t{\n\t\t\t\tthis.openFlow();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isEdit && this.flow)\n\t\t\t{\n\t\t\t\tthis.isMenuShown = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showDialog();\n\t\t\t}\n\t\t},\n\t\topenFlow(): void\n\t\t{\n\t\t\tconst href = flowService.getUrl(this.flow.id, Core.getParams().currentUser.id);\n\n\t\t\tSidePanel.Instance.open(href);\n\t\t},\n\t\tclearField(): void\n\t\t{\n\t\t\tvoid taskService.update(this.taskId, {\n\t\t\t\tflowId: 0,\n\t\t\t\tgroupId: 0,\n\t\t\t\tstageId: 0,\n\t\t\t});\n\t\t},\n\t\tshowDialog(): void\n\t\t{\n\t\t\tflowDialog.show({\n\t\t\t\ttargetNode: this.$refs.container,\n\t\t\t\ttaskId: this.taskId,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-field-id=\"flowMeta.id\"\n\t\t\t:data-task-field-value=\"task.flowId\"\n\t\t\tref=\"container\"\n\t\t>\n\t\t\t<HoverPill\n\t\t\t\tv-if=\"flow\"\n\t\t\t\t:withClear=\"!readonly && !isEdit\"\n\t\t\t\t:active=\"isMenuShown\"\n\t\t\t\t@click=\"handleClick\"\n\t\t\t\t@clear=\"clearField\"\n\t\t\t>\n\t\t\t\t<div class=\"tasks-field-flow\">\n\t\t\t\t\t<BIcon :name=\"Outline.BOTTLENECK\"/>\n\t\t\t\t\t<div class=\"tasks-field-flow-title\">{{ flow.name }}</div>\n\t\t\t\t</div>\n\t\t\t</HoverPill>\n\t\t\t<FieldAdd v-else :icon=\"Outline.BOTTLENECK\" @click=\"handleClick\"/>\n\t\t</div>\n\t\t<BMenu v-if=\"isMenuShown\" :options=\"menuOptions\" @close=\"isMenuShown = false\"/>\n\t`,\n};\n","import { Chip, ChipDesign } from 'ui.system.chip.vue';\nimport { Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport { Model } from 'tasks.v2.const';\nimport { fieldHighlighter } from 'tasks.v2.lib.field-highlighter';\nimport { flowService } from 'tasks.v2.provider.service.flow-service';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { FlowModel } from 'tasks.v2.model.flows';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { flowMeta } from './flow-meta';\nimport { flowDialog } from './flow-dialog';\n\n// @vue/component\nexport const FlowChip = {\n\tcomponents: {\n\t\tChip,\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t},\n\tprops: {\n\t\tisAutonomous: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(): { task: TaskModel }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tflowMeta,\n\t\t};\n\t},\n\tcomputed: {\n\t\tflow(): FlowModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Flows}/getById`](this.task.flowId);\n\t\t},\n\t\tdesign(): string\n\t\t{\n\t\t\treturn {\n\t\t\t\t[!this.isAutonomous && !this.isSelected]: ChipDesign.ShadowNoAccent,\n\t\t\t\t[!this.isAutonomous && this.isSelected]: ChipDesign.ShadowAccent,\n\t\t\t\t[this.isAutonomous && !this.isSelected]: ChipDesign.OutlineNoAccent,\n\t\t\t\t[this.isAutonomous && this.isSelected]: ChipDesign.OutlineAccent,\n\t\t\t}.true;\n\t\t},\n\t\tisSelected(): boolean\n\t\t{\n\t\t\tif (this.isAutonomous)\n\t\t\t{\n\t\t\t\treturn this.task.flowId > 0;\n\t\t\t}\n\n\t\t\treturn this.task.filledFields[flowMeta.id];\n\t\t},\n\t\tisFilled(): boolean\n\t\t{\n\t\t\treturn this.isAutonomous && this.task.flowId > 0;\n\t\t},\n\t\ttext(): string\n\t\t{\n\t\t\tif (this.isFilled)\n\t\t\t{\n\t\t\t\treturn this.flow.name;\n\t\t\t}\n\n\t\t\treturn this.loc('TASKS_V2_FLOW_TITLE_CHIP');\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tif (this.task.flowId && !this.flow)\n\t\t{\n\t\t\tvoid flowService.getFlow(this.task.flowId);\n\t\t}\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tif (!this.isAutonomous && this.isSelected)\n\t\t\t{\n\t\t\t\tthis.highlightField();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tflowDialog.show({\n\t\t\t\ttargetNode: this.$el,\n\t\t\t\ttaskId: this.taskId,\n\t\t\t\tonClose: this.highlightField,\n\t\t\t});\n\t\t},\n\t\thighlightField(): void\n\t\t{\n\t\t\tvoid fieldHighlighter.setContainer(this.$root.$el).highlight(flowMeta.id);\n\t\t},\n\t\thandleClear(): void\n\t\t{\n\t\t\tvoid taskService.update(this.taskId, {\n\t\t\t\tflowId: 0,\n\t\t\t\tgroupId: 0,\n\t\t\t});\n\t\t},\n\t},\n\t// TODO: remove title prop when flow popup added\n\ttemplate: `\n\t\t<Chip\n\t\t\t:design\n\t\t\t:icon=\"Outline.BOTTLENECK\"\n\t\t\t:text\n\t\t\t:withClear=\"isFilled\"\n\t\t\t:trimmable=\"isFilled\"\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-chip-id=\"flowMeta.id\"\n\t\t\t:data-task-chip-value=\"task.flowId\"\n\t\t\t@click=\"handleClick\"\n\t\t\t@clear=\"handleClear\"\n\t\t\t:title=\"flow?.name ?? ''\"\n\t\t/>\n\t`,\n};\n"],"names":["flowMeta","Object","freeze","id","TaskField","Flow","title","Loc","getMessage","FlowDialog","item","getSelectedItems","flow","getId","name","getTitle","groupId","getCustomData","get","templateId","Core","getStore","getters","Model","Groups","groupService","getGroup","dispatch","Flows","show","params","taskId","onClose","selectItemsByIds","showTo","targetNode","dialog","EntitySelectorDialog","context","width","height","multiple","hideOnDeselect","enableSearch","entities","EntitySelectorEntity","options","onlyActive","preselectedItems","events","onLoad","popupOptions","flowId","setHasScrumInfo","taskService","update","stageId","getParams","rights","create","isFeatureTriable","Extension","getSettings","Runtime","loadExtension","then","EmptyStub","Footer","setFooter","render","getRecentTab","getStub","hide","setStub","showArrow","getStoreTask","flowDialog","components","BIcon","BMenu","HoverPill","FieldAdd","inject","task","isEdit","setup","Outline","data","isMenuShown","computed","$store","menuOptions","bindElement","$refs","container","offsetTop","items","loc","icon","BOTTLENECK","onClick","openFlow","EDIT_L","showDialog","design","MenuItemDesign","Alert","CROSS_L","clearField","targetContainer","document","body","readonly","edit","methods","handleClick","href","flowService","getUrl","currentUser","SidePanel","Instance","open","template","FlowChip","Chip","props","isAutonomous","type","Boolean","default","isSelected","ChipDesign","ShadowNoAccent","ShadowAccent","OutlineNoAccent","OutlineAccent","true","filledFields","isFilled","text","created","getFlow","highlightField","$el","fieldHighlighter","setContainer","$root","highlight","handleClear"],"mappings":"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"}