this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};this.BX.Tasks.V2=this.BX.Tasks.V2||{};this.BX.Tasks.V2.Component=this.BX.Tasks.V2.Component||{};(function(t,e,s,i,a,n,o,l,r,u,S,T){"use strict";const h=Object.freeze({id:T.TaskField.Status,title:S.Loc.getMessage("TASKS_V2_STATUS_TITLE")});const m={components:{BIcon:a.BIcon,BMenu:i.BMenu,HoverPill:o.HoverPill},directives:{hint:s.hint},inject:{task:{},taskId:{},analytics:{}},setup(){return{statusMeta:h,Outline:a.Outline}},data(){return{isMenuShown:false}},computed:{rights(){return this.task.rights},icon(){var t;const e={[T.TaskStatus.Pending]:a.Outline.HOURGLASS,[T.TaskStatus.InProgress]:a.Outline.NEXT,[T.TaskStatus.SupposedlyCompleted]:a.Outline.REFRESH,[T.TaskStatus.Completed]:a.Outline.SENDED,[T.TaskStatus.Deferred]:a.Outline.PAUSE_L};return(t=e[this.task.status])!=null?t:a.Outline.HOURGLASS},statusFormatted(){var t;const e={[T.TaskStatus.Pending]:this.loc("TASKS_V2_STATUS_PENDING"),[T.TaskStatus.InProgress]:this.loc("TASKS_V2_STATUS_IN_PROGRESS"),[T.TaskStatus.SupposedlyCompleted]:this.loc("TASKS_V2_STATUS_SUPPOSEDLY_COMPLETED_MSGVER_1"),[T.TaskStatus.Completed]:this.loc("TASKS_V2_STATUS_COMPLETED_MSGVER_1"),[T.TaskStatus.Deferred]:this.loc("TASKS_V2_STATUS_DEFERRED")};return(t=e[this.task.status])!=null?t:this.loc("TASKS_V2_STATUS_PENDING")},statusAtFormatted(){return this.loc("TASKS_V2_STATUS_FROM",{"#DATE#":this.formatDate(this.statusChangedTs),"#TIME#":this.formatTime(this.statusChangedTs)})},statusChangedTs(){return this.task.statusChangedTs||this.task.createdTs},menuOptions(){return{id:`tasks-status-menu-${this.taskId}`,bindElement:this.$refs.clickable.$el,offsetTop:8,items:this.menuItems,targetContainer:document.body}},menuItems(){var t;const e={[T.TaskStatus.Pending]:[this.rights.start&&this.getStartItem(),this.rights.complete&&this.getCompleteItem(),this.rights.defer&&this.getDeferItem()].filter(Boolean),[T.TaskStatus.InProgress]:[this.rights.pause&&this.getPauseItem(),this.rights.complete&&this.getCompleteItem()].filter(Boolean),[T.TaskStatus.SupposedlyCompleted]:[this.rights.renew&&this.getRenewItem(),this.rights.complete&&this.getCompleteItem()].filter(Boolean),[T.TaskStatus.Deferred]:[this.rights.renew&&this.getResumeItem(),this.rights.complete&&this.getCompleteItem()].filter(Boolean),[T.TaskStatus.Completed]:[this.rights.renew&&this.getResumeItem()].filter(Boolean)};return(t=e[this.task.status])!=null?t:[]},hasMenuItems(){return this.menuItems.length>0},tooltip(){return()=>l.tooltip({text:this.statusAtFormatted,popupOptions:{offsetLeft:40},timeout:200})},controlTooltip(){return()=>l.tooltip({text:this.loc("TASKS_V2_STATUS_NEEDS_CONTROL_HINT"),popupOptions:{offsetLeft:this.$refs.needsControl.offsetWidth/2},timeout:200})}},methods:{formatDate(t){const s=(t+r.timezone.getOffset(t))/1e3;return e.DateTimeFormat.format(e.DateTimeFormat.getFormat("SHORT_DATE_FORMAT"),s)},formatTime(t){const s=(t+r.timezone.getOffset(t))/1e3;return e.DateTimeFormat.format(e.DateTimeFormat.getFormat("SHORT_TIME_FORMAT"),s)},handleClick(){if(!this.hasMenuItems){return}this.isMenuShown=true},getStartItem(){return{title:this.loc("TASKS_V2_STATUS_START_ACTION"),icon:a.Outline.NEXT,dataset:{id:"tasks-status-menu-start"},onClick:()=>u.statusService.start(this.taskId)}},getPauseItem(){return{title:this.loc("TASKS_V2_STATUS_PAUSE_ACTION"),icon:a.Outline.HOURGLASS,dataset:{id:"tasks-status-menu-pause"},onClick:()=>u.statusService.pause(this.taskId)}},getCompleteItem(){return{title:this.loc("TASKS_V2_STATUS_COMPLETE_ACTION"),icon:a.Outline.CHECK_L,dataset:{id:"tasks-status-menu-complete"},onClick:()=>{var t,e,s,i;void u.statusService.complete(this.taskId,{context:(t=(e=this.analytics)==null?void 0:e.context)!=null?t:T.Analytics.Section.Tasks,additionalContext:(s=(i=this.analytics)==null?void 0:i.additionalContext)!=null?s:T.Analytics.SubSection.TaskCard,element:T.Analytics.Element.ContextMenu})}}},getDeferItem(){return{title:this.loc("TASKS_V2_STATUS_DEFER_ACTION"),icon:a.Outline.PAUSE_L,dataset:{id:"tasks-status-menu-defer"},onClick:()=>u.statusService.defer(this.taskId)}},getRenewItem(){if(!this.task.rights.renew){return null}return{title:this.loc("TASKS_V2_STATUS_RENEW_ACTION"),icon:a.Outline.UNDO,dataset:{id:"tasks-status-menu-renew"},onClick:()=>u.statusService.renew(this.taskId)}},getResumeItem(){return{title:this.loc("TASKS_V2_STATUS_RESUME_ACTION"),icon:a.Outline.UNDO,dataset:{id:"tasks-status-menu-resume"},onClick:()=>u.statusService.renew(this.taskId)}}},template:`\n\t\t<div\n\t\t\tclass="tasks-field-status"\n\t\t\t:data-task-id="taskId"\n\t\t\t:data-task-field-id="statusMeta.id"\n\t\t\t:data-task-field-value="task.status"\n\t\t\t:data-task-created-ts="task.createdTs"\n\t\t\t:data-task-status-changes-ts="statusChangedTs"\n\t\t>\n\t\t\t<HoverPill\n\t\t\t\tv-hint="tooltip"\n\t\t\t\t:active="isMenuShown"\n\t\t\t\t:readonly="!hasMenuItems"\n\t\t\t\t@click="handleClick"\n\t\t\t\tref="clickable"\n\t\t\t>\n\t\t\t\t<BIcon class="tasks-field-status-icon" :name="icon"/>\n\t\t\t\t<div class="tasks-field-status-text">{{ statusFormatted }}</div>\n\t\t\t</HoverPill>\n\t\t\t<div ref="needsControl" class="tasks-field-status-control" v-hint="controlTooltip">\n\t\t\t\t<BIcon\n\t\t\t\t\tv-if="task.needsControl"\n\t\t\t\t\tclass="tasks-field-status-control-icon"\n\t\t\t\t\t:name="Outline.CHECK_DEFERRED"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t\t<BMenu v-if="isMenuShown" :options="menuOptions" @close="isMenuShown = false"/>\n\t`};t.Status=m;t.statusMeta=h})(this.BX.Tasks.V2.Component.Fields=this.BX.Tasks.V2.Component.Fields||{},BX.Main,BX.Vue3.Directives,BX.UI.System.Menu,BX.UI.IconSet,BX,BX.Tasks.V2.Component.Elements,BX.Tasks.V2.Component.Elements,BX.Tasks.V2.Lib,BX.Tasks.V2.Provider.Service,BX,BX.Tasks.V2.Const);
//# sourceMappingURL=status.bundle.map.js