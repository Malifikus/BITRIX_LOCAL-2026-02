{"version":3,"file":"check-list-service.bundle.js","sources":["../src/mappers.js","../src/check-list-service.js","../src/index.js"],"sourcesContent":["import { UserTypes } from 'tasks.v2.model.users';\nimport { UserMappers } from 'tasks.v2.provider.service.user-service';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\n\nimport type { CheckListSliderData, CheckListDto } from './types';\n\nexport function prepareCheckLists(checklist: CheckListModel[]): CheckListModel[]\n{\n\tconst parentNodeIdMap = new Map();\n\tchecklist.forEach((item: CheckListModel) => {\n\t\tparentNodeIdMap.set(item.id, item.nodeId);\n\t});\n\n\treturn checklist.map((item: CheckListModel) => {\n\t\tconst parentNodeId = item.parentId ? parentNodeIdMap.get(item.parentId) : 0;\n\n\t\treturn { ...item, parentNodeId };\n\t});\n}\n\n// todo remove after features.isV2Enabled === true\nexport function prepareTitleCheckLists(checklist: CheckListModel[]): CheckListModel[]\n{\n\treturn checklist.map((item: CheckListModel) => {\n\t\tconst title = prepareTitle(item);\n\n\t\treturn { ...item, title };\n\t});\n}\n\nexport function mapDtoToModel(checkList: CheckListModel): CheckListDto\n{\n\treturn {\n\t\tid: checkList.id,\n\t\tnodeId: checkList.nodeId,\n\t\ttitle: checkList.title,\n\t\tcreator: checkList.creator ? UserMappers.mapDtoToModel(checkList.creator) : null,\n\t\ttoggledBy: checkList.toggledBy ? UserMappers.mapDtoToModel(checkList.toggledBy) : null,\n\t\ttoggledDate: checkList.toggledDate,\n\t\taccomplices: checkList.accomplices?.map((it) => UserMappers.mapDtoToModel(it)),\n\t\tauditors: checkList.auditors?.map((it) => UserMappers.mapDtoToModel(it)),\n\t\tattachments: checkList.attachments,\n\t\tisComplete: checkList.isComplete,\n\t\tisImportant: checkList.isImportant,\n\t\tparentId: checkList.parentId,\n\t\tparentNodeId: checkList.parentNodeId,\n\t\tsortIndex: checkList.sortIndex,\n\t\tactions: checkList.actions,\n\t\tpanelIsShown: checkList.panelIsShown,\n\t\tmyFilterActive: checkList.myFilterActive,\n\t\tcollapsed: checkList.collapsed,\n\t\texpanded: checkList.expanded,\n\t\tlocalCompleteState: checkList.localCompleteState,\n\t\tlocalCollapsedState: checkList.localCollapsedState,\n\t\tareCompletedCollapsed: checkList.areCompletedCollapsed,\n\t\thidden: checkList.hidden,\n\t\tgroupMode: checkList.groupMode,\n\t};\n}\n\nexport function mapModelToSliderData(checkLists: CheckListModel[]): CheckListSliderData[]\n{\n\treturn Object.fromEntries(\n\t\tcheckLists.map((item) => {\n\t\t\tconst accomplices = item.accomplices?.map((accomplice) => ({\n\t\t\t\tID: accomplice.id,\n\t\t\t\tTYPE: 'A',\n\t\t\t\tNAME: accomplice.name,\n\t\t\t\tIMAGE: accomplice.image,\n\t\t\t\tIS_COLLABER: accomplice.type === UserTypes.Collaber ? 1 : '',\n\t\t\t}));\n\n\t\t\tconst auditors = item.auditors?.map((auditor) => ({\n\t\t\t\tID: auditor.id,\n\t\t\t\tTYPE: 'U',\n\t\t\t\tNAME: auditor.name,\n\t\t\t\tIMAGE: auditor.image,\n\t\t\t\tIS_COLLABER: auditor.type === UserTypes.Collaber ? 1 : '',\n\t\t\t}));\n\n\t\t\tconst attachments = Object.fromEntries(item.attachments?.map((key) => [key, key]));\n\t\t\tconst members = [...accomplices, ...auditors].reduce((acc, curr) => {\n\t\t\t\tacc[curr.ID] = curr;\n\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\n\t\t\tconst title = prepareTitle(item);\n\n\t\t\tconst node = Object.fromEntries(\n\t\t\t\tObject.entries({\n\t\t\t\t\tNODE_ID: item.nodeId,\n\t\t\t\t\tTITLE: title,\n\t\t\t\t\tCREATED_BY: item.creator?.id,\n\t\t\t\t\tTOGGLED_BY: item.toggledBy?.id,\n\t\t\t\t\tTOGGLED_DATE: item.toggledDate,\n\t\t\t\t\tMEMBERS: members,\n\t\t\t\t\tNEW_FILE_IDS: attachments,\n\t\t\t\t\tATTACHMENTS: attachments,\n\t\t\t\t\tIS_COMPLETE: item.isComplete,\n\t\t\t\t\tIS_IMPORTANT: item.isImportant,\n\t\t\t\t\tPARENT_ID: item.parentId,\n\t\t\t\t\tSORT_INDEX: item.sortIndex,\n\t\t\t\t\tACTIONS: {\n\t\t\t\t\t\tMODIFY: item.actions.modify,\n\t\t\t\t\t\tREMOVE: item.actions.remove,\n\t\t\t\t\t\tTOGGLE: item.actions.toggle,\n\t\t\t\t\t},\n\t\t\t\t}).filter(([, value]) => value !== null && value !== undefined),\n\t\t\t);\n\n\t\t\treturn [item.nodeId, node];\n\t\t}),\n\t);\n}\n\nexport function getUserIdsFromChecklists(\n\tcheckLists: CheckListModel[],\n\tuserType: 'accomplices' | 'auditors',\n): number[]\n{\n\treturn checkLists\n\t\t.flatMap((item: CheckListModel) => (item[userType] || []).map((user: User) => user.id))\n\t\t.filter((id, idx, arr) => arr.indexOf(id) === idx);\n}\n\nexport function prepareTitle(item: CheckListModel): string\n{\n\tconst names = [\n\t\t...(item.accomplices ?? []).map((member) => member.name),\n\t\t...(item.auditors ?? []).map((member) => member.name),\n\t].join(' ');\n\n\tif (names)\n\t{\n\t\treturn `${item.title} ${names}`;\n\t}\n\n\treturn item.title;\n}\n","import { Runtime, Type, Event, Text } from 'main.core';\nimport type { Store } from 'ui.vue3.vuex';\n\nimport { Core } from 'tasks.v2.core';\nimport { Endpoint, Model } from 'tasks.v2.const';\nimport { apiClient } from 'tasks.v2.lib.api-client';\nimport { idUtils, type TaskId } from 'tasks.v2.lib.id-utils';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\nimport type { UserModel } from 'tasks.v2.model.users';\n\nimport { mapDtoToModel, prepareCheckLists, prepareTitleCheckLists } from './mappers';\n\nclass CheckListService\n{\n\t#getPromises = {};\n\t#completeCheckListIds: { [taskId: number]: Set<number> } = {};\n\t#renewCheckListIds: { [taskId: number]: Set<number> } = {};\n\t#completePromises: { [taskId: number]: Resolvable } = {};\n\t#renewPromises: { [taskId: number]: Resolvable } = {};\n\t#completeDebounced: { [taskId: number]: Function } = {};\n\t#renewDebounced: { [taskId: number]: Function } = {};\n\n\tconstructor()\n\t{\n\t\tEvent.bind(window, 'beforeunload', this.handleBeforeUnload);\n\t}\n\n\thandleBeforeUnload = (): void => {\n\t\tvoid this.forceSaveAllPending();\n\t};\n\n\tasync load(taskId: TaskId, cloneTo: TaskId): Promise<CheckListModel[]>\n\t{\n\t\tconst task = taskService.getStoreTask(taskId);\n\t\tif (!idUtils.isReal(taskId) && task.templateId)\n\t\t{\n\t\t\tawait this.load(idUtils.boxTemplate(task.templateId), taskId);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst isTemplate = idUtils.isTemplate(taskId);\n\t\tconst toId = cloneTo ?? taskId;\n\t\tconst urlCheckListGet = isTemplate ? 'Template.CheckList.get' : Endpoint.CheckListGet;\n\t\tconst idKey = isTemplate ? 'templateId' : 'taskId';\n\t\t// eslint-disable-next-line no-async-promise-executor\n\t\tthis.#getPromises[toId] = new Promise(async (resolve, reject) => {\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst data = await apiClient.post(urlCheckListGet, {\n\t\t\t\t\t[idKey]: idUtils.unbox(taskId),\n\t\t\t\t});\n\n\t\t\t\tlet checkLists = data.map((it) => mapDtoToModel(it));\n\t\t\t\tif (cloneTo)\n\t\t\t\t{\n\t\t\t\t\tcheckLists = this.#clone(checkLists);\n\t\t\t\t}\n\n\t\t\t\tawait Promise.all([\n\t\t\t\t\tthis.$store.dispatch(`${Model.CheckList}/upsertMany`, checkLists),\n\t\t\t\t\ttaskService.updateStoreTask(toId, {\n\t\t\t\t\t\tcontainsChecklist: checkLists.length > 0,\n\t\t\t\t\t\tchecklist: checkLists.map(({ id }) => id),\n\t\t\t\t\t}),\n\t\t\t\t]);\n\n\t\t\t\tresolve();\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\treject(error);\n\t\t\t}\n\t\t});\n\n\t\tawait this.#getPromises[toId];\n\t}\n\n\tasync save(taskId: number, checklists: CheckListModel[], skipNotification: boolean = false): Promise<void>\n\t{\n\t\t// eslint-disable-next-line no-async-promise-executor\n\t\treturn new Promise(async (resolve, reject) => {\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst isTemplate = idUtils.isTemplate(taskId);\n\t\t\t\tconst idPure = idUtils.unbox(taskId);\n\t\t\t\tconst urlCheckListSave = isTemplate ? 'Template.CheckList.save' : Endpoint.CheckListSave;\n\t\t\t\tconst entity = isTemplate ? 'template' : 'task';\n\t\t\t\tconst features = Core.getParams().features;\n\n\t\t\t\t// todo remove after features.isV2Enabled === true\n\t\t\t\tconst task = taskService.getStoreTask(taskId);\n\t\t\t\tconst canOpenFullCard = (\n\t\t\t\t\tfeatures.isV2Enabled\n\t\t\t\t\t|| (\n\t\t\t\t\t\tType.isArray(features.allowedGroups)\n\t\t\t\t\t\t&& features.allowedGroups.includes(task.groupId)\n\t\t\t\t\t)\n\t\t\t\t);\n\n\t\t\t\tif (!canOpenFullCard)\n\t\t\t\t{\n\t\t\t\t\t// todo remove after features.isV2Enabled === true\n\t\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\t\tchecklists = prepareTitleCheckLists(checklists);\n\t\t\t\t}\n\n\t\t\t\tconst savedList = await apiClient.post(urlCheckListSave, {\n\t\t\t\t\t[entity]: {\n\t\t\t\t\t\tid: idPure,\n\t\t\t\t\t\tchecklist: prepareCheckLists(checklists),\n\t\t\t\t\t},\n\t\t\t\t\tskipNotification,\n\t\t\t\t});\n\n\t\t\t\tconst checkLists = savedList.map((it) => mapDtoToModel(it));\n\n\t\t\t\tawait Promise.all([\n\t\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setDisableCheckListAnimations`, true),\n\t\t\t\t\tthis.$store.dispatch(`${Model.CheckList}/upsertMany`, checkLists),\n\t\t\t\t]);\n\n\t\t\t\tawait this.#updateTask(taskId, checkLists);\n\n\t\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setDisableCheckListAnimations`, false);\n\n\t\t\t\tresolve();\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\treject(error);\n\t\t\t}\n\t\t});\n\t}\n\n\tasync collapse(taskId: number, checkListId: number): Promise<void>\n\t{\n\t\tconst isTemplate = idUtils.isTemplate(taskId);\n\t\tconst idPure = idUtils.unbox(taskId);\n\t\tconst urlCheckListCollapse = isTemplate ? 'Template.CheckList.collapse' : Endpoint.CheckListCollapse;\n\t\tconst entity = isTemplate ? 'template' : 'task';\n\n\t\tawait apiClient.post(urlCheckListCollapse, {\n\t\t\t[`${entity}Id`]: idPure,\n\t\t\tcheckListId,\n\t\t});\n\n\t\tvoid this.$store.dispatch(`${Model.CheckList}/update`, {\n\t\t\tid: checkListId,\n\t\t\tfields: {\n\t\t\t\tcollapsed: true,\n\t\t\t\texpanded: false,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync expand(taskId: number, checkListId: number): Promise<void>\n\t{\n\t\tconst isTemplate = idUtils.isTemplate(taskId);\n\t\tconst idPure = idUtils.unbox(taskId);\n\t\tconst urlCheckListExpand = isTemplate ? 'Template.CheckList.expand' : Endpoint.CheckListExpand;\n\t\tconst entity = isTemplate ? 'template' : 'task';\n\n\t\tawait apiClient.post(urlCheckListExpand, {\n\t\t\t[`${entity}Id`]: idPure,\n\t\t\tcheckListId,\n\t\t});\n\n\t\tvoid this.$store.dispatch(`${Model.CheckList}/update`, {\n\t\t\tid: checkListId,\n\t\t\tfields: {\n\t\t\t\tcollapsed: false,\n\t\t\t\texpanded: true,\n\t\t\t},\n\t\t});\n\t}\n\n\tasync complete(taskId: number, checkListId: number): Promise<void>\n\t{\n\t\tawait this.$store.dispatch(`${Model.CheckList}/update`, {\n\t\t\tid: checkListId,\n\t\t\tfields: { isComplete: true },\n\t\t});\n\n\t\tthis.#completeCheckListIds[taskId] ??= new Set();\n\t\tthis.#completeCheckListIds[taskId].add(checkListId);\n\n\t\tthis.#completePromises[taskId] ??= new Resolvable();\n\n\t\tthis.#completeDebounced[taskId] ??= Runtime.debounce(this.#completeCheckLists, 1500, this);\n\t\tthis.#completeDebounced[taskId](taskId);\n\n\t\tawait this.#completePromises[taskId];\n\t}\n\n\tasync renew(taskId: number, checkListId: number): Promise<void>\n\t{\n\t\tawait this.$store.dispatch(`${Model.CheckList}/update`, {\n\t\t\tid: checkListId,\n\t\t\tfields: { isComplete: false },\n\t\t});\n\n\t\tthis.#renewCheckListIds[taskId] ??= new Set();\n\t\tthis.#renewCheckListIds[taskId].add(checkListId);\n\n\t\tthis.#renewPromises[taskId] ??= new Resolvable();\n\n\t\tthis.#renewDebounced[taskId] ??= Runtime.debounce(this.#renewCheckLists, 1500, this);\n\t\tthis.#renewDebounced[taskId](taskId);\n\n\t\tawait this.#renewPromises[taskId];\n\t}\n\n\tasync delete(taskId: number, checkListId: number): Promise<void>\n\t{\n\t\tconst task = taskService.getStoreTask(taskId);\n\t\tconst checklists = this.$store.getters[`${Model.CheckList}/getByIds`](task.checklist);\n\t\tawait this.save(taskId, checklists);\n\t}\n\n\tasync #completeCheckLists(taskId: number): Promise<void>\n\t{\n\t\tconst isTemplate = idUtils.isTemplate(taskId);\n\t\tconst idPure = idUtils.unbox(taskId);\n\t\tconst urlCheckListComplete = isTemplate ? 'Template.CheckList.complete' : Endpoint.CheckListComplete;\n\t\tconst entity = isTemplate ? 'template' : 'task';\n\t\tconst checkListIds = this.#completeCheckListIds[taskId];\n\t\tdelete this.#completeCheckListIds[taskId];\n\n\t\tconst promise = this.#completePromises[taskId];\n\t\tdelete this.#completePromises[taskId];\n\n\t\tif (!checkListIds || checkListIds.size === 0)\n\t\t{\n\t\t\tpromise?.resolve();\n\n\t\t\treturn;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tconst checkLists = await Promise.all(\n\t\t\t\t[...checkListIds].map((checkListId) => {\n\t\t\t\t\treturn this.$store.getters[`${Model.CheckList}/getById`](checkListId);\n\t\t\t\t}),\n\t\t\t);\n\n\t\t\tawait apiClient.post(urlCheckListComplete, {\n\t\t\t\t[entity]: {\n\t\t\t\t\tid: idPure,\n\t\t\t\t\tchecklist: prepareCheckLists(checkLists),\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tpromise?.resolve();\n\t\t}\n\t\tcatch\n\t\t{\n\t\t\tpromise?.resolve();\n\t\t}\n\t}\n\n\tasync #renewCheckLists(taskId: number): Promise<void>\n\t{\n\t\tconst isTemplate = idUtils.isTemplate(taskId);\n\t\tconst idPure = idUtils.unbox(taskId);\n\t\tconst urlCheckListRenew = isTemplate ? 'Template.CheckList.renew' : Endpoint.CheckListRenew;\n\t\tconst entity = isTemplate ? 'template' : 'task';\n\t\tconst checkListIds = this.#renewCheckListIds[taskId];\n\t\tdelete this.#renewCheckListIds[taskId];\n\n\t\tconst promise = this.#renewPromises[taskId];\n\t\tdelete this.#renewPromises[taskId];\n\n\t\tif (!checkListIds || checkListIds.size === 0)\n\t\t{\n\t\t\tpromise?.resolve();\n\n\t\t\treturn;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tconst checkLists = await Promise.all(\n\t\t\t\t[...checkListIds].map(async (checkListId) => {\n\t\t\t\t\treturn this.$store.getters[`${Model.CheckList}/getById`](checkListId);\n\t\t\t\t}),\n\t\t\t);\n\n\t\t\tawait apiClient.post(urlCheckListRenew, {\n\t\t\t\t[entity]: {\n\t\t\t\t\tid: idPure,\n\t\t\t\t\tchecklist: prepareCheckLists(checkLists),\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tpromise?.resolve();\n\t\t}\n\t\tcatch\n\t\t{\n\t\t\tpromise?.resolve();\n\t\t}\n\t}\n\n\tisCheckListExists(checkListId: number): boolean\n\t{\n\t\treturn this.#getById(checkListId) !== null;\n\t}\n\n\tfilterItemsBelongingToCheckList(checkListId: number, checkListItemIds: number[]): number[]\n\t{\n\t\tconst result = [];\n\n\t\tcheckListItemIds.forEach((checkListItemId: number) => {\n\t\t\tconst rootId = this.#getRootId(checkListItemId);\n\t\t\tif (rootId === checkListId)\n\t\t\t{\n\t\t\t\tresult.push(checkListItemId);\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t#getRootId(checkListItemId: number): number\n\t{\n\t\tconst item = this.#getById(checkListItemId);\n\n\t\tif (!item)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (item.parentId === 0)\n\t\t{\n\t\t\treturn item.id;\n\t\t}\n\n\t\treturn this.#getRootId(item.parentId);\n\t}\n\n\t#getById(checkListId: number): CheckListModel | null\n\t{\n\t\treturn this.$store.getters[`${Model.CheckList}/getById`](checkListId) ?? null;\n\t}\n\n\tasync #updateTask(taskId: number, checkLists: CheckListModel[]): void\n\t{\n\t\tconst task = taskService.getStoreTask(taskId);\n\n\t\tconst accomplicesIdsSet = new Set(task?.accomplicesIds);\n\t\tconst auditorsIdsSet = new Set(task?.auditorsIds);\n\n\t\tconst users = [];\n\t\tcheckLists.forEach((item: CheckListModel) => {\n\t\t\titem.accomplices?.forEach((accomplice: UserModel) => {\n\t\t\t\tusers.push(accomplice);\n\t\t\t\taccomplicesIdsSet.add(accomplice.id);\n\t\t\t});\n\t\t\titem.auditors?.forEach((auditor: UserModel) => {\n\t\t\t\tusers.push(auditor);\n\t\t\t\tauditorsIdsSet.add(auditor.id);\n\t\t\t});\n\t\t});\n\n\t\tconst accomplicesIds = [...accomplicesIdsSet];\n\t\tconst auditorsIds = [...auditorsIdsSet];\n\n\t\tawait Core.getStore().dispatch(`${Model.Users}/upsertMany`, users);\n\n\t\tawait taskService.updateStoreTask(taskId, {\n\t\t\tcontainsChecklist: checkLists.length > 0,\n\t\t\tchecklist: checkLists.map((item: CheckListModel) => item.id),\n\t\t\taccomplicesIds,\n\t\t\tauditorsIds,\n\t\t});\n\t}\n\n\tasync forceCompletePending(taskId: number): Promise<void>\n\t{\n\t\tif (this.#completeCheckListIds[taskId]?.size > 0)\n\t\t{\n\t\t\tawait this.#completeCheckLists(taskId);\n\t\t}\n\t}\n\n\tasync forceRenewPending(taskId: number): Promise<void>\n\t{\n\t\tif (this.#renewCheckListIds[taskId]?.size > 0)\n\t\t{\n\t\t\tawait this.#renewCheckLists(taskId);\n\t\t}\n\t}\n\n\tasync forceSavePending(taskId: number): Promise<void>\n\t{\n\t\tawait Promise.all([\n\t\t\tthis.forceCompletePending(taskId),\n\t\t\tthis.forceRenewPending(taskId),\n\t\t]);\n\t}\n\n\tasync forceSaveAllPending(): Promise<void>\n\t{\n\t\tconst allTaskIds = new Set([\n\t\t\t...Object.keys(this.#completeCheckListIds),\n\t\t\t...Object.keys(this.#renewCheckListIds),\n\t\t]);\n\n\t\tawait Promise.all(\n\t\t\t[...allTaskIds].map((taskId) => this.forceSavePending(parseInt(taskId, 10))),\n\t\t);\n\t}\n\n\t#clone(checkLists: CheckListModel[]): CheckListModel[]\n\t{\n\t\tconst { idsMap, nodeIdsMap } = checkLists.reduce((maps, { id, nodeId }) => {\n\t\t\tmaps.idsMap.set(id, Text.getRandom());\n\t\t\tif (nodeId)\n\t\t\t{\n\t\t\t\tmaps.nodeIdsMap.set(nodeId, Text.getRandom());\n\t\t\t}\n\n\t\t\treturn maps;\n\t\t}, { idsMap: new Map(), nodeIdsMap: new Map() });\n\n\t\treturn checkLists.map((checkList: CheckListModel) => ({\n\t\t\t...checkList,\n\t\t\tid: idsMap.get(checkList.id),\n\t\t\tcopiedId: checkList.id,\n\t\t\tnodeId: nodeIdsMap.get(checkList.nodeId) ?? Text.getRandom(),\n\t\t\tparentId: idsMap.get(checkList.parentId) ?? 0,\n\t\t\tparentNodeId: nodeIdsMap.get(checkList.parentNodeId) ?? null,\n\t\t\tactions: {\n\t\t\t\tmodify: true,\n\t\t\t\tremove: true,\n\t\t\t\ttoggle: true,\n\t\t\t},\n\t\t}));\n\t}\n\n\tget $store(): Store\n\t{\n\t\treturn Core.getStore();\n\t}\n}\n\nexport const checkListService = new CheckListService();\n\nfunction Resolvable(): Promise\n{\n\tconst promise = new Promise((resolve) => {\n\t\tthis.resolve = resolve;\n\t});\n\n\tpromise.resolve = this.resolve;\n\n\treturn promise;\n}\n","import { getUserIdsFromChecklists, mapModelToSliderData } from './mappers';\n\nexport { checkListService } from './check-list-service';\n\nexport const CheckListMappers = { mapModelToSliderData, getUserIdsFromChecklists };\n"],"names":["prepareCheckLists","checklist","parentNodeIdMap","Map","forEach","item","set","id","nodeId","map","parentNodeId","parentId","get","prepareTitleCheckLists","title","prepareTitle","mapDtoToModel","checkList","creator","UserMappers","toggledBy","toggledDate","accomplices","it","auditors","attachments","isComplete","isImportant","sortIndex","actions","panelIsShown","myFilterActive","collapsed","expanded","localCompleteState","localCollapsedState","areCompletedCollapsed","hidden","groupMode","mapModelToSliderData","checkLists","Object","fromEntries","accomplice","ID","TYPE","NAME","name","IMAGE","image","IS_COLLABER","type","UserTypes","Collaber","auditor","key","members","reduce","acc","curr","node","entries","NODE_ID","TITLE","CREATED_BY","TOGGLED_BY","TOGGLED_DATE","MEMBERS","NEW_FILE_IDS","ATTACHMENTS","IS_COMPLETE","IS_IMPORTANT","PARENT_ID","SORT_INDEX","ACTIONS","MODIFY","modify","REMOVE","remove","TOGGLE","toggle","filter","value","undefined","getUserIdsFromChecklists","userType","flatMap","user","idx","arr","indexOf","names","member","join","CheckListService","constructor","handleBeforeUnload","forceSaveAllPending","Event","bind","window","load","taskId","cloneTo","task","taskService","getStoreTask","idUtils","isReal","templateId","boxTemplate","isTemplate","toId","urlCheckListGet","Endpoint","CheckListGet","idKey","Promise","resolve","reject","data","apiClient","post","unbox","all","$store","dispatch","Model","CheckList","updateStoreTask","containsChecklist","length","error","save","checklists","skipNotification","idPure","urlCheckListSave","CheckListSave","entity","features","Core","getParams","canOpenFullCard","isV2Enabled","Type","isArray","allowedGroups","includes","groupId","savedList","Interface","collapse","checkListId","urlCheckListCollapse","CheckListCollapse","fields","expand","urlCheckListExpand","CheckListExpand","complete","Set","add","Resolvable","Runtime","debounce","renew","delete","getters","isCheckListExists","filterItemsBelongingToCheckList","checkListItemIds","result","checkListItemId","rootId","push","forceCompletePending","size","forceRenewPending","forceSavePending","allTaskIds","keys","parseInt","getStore","urlCheckListComplete","CheckListComplete","checkListIds","promise","urlCheckListRenew","CheckListRenew","accomplicesIdsSet","accomplicesIds","auditorsIdsSet","auditorsIds","users","Users","idsMap","nodeIdsMap","maps","Text","getRandom","copiedId","checkListService","CheckListMappers"],"mappings":"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"}