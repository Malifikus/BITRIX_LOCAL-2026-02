{"version":3,"file":"pull-manager.bundle.js","sources":["../src/handler/base-pull-handler.js","../src/tags-pull-handler/tags-pull-handler.js","../src/task-pull-handler/mappers.js","../src/task-pull-handler/task-pull-handler.js","../src/results-pull-handler/results-pull-handler.js","../src/pull-manager.js"],"sourcesContent":["export class BasePullHandler\n{\n\tconstructor()\n\t{\n\t\tif (new.target === BasePullHandler)\n\t\t{\n\t\t\tthrow new TypeError('BasePullHandler: An abstract class cannot be instantiated');\n\t\t}\n\t}\n\n\tgetMap(): { [command: string]: Function }\n\t{\n\t\treturn {};\n\t}\n\n\tgetDelayedMap(): { [command: string]: Function }\n\t{\n\t\treturn {};\n\t}\n}\n","import { EventEmitter } from 'main.core.events';\nimport type { Store } from 'ui.vue3.vuex';\n\nimport { Core } from 'tasks.v2.core';\nimport { EventName, Model } from 'tasks.v2.const';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { BasePullHandler } from '../handler/base-pull-handler';\n\nexport class TagsPullHandler extends BasePullHandler\n{\n\tgetMap(): { [command: string]: Function }\n\t{\n\t\treturn {\n\t\t\ttags_deleted: this.#handleTagsDeleted,\n\t\t};\n\t}\n\n\t#handleTagsDeleted = ({ tagNames, userId, groupId }): void => {\n\t\ttagNames.forEach((tagName: string) => this.#handleTagDeleted({ tagName, userId, groupId }));\n\t};\n\n\t#handleTagDeleted = ({ tagName, userId, groupId }): void => {\n\t\tif (!groupId && userId !== this.#currentUserId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst tasks: TaskModel[] = this.$store.getters[`${Model.Tasks}/getAll`];\n\n\t\tconst tasksWithTag = tasks.filter((task: TaskModel) => {\n\t\t\treturn (task.groupId || 0) === (groupId || 0) && task.tags.includes(tagName);\n\t\t});\n\n\t\ttasksWithTag.forEach((task: TaskModel) => {\n\t\t\tvoid taskService.updateStoreTask(task.id, {\n\t\t\t\ttags: task.tags.filter((it: string) => it !== tagName),\n\t\t\t});\n\t\t});\n\n\t\tEventEmitter.emit(EventName.TagDeleted, { tagName, groupId });\n\t};\n\n\tget #currentUserId(): number\n\t{\n\t\treturn this.$store.getters[`${Model.Interface}/currentUserId`];\n\t}\n\n\tget $store(): Store\n\t{\n\t\treturn Core.getStore();\n\t}\n}\n","import { Type } from 'main.core';\nimport { TaskStatus, Mark } from 'tasks.v2.const';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { PushData } from './types';\n\nexport function mapInstantFields(model: TaskModel): TaskModel\n{\n\tconst task: TaskModel = {\n\t\tid: model.id,\n\t\tdeadlineTs: model.deadlineTs,\n\t\tstatus: model.status,\n\t\tstageId: model.stageId,\n\t\tauditorsIds: model.auditorsIds,\n\t};\n\n\treturn Object.fromEntries(Object.entries(task).filter(([, value]) => !Type.isUndefined(value)));\n}\n\nexport function mapPushToModel({ AFTER: after, TASK_ID: id }: PushData): TaskModel\n{\n\tconst task: TaskModel = {\n\t\tid,\n\t\ttitle: prepareValue(after.TITLE),\n\t\tisImportant: prepareValue(after.PRIORITY, after.PRIORITY === 2),\n\t\tcreatorId: prepareValue(after.CREATED_BY),\n\t\tresponsibleIds: prepareValue(after.RESPONSIBLE_ID, mapResponsibleId(after.RESPONSIBLE_ID)),\n\t\tdeadlineTs: prepareValue(after.DEADLINE, after.DEADLINE * 1000),\n\t\tchecklist: undefined,\n\t\tgroupId: prepareValue(after.GROUP_ID),\n\t\tstageId: prepareValue(after.STAGE, after.STAGE_INFO?.id ?? 0),\n\t\tflowId: prepareValue(after.FLOW_ID),\n\t\tstatus: prepareValue(after.STATUS, mapStatus(after.STATUS)),\n\t\tstatusChangedTs: prepareValue(after.STATUS, Date.now()),\n\t\taccomplicesIds: prepareValue(after.ACCOMPLICES, mapUserIds(after.ACCOMPLICES)),\n\t\tauditorsIds: prepareValue(after.AUDITORS, mapUserIds(after.AUDITORS)),\n\t\tparentId: prepareValue(after.PARENT_ID, Number(after.PARENT_ID) || 0),\n\t\ttags: prepareValue(after.TAGS, after.TAGS ? after.TAGS.split(',') : []),\n\t\tmark: prepareValue(after.MARK, mapMark(String(after.MARK))),\n\t};\n\n\treturn Object.fromEntries(Object.entries(task).filter(([, value]) => !Type.isUndefined(value)));\n}\n\nfunction mapStatus(status: number): string\n{\n\treturn {\n\t\t2: TaskStatus.Pending,\n\t\t3: TaskStatus.InProgress,\n\t\t4: TaskStatus.SupposedlyCompleted,\n\t\t5: TaskStatus.Completed,\n\t\t6: TaskStatus.Deferred,\n\t}[status] ?? TaskStatus.Pending;\n}\n\nfunction mapMark(mark: ?string): string\n{\n\treturn {\n\t\tfalse: Mark.None,\n\t\tP: Mark.Positive,\n\t\tN: Mark.Negative,\n\t}[mark] ?? Mark.None;\n}\n\nfunction mapUserIds(users: string): number[]\n{\n\tif (!users)\n\t{\n\t\treturn [];\n\t}\n\n\treturn users.split(',').map((id: string) => Number(id));\n}\n\nfunction mapResponsibleId(responsibleId: ?number): number[]\n{\n\treturn Type.isNumber(responsibleId) ? [responsibleId] : [];\n}\n\nfunction prepareValue(value: any, mappedValue: ?any = value): any | undefined\n{\n\treturn Type.isUndefined(value) ? undefined : mappedValue;\n}\n","import { Loc, Runtime, Text } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport type { Store } from 'ui.vue3.vuex';\n\nimport { EventName, Model } from 'tasks.v2.const';\nimport { Core } from 'tasks.v2.core';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { subTasksService } from 'tasks.v2.provider.service.relation-service';\nimport { GroupMappers, groupService, type StageDto } from 'tasks.v2.provider.service.group-service';\nimport { flowService } from 'tasks.v2.provider.service.flow-service';\nimport { userService } from 'tasks.v2.provider.service.user-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { StageModel } from 'tasks.v2.model.stages';\n\nimport { BasePullHandler } from '../handler/base-pull-handler';\nimport { mapInstantFields, mapPushToModel } from './mappers';\nimport type { PushData } from './types';\n\nexport class TaskPullHandler extends BasePullHandler\n{\n\tgetMap(): { [command: string]: Function }\n\t{\n\t\treturn {\n\t\t\ttask_add: this.#handleTaskAdded,\n\t\t\ttask_update: this.#handleTaskUpdated,\n\t\t\ttask_view: this.#handleTaskViewed,\n\t\t\ttask_remove: this.#handleTaskDeleted,\n\t\t\tdefault_deadline_changed: this.#handleDefaultDeadlineChanged,\n\t\t};\n\t}\n\n\tgetDelayedMap(): { [command: string]: Function }\n\t{\n\t\treturn {\n\t\t\ttask_update: this.#handleTaskUpdatedDelayed,\n\t\t};\n\t}\n\n\t#handleTaskAdded = (data): void => {\n\t\tconst features = Core.getParams().features;\n\n\t\t// show task created balloon if miniform feature is enabled\n\t\tconst showTaskAddedBalloon = (data.AFTER.USER_ID === this.#currentUserId)\n\t\t\t&& (features.isMiniformEnabled && !features.isV2Enabled)\n\t\t;\n\n\t\tif (showTaskAddedBalloon)\n\t\t{\n\t\t\tconst url = data.AFTER.URL ?? '';\n\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tid: Text.getRandom(),\n\t\t\t\tcontent: Loc.getMessage('TASKS_V2_NOTIFY_TASK_CREATED'),\n\t\t\t\tactions: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: Loc.getMessage('TASKS_V2_NOTIFY_TASK_DO_VIEW'),\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: (event, balloon) => {\n\t\t\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\t\t\tBX.SidePanel.Instance.open(url);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t}\n\t};\n\n\t#handleTaskUpdated = (data: PushData): void => {\n\t\tconst task = mapPushToModel(data);\n\n\t\tthis.#upsertStage(data.AFTER.STAGE_INFO);\n\n\t\tif (data.BEFORE.PARENT_ID)\n\t\t{\n\t\t\tsubTasksService.deleteStore(data.BEFORE.PARENT_ID, [task.id]);\n\t\t}\n\n\t\tif (task.parentId)\n\t\t{\n\t\t\tsubTasksService.addStore(task.parentId, [task.id]);\n\t\t}\n\n\t\tconst { id, ...fields } = mapInstantFields(task);\n\n\t\tvoid taskService.updateStoreTask(id, fields);\n\t};\n\n\t#pushedTasks: { [taskId: number]: TaskModel } = {};\n\n\t#handleTaskUpdatedDelayed = async (data: PushData): Promise<void> => {\n\t\tconst task = mapPushToModel(data);\n\n\t\tconst { TaskFullCard } = await Runtime.loadExtension('tasks.v2.application.task-full-card');\n\n\t\tif (data.USER_ID === this.#currentUserId && TaskFullCard.isOpened(task.id))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!taskService.hasStoreTask(task.id))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#pushedTasks[task.id] = { ...this.#pushedTasks[task.id], ...task };\n\n\t\tthis.#handleTaskUpdatedDebounced(data);\n\t};\n\n\t#handleTaskUpdatedDebounced = Runtime.debounce(async (data: PushData) => {\n\t\tconst task = this.#pushedTasks[data.TASK_ID];\n\t\tdelete this.#pushedTasks[task.id];\n\n\t\tif (this.#needToLoadTask(data))\n\t\t{\n\t\t\tawait this.#loadTask(task);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tawait Promise.all([\n\t\t\t\tthis.#loadGroup(task),\n\t\t\t\tthis.#loadFlow(task),\n\t\t\t\tthis.#loadUsers(task),\n\t\t\t\tthis.#loadRights(task),\n\t\t\t]);\n\n\t\t\tconst { id, ...fields } = task;\n\n\t\t\ttaskService.updateStoreTask(id, fields);\n\t\t}\n\n\t\tEventEmitter.emit(EventName.TaskPullUpdated, { task: taskService.getStoreTask(task.id) });\n\t}, 0);\n\n\t#handleTaskViewed = (data): void => {};\n\n\t#handleTaskDeleted = (data: PushData): void => {\n\t\tconst taskId = data.TASK_ID;\n\t\tvoid taskService.deleteStore(taskId);\n\t\tEventEmitter.emit(EventName.CloseFullCard, { taskId });\n\t\tEventEmitter.emit(EventName.TaskDeleted, { id: taskId });\n\t};\n\n\t#handleDefaultDeadlineChanged = ({ deadlineUserOption }): void => {\n\t\tvoid this.$store.dispatch(`${Model.Interface}/updateDeadlineUserOption`, deadlineUserOption);\n\t};\n\n\t#upsertStage(stageDto: StageDto): void\n\t{\n\t\tif (stageDto)\n\t\t{\n\t\t\tconst stage: StageModel = GroupMappers.mapStageDtoToModel(stageDto);\n\n\t\t\tvoid this.$store.dispatch(`${Model.Stages}/upsert`, stage);\n\t\t}\n\t}\n\n\tasync #loadTask(task: TaskModel): Promise<void>\n\t{\n\t\tawait taskService.get(task.id);\n\t}\n\n\t#needToLoadTask(data: PushData): boolean\n\t{\n\t\tconst notPushableFields = new Set([\n\t\t\t'DESCRIPTION',\n\t\t\t'UF_TASK_WEBDAV_FILES',\n\t\t\t'STATUS',\n\t\t\t'ALLOW_TIME_TRACKING',\n\t\t]);\n\n\t\treturn Object.keys(data.AFTER).some((field: string) => notPushableFields.has(field));\n\t}\n\n\tasync #loadGroup(task: TaskModel): Promise<void>\n\t{\n\t\tif (this.#needToLoadGroup(task))\n\t\t{\n\t\t\tawait groupService.getGroup(task.groupId);\n\t\t}\n\t}\n\n\t#needToLoadGroup(task: TaskModel): boolean\n\t{\n\t\tif (this.#needToLoadFlow(task))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn task.groupId && !this.$store.getters[`${Model.Groups}/getById`](task.groupId);\n\t}\n\n\tasync #loadFlow(task: TaskModel): Promise<void>\n\t{\n\t\tif (this.#needToLoadFlow(task))\n\t\t{\n\t\t\tawait flowService.getFlow(task.flowId);\n\t\t}\n\t}\n\n\t#needToLoadFlow(task: TaskModel): boolean\n\t{\n\t\treturn Boolean(task.flowId) && !this.$store.getters[`${Model.Flows}/getById`](task.flowId);\n\t}\n\n\tasync #loadUsers(task: TaskModel): Promise<void>\n\t{\n\t\tif (this.#needToLoadUsers(task))\n\t\t{\n\t\t\tawait userService.list(this.#getUsersIds(task));\n\t\t}\n\t}\n\n\t#needToLoadUsers(task: TaskModel): boolean\n\t{\n\t\treturn !userService.hasUsers(this.#getUsersIds(task));\n\t}\n\n\t#getUsersIds(task: TaskModel): number[]\n\t{\n\t\treturn [\n\t\t\ttask.creatorId,\n\t\t\t...(task.responsibleIds ?? []),\n\t\t\t...(task.accomplicesIds ?? []),\n\t\t\t...(task.auditorsIds ?? []),\n\t\t].filter((id: ?number) => id);\n\t}\n\n\tasync #loadRights(task: TaskModel): Promise<void>\n\t{\n\t\tawait taskService.getRights(task.id);\n\t}\n\n\tget #currentUserId(): number\n\t{\n\t\treturn this.$store.getters[`${Model.Interface}/currentUserId`];\n\t}\n\n\tget $store(): Store\n\t{\n\t\treturn Core.getStore();\n\t}\n}\n","import { Model } from 'tasks.v2.const';\nimport { Core } from 'tasks.v2.core';\nimport { fileService, EntityTypes } from 'tasks.v2.provider.service.file-service';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { resultService, ResultMappers } from 'tasks.v2.provider.service.result-service';\nimport type { ResultDto } from 'tasks.v2.provider.service.result-service';\nimport { Store } from 'ui.vue3.vuex';\n\nimport { BasePullHandler } from '../handler/base-pull-handler';\n\nexport class ResultsPullHandler extends BasePullHandler\n{\n\tgetMap(): { [command: string]: Function }\n\t{\n\t\treturn {\n\t\t\ttask_result_create: this.#handleResultCreate,\n\t\t\ttask_result_update: this.#handleResultUpdate,\n\t\t\ttask_result_delete: this.#handleResultDelete,\n\t\t};\n\t}\n\n\t#handleResultCreate = async (data): void => {\n\t\tconst result: ResultDto = data.result;\n\t\tconst { id, taskId, messageId } = result;\n\n\t\tif (resultService.hasStoreResult(id) || !taskService.hasStoreTask(taskId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst insertedResult = ResultMappers.mapDtoToModel(result);\n\n\t\tawait resultService.insertStoreResult(insertedResult);\n\t\tresultService.addResultToTask(taskId, id, messageId);\n\n\t\tvoid resultService.get(id);\n\t};\n\n\t#handleResultUpdate = async (data): void => {\n\t\tconst result: ResultDto = data.result;\n\t\tconst { id, fileIds, author } = result;\n\n\t\tif (!resultService.hasStoreResult(id) || author.id === this.#currentUserId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst updatedResult = ResultMappers.mapDtoToModel(result);\n\n\t\tawait resultService.updateStoreResult(id, updatedResult);\n\n\t\tawait fileService.get(id, EntityTypes.Result).sync(fileIds);\n\t};\n\n\t#handleResultDelete = (data): void => {\n\t\tconst result: ResultDto = data.result;\n\t\tconst { id, taskId } = result;\n\n\t\tif (!taskService.hasStoreTask(taskId) || !resultService.hasStoreResult(taskId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tresultService.deleteResultFromTask(taskId, id);\n\t\tvoid resultService.deleteStoreResult(id);\n\t};\n\n\tget #currentUserId(): number\n\t{\n\t\treturn this.$store.getters[`${Model.Interface}/currentUserId`];\n\t}\n\n\tget $store(): Store\n\t{\n\t\treturn Core.getStore();\n\t}\n}\n","import { Text } from 'main.core';\nimport type { BaseEvent } from 'main.core.events';\n\nimport { QueueManager } from 'pull.queuemanager';\nimport type { ActionItem } from 'pull.queuemanager';\n\nimport { Module } from 'tasks.v2.const';\nimport { TagsPullHandler } from './tags-pull-handler/tags-pull-handler';\nimport { TaskPullHandler } from './task-pull-handler/task-pull-handler';\nimport { ResultsPullHandler } from './results-pull-handler/results-pull-handler';\nimport type { BasePullHandler } from './handler/base-pull-handler';\n\ntype Params = {\n\tcurrentUserId: number,\n};\n\nexport class PullManager\n{\n\t#params: Params;\n\t#loadItemsDelay: number = 500;\n\n\t#handlers: Set<BasePullHandler>;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\n\t\tthis.#handlers = new Set([\n\t\t\tnew TaskPullHandler(),\n\t\t\tnew TagsPullHandler(),\n\t\t\tnew ResultsPullHandler(),\n\t\t]);\n\t}\n\n\tinitQueueManager(): QueueManager\n\t{\n\t\treturn new QueueManager({\n\t\t\tmoduleId: Module.Tasks,\n\t\t\tuserId: this.#params.currentUserId,\n\t\t\tconfig: {\n\t\t\t\tloadItemsDelay: this.#loadItemsDelay,\n\t\t\t},\n\t\t\tadditionalData: {},\n\t\t\tevents: {\n\t\t\t\tonBeforePull: (baseEvent: BaseEvent) => {\n\t\t\t\t\tthis.#onBeforePull(baseEvent);\n\t\t\t\t},\n\t\t\t\tonPull: (baseEvent: BaseEvent) => {\n\t\t\t\t\tthis.#onPull(baseEvent);\n\t\t\t\t},\n\t\t\t},\n\t\t\tcallbacks: {\n\t\t\t\tonBeforeQueueExecute: (items: Array<ActionItem>) => {\n\t\t\t\t\treturn this.#onBeforeQueueExecute(items);\n\t\t\t\t},\n\t\t\t\tonQueueExecute: (items: Array<ActionItem>) => {\n\t\t\t\t\treturn this.#onQueueExecute(items);\n\t\t\t\t},\n\t\t\t\tonReload: () => {\n\t\t\t\t\tthis.#onReload();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#onBeforePull(baseEvent: BaseEvent): void\n\t{\n\t\tconst { pullData: { command, params } } = baseEvent.data;\n\n\t\tfor (const handler of this.#handlers)\n\t\t{\n\t\t\thandler.getMap()[command]?.(params);\n\t\t}\n\t}\n\n\t#onPull(baseEvent: BaseEvent): void\n\t{\n\t\tconst { pullData: { command, params }, promises } = baseEvent.data;\n\n\t\tfor (const handler of this.#handlers)\n\t\t{\n\t\t\tif (handler.getDelayedMap()[command])\n\t\t\t{\n\t\t\t\tpromises.push(\n\t\t\t\t\tPromise.resolve({\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tid: params.entityId ?? Text.getRandom(),\n\t\t\t\t\t\t\tcommand,\n\t\t\t\t\t\t\tparams,\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\t#onBeforeQueueExecute(items: Array<ActionItem>): Promise\n\t{\n\t\treturn Promise.resolve();\n\t}\n\n\tasync #onQueueExecute(items: Array<ActionItem>): Promise\n\t{\n\t\tawait this.#executeQueue(items);\n\t}\n\n\t#onReload(event) {}\n\n\t#executeQueue(items: Array<ActionItem>): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\titems.forEach((item: ActionItem) => {\n\t\t\t\tconst { data: { command, params } } = item;\n\n\t\t\t\tfor (const handler of this.#handlers)\n\t\t\t\t{\n\t\t\t\t\thandler.getDelayedMap()[command]?.(params);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tresolve();\n\t\t});\n\t}\n}\n"],"names":["BasePullHandler","constructor","new","target","TypeError","getMap","getDelayedMap","TagsPullHandler","tagNames","userId","groupId","forEach","tagName","tasks","$store","getters","Model","Tasks","tasksWithTag","filter","task","tags","includes","taskService","updateStoreTask","id","it","EventEmitter","emit","EventName","TagDeleted","tags_deleted","Core","getStore","Interface","mapInstantFields","model","deadlineTs","status","stageId","auditorsIds","Object","fromEntries","entries","value","Type","isUndefined","mapPushToModel","AFTER","after","TASK_ID","title","prepareValue","TITLE","isImportant","PRIORITY","creatorId","CREATED_BY","responsibleIds","RESPONSIBLE_ID","mapResponsibleId","DEADLINE","checklist","undefined","GROUP_ID","STAGE","STAGE_INFO","flowId","FLOW_ID","STATUS","mapStatus","statusChangedTs","Date","now","accomplicesIds","ACCOMPLICES","mapUserIds","AUDITORS","parentId","PARENT_ID","Number","TAGS","split","mark","MARK","mapMark","String","TaskStatus","Pending","InProgress","SupposedlyCompleted","Completed","Deferred","false","Mark","None","P","Positive","N","Negative","users","map","responsibleId","isNumber","mappedValue","TaskPullHandler","data","features","getParams","showTaskAddedBalloon","USER_ID","isMiniformEnabled","isV2Enabled","url","URL","BX","UI","Notification","Center","notify","Text","getRandom","content","Loc","getMessage","actions","events","click","event","balloon","close","SidePanel","Instance","open","BEFORE","subTasksService","deleteStore","addStore","fields","TaskFullCard","Runtime","loadExtension","isOpened","hasStoreTask","debounce","Promise","all","TaskPullUpdated","getStoreTask","taskId","CloseFullCard","TaskDeleted","deadlineUserOption","dispatch","task_add","task_update","task_view","task_remove","default_deadline_changed","stageDto","stage","GroupMappers","mapStageDtoToModel","Stages","get","notPushableFields","Set","keys","some","field","has","groupService","getGroup","Groups","flowService","getFlow","Boolean","Flows","userService","list","hasUsers","getRights","ResultsPullHandler","result","messageId","resultService","hasStoreResult","insertedResult","ResultMappers","mapDtoToModel","insertStoreResult","addResultToTask","fileIds","author","updatedResult","updateStoreResult","fileService","EntityTypes","Result","sync","deleteResultFromTask","deleteStoreResult","task_result_create","task_result_update","task_result_delete","PullManager","params","initQueueManager","QueueManager","moduleId","Module","currentUserId","config","loadItemsDelay","additionalData","onBeforePull","baseEvent","onPull","callbacks","onBeforeQueueExecute","items","onQueueExecute","onReload","pullData","command","handler","promises","push","resolve","entityId","item"],"mappings":"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"}