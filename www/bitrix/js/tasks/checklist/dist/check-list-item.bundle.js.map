{"version":3,"file":"check-list-item.bundle.js","sources":["../src/tree-item.js","../src/composite-tree-item.js","../src/check-list-item-fields.js","../src/check-list-item.js"],"sourcesContent":["class TreeItem\n{\n\tstatic generateUniqueNodeId()\n\t{\n\t\treturn Math.random().toString(36).substr(2, 9);\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.setNodeId(TreeItem.generateUniqueNodeId());\n\t\tthis.setParent(null);\n\t}\n\n\tgetRootNode()\n\t{\n\t\tlet parent = this;\n\n\t\twhile (parent.getParent() !== null)\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\treturn parent;\n\t}\n\n\tgetNodeId()\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tsetNodeId(nodeId)\n\t{\n\t\tthis.nodeId = nodeId;\n\t}\n\n\tgetParent()\n\t{\n\t\treturn this.parent;\n\t}\n\n\tsetParent(parent)\n\t{\n\t\tthis.parent = parent;\n\t}\n}\n\nexport {TreeItem};","import {TreeItem} from './tree-item';\n\nclass CompositeTreeItem extends TreeItem\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.descendants = [];\n\t}\n\n\tadd(item, position = null)\n\t{\n\t\titem.setParent(this);\n\n\t\tif (position === null)\n\t\t{\n\t\t\tthis.descendants.push(item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.descendants.splice(position, 0, item);\n\t\t}\n\t}\n\n\taddAfter(item, after)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === after);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.add(item, index + 1);\n\t\t}\n\t}\n\n\taddBefore(item, before)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === before);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.add(item, index);\n\t\t}\n\t}\n\n\tremove(item)\n\t{\n\t\tconst index = this.descendants.findIndex(descendant => descendant === item);\n\t\tif (index !== -1)\n\t\t{\n\t\t\tthis.descendants.splice(index, 1);\n\t\t}\n\t}\n\n\tgetDescendants()\n\t{\n\t\treturn this.descendants;\n\t}\n\n\tgetDescendantsCount()\n\t{\n\t\treturn this.descendants.length;\n\t}\n\n\tgetFirstDescendant()\n\t{\n\t\tif (this.descendants.length > 0)\n\t\t{\n\t\t\treturn this.descendants[0];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetLastDescendant()\n\t{\n\t\tif (this.descendants.length > 0)\n\t\t{\n\t\t\treturn this.descendants[this.descendants.length - 1];\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tisFirstDescendant()\n\t{\n\t\treturn (this === this.getParent().getFirstDescendant());\n\t}\n\n\tisLastDescendant()\n\t{\n\t\treturn (this === this.getParent().getLastDescendant());\n\t}\n\n\tgetLeftSibling()\n\t{\n\t\tif (this.isFirstDescendant())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst parentDescendants = this.getParent().getDescendants();\n\t\tconst index = parentDescendants.findIndex(descendant => descendant === this);\n\n\t\tif (index !== -1)\n\t\t{\n\t\t\treturn parentDescendants[index - 1];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetRightSibling()\n\t{\n\t\tif (this.isLastDescendant())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst parentDescendants = this.getParent().getDescendants();\n\t\tconst index = parentDescendants.findIndex(descendant => descendant === this);\n\n\t\tif (index !== -1)\n\t\t{\n\t\t\treturn parentDescendants[index + 1];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetLeftSiblingThrough()\n\t{\n\t\tif (this === this.getRootNode())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.isFirstDescendant())\n\t\t{\n\t\t\treturn this.getParent();\n\t\t}\n\n\t\tlet leftSiblingThrough = this.getLeftSibling();\n\t\twhile (leftSiblingThrough && leftSiblingThrough.getDescendantsCount() > 0)\n\t\t{\n\t\t\tleftSiblingThrough = leftSiblingThrough.getLastDescendant();\n\t\t}\n\n\t\treturn leftSiblingThrough;\n\t}\n\n\tgetRightSiblingThrough()\n\t{\n\t\tif (this.getDescendantsCount() > 0)\n\t\t{\n\t\t\treturn this.getFirstDescendant();\n\t\t}\n\n\t\tif (!this.isLastDescendant())\n\t\t{\n\t\t\treturn this.getRightSibling();\n\t\t}\n\n\t\tlet parent = this;\n\t\twhile (parent.getParent() !== null && parent.isLastDescendant())\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\tif (parent !== this.getRootNode())\n\t\t{\n\t\t\treturn parent.getRightSibling();\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfindChild(nodeId)\n\t{\n\t\tif (!nodeId)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.getNodeId().toString() === nodeId.toString())\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = descendant.findChild(nodeId);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tcountTreeSize()\n\t{\n\t\tlet size = this.getDescendantsCount();\n\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tsize += descendant.countTreeSize();\n\t\t});\n\n\t\treturn size;\n\t}\n\n\tgetTreeSize()\n\t{\n\t\treturn this.getRootNode().countTreeSize() + 1;\n\t}\n}\n\nexport {CompositeTreeItem};","import {Text, Type} from 'main.core';\n\nclass CheckListItemFields\n{\n\tstatic snakeToCamelCase(string)\n\t{\n\t\tlet camelCaseString = string;\n\n\t\tif (Type.isString(camelCaseString))\n\t\t{\n\t\t\tcamelCaseString = camelCaseString.toLowerCase();\n\t\t\tcamelCaseString = camelCaseString.replace(/[-_\\s]+(.)?/g, (match, chr) => (chr ? chr.toUpperCase() : ''));\n\n\t\t\treturn camelCaseString.substr(0, 1).toLowerCase() + camelCaseString.substr(1);\n\t\t}\n\n\t\treturn camelCaseString;\n\t}\n\n\tstatic camelToSnakeCase(string)\n\t{\n\t\tlet snakeCaseString = string;\n\n\t\tif (Type.isString(snakeCaseString))\n\t\t{\n\t\t\tsnakeCaseString = snakeCaseString.replace(/(.)([A-Z])/g, '$1_$2').toUpperCase();\n\t\t}\n\n\t\treturn snakeCaseString;\n\t}\n\n\tconstructor(fields)\n\t{\n\t\tthis.fields = [\n\t\t\t'id',\n\t\t\t'copiedId',\n\t\t\t'nodeId',\n\t\t\t'parentId',\n\t\t\t'title',\n\t\t\t'sortIndex',\n\t\t\t'displaySortIndex',\n\t\t\t'isComplete',\n\t\t\t'isImportant',\n\t\t\t'isSelected',\n\t\t\t'isCollapse',\n\t\t\t'completedCount',\n\t\t\t'totalCount',\n\t\t\t'members',\n\t\t\t'attachments',\n\t\t];\n\n\t\tthis.id = null;\n\t\tthis.nodeId = null;\n\t\tthis.parentId = null;\n\t\tthis.title = '';\n\t\tthis.sortIndex = 0;\n\t\tthis.displaySortIndex = '';\n\t\tthis.isComplete = false;\n\t\tthis.isImportant = false;\n\t\tthis.isSelected = false;\n\t\tthis.isCollapse = false;\n\t\tthis.completedCount = 0;\n\t\tthis.totalCount = 0;\n\t\tthis.members = new Map();\n\t\tthis.attachments = {};\n\n\t\tthis.setFields(fields);\n\t}\n\n\tsetFields(fields)\n\t{\n\t\tObject.keys(fields).forEach((name) => {\n\t\t\tconst camelCaseName = CheckListItemFields.snakeToCamelCase(name);\n\n\t\t\tif (this.fields.indexOf(name) !== -1)\n\t\t\t{\n\t\t\t\tconst snakeCaseName = CheckListItemFields.camelToSnakeCase(name);\n\t\t\t\tconst setMethod = this[CheckListItemFields.snakeToCamelCase(`SET_${snakeCaseName}`)].bind(this);\n\t\t\t\tsetMethod(fields[name]);\n\t\t\t}\n\t\t\telse if (this.fields.indexOf(camelCaseName) !== -1)\n\t\t\t{\n\t\t\t\tconst setMethod = this[CheckListItemFields.snakeToCamelCase(`SET_${name}`)].bind(this);\n\t\t\t\tsetMethod(fields[name]);\n\t\t\t}\n\t\t});\n\t}\n\n\tgetId()\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetId(id)\n\t{\n\t\tthis.id = id;\n\t}\n\n\tgetNodeId()\n\t{\n\t\treturn this.nodeId;\n\t}\n\n\tsetNodeId(nodeId)\n\t{\n\t\tthis.nodeId = nodeId;\n\t}\n\n\tgetCopiedId()\n\t{\n\t\treturn this.copiedId;\n\t}\n\n\tsetCopiedId(copiedId)\n\t{\n\t\tthis.copiedId = copiedId;\n\t}\n\n\tgetParentId()\n\t{\n\t\treturn this.parentId;\n\t}\n\n\tsetParentId(parentId)\n\t{\n\t\tthis.parentId = parentId;\n\t}\n\n\tgetTitle()\n\t{\n\t\treturn this.title;\n\t}\n\n\tsetTitle(title)\n\t{\n\t\tthis.title = Text.encode(title);\n\t}\n\n\tgetSortIndex()\n\t{\n\t\treturn this.sortIndex;\n\t}\n\n\tsetSortIndex(sortIndex)\n\t{\n\t\tthis.sortIndex = sortIndex;\n\t}\n\n\tgetDisplaySortIndex()\n\t{\n\t\treturn this.displaySortIndex;\n\t}\n\n\tsetDisplaySortIndex(displaySortIndex)\n\t{\n\t\tthis.displaySortIndex = displaySortIndex;\n\t}\n\n\tgetIsComplete()\n\t{\n\t\treturn this.isComplete;\n\t}\n\n\tsetIsComplete(isComplete)\n\t{\n\t\tthis.isComplete = isComplete;\n\t}\n\n\tgetIsImportant()\n\t{\n\t\treturn this.isImportant;\n\t}\n\n\tsetIsImportant(isImportant)\n\t{\n\t\tthis.isImportant = isImportant;\n\t}\n\n\tgetIsSelected()\n\t{\n\t\treturn this.isSelected;\n\t}\n\n\tsetIsSelected(isSelected)\n\t{\n\t\tthis.isSelected = isSelected;\n\t}\n\n\tgetIsCollapse()\n\t{\n\t\treturn this.isCollapse;\n\t}\n\n\tsetIsCollapse(isCollapse)\n\t{\n\t\tthis.isCollapse = isCollapse;\n\t}\n\n\tgetCompletedCount()\n\t{\n\t\treturn this.completedCount;\n\t}\n\n\tsetCompletedCount(completedCount)\n\t{\n\t\tthis.completedCount = completedCount;\n\t}\n\n\tgetTotalCount()\n\t{\n\t\treturn this.totalCount;\n\t}\n\n\tsetTotalCount(totalCount)\n\t{\n\t\tthis.totalCount = totalCount;\n\t}\n\n\tgetMembers()\n\t{\n\t\treturn this.members;\n\t}\n\n\tsetMembers(members)\n\t{\n\t\tconst types = {\n\t\t\tA: 'accomplice',\n\t\t\tU: 'auditor',\n\t\t};\n\n\t\tthis.members.clear();\n\n\t\tObject.keys(members).forEach((id) => {\n\t\t\tconst { ID, NAME, TYPE, IS_COLLABER: isCollaber } = members[id];\n\t\t\tconst userId = Number(ID);\n\t\t\tthis.members.set(userId, { id: userId, nameFormatted: Text.encode(NAME), type: types[TYPE], isCollaber });\n\t\t});\n\t}\n\n\taddMember(member)\n\t{\n\t\tthis.members.set(member.id, member);\n\t}\n\n\tremoveMember(id)\n\t{\n\t\tthis.members.delete(id);\n\t}\n\n\tgetAttachments()\n\t{\n\t\treturn this.attachments;\n\t}\n\n\tsetAttachments(attachments)\n\t{\n\t\tthis.attachments = attachments;\n\t}\n\n\taddAttachments(attachments)\n\t{\n\t\tObject.keys(attachments).forEach((id) => {\n\t\t\tthis.attachments[id] = attachments[id];\n\t\t});\n\t}\n\n\tremoveAttachment(id)\n\t{\n\t\tdelete this.attachments[id];\n\t}\n}\n\nexport {CheckListItemFields};\n","import 'ui.design-tokens';\nimport './css/check-list-item.css';\n\nimport { Dom, Event, Loc, Runtime, Tag, Text } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport { CompositeTreeItem } from './composite-tree-item';\nimport { CheckListItemFields } from './check-list-item-fields';\n\nclass CheckListItem extends CompositeTreeItem\n{\n\tclass = CheckListItem;\n\n\tcheckedClass = 'tasks-checklist-item-solved';\n\thiddenClass = 'tasks-checklist-item-hidden';\n\tcollapseClass = 'tasks-checklist-collapse';\n\twrapperClass = 'tasks-checklist-items-wrapper';\n\n\tshowClass = 'tasks-checklist-item-show';\n\thideClass = 'tasks-checklist-item-hide';\n\n\tskipUpdateClasses = {\n\t\theader: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t],\n\t\titem: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t\t'.tasks-checklist-item-important',\n\t\t\t'.tasks-checklist-item-dragndrop',\n\t\t\t'.tasks-checklist-item-group-checkbox',\n\t\t\t'.tasks-checklist-item-remove',\n\t\t\t'.tasks-checklist-item-flag-block',\n\t\t],\n\t};\n\n\tstatic addDangerToElement(element)\n\t{\n\t\tconst dangerClass = 'ui-ctl-danger';\n\n\t\tif (!Dom.hasClass(element, dangerClass))\n\t\t{\n\t\t\tDom.addClass(element, dangerClass);\n\t\t}\n\t}\n\n\tstatic updateParents(oldParent, newParent)\n\t{\n\t\tif (oldParent !== newParent)\n\t\t{\n\t\t\toldParent.updateCounts();\n\t\t\tnewParent.updateCounts();\n\n\t\t\toldParent.updateProgress();\n\t\t\tnewParent.updateProgress();\n\n\t\t\toldParent.updateIndexes();\n\t\t\tnewParent.updateIndexes();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewParent.updateIndexes();\n\t\t}\n\t}\n\n\tstatic getProgressText(completed, total)\n\t{\n\t\tconst replaces = {\n\t\t\t'#total#': total,\n\t\t\t'#completed#': completed,\n\t\t};\n\t\tlet progressText = Loc.getMessage('TASKS_CHECKLIST_PROGRESS_BAR_PROGRESS_TEXT');\n\n\t\tObject.keys(replaces).forEach((search) => {\n\t\t\tprogressText = progressText.replace(search, replaces[search]);\n\t\t});\n\n\t\treturn progressText;\n\t}\n\n\tstatic getFileExtension(ext)\n\t{\n\t\tlet fileExtension;\n\n\t\tswitch (ext)\n\t\t{\n\t\t\tcase 'mp4':\n\t\t\tcase 'mkv':\n\t\t\tcase 'mpeg':\n\t\t\tcase 'avi':\n\t\t\tcase '3gp':\n\t\t\tcase 'flv':\n\t\t\tcase 'm4v':\n\t\t\tcase 'ogg':\n\t\t\tcase 'swf':\n\t\t\tcase 'wmv':\n\t\t\t\tfileExtension = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'txt':\n\t\t\t\tfileExtension = 'txt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'doc':\n\t\t\tcase 'docx':\n\t\t\t\tfileExtension = 'doc';\n\t\t\t\tbreak;\n\n\t\t\tcase 'xls':\n\t\t\tcase 'xlsx':\n\t\t\t\tfileExtension = 'xls';\n\t\t\t\tbreak;\n\n\t\t\tcase 'php':\n\t\t\t\tfileExtension = 'php';\n\t\t\t\tbreak;\n\n\t\t\tcase 'pdf':\n\t\t\t\tfileExtension = 'pdf';\n\t\t\t\tbreak;\n\n\t\t\tcase 'ppt':\n\t\t\tcase 'pptx':\n\t\t\t\tfileExtension = 'ppt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'rar':\n\t\t\t\tfileExtension = 'rar';\n\t\t\t\tbreak;\n\n\t\t\tcase 'zip':\n\t\t\t\tfileExtension = 'zip';\n\t\t\t\tbreak;\n\n\t\t\tcase 'set':\n\t\t\t\tfileExtension = 'set';\n\t\t\t\tbreak;\n\n\t\t\tcase 'mov':\n\t\t\t\tfileExtension = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'img':\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\t\t\tcase 'gif':\n\t\t\t\tfileExtension = 'img';\n\t\t\t\tbreak;\n\n\t\t\tcase 'flp':\n\t\t\tcase 'board':\n\t\t\t\tfileExtension = 'board';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tfileExtension = 'empty';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn fileExtension;\n\t}\n\n\tstatic getInputSelection(input)\n\t{\n\t\tlet start = 0;\n\t\tlet end = 0;\n\t\tlet normalizedValue;\n\t\tlet range;\n\t\tlet textInputRange;\n\t\tlet len;\n\t\tlet endRange;\n\n\t\tif (typeof input.selectionStart === 'number' && typeof input.selectionEnd === 'number')\n\t\t{\n\t\t\tstart = input.selectionStart;\n\t\t\tend = input.selectionEnd;\n\t\t}\n\t\telse\n\t\t{\n\t\t\trange = document.selection.createRange();\n\n\t\t\tif (range && range.parentElement() === input)\n\t\t\t{\n\t\t\t\tlen = input.value.length;\n\t\t\t\tnormalizedValue = input.value.replace(/\\r\\n/g, '\\n');\n\n\t\t\t\t// Create a working TextRange that lives only in the input\n\t\t\t\ttextInputRange = input.createTextRange();\n\t\t\t\ttextInputRange.moveToBookmark(range.getBookmark());\n\n\t\t\t\t// Check if the start and end of the selection are at the very end\n\t\t\t\t// of the input, since moveStart/moveEnd doesn't return what we want\n\t\t\t\t// in those cases\n\t\t\t\tendRange = input.createTextRange();\n\t\t\t\tendRange.collapse(false);\n\n\t\t\t\tif (textInputRange.compareEndPoints('StartToEnd', endRange) > -1)\n\t\t\t\t{\n\t\t\t\t\tstart = len;\n\t\t\t\t\tend = len;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstart = -textInputRange.moveStart('character', -len);\n\t\t\t\t\tstart += normalizedValue.slice(0, start).split('\\n').length - 1;\n\n\t\t\t\t\tif (textInputRange.compareEndPoints('EndToEnd', endRange) > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tend = len;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tend = -textInputRange.moveEnd('character', -len);\n\t\t\t\t\t\tend += normalizedValue.slice(0, end).split('\\n').length - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn { start, end };\n\t}\n\n\tstatic getDefaultCheckListTitle(title)\n\t{\n\t\tlet defaultTitle = title;\n\n\t\tif (title.indexOf('BX_CHECKLIST') === 0)\n\t\t{\n\t\t\tif (title === 'BX_CHECKLIST')\n\t\t\t{\n\t\t\t\tdefaultTitle = Loc.getMessage('TASKS_CHECKLIST_DEFAULT_DISPLAY_TITLE_2');\n\t\t\t}\n\t\t\telse if (title.match(/BX_CHECKLIST_\\d+$/))\n\t\t\t{\n\t\t\t\tconst itemNumber = title.replace('BX_CHECKLIST_', '');\n\t\t\t\tdefaultTitle = Loc.getMessage('TASKS_CHECKLIST_DEFAULT_DISPLAY_TITLE_WITH_NUMBER').replace(\n\t\t\t\t\t'#ITEM_NUMBER#',\n\t\t\t\t\titemNumber,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn defaultTitle;\n\t}\n\n\tstatic smoothScroll(node)\n\t{\n\t\tconst posFrom = BX.GetWindowScrollPos().scrollTop;\n\t\tconst posTo = BX.pos(node).top - Math.round(BX.GetWindowInnerSize().innerHeight / 2);\n\t\tconst toBottom = posFrom < posTo;\n\t\tconst distance = Math.abs(posTo - posFrom);\n\t\tconst speed = (Math.round(distance / 100) > 20 ? 20 : Math.round(distance / 100));\n\t\tconst step = speed / 2;\n\n\t\tif (step <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet posCurrent = (toBottom ? posFrom + step : posFrom - step);\n\t\tlet timer = 0;\n\n\t\tif (toBottom)\n\t\t{\n\t\t\tfor (let i = posFrom; i < posTo; i += step)\n\t\t\t{\n\t\t\t\tsetTimeout(`window.scrollTo(0, ${posCurrent})`, timer * speed);\n\n\t\t\t\tposCurrent += step;\n\t\t\t\tif (posCurrent > posTo)\n\t\t\t\t{\n\t\t\t\t\tposCurrent = posTo;\n\t\t\t\t}\n\t\t\t\ttimer += 1;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor (let i = posFrom; i > posTo; i -= step)\n\t\t\t{\n\t\t\t\tsetTimeout(`window.scrollTo(0, ${posCurrent})`, timer * speed);\n\n\t\t\t\tposCurrent -= step;\n\t\t\t\tif (posCurrent < posTo)\n\t\t\t\t{\n\t\t\t\t\tposCurrent = posTo;\n\t\t\t\t}\n\t\t\t\ttimer += 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getMemberLinkLayout(type, name, url, isCollaber)\n\t{\n\t\tconst messageId = `TASKS_CHECKLIST_${type.toUpperCase()}_ICON_HINT`;\n\t\treturn `\n\t\t\t<span class=\"tasks-checklist-item-auditor\">\n\t\t\t\t<a class=\"tasks-checklist-item-${type}-icon\" title=\"${Loc.getMessage(messageId)}\"></a>\n\t\t\t\t<a href=\"${url}\" class=\"tasks-checklist-item-${type}-link ${isCollaber ? 'tasks-checklist-item-collaber' : ''}\">${name}</a>\n\t\t\t</span> \n\t\t`;\n\t}\n\n\tstatic getLinkLayout(url)\n\t{\n\t\treturn `<a class=\"tasks-checklist-item-link\" href=\"${url}\" target=\"_blank\">${url}</a>`;\n\t}\n\n\tstatic get keyCodes()\n\t{\n\t\treturn {\n\t\t\tesc: 27,\n\t\t\tenter: 13,\n\t\t\tplus: 43,\n\t\t\tatsign: 64,\n\t\t\ttab: 9,\n\t\t\tup: 38,\n\t\t\tdown: 40,\n\t\t\tbackspace: 8,\n\t\t};\n\t}\n\n\tconstructor(fields = {})\n\t{\n\t\tconst { action } = fields;\n\n\t\tsuper();\n\t\tthis.fields = new CheckListItemFields(fields);\n\t\tthis.action = {\n\t\t\tcanUpdate: (action && 'MODIFY' in action) ? action.MODIFY : true,\n\t\t\tcanRemove: (action && 'REMOVE' in action) ? action.REMOVE : true,\n\t\t\tcanToggle: (action && 'TOGGLE' in action) ? action.TOGGLE : true,\n\t\t\tcanDrag: (action && 'DRAG' in action) ? action.DRAG : true,\n\t\t};\n\n\t\tthis.input = null;\n\t\tthis.panel = null;\n\t\tthis.progress = null;\n\t\tthis.filesLoaderPopup = null;\n\t\tthis.filesLoaderProgressBars = new Map();\n\t\tthis.updateMode = false;\n\t}\n\n\tadd(item, position = null)\n\t{\n\t\tsuper.add(item, position);\n\n\t\titem.optionManager = this.optionManager;\n\t\titem.clickEventHandler = this.clickEventHandler;\n\t}\n\n\tisTaskRoot()\n\t{\n\t\treturn this.getNodeId() === 0 && this.getParent() === null;\n\t}\n\n\tisCheckList()\n\t{\n\t\treturn !this.isTaskRoot() && this.getParent().isTaskRoot();\n\t}\n\n\tgetCheckList()\n\t{\n\t\tlet parent = this;\n\n\t\twhile (!parent.getParent().isTaskRoot())\n\t\t{\n\t\t\tparent = parent.getParent();\n\t\t}\n\n\t\treturn parent;\n\t}\n\n\tfindById(id)\n\t{\n\t\tif (!id)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.fields.getId() && this.fields.getId().toString() === id.toString())\n\t\t{\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = descendant.findById(id);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tcountCompletedCount(recursively = false)\n\t{\n\t\tlet completedCount = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (descendant.fields.getIsComplete())\n\t\t\t{\n\t\t\t\tcompletedCount += 1;\n\t\t\t}\n\n\t\t\tif (recursively)\n\t\t\t{\n\t\t\t\tcompletedCount += descendant.countCompletedCount(recursively);\n\t\t\t}\n\t\t});\n\n\t\treturn completedCount;\n\t}\n\n\tcountTotalCount(recursively = false)\n\t{\n\t\tlet totalCount = 0;\n\n\t\tif (!recursively)\n\t\t{\n\t\t\ttotalCount = this.getDescendantsCount();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\ttotalCount += 1;\n\t\t\t\ttotalCount += descendant.countTotalCount(recursively);\n\t\t\t});\n\t\t}\n\n\t\treturn totalCount;\n\t}\n\n\tupdateCompletedCount()\n\t{\n\t\tconst completedCount = this.countCompletedCount();\n\t\tthis.fields.setCompletedCount(completedCount);\n\t}\n\n\tupdateTotalCount()\n\t{\n\t\tconst totalCount = this.countTotalCount();\n\t\tthis.fields.setTotalCount(totalCount);\n\t}\n\n\tupdateCounts()\n\t{\n\t\tthis.updateCompletedCount();\n\t\tthis.updateTotalCount();\n\t}\n\n\tupdateProgress()\n\t{\n\t\tif (this.progress === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst total = this.fields.getTotalCount();\n\t\tconst completed = this.fields.getCompletedCount();\n\n\t\tthis.progress.setMaxValue(total);\n\t\tthis.progress.update(completed);\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\tthis.updateProgressText(completed, total);\n\t\t}\n\t}\n\n\tupdateProgressText(completed, total)\n\t{\n\t\tconst progressText = CheckListItem.getProgressText(completed, total);\n\t\tthis.progress.setTextAfter(progressText);\n\t}\n\n\tsetDefaultStyles(layout, action = 'add')\n\t{\n\t\tif (action === 'add')\n\t\t{\n\t\t\tlayout.style.overflow = 'hidden';\n\t\t\tlayout.style.height = 0;\n\t\t\tlayout.style.opacity = 0;\n\n\t\t\tDom.addClass(layout, this.showClass);\n\t\t}\n\t\telse if (action === 'delete')\n\t\t{\n\t\t\tlayout.style.overflow = 'hidden';\n\t\t\tlayout.style.height = `${layout.scrollHeight}px`;\n\t\t\tlayout.style.opacity = 1;\n\n\t\t\tDom.addClass(layout, this.hideClass);\n\t\t}\n\t}\n\n\tdelete()\n\t{\n\t\tconst parent = this.getParent();\n\n\t\tparent.remove(this);\n\t\tparent.updateCounts();\n\t\tparent.updateProgress();\n\n\t\tthis.setDefaultStyles(this.container, 'delete');\n\n\t\tsetTimeout(() => {\n\t\t\tthis.container.style.height = 0;\n\t\t\tthis.container.style.opacity = 0;\n\t\t\tthis.container.style.paddingTop = 0;\n\t\t}, 1);\n\n\t\tsetTimeout(() => {\n\t\t\tDom.remove(this.container);\n\t\t}, 250);\n\t}\n\n\trestore()\n\t{\n\t\tconst parent = this.getParent();\n\t\tconst position = this.fields.getSortIndex();\n\n\t\tif (position === 0)\n\t\t{\n\t\t\tif (parent.getDescendantsCount() > 0)\n\t\t\t{\n\t\t\t\tparent.addCheckListItem(this, parent.getFirstDescendant(), 'before');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparent.addCheckListItem(this);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparent.addCheckListItem(this, parent.getDescendants()[position - 1]);\n\t\t}\n\t}\n\n\tdeleteAction(showBalloon = true)\n\t{\n\t\tconst title = this.fields.getTitle();\n\n\t\tthis.delete();\n\n\t\tif (showBalloon && title.length > 0 && title !== '')\n\t\t{\n\t\t\tconst action = 'DELETE';\n\t\t\tconst data = {\n\t\t\t\ttype: this.isCheckList() ? 'CHECKLIST' : 'ITEM',\n\t\t\t};\n\n\t\t\tthis.getNotificationBalloon(action, data);\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action: 'delete' });\n\n\t\tthis.input = null;\n\t\tthis.updateMode = false;\n\t}\n\n\tonDeleteClick(e)\n\t{\n\t\te.preventDefault();\n\n\t\tDom.hide(this.getRootNode().panel);\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tconst items = this.getSelectedItems();\n\t\t\tconst action = 'DELETE_SELECTED';\n\t\t\tconst data = { items };\n\n\t\t\tthis.runForEachSelectedItem((item) => {\n\t\t\t\titem.fields.setIsSelected(false);\n\t\t\t\titem.deleteAction(false);\n\t\t\t});\n\n\t\t\titems.forEach((item) => {\n\t\t\t\titem.getParent().updateIndexes();\n\t\t\t\titem.handleCheckListChanges();\n\t\t\t});\n\n\t\t\tthis.getNotificationBalloon(action, data);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deleteAction();\n\t\tthis.getParent().updateIndexes();\n\n\t\tthis.handleCheckListChanges();\n\t}\n\n\tgetNotificationBalloon(action, data)\n\t{\n\t\tconst actions = [];\n\t\tlet content = '';\n\n\t\tswitch (action)\n\t\t{\n\t\t\tcase 'DELETE':\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}_${data.type}`);\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_CHECKLIST_NOTIFICATION_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon) => {\n\t\t\t\t\t\t\tballoon.close();\n\n\t\t\t\t\t\t\tthis.restore();\n\t\t\t\t\t\t\tthis.handleCheckListChanges();\n\t\t\t\t\t\t\tthis.handleTaskOptions();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'DELETE_SELECTED':\n\t\t\t{\n\t\t\t\tcontent = Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}_ITEMS`);\n\t\t\t\tactions.push({\n\t\t\t\t\ttitle: Loc.getMessage('TASKS_CHECKLIST_NOTIFICATION_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: (event, balloon) => {\n\t\t\t\t\t\t\tballoon.close();\n\n\t\t\t\t\t\t\tdata.items.forEach((item) => {\n\t\t\t\t\t\t\t\titem.restore();\n\t\t\t\t\t\t\t\titem.handleCheckListChanges();\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.handleTaskOptions();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'AUDITOR_ADDED':\n\t\t\tcase 'ACCOMPLICE_ADDED':\n\t\t\t{\n\t\t\t\tlet image = '';\n\t\t\t\tif (data.avatar)\n\t\t\t\t{\n\t\t\t\t\timage = Tag.render`\n\t\t\t\t\t\t<img class=\"tasks-checklist-notification-balloon-avatar-img\" src=\"${encodeURI(data.avatar)}\" alt=\"\"/>\n\t\t\t\t\t`;\n\t\t\t\t}\n\t\t\t\tcontent = Tag.render`\n\t\t\t\t\t<div class=\"tasks-checklist-notification-balloon-message-container\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-notification-balloon-avatar\">\n\t\t\t\t\t\t\t${image}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class=\"tasks-checklist-notification-balloon-message\">\n\t\t\t\t\t\t\t${Loc.getMessage(`TASKS_CHECKLIST_NOTIFICATION_BALLOON_ACTION_${action}`)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tBX.loadExt('ui.notification').then(() => {\n\t\t\tBX.UI.Notification.Center.notify({ content, actions });\n\t\t});\n\t}\n\n\tonToAnotherCheckListClick(e)\n\t{\n\t\tconst rootNode = this.getRootNode();\n\n\t\tif (rootNode.getDescendantsCount() === 1)\n\t\t{\n\t\t\tthis.moveToNewCheckList(2);\n\t\t\treturn;\n\t\t}\n\n\t\tnew BX.PopupMenuWindow(\n\t\t\t'to-another-checklist',\n\t\t\te.target,\n\t\t\tthis.getToAnotherCheckListPopupItems(),\n\t\t\t{\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\toffsetLeft: e.target.offsetWidth / 3,\n\t\t\t\tangle: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose()\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t).show();\n\t}\n\n\tgetToAnotherCheckListPopupItems()\n\t{\n\t\tconst selectMode = this.checkSelectedItems();\n\t\tconst popupMenuItems = [];\n\t\tconst toNewCheckListMenuItem = {\n\t\t\ttext: Tag.message`+ ${'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST_POPUP_NEW_CHECKLIST'}`,\n\t\t\tonclick: (event, item) => {\n\t\t\t\titem.getMenuWindow().close();\n\t\t\t\tthis.moveToNewCheckList(this.getRootNode().getDescendantsCount() + 1);\n\t\t\t},\n\t\t};\n\n\t\tif (selectMode)\n\t\t{\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\tpopupMenuItems.push({\n\t\t\t\t\ttext: descendant.fields.getTitle(),\n\t\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\t\titem.getMenuWindow().close();\n\n\t\t\t\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\t\t\t\tselectedItem.makeChildOf(descendant);\n\t\t\t\t\t\t\tdescendant.unselectAll();\n\n\t\t\t\t\t\t\tif (!this.checkSelectedItems())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tpopupMenuItems.push({ delimiter: true });\n\t\t\tpopupMenuItems.push(toNewCheckListMenuItem);\n\n\t\t\treturn popupMenuItems;\n\t\t}\n\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkLists = this.getRootNode().getDescendants().filter(item => item !== checkList);\n\n\t\tcheckLists.forEach((descendant) => {\n\t\t\tpopupMenuItems.push({\n\t\t\t\ttext: descendant.fields.getTitle(),\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t\tthis.makeChildOf(descendant);\n\t\t\t\t\tthis.handleUpdateEnding();\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tpopupMenuItems.push({ delimiter: true });\n\t\tpopupMenuItems.push(toNewCheckListMenuItem);\n\n\t\treturn popupMenuItems;\n\t}\n\n\tmoveToNewCheckList(number)\n\t{\n\t\tconst title = `${Loc.getMessage('TASKS_CHECKLIST_NEW_CHECKLIST_TITLE')}`.replace('#ITEM_NUMBER#', number);\n\t\tconst newCheckList = new CheckListItem({ TITLE: title });\n\n\t\tthis.getRootNode().addCheckListItem(newCheckList).then(() => {\n\t\t\tif (this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\t\tselectedItem.makeChildOf(newCheckList);\n\t\t\t\t\tnewCheckList.unselectAll();\n\n\t\t\t\t\tif (!this.checkSelectedItems())\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.makeChildOf(newCheckList);\n\t\t\t\tthis.handleUpdateEnding();\n\t\t\t}\n\t\t});\n\t}\n\n\tprocessMemberSelect(member)\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tconst title = selectedItem.fields.getTitle();\n\t\t\t\tconst space = (title.slice(-1) === ' ' ? '' : ' ');\n\t\t\t\tconst newTitle = `${title}${space}${member.nameFormatted}`;\n\n\t\t\t\tselectedItem.fields.addMember(member);\n\t\t\t\tselectedItem.updateTitle(Text.decode(newTitle));\n\t\t\t\tselectedItem.updateTitleNode();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst inputText = this.input.value;\n\t\tconst mentioned = +this.mentioned;\n\t\tconst start = this.inputCursorPosition.start || 0;\n\t\tconst startSpace = (start === 0 || start - mentioned === 0 || inputText.charAt(start - mentioned - 1) === ' ') ? '' : ' ';\n\t\tconst endSpace = (inputText.charAt(start) === ' ' ? '' : ' ');\n\n\t\tthis.fields.addMember(member);\n\n\t\tconst newInputText = `${inputText.slice(\n\t\t\t0,\n\t\t\tstart - mentioned,\n\t\t)}${startSpace}${Text.decode(member.nameFormatted)}${endSpace}`;\n\n\t\tthis.inputCursorPosition.start = newInputText.length;\n\t\tthis.inputCursorPosition.end = newInputText.length;\n\n\t\tthis.input.value = `${newInputText}${inputText.slice(start)}`;\n\t\tthis.mentioned = false;\n\n\t\tthis.retrieveFocus();\n\t}\n\n\tonSocNetSelectorAuditorSelected(auditor)\n\t{\n\t\tconst type = 'auditor';\n\t\tconst userData = this.prepareUserData(auditor);\n\t\tconst resultAuditor = { ...userData, type };\n\n\t\tconst notificationAction = `${type.toUpperCase()}_ADDED`;\n\t\tconst notificationData = { avatar: auditor.avatar };\n\n\t\tthis.processMemberSelect(resultAuditor);\n\t\tthis.getNotificationBalloon(notificationAction, notificationData);\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:auditorAdded', userData);\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action: 'addAuditor' });\n\t}\n\n\tonSocNetSelectorAccompliceSelected(accomplice)\n\t{\n\t\tconst type = 'accomplice';\n\t\tconst userData = this.prepareUserData(accomplice);\n\t\tconst resultAccomplice = { ...userData, type };\n\n\t\tconst notificationAction = `${type.toUpperCase()}_ADDED`;\n\t\tconst notificationData = { avatar: accomplice.avatar };\n\n\t\tthis.processMemberSelect(resultAccomplice);\n\t\tthis.getNotificationBalloon(notificationAction, notificationData);\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:accompliceAdded', userData);\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action: 'addAccomplice' });\n\t}\n\n\tprepareUserData(user)\n\t{\n\t\tconst customData = user.getCustomData();\n\t\tconst entityType = user.getEntityType();\n\n\t\treturn {\n\t\t\tavatar: user.avatar,\n\t\t\tdescription: '',\n\t\t\tentityType: 'U',\n\t\t\tid: user.getId(),\n\t\t\tname: customData.get('name'),\n\t\t\tlastName: customData.get('lastName'),\n\t\t\temail: customData.get('email'),\n\t\t\tnameFormatted: Text.encode(user.getTitle()),\n\t\t\tnetworkId: '',\n\t\t\ttype: {\n\t\t\t\tcrmemail: false,\n\t\t\t\textranet: (entityType === 'extranet'),\n\t\t\t\temail: (entityType === 'email'),\n\t\t\t\tnetwork: (entityType === 'network'),\n\t\t\t},\n\t\t\tisCollaber: (entityType === 'collaber'),\n\t\t};\n\t}\n\n\tgetMemberSelector(e, memberType = 'auditor', mentioned = false)\n\t{\n\t\tif (!this.checkCanAddAccomplice())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst typeFunctionMap = {\n\t\t\tauditor: this.onSocNetSelectorAuditorSelected.bind(this),\n\t\t\taccomplice: this.onSocNetSelectorAccompliceSelected.bind(this),\n\t\t};\n\t\tconst typeFunction = typeFunctionMap[memberType] || typeFunctionMap.auditor;\n\n\t\tthis.isSelectorLoading = true;\n\n\t\tRuntime.loadExtension('ui.entity-selector').then(exports => {\n\t\t\tconst { Dialog } = exports;\n\t\t\tconst dialog = new Dialog({\n\t\t\t\ttargetNode: e.target,\n\t\t\t\tenableSearch: true,\n\t\t\t\tmultiple: false,\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tinviteGuestLink: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t\temailUsers: true,\n\t\t\t\t\t\t\tnetworkUsers: this.optionManager.isNetworkEnabled,\n\t\t\t\t\t\t\textranetUsers: true,\n\t\t\t\t\t\t\tanalyticModuleName: 'task',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\t'onLoad': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.isSelectorLoading = false;\n\t\t\t\t\t},\n\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.isSelectorLoading = false;\n\t\t\t\t\t\tthis.mentioned = mentioned;\n\t\t\t\t\t\tthis.retrieveFocus();\n\n\t\t\t\t\t\tconst { item: selectedItem } = event.getData();\n\t\t\t\t\t\ttypeFunction(selectedItem);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t\tdialog.show();\n\t\t});\n\t}\n\n\tonAddAuditorClick(e)\n\t{\n\t\tthis.getMemberSelector(e, 'auditor');\n\t}\n\n\tonAddAccompliceClick(e)\n\t{\n\t\tthis.getMemberSelector(e, 'accomplice');\n\t}\n\n\tonUploadAttachmentClick(e)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst { prefix, diskUrls } = this.optionManager;\n\t\tconst { urlSelect, urlRenameFile, urlDeleteFile, urlUpload } = diskUrls;\n\n\t\tif (this.filesLoaderPopup === null)\n\t\t{\n\t\t\tthis.filesLoaderPopup = new BX.PopupWindow({\n\t\t\t\tcontent: this.getAttachmentsLoaderLayout(),\n\t\t\t\tbindElement: e.target,\n\t\t\t\toffsetLeft: e.target.offsetWidth / 2,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tangle: true,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.filesLoaderPopup.setBindElement(e.target);\n\t\t}\n\n\t\tthis.filesLoaderPopup.show();\n\n\t\tBX.Disk.UF.add({\n\t\t\tUID: nodeId,\n\t\t\tcontrolName: `${prefix}[${nodeId}][UF_CHECKLIST_FILES][]`,\n\t\t\thideSelectDialog: false,\n\t\t\turlSelect,\n\t\t\turlRenameFile,\n\t\t\turlDeleteFile,\n\t\t\turlUpload,\n\t\t});\n\n\t\tBX.onCustomEvent(\n\t\t\tthis.filesLoaderPopup.contentContainer.querySelector('#files_chooser'),\n\t\t\t'DiskLoadFormController',\n\t\t\t['show'],\n\t\t);\n\t}\n\n\tonDeleteAttachmentClick(fileId)\n\t{\n\t\tthis.fields.removeAttachment(fileId);\n\t\tDom.remove(this.getAttachmentsContainer().querySelector(`#disk-attach-${fileId}`));\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action: 'deleteAttachment' });\n\t}\n\n\tgetPanelBodyLayout()\n\t{\n\t\tconst membersLayout = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-auditor\" onclick=\"${this.onAddAuditorClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Tag.message`+ ${'TASKS_CHECKLIST_PANEL_AUDITOR'}`}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-accomplice\" onclick=\"${this.onAddAccompliceClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Tag.message`+ ${'TASKS_CHECKLIST_PANEL_ACCOMPLICE'}`}</span>\n\t\t\t</div>\n\t\t`;\n\t\tconst attachmentButtonLayout = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-attachment\" onclick=\"${this.onUploadAttachmentClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t\tconst itemsActionButtonsLayout = Tag.render`\n\t\t\t${this.checkSelectedItems() ? '' : attachmentButtonLayout}\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-tabin\" onclick=\"${this.onTabInClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-tabout\" onclick=\"${this.onTabOutClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-important\n\t\t\t\t${this.fields.getIsImportant() ? ' tasks-checklist-item-editor-panel-btn-important-selected' : ''}\" onclick=\"${this.onImportantClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Loc.getMessage('TASKS_CHECKLIST_PANEL_IMPORTANT')}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-checklist\" onclick=\"${this.onToAnotherCheckListClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-text\">${Loc.getMessage(\n\t\t\t'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST')}</span>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-separator\"></div>\n\t\t\t<div class=\"tasks-checklist-item-editor-panel-btn tasks-checklist-item-editor-panel-btn-remove\" onclick=\"${this.onDeleteClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t<span class=\"tasks-checklist-item-editor-panel-icon\"></span>\n\t\t\t</div>\n\t\t`;\n\t\tconst separator = Tag.render`<div class=\"tasks-checklist-item-editor-panel-separator\"></div>`;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-editor-panel ${this.isTaskRoot() || this.isCheckList() ? 'tasks-checklist-item-editor-group-panel' : ''}\">\n\t\t\t\t${this.checkCanAddAccomplice() ? membersLayout : ''}\n\t\t\t\t${this.checkCanAddAccomplice() && !this.isCheckList() ? separator : ''}\n\t\t\t\t${!this.isCheckList() ? itemsActionButtonsLayout : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tupdateTitle(text)\n\t{\n\t\tthis.fields.setTitle(text);\n\t}\n\n\tupdateTitleNode()\n\t{\n\t\tDom.replace(this.getTitleNodeContainer(), this.getTitleLayout());\n\t}\n\n\tgetTitleLayout()\n\t{\n\t\tconst { userPath } = this.optionManager;\n\t\tconst escapeRegExp = (string) => string.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n\t\tlet title = this.fields.getTitle();\n\n\t\ttitle = (this.isCheckList() ? CheckListItem.getDefaultCheckListTitle(title) : title);\n\n\t\tthis.fields.getMembers().forEach(({ id, nameFormatted, type, isCollaber }) => {\n\t\t\tconst regExp = new RegExp(escapeRegExp(nameFormatted), 'g');\n\t\t\tconst url = userPath.replace('#user_id#', id).replace('#USER_ID#', id);\n\t\t\ttitle = title.replace(regExp, CheckListItem.getMemberLinkLayout(type, nameFormatted, url, isCollaber));\n\t\t});\n\n\t\ttitle = title.replace(/(https?:\\/\\/[^\\s]+)/g, url => CheckListItem.getLinkLayout(url));\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"${this.getTitleNodeClass()}\">\n\t\t\t\t${title}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tprocessMembersFromText()\n\t{\n\t\tconst membersToDelete = [];\n\n\t\tthis.fields.getMembers().forEach(({ id, nameFormatted }) => {\n\t\t\tif (this.fields.getTitle().indexOf(nameFormatted) === -1)\n\t\t\t{\n\t\t\t\tmembersToDelete.push(id);\n\t\t\t}\n\t\t});\n\n\t\tmembersToDelete.forEach((id) => {\n\t\t\tthis.fields.removeMember(id);\n\t\t});\n\t}\n\n\tupdateIndexes()\n\t{\n\t\tthis.updateSortIndexes();\n\t\tthis.updateDisplaySortIndexes();\n\t}\n\n\tupdateSortIndexes()\n\t{\n\t\tlet sortIndex = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.fields.setSortIndex(sortIndex);\n\t\t\tsortIndex += 1;\n\t\t});\n\t}\n\n\tupdateDisplaySortIndexes()\n\t{\n\t\tconst parentSortIndex = (this.isCheckList() || this.isTaskRoot() ? '' : `${this.fields.getDisplaySortIndex()}.`);\n\t\tlet localSortIndex = 0;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tlocalSortIndex += 1;\n\t\t\tconst newSortIndex = `${parentSortIndex}${localSortIndex}`;\n\n\t\t\tdescendant.fields.setDisplaySortIndex(newSortIndex);\n\n\t\t\tif (!descendant.isCheckList())\n\t\t\t{\n\t\t\t\tdescendant.container.querySelector('.tasks-checklist-item-number').innerText = newSortIndex;\n\t\t\t}\n\n\t\t\tdescendant.updateDisplaySortIndexes();\n\t\t});\n\t}\n\n\thandleTaskOptions()\n\t{\n\t\tconst { userId, showCompleted, showOnlyMine } = this.optionManager;\n\n\t\tthis.getRootNode().hideByCondition((item) => {\n\t\t\tconst isComplete = item.fields.getIsComplete();\n\t\t\tconst hasUserInMembers = item.fields.getMembers().has(userId.toString());\n\t\t\tlet condition;\n\n\t\t\tif (!showCompleted && showOnlyMine)\n\t\t\t{\n\t\t\t\tcondition = isComplete || !hasUserInMembers;\n\t\t\t}\n\t\t\telse if (!showCompleted)\n\t\t\t{\n\t\t\t\tcondition = isComplete;\n\t\t\t}\n\t\t\telse if (showOnlyMine)\n\t\t\t{\n\t\t\t\tcondition = !hasUserInMembers;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcondition = false;\n\t\t\t}\n\n\t\t\treturn condition;\n\t\t});\n\t}\n\n\thideByCondition(condition)\n\t{\n\t\tif (this.checkCanHide(condition))\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\t\tdescendant.hideByCondition(condition);\n\t\t\t});\n\t\t}\n\t}\n\n\tcheckCanHide(condition)\n\t{\n\t\tif (\n\t\t\tthis.isTaskRoot()\n\t\t\t|| this.updateMode\n\t\t\t|| Dom.hasClass(this.container, this.showClass)\n\t\t\t|| !condition(this)\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet canHide = true;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (!condition(descendant))\n\t\t\t{\n\t\t\t\tcanHide = false;\n\t\t\t}\n\t\t\telse if (canHide)\n\t\t\t{\n\t\t\t\tcanHide = descendant.checkCanHide(condition);\n\t\t\t}\n\t\t});\n\n\t\treturn canHide;\n\t}\n\n\thide()\n\t{\n\t\tDom.hide(this.container);\n\t}\n\n\tshow()\n\t{\n\t\tDom.show(this.container);\n\t}\n\n\tcheckIsComplete()\n\t{\n\t\tlet isComplete;\n\n\t\tif (this.isTaskRoot())\n\t\t{\n\t\t\tisComplete = false;\n\t\t}\n\t\telse if (this.isCheckList())\n\t\t{\n\t\t\tconst completedCount = this.countCompletedCount(true);\n\t\t\tconst totalCount = this.countTotalCount(true);\n\n\t\t\tisComplete = (completedCount === totalCount && totalCount > 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tisComplete = this.fields.getIsComplete();\n\t\t}\n\n\t\treturn isComplete;\n\t}\n\n\tcheckActiveUpdateExist()\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tlet found = false;\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (found === false)\n\t\t\t{\n\t\t\t\tfound = descendant.checkActiveUpdateExist();\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tdisableAllGroup()\n\t{\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (descendant.fields.getIsSelected())\n\t\t\t{\n\t\t\t\tdescendant.toggleGroup();\n\t\t\t}\n\t\t});\n\t}\n\n\tdisableAllUpdateModes()\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\tthis.handleUpdateEnding();\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.disableAllUpdateModes();\n\t\t});\n\t}\n\n\trememberInputState()\n\t{\n\t\tthis.input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tthis.inputCursorPosition = CheckListItem.getInputSelection(this.input);\n\t}\n\n\tclearInput(e)\n\t{\n\t\te.preventDefault();\n\n\t\tthis.container.querySelector(`#text_${this.getNodeId()}`).value = '';\n\t\tthis.retrieveFocus();\n\t}\n\n\tretrieveFocus()\n\t{\n\t\tif (this.input !== null && this.inputCursorPosition)\n\t\t{\n\t\t\tconst { start, end } = this.inputCursorPosition;\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.input.focus();\n\t\t\t\tthis.input.setSelectionRange(start, end);\n\t\t\t}, 10);\n\t\t}\n\t}\n\n\tgetUpdateModeLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-header-name tasks-checklist-header-name-edit-mode\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-after-icon ui-ctl-xs ui-ctl-no-padding ui-ctl-underline \n\t\t\t\t\t\t\t\ttasks-checklist-header-name-editor\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t\t   onkeydown=\"${this.onInputKeyDown.bind(this)}\"\n\t\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.clearInput.bind(this)}\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst progressBarLayout = new BX.UI.ProgressRound({\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 20,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-inner tasks-checklist-item-new ${this.fields.getIsComplete() ? 'tasks-checklist-item-solved' : ''}\">\n\t\t\t\t<div class=\"tasks-checklist-item-flag-block\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-flag\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-flag-element\" onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-sub-checklist-progress\">\n\t\t\t\t\t\t\t\t${progressBarLayout.getContainer()}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-element-decorate\"></span>\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-content-block\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-after-icon ui-ctl-w100\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t\t   placeholder=\"${Loc.getMessage('TASKS_CHECKLIST_NEW_ITEM_PLACEHOLDER')}\"\n\t\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t\t   onkeydown=\"${this.onInputKeyDown.bind(this)}\"\n\t\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t\t\t<button class=\"ui-ctl-after ui-ctl-icon-clear\" onclick=\"${this.clearInput.bind(this)}\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowEditorPanel(item, nodeToPosition = null)\n\t{\n\t\tconst node = nodeToPosition || item.getContainer();\n\t\tconst position = Dom.getPosition(node);\n\n\t\tif (!this.panel)\n\t\t{\n\t\t\tthis.panel = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-editor-panel-container\">\n\t\t\t\t\t${item.getPanelBodyLayout()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.panel.style.top = `${position.top}px`;\n\t\t\tthis.panel.style.left = `${position.left}px`;\n\t\t\tthis.panel.style.width = `${position.width}px`;\n\n\t\t\tDom.append(this.panel, document.body);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.replace(this.panel.querySelector('.tasks-checklist-item-editor-panel'), item.getPanelBodyLayout());\n\n\t\t\tthis.panel.style.top = `${position.top}px`;\n\t\t\tthis.panel.style.left = `${position.left}px`;\n\t\t\tthis.panel.style.width = `${position.width}px`;\n\t\t}\n\n\t\tif (!Dom.isShown(this.panel))\n\t\t{\n\t\t\tDom.show(this.panel);\n\t\t}\n\n\t\tif (\n\t\t\t(Dom.isShown(this.panel) && item.isCheckList() && !item.checkCanAddAccomplice())\n\t\t\t|| (position.left === 0 && position.right === 0 && position.width === 0)\n\t\t)\n\t\t{\n\t\t\tDom.hide(this.panel);\n\t\t}\n\t}\n\n\tenableUpdateMode()\n\t{\n\t\tconst viewModeLayout = this.getInnerContainer();\n\t\tconst updateModeLayout = this.getUpdateModeLayout();\n\n\t\tDom.addClass(viewModeLayout, this.hiddenClass);\n\t\tDom.insertBefore(updateModeLayout, viewModeLayout);\n\n\t\tthis.input = updateModeLayout.querySelector(`#text_${this.getNodeId()}`);\n\t\tthis.input.focus();\n\t\tthis.input.setSelectionRange(this.input.value.length, this.input.value.length);\n\t\tthis.inputCursorPosition = CheckListItem.getInputSelection(this.input);\n\n\t\tEvent.bind(this.input, 'beforeinput', this.onInputBeforeInput.bind(this));\n\n\t\tif (this.input.value === '' || this.input.value.length === 0)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (Dom.isShown(this.input))\n\t\t\t\t{\n\t\t\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t\t\t}\n\t\t\t}, 250);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t}\n\n\t\tthis.updateMode = true;\n\t}\n\n\tdisableUpdateMode()\n\t{\n\t\tconst currentInner = this.getInnerContainer();\n\t\tconst text = currentInner.querySelector(`#text_${this.getNodeId()}`).value.trim();\n\n\t\tthis.updateTitle(text);\n\t\tthis.processMembersFromText();\n\t\tthis.updateTitleNode();\n\n\t\tDom.removeClass(currentInner.nextElementSibling, this.hiddenClass);\n\t\tDom.remove(currentInner);\n\t\tDom.hide(this.getRootNode().panel);\n\n\t\tthis.input = null;\n\t\tthis.updateMode = false;\n\t}\n\n\tcheckCanDeleteOnUpdateEnding()\n\t{\n\t\treturn this.getDescendantsCount() === 0\n\t\t\t&& Object.keys(this.fields.getAttachments()).length === 0\n\t\t\t&& this.filesLoaderProgressBars.size === 0;\n\t}\n\n\thandleUpdateEnding(createNewItem = false)\n\t{\n\t\tconst input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tconst text = input.value.trim();\n\n\t\tif (text.length === 0)\n\t\t{\n\t\t\tif (this.checkCanDeleteOnUpdateEnding())\n\t\t\t{\n\t\t\t\tthis.deleteAction(false);\n\t\t\t\tthis.getParent().updateIndexes();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\n\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tCheckListItem.addDangerToElement(input.parentElement);\n\n\t\t\t\tif (this.input !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.getRootNode().showEditorPanel(this, this.input);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse if (createNewItem)\n\t\t{\n\t\t\tthis.getParent().addCheckListItem(null, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableUpdateMode();\n\t\t\tthis.handleTaskOptions();\n\t\t}\n\n\t\tif (this.filesLoaderPopup !== null)\n\t\t{\n\t\t\tthis.filesLoaderPopup.close();\n\t\t}\n\t}\n\n\ttoggleUpdateMode(e)\n\t{\n\t\tif (this.updateMode)\n\t\t{\n\t\t\tif (e.keyCode === CheckListItem.keyCodes.enter || e.keyCode === CheckListItem.keyCodes.tab)\n\t\t\t{\n\t\t\t\tthis.handleUpdateEnding(!this.isCheckList());\n\t\t\t}\n\t\t\telse if (e.keyCode === CheckListItem.keyCodes.esc)\n\t\t\t{\n\t\t\t\tthis.handleUpdateEnding();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst rootNode = this.getRootNode();\n\n\t\t\trootNode.disableAllUpdateModes();\n\t\t\trootNode.disableAllGroup();\n\n\t\t\tif (!rootNode.checkActiveUpdateExist())\n\t\t\t{\n\t\t\t\tthis.enableUpdateMode();\n\t\t\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action: 'toggleUpdateMode' });\n\t\t\t}\n\t\t}\n\t}\n\n\tonInputKeyDown(e)\n\t{\n\t\tif (this.isSelectorLoading)\n\t\t{\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (e.keyCode)\n\t\t{\n\t\t\tcase CheckListItem.keyCodes.esc:\n\t\t\tcase CheckListItem.keyCodes.enter:\n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t\tsetTimeout(() => this.toggleUpdateMode(e));\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.tab:\n\t\t\t{\n\t\t\t\tif (!this.isCheckList())\n\t\t\t\t{\n\t\t\t\t\t(e.shiftKey ? this.tabOut.bind(this) : this.tabIn.bind(this))();\n\t\t\t\t}\n\t\t\t\tthis.retrieveFocus();\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.up:\n\t\t\t{\n\t\t\t\tconst leftSiblingThrough = this.getLeftSiblingThrough();\n\t\t\t\tif (leftSiblingThrough && leftSiblingThrough !== this.getRootNode())\n\t\t\t\t{\n\t\t\t\t\tleftSiblingThrough.toggleUpdateMode(e);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase CheckListItem.keyCodes.down:\n\t\t\t{\n\t\t\t\tconst rightSiblingThrough = this.getRightSiblingThrough();\n\t\t\t\tif (rightSiblingThrough)\n\t\t\t\t{\n\t\t\t\t\trightSiblingThrough.toggleUpdateMode(e);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t\t// do nothing\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonInputBeforeInput(e)\n\t{\n\t\tif (this.isSelectorLoading)\n\t\t{\n\t\t\te.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tif (['+', '@'].includes(e.data))\n\t\t{\n\t\t\tthis.getMemberSelector(e, this.optionManager.defaultMemberSelectorType, true);\n\t\t}\n\t}\n\n\tonHeaderMouseDown(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseDown(e);\n\t\tthis.clickEventHandler.registerClickDoneCallback(this.onHeaderClickDone.bind(this, e));\n\t}\n\n\tonHeaderMouseUp(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseUp(e);\n\t}\n\n\tonHeaderClickDone(e)\n\t{\n\t\tif (!this.checkCanUpdate() || this.checkSkipUpdate(e, 'header'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleUpdateMode(e);\n\t}\n\n\tonInnerContainerMouseDown(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseDown(e);\n\t\tthis.clickEventHandler.registerClickDoneCallback(this.onInnerContainerClickDone.bind(this, e));\n\t}\n\n\tonInnerContainerMouseUp(e)\n\t{\n\t\tthis.clickEventHandler.handleMouseUp(e);\n\t}\n\n\tonInnerContainerClickDone(e)\n\t{\n\t\tif (!this.checkCanUpdate() || this.checkSkipUpdate(e, 'item'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getCheckList().fields.getIsSelected())\n\t\t{\n\t\t\tthis.toggleSelect(e);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleUpdateMode(e);\n\t}\n\n\tgetImportantLayout()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-important\" onclick=\"${this.onImportantClick.bind(this)}\"></div>\n\t\t`;\n\t}\n\n\ttoggleImportant()\n\t{\n\t\tif (this.fields.getIsImportant())\n\t\t{\n\t\t\tthis.fields.setIsImportant(false);\n\t\t\tDom.remove(this.container.querySelector('.tasks-checklist-item-important'));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsImportant(true);\n\t\t\tDom.insertBefore(\n\t\t\t\tthis.getImportantLayout(),\n\t\t\t\tthis.container.querySelector('.tasks-checklist-item-description'),\n\t\t\t);\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action: 'toggleImportant' });\n\n\t\tthis.retrieveFocus();\n\t}\n\n\tcheckSelectedItems()\n\t{\n\t\treturn this.getRootNode().getSelectedItems().length > 0;\n\t}\n\n\trunForEachSelectedItem(callback, reverse = false)\n\t{\n\t\tlet selectedItems = this.getRootNode().getSelectedItems();\n\n\t\tif (reverse)\n\t\t{\n\t\t\tselectedItems = [...selectedItems.reverse()];\n\t\t}\n\n\t\tselectedItems.forEach((item) => {\n\t\t\tcallback(item);\n\t\t});\n\t}\n\n\tonImportantClick(e)\n\t{\n\t\tif (!this.checkCanUpdate())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.toggleImportant();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleImportant();\n\n\t\tconst panelImportantButton = e.target.closest('.tasks-checklist-item-editor-panel-btn-important');\n\t\tif (panelImportantButton)\n\t\t{\n\t\t\tDom.toggleClass(panelImportantButton, 'tasks-checklist-item-editor-panel-btn-important-selected');\n\t\t}\n\t}\n\n\tonCompleteAllButtonClick()\n\t{\n\t\tif (this.fields.getIsSelected() || this.updateMode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.completeAll();\n\t\tthis.runAjaxCompleteAll();\n\t}\n\n\tcompleteAll(): void\n\t{\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tif (\n\t\t\t\tdescendant.checkCanToggle()\n\t\t\t\t&& !descendant.updateMode\n\t\t\t\t&& !descendant.fields.getIsComplete()\n\t\t\t)\n\t\t\t{\n\t\t\t\tdescendant.toggleComplete(false);\n\t\t\t}\n\t\t\tdescendant.completeAll();\n\t\t});\n\t}\n\n\trunAjaxCompleteAll(): void\n\t{\n\t\tconst { ajaxActions, entityId, entityType, stableTreeStructure } = this.optionManager;\n\n\t\tif (!ajaxActions || !ajaxActions.COMPLETE_ALL)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.ajax.runAction(ajaxActions.COMPLETE_ALL, {\n\t\t\tdata: {\n\t\t\t\t[`${entityType.toLowerCase()}Id`]: entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tresponse.data.forEach(item => {\n\t\t\t\tthis.findById(item.id).updateStableTreeStructure(\n\t\t\t\t\titem.isComplete,\n\t\t\t\t\tstableTreeStructure,\n\t\t\t\t\tstableTreeStructure,\n\t\t\t\t);\n\t\t\t});\n\t\t});\n\t}\n\n\tonCompleteButtonClick()\n\t{\n\t\tif (\n\t\t\tthis.getCheckList().fields.getIsSelected()\n\t\t\t|| this.updateMode\n\t\t\t|| !this.checkCanToggle()\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleComplete();\n\t}\n\n\ttoggleComplete(runAjax = true)\n\t{\n\t\tconst isComplete = this.fields.getIsComplete();\n\n\t\tthis.fields.setIsComplete(!isComplete);\n\t\tthis.getParent().updateCounts();\n\t\tthis.getParent().updateProgress();\n\n\t\tDom.toggleClass(this.getInnerContainer(), this.checkedClass);\n\n\t\tthis.handleCheckListChanges();\n\t\tthis.handleTaskOptions();\n\n\t\tif (runAjax)\n\t\t{\n\t\t\tthis.runAjaxToggleComplete();\n\t\t}\n\t}\n\n\trunAjaxToggleComplete()\n\t{\n\t\tconst id = this.fields.getId();\n\n\t\tif (!id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = {};\n\t\tconst { ajaxActions, entityId, entityType, stableTreeStructure } = this.optionManager;\n\t\tconst actionName = (this.fields.getIsComplete() ? ajaxActions.COMPLETE : ajaxActions.RENEW);\n\n\t\tdata[`${entityType.toLowerCase()}Id`] = entityId;\n\t\tdata.checkListItemId = id;\n\n\t\tBX.ajax.runAction(actionName, { data }).then((response) => {\n\t\t\tconst { isComplete } = response.data.checkListItem;\n\t\t\tthis.updateStableTreeStructure(isComplete, stableTreeStructure, stableTreeStructure);\n\t\t});\n\t}\n\n\tupdateStableTreeStructure(isComplete, item, parent)\n\t{\n\t\tif (this.fields.getId() === item.FIELDS.id)\n\t\t{\n\t\t\titem.FIELDS.isComplete = isComplete;\n\t\t\tparent.FIELDS.completedCount += (isComplete ? 1 : -1);\n\n\t\t\treturn this;\n\t\t}\n\n\t\tlet found = null;\n\t\titem.DESCENDANTS.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = this.updateStableTreeStructure(isComplete, descendant, item);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tunselectAll()\n\t{\n\t\tconst checkBox = this.container.querySelector(`#select_${this.getNodeId()}`);\n\n\t\tif (checkBox && checkBox.checked === true)\n\t\t{\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\tcheckBox.checked = false;\n\t\t\tDom.removeClass(this.getInnerContainer(), 'tasks-checklist-item-selected');\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.unselectAll();\n\t\t});\n\t}\n\n\tgetSelected()\n\t{\n\t\tlet selected = [];\n\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tselected.push(this);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tselected = [...selected, ...descendant.getSelected()];\n\t\t});\n\n\t\treturn selected;\n\t}\n\n\tgetSelectedItems()\n\t{\n\t\treturn this.getSelected().filter(item => !item.isCheckList() && !item.isTaskRoot());\n\t}\n\n\tonSelectCheckboxClick(e)\n\t{\n\t\tif (!this.checkCanUpdate())\n\t\t{\n\t\t\te.target.checked = false;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleSelect();\n\t}\n\n\ttoggleSelect()\n\t{\n\t\tconst rootNode = this.getRootNode();\n\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tthis.container.querySelector(`#select_${this.getNodeId()}`).checked = false;\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\trootNode.showEditorPanel(rootNode, this.container);\n\n\t\t\tif (!this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tDom.hide(rootNode.panel);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.container.querySelector(`#select_${this.getNodeId()}`).checked = true;\n\t\t\tthis.fields.setIsSelected(true);\n\n\t\t\trootNode.showEditorPanel(rootNode, this.container);\n\t\t}\n\n\t\tDom.toggleClass(this.getInnerContainer(), 'tasks-checklist-item-selected');\n\t}\n\n\tonGroupButtonClick()\n\t{\n\t\tif (!this.getRootNode().checkActiveUpdateExist())\n\t\t{\n\t\t\tthis.toggleGroup();\n\t\t}\n\t}\n\n\ttoggleGroup()\n\t{\n\t\tif (this.fields.getIsSelected())\n\t\t{\n\t\t\tthis.unselectAll();\n\t\t\tthis.fields.setIsSelected(false);\n\n\t\t\tif (!this.checkSelectedItems())\n\t\t\t{\n\t\t\t\tDom.hide(this.getRootNode().panel);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsSelected(true);\n\n\t\t\tif (this.fields.getIsCollapse())\n\t\t\t{\n\t\t\t\tthis.toggleCollapse();\n\t\t\t}\n\t\t}\n\n\t\tDom.toggleClass(this.container, 'tasks-checklist-item-group-editor-collapse');\n\t\tDom.toggleClass(this.container, 'tasks-checklist-item-group-editor-expand');\n\t}\n\n\tonCollapseButtonClick()\n\t{\n\t\tif (this.collapseFreezed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.toggleCollapse();\n\t}\n\n\ttoggleCollapse()\n\t{\n\t\tthis.collapseFreezed = true;\n\n\t\tconst wrapperList = this.container.querySelector(`.${this.wrapperClass}`);\n\t\tconst wrapperListHeight = `${Dom.getPosition(wrapperList).height}px`;\n\n\t\tif (!Dom.hasClass(this.container, this.collapseClass))\n\t\t{\n\t\t\tthis.fields.setIsCollapse(true);\n\n\t\t\twrapperList.style.overflow = 'hidden';\n\t\t\twrapperList.style.height = wrapperListHeight;\n\t\t\tsetTimeout(() => {\n\t\t\t\twrapperList.style.height = 0;\n\t\t\t}, 0);\n\n\t\t\tDom.addClass(this.container, this.collapseClass);\n\n\t\t\tthis.collapseFreezed = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsCollapse(false);\n\n\t\t\twrapperList.style.height = 0;\n\t\t\twrapperList.style.height = `${wrapperList.scrollHeight}px`;\n\n\t\t\tconst setAutoHeight = () => {\n\t\t\t\twrapperList.style.height = 'auto';\n\t\t\t\tBX.unbind(wrapperList, 'transitionend', setAutoHeight);\n\n\t\t\t\tthis.collapseFreezed = false;\n\t\t\t};\n\t\t\tBX.bind(wrapperList, 'transitionend', setAutoHeight);\n\n\t\t\tDom.removeClass(this.container, this.collapseClass);\n\t\t}\n\t}\n\n\ttoggleEmpty()\n\t{\n\t\tDom.toggleClass(this.container, 'tasks-checklist-empty');\n\t}\n\n\thandleCheckListIsComplete()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkListIsComplete = checkList.checkIsComplete();\n\n\t\tcheckList.fields.setIsComplete(checkListIsComplete);\n\n\t\tif (\n\t\t\tcheckListIsComplete\n\t\t\t&& !Dom.hasClass(checkList.container, 'tasks-checklist-collapse')\n\t\t\t&& this.collapseOnCompleteAll()\n\t\t)\n\t\t{\n\t\t\tcheckList.toggleCollapse();\n\t\t}\n\t}\n\n\thandleCheckListIsEmpty()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkListIsEmpty = checkList.getDescendantsCount() === 0;\n\n\t\tif (\n\t\t\t(checkListIsEmpty && !Dom.hasClass(checkList.container, 'tasks-checklist-empty'))\n\t\t\t|| (!checkListIsEmpty && Dom.hasClass(checkList.container, 'tasks-checklist-empty'))\n\t\t)\n\t\t{\n\t\t\tcheckList.toggleEmpty();\n\t\t}\n\t}\n\n\thandleCheckListChanges()\n\t{\n\t\tthis.handleCheckListIsComplete();\n\t\tthis.handleCheckListIsEmpty();\n\t}\n\n\tcheckSkipUpdate(e, area)\n\t{\n\t\treturn this.skipUpdateClasses[area]\n\t\t\t&& this.skipUpdateClasses[area].find(item => e.target.closest(item));\n\t}\n\n\tshowCompleteAllButton()\n\t{\n\t\treturn this.optionManager.getShowCompleteAllButton();\n\t}\n\n\tcollapseOnCompleteAll()\n\t{\n\t\treturn this.optionManager.getCollapseOnCompleteAll();\n\t}\n\n\tcheckCanAdd()\n\t{\n\t\treturn this.optionManager.getCanAdd();\n\t}\n\n\tcheckCanAddAccomplice()\n\t{\n\t\treturn this.optionManager.getCanAddAccomplice();\n\t}\n\n\tcheckCanUpdate()\n\t{\n\t\treturn this.action.canUpdate;\n\t}\n\n\tcheckCanRemove()\n\t{\n\t\treturn this.action.canRemove;\n\t}\n\n\tcheckCanToggle()\n\t{\n\t\treturn this.action.canToggle;\n\t}\n\n\tcheckCanDrag()\n\t{\n\t\treturn this.action.canDrag;\n\t}\n\n\tgetTitleNodeClass()\n\t{\n\t\treturn (this.isCheckList() ? 'tasks-checklist-header-name-text' : 'tasks-checklist-item-description-text');\n\t}\n\n\tgetTitleNodeContainer()\n\t{\n\t\treturn this.container.querySelector(`.${this.getTitleNodeClass()}`);\n\t}\n\n\tgetAttachmentsContainer()\n\t{\n\t\treturn this.container.querySelector(`#attachments_${this.getNodeId()}`);\n\t}\n\n\tgetSubItemsContainer()\n\t{\n\t\treturn this.container.querySelector(`#subItems_${this.getNodeId()}`);\n\t}\n\n\tgetInnerContainer()\n\t{\n\t\treturn this.container.querySelector(this.isCheckList() ? '.tasks-checklist-header-name' : '.tasks-checklist-item-inner');\n\t}\n\n\tgetContainer()\n\t{\n\t\treturn this.container;\n\t}\n\n\tmove(item, position = 'bottom', action = 'move')\n\t{\n\t\tif (\n\t\t\tthis.getNodeId() === item.getNodeId()\n\t\t\t|| this.findChild(item.getNodeId()) !== null\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst oldParent = this.getParent();\n\t\tconst newParent = item.getParent();\n\n\t\toldParent.remove(this);\n\n\t\tif (position === 'top')\n\t\t{\n\t\t\tnewParent.addBefore(this, item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewParent.addAfter(this, item);\n\t\t}\n\n\t\tCheckListItem.updateParents(oldParent, newParent);\n\n\t\tif (position === 'top')\n\t\t{\n\t\t\tDom.insertBefore(this.container, item.container);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.insertAfter(this.container, item.container);\n\t\t}\n\n\t\tthis.handleCheckListIsEmpty();\n\t\tthis.handleTaskOptions();\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action });\n\t}\n\n\tmakeChildOf(item, position = 'bottom', action = 'makeChildOf')\n\t{\n\t\tif (item.getDescendantsCount() > 0)\n\t\t{\n\t\t\tconst borderItems = {\n\t\t\t\ttop: item.getFirstDescendant(),\n\t\t\t\tbottom: item.getLastDescendant(),\n\t\t\t};\n\n\t\t\tthis.move(borderItems[position], position, action);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst oldParent = this.getParent();\n\t\t\tconst newParent = item;\n\n\t\t\toldParent.remove(this);\n\t\t\tnewParent.add(this);\n\n\t\t\tCheckListItem.updateParents(oldParent, newParent);\n\n\t\t\tDom.append(this.container, newParent.getSubItemsContainer());\n\t\t\tDom.addClass(this.container, 'mobile-task-checklist-item-wrapper-animate');\n\n\t\t\tthis.handleCheckListIsEmpty();\n\t\t\tthis.handleTaskOptions();\n\n\t\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action });\n\t\t}\n\t}\n\n\ttabIn()\n\t{\n\t\tif (!this.isFirstDescendant())\n\t\t{\n\t\t\tthis.makeChildOf(this.getLeftSibling(), 'bottom', 'tabIn');\n\t\t}\n\t}\n\n\tonTabInClick()\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.tabIn();\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tabIn();\n\t\tthis.retrieveFocus();\n\t}\n\n\ttabOut()\n\t{\n\t\tconst parent = this.getParent();\n\n\t\tif (parent.isCheckList())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.move(parent, 'bottom', 'tabOut');\n\t}\n\n\tonTabOutClick()\n\t{\n\t\tif (this.checkSelectedItems())\n\t\t{\n\t\t\tthis.runForEachSelectedItem((selectedItem) => {\n\t\t\t\tselectedItem.tabOut();\n\t\t\t}, true);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.tabOut();\n\t\tthis.retrieveFocus();\n\t}\n\n\taddCheckListItem(item = null, dependsOn = null, position = 'after')\n\t{\n\t\tconst itemGet = item instanceof this.class;\n\n\t\treturn new Promise((resolve) => {\n\t\t\tconst newCheckListItem = item || new this.class();\n\t\t\tlet newCheckListItemLayout;\n\n\t\t\tif (dependsOn instanceof this.class)\n\t\t\t{\n\t\t\t\tif (position === 'before')\n\t\t\t\t{\n\t\t\t\t\tthis.addBefore(newCheckListItem, dependsOn);\n\n\t\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\t\tDom.insertBefore(newCheckListItemLayout, dependsOn.container);\n\t\t\t\t}\n\t\t\t\telse if (position === 'after')\n\t\t\t\t{\n\t\t\t\t\tthis.addAfter(newCheckListItem, dependsOn);\n\n\t\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\t\tDom.insertAfter(newCheckListItemLayout, dependsOn.container);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.add(newCheckListItem);\n\n\t\t\t\tnewCheckListItemLayout = newCheckListItem.getLayout();\n\t\t\t\tthis.setDefaultStyles(newCheckListItemLayout);\n\n\t\t\t\tDom.append(newCheckListItemLayout, this.getSubItemsContainer());\n\t\t\t}\n\n\t\t\tthis.updateCounts();\n\t\t\tthis.updateIndexes();\n\n\t\t\tif (!this.isTaskRoot())\n\t\t\t{\n\t\t\t\tthis.updateProgress();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\n\t\t\t\tif (!itemGet)\n\t\t\t\t{\n\t\t\t\t\tnewCheckListItem.toggleUpdateMode();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnewCheckListItemLayout.style.height = `${newCheckListItemLayout.scrollHeight}px`;\n\t\t\t\tnewCheckListItemLayout.style.opacity = 1;\n\t\t\t}, 1);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnewCheckListItemLayout.style.overflow = '';\n\t\t\t\tnewCheckListItemLayout.style.height = '';\n\t\t\t\tnewCheckListItemLayout.style.opacity = '';\n\n\t\t\t\tDom.removeClass(newCheckListItemLayout, this.showClass);\n\n\t\t\t\tif (!this.isTaskRoot() && !itemGet && newCheckListItem.input !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.class.smoothScroll(newCheckListItem.getContainer());\n\t\t\t\t}\n\n\t\t\t\tresolve(newCheckListItem);\n\t\t\t}, 250);\n\t\t});\n\t}\n\n\tonAddCheckListItemClick()\n\t{\n\t\tif (this.getRootNode().checkActiveUpdateExist())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addCheckListItem();\n\t}\n\n\tgetItemRequestData()\n\t{\n\t\tconst itemRequestData = {\n\t\t\tNODE_ID: this.getNodeId(),\n\t\t\tPARENT_NODE_ID: this.getParent().getNodeId(),\n\t\t\tID: this.fields.getId(),\n\t\t\tCOPIED_ID: this.fields.getCopiedId(),\n\t\t\tPARENT_ID: this.fields.getParentId(),\n\t\t\tTITLE: Text.decode(this.fields.getTitle()),\n\t\t\tSORT_INDEX: this.fields.getSortIndex(),\n\t\t\tIS_COMPLETE: this.fields.getIsComplete(),\n\t\t\tIS_IMPORTANT: this.fields.getIsImportant(),\n\t\t\tMEMBERS: [],\n\t\t\tATTACHMENTS: {},\n\t\t};\n\n\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\tconst { nameFormatted, type } = value;\n\t\t\titemRequestData.MEMBERS.push({\n\t\t\t\t[key]: {\n\t\t\t\t\tTYPE: type,\n\t\t\t\t\tNAME: Text.decode(nameFormatted),\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tconst attachments = this.fields.getAttachments();\n\t\tObject.keys(attachments).forEach((id) => {\n\t\t\titemRequestData.ATTACHMENTS[id] = attachments[id];\n\t\t});\n\n\t\treturn itemRequestData;\n\t}\n\n\tgetRequestData(inputData = null)\n\t{\n\t\tconst title = this.fields.getTitle();\n\t\tlet data = inputData || [];\n\n\t\tif (!this.isTaskRoot() && title !== '' && title.length > 0)\n\t\t{\n\t\t\tdata.push(this.getItemRequestData());\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdata = descendant.getRequestData(data);\n\t\t});\n\n\t\treturn data;\n\t}\n\n\tappendRequestLayout()\n\t{\n\t\tif (!this.isTaskRoot())\n\t\t{\n\t\t\tconst nodeId = this.getNodeId();\n\t\t\tconst attachments = this.fields.getAttachments();\n\t\t\tconst prefix = `${this.optionManager.prefix}[${nodeId}]`;\n\n\t\t\tlet membersLayout = '';\n\t\t\tlet attachmentsLayout = '';\n\n\t\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\t\tmembersLayout += `<input type=\"hidden\" id=\"MEMBERS_TYPE_${key}\" name=\"${prefix}[MEMBERS][${key}][TYPE]\" value=\"${value.type}\"/>`;\n\t\t\t\tmembersLayout += `<input type=\"hidden\" id=\"MEMBERS_NAME_${key}\" name=\"${prefix}[MEMBERS][${key}][NAME]\" value=\"${value.nameFormatted}\"/>`;\n\t\t\t});\n\n\t\t\tObject.keys(attachments).forEach((id) => {\n\t\t\t\tattachmentsLayout += `<input type=\"hidden\" id=\"ATTACHMENTS_${id}\" name=\"${prefix}[ATTACHMENTS][${id}]\" value=\"${attachments[id]}\"/>`;\n\t\t\t});\n\n\t\t\tconst requestLayout = Tag.render`\n\t\t\t\t<div id=\"request_${nodeId}\">\n\t\t\t\t\t<input type=\"hidden\" id=\"NODE_ID\" name=\"${prefix}[NODE_ID]\" value=\"${nodeId}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"PARENT_NODE_ID\" name=\"${prefix}[PARENT_NODE_ID]\" value=\"${this.getParent().getNodeId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"ID\" name=\"${prefix}[ID]\" value=\"${this.fields.getId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"COPIED_ID\" name=\"${prefix}[COPIED_ID]\" value=\"${this.fields.getCopiedId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"PARENT_ID\" name=\"${prefix}[PARENT_ID]\" value=\"${this.fields.getParentId()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"TITLE\" name=\"${prefix}[TITLE]\" value=\"${this.fields.getTitle()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"SORT_INDEX\" name=\"${prefix}[SORT_INDEX]\" value=\"${this.fields.getSortIndex()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"IS_COMPLETE\" name=\"${prefix}[IS_COMPLETE]\" value=\"${this.fields.getIsComplete()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"IS_IMPORTANT\" name=\"${prefix}[IS_IMPORTANT]\" value=\"${this.fields.getIsImportant()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"MODIFY\" name=\"${prefix}[ACTION][MODIFY]\" value=\"${this.checkCanUpdate()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"REMOVE\" name=\"${prefix}[ACTION][REMOVE]\" value=\"${this.checkCanRemove()}\"/>\n\t\t\t\t\t<input type=\"hidden\" id=\"TOGGLE\" name=\"${prefix}[ACTION][TOGGLE]\" value=\"${this.checkCanToggle()}\"/>\n\t\t\t\t\t${membersLayout}\n\t\t\t\t\t${attachmentsLayout}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.remove(this.container.querySelector(`#request_${nodeId}`));\n\t\t\tDom.append(requestLayout, this.container);\n\t\t}\n\n\t\tthis.getDescendants().forEach((descendant) => {\n\t\t\tdescendant.appendRequestLayout();\n\t\t});\n\t}\n\n\tgetAttachmentsLayout()\n\t{\n\t\tconst searchId = this.fields.getId() || this.fields.getCopiedId() || this.fields.getNodeId();\n\t\tconst { optionManager } = this;\n\t\tconst optionAttachments = optionManager.attachments;\n\t\tlet attachmentsLayout = '';\n\n\t\tif (optionAttachments && (searchId in optionAttachments))\n\t\t{\n\t\t\tconst attachments = Tag.render`${optionAttachments[searchId]}`;\n\t\t\tconst stableAttachments = this.getStableAttachments(optionManager.getStableTreeStructure());\n\t\t\tconst attachmentsToDelete = [];\n\n\t\t\tif (!attachments)\n\t\t\t{\n\t\t\t\treturn attachmentsLayout;\n\t\t\t}\n\n\t\t\tattachmentsLayout = attachments;\n\n\t\t\tif (!Array.isArray(attachments))\n\t\t\t{\n\t\t\t\tattachmentsLayout = [attachments];\n\t\t\t}\n\n\t\t\tObject.keys(attachmentsLayout).forEach((key) => {\n\t\t\t\tconst attachment = attachmentsLayout[key];\n\t\t\t\tif ('serverPreviewUrl' in attachment)\n\t\t\t\t{\n\t\t\t\t\tattachmentsLayout[key] = this.getLoadedAttachmentLayout({\n\t\t\t\t\t\tid: attachment.serverFileId,\n\t\t\t\t\t\tname: attachment.name,\n\t\t\t\t\t\tviewUrl: attachment.serverPreviewUrl,\n\t\t\t\t\t\tsize: attachment.size,\n\t\t\t\t\t\text: attachment.name.split('.').splice(-1)[0].toLowerCase(),\n\t\t\t\t\t});\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst fileId = attachment.getAttribute('data-bx-id');\n\t\t\t\tconst extension = CheckListItem.getFileExtension(attachment.getAttribute('data-bx-extension'));\n\t\t\t\tconst extensionClass = `ui-icon-file-${extension}`;\n\t\t\t\tconst iconContainer = attachment.querySelector(`#disk-attach-file-${fileId}`);\n\t\t\t\tconst deleteButton = Tag.render`\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\"\n\t\t\t\t\t\t onclick=\"${this.onDeleteAttachmentClick.bind(this, fileId)}\"></div>\n\t\t\t\t`;\n\t\t\t\tconst has = Object.prototype.hasOwnProperty;\n\n\t\t\t\tif (!has.call(stableAttachments, fileId))\n\t\t\t\t{\n\t\t\t\t\tattachmentsToDelete.push(key);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (iconContainer && !Dom.hasClass(iconContainer, extensionClass))\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(iconContainer, extensionClass);\n\t\t\t\t}\n\n\t\t\t\tif (this.checkCanUpdate())\n\t\t\t\t{\n\t\t\t\t\tDom.append(deleteButton, attachment.querySelector('.tasks-checklist-item-attachment-file-cover'));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tattachmentsToDelete.sort((a, b) => b - a);\n\t\t\tattachmentsToDelete.forEach((id) => {\n\t\t\t\tattachmentsLayout.splice(id, 1);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setAttachments({});\n\t\t}\n\n\t\treturn attachmentsLayout;\n\t}\n\n\tgetStableAttachments(item)\n\t{\n\t\tconst fields = item.FIELDS;\n\t\tconst id = fields.id || fields.copiedId;\n\n\t\tif ((id === this.fields.getId() || id === this.fields.getCopiedId()) && (fields.nodeId === this.fields.getNodeId()))\n\t\t{\n\t\t\treturn fields.attachments;\n\t\t}\n\n\t\tlet found = null;\n\t\titem.DESCENDANTS.forEach((descendant) => {\n\t\t\tif (found === null)\n\t\t\t{\n\t\t\t\tfound = this.getStableAttachments(descendant);\n\t\t\t}\n\t\t});\n\n\t\treturn found;\n\t}\n\n\tgetLoadedAttachmentLayout(attachment)\n\t{\n\t\tconst { id, name, viewUrl, size, ext } = attachment;\n\t\tlet img = '';\n\n\t\tif (viewUrl)\n\t\t{\n\t\t\timg = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-cover\" style=\"background-image: url(${viewUrl})\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\" onclick=\"${this.onDeleteAttachmentClick.bind(\n\t\t\t\tthis,\n\t\t\t\tid,\n\t\t\t)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst extension = CheckListItem.getFileExtension(ext);\n\n\t\t\timg = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-cover\">\n\t\t\t\t\t<div class=\"ui-icon ui-icon-file-${extension}\"><i></i></div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-remove\" onclick=\"${this.onDeleteAttachmentClick.bind(\n\t\t\t\tthis,\n\t\t\t\tid,\n\t\t\t)}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-checklist-item-attachment-file\" id=\"disk-attach-${id}\" data-bx-id=\"${id}\">\n\t\t\t\t${img}\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-name\">\n\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-name-text\" title=\"${name}\">${name}</label>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-size\">\n\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-size-text\">${size}</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonAttachmentsLoaderMenuItemClick()\n\t{\n\t\tif (this.filesLoaderPopup !== null)\n\t\t{\n\t\t\tthis.filesLoaderPopup.close();\n\t\t}\n\t}\n\n\tgetAttachmentsLoaderLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst { prefix } = this.optionManager;\n\t\tconst filesChooser = Tag.render`\n\t\t\t<div id=\"files_chooser\">\n\t\t\t\t<div id=\"diskuf-selectdialog-${nodeId}\" class=\"diskuf-files-entity diskuf-selectdialog bx-disk\">\n\t\t\t\t\t<div class=\"diskuf-files-block tasks-checklist-loader-files\">\n\t\t\t\t\t\t<div class=\"diskuf-placeholder\">\n\t\t\t\t\t\t\t<table class=\"files-list\">\n\t\t\t\t\t\t\t\t<tbody class=\"diskuf-placeholder-tbody\"></tbody>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"diskuf-extended\" style=\"display: block\">\n\t\t\t\t\t\t<input type=\"hidden\" name=\"${prefix}[${nodeId}][UF_CHECKLIST_FILES][]\" value=\"\"/>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\">\n\t\t\t\t\t\t\t<label for=\"file_loader_${nodeId}\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_COMPUTER')}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input class=\"diskuf-fileUploader\" id=\"file_loader_${nodeId}\" type=\"file\"\n\t\t\t\t\t\t\t\t   multiple=\"multiple\" size=\"1\" style=\"display: none\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"diskuf-selector-link\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_B24')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"diskuf-extended-item\" onclick=\"${this.onAttachmentsLoaderMenuItemClick.bind(this)}\">\n\t\t\t\t\t\t\t<span class=\"diskuf-selector-link-cloud\" data-bx-doc-handler=\"gdrive\">\n\t\t\t\t\t\t\t\t<span>${Loc.getMessage('TASKS_CHECKLIST_FILES_LOADER_POPUP_FROM_CLOUD')}</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tBX.addCustomEvent(filesChooser, 'OnFileUploadSuccess', this.OnFileUploadSuccess.bind(this));\n\t\tBX.addCustomEvent(filesChooser, 'DiskDLoadFormControllerInit', (uf) => {\n\t\t\tuf._onUploadProgress = this.onUploadProgress.bind(this);\n\t\t});\n\n\t\treturn filesChooser;\n\t}\n\n\tonUploadProgress(item, progress)\n\t{\n\t\tconst { id, name, size } = item;\n\t\tconst newProgress = Math.min(progress, 98);\n\n\t\tif (!this.filesLoaderProgressBars.has(id))\n\t\t{\n\t\t\tconst myProgress = new BX.UI.ProgressRound({\n\t\t\t\tid: `load_progress_${id}`,\n\t\t\t\tvalue: newProgress,\n\t\t\t\tmaxValue: 100,\n\t\t\t\twidth: 69,\n\t\t\t\tlineSize: 5,\n\t\t\t\tfill: false,\n\t\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t\t\tstatusType: BX.UI.ProgressRound.Status.INCIRCLE,\n\t\t\t});\n\t\t\tconst filePreview = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-item-attachment-file\" id=\"disk-attach-${id}\">\n\t\t\t\t\t${myProgress.getContainer()}\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-name\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-name-text\" title=\"${name}\">${name}</label>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-file-size\">\n\t\t\t\t\t\t<label class=\"tasks-checklist-item-attachment-file-size-text\">${size}</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.filesLoaderProgressBars.set(id, myProgress);\n\t\t\tDom.append(filePreview, this.getAttachmentsContainer());\n\t\t}\n\n\t\tif (!item.progressBarWidth)\n\t\t{\n\t\t\titem.progressBarWidth = 5;\n\t\t}\n\n\t\tif (newProgress > item.progressBarWidth)\n\t\t{\n\t\t\titem.progressBarWidth = Math.ceil(newProgress);\n\t\t\titem.progressBarWidth = item.progressBarWidth > 100 ? 100 : item.progressBarWidth;\n\n\t\t\tif (this.filesLoaderProgressBars.has(id))\n\t\t\t{\n\t\t\t\tthis.filesLoaderProgressBars.get(id).update(item.progressBarWidth);\n\t\t\t}\n\t\t}\n\t}\n\n\tOnFileUploadSuccess(fileResult, uf, file, uploaderFile)\n\t{\n\t\tif (typeof file === 'undefined' || typeof uploaderFile === 'undefined')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst attachmentId = fileResult.element_id.toString();\n\t\tconst attachment = {\n\t\t\tid: attachmentId,\n\t\t\tname: fileResult.element_name,\n\t\t\tviewUrl: fileResult.element_url,\n\t\t\tsize: uploaderFile.size,\n\t\t\text: uploaderFile.ext,\n\t\t};\n\n\t\tthis.fields.addAttachments({ [attachmentId]: attachmentId });\n\t\tthis.filesLoaderProgressBars.delete(uploaderFile.id);\n\n\t\tconst attachmentProgress = this.getAttachmentsContainer().querySelector(`#disk-attach-${uploaderFile.id}`);\n\t\tconst attachmentLayout = this.getLoadedAttachmentLayout(attachment);\n\n\t\tif (attachmentProgress)\n\t\t{\n\t\t\tDom.replace(attachmentProgress, attachmentLayout);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.append(attachmentLayout, this.getAttachmentsContainer());\n\t\t}\n\n\t\tconst id = this.fields.getId();\n\t\tconst optionAttachments = this.optionManager.attachments;\n\n\t\tif (optionAttachments)\n\t\t{\n\t\t\tif (id in optionAttachments)\n\t\t\t{\n\t\t\t\tthis.optionManager.attachments[id] += attachmentLayout.outerHTML;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.optionManager.attachments[id] = attachmentLayout.outerHTML;\n\t\t\t}\n\t\t}\n\n\t\tEventEmitter.emit('BX.Tasks.CheckListItem:CheckListChanged', { action: 'fileUpload' });\n\t}\n\n\tgetTaskRootLayout(children)\n\t{\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-task-root\">\n\t\t\t\t<div id=\"subItems_${this.getNodeId()}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst value = this.fields.getCompletedCount();\n\t\tconst maxValue = this.fields.getTotalCount();\n\t\tconst layouts = {\n\t\t\tlistActionsPanel: Tag.render`<div class=\"tasks-checklist-items-list-actions droppable\"></div>`,\n\t\t\tcompleteAllButton: Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-action-complete-all-btn\" onclick=\"${this.onCompleteAllButtonClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_COMPLETE_ALL')}\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tgroupButton: '',\n\t\t\tdndButton: Tag.render`<div class=\"tasks-checklist-wrapper-dragndrop\"></div>`,\n\t\t};\n\n\t\tif (this.checkCanAdd())\n\t\t{\n\t\t\tconst addButtonLayout = Tag.render`\n\t\t\t\t<a class=\"tasks-checklist-item-add-btn\" onclick=\"${this.onAddCheckListItemClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_ADD_NEW_ITEM')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t\tconst groupButton = Tag.render`\n\t\t\t\t<div class=\"tasks-checklist-action-group-btn\" onclick=\"${this.onGroupButtonClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_GROUP_ACTIONS')}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tDom.append(addButtonLayout, layouts.listActionsPanel);\n\t\t\tlayouts.groupButton = groupButton;\n\t\t}\n\n\t\tif (this.checkCanRemove())\n\t\t{\n\t\t\tconst removeButtonLayout = Tag.render`\n\t\t\t\t<a class=\"tasks-checklist-item-remove-btn\" onclick=\"${this.onDeleteClick.bind(this)}\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_DELETE_CHECKLIST')}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t\tDom.append(removeButtonLayout, layouts.listActionsPanel);\n\t\t}\n\n\t\tif (!this.checkCanDrag())\n\t\t{\n\t\t\tlayouts.dndButton.style.visibility = 'hidden';\n\t\t}\n\n\t\tif (!this.showCompleteAllButton())\n\t\t{\n\t\t\tlayouts.completeAllButton = '';\n\t\t}\n\n\t\tthis.progress = new BX.UI.ProgressBar({\n\t\t\tvalue,\n\t\t\tmaxValue,\n\t\t\tsize: BX.UI.ProgressBar.Size.MEDIUM,\n\t\t\ttextAfter: CheckListItem.getProgressText(value, maxValue),\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-wrapper tasks-checklist-item-group-editor-collapse\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"tasks-checklist-header-wrapper droppable\">\n\t\t\t\t\t${layouts.dndButton}\n\t\t\t\t\t<div class=\"tasks-checklist-header-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-header-inner\">\n\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-name\"\n\t\t\t\t\t\t\t\t onmousedown=\"${this.onHeaderMouseDown.bind(this)}\"\n\t\t\t\t\t\t\t\t onmouseup=\"${this.onHeaderMouseUp.bind(this)}\">\n\t\t\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-name-edit-btn\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-progress-block\">\n\t\t\t\t\t\t\t\t<div class=\"tasks-checklist-header-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-header-actions\">\n\t\t\t\t\t\t${layouts.completeAllButton}\n\t\t\t\t\t\t${layouts.groupButton}\n\t\t\t\t\t\t<div class=\"tasks-checklist-action-collapse-btn collapsed\" onclick=\"${this.onCollapseButtonClick.bind(\n\t\t\tthis)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-items-wrapper\">\n\t\t\t\t\t<div class=\"tasks-checklist-items-list\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t\t${children}\n\t\t\t\t\t</div>\n\t\t\t\t\t${layouts.listActionsPanel}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListItemLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst layouts = {\n\t\t\tdeleteButton: Tag.render`<button class=\"tasks-checklist-item-remove\" onclick=\"${this.onDeleteClick.bind(this)}\"></button>`,\n\t\t\tdndButton: Tag.render`<div class=\"tasks-checklist-item-dragndrop\"></div>`,\n\t\t\tattachments: this.getAttachmentsLayout(),\n\t\t};\n\n\t\tif (!this.checkCanRemove())\n\t\t{\n\t\t\tlayouts.deleteButton = '';\n\t\t}\n\n\t\tif (!this.checkCanDrag())\n\t\t{\n\t\t\tlayouts.dndButton.style.visibility = 'hidden';\n\t\t}\n\n\t\tthis.progress = new BX.UI.ProgressRound({\n\t\t\tid: `progress_${nodeId}`,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 20,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"tasks-checklist-item\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"tasks-checklist-item-inner droppable ${this.fields.getIsComplete() ? 'tasks-checklist-item-solved' : ''}\"\n\t\t\t\t\t onmousedown=\"${this.onInnerContainerMouseDown.bind(this)}\" onmouseup=\"${this.onInnerContainerMouseUp.bind(\n\t\t\tthis)}\">\n\t\t\t\t\t${layouts.dndButton}\n\t\t\t\t\t<div class=\"tasks-checklist-item-flag-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-flag\">\n\t\t\t\t\t\t\t<label class=\"tasks-checklist-item-flag-element\" onclick=\"${this.onCompleteButtonClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-sub-checklist-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class=\"tasks-checklist-item-flag-element-decorate\"></span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-content-block\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-number\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t\t${this.fields.getIsImportant() ? this.getImportantLayout() : ''}\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-description\">\n\t\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-additional-block\">\n\t\t\t\t\t\t${layouts.deleteButton}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-checklist-item-actions-block\">\n\t\t\t\t\t\t<input class=\"tasks-checklist-item-group-checkbox\" id=\"select_${nodeId}\" type=\"checkbox\"\n\t\t\t\t\t\t\t   onclick=\"${this.onSelectCheckboxClick.bind(this)}\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-item-attachment\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-attachment-list\" id=\"attachments_${nodeId}\">\n\t\t\t\t\t\t${layouts.attachments}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-checklist-sublist-items-wrapper\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetLayout()\n\t{\n\t\tconst children = [];\n\n\t\tthis.descendants.forEach((descendant) => {\n\t\t\tchildren.push(descendant.getLayout());\n\t\t});\n\n\t\tif (this.isTaskRoot())\n\t\t{\n\t\t\treturn this.getTaskRootLayout(children);\n\t\t}\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\tconst checkListLayout = this.getCheckListLayout(children);\n\n\t\t\tthis.handleCheckListChanges();\n\n\t\t\treturn checkListLayout;\n\t\t}\n\n\t\treturn this.getCheckListItemLayout(children);\n\t}\n}\n\nclass MobileCheckListItem extends CheckListItem\n{\n\tclass = MobileCheckListItem;\n\n\tcheckedClass = 'mobile-task-checklist-item-checked';\n\thiddenClass = 'mobile-task-checklist-item-hidden';\n\tcollapseClass = 'mobile-task-checklist-section-collapse';\n\twrapperClass = 'mobile-task-checklist-wrapper';\n\n\tshowClass = 'mobile-checklist-item-show';\n\thideClass = 'mobile-checklist-item-hide';\n\n\tskipUpdateClasses = {\n\t\theader: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t],\n\t\titem: [\n\t\t\t'.tasks-checklist-item-auditor',\n\t\t\t'.tasks-checklist-item-accomplice',\n\t\t\t'.tasks-checklist-item-link',\n\t\t\t'.mobile-task-checklist-item-checker',\n\t\t\t'.mobile-task-checklist-item-param',\n\t\t\t'.mobile-task-checklist-item-controls',\n\t\t],\n\t};\n\n\tstatic addDangerToElement(element)\n\t{\n\t\tconst dangerClass = 'mobile-task-checklist-error';\n\n\t\tif (!Dom.hasClass(element, dangerClass))\n\t\t{\n\t\t\tDom.addClass(element, dangerClass);\n\t\t}\n\t}\n\n\tgetItemRequestData()\n\t{\n\t\tconst itemRequestData = {\n\t\t\tPARENT_ID: this.fields.getParentId(),\n\t\t\tTITLE: Text.decode(this.fields.getTitle()),\n\t\t\tIS_COMPLETE: this.fields.getIsComplete(),\n\t\t\tIS_IMPORTANT: this.fields.getIsImportant(),\n\t\t\tMEMBERS: {},\n\t\t\tATTACHMENTS: this.fields.getAttachments() || {},\n\t\t};\n\t\tconst membersTypes = {\n\t\t\taccomplice: 'A',\n\t\t\tauditor: 'U',\n\t\t};\n\n\t\tthis.fields.getMembers().forEach((value, key) => {\n\t\t\titemRequestData.MEMBERS[key] = { TYPE: membersTypes[value.type] };\n\t\t});\n\n\t\treturn itemRequestData;\n\t}\n\n\tonChecklistAjaxError()\n\t{\n\t\tBXMobileApp.Events.postToComponent('onChecklistAjaxError', {\n\t\t\ttaskId: this.optionManager.entityId,\n\t\t\ttaskGuid: this.optionManager.taskGuid,\n\t\t}, 'tasks.view');\n\t}\n\n\tsendAddAjaxAction()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst fields = this.getItemRequestData();\n\t\t\tconst parent = this.getParent();\n\n\t\t\tfields.PARENT_ID = parent.fields.getId() || (parent.isTaskRoot() ? 0 : null);\n\n\t\t\tBX.ajax.runAction('tasks.task.checklist.add', {\n\t\t\t\tdata: {\n\t\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\t\tfields,\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\t\t\t\tif (response.status === 'success')\n\t\t\t\t{\n\t\t\t\t\tconst { checkListItem } = response.data;\n\t\t\t\t\tthis.fields.setId(checkListItem.id);\n\t\t\t\t\tresolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t\t\treject();\n\t\t\t\t}\n\t\t\t}).catch(() => {\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t\treject();\n\t\t\t});\n\t\t});\n\t}\n\n\tsendUpdateAjaxAction(fields, onFailCallback = null)\n\t{\n\t\tconst onFailFunction = onFailCallback || this.onChecklistAjaxError.bind(this);\n\n\t\tBX.ajax.runAction('tasks.task.checklist.update', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t\tfields,\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tonFailFunction();\n\t\t\t}\n\t\t}).catch(() => onFailFunction());\n\t}\n\n\tsendRemoveAjaxAction()\n\t{\n\t\tBX.ajax.runAction('tasks.task.checklist.delete', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t}\n\t\t}).catch(() => this.onChecklistAjaxError());\n\t}\n\n\tsendMembersAddAjaxAction(member, focusInput)\n\t{\n\t\tconst map = {\n\t\t\tauditor: {\n\t\t\t\tactionName: 'addAuditors',\n\t\t\t\tparamName: 'auditorsIds',\n\t\t\t\tletter: 'U',\n\t\t\t},\n\t\t\taccomplice: {\n\t\t\t\tactionName: 'addAccomplices',\n\t\t\t\tparamName: 'accomplicesIds',\n\t\t\t\tletter: 'A',\n\t\t\t},\n\t\t};\n\t\tconst currentType = map[member.type];\n\n\t\tconst toChecklistAddAction = 'tasks.task.checklist.addMembers';\n\t\tconst toChecklistAddData = {\n\t\t\ttaskId: this.optionManager.entityId,\n\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\tmembers: { [member.id]: currentType.letter },\n\t\t};\n\n\t\tBX.ajax.runAction(toChecklistAddAction, { data: toChecklistAddData }).then((toChecklistAddResponse) => {\n\t\t\tif (toChecklistAddResponse.status === 'success')\n\t\t\t{\n\t\t\t\tif (focusInput)\n\t\t\t\t{\n\t\t\t\t\tthis.toggleUpdateMode();\n\t\t\t\t}\n\n\t\t\t\tBX.ajax.runAction(`tasks.task.${currentType.actionName}`, {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\t\t\t[currentType.paramName]: [member.id],\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.fields.removeMember(member.id);\n\t\t\t}\n\t\t}).catch(() => this.fields.removeMember(member.id));\n\t}\n\n\tsendMoveAfterAjaxAction(afterItem)\n\t{\n\t\tBX.ajax.runAction('tasks.task.checklist.moveAfter', {\n\t\t\tdata: {\n\t\t\t\ttaskId: this.optionManager.entityId,\n\t\t\t\tcheckListItemId: this.fields.getId(),\n\t\t\t\tafterItemId: afterItem.fields.getId(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status !== 'success')\n\t\t\t{\n\t\t\t\tthis.onChecklistAjaxError();\n\t\t\t}\n\t\t}).catch(() => this.onChecklistAjaxError());\n\t}\n\n\tgetPopupMenuItems()\n\t{\n\t\tconst locPrefix = 'TASKS_CHECKLIST_MOBILE_POPUP_MENU_';\n\t\tconst popupMenuItems = [];\n\t\tconst popupMenuItemsBuildMap = {\n\t\t\tchecklist: {\n\t\t\t\taddAuditor: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_AUDITOR`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-auditor.png',\n\t\t\t\t},\n\t\t\t\taddAccomplice: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_ACCOMPLICE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-accomplice.png',\n\t\t\t\t},\n\t\t\t\trename: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}RENAME`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-rename.png',\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tcondition: this.checkCanRemove.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}REMOVE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-remove.png',\n\t\t\t\t},\n\t\t\t},\n\t\t\tchecklistItem: {\n\t\t\t\taddFile: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_FILE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-file.png',\n\t\t\t\t},\n\t\t\t\taddAuditor: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_AUDITOR`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-auditor.png',\n\t\t\t\t},\n\t\t\t\taddAccomplice: {\n\t\t\t\t\tcondition: this.checkCanAddAccomplice.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}ADD_ACCOMPLICE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-add-accomplice.png',\n\t\t\t\t},\n\t\t\t\ttabIn: {\n\t\t\t\t\tcondition: this.checkCanTabIn.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TAB_IN`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-tab-in.png',\n\t\t\t\t},\n\t\t\t\ttabOut: {\n\t\t\t\t\tcondition: this.checkCanTabOut.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TAB_OUT`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-tab-out.png',\n\t\t\t\t},\n\t\t\t\timportant: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}IMPORTANT`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-important.png',\n\t\t\t\t},\n\t\t\t\ttoAnotherChecklist: {\n\t\t\t\t\tcondition: this.checkCanUpdate.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}TO_ANOTHER_CHECKLIST`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-to-another-checklist.png',\n\t\t\t\t},\n\t\t\t\tremove: {\n\t\t\t\t\tcondition: this.checkCanRemove.bind(this),\n\t\t\t\t\tsectionCode: '0',\n\t\t\t\t\ttitle: Loc.getMessage(`${locPrefix}REMOVE`),\n\t\t\t\t\ticonUrl: '/bitrix/js/tasks/checklist/images/mobile-checklist-remove.png',\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\tconst type = (this.isCheckList() ? 'checklist' : 'checklistItem');\n\n\t\tObject.keys(popupMenuItemsBuildMap[type]).forEach((id) => {\n\t\t\tconst { sectionCode, title, iconUrl, condition } = popupMenuItemsBuildMap[type][id];\n\t\t\tpopupMenuItems.push({ id, sectionCode, title, iconUrl, disable: !condition() });\n\t\t});\n\n\t\treturn popupMenuItems;\n\t}\n\n\tgetPopupChecklistsList()\n\t{\n\t\tconst checkList = this.getCheckList();\n\t\tconst checkLists = this.getRootNode().getDescendants().filter(item => item !== checkList);\n\t\tconst popupChecklistsList = [];\n\n\t\tcheckLists.forEach((descendant) => {\n\t\t\tpopupChecklistsList.push({\n\t\t\t\tid: descendant.getNodeId(),\n\t\t\t\ttitle: Text.decode(descendant.fields.getTitle()),\n\t\t\t\tsectionCode: '0',\n\t\t\t});\n\t\t});\n\t\tpopupChecklistsList.push({\n\t\t\tid: 'newChecklist',\n\t\t\ttitle: Tag.message`+ ${'TASKS_CHECKLIST_PANEL_TO_ANOTHER_CHECKLIST_POPUP_NEW_CHECKLIST'}`,\n\t\t\tsectionCode: '0',\n\t\t});\n\n\t\treturn popupChecklistsList;\n\t}\n\n\tonMemberSelectedEvent(eventData)\n\t{\n\t\tconst { nodeId, member, position, focusInput } = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst title = node.fields.getTitle();\n\t\tlet newTitle = '';\n\n\t\tmember.nameFormatted = Text.encode(member.nameFormatted);\n\n\t\tif (focusInput)\n\t\t{\n\t\t\tconst start = position || 0;\n\t\t\tconst startSpace = ((start === 0 || start - 1 === 0 || title.charAt(start - 2) === ' ') ? '' : ' ');\n\t\t\tconst endSpace = (title.charAt(start - 1) === ' ' ? '' : ' ');\n\t\t\tconst newInputText = `${title.slice(0, start - 1)}${startSpace}${member.nameFormatted}${endSpace}`;\n\t\t\tnewTitle = `${newInputText}${title.slice(start)}`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst space = (title.slice(-1) === ' ' ? '' : ' ');\n\t\t\tnewTitle = `${title}${space}${member.nameFormatted}`;\n\t\t}\n\n\t\tnode.fields.addMember(member);\n\t\tnode.updateTitle(Text.decode(newTitle));\n\t\tnode.updateTitleNode();\n\n\t\tif (!this.checkEditMode())\n\t\t{\n\t\t\tnode.sendUpdateAjaxAction({ TITLE: Text.decode(node.fields.getTitle()) });\n\t\t\tnode.sendMembersAddAjaxAction(member, focusInput);\n\t\t}\n\t\telse if (focusInput)\n\t\t{\n\t\t\tnode.toggleUpdateMode();\n\t\t}\n\t}\n\n\tonAddAttachmentEvent(eventData)\n\t{\n\t\tconst { nodeId, attachment } = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tconst key = Object.keys(attachment)[0];\n\t\t\tconst value = Object.values(attachment)[0];\n\n\t\t\tnode.fields.addAttachments({ [`n${key}`]: value });\n\t\t}\n\t}\n\n\tonRemoveAttachmentEvent(eventData)\n\t{\n\t\tconst { nodeId, attachmentId } = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.fields.removeAttachment(attachmentId);\n\t\t\tnode.fields.removeAttachment(`n${attachmentId}`);\n\t\t}\n\t}\n\n\tgetFakeAttachmentsCount(filesToRemove, filesToAdd)\n\t{\n\t\tconst attachmentsIds = Object.keys(this.fields.getAttachments());\n\t\tconst countWithRemovable = attachmentsIds.filter(id => !filesToRemove.includes(id)).length;\n\n\t\treturn countWithRemovable + filesToAdd.length;\n\t}\n\n\tsetLayoutAttachmentsCount(attachmentsCount)\n\t{\n\t\tconst newAttachmentsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-param\" id=\"attachments_${this.getNodeId()}\" onclick=\"${this.onAttachmentsLayoutClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t${attachmentsCount > 0 ? `<div class=\"mobile-task-checklist-item-param-attach\">${attachmentsCount}</div>` : ''}\n\t\t\t</div>\n\t\t`;\n\t\tDom.replace(this.getAttachmentsContainer(), newAttachmentsLayout);\n\t}\n\n\tupdateNodeAttachments(filesToRemove, filesToAdd, attachments = null)\n\t{\n\t\tif (attachments)\n\t\t{\n\t\t\tthis.fields.setAttachments(attachments);\n\t\t}\n\n\t\tconst fakeAttachmentsCount = this.getFakeAttachmentsCount(filesToRemove, filesToAdd);\n\t\tthis.setLayoutAttachmentsCount(fakeAttachmentsCount);\n\t}\n\n\tonAttachFilesEvent(eventData)\n\t{\n\t\tconst { nodeId, filesToRemove, filesToAdd, attachments, checkListItemId } = eventData;\n\t\tconst node = (nodeId ? this.findChild(nodeId) : this.findById(checkListItemId));\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd, attachments);\n\t\t}\n\t}\n\n\tonRemoveFilesEvent(eventData)\n\t{\n\t\tconst { nodeId, filesToRemove, filesToAdd, attachments } = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd, attachments);\n\t\t}\n\t}\n\n\tonFakeAttachFilesEvent(eventData)\n\t{\n\t\tconst { nodeId, filesToRemove, filesToAdd, checkListItemId } = eventData;\n\t\tconst node = (nodeId ? this.findChild(nodeId) : this.findById(checkListItemId));\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd);\n\t\t}\n\t}\n\n\tonFakeRemoveFilesEvent(eventData)\n\t{\n\t\tconst { nodeId, filesToRemove, filesToAdd } = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.updateNodeAttachments(filesToRemove, filesToAdd);\n\t\t}\n\t}\n\n\tonRenameEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.toggleUpdateMode();\n\t\t}\n\t}\n\n\tonRemoveEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tif (!this.checkEditMode() && node.fields.getId())\n\t\t\t{\n\t\t\t\tnode.sendRemoveAjaxAction();\n\t\t\t}\n\t\t\tnode.deleteAction(false);\n\t\t\tnode.getParent().updateIndexes();\n\t\t\tnode.handleCheckListChanges();\n\t\t}\n\t}\n\n\tonTabInEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node && node.checkCanTabIn())\n\t\t{\n\t\t\tnode.tabIn();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (node.getLeftSibling())\n\t\t\t\t{\n\t\t\t\t\tnode.sendMoveAfterAjaxAction(node.getLeftSibling());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst fields = {\n\t\t\t\t\t\tPARENT_ID: node.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: node.fields.getSortIndex(),\n\t\t\t\t\t};\n\t\t\t\t\tconst onFailCallback = () => {\n\t\t\t\t\t\tnode.tabOut();\n\t\t\t\t\t};\n\n\t\t\t\t\tnode.sendUpdateAjaxAction(fields, onFailCallback);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonTabOutEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node && node.checkCanTabOut())\n\t\t{\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tnode.sendMoveAfterAjaxAction(node.getParent());\n\t\t\t}\n\t\t\tnode.tabOut();\n\t\t}\n\t}\n\n\tonImportantEvent(eventData)\n\t{\n\t\tconst node = this.findChild(eventData.nodeId);\n\n\t\tif (node)\n\t\t{\n\t\t\tnode.toggleImportant();\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tconst onFailCallback = () => {\n\t\t\t\t\tnode.toggleImportant();\n\t\t\t\t};\n\t\t\t\tnode.sendUpdateAjaxAction({ IS_IMPORTANT: node.fields.getIsImportant() }, onFailCallback);\n\t\t\t}\n\t\t}\n\t}\n\n\tonToAnotherCheckListEvent(eventData)\n\t{\n\t\tconst { nodeId, checklistId } = eventData;\n\t\tconst node = this.findChild(nodeId);\n\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (checklistId === 'newChecklist')\n\t\t{\n\t\t\tnode.moveToNewCheckList(this.getDescendantsCount() + 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.makeChildOf(this.findChild(checklistId));\n\t\t\tnode.handleCheckListChanges();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (node.getLeftSibling())\n\t\t\t\t{\n\t\t\t\t\tnode.sendMoveAfterAjaxAction(node.getLeftSibling());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tnode.sendUpdateAjaxAction({\n\t\t\t\t\t\tPARENT_ID: node.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: node.fields.getSortIndex(),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetNativeComponentName()\n\t{\n\t\treturn (this.checkEditMode() ? 'tasks.edit' : 'tasks.view');\n\t}\n\n\tcheckEditMode()\n\t{\n\t\treturn this.optionManager.isEditMode();\n\t}\n\n\tcheckCanTabIn()\n\t{\n\t\treturn !this.isTaskRoot() && !this.isCheckList() && !this.isFirstDescendant();\n\t}\n\n\tcheckCanTabOut()\n\t{\n\t\treturn !this.isTaskRoot() && !this.isCheckList() && !this.getParent().isCheckList();\n\t}\n\n\tshowEditorPanel(item, nodeToPosition = null)\n\t{\n\t\t// no editor panel in mobile version\n\t}\n\n\tgetTitleNodeClass()\n\t{\n\t\treturn this.isCheckList() ? 'mobile-task-checklist-head-title-text' : 'mobile-task-checklist-item-text';\n\t}\n\n\tgetInnerContainer()\n\t{\n\t\treturn this.container.querySelector(this.isCheckList() ? '.mobile-task-checklist-head-title' : '.mobile-task-checklist-item');\n\t}\n\n\tmoveToNewCheckList(number)\n\t{\n\t\tconst title = `${Loc.getMessage('TASKS_CHECKLIST_NEW_CHECKLIST_TITLE')}`.replace('#ITEM_NUMBER#', number);\n\t\tconst newCheckList = new MobileCheckListItem({ TITLE: title });\n\n\t\tthis.getRootNode().addCheckListItem(newCheckList).then(() => {\n\t\t\tthis.makeChildOf(newCheckList);\n\t\t\tthis.handleCheckListChanges();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tnewCheckList.sendAddAjaxAction().then(() => {\n\t\t\t\t\tthis.sendUpdateAjaxAction({\n\t\t\t\t\t\tPARENT_ID: this.getParent().fields.getId(),\n\t\t\t\t\t\tSORT_INDEX: this.fields.getSortIndex(),\n\t\t\t\t\t});\n\t\t\t\t}, () => {\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\ttoggleImportant()\n\t{\n\t\tif (this.fields.getIsImportant())\n\t\t{\n\t\t\tthis.fields.setIsImportant(false);\n\t\t\tDom.removeClass(this.getInnerContainer(), 'mobile-task-checklist-item-important');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.fields.setIsImportant(true);\n\t\t\tDom.addClass(this.getInnerContainer(), 'mobile-task-checklist-item-important');\n\t\t}\n\t}\n\n\thandleUpdateEnding(createNewItem = false)\n\t{\n\t\tconst input = this.container.querySelector(`#text_${this.getNodeId()}`);\n\t\tconst text = input.value.trim();\n\n\t\tif (text.length === 0)\n\t\t{\n\t\t\tif (this.checkCanDeleteOnUpdateEnding())\n\t\t\t{\n\t\t\t\tif (!this.checkEditMode() && this.fields.getId())\n\t\t\t\t{\n\t\t\t\t\tthis.sendRemoveAjaxAction();\n\t\t\t\t}\n\t\t\t\tthis.deleteAction(false);\n\t\t\t\tthis.getParent().updateIndexes();\n\t\t\t\tthis.handleCheckListIsEmpty();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tMobileCheckListItem.addDangerToElement(input.parentElement);\n\t\t\t}\n\t\t}\n\t\telse if (createNewItem)\n\t\t{\n\t\t\tthis.getParent().addCheckListItem(null, this);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableUpdateMode();\n\t\t\tthis.handleTaskOptions();\n\n\t\t\tif (!this.checkEditMode())\n\t\t\t{\n\t\t\t\tif (this.fields.getId())\n\t\t\t\t{\n\t\t\t\t\tconst itemRequestData = this.getItemRequestData();\n\t\t\t\t\tconst members = itemRequestData.MEMBERS;\n\n\t\t\t\t\tthis.sendUpdateAjaxAction({\n\t\t\t\t\t\tTITLE: itemRequestData.TITLE,\n\t\t\t\t\t\tMEMBERS: (Object.keys(members).length > 0 ? members : ''),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.sendAddAjaxAction().then(() => {\n\t\t\t\t\t}, () => {\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonInputBeforeInput(e)\n\t{\n\t\tconst memberSelectorCallKeys = ['@', '+'];\n\t\tconst position = CheckListItem.getInputSelection(this.input).start;\n\n\t\tif (memberSelectorCallKeys.includes(e.data) && this.checkCanAddAccomplice())\n\t\t{\n\t\t\tconst params = {\n\t\t\t\tposition,\n\t\t\t\tnodeId: this.getNodeId(),\n\t\t\t};\n\t\t\tBXMobileApp.Events.postToComponent(\n\t\t\t\t'onChecklistInputMemberSelectorCall',\n\t\t\t\tparams,\n\t\t\t\tthis.getNativeComponentName(),\n\t\t\t);\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\tonInputKeyPressed(e)\n\t{\n\t\tif (e.keyCode === CheckListItem.keyCodes.enter)\n\t\t{\n\t\t\tthis.toggleUpdateMode(e);\n\t\t\te.preventDefault();\n\t\t}\n\t}\n\n\tgetParamsForMobileEvent(type)\n\t{\n\t\tif (!['settings', 'attachments'].includes(type))\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\tconst { entityId, entityType, taskGuid, diskOptions, mode } = this.optionManager;\n\t\tconst defaultParams = {\n\t\t\ttaskGuid,\n\t\t\ttaskId: entityId,\n\t\t\tnodeId: this.getNodeId(),\n\t\t\tdisk: diskOptions,\n\t\t\tajaxData: {\n\t\t\t\tentityId,\n\t\t\t\tmode,\n\t\t\t\tcheckListItemId: (this.checkEditMode() ? this.getNodeId() : this.fields.getId()),\n\t\t\t\tentityTypeId: `${entityType.toLowerCase()}Id`,\n\t\t\t},\n\t\t};\n\t\tlet localParams = {};\n\n\t\tif (type === 'settings')\n\t\t{\n\t\t\tlocalParams = {\n\t\t\t\tpopupChecklists: this.getPopupChecklistsList(),\n\t\t\t\tpopupMenuItems: this.getPopupMenuItems(),\n\t\t\t\tpopupMenuSections: [{ id: '0', title: Text.decode(this.fields.getTitle()) }],\n\t\t\t};\n\t\t}\n\t\telse if (type === 'attachments')\n\t\t{\n\t\t\tlocalParams = {\n\t\t\t\tattachmentsIds: Object.keys(this.fields.getAttachments()),\n\t\t\t\tcanUpdate: this.checkCanUpdate(),\n\t\t\t};\n\t\t}\n\n\t\treturn { ...defaultParams, ...localParams };\n\t}\n\n\tonAttachmentsLayoutClick()\n\t{\n\t\tconst params = this.getParamsForMobileEvent('attachments');\n\t\tBXMobileApp.Events.postToComponent('onChecklistAttachmentsClick', params, this.getNativeComponentName());\n\t}\n\n\tonSettingsClick()\n\t{\n\t\tconst params = this.getParamsForMobileEvent('settings');\n\t\tBXMobileApp.Events.postToComponent('onChecklistSettingsClick', params, this.getNativeComponentName());\n\t}\n\n\tgetUpdateModeLayout()\n\t{\n\t\tconst nodeId = this.getNodeId();\n\n\t\tif (this.isCheckList())\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"mobile-task-checklist-head-title mobile-task-checklist-item-edit-mode\">\n\t\t\t\t\t<input class=\"mobile-task-checklist-item-input\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst progressBarLayout = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item mobile-task-checklist-item-edit-mode ${this.fields.getIsComplete() ? this.checkedClass : ''}\">\n\t\t\t\t<div class=\"mobile-task-checklist-item-checker\">\n\t\t\t\t\t${progressBarLayout.getContainer()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist-item-title\">\n\t\t\t\t\t<div class=\"tasks-checklist-item-number\" style=\"display: none\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t<input class=\"mobile-task-checklist-item-input\" type=\"text\" id=\"text_${nodeId}\"\n\t\t\t\t\t\t   placeholder=\"${Loc.getMessage('TASKS_CHECKLIST_NEW_ITEM_PLACEHOLDER')}\"\n\t\t\t\t\t\t   value=\"${this.fields.getTitle()}\"\n\t\t\t\t\t\t   onkeypress=\"${this.onInputKeyPressed.bind(this)}\"\n\t\t\t\t\t\t   onblur=\"${this.rememberInputState.bind(this)}\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetAttachmentsLayout()\n\t{\n\t\tconst attachmentsCount = Object.keys(this.fields.getAttachments()).length;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-param\" id=\"attachments_${this.getNodeId()}\" onclick=\"${this.onAttachmentsLayoutClick.bind(\n\t\t\tthis)}\">\n\t\t\t\t${attachmentsCount > 0 ? `<div class=\"mobile-task-checklist-item-param-attach\">${attachmentsCount}</div>` : ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetCheckListLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst settingsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-setting\" onclick=\"${this.onSettingsClick.bind(this)}\"></div>\n\t\t`;\n\t\tconst addButtonLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-add-button\" onclick=\"${this.onAddCheckListItemClick.bind(this)}\">\n\t\t\t\t<div class=\"mobile-task-checklist-add-text\">\n\t\t\t\t\t${Loc.getMessage('TASKS_CHECKLIST_ADD_NEW_ITEM')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.progress = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\tstatusType: BX.UI.ProgressRound.Status.COUNTER,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-section\" id=\"${nodeId}\" data-role=\"mobile-task-checklist\">\n\t\t\t\t<div class=\"mobile-task-checklist-head\">\n\t\t\t\t\t<div class=\"mobile-task-checklist-counter\">\n\t\t\t\t\t\t<div class=\"mobile-task-checklist-counter-progress\" id=\"progress_${nodeId}\">\n\t\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-head-title\" onclick=\"${this.onHeaderClickDone.bind(this)}\">\n\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-controls\">\n\t\t\t\t\t\t${this.checkCanUpdate() ? settingsLayout : ''}\n\t\t\t\t\t\t<div class=\"mobile-task-checklist-visible\"\n\t\t\t\t\t\t\t onclick=\"${this.onCollapseButtonClick.bind(this)}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist-wrapper\">\n\t\t\t\t\t<div class=\"mobile-task-checklist\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t\t${children}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.checkCanAdd() ? addButtonLayout : ''}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n\n\tgetCheckListItemLayout(children)\n\t{\n\t\tconst nodeId = this.getNodeId();\n\t\tconst settingsLayout = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-setting\" onclick=\"${this.onSettingsClick.bind(this)}\"></div>\n\t\t`;\n\n\t\tthis.progress = new BX.Mobile.Tasks.CheckList.ProgressRound({\n\t\t\tid: `progress_${nodeId}`,\n\t\t\tvalue: this.fields.getCompletedCount(),\n\t\t\tmaxValue: this.fields.getTotalCount(),\n\t\t\twidth: 29,\n\t\t\tlineSize: 3,\n\t\t\tfill: false,\n\t\t\tcolor: BX.UI.ProgressRound.Color.PRIMARY,\n\t\t});\n\n\t\tthis.container = Tag.render`\n\t\t\t<div class=\"mobile-task-checklist-item-wrapper\" id=\"${nodeId}\">\n\t\t\t\t<div class=\"mobile-task-checklist-item ${this.fields.getIsComplete() ? this.checkedClass : ''} ${this.fields.getIsImportant() ? 'mobile-task-checklist-item-important' : ''}\"\n\t\t\t\t\t onclick=\"${this.onInnerContainerClickDone.bind(this)}\">\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-checker\" id=\"progress_${nodeId}\"\n\t\t\t\t\t\t onclick=\"${this.onCompleteButtonClick.bind(this)}\">\n\t\t\t\t\t\t${this.progress.getContainer()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-title\">\n\t\t\t\t\t\t<div class=\"tasks-checklist-item-number\" style=\"display: none\">${this.fields.getDisplaySortIndex()}</div>\n\t\t\t\t\t\t${this.getTitleLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.getAttachmentsLayout()}\n\t\t\t\t\t<div class=\"mobile-task-checklist-item-controls\">\n\t\t\t\t\t\t${this.checkCanUpdate() ? settingsLayout : ''}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mobile-task-checklist\" id=\"subItems_${nodeId}\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.container;\n\t}\n}\n\nexport { CheckListItem, MobileCheckListItem };"],"names":["TreeItem","Math","random","toString","substr","setNodeId","generateUniqueNodeId","setParent","parent","getParent","nodeId","CompositeTreeItem","descendants","item","position","push","splice","after","index","findIndex","descendant","add","before","length","getFirstDescendant","getLastDescendant","isFirstDescendant","parentDescendants","getDescendants","isLastDescendant","getRootNode","leftSiblingThrough","getLeftSibling","getDescendantsCount","getRightSibling","getNodeId","found","forEach","findChild","size","countTreeSize","CheckListItemFields","string","camelCaseString","Type","isString","toLowerCase","replace","match","chr","toUpperCase","snakeCaseString","fields","id","parentId","title","sortIndex","displaySortIndex","isComplete","isImportant","isSelected","isCollapse","completedCount","totalCount","members","Map","attachments","setFields","Object","keys","name","camelCaseName","snakeToCamelCase","indexOf","snakeCaseName","camelToSnakeCase","setMethod","bind","copiedId","Text","encode","types","A","U","clear","ID","NAME","TYPE","isCollaber","IS_COLLABER","userId","Number","set","nameFormatted","type","member","CheckListItem","element","dangerClass","Dom","hasClass","addClass","oldParent","newParent","updateCounts","updateProgress","updateIndexes","completed","total","replaces","progressText","Loc","getMessage","search","ext","fileExtension","input","start","end","normalizedValue","range","textInputRange","len","endRange","selectionStart","selectionEnd","document","selection","createRange","parentElement","value","createTextRange","moveToBookmark","getBookmark","collapse","compareEndPoints","moveStart","slice","split","moveEnd","defaultTitle","itemNumber","node","posFrom","BX","GetWindowScrollPos","scrollTop","posTo","pos","top","round","GetWindowInnerSize","innerHeight","toBottom","distance","abs","speed","step","posCurrent","timer","i","setTimeout","url","messageId","esc","enter","plus","atsign","tab","up","down","backspace","action","header","canUpdate","MODIFY","canRemove","REMOVE","canToggle","TOGGLE","canDrag","DRAG","panel","progress","filesLoaderPopup","filesLoaderProgressBars","updateMode","optionManager","clickEventHandler","isTaskRoot","getId","findById","recursively","getIsComplete","countCompletedCount","countTotalCount","setCompletedCount","setTotalCount","updateCompletedCount","updateTotalCount","getTotalCount","getCompletedCount","setMaxValue","update","isCheckList","updateProgressText","getProgressText","setTextAfter","layout","style","overflow","height","opacity","showClass","scrollHeight","hideClass","remove","setDefaultStyles","container","paddingTop","getSortIndex","addCheckListItem","showBalloon","getTitle","data","getNotificationBalloon","EventEmitter","emit","e","preventDefault","hide","checkSelectedItems","items","getSelectedItems","runForEachSelectedItem","setIsSelected","deleteAction","handleCheckListChanges","actions","content","events","click","event","balloon","close","restore","handleTaskOptions","image","avatar","Tag","render","encodeURI","loadExt","then","UI","Notification","Center","notify","rootNode","moveToNewCheckList","PopupMenuWindow","target","getToAnotherCheckListPopupItems","autoHide","closeByEsc","offsetLeft","offsetWidth","angle","onPopupClose","destroy","show","selectMode","popupMenuItems","toNewCheckListMenuItem","text","message","onclick","getMenuWindow","selectedItem","makeChildOf","unselectAll","delimiter","checkList","getCheckList","checkLists","filter","handleUpdateEnding","number","newCheckList","TITLE","space","newTitle","addMember","updateTitle","decode","updateTitleNode","inputText","mentioned","inputCursorPosition","startSpace","charAt","endSpace","newInputText","retrieveFocus","auditor","userData","prepareUserData","resultAuditor","notificationAction","notificationData","processMemberSelect","accomplice","resultAccomplice","user","customData","getCustomData","entityType","getEntityType","description","get","lastName","email","networkId","crmemail","extranet","network","memberType","checkCanAddAccomplice","typeFunctionMap","onSocNetSelectorAuditorSelected","onSocNetSelectorAccompliceSelected","typeFunction","isSelectorLoading","Runtime","loadExtension","exports","Dialog","dialog","targetNode","enableSearch","multiple","entities","options","inviteGuestLink","inviteEmployeeLink","emailUsers","networkUsers","isNetworkEnabled","extranetUsers","analyticModuleName","getData","getMemberSelector","prefix","diskUrls","urlSelect","urlRenameFile","urlDeleteFile","urlUpload","PopupWindow","getAttachmentsLoaderLayout","bindElement","setBindElement","Disk","UF","UID","controlName","hideSelectDialog","onCustomEvent","contentContainer","querySelector","fileId","removeAttachment","getAttachmentsContainer","membersLayout","onAddAuditorClick","onAddAccompliceClick","attachmentButtonLayout","onUploadAttachmentClick","itemsActionButtonsLayout","onTabInClick","onTabOutClick","getIsImportant","onImportantClick","onToAnotherCheckListClick","onDeleteClick","separator","setTitle","getTitleNodeContainer","getTitleLayout","userPath","escapeRegExp","getDefaultCheckListTitle","getMembers","regExp","RegExp","getMemberLinkLayout","getLinkLayout","getTitleNodeClass","membersToDelete","removeMember","updateSortIndexes","updateDisplaySortIndexes","setSortIndex","parentSortIndex","getDisplaySortIndex","localSortIndex","newSortIndex","setDisplaySortIndex","innerText","showCompleted","showOnlyMine","hideByCondition","hasUserInMembers","has","condition","checkCanHide","canHide","checkActiveUpdateExist","getIsSelected","toggleGroup","disableAllUpdateModes","getInputSelection","focus","setSelectionRange","onInputKeyDown","rememberInputState","clearInput","progressBarLayout","ProgressRound","maxValue","width","lineSize","fill","color","Color","PRIMARY","onCompleteButtonClick","getContainer","nodeToPosition","getPosition","getPanelBodyLayout","left","append","body","isShown","right","viewModeLayout","getInnerContainer","updateModeLayout","getUpdateModeLayout","hiddenClass","insertBefore","Event","onInputBeforeInput","showEditorPanel","currentInner","trim","processMembersFromText","removeClass","nextElementSibling","getAttachments","createNewItem","checkCanDeleteOnUpdateEnding","handleCheckListIsEmpty","addDangerToElement","disableUpdateMode","keyCode","keyCodes","disableAllGroup","enableUpdateMode","toggleUpdateMode","shiftKey","tabOut","tabIn","getLeftSiblingThrough","rightSiblingThrough","getRightSiblingThrough","includes","defaultMemberSelectorType","handleMouseDown","registerClickDoneCallback","onHeaderClickDone","handleMouseUp","checkCanUpdate","checkSkipUpdate","onInnerContainerClickDone","toggleSelect","setIsImportant","getImportantLayout","callback","reverse","selectedItems","toggleImportant","panelImportantButton","closest","toggleClass","completeAll","runAjaxCompleteAll","checkCanToggle","toggleComplete","ajaxActions","entityId","stableTreeStructure","COMPLETE_ALL","ajax","runAction","response","updateStableTreeStructure","runAjax","setIsComplete","checkedClass","runAjaxToggleComplete","actionName","COMPLETE","RENEW","checkListItemId","checkListItem","FIELDS","DESCENDANTS","checkBox","checked","selected","getSelected","getIsCollapse","toggleCollapse","collapseFreezed","wrapperList","wrapperClass","wrapperListHeight","collapseClass","setIsCollapse","setAutoHeight","unbind","checkListIsComplete","checkIsComplete","collapseOnCompleteAll","checkListIsEmpty","toggleEmpty","handleCheckListIsComplete","area","skipUpdateClasses","find","getShowCompleteAllButton","getCollapseOnCompleteAll","getCanAdd","getCanAddAccomplice","addBefore","addAfter","updateParents","insertAfter","borderItems","bottom","move","getSubItemsContainer","dependsOn","itemGet","Promise","resolve","newCheckListItem","newCheckListItemLayout","getLayout","smoothScroll","itemRequestData","NODE_ID","PARENT_NODE_ID","COPIED_ID","getCopiedId","PARENT_ID","getParentId","SORT_INDEX","IS_COMPLETE","IS_IMPORTANT","MEMBERS","ATTACHMENTS","key","inputData","getItemRequestData","getRequestData","attachmentsLayout","requestLayout","checkCanRemove","appendRequestLayout","searchId","optionAttachments","stableAttachments","getStableAttachments","getStableTreeStructure","attachmentsToDelete","Array","isArray","attachment","getLoadedAttachmentLayout","serverFileId","viewUrl","serverPreviewUrl","getAttribute","extension","getFileExtension","extensionClass","iconContainer","deleteButton","onDeleteAttachmentClick","prototype","hasOwnProperty","call","sort","a","b","setAttachments","img","filesChooser","onAttachmentsLoaderMenuItemClick","addCustomEvent","OnFileUploadSuccess","uf","_onUploadProgress","onUploadProgress","newProgress","min","myProgress","statusType","Status","INCIRCLE","filePreview","progressBarWidth","ceil","fileResult","file","uploaderFile","attachmentId","element_id","element_name","element_url","addAttachments","attachmentProgress","attachmentLayout","outerHTML","children","layouts","listActionsPanel","completeAllButton","onCompleteAllButtonClick","groupButton","dndButton","checkCanAdd","addButtonLayout","onAddCheckListItemClick","onGroupButtonClick","removeButtonLayout","checkCanDrag","visibility","showCompleteAllButton","ProgressBar","Size","MEDIUM","textAfter","onHeaderMouseDown","onHeaderMouseUp","onCollapseButtonClick","getAttachmentsLayout","onInnerContainerMouseDown","onInnerContainerMouseUp","onSelectCheckboxClick","getTaskRootLayout","checkListLayout","getCheckListLayout","getCheckListItemLayout","MobileCheckListItem","membersTypes","BXMobileApp","Events","postToComponent","taskId","taskGuid","reject","status","setId","onChecklistAjaxError","onFailCallback","onFailFunction","focusInput","map","paramName","letter","currentType","toChecklistAddAction","toChecklistAddData","toChecklistAddResponse","afterItem","afterItemId","locPrefix","popupMenuItemsBuildMap","checklist","addAuditor","sectionCode","iconUrl","addAccomplice","rename","checklistItem","addFile","checkCanTabIn","checkCanTabOut","important","toAnotherChecklist","disable","popupChecklistsList","eventData","checkEditMode","sendUpdateAjaxAction","sendMembersAddAjaxAction","values","filesToRemove","filesToAdd","attachmentsIds","countWithRemovable","attachmentsCount","newAttachmentsLayout","onAttachmentsLayoutClick","fakeAttachmentsCount","getFakeAttachmentsCount","setLayoutAttachmentsCount","updateNodeAttachments","sendRemoveAjaxAction","sendMoveAfterAjaxAction","checklistId","isEditMode","sendAddAjaxAction","memberSelectorCallKeys","params","getNativeComponentName","diskOptions","mode","defaultParams","disk","ajaxData","entityTypeId","localParams","popupChecklists","getPopupChecklistsList","getPopupMenuItems","popupMenuSections","getParamsForMobileEvent","onInputKeyPressed","Mobile","Tasks","CheckList","settingsLayout","onSettingsClick","COUNTER"],"mappings":"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"}