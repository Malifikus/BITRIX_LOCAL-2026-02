{"version":3,"file":"conference.bundle.js","sources":["../src/utils/restclient.js","../src/controller.js"],"sourcesContent":["import { RestClient } from \"rest.client\";\nimport { Utils } from \"im.lib.utils\";\n\nconst RestAuth = Object.freeze({\n\tguest: 'guest',\n});\n\nexport class CallRestClient\n{\n\tconstructor(params)\n\t{\n\t\tthis.queryAuthRestore = false;\n\n\t\tthis.setAuthId(RestAuth.guest);\n\n\t\tthis.restClient = new RestClient({\n\t\t\tendpoint: params.endpoint,\n\t\t\tqueryParams: this.queryParams,\n\t\t\tcors: true\n\t\t});\n\t}\n\n\tsetAuthId(authId, customAuthId = '')\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t|| typeof authId === 'string' && authId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.call_auth_id = authId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error(`%CallRestClient.setAuthId: auth is not correct (%c${authId}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t&& typeof customAuthId === 'string' && customAuthId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.call_custom_auth_id = customAuthId;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tsetChatId(chatId)\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tthis.queryParams.call_chat_id = chatId;\n\t}\n\n\tsetConfId(alias)\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tthis.queryParams.videoconf_id = alias;\n\t}\n\n\tsetPassword(password)\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tthis.queryParams.videoconf_password = password;\n\t}\n\n\tcallMethod(method, params, callback, sendCallback, logTag = null)\n\t{\n\t\tif (!logTag)\n\t\t{\n\t\t\tlogTag = Utils.getLogTrackingParams({\n\t\t\t\tname: method,\n\t\t\t});\n\t\t}\n\n\t\tconst promise = new BX.Promise();\n\n\t\t// TODO: Callbacks methods will not work!\n\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.fulfill(result);\n\n\t\t}).catch(result => {\n\n\t\t\tlet error = result.error();\n\t\t\tif (error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t{\n\t\t\t\tthis.setAuthId(error.ex.hash);\n\n\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.fulfill(result);\n\t\t\t\t\t}).catch(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.reject(result);\n\t\t});\n\n\t\treturn promise;\n\t};\n\n\tcallBatch(calls, callback, bHaltOnError, sendCallback, logTag)\n\t{\n\t\tlet resultCallback = (result) => {\n\t\t\tlet error = null;\n\t\t\tfor (let method in calls)\n\t\t\t{\n\t\t\t\tif (!calls.hasOwnProperty(method))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet error = result[method].error();\n\t\t\t\tif (error && error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t\t{\n\t\t\t\t\tthis.setAuthId(error.ex.hash);\n\t\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tcallback(result);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\t\tthis.restClient.callBatch(calls, callback, bHaltOnError, sendCallback, logTag);\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tcallback(result);\n\n\t\t\treturn true;\n\t\t};\n\n\t\treturn this.restClient.callBatch(calls, resultCallback, bHaltOnError, sendCallback, logTag);\n\t};\n}","/**\n * Bitrix Im\n * Conference application\n *\n * @package bitrix\n * @subpackage mobile\n * @copyright 2001-2021 Bitrix\n */\n\n// call\nimport * as Call from 'call.core';\nimport { Analytics } from 'call.lib.analytics';\nimport { CallTokenManager } from 'call.lib.call-token-manager';\nimport { CallSettingsManager } from 'call.lib.settings-manager';\nimport './css/view.css';\nimport { Util, Hardware, JoinResponseError, ParticipantsPermissionPopup } from 'call.core';\nimport { ConferenceChannel } from 'call.application.conference-channel';\n\n// im\nimport 'im.debug';\nimport 'im.application.launch';\nimport 'im.component.conference.conference-public';\nimport {DesktopApi} from 'im.v2.lib.desktop-api';\nimport { ConferenceModel, CallModel } from \"call.model\";\nimport { Controller } from 'im.controller';\nimport { Utils } from \"im.lib.utils\";\nimport { Cookie } from \"im.lib.cookie\";\nimport { LocalStorage } from \"im.lib.localstorage\";\nimport { Logger } from \"im.lib.logger\";\nimport { Clipboard } from 'im.lib.clipboard';\nimport { Desktop } from \"im.lib.desktop\";\nimport { EventType } from \"im.const\";\n\nimport { ConferenceErrorCode, ConferenceRightPanelMode as RightPanelMode } from \"call.const\";\n\n//ui\nimport {Notifier, NotificationOptions} from 'ui.notification-manager';\nimport 'ui.notification';\nimport 'ui.buttons';\nimport 'ui.progressround';\nimport 'ui.viewer';\nimport { VueVendorV2 } from \"ui.vue\";\nimport { VuexBuilder } from \"ui.vue.vuex\";\n\n// core\nimport { Loc, Tag, Dom, Text, Type, Event } from \"main.core\";\nimport \"promise\";\nimport 'main.date';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\n// pull and rest\nimport { PullClient } from \"pull.client\";\nimport { ImCallPullHandler } from \"im.provider.pull\";\n\nimport { CallRestClient } from \"./utils/restclient\";\n\nconst BALLOON_OFFSET_CLASS_NAME = 'bx-call-control-notification-right-offset';\n\nclass ConferenceApplication\n{\n\t#onCallUserCommonRecordStateHandler;\n\t#onCloudRecordStatusChangedHandler;\n\t/* region 01. Initialize */\n\tconstructor(params = {})\n\t{\n\t\tthis.inited = false;\n\t\tthis.hardwareInited = false;\n\t\tthis.dialogInited = false;\n\t\tthis.initPromise = new BX.Promise;\n\n\t\tthis.params = params;\n\t\tthis.params.userId = this.params.userId? parseInt(this.params.userId): 0;\n\t\tthis.params.siteId = this.params.siteId || '';\n\t\tthis.params.chatId = this.params.chatId? parseInt(this.params.chatId): 0;\n\t\tthis.params.dialogId = this.params.chatId? 'chat'+this.params.chatId.toString(): '0';\n\t\tthis.params.passwordRequired = !!this.params.passwordRequired;\n\t\tthis.params.isBroadcast = !!this.params.isBroadcast;\n\n\t\tBX.Messenger.Lib.Logger.setConfig(params.loggerConfig);\n\n\t\tthis.messagesQueue = [];\n\n\t\tthis.template = null;\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.event = new VueVendorV2;\n\t\tthis.callContainer = null;\n\t\t// this.callView = null;\n\t\tthis.preCall = null;\n\t\tthis.currentCall = null;\n\t\tthis.callToken = this.params.callToken ?? null;\n\t\tthis.videoStrategy = null;\n\t\tthis.callDetails = {};\n\t\tthis.showFeedback = true;\n\t\tthis.callScheme = null;\n\n\t\tthis.promotedToAdminTimeoutValue = 10 * 1000; // 10 sec\n\t\tthis.promotedToAdminTimeout = null;\n\n\t\tthis.featureConfig = {};\n\t\t(params.featureConfig || []).forEach(limit => {\n\t\t\tthis.featureConfig[limit.id] = limit;\n\t\t});\n\n\t\tthis.localVideoStream = null;\n\n\t\t// save reconnect camera\n\t\tthis.lastUsedCameraId = null;\n\t\tthis.reconnectingCameraId = null;\n\n\t\tthis.conferencePageTagInterval = null;\n\n\t\tthis.onCallUserInvitedHandler = this.onCallUserInvited.bind(this);\n\t\tthis.onCallUserJoinedHandler = this.onCallUserJoined.bind(this);\n\t\tthis.onCallUserStateChangedHandler = this.onCallUserStateChanged.bind(this);\n\t\tthis.onCallUserMicrophoneStateHandler = this.onCallUserMicrophoneState.bind(this);\n\t\tthis.onCallUserCameraStateHandler = this.onCallUserCameraState.bind(this);\n\t\tthis.onNeedResetMediaDevicesStateHandler = this.onNeedResetMediaDevicesState.bind(this);\n\t\tthis.onCallUserVideoPausedHandler = this.onCallUserVideoPaused.bind(this);\n\t\tthis.onCallLocalMediaReceivedHandler = BX.debounce(this.onCallLocalMediaReceived.bind(this), 1000);\n\t\tthis.onCallLocalMediaStoppedHandler = this.onCallLocalMediaStopped.bind(this);\n\t\tthis.onCallRemoteMediaReceivedHandler = this.onCallRemoteMediaReceived.bind(this);\n\t\tthis.onCallRemoteMediaStoppedHandler = this.onCallRemoteMediaStopped.bind(this);\n\t\tthis.onCallUserVoiceStartedHandler = this.onCallUserVoiceStarted.bind(this);\n\t\tthis.onCallUserVoiceStoppedHandler = this.onCallUserVoiceStopped.bind(this);\n\t\tthis.onUserStatsReceivedHandler = this.onUserStatsReceived.bind(this);\n\t\tthis.onCallUserScreenStateHandler = this.onCallUserScreenState.bind(this);\n\t\tthis.#onCallUserCommonRecordStateHandler = this.#onCallUserCommonRecordState.bind(this);\n\t\tthis.#onCloudRecordStatusChangedHandler = this.#onCloudRecordStatusChanged.bind(this);\n\t\tthis.onCallUserFloorRequestHandler = this.onCallUserFloorRequest.bind(this);\n\t\tthis.onMicrophoneLevelHandler = this.onMicrophoneLevel.bind(this);\n\t\tthis._onCallJoinHandler = this.onCallJoin.bind(this);\n\t\tthis.onCallFailureHandler = this.onCallFailure.bind(this);\n\t\tthis.onCallLeaveHandler = this.onCallLeave.bind(this);\n\t\tthis.onCallDestroyHandler = this.onCallDestroy.bind(this);\n\t\tthis.onInputFocusHandler = this.onInputFocus.bind(this);\n\t\tthis.onInputBlurHandler = this.onInputBlur.bind(this);\n\t\tthis.onReconnectingHandler = this.onReconnecting.bind(this);\n\t\tthis.onReconnectedHandler = this.onReconnected.bind(this);\n\t\tthis.onReconnectingFailedHandler = this.onReconnectingFailed.bind(this);\n\t\tthis.onUpdateLastUsedCameraIdHandler = this.onUpdateLastUsedCameraId.bind(this);\n\t\tthis.onCallConnectionQualityChangedHandler = this.onCallConnectionQualityChanged.bind(this);\n\t\tthis.onCallToggleRemoteParticipantVideoHandler = this.onCallToggleRemoteParticipantVideo.bind(this);\n\t\tthis._onGetUserMediaEndedHandler = this.onGetUserMediaEnded.bind(this);\n\t\tthis._onSwitchTrackRecordStatusHandler = this.onUpdateCallCopilotState.bind(this);\n\t\tthis.onCameraPublishingHandler = this.onCameraPublishing.bind(this);\n\t\tthis.onMicrophonePublishingdHandler = this.onMicrophonePublishingd.bind(this);\n\n\t\tthis._onTurnOnCameraHandler = this._onTurnOnCamera.bind(this);\n\t\tthis._onAllParticipantsAudioMutedHandler = this._onAllParticipantsAudioMuted.bind(this);\n\t\tthis._onAllParticipantsVideoMutedHandler = this._onAllParticipantsVideoMuted.bind(this);\n\t\tthis._onAllParticipantsScreenshareHandler = this._onAllParticipantsScreenshareMuted.bind(this);\n\t\tthis._onYouMuteAllParticipantsHandler = this._onYouMuteAllParticipants.bind(this);\n\t\tthis._onRoomSettingsChangedHandler = this._onRoomSettingsChanged.bind(this);\n\t\tthis._onUserPermissionsChangedHandler = this._onUserPermissionsChanged.bind(this);\n\t\tthis._onUserRoleChangedHandler = this._onUserRoleChanged.bind(this);\n\t\tthis._onParticipantMutedHandler = this._onParticipantMuted.bind(this);\n\n\t\tthis.onPreCallDestroyHandler = this.onPreCallDestroy.bind(this);\n\t\tthis.onPreCallUserStateChangedHandler = this.onPreCallUserStateChanged.bind(this);\n\n\t\tthis.waitingForCallStatus = false;\n\t\tthis.waitingForCallStatusTimeout = null;\n\t\tthis.callEventReceived = false;\n\n\t\tthis.commonRecord = this.#getDefaultCommonRecord();\n\n\t\tthis.floatingScreenShareWindow = null;\n\t\tthis.webScreenSharePopup = null;\n\t\tthis.screenShareStartTime = null;\n\n\t\tthis.mutePopup = null;\n\t\tthis.riseYouHandToTalkPopup = null;\n\t\tthis.allowMutePopup = true;\n\n\t\tthis.loopTimers = {};\n\n\t\tthis.isFileChooserActive = false;\n\t\tthis.pictureInPictureDebounceForOpen = null;\n\t\tthis.isWindowFocus = true;\n\n\t\tif (DesktopApi.isDesktop())\n\t\t{\n\t\t\tConferenceChannel.getInstance().setExecuter((callUuid) => {\n\t\t\t\tconst currentCallUuid = this.params.alias;\n\t\t\t\tconst hasView = Boolean(this.callView);\n\n\t\t\t\tconst hasActiveCall = currentCallUuid === callUuid && hasView;\n\t\t\t\tif (hasActiveCall)\n\t\t\t\t{\n\t\t\t\t\tBXDesktopSystem.SetActiveTab();\n\t\t\t\t}\n\n\t\t\t\treturn hasActiveCall;\n\t\t\t});\n\t\t}\n\n\t\tthis.initDesktopEvents()\n\t\t\t.then(() => this.initAdditionalEvents())\n\t\t\t.then(() => this.initRestClient())\n\t\t\t.then(() => this.subscribePreCallChanges())\n\t\t\t.then(() => this.subscribeNotifierEvents())\n\t\t\t.then(() => this.initPullClient())\n\t\t\t.then(() => this.initCore())\n\t\t\t.then(() => this.setModelData())\n\t\t\t.then(() => this.initComponent())\n\t\t\t.then(() => this.initCallInterface())\n\t\t\t.then(() => this.initHardware())\n\t\t\t.then(() => this.initUserComplete())\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error('Init error', error);\n\t\t\t})\n\t\t;\n\t}\n\t/* region 01. Initialize methods */\n\tinitDesktopEvents()\n\t{\n\t\tif (!DesktopApi.isDesktop())\n\t\t{\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t}\n\n\t\tthis.floatingScreenShareWindow = new Call.FloatingScreenShare({\n\t\t\tonBackToCallClick: this.onFloatingScreenShareBackToCallClick.bind(this),\n\t\t\tonStopSharingClick: this.onFloatingScreenShareStopClick.bind(this),\n\t\t\tonChangeScreenClick: this.onFloatingScreenShareChangeScreenClick.bind(this)\n\t\t});\n\n\t\tif (this.floatingScreenShareWindow)\n\t\t{\n\t\t\tDesktopApi.subscribe(\"BXScreenMediaSharing\", (id, title, x, y, width, height, app) =>\n\t\t\t{\n\t\t\t\tthis.floatingScreenShareWindow.setSharingData({\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tx: x,\n\t\t\t\t\ty: y,\n\t\t\t\t\twidth: width,\n\t\t\t\t\theight: height,\n\t\t\t\t\tapp: app\n\t\t\t\t}).then(() => {\n\t\t\t\t\tthis.floatingScreenShareWindow.show();\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tLogger.error('setSharingData error', error);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tDesktopApi.subscribe('bxImUpdateCounterMessage', (counter) =>\n\t\t{\n\t\t\tif (!this.controller)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.controller.getStore().commit('conference/common', {\n\t\t\t\tmessageCount: counter\n\t\t\t});\n\t\t});\n\n\t\tif (DesktopApi.isDesktop())\n\t\t{\n\t\t\tDesktopApi.subscribe('BXVpnStatusChange', (status) =>\n\t\t\t{\n\t\t\t\tif (status)\n\t\t\t\t{\n\t\t\t\t\tthis.showVpnIsActiveNotification();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tEventEmitter.subscribe(EventType.textarea.focus, this.onInputFocusHandler);\n\t\tEventEmitter.subscribe(EventType.textarea.blur, this.onInputBlurHandler);\n\t\tEventEmitter.subscribe(EventType.conference.userRenameFocus, this.onInputFocusHandler);\n\t\tEventEmitter.subscribe(EventType.conference.userRenameBlur, this.onInputBlurHandler);\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitAdditionalEvents()\n\t{\n\t\twindow.addEventListener('focus', () => {\n\t\t\tthis.onWindowFocus();\n\t\t});\n\n\t\twindow.addEventListener('blur', () => {\n\t\t\tthis.onWindowBlur();\n\t\t});\n\n\t\tdocument.body.addEventListener('click', (evt) =>\n\t\t{\n\t\t\tthis.onDocumentBodyClick(evt);\n\t\t});\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitRestClient()\n\t{\n\t\tthis.restClient = new CallRestClient({endpoint: this.getHost()+'/rest'});\n\t\tthis.restClient.setConfId(this.params.conferenceId);\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tsubscribePreCallChanges()\n\t{\n\t\tBX.addCustomEvent(window, 'CallEvents::callCreated', this.onCallCreated.bind(this));\n\t}\n\n\tsubscribeNotifierEvents()\n\t{\n\t\tNotifier.subscribe('click', (event: BaseEvent<NotifierClickParams>) => {\n\t\t\tconst { id } = event.getData();\n\t\t\tif (id.startsWith('im-videconf'))\n\t\t\t{\n\t\t\t\tthis.toggleChat();\n\t\t\t}\n\t\t});\n\t}\n\n\tinitPullClient()\n\t{\n\t\tif (!this.params.isIntranetOrExtranet)\n\t\t{\n\t\t\tthis.pullClient = new PullClient({\n\t\t\t\tserverEnabled: true,\n\t\t\t\tuserId: this.params.userId,\n\t\t\t\tsiteId: this.params.siteId,\n\t\t\t\trestClient: this.restClient,\n\t\t\t\tskipStorageInit: true,\n\t\t\t\tconfigTimestamp: 0,\n\t\t\t\tskipCheckRevision: true,\n\t\t\t\tgetPublicListMethod: 'im.call.channel.public.list'\n\t\t\t});\n\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.pullClient = BX.PULL;\n\n\t\t\treturn this.pullClient.start().then(() => {\n\t\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t\t});\n\t\t}\n\t}\n\n\tinitCore()\n\t{\n\t\tthis.controller = new Controller({\n\t\t\thost: this.getHost(),\n\t\t\tsiteId: this.params.siteId,\n\t\t\tuserId: this.params.userId,\n\t\t\tlanguageId: this.params.language,\n\t\t\tpull: {client: this.pullClient},\n\t\t\trest: {client: this.restClient},\n\t\t\tvuexBuilder: {\n\t\t\t\tdatabase: !Utils.browser.isIe(),\n\t\t\t\tdatabaseName: 'imol/call',\n\t\t\t\tdatabaseType: VuexBuilder.DatabaseType.localStorage,\n\t\t\t\tmodels: [\n\t\t\t\t\tConferenceModel.create(),\n\t\t\t\t\tCallModel.create()\n\t\t\t\t],\n\t\t\t}\n\t\t});\n\n\t\twindow.BX.Messenger.Application.Core = {\n\t\t\tcontroller: this.controller\n\t\t};\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.controller.ready().then(() => resolve());\n\t\t});\n\t}\n\n\tsetModelData()\n\t{\n\t\tthis.controller.getStore().commit('application/set', {\n\t\t\tdialog: {\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tdialogId: this.getDialogId()\n\t\t\t},\n\t\t\toptions: {\n\t\t\t\tdarkBackground: true\n\t\t\t}\n\t\t});\n\n\t\t//set presenters ID list\n\t\tconst presentersIds = this.params.presenters.map(presenter => presenter['id']);\n\t\tthis.controller.getStore().dispatch('conference/setBroadcastMode', {broadcastMode: this.params.isBroadcast});\n\t\tthis.controller.getStore().dispatch('conference/setPresenters', {presenters: presentersIds});\n\n\t\t//set presenters info in users model\n\t\tthis.params.presenters.forEach(presenter => {\n\t\t\tthis.controller.getStore().dispatch('users/set', presenter);\n\t\t});\n\n\t\tif (this.params.passwordRequired)\n\t\t{\n\t\t\tthis.controller.getStore().commit('conference/common', {\n\t\t\t\tpassChecked: false,\n\t\t\t});\n\t\t}\n\n\t\tif (this.params.conferenceTitle)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('conference/setConferenceTitle', {\n\t\t\t\tconferenceTitle: this.params.conferenceTitle,\n\t\t\t});\n\t\t}\n\n\t\tif (this.params.alias)\n\t\t{\n\t\t\tthis.controller.getStore().commit('conference/setAlias', {\n\t\t\t\talias: this.params.alias,\n\t\t\t});\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tinitComponent()\n\t{\n\t\tif (this.getStartupErrorCode())\n\t\t{\n\t\t\tthis.setError(this.getStartupErrorCode());\n\t\t}\n\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tthis.controller.createVue(this, {\n\t\t\t\tel: this.rootNode,\n\t\t\t\tdata: () =>\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdialogId: this.getDialogId()\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\ttemplate: `<bx-im-component-conference-public :dialogId=\"dialogId\"/>`,\n\t\t\t}).then(vue =>\n\t\t\t{\n\t\t\t\tthis.template = vue;\n\t\t\t\tresolve();\n\t\t\t}).catch(error => reject(error));\n\t\t});\n\t}\n\n\tinitCallInterface()\n\t{\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\ttry {\n\t\t\t\tthis.callContainer = document.getElementById('bx-im-component-call-container');\n\n\t\t\t\tlet hiddenButtons = ['camera', 'microphone', 'document'];\n\t\t\t\tif (this.isViewerMode())\n\t\t\t\t{\n\t\t\t\t\thiddenButtons = ['screen', 'record', 'floorRequest', 'document'];\n\t\t\t\t}\n\t\t\t\tif (!this.params.isIntranetOrExtranet)\n\t\t\t\t{\n\t\t\t\t\thiddenButtons.push('record');\n\t\t\t\t}\n\n\t\t\t\tif (!Util.isConferenceChatEnabled())\n\t\t\t\t{\n\t\t\t\t\thiddenButtons.push('chat');\n\t\t\t\t}\n\n\t\t\t\tthis.callView = new Call.View({\n\t\t\t\t\tcontainer: this.callContainer,\n\t\t\t\t\tshowChatButtons: true,\n\t\t\t\t\tshowUsersButton: true,\n\t\t\t\t\tshowShareButton: this.getFeatureState('screenSharing') !== ConferenceApplication.FeatureState.Disabled,\n\t\t\t\t\tshowRecordButton: this.getFeatureState('record') !== ConferenceApplication.FeatureState.Disabled,\n\t\t\t\t\tuserLimit: Util.getUserLimit(),\n\t\t\t\t\tisIntranetOrExtranet: !!this.params.isIntranetOrExtranet,\n\t\t\t\t\tlanguage: this.params.language,\n\t\t\t\t\tlayout: Utils.device.isMobile() ? Call.View.Layout.Mobile : Call.View.Layout.Centered,\n\t\t\t\t\tuiState: Call.View.UiState.Preparing,\n\t\t\t\t\tblockedButtons: ['camera', 'microphone', 'floorRequest', 'screen', 'copilot'],\n\t\t\t\t\tlocalUserState: Call.UserState.Idle,\n\t\t\t\t\thiddenTopButtons: !this.isBroadcast() || this.getBroadcastPresenters().length > 1? []: ['grid'],\n\t\t\t\t\thiddenButtons: hiddenButtons,\n\t\t\t\t\tbroadcastingMode: this.isBroadcast(),\n\t\t\t\t\tbroadcastingPresenters: this.getBroadcastPresenters(),\n\t\t\t\t\tisCopilotFeaturesEnabled: false,\n\t\t\t\t\tisCopilotActive: false,\n\t\t\t\t\tisWindowFocus: this.isWindowFocus,\n\t\t\t\t\tisVideoconf: true,\n\t\t\t\t});\n\n\t\t\t\tthis.callView.subscribe(Call.View.Event.onButtonClick, this.onCallButtonClick.bind(this));\n\t\t\t\tthis.callView.subscribe(Call.View.Event.onReplaceCamera, this.onCallReplaceCamera.bind(this));\n\t\t\t\tthis.callView.subscribe(Call.View.Event.onReplaceMicrophone, this.onCallReplaceMicrophone.bind(this));\n\t\t\t\tthis.callView.subscribe(Call.View.Event.onReplaceSpeaker, this.onCallReplaceSpeaker.bind(this));\n\t\t\t\tthis.callView.subscribe(Call.View.Event.onHasMainStream, this.onCallViewHasMainStream.bind(this));\n\t\t\t\tthis.callView.subscribe(Call.View.Event.onChangeHdVideo, this.onCallViewChangeHdVideo.bind(this));\n\t\t\t\tthis.callView.subscribe(Call.View.Event.onChangeNoiseSuppression, this.onCallViewChangeNoiseSuppression.bind(this));\n\t\t\t\tthis.callView.subscribe(Call.View.Event.onChangeMicAutoParams, this.onCallViewChangeMicAutoParams.bind(this));\n\t\t\t\tthis.callView.subscribe(Call.View.Event.onChangeFaceImprove, this.onCallViewChangeFaceImprove.bind(this));\n\t\t\t\tthis.callView.subscribe(Call.View.Event.onUserRename, this.onCallViewUserRename.bind(this));\n\t\t\t\tthis.callView.subscribe(Call.View.Event.onUserPinned, this.onCallViewUserPinned.bind(this));\n\t\t\t\tthis.callView.subscribe(Call.View.Event.onToggleSubscribe, this.onCallToggleSubscribe.bind(this));\n\t\t\t\tthis.callView.subscribe(Call.View.Event.onCommonRecordMenu, this.#onCommonRecordMenu.bind(this));\n\n\t\t\t\tthis.callView.setCallback(Call.View.Event.onChangeVideoQuality, this._onChangeVideoQuality.bind(this));\n\t\t\t\tthis.callView.setCallback(Call.View.Event.onTurnOffParticipantMic, this._onCallViewTurnOffParticipantMic.bind(this));\n\t\t\t\tthis.callView.setCallback(Call.View.Event.onTurnOffParticipantCam, this._onCallViewTurnOffParticipantCam.bind(this));\n\t\t\t\tthis.callView.setCallback(Call.View.Event.onTurnOffParticipantScreenshare, this._onCallViewTurnOffParticipantScreenshare.bind(this));\n\t\t\t\tthis.callView.setCallback(Call.View.Event.onAllowSpeakPermission, this._onCallViewAllowSpeakPermission.bind(this));\n\t\t\t\tthis.callView.setCallback(Call.View.Event.onDisallowSpeakPermission, this._onCallViewDisallowSpeakPermission.bind(this));\n\n\t\t\t\tthis.callView.blockAddUser();\n\t\t\t\tthis.callView.blockHistoryButton();\n\n\t\t\t\tif (!Utils.device.isMobile())\n\t\t\t\t{\n\t\t\t\t\tthis.callView.show();\n\t\t\t\t}\n\n\t\t\t\tresolve()\n\t\t\t} catch (error)\n\t\t\t{\n\t\t\t\tLogger.error('creating call interface conference', error);\n\n\t\t\t\tlet errorCode = 'UNKNOWN_ERROR';\n\t\t\t\tif (Type.isString(error))\n\t\t\t\t{\n\t\t\t\t\terrorCode = error;\n\t\t\t\t}\n\t\t\t\telse if (Type.isPlainObject(error) && error.code)\n\t\t\t\t{\n\t\t\t\t\terrorCode = error.code == 'access_denied' ? 'ACCESS_DENIED' : error.code\n\t\t\t\t}\n\n\t\t\t\tthis.onCallFailure({\n\t\t\t\t\tcode: errorCode,\n\t\t\t\t\tmessage: error.message || \"\",\n\t\t\t\t})\n\n\t\t\t\treject('call interface error');\n\t\t\t}\n\t\t})\n\t}\n\n\tinitUserComplete()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.initUser()\n\t\t\t\t.then(() => this.tryJoinExistingCall())\n\t\t\t\t.then(() => this.initCall())\n\t\t\t\t.then(() => this.startPageTagInterval())\n\t\t\t\t.then(() => this.initPullHandlers())\n\t\t\t\t.then(() => this.subscribeToStoreChanges())\n\t\t\t\t.then(() => this.initComplete())\n\t\t\t\t.then(() => resolve)\n\t\t\t\t.catch((error) => reject(error));\n\t\t})\n\t}\n\t/* endregion 01. Initialize methods */\n\n\t/* region 02. initUserComplete methods */\n\tinitUser()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (this.getStartupErrorCode() || !this.getConference().common.passChecked)\n\t\t\t{\n\t\t\t\treturn reject();\n\t\t\t}\n\n\t\t\tif (this.params.userId > 0)\n\t\t\t{\n\t\t\t\tthis.controller.setUserId(this.params.userId);\n\n\t\t\t\tif (this.params.isIntranetOrExtranet)\n\t\t\t\t{\n\t\t\t\t\tthis.switchToSessAuth();\n\n\t\t\t\t\tthis.controller.getStore().commit('conference/user', {\n\t\t\t\t\t\tid: this.params.userId\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet hashFromCookie = this.getUserHashCookie();\n\t\t\t\t\tif (hashFromCookie)\n\t\t\t\t\t{\n\t\t\t\t\t\tCallTokenManager.setQueryParams({\n\t\t\t\t\t\t\tcall_auth_id: hashFromCookie,\n\t\t\t\t\t\t\tvideoconf_id: this.params.conferenceId,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.restClient.setAuthId(hashFromCookie);\n\t\t\t\t\t\tthis.restClient.setChatId(this.getChatId());\n\t\t\t\t\t\tthis.controller.getStore().commit('conference/user', {\n\t\t\t\t\t\t\tid: this.params.userId,\n\t\t\t\t\t\t\thash: hashFromCookie\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.pullClient.start();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.controller.getStore().commit('conference/common', {\n\t\t\t\t\tinited: true\n\t\t\t\t});\n\n\t\t\t\treturn resolve();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.restClient.setAuthId('guest');\n\t\t\t\tthis.restClient.setChatId(this.getChatId());\n\n\t\t\t\tif (typeof BX.SidePanel !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tBX.SidePanel.Instance.disableAnchorBinding();\n\t\t\t\t}\n\n\t\t\t\treturn this.restClient.callMethod('im.call.user.register', {\n\t\t\t\t\talias: this.params.alias,\n\t\t\t\t\tuser_hash: this.getUserHashCookie() || '',\n\t\t\t\t}).then((result) => {\n\t\t\t\t\tBX.message.USER_ID = result.data().id;\n\t\t\t\t\tthis.controller.getStore().commit('conference/user', {\n\t\t\t\t\t\tid: result.data().id,\n\t\t\t\t\t\thash: result.data().hash,\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.controller.setUserId(result.data().id);\n\t\t\t\t\tthis.callView.setLocalUserId(result.data().id);\n\n\t\t\t\t\tCall.Engine.setCurrentUserId(this.controller.getUserId());\n\t\t\t\t\tCall.EngineLegacy.setCurrentUserId(this.controller.getUserId());\n\n\t\t\t\t\tCallTokenManager.setUserToken(result.data().userToken);\n\n\t\t\t\t\tif (result.data().created)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.params.userCount++;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.controller.getStore().commit('conference/common', {\n\t\t\t\t\t\tinited: true,\n\t\t\t\t\t});\n\n\t\t\t\t\tCallTokenManager.setQueryParams({\n\t\t\t\t\t\tcall_auth_id: result.data().hash,\n\t\t\t\t\t\tvideoconf_id: this.params.conferenceId,\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.restClient.setAuthId(result.data().hash);\n\t\t\t\t\tthis.pullClient.start();\n\n\t\t\t\t\treturn resolve();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tstartPageTagInterval()\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tclearInterval(this.conferencePageTagInterval);\n\t\t\tthis.conferencePageTagInterval = setInterval(() => {\n\t\t\t\tLocalStorage.set(this.params.siteId, this.params.userId, this.callEngine.getConferencePageTag(this.params.dialogId), \"Y\", 2);\n\t\t\t}, 1000);\n\t\t\tresolve();\n\t\t})\n\t}\n\n\ttryJoinExistingCall()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst url = CallSettingsManager.jwtCallsEnabled\n\t\t\t\t? 'call.Call.tryJoinCall'\n\t\t\t\t: 'im.call.tryJoinCall';\n\n\t\t\tconst callTypeKey = CallSettingsManager.jwtCallsEnabled\n\t\t\t\t? 'callType'\n\t\t\t\t: 'type';\n\n\t\t\tBX.ajax.runAction(url, {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tentityType: 'chat',\n\t\t\t\t\t\tentityId: this.params.dialogId,\n\t\t\t\t\t\tprovider: Call.Provider.Bitrix,\n\t\t\t\t\t\t[callTypeKey]: Call.Type.Permanent,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\t.then((result) => {\n\t\t\t\t\tconst data = result.data;\n\t\t\t\t\tLogger.warn('tryJoinCall', data);\n\n\t\t\t\t\tif (data.success)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.waitingForCallStatus = true;\n\t\t\t\t\t\tthis.callScheme = data.call.SCHEME;\n\n\t\t\t\t\t\tif (this.callScheme === Call.CallScheme.jwt)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.callToken = data.callToken;\n\t\t\t\t\t\t\tCall.Engine.instantiateCall(data.call, data.callToken, data.logToken, data.userData);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tCall.EngineLegacy.instantiateCall(data.call, data.users, data.logToken, data.connectionData, data.userData);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.waitingForCallStatusTimeout = setTimeout(() => {\n\t\t\t\t\t\t\tthis.waitingForCallStatus = false;\n\t\t\t\t\t\t\tif (!this.callEventReceived)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.setConferenceStatus(false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.callEventReceived = false;\n\t\t\t\t\t\t}, 5000);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setConferenceStatus(false);\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve();\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.setConferenceStatus(false);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t});\n\n\t}\n\n\tinitCall()\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tif (this.callScheme)\n\t\t\t{\n\t\t\t\tthis.callEngine = this.callScheme === Call.CallScheme.jwt\n\t\t\t\t\t? Call.Engine\n\t\t\t\t\t: Call.EngineLegacy;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.callEngine = CallSettingsManager.jwtCallsEnabled\n\t\t\t\t\t? Call.Engine\n\t\t\t\t\t: Call.EngineLegacy;\n\t\t\t}\n\n\t\t\tCall.Engine.setRestClient(this.restClient);\n\t\t\tCall.Engine.setPullClient(this.pullClient);\n\n\t\t\t// this is a workaround to use actual parameters for conference guests in Util\n\t\t\t// since we don't know if a call is legacy or not when we make a REST request\n\t\t\tCall.EngineLegacy.setRestClient(this.restClient);\n\t\t\tCall.EngineLegacy.setPullClient(this.pullClient);\n\t\t\tthis.callView.unblockButtons(['chat']);\n\n\t\t\tresolve();\n\t\t})\n\t}\n\n\tinitPullHandlers()\n\t{\n\t\tthis.pullClient.subscribe(\n\t\t\tnew ImCallPullHandler({\n\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\tapplication: this,\n\t\t\t\tcontroller: this.controller,\n\t\t\t})\n\t\t);\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\n\tsubscribeToStoreChanges()\n\t{\n\t\tthis.controller.getStore().subscribe((mutation, state) => {\n\t\t\tconst { payload, type } = mutation;\n\t\t\tif (type === 'users/update' && payload.fields.name)\n\t\t\t{\n\t\t\t\tif (!this.callView)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.callView.updateUserData(\n\t\t\t\t\t{[payload.id]: {name: payload.fields.name}}\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (type === 'dialogues/set')\n\t\t\t{\n\t\t\t\tif (payload[0].dialogId !== this.getDialogId())\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!Utils.platform.isBitrixDesktop())\n\t\t\t\t{\n\t\t\t\t\tif (Number.isNaN(parseInt(payload[0].counter, 10)))\n\t\t\t\t\t{\n\t\t\t\t\t\tUtil.sendLog(`[conf] setButtonCounter chat: payload[0].counter = ${payload[0].counter} (NaN)`);\n\t\t\t\t\t}\n\t\t\t\t\tthis.callView.setButtonCounter('chat', payload[0].counter);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (type === 'dialogues/update')\n\t\t\t{\n\t\t\t\tif (payload.dialogId !== this.getDialogId())\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (typeof payload.fields.counter === 'number' && this.callView)\n\t\t\t\t{\n\t\t\t\t\tif (Utils.platform.isBitrixDesktop())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tpayload.actionName === \"decreaseCounter\"\n\t\t\t\t\t\t\t&& !payload.dialogMuted\n\t\t\t\t\t\t\t&& typeof payload.fields.previousCounter === 'number'\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet counter = payload.fields.counter;\n\t\t\t\t\t\t\tif (this.getConference().common.messageCount)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcounter = this.getConference().common.messageCount - (payload.fields.previousCounter - counter);\n\t\t\t\t\t\t\t\tif (counter < 0)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcounter = 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (Number.isNaN(parseInt(counter, 10)))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tUtil.sendLog(`[conf] setButtonCounter chat: counter = ${counter} (NaN)`);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.callView.setButtonCounter('chat', counter);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Number.isNaN(parseInt(payload.fields.counter, 10)))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tUtil.sendLog(`[conf] setButtonCounter chat:  payload.fields.counter = ${payload.fields.counter} (NaN)`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.callView.setButtonCounter('chat', payload.fields.counter);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (typeof payload.fields.name !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tdocument.title = payload.fields.name.toString();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (type === 'conference/common' && typeof payload.messageCount === 'number')\n\t\t\t{\n\t\t\t\tif (this.callView)\n\t\t\t\t{\n\t\t\t\t\tif (Number.isNaN(parseInt(payload.messageCount, 10)))\n\t\t\t\t\t{\n\t\t\t\t\t\tUtil.sendLog(`[conf] setButtonCounter chat: payload.messageCount = ${payload.messageCount} (NaN)`);\n\t\t\t\t\t}\n\t\t\t\t\tthis.callView.setButtonCounter('chat', payload.messageCount);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tinitComplete()\n\t{\n\t\tif (this.isExternalUser())\n\t\t{\n\t\t\tthis.callView.localUser.userModel.allowRename = true;\n\t\t}\n\n\t\tif (this.getConference().common.inited)\n\t\t{\n\t\t\tthis.inited = true;\n\t\t\tthis.initPromise.resolve(this);\n\t\t}\n\n\t\tif (DesktopApi.isDesktop())\n\t\t{\n\t\t\tDesktopApi.emitToMainWindow('bxConferenceLoadComplete', []);\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => resolve());\n\t}\n\t/* endregion 02. initUserComplete methods */\n\t/* endregion 01. Initialize */\n\n\t/* region 02. Methods */\n\n\t/* region 01. Call methods */\n\tinitHardware()\n\t{\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tCall.Hardware.init().then(() => {\n\t\t\t\tif (this.hardwareInited)\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tif (Object.values(Call.Hardware.microphoneList).length === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.setError(ConferenceErrorCode.missingMicrophone);\n\t\t\t\t}\n\n\t\t\t\tif (!this.isViewerMode())\n\t\t\t\t{\n\t\t\t\t\tthis.checkAvailableCamera();\n\t\t\t\t\tthis.checkAvailableMicrophone();\n\t\t\t\t\tthis.callView.enableMediaSelection();\n\t\t\t\t}\n\n\t\t\t\tCall.Hardware.subscribe(Call.Hardware.Events.deviceChanged, this._onDeviceChange.bind(this));\n\n\t\t\t\tthis.hardwareInited = true;\n\t\t\t\tresolve();\n\t\t\t}).catch(error => {\n\t\t\t\tif (error === 'NO_WEBRTC' && this.isHttps())\n\t\t\t\t{\n\t\t\t\t\tthis.setError(ConferenceErrorCode.unsupportedBrowser);\n\t\t\t\t}\n\t\t\t\telse if (error === 'NO_WEBRTC' && !this.isHttps())\n\t\t\t\t{\n\t\t\t\t\tthis.setError(ConferenceErrorCode.unsafeConnection);\n\t\t\t\t}\n\t\t\t\tLogger.error('Init hardware error', error);\n\t\t\t\treject(error)\n\t\t\t})\n\t\t});\n\t}\n\n\t_onDeviceChange(e)\n\t{\n\t\tif (!this.currentCall || !this.currentCall.ready)\n\t\t{\n\t\t\tthis.checkAvailableCamera();\n\t\t\tthis.checkAvailableMicrophone();\n\t\t\treturn;\n\t\t}\n\n\t\tconst allAddedDevice = e.data.added;\n\t\tconst allRemovedDevice = e.data.removed;\n\t\tconst removed = Call.Hardware.getRemovedUsedDevices(\n\t\t\te.data.removed,\n\t\t\t{\n\t\t\t\tmicrophoneId: this.currentCall.microphoneId,\n\t\t\t\tcameraId: this.currentCall.cameraId,\n\t\t\t\tspeakerId: this.callView.speakerId,\n\t\t\t}\n\t\t);\n\n\t\tif (allAddedDevice)\n\t\t{\n\t\t\tsetTimeout(() => this.useDevicesInCurrentCall(allAddedDevice), 500);\n\t\t}\n\n\t\tif (removed.length > 0)\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: BX.message(\"IM_CALL_DEVICES_DETACHED\") + \"<br><ul>\" + removed.map(function (deviceInfo)\n\t\t\t\t{\n\t\t\t\t\treturn \"<li>\" + deviceInfo.label\n\t\t\t\t}) + \"</ul>\",\n\t\t\t\tposition: \"top-right\",\n\t\t\t\tautoHideDelay: 10000,\n\t\t\t\tcloseButton: true,\n\t\t\t\t//category: \"call-device-change\",\n\t\t\t\tactions: [{\n\t\t\t\t\ttitle: BX.message(\"IM_CALL_DEVICES_CLOSE\"),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: function (event, balloon)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}]\n\t\t\t});\n\t\t}\n\n\t\tif (allRemovedDevice)\n\t\t{\n\t\t\tsetTimeout(() => this.removeDevicesFromCurrentCall(allRemovedDevice), 500);\n\t\t}\n\t}\n\n\tsetDefaultCameraIfNeeded()\n\t{\n\t\tif (!Call.Hardware.hasCamera() || (!!Call.Hardware.defaultCamera && !!Call.Hardware.cameraList.length && Call.Hardware.cameraList.some(cameraItem => cameraItem.deviceId === Call.Hardware.defaultCamera)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\n\t\tif (!Call.Hardware.defaultCamera && !!Call.Hardware.cameraList.length)\n\t\t{\n\t\t\tCall.Hardware.defaultCamera = Call.Hardware.cameraList[0].deviceId;\n\n\t\t\treturn;\n\t\t}\n\n\t\tCall.Hardware.defaultCamera = '';\n\t}\n\n\tsetDefaultMicrophoneIfNeeded()\n\t{\n\t\tif (!Call.Hardware.hasMicrophone() || (!!Call.Hardware.defaultMicrophone && !!Call.Hardware.microphoneList.length && Call.Hardware.microphoneList.some(micItem => micItem.deviceId === Call.Hardware.defaultMicrophone)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\n\t\tif (!Call.Hardware.defaultMicrophone && !!Call.Hardware.microphoneList.length)\n\t\t{\n\t\t\tCall.Hardware.defaultMicrophone = Call.Hardware.microphoneList[0].deviceId;\n\n\t\t\treturn;\n\t\t}\n\n\t\tCall.Hardware.defaultMicrophone = '';\n\t}\n\n\tonBlockCameraButton()\n\t{\n\t\tif (!this.callView)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callView.blockSwitchCamera();\n\t}\n\n\tonUnblockCameraButton()\n\t{\n\t\tif (!this.callView) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callView.unblockSwitchCamera();\n\t}\n\n\tonBlockMicrophoneButton()\n\t{\n\t\tif (!this.callView) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callView.blockSwitchMicrophone();\n\t}\n\n\tonUnblockMicrophoneButton()\n\t{\n\t\tif (!this.callView) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callView.unblockSwitchMicrophone();\n\t}\n\n\tcheckAvailableCamera()\n\t{\n\t\tconst isCameraButtonHasBlocked = this.callView.isButtonBlocked('camera');\n\n\t\tif (!this.currentCall && !Call.Hardware.hasCamera())\n\t\t{\n\t\t\tthis.onBlockCameraButton();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.onUnblockCameraButton();\n\t\t}\n\n\t\tthis.setDefaultCameraIfNeeded();\n\n\t\tconst isActiveState = Call.Hardware.hasCamera() && Call.Hardware.defaultCamera;\n\n\t\tif (!this.currentCall && isCameraButtonHasBlocked)\n\t\t{\n\t\t\tthis.template.$emit('setCameraState', isActiveState);\n\t\t\tthis.template.$emit('cameraSelected', Call.Hardware.defaultCamera);\n\t\t}\n\n\t\tthis.callView.updateButtons();\n\t}\n\n\tcheckAvailableMicrophone()\n\t{\n\t\tif (!this.currentCall && !Call.Hardware.hasMicrophone())\n\t\t{\n\t\t\tthis.onBlockMicrophoneButton();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.onUnblockMicrophoneButton();\n\t\t}\n\n\t\tthis.setDefaultMicrophoneIfNeeded();\n\n\t\tconst isActiveState = Call.Hardware.hasMicrophone();\n\n\t\tif (!this.currentCall)\n\t\t{\n\t\t\tthis.template.$emit('setMicState', isActiveState);\n\t\t\tthis.template.$emit('micSelected', Call.Hardware.defaultCamera);\n\t\t}\n\n\t\tthis.callView.updateButtons();\n\t}\n\n\tuseDevicesInCurrentCall(deviceList, isForceUse = false)\n\t{\n\t\tif (!this.currentCall || !this.currentCall.ready)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < deviceList.length; i++)\n\t\t{\n\t\t\tconst deviceInfo = deviceList[i];\n\n\t\t\tswitch (deviceInfo.kind)\n\t\t\t{\n\t\t\t\tcase \"audioinput\":\n\t\t\t\t\tif (deviceInfo.deviceId === 'default' || isForceUse)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst newDeviceId = Call.Hardware.getDefaultDeviceIdByGroupId(deviceInfo.groupId, 'audioinput');\n\t\t\t\t\t\tthis.currentCall.setMicrophoneId(newDeviceId);\n\t\t\t\t\t\tthis.callView.setMicrophoneId(newDeviceId);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.checkAvailableMicrophone();\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"videoinput\":\n\t\t\t\t\tif (deviceInfo.deviceId === 'default' || isForceUse)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.currentCall.setCameraId(deviceInfo.deviceId);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.reconnectingCameraId === deviceInfo.deviceId && !Call.Hardware.isCameraOn)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.updateCameraSettingsInCurrentCallAfterReconnecting(deviceInfo.deviceId)\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.checkAvailableCamera();\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"audiooutput\":\n\t\t\t\t\tif (this.callView && deviceInfo.deviceId === 'default' || isForceUse)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst newDeviceId = Call.Hardware.getDefaultDeviceIdByGroupId(deviceInfo.groupId, 'audiooutput');\n\t\t\t\t\t\tthis.callView.setSpeakerId(newDeviceId);\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveDevicesFromCurrentCall(deviceList)\n\t{\n\t\tif (!this.currentCall || !this.currentCall.ready)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < deviceList.length; i++)\n\t\t{\n\t\t\tconst deviceInfo = deviceList[i];\n\n\t\t\tswitch (deviceInfo.kind)\n\t\t\t{\n\t\t\t\tcase \"audioinput\":\n\t\t\t\t\tif (this.currentCall.microphoneId == deviceInfo.deviceId)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst microphoneIds = Object.keys(Call.Hardware.microphoneList);\n\t\t\t\t\t\tlet deviceId;\n\n\t\t\t\t\t\tif (microphoneIds.includes('default'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst deviceGroup = Call.Hardware.getDeviceGroupIdByDeviceId('default', 'audioinput');\n\t\t\t\t\t\t\tdeviceId = Call.Hardware.getDefaultDeviceIdByGroupId(deviceGroup, 'audioinput');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!deviceId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdeviceId = microphoneIds.length > 0 ? microphoneIds[0] : \"\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.currentCall.setMicrophoneId(deviceId);\n\n\t\t\t\t\t\tif (this.currentCall.provider === Call.Provider.Bitrix)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.callView.setMicrophoneId(deviceId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.checkAvailableMicrophone();\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"videoinput\":\n\t\t\t\t\tif (this.currentCall.cameraId == deviceInfo.deviceId)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst cameraIds = Object.keys(Call.Hardware.cameraList);\n\t\t\t\t\t\tthis.currentCall.setCameraId(cameraIds.length > 0 ? cameraIds[0] : \"\");\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.checkAvailableCamera();\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"audiooutput\":\n\t\t\t\t\tif (this.callView && this.callView.speakerId == deviceInfo.deviceId)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst speakerIds = Object.keys(Call.Hardware.audioOutputList);\n\t\t\t\t\t\tlet deviceId;\n\n\t\t\t\t\t\tif (speakerIds.includes('default'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst deviceGroup = Call.Hardware.getDeviceGroupIdByDeviceId('default', 'audiooutput');\n\t\t\t\t\t\t\tdeviceId = Call.Hardware.getDefaultDeviceIdByGroupId(deviceGroup, 'audiooutput');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!deviceId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.callView.setSpeakerId(speakerIds.length > 0 ? speakerIds[0] : \"\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tstartCall(videoEnabled, viewerMode = false, withCopilot)\n\t{\n\t\tif (this.initCallPromise)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Utils.device.isMobile())\n\t\t{\n\t\t\tthis.callView.show();\n\t\t\tif (Number.isNaN(parseInt(this.getDialogData().counter, 10)))\n\t\t\t{\n\t\t\t\tUtil.sendLog(`[conf] setButtonCounter chat: this.getDialogData().counter = ${this.getDialogData().counter} (NaN)`);\n\t\t\t}\n\t\t\tthis.callView.setButtonCounter('chat', this.getDialogData().counter);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.callView.setLayout(Call.View.Layout.Grid);\n\t\t}\n\n\t\tthis.callView.setUiState(Call.View.UiState.Calling);\n\n\t\tif (videoEnabled && !Call.Hardware.hasCamera())\n\t\t{\n\t\t\tthis.showNotification(BX.message('IM_CALL_NO_CAMERA_ERROR'));\n\t\t\tvideoEnabled = false;\n\t\t}\n\n\t\tif (this.localVideoStream)\n\t\t{\n\t\t\tif (!videoEnabled)\n\t\t\t{\n\t\t\t\tthis.stopLocalVideoStream();\n\t\t\t}\n\t\t}\n\t\tthis.controller.getStore().commit('conference/startCall');\n\n\t\tlet callTokenPromise = Promise.resolve(this.callToken);\n\t\tif (CallSettingsManager.jwtCallsEnabled && !this.callToken)\n\t\t{\n\t\t\tcallTokenPromise = CallTokenManager.getToken(this.params.chatId);\n\t\t}\n\n\t\tcallTokenPromise\n\t\t\t.then((callToken) => {\n\t\t\t\tthis.callToken = callToken;\n\t\t\t\tCallTokenManager.setToken(this.params.chatId, this.callToken);\n\n\t\t\t\treturn this.callEngine.createCall(this.getCallConfig(videoEnabled))\n\t\t\t\t\t.then(e =>\n\t\t\t\t\t{\n\t\t\t\t\t\tLogger.warn('call created', e);\n\n\t\t\t\t\t\tthis.currentCall = e.call;\n\t\t\t\t\t\t//this.currentCall.useHdVideo(Call.Hardware.preferHdQuality);\n\t\t\t\t\t\tthis.currentCall.useHdVideo(true);\n\n\t\t\t\t\t\tif (this.promotedToAdminTimeout)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tclearTimeout(this.promotedToAdminTimeout);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!CallSettingsManager.jwtCallsEnabled)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.onUpdateCallCopilotState({\n\t\t\t\t\t\t\t\tisTrackRecordOn: this.currentCall.isCopilotActive,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (Call.Hardware.defaultMicrophone)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.currentCall.setMicrophoneId(Call.Hardware.defaultMicrophone);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (Call.Hardware.defaultCamera)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.currentCall.setCameraId(Call.Hardware.defaultCamera);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.checkAvailableMicrophone();\n\t\t\t\t\t\tthis.checkAvailableCamera();\n\n\t\t\t\t\t\tif (!Utils.device.isMobile())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.callView.setLayout(Call.View.Layout.Grid);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (CallSettingsManager.jwtCallsEnabled)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst userData = this.controller.getStore().getters['users/get'](this.controller.getUserId(), true);\n\t\t\t\t\t\t\tthis.callView.appendUsers([userData.id]);\n\t\t\t\t\t\t\tthis.callView.updateUserData({[userData.id]: userData});\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.callView.appendUsers(this.currentCall.getUsers());\n\t\t\t\t\t\t\tUtil.getUsers(this.currentCall.id, this.getCallUsers(true)).then(userData => {\n\t\t\t\t\t\t\t\tthis.controller.getStore().dispatch('users/set', Object.values(userData));\n\t\t\t\t\t\t\t\tthis.controller.getStore().dispatch('conference/setUsers', {users: Object.keys(userData)});\n\t\t\t\t\t\t\t\tthis.callView.updateUserData(userData)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.releasePreCall();\n\t\t\t\t\t\tthis.bindCallEvents();\n\t\t\t\t\t\tthis.updateCallUser(this.currentCall.userId, { microphoneState: !Call.Hardware.isMicrophoneMuted });\n\t\t\t\t\t\tif (e.isNew)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tAnalytics.getInstance().onStartVideoconf({\n\t\t\t\t\t\t\t\tcallId: this.currentCall?.uuid,\n\t\t\t\t\t\t\t\twithVideo: videoEnabled,\n\t\t\t\t\t\t\t\tmediaParams: {\n\t\t\t\t\t\t\t\t\tvideo: Call.Hardware.isCameraOn,\n\t\t\t\t\t\t\t\t\taudio: !Call.Hardware.isMicrophoneMuted,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tstatus: Analytics.AnalyticsStatus.success,\n\t\t\t\t\t\t\t\tisCopilotActive: this.currentCall.isCopilotActive,\n\t\t\t\t\t\t\t\tisVpnActive: this.#isVpnConnected(),\n\t\t\t\t\t\t\t\tuserCounter: this.currentCall.associatedEntity?.userCounter,\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.currentCall.inviteUsers();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.currentCall.answer({\n\t\t\t\t\t\t\t\tjoinAsViewer: viewerMode\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tAnalytics.getInstance().onJoinVideoconf({\n\t\t\t\t\t\t\t\tcallId: this.currentCall?.uuid,\n\t\t\t\t\t\t\t\twithVideo: videoEnabled,\n\t\t\t\t\t\t\t\tmediaParams: {\n\t\t\t\t\t\t\t\t\tvideo: Call.Hardware.isCameraOn,\n\t\t\t\t\t\t\t\t\taudio: !Call.Hardware.isMicrophoneMuted,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tstatus: Analytics.AnalyticsStatus.success,\n\t\t\t\t\t\t\t\tisVpnActive: this.#isVpnConnected(),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.checkVpnStatus();\n\n\t\t\t\t\t\tthis.onUpdateLastUsedCameraId();\n\t\t\t\t\t});\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tLogger.error('creating call error', error);\n\t\t\t\tlet errorCode = 'UNKNOWN_ERROR';\n\t\t\t\tif (Type.isString(error))\n\t\t\t\t{\n\t\t\t\t\terrorCode = error;\n\t\t\t\t}\n\t\t\t\telse if (Type.isObject(error) && error instanceof JoinResponseError)\n\t\t\t\t{\n\t\t\t\t\terrorCode = error.name;\n\t\t\t\t}\n\t\t\t\telse if (Type.isPlainObject(error) && error.code)\n\t\t\t\t{\n\t\t\t\t\terrorCode = error.code == 'access_denied' ? 'ACCESS_DENIED' : error.code\n\t\t\t\t}\n\n\t\t\t\tAnalytics.getInstance().onStartCallError({\n\t\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\t\terrorCode,\n\t\t\t\t\terrorMessage: error?.message,\n\t\t\t\t});\n\n\t\t\t\tthis.initCallPromise = null;\n\t\t\t});\n\t}\n\n\t/**\n\t * @param {int} callUuid\n\t * @param {object} options\n\t */\n\tjoinCall(callId, callUuid, options)\n\t{\n\t\tif (this.initCallPromise)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet video = BX.prop.getBoolean(options, \"video\", false);\n\t\tlet joinAsViewer = BX.prop.getBoolean(options, \"joinAsViewer\", false);\n\t\tCall.Hardware.isCameraOn = !!video;\n\n\t\tif (Utils.device.isMobile())\n\t\t{\n\t\t\tthis.callView.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.callView.setLayout(Call.View.Layout.Grid);\n\t\t}\n\n\t\tif (joinAsViewer)\n\t\t{\n\t\t\tthis.callView.setLocalUserDirection(Call.EndpointDirection.RecvOnly);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.callView.setLocalUserDirection(Call.EndpointDirection.SendRecv);\n\t\t}\n\n\t\tthis.callView.setUiState(Call.View.UiState.Calling);\n\n\t\tconst isLegacyCall = Boolean(callId)\n\t\t\t|| this.callScheme === Call.CallScheme.classic\n\t\t\t|| (!this.callScheme && !CallSettingsManager.jwtCallsEnabled);\n\n\t\tthis.initCallPromise = Promise.resolve(this.callToken);\n\t\tif (!isLegacyCall && !this.callToken)\n\t\t{\n\t\t\tthis.initCallPromise = CallTokenManager.getToken(this.params.chatId);\n\t\t}\n\n\t\tthis.initCallPromise\n\t\t\t.then((callToken) => {\n\t\t\t\tif (isLegacyCall)\n\t\t\t\t{\n\t\t\t\t\treturn Call.EngineLegacy.getCallWithId(callId, this.getCallConfig(video));\n\t\t\t\t}\n\n\t\t\t\tthis.callToken = callToken;\n\t\t\t\tCallTokenManager.setToken(this.params.chatId, this.callToken);\n\n\t\t\t\treturn Call.Engine.getCallWithId(callUuid, this.getCallConfig(video, callUuid));\n\t\t\t})\n\t\t\t.then((result) => {\n\t\t\t\tthis.currentCall = result.call;\n\t\t\t\tthis.releasePreCall();\n\t\t\t\tthis.bindCallEvents();\n\n\t\t\t\tif (this.promotedToAdminTimeout)\n\t\t\t\t{\n\t\t\t\t\tclearTimeout(this.promotedToAdminTimeout);\n\t\t\t\t}\n\n\t\t\t\tif (this.currentCall?.scheme === Call.CallScheme.classic || !CallSettingsManager.jwtCallsEnabled)\n\t\t\t\t{\n\t\t\t\t\tthis.onUpdateCallCopilotState({\n\t\t\t\t\t\tisTrackRecordOn: this.currentCall.isCopilotActive,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.controller.getStore().commit('conference/startCall');\n\n\t\t\t\tif (this.currentCall?.scheme === Call.CallScheme.jwt)\n\t\t\t\t{\n\t\t\t\t\tconst userData = this.controller.getStore().getters['users/get'](this.controller.getUserId(), true);\n\t\t\t\t\tthis.callView.appendUsers([userData.id]);\n\t\t\t\t\tthis.callView.updateUserData({[userData.id]: userData});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.callView.appendUsers(this.currentCall.getUsers());\n\t\t\t\t\tUtil.getUsers(this.currentCall.id, this.getCallUsers(true)).then(userData => {\n\t\t\t\t\t\tthis.controller.getStore().dispatch('users/set', Object.values(userData));\n\t\t\t\t\t\tthis.controller.getStore().dispatch('conference/setUsers', {users: Object.keys(userData)});\n\t\t\t\t\t\tthis.callView.updateUserData(userData)\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (!joinAsViewer)\n\t\t\t\t{\n\t\t\t\t\t//this.currentCall.useHdVideo(Call.Hardware.preferHdQuality);\n\t\t\t\t\tthis.currentCall.useHdVideo(true);\n\t\t\t\t\tif (Call.Hardware.defaultMicrophone)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.currentCall.setMicrophoneId(Call.Hardware.defaultMicrophone);\n\t\t\t\t\t}\n\t\t\t\t\tif (Call.Hardware.defaultCamera)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.currentCall.setCameraId(Call.Hardware.defaultCamera);\n\t\t\t\t\t}\n\n\n\t\t\t\t\tthis.checkAvailableMicrophone();\n\t\t\t\t\tthis.checkAvailableCamera();\n\n\t\t\t\t\tthis.updateCallUser(this.currentCall.userId, {microphoneState: !Call.Hardware.isMicrophoneMuted});\n\t\t\t\t}\n\n\t\t\t\tthis.currentCall.answer({\n\t\t\t\t\tjoinAsViewer: joinAsViewer\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tAnalytics.getInstance().onJoinVideoconf({\n\t\t\t\t\tcallId: this.currentCall?.uuid,\n\t\t\t\t\twithVideo: Call.Hardware.isCameraOn,\n\t\t\t\t\tmediaParams: {\n\t\t\t\t\t\tvideo: Call.Hardware.isCameraOn,\n\t\t\t\t\t\taudio: !Call.Hardware.isMicrophoneMuted,\n\t\t\t\t\t},\n\t\t\t\t\tstatus: Analytics.AnalyticsStatus.success,\n\t\t\t\t\tisVpnActive: this.#isVpnConnected(),\n\t\t\t\t});\n\n\t\t\t\tthis.checkVpnStatus();\n\n\t\t\t\tthis.onUpdateLastUsedCameraId();\n\t\t\t})\n\t\t\t.catch((error) =>\n\t\t\t{\n\t\t\t\tconsole.error(error);\n\n\t\t\t\tlet errorCode = 'UNKNOWN_ERROR';\n\t\t\t\tif (Type.isString(error))\n\t\t\t\t{\n\t\t\t\t\terrorCode = error;\n\t\t\t\t}\n\t\t\t\telse if (Type.isObject(error) && error instanceof JoinResponseError)\n\t\t\t\t{\n\t\t\t\t\terrorCode = error.name;\n\t\t\t\t}\n\t\t\t\telse if (Type.isPlainObject(error) && error.code)\n\t\t\t\t{\n\t\t\t\t\terrorCode = error.code === 'access_denied' ? 'ACCESS_DENIED' : error.code;\n\t\t\t\t}\n\n\t\t\t\tAnalytics.getInstance().onJoinCallError({\n\t\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\t\terrorCode,\n\t\t\t\t\tcallId: callUuid,\n\t\t\t\t\terrorMessage: error?.message,\n\t\t\t\t\tisVpnActive: this.#isVpnConnected(),\n\t\t\t\t});\n\n\t\t\t\tthis.initCallPromise = null;\n\t\t\t});\n\t}\n\n\tendCall(finishCall = false)\n\t{\n\t\tif (this.#isLocalRecordStarted())\n\t\t{\n\t\t\tAnalytics.getInstance().onRecordStop({\n\t\t\t\tcallId: this.currentCall.uuid,\n\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\tsubSection: finishCall ? Analytics.AnalyticsSubSection.contextMenu : Analytics.AnalyticsSubSection.window,\n\t\t\t\telement: finishCall ? Analytics.AnalyticsElement.finishForAllButton : Analytics.AnalyticsElement.disconnectButton,\n\t\t\t\trecordTime: Util.getRecordTimeText(this.commonRecord.info),\n\t\t\t})\n\n\t\t}\n\n\t\tthis.#stopCommonRecord();\n\n\t\tthis.setConferenceHasErrorInCall(false);\n\t\tthis.showFeedback = !!this.currentCall?.wasConnected;\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.callDetails = {\n\t\t\t\tid: this.currentCall.uuid,\n\t\t\t\tprovider: this.currentCall.provider,\n\t\t\t\tuserCount: this.currentCall.users.length,\n\t\t\t\tbrowser: Util.getBrowserForStatistics(),\n\t\t\t\tisMobile: BX.browser.IsMobile(),\n\t\t\t\tisConference: true\n\t\t\t}\n\n\t\t\tthis.removeCallEvents();\n\t\t\tthis.removeAdditionalEvents();\n\t\t\tthis.currentCall.hangup(false, '', finishCall);\n\t\t}\n\n\t\tif (Utils.platform.isBitrixDesktop())\n\t\t{\n\t\t\tif (this.floatingScreenShareWindow)\n\t\t\t{\n\t\t\t\tthis.floatingScreenShareWindow.destroy();\n\t\t\t\tthis.floatingScreenShareWindow = null;\n\t\t\t}\n\n\t\t\twindow.close();\n\t\t\t// if the conference was opened incorrectly, then \"window.close();\" may not work in some cases\n\t\t\t// as a workaround, we can redirect the user back to the portal's front page.\n\t\t\tlocation.href = '/';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.callView.releaseLocalMedia();\n\t\t\tthis.callView.close();\n\t\t\tthis.closeReconnectionBaloon();\n\t\t\tthis.setError(ConferenceErrorCode.userLeftCall);\n\t\t\tthis.controller.getStore().commit('conference/endCall');\n\t\t}\n\n\t\tif (this.riseYouHandToTalkPopup)\n\t\t{\n\t\t\tthis.riseYouHandToTalkPopup.close();\n\t\t\tthis.riseYouHandToTalkPopup = null;\n\t\t}\n\n\t\tEventEmitter.unsubscribe(EventType.textarea.focus, this.onInputFocusHandler);\n\t\tEventEmitter.unsubscribe(EventType.textarea.blur, this.onInputBlurHandler);\n\t\tEventEmitter.unsubscribe(EventType.conference.userRenameFocus, this.onInputFocusHandler);\n\t\tEventEmitter.unsubscribe(EventType.conference.userRenameBlur, this.onInputBlurHandler);\n\t}\n\n\trestart()\n\t{\n\t\tconsole.trace(\" restart\");\n\t\tif(this.currentCall)\n\t\t{\n\t\t\tthis.removeCallEvents();\n\t\t\tthis.currentCall = null;\n\t\t}\n\n\t\tif (this.promotedToAdminTimeout)\n\t\t{\n\t\t\tclearTimeout(this.promotedToAdminTimeout);\n\t\t}\n\n\t\tif(this.callView)\n\t\t{\n\t\t\tthis.callView.releaseLocalMedia();\n\t\t\tthis.callView.close();\n\t\t\tthis.closeReconnectionBaloon();\n\t\t\tthis.callView.destroy();\n\t\t\tthis.callView = null;\n\t\t}\n\t\tthis.initCallInterface();\n\t\tthis.initCall();\n\t\tthis.controller.getStore().commit('conference/endCall');\n\t}\n\n\tkickFromCall()\n\t{\n\t\tthis.setError(ConferenceErrorCode.kickedFromCall);\n\t\tthis.pullClient.disconnect();\n\t\tthis.endCall();\n\t}\n\n\tgetCallUsers(includeSelf)\n\t{\n\t\tif (!this.currentCall)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tlet result = Object.keys(this.currentCall.getUsers());\n\t\tif (includeSelf)\n\t\t{\n\t\t\tresult.push(this.currentCall.userId);\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetActiveCallUsers()\n\t{\n\t\tconst userStates = this.currentCall.getUsers();\n\t\tlet activeUsers = [];\n\n\t\tfor (let userId in userStates)\n\t\t{\n\t\t\tif (userStates.hasOwnProperty(userId))\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tuserStates[userId] === Call.UserState.Connected\n\t\t\t\t\t|| userStates[userId] === Call.UserState.Connecting\n\t\t\t\t\t|| userStates[userId] === Call.UserState.Calling\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tactiveUsers.push(userId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn activeUsers;\n\t}\n\n\tsetLocalVideoStream(stream)\n\t{\n\t\tthis.localVideoStream = stream;\n\t}\n\n\tupdateMediaDevices() {\n\t\tCall.Hardware.getCurrentDeviceList()\n\t\tconsole.log('updateMediaDevices')\n\t}\n\n\tstopLocalVideoStream()\n\t{\n\t\tif (this.localVideoStream)\n\t\t{\n\t\t\tthis.localVideoStream.getTracks().forEach(tr => tr.stop());\n\t\t}\n\t\tthis.localVideoStream = null;\n\t}\n\n\tsetSelectedCamera(cameraId)\n\t{\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.setCameraId(cameraId)\n\t\t}\n\t}\n\n\tsetSelectedMic(micId)\n\t{\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.setMicrophoneId(micId);\n\t\t}\n\t}\n\n\tgetFeature(id)\n\t{\n\t\tif (typeof this.featureConfig[id] === 'undefined')\n\t\t{\n\t\t\treturn {\n\t\t\t\tid,\n\t\t\t\tstate: ConferenceApplication.FeatureState.Enabled,\n\t\t\t\tarticleCode: ''\n\t\t\t}\n\t\t}\n\n\t\treturn this.featureConfig[id];\n\t}\n\n\tgetFeatureState(id)\n\t{\n\t\treturn this.getFeature(id).state;\n\t}\n\n\t#canLocalRecord()\n\t{\n\t\tconst isDesktop = Utils.platform.isBitrixDesktop();\n\t\tconst isValidApi = Utils.platform.getDesktopVersion() >= 54;\n\n\t\t// It's a desktop with the right API version.\n\t\tif (!isDesktop || !isValidApi)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\t// If cloud recording is disabled, can record local\n\t\tif (!Call.CallCloudRecord.serviceEnabled)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\t// If the cloud recording tariff is not available, can record local\n\t\tif (!Call.CallCloudRecord.tariffAvailable)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\t// If the cloud recording is active, and it is a paid plan, then we turn it on only in plain\n\t\treturn this.currentCall.provider === Call.Provider.Plain;\n\t}\n\n\t#canCloudRecord()\n\t{\n\t\treturn Call.CallCloudRecord.serviceEnabled && Call.CallCloudRecord.tariffAvailable;\n\t}\n\n\t#canCommonRecord()\n\t{\n\t\treturn this.#canLocalRecord() || this.#canCloudRecord();\n\t}\n\n\t#isLocalRecordStarted()\n\t{\n\t\treturn this.#canLocalRecord()\n\t\t\t&& this.commonRecord.state != Call.CallCommonRecordState.Stopped\n\t\t\t&& this.commonRecord.state != Call.CallCommonRecordState.Destroyed;\n\t}\n\n\t#isCommonRecordStarted()\n\t{\n\t\treturn this.#canCommonRecord()\n\t\t\t&& this.commonRecord.state != Call.CallCommonRecordState.Stopped\n\t\t\t&& this.commonRecord.state != Call.CallCommonRecordState.Destroyed;\n\t}\n\n\tshowFeatureLimitSlider(id)\n\t{\n\t\tconst articleCode = this.getFeature(id).articleCode;\n\t\tif (!articleCode || !window.BX.UI.InfoHelper)\n\t\t{\n\t\t\tconsole.warn('Limit article not found', id);\n\t\t\treturn false;\n\t\t}\n\n\t\twindow.BX.UI.InfoHelper.show(articleCode);\n\n\t\treturn true;\n\t}\n\n\tshowNotification(notificationText, actions)\n\t{\n\t\tif (!actions)\n\t\t{\n\t\t\tactions = [];\n\t\t}\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: Text.encode(notificationText),\n\t\t\tposition: \"top-right\",\n\t\t\tautoHideDelay: 5000,\n\t\t\tcloseButton: true,\n\t\t\tactions: actions\n\t\t});\n\t}\n\t\n\t#isVpnConnected()\n\t{\n\t\tif (DesktopApi.isDesktop() && typeof BXDesktopSystem?.IsVpnConnected === 'function' && BXDesktopSystem.IsVpnConnected())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tcheckVpnStatus()\n\t{\n\t\tif (this.#isVpnConnected())\n\t\t{\n\t\t\tthis.showVpnIsActiveNotification();\n\t\t}\n\t}\n\n\tshowVpnIsActiveNotification()\n\t{\n\t\tif (this.callView)\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: Text.encode(Loc.getMessage('CALL_MESSAGE_VPN_IS_ACTIVE')),\n\t\t\t\tposition: 'top-right',\n\t\t\t\tautoHideDelay: 10000,\n\t\t\t\tcloseButton: true,\n\t\t\t\tcategory: 'vpnIsActive',\n\t\t\t});\n\t\t}\n\t}\n\n\tshowMicMutedNotification()\n\t{\n\t\tif (this.mutePopup || !this.callView || this.riseYouHandToTalkPopup || !Util.havePermissionToBroadcast('mic'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.mutePopup = new Call.Hint({\n\t\t\tbindElement: this.callView.buttons.microphone.elements.icon,\n\t\t\ttargetContainer: this.callView.container,\n\t\t\tbuttons: [\n\t\t\t\tthis.createUnmuteButton()\n\t\t\t],\n\t\t\tonClose: () =>\n\t\t\t{\n\t\t\t\tthis.allowMutePopup = false;\n\t\t\t\tthis.mutePopup.destroy();\n\t\t\t\tthis.mutePopup = null;\n\t\t\t},\n\t\t});\n\t\tthis.mutePopup.show();\n\t}\n\tcreateUnmuteButton()\n\t{\n\t\treturn new BX.UI.Button({\n\t\t\tbaseClass: \"ui-btn bx-call-view-popup-call-hint-unmute\",\n\t\t\ttext: BX.message(\"IM_CALL_UNMUTE_MIC\"),\n\t\t\tsize: BX.UI.Button.Size.EXTRA_SMALL,\n\t\t\tcolor: BX.UI.Button.Color.LIGHT_BORDER,\n\t\t\tnoCaps: true,\n\t\t\tround: true,\n\t\t\tevents: {\n\t\t\t\tclick: () =>\n\t\t\t\t{\n\t\t\t\t\tthis.onCallViewToggleMuteButtonClick({\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tmuted: false\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.mutePopup.destroy();\n\t\t\t\t\tthis.mutePopup = null;\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\tshowWebScreenSharePopup()\n\t{\n\t\tif (this.webScreenSharePopup)\n\t\t{\n\t\t\tthis.webScreenSharePopup.show();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.webScreenSharePopup = new Call.WebScreenSharePopup({\n\t\t\tbindElement: this.callView.buttons.screen.elements.root,\n\t\t\ttargetContainer: this.callView.container,\n\t\t\tonClose: function ()\n\t\t\t{\n\t\t\t\tthis.webScreenSharePopup.destroy();\n\t\t\t\tthis.webScreenSharePopup = null;\n\t\t\t}.bind(this),\n\t\t\tonStopSharingClick: function ()\n\t\t\t{\n\t\t\t\tthis.onCallViewToggleScreenSharingButtonClick();\n\t\t\t\tthis.webScreenSharePopup.destroy();\n\t\t\t\tthis.webScreenSharePopup = null;\n\t\t\t}.bind(this)\n\t\t});\n\t\tthis.webScreenSharePopup.show();\n\t}\n\n\tisViewerMode()\n\t{\n\t\tlet viewerMode = false;\n\t\tconst isBroadcast = this.isBroadcast();\n\t\tif (isBroadcast)\n\t\t{\n\t\t\tconst presenters = this.getBroadcastPresenters();\n\t\t\tconst currentUserId = this.controller.getStore().state.application.common.userId;\n\t\t\tconst isCurrentUserPresenter = presenters.includes(currentUserId);\n\t\t\tviewerMode = isBroadcast && !isCurrentUserPresenter;\n\t\t}\n\t\treturn viewerMode;\n\t}\n\n\tonCallCreated(e)\n\t{\n\t\tLogger.warn('we got event onCallCreated', e);\n\t\tif(this.preCall || this.currentCall)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tlet call = e.call;\n\t\tif (call.associatedEntity.type === 'chat' && call.associatedEntity.id === this.params.dialogId)\n\t\t{\n\t\t\tthis.preCall = e.call;\n\t\t\tthis.updatePreCallCounter();\n\t\t\tthis.preCall.addEventListener(Call.Event.onUserStateChanged, this.onPreCallUserStateChangedHandler);\n\t\t\tthis.preCall.addEventListener(Call.Event.onDestroy, this.onPreCallDestroyHandler);\n\n\t\t\tif (this.waitingForCallStatus)\n\t\t\t{\n\t\t\t\tthis.callEventReceived = true;\n\t\t\t}\n\t\t\tthis.setConferenceStatus(true);\n\t\t\tthis.setConferenceStartDate(e.call.startDate);\n\t\t}\n\n\t\tconst userReadyToJoin = this.getConference().common.userReadyToJoin;\n\t\tif (userReadyToJoin)\n\t\t{\n\t\t\tlet viewerMode = this.isViewerMode();\n\n\t\t\tconst videoEnabled = this.getConference().common.joinWithVideo;\n\t\t\tLogger.warn('ready to join call after waiting', videoEnabled, viewerMode);\n\t\t\tsetTimeout(() => {\n\t\t\t\tCall.Hardware.init().then(() => {\n\t\t\t\t\tif (viewerMode && this.preCall)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.joinCall(this.preCall.id, this.preCall.uuid, {\n\t\t\t\t\t\t\tjoinAsViewer: true\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.joinCall(this.preCall.id, this.preCall.uuid, {\n\t\t\t\t\t\t\tvideo: videoEnabled\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, 1000);\n\t\t}\n\t}\n\n\treleasePreCall()\n\t{\n\t\tif(this.preCall)\n\t\t{\n\t\t\tthis.preCall.removeEventListener(Call.Event.onUserStateChanged, this.onPreCallUserStateChangedHandler);\n\t\t\tthis.preCall.removeEventListener(Call.Event.onDestroy, this.onPreCallDestroyHandler);\n\t\t\tthis.preCall = null;\n\t\t}\n\t}\n\n\tonPreCallDestroy(e)\n\t{\n\t\tif (this.waitingForCallStatusTimeout)\n\t\t{\n\t\t\tclearTimeout(this.waitingForCallStatusTimeout);\n\t\t}\n\t\tthis.setConferenceStatus(false);\n\n\t\tthis.releasePreCall();\n\t}\n\n\tonPreCallUserStateChanged(e)\n\t{\n\t\tthis.updatePreCallCounter();\n\t}\n\n\tupdatePreCallCounter()\n\t{\n\t\tif(this.preCall)\n\t\t{\n\t\t\tthis.controller.getStore().commit('conference/common', {\n\t\t\t\tuserInCallCount: this.preCall.getParticipatingUsers().length\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.controller.getStore().commit('conference/common', {\n\t\t\t\tuserInCallCount: 0\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateVideoStrategy()\n\t{\n\t\tif (this.videoStrategy)\n\t\t{\n\t\t\tthis.videoStrategy.destroy();\n\t\t}\n\n\t\tvar strategyType = Utils.device.isMobile() ? VideoStrategy.Type.OnlySpeaker : VideoStrategy.Type.AllowAll;\n\n\t\tthis.videoStrategy = new VideoStrategy({\n\t\t\tcall: this.currentCall,\n\t\t\tcallView: this.callView,\n\t\t\tstrategyType: strategyType\n\t\t});\n\t}\n\n\tremoveVideoStrategy()\n\t{\n\t\tif (this.videoStrategy)\n\t\t{\n\t\t\tthis.videoStrategy.destroy();\n\t\t}\n\t\tthis.videoStrategy = null;\n\t}\n\n\tonCallReplaceCamera(event)\n\t{\n\t\tlet cameraId = event.data.deviceId;\n\n\t\tif (this.reconnectingCameraId) {\n\t\t\tthis.setReconnectingCameraId(null);\n\t\t}\n\n\t\tCall.Hardware.defaultCamera = cameraId;\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.currentCall.setCameraId(cameraId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.template.$emit('cameraSelected', cameraId);\n\t\t}\n\t}\n\n\tonCallReplaceMicrophone(event)\n\t{\n\t\tlet microphoneId = event.data.deviceId;\n\t\tCall.Hardware.defaultMicrophone = microphoneId.deviceId;\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.setMicrophoneId(microphoneId);\n\t\t}\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.currentCall.setMicrophoneId(microphoneId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.template.$emit('micSelected', event.data.deviceId);\n\t\t}\n\t}\n\n\tonCallReplaceSpeaker(event)\n\t{\n\t\tCall.Hardware.defaultSpeaker = event.data.deviceId;\n\t}\n\n\tonCallViewHasMainStream(event)\n\t{\n\t\tif (this.currentCall && this.currentCall.provider === Call.Provider.Bitrix)\n\t\t{\n\t\t\tthis.currentCall.setMainStream(event.data);\n\t\t}\n\t}\n\n\t_onCallViewTurnOffParticipantMic(e)\n\t{\n\t\tthis.currentCall.turnOffParticipantStream({typeOfStream: 'mic', userId: e.userId, fromUserId: this.callEngine.getCurrentUserId()});\n\n\t\tAnalytics.getInstance().onTurnOffParticipantStream({\n\t\t\tcallId: this._getCallIdentifier(this.currentCall),\n\t\t\tcallType: this.getCallType(),\n\t\t\ttypeOfSetting: 'mic',\n\t\t});\n\t}\n\n\t_onCallViewTurnOffParticipantCam(e)\n\t{\n\t\tthis.currentCall.turnOffParticipantStream({typeOfStream: 'cam', userId: e.userId, fromUserId: this.callEngine.getCurrentUserId()});\n\n\t\tAnalytics.getInstance().onTurnOffParticipantStream({\n\t\t\tcallId: this._getCallIdentifier(this.currentCall),\n\t\t\tcallType: this.getCallType(),\n\t\t\ttypeOfSetting: 'cam',\n\t\t});\n\t}\n\n\t_onCallViewTurnOffParticipantScreenshare(e)\n\t{\n\t\tthis.currentCall.turnOffParticipantStream({typeOfStream: 'screenshare', userId: e.userId, fromUserId: this.callEngine.getCurrentUserId()});\n\n\t\tAnalytics.getInstance().onTurnOffParticipantStream({\n\t\t\tcallId: this._getCallIdentifier(this.currentCall),\n\t\t\tcallType: this.getCallType(),\n\t\t\ttypeOfSetting: 'screenshare',\n\t\t});\n\t}\n\n\t_onCallViewAllowSpeakPermission(e)\n\t{\n\t\tthis.currentCall.allowSpeakPermission({allow: true, userId: e.userId});\n\n\t\tAnalytics.getInstance().onAllowPermissionToSpeakResponse({\n\t\t\tcallId: this._getCallIdentifier(this.currentCall),\n\t\t\tcallType: this.getCallType(),\n\t\t});\n\t}\n\n\t_onCallViewDisallowSpeakPermission(e)\n\t{\n\t\tthis.currentCall.allowSpeakPermission({allow: false, userId: e.userId});\n\n\t\tAnalytics.getInstance().onDisallowPermissionToSpeakResponse({\n\t\t\tcallId: this._getCallIdentifier(this.currentCall),\n\t\t\tcallType: this.getCallType(),\n\t\t});\n\t}\n\n\tonCallViewChangeHdVideo(event)\n\t{\n\t\tCall.Hardware.preferHdQuality = event.data.allowHdVideo;\n\t}\n\n\tonCallViewChangeNoiseSuppression(event)\n\t{\n\t\tCall.Hardware.enableNoiseSuppression = event.data.allowNoiseSuppression;\n\t\tCall.Hardware.turnNoiseSuppression();\n\t}\n\n\tonCallViewChangeMicAutoParams(event)\n\t{\n\t\tCall.Hardware.enableMicAutoParameters = event.data.allowMicAutoParams;\n\t}\n\n\t_onChangeVideoQuality(event)\n\t{\n\t\tif (this.currentCall && this.currentCall.provider === Call.Provider.Bitrix)\n\t\t{\n\t\t\tconst params = {\n\t\t\t\tisCameraWasEnabledBeforeQualityChanged: event.isCameraWasEnabledBeforeQualityChanged,\n\t\t\t\tvideoQuality: event.videoQuality,\n\t\t\t\totherUsers: this.currentCall.users,\n\t\t\t};\n\t\t\tthis.currentCall.setVideoQualityForStreams(params);\n\t\t}\n\t}\n\n\tonCallViewChangeFaceImprove(event)\n\t{\n\t\tif (!DesktopApi.isDesktop())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDesktopApi.setCameraSmoothingStatus(event.data.faceImproveEnabled);\n\t}\n\n\tonCallViewUserRename(event)\n\t{\n\t\tconst newName = event.data.newName;\n\n\t\tif (!this.isExternalUser())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (Utils.device.isMobile())\n\t\t{\n\t\t\tthis.renameGuestMobile(newName)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.renameGuest(newName);\n\t\t}\n\t}\n\n\tonCallViewUserPinned(event)\n\t{\n\t\tif (event.data.userId)\n\t\t{\n\t\t\tthis.updateCallUser(event.data.userId, {pinned: true});\n\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.controller.getStore().dispatch('call/unpinUser');\n\n\t\treturn true;\n\t}\n\n\tonCallToggleSubscribe(e) {\n\t\tif (this.currentCall && this.currentCall.provider === Call.Provider.Bitrix && e.data)\n\t\t{\n\t\t\tthis.currentCall.toggleRemoteParticipantVideo(e.data.participants, e.data.showVideo, true)\n\t\t}\n\t}\n\n\tasync renameGuest(newName)\n\t{\n\t\tthis.callView.localUser.userModel.renameRequested = true;\n\t\ttry\n\t\t{\n\t\t\tconst response = await this.setUserName(newName);\n\t\t\tconst result = response?.answer?.result;\n\t\t\tif (Type.isString(result?.userToken) && result.userToken.length > 0)\n\t\t\t{\n\t\t\t\tCallTokenManager.setUserToken(result.userToken);\n\t\t\t}\n\t\t\tthis.currentCall?.updateUserData({ name: newName });\n\t\t\tthis.callView.localUser.userModel.wasRenamed = true;\n\t\t\tLogger.log('setting name to', newName);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tLogger.error('error setting name', error);\n\t\t}\n\t}\n\n\trenameGuestMobile(newName)\n\t{\n\t\tthis.setUserName(newName).then(() => {\n\t\t\tLogger.log('setting mobile name to', newName);\n\t\t\tif (this.callView.renameSlider)\n\t\t\t{\n\t\t\t\tthis.callView.renameSlider.close();\n\t\t\t}\n\t\t}).catch(error => {\n\t\t\tLogger.error('error setting name', error);\n\t\t});\n\t}\n\n\tonCallButtonClick(event)\n\t{\n\t\tconst buttonName = event.data.buttonName;\n\t\tLogger.warn('Button clicked!', buttonName);\n\n\t\tconst handlers = {\n\t\t\thangup: this.onCallViewHangupButtonClick.bind(this),\n\t\t\thangupOptions: this._onCallViewHangupOptionsButtonClick.bind(this),\n\t\t\tclose: this.onCallViewCloseButtonClick.bind(this),\n\t\t\t//inviteUser: this.onCallViewInviteUserButtonClick.bind(this),\n\t\t\ttoggleMute: this.onCallViewToggleMuteButtonClick.bind(this),\n\t\t\ttoggleScreenSharing: this.onCallViewToggleScreenSharingButtonClick.bind(this),\n\t\t\trecord: this.#onCallViewRecordButtonClick.bind(this),\n\t\t\ttoggleVideo: this.onCallViewToggleVideoButtonClick.bind(this),\n\t\t\ttoggleSpeaker: this.onCallViewToggleSpeakerButtonClick.bind(this),\n\t\t\tshowChat: this.onCallViewShowChatButtonClick.bind(this),\n\t\t\ttoggleUsers: this.onCallViewToggleUsersButtonClick.bind(this),\n\t\t\tshare: this.onCallViewShareButtonClick.bind(this),\n\t\t\tfullscreen: this.onCallViewFullScreenButtonClick.bind(this),\n\t\t\tfloorRequest: this.onCallViewFloorRequestButtonClick.bind(this),\n\t\t\tfeedback: this.onCallViewFeedbackButtonClick.bind(this),\n\t\t\tcallcontrol: this._onCallcontrolButtonClick.bind(this),\n\t\t\tonUserClick: this.onCallUserClick.bind(this),\n\t\t\tcopilot: this.onCallCopilotButtonClick.bind(this),\n\t\t};\n\n\t\tif(handlers[buttonName])\n\t\t{\n\t\t\thandlers[buttonName](event);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tLogger.error('Button handler not found!', buttonName);\n\t\t}\n\t}\n\n\tonCallViewHangupButtonClick(e)\n\t{\n\t\tAnalytics.getInstance().onDisconnectCall({\n\t\t\tcallId: this.currentCall?.uuid,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\tsubSection: Analytics.AnalyticsSubSection.finishButton,\n\t\t\tmediaParams: {\n\t\t\t\tvideo: Call.Hardware.isCameraOn,\n\t\t\t\taudio: !Call.Hardware.isMicrophoneMuted,\n\t\t\t},\n\t\t});\n\t\tthis.stopLocalVideoStream();\n\t\tthis.endCall();\n\t}\n\n\t_onCallViewHangupOptionsButtonClick()\n\t{\n\t\tif (this.hangupOptionsMenu)\n\t\t{\n\t\t\tthis.hangupOptionsMenu.destroy();\n\t\t\treturn;\n\t\t}\n\n\t\tconst targetNodeWidth = this.callView.buttons.hangupOptions.elements.root.offsetWidth;\n\n\t\tlet menuItems = [\n\t\t\t{\n\t\t\t\ttext: BX.message(\"CALL_M_BTN_HANGUP_OPTION_FINISH\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tAnalytics.getInstance().onFinishCall({\n\t\t\t\t\t\tcallId: this.currentCall?.uuid,\n\t\t\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\t\t\tstatus: Analytics.AnalyticsStatus.finishedForAll,\n\t\t\t\t\t\tchatId: this.currentCall?.associatedEntity.id,\n\t\t\t\t\t\tcallUsersCount: this.getCallUsers(true).length,\n\t\t\t\t\t\tcallLength: Util.getTimeText(this.currentCall?.startDate),\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\tthis.hangupOptionsMenu?.destroy();\n\n\t\t\t\t\tthis.stopLocalVideoStream();\n\t\t\t\t\tthis.endCall(true);\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: BX.message(\"CALL_M_BTN_HANGUP_OPTION_LEAVE\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tAnalytics.getInstance().onDisconnectCall({\n\t\t\t\t\t\tcallId: this.currentCall?.uuid,\n\t\t\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\t\t\tsubSection: Analytics.AnalyticsSubSection.contextMenu,\n\t\t\t\t\t\tmediaParams: {\n\t\t\t\t\t\t\tvideo: Call.Hardware.isCameraOn,\n\t\t\t\t\t\t\taudio: !Call.Hardware.isMicrophoneMuted,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tthis.hangupOptionsMenu?.destroy();\n\t\t\t\t\tthis.stopLocalVideoStream();\n\t\t\t\t\tthis.endCall(false);\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\tthis.hangupOptionsMenu = new BX.PopupMenuWindow({\n\t\t\tclassName: 'bx-messenger-videocall-hangup-options-container',\n\t\t\tbackground: '#00428F',\n\t\t\tcontentBackground: '#00428F',\n\t\t\tdarkMode: true,\n\t\t\tcontentBorderRadius: '6px',\n\t\t\tborderRadius: '6px',\n\t\t\tangle: false,\n\t\t\tbindElement: this.callView.buttons.hangupOptions.elements.root,\n\t\t\ttargetContainer: this.container,\n\t\t\toffsetTop: -15,\n\t\t\tbindOptions: {position: \"top\"},\n\t\t\tcacheable: false,\n\t\t\tsubMenuOptions: {\n\t\t\t\tmaxWidth: 450\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonShow: (event) =>\n\t\t\t\t{\n\t\t\t\t\tconst popup = event.getTarget();\n\t\t\t\t\tpopup.getPopupContainer().style.display = 'block'; // bad hack\n\n\t\t\t\t\tconst offsetLeft = (targetNodeWidth / 2) - popup.getPopupContainer().offsetWidth / 2;\n\t\t\t\t\tpopup.setOffset({offsetLeft: offsetLeft + 40, offsetTop: 0});\n\t\t\t\t\tpopup.setAngle({offset: popup.getPopupContainer().offsetWidth / 2 - 17});\n\t\t\t\t},\n\t\t\t\tonDestroy: () => this.hangupOptionsMenu = null\n\t\t\t},\n\t\t\titems: menuItems,\n\t\t});\n\n\t\tthis.hangupOptionsMenu.show();\n\t}\n\n\tonCallViewCloseButtonClick(e)\n\t{\n\t\tthis.stopLocalVideoStream();\n\t\tthis.endCall();\n\t}\n\n\tonCallViewToggleMuteButtonClick(event)\n\t{\n\t\t/*if (!Call.Hardware.hasMicrophone() &&  !event.data.muted)\n\t\t{\n\t\t\treturn;\n\t\t}*/\n\n\t\tAnalytics.getInstance().onToggleMicrophone({\n\t\t\tmuted: event.data.muted,\n\t\t\tcallId: this.currentCall ? this.currentCall.uuid : 0,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t});\n\n\t\t/*if (this.currentCall && !this.currentCall.microphoneId && !event.data.muted)\n\t\t{\n\t\t\tthis.currentCall.setMicrophoneId(Call.Hardware.defaultMicrophone);\n\t\t}\n\n\t\tCall.Hardware.isMicrophoneMuted = event.data.muted;\n\t\tif (!this.currentCall)\n\t\t{\n\t\t\tthis.template.$emit('setMicState', !event.data.muted);\n\t\t}\n\n\t\tif (this.#isCommonRecordStarted())\n\t\t{\n\t\t\tBXDesktopSystem.CallRecordMute(event.data.muted);\n\t\t}\n\n\t\tif (this.currentCall?.userId)\n\t\t{\n\t\t\tthis.updateCallUser(this.currentCall.userId, {microphoneState: !event.data.muted});\n\t\t}*/\n\n\t\tthis._onCallViewToggleMuteHandler(event.data);\n\t}\n\n\t_onCallViewToggleMuteHandler(e)\n\t{\n\t\tif (!e.muted && !Hardware?.hasMicrophone())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentRoom = this.currentCall && this.currentCall.currentRoom && this.currentCall.currentRoom();\n\t\tif (currentRoom && currentRoom.speaker != this.userId && !e.muted)\n\t\t{\n\t\t\tthis.currentCall.requestRoomSpeaker();\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.currentCall && !this.currentCall.microphoneId && !e.muted)\n\t\t{\n\t\t\tthis.currentCall.setMicrophoneId(Hardware.defaultMicrophone);\n\t\t}\n\n\t\tHardware.setIsMicrophoneMuted({isMicrophoneMuted: e.muted, calledProgrammatically: !!e.calledProgrammatically});\n\n\t\tif (this.floatingWindow)\n\t\t{\n\t\t\tthis.floatingWindow.setAudioMuted(e.muted);\n\t\t}\n\n\t\tif (this.mutePopup)\n\t\t{\n\t\t\tthis.mutePopup.close();\n\t\t}\n\t\tif (!e.muted)\n\t\t{\n\t\t\tif (!Util.havePermissionToBroadcast('mic'))\n\t\t\t{\n\t\t\t\tthis.showRiseYouHandToTalkNotification({initiatorName: this.lastCalledChangeSettingsUserName});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.allowMutePopup = true;\n\t\t\t}\n\t\t}\n\n\t\tif (this.#isCommonRecordStarted() && this.#canLocalRecord())\n\t\t{\n\t\t\tBXDesktopSystem.CallRecordMute(e.muted);\n\t\t}\n\n\t\tif (this.currentCall?.userId)\n\t\t{\n\t\t\tthis.updateCallUser(this.currentCall.userId, {microphoneState: !e.muted});\n\t\t}\n\n\t\tif (!this.currentCall)\n\t\t{\n\t\t\tthis.template.$emit('setMicState', !e.muted);\n\t\t}\n\t}\n\n\tonCallViewToggleScreenSharingButtonClick()\n\t{\n\t\tAnalytics.getInstance().onScreenShareBtnClick({\n\t\t\tcallId: this.currentCall.uuid,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t});\n\n\t\tif (this.getFeatureState('screenSharing') === ConferenceApplication.FeatureState.Limited)\n\t\t{\n\t\t\tthis.showFeatureLimitSlider('screenSharing');\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getFeatureState('screenSharing') === ConferenceApplication.FeatureState.Disabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.currentCall.isScreenSharingStarted())\n\t\t{\n\t\t\tthis.currentCall.stopScreenSharing();\n\n\t\t\tif (this.#isCommonRecordStarted() && this.#canLocalRecord())\n\t\t\t{\n\t\t\t\tBXDesktopSystem.CallRecordStopSharing();\n\t\t\t}\n\n\t\t\tif (this.floatingScreenShareWindow)\n\t\t\t{\n\t\t\t\tthis.floatingScreenShareWindow.close();\n\t\t\t}\n\n\t\t\tif (this.webScreenSharePopup)\n\t\t\t{\n\t\t\t\tthis.webScreenSharePopup.close();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tBX.ajax.runAction('call.Call.onShareScreen', { data: { callUuid: this.currentCall.uuid } });\n\t\t\tthis.currentCall.startScreenSharing();\n\t\t\tthis.togglePictureInPictureCallWindow();\n\t\t}\n\t}\n\n\ttogglePictureInPictureCallWindow(config = {})\n\t{\n\t\tconst isActiveStatePictureInPictureCallWindow = this.currentCall && (this.currentCall.isScreenSharingStarted() || config.isForceOpen) && !config.isForceClose;\n\n\t\tif (!this.callView)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callView.isActivePiPFromController = isActiveStatePictureInPictureCallWindow;\n\t\tthis.callView.toggleStatePictureInPictureCallWindow(isActiveStatePictureInPictureCallWindow);\n\n\t}\n\n\t#startCommonRecord(type)\n\t{\n\t\tconst isPlainCall = this.currentCall.provider === Call.Provider.Plain;\n\n\t\tthis.commonRecord.type = type;\n\n\t\tif (Call.CallCloudRecord.serviceEnabled && !isPlainCall)\n\t\t{\n\t\t\tconst kind = type === 'audio' ? Call.CloudRecordKind.AUDIO : Call.CloudRecordKind.VIDEO;\n\t\t\tthis.callView.blockButtons(['record']);\n\t\t\tthis.currentCall.setCloudRecordState(Call.CloudRecordStatus.STARTED, kind);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callView.setButtonActive('record', true);\n\n\t\tthis.currentCall.sendLocalRecordState({\n\t\t\taction: Call.CallCommonRecordState.Started,\n\t\t\ttype: this.commonRecord.type,\n\t\t\tdate: new Date(),\n\t\t});\n\n\t\tthis.commonRecord.state = Call.CallCommonRecordState.Started;\n\t}\n\n\t#stopCommonRecord()\n\t{\n\t\tconst initiatorId = this.commonRecord.initiatorId;\n\t\tconst state = this.commonRecord.state;\n\n\t\tthis.commonRecord = this.#getDefaultCommonRecord();\n\n\t\tif (this.#canLocalRecord())\n\t\t{\n\t\t\tBXDesktopSystem.CallRecordStop();\n\t\t}\n\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.setCommonRecordState(this.callView.getDefaultCommonRecordState());\n\t\t\tthis.callView.setButtonActive('record', false);\n\t\t}\n\n\t\tif (\n\t\t\tstate !== Call.CallCommonRecordState.Stopped\n\t\t\t&& (this.currentCall && this.currentCall.isAnyoneParticipating())\n\t\t\t&& initiatorId === this.currentCall.userId\n\t\t)\n\t\t{\n\t\t\tthis.currentCall.sendLocalRecordState({\n\t\t\t\taction: Call.CallCommonRecordState.Stopped,\n\t\t\t\tuserId: this.currentCall.userId,\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * @param { Object } event\n\t * @param { string } event.state\n\t * @param { string } event.kind\n\t * @param { boolean } event.hotkey\n\t */\n\t#onCommonRecordMenu(event)\n\t{\n\t\tconst { state, kind, hotkey } = event.data;\n\n\t\t// Recording state (Started, Paused, Stopped, etc.)\n\t\tswitch (state)\n\t\t{\n\t\t\tcase Call.CallCommonRecordState.Started:\n\t\t\t{\n\t\t\t\t// If forced recording  start immediately\n\t\t\t\tif (hotkey)\n\t\t\t\t{\n\t\t\t\t\tthis.#startCommonRecord(Call.CallCommonRecordType.Video);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (kind === Call.CallCommonRecordType.Audio)\n\t\t\t\t{\n\t\t\t\t\t// If copilot is active  ask if recording is needed\n\t\t\t\t\tif (this.currentCall && this.currentCall.isCopilotActive)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.callView\n\t\t\t\t\t\t\t.showConfirmModal({\n\t\t\t\t\t\t\t\ttitle: Loc.getMessage('CALL_RECORD_AUDIO_WITH_COPILOT_TITLE'),\n\t\t\t\t\t\t\t\tmessage: Loc.getMessage('CALL_RECORD_AUDIO_WITH_COPILOT_MESSAGE'),\n\t\t\t\t\t\t\t\tyesButtonText: Loc.getMessage('CALL_RECORD_AUDIO_WITH_COPILOT_YES_BUTTON'),\n\t\t\t\t\t\t\t\tnoButtonText: Loc.getMessage('CALL_RECORD_AUDIO_WITH_COPILOT_NO_BUTTON'),\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.then((choice) => {\n\t\t\t\t\t\t\t\tif (choice === 'no')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis.#startCommonRecord(Call.CallCommonRecordType.Audio);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch((error) => console.error('Unspecified error in callView.showConfirmModal:', error));\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// Else start audio recording immediately\n\t\t\t\t\tthis.#startCommonRecord(Call.CallCommonRecordType.Audio);\n\t\t\t\t}\n\n\t\t\t\t// Start video recording\n\t\t\t\tif (kind === Call.CallCommonRecordType.Video)\n\t\t\t\t{\n\t\t\t\t\tthis.#startCommonRecord(Call.CallCommonRecordType.Video);\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcase Call.CallCommonRecordState.Paused:\n\t\t\tcase Call.CallCommonRecordState.Resumed:\n\t\t\t{\n\t\t\t\t// For cloud recording  change recorder state\n\t\t\t\tif (this.#canCloudRecord())\n\t\t\t\t{\n\t\t\t\t\tconst status = (state === Call.CallCommonRecordState.Paused ? Call.CloudRecordStatus.PAUSED : Call.CloudRecordStatus.STARTED);\n\t\t\t\t\tthis.currentCall.setCloudRecordState(status);\n\t\t\t\t\tthis.commonRecord.state = state;\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// For desktop  pause / resume recording\n\t\t\t\tif (this.#canLocalRecord())\n\t\t\t\t{\n\t\t\t\t\tBXDesktopSystem.CallRecordPause(state === Call.CallCommonRecordState.Paused);\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase Call.CallCommonRecordState.Stopped:\n\t\t\t{\n\t\t\t\t// For cloud recording  block button and stop recording\n\t\t\t\tif (this.#canCloudRecord())\n\t\t\t\t{\n\t\t\t\t\tthis.callView.blockButtons(['record']);\n\t\t\t\t\tthis.currentCall.setCloudRecordState(Call.CloudRecordStatus.STOPPED);\n\t\t\t\t\tthis.commonRecord.state = Call.CallCommonRecordState.Stopped;\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// For desktop  just deactivate the recording button\n\t\t\t\tthis.callView.setButtonActive('record', false);\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase Call.CallCommonRecordState.Destroyed:\n\t\t\t{\n\t\t\t\t// For cloud recording  confirm recording deletion\n\t\t\t\tif (this.#canCloudRecord())\n\t\t\t\t{\n\t\t\t\t\tthis.callView\n\t\t\t\t\t\t.showConfirmModal({\n\t\t\t\t\t\t\ttitle: Loc.getMessage('CALL_CLOUD_RECORD_DESTROY_TITLE'),\n\t\t\t\t\t\t\tmessage: Loc.getMessage('CALL_CLOUD_RECORD_DESTROY_MESSAGE'),\n\t\t\t\t\t\t\tyesButtonText: Loc.getMessage('CALL_CLOUD_RECORD_DESTROY_RESUME_BUTTON'),\n\t\t\t\t\t\t\tnoButtonText: Loc.getMessage('CALL_CLOUD_RECORD_DESTROY_DELETE_BUTTON'),\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then((choice) => {\n\t\t\t\t\t\t\tif (choice === 'no')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.callView.blockButtons(['record']);\n\t\t\t\t\t\t\t\tthis.currentCall.setCloudRecordState(Call.CloudRecordStatus.DESTROYED);\n\t\t\t\t\t\t\t\tthis.commonRecord.state = Call.CallCommonRecordState.Destroyed;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((error) => console.error('Unspecified error in callView.showConfirmModal:', error));\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t{\n\t\t\t\tconsole.warn('Unknown recording state', state);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// Send current recording state\n\t\tthis.currentCall.sendLocalRecordState({\n\t\t\taction: state,\n\t\t\ttype: this.commonRecord.type,\n\t\t\tdate: new Date(),\n\t\t});\n\n\t\t// Save current recording state locally\n\t\tthis.commonRecord.state = state;\n\t}\n\n\t#onCallViewRecordButtonClick()\n\t{\n\t\t// Send analytics event for record button click\n\t\tAnalytics.getInstance().onRecordBtnClick({\n\t\t\tcallId: this.currentCall.uuid,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t});\n\n\t\tif (Call.CallCloudRecord.serviceEnabled)\n\t\t{\n\t\t\tif (!Call.CallCloudRecord.tariffAvailable)\n\t\t\t{\n\t\t\t\tUtil.openArticle(Call.CallCloudRecord.tariffSlider);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst isPlainCall = this.currentCall.provider === Call.Provider.Plain;\n\n\t\t\tif (isPlainCall && !DesktopApi.isDesktop())\n\t\t\t{\n\t\t\t\tthis.callView.showCloudRecordInfoPopup(this.currentCall.isCloudRecordFeaturesEnabled, this.currentCall.id);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.callView.showCommonRecordMenuPopup(isPlainCall && DesktopApi.isDesktop());\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.#canCommonRecord())\n\t\t{\n\t\t\tif (window.BX.Helper)\n\t\t\t{\n\t\t\t\twindow.BX.Helper.show('redirect=detail&code=22079566');\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callView.showCommonRecordMenuPopup(true);\n\t}\n\n\t_onCallViewToggleVideoButtonClickHandler(e)\n\t{\n\t\tif (!Hardware.initialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.video && Object.values(Hardware.cameraList).length === 0)\n\t\t{\n\t\t\tthis.showNotification(Loc.getMessage('IM_CALL_CAMERA_ERROR_FALLBACK_TO_MIC'));\n\n\t\t\treturn;\n\t\t}\n\n\t\tHardware.setIsCameraOn({ isCameraOn: e.video, calledProgrammatically: Boolean(e.calledProgrammatically) });\n\n\t\tif (this.currentCall && !e.video && !this.currentCall.isScreenSharingStarted())\n\t\t{\n\t\t\tthis.callView.releaseLocalMedia();\n\t\t}\n\n\t\tif (this.currentCall && !this.currentCall.cameraId && e.video)\n\t\t{\n\t\t\tthis.currentCall.setCameraId(Hardware.defaultCamera);\n\t\t}\n\n\t\tif (!this.currentCall)\n\t\t{\n\t\t\tthis.template.$emit('setCameraState', e.video);\n\t\t}\n\t}\n\n\tonCallViewToggleVideoButtonClick(event)\n\t{\n\t\t/*if (!Call.Hardware.hasCamera() &&  event.data.video)\n\t\t{\n\t\t\tthis.showNotification(BX.message('IM_CALL_NO_CAMERA_ERROR'));\n\t\t\treturn;\n\t\t}*/\n\n\t\tAnalytics.getInstance().onToggleCamera({\n\t\t\tvideo: event.data.video,\n\t\t\tcallId: this.currentCall ? this.currentCall.uuid : 0,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t});\n\n\t\tthis._onCallViewToggleVideoButtonClickHandler(event.data);\n\n\t\t/*Call.Hardware.isCameraOn = event.data.video;\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tif (!Call.Hardware.initialized)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (event.data.video && Object.values(Call.Hardware.cameraList).length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!event.data.video)\n\t\t\t{\n\t\t\t\tthis.callView.releaseLocalMedia();\n\t\t\t}\n\n\t\t\tif (!this.currentCall.cameraId && event.data.video)\n\t\t\t{\n\t\t\t\tthis.currentCall.setCameraId(Call.Hardware.defaultCamera);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.template.$emit('setCameraState', event.data.video);\n\t\t}*/\n\t}\n\n\tonCallViewToggleSpeakerButtonClick(event)\n\t{\n\t\tthis.callView.muteSpeaker(!event.data.speakerMuted);\n\n\t\tif (event.data.fromHotKey)\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: BX.message(this.callView.speakerMuted? 'IM_M_CALL_MUTE_SPEAKERS_OFF': 'IM_M_CALL_MUTE_SPEAKERS_ON'),\n\t\t\t\tposition: \"top-right\",\n\t\t\t\tautoHideDelay: 3000,\n\t\t\t\tcloseButton: true\n\t\t\t});\n\t\t}\n\t}\n\n\tonCallViewShareButtonClick()\n\t{\n\t\tlet notifyWidth = 400;\n\t\tif (Utils.device.isMobile() && document.body.clientWidth < 400)\n\t\t{\n\t\t\tnotifyWidth = document.body.clientWidth - 40;\n\t\t}\n\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage('BX_IM_VIDEOCONF_LINK_COPY_DONE'),\n\t\t\tautoHideDelay: 4000,\n\t\t\twidth: notifyWidth\n\t\t});\n\n\t\tClipboard.copy(this.getDialogData().public.link);\n\t}\n\n\tonCallViewFullScreenButtonClick()\n\t{\n\t\tthis.toggleFullScreen();\n\t}\n\n\tonFloatingScreenShareBackToCallClick()\n\t{\n\t\tDesktopApi.activateWindow();\n\t\tDesktopApi.changeTab(\"im\");\n\t\tif (this.floatingScreenShareWindow)\n\t\t{\n\t\t\tthis.floatingScreenShareWindow.hide();\n\t\t}\n\t}\n\n\tonFloatingScreenShareStopClick()\n\t{\n\t\tDesktopApi.activateWindow();\n\t\tDesktopApi.changeTab(\"im\");\n\t\tthis.onCallViewToggleScreenSharingButtonClick();\n\t}\n\n\tonFloatingScreenShareChangeScreenClick()\n\t{\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.currentCall.startScreenSharing(true);\n\t\t}\n\t}\n\n\tupdateWindowFocusState(isActive)\n\t{\n\t\tif (isActive === this.isWindowFocus)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.isWindowFocus = isActive;\n\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.setWindowFocusState(this.isWindowFocus);\n\t\t}\n\t}\n\n\tclearPictureInPictureDebounceForOpen()\n\t{\n\t\tif (this.pictureInPictureDebounceForOpen)\n\t\t{\n\t\t\tclearTimeout(this.pictureInPictureDebounceForOpen);\n\t\t\tthis.pictureInPictureDebounceForOpen = null;\n\t\t}\n\t}\n\n\tonInputFileOpenedStateUpdate(isActive)\n\t{\n\t\tif (isActive)\n\t\t{\n\t\t\tthis.clearPictureInPictureDebounceForOpen();\n\t\t\tthis.togglePictureInPictureCallWindow({ isForceClose: true });\n\t\t\tthis.isFileChooserActive = true;\n\t\t}\n\n\t\tif (!isActive && !this.pictureInPictureDebounceForOpen)\n\t\t{\n\t\t\tthis.pictureInPictureDebounceForOpen = setTimeout(() => {\n\t\t\t\tthis.togglePictureInPictureCallWindow();\n\t\t\t\tthis.isFileChooserActive = false;\n\t\t\t\tthis.pictureInPictureDebounceForOpen = null;\n\t\t\t}, 1000);\n\t\t}\n\t}\n\n\tonDocumentBodyClick()\n\t{\n\t\tconst { target } = event;\n\n\t\tif (target.matches('input[type=\"file\"]'))\n\t\t{\n\t\t\tthis.onInputFileOpenedStateUpdate(true);\n\t\t}\n\t}\n\n\tonWindowFocus()\n\t{\n\t\tif (DesktopApi.isDesktop())\n\t\t{\n\t\t\tthis.onWindowDesktopFocus();\n\t\t}\n\n\t\tif (DesktopApi.isDesktop() && this.isFileChooserActive)\n\t\t{\n\t\t\tthis.onInputFileOpenedStateUpdate(false);\n\t\t}\n\n\t\tthis.updateWindowFocusState(true);\n\t}\n\n\tonWindowBlur()\n\t{\n\t\tif (DesktopApi.isDesktop())\n\t\t{\n\t\t\tthis.onWindowDesktopBlur();\n\t\t}\n\n\t\tthis.updateWindowFocusState(false);\n\t}\n\n\tonWindowDesktopFocus()\n\t{\n\t\tif (this.floatingScreenShareWindow)\n\t\t{\n\t\t\tthis.floatingScreenShareWindow.hide();\n\t\t}\n\t}\n\n\tonWindowDesktopBlur()\n\t{\n\t\tif(this.floatingScreenShareWindow && this.currentCall && this.currentCall.isScreenSharingStarted())\n\t\t{\n\t\t\tthis.floatingScreenShareWindow.show();\n\t\t}\n\t}\n\n\tisFullScreen ()\n\t{\n\t\tif (\"webkitFullscreenElement\" in document)\n\t\t{\n\t\t\treturn (!!document.webkitFullscreenElement);\n\t\t}\n\t\telse if (\"fullscreenElement\" in document)\n\t\t{\n\t\t\treturn (!!document.fullscreenElement);\n\t\t}\n\t\treturn false;\n\t}\n\n\ttoggleFullScreen ()\n\t{\n\t\tif(this.isFullScreen())\n\t\t{\n\t\t\tthis.exitFullScreen();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.enterFullScreen();\n\t\t}\n\t}\n\n\tenterFullScreen ()\n\t{\n\t\tif (!this.callView)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst element = this.callView.elements.root;\n\n\t\ttry\n\t\t{\n\t\t\tconst requestFullscreen = element.requestFullscreen\n\t\t\t\t|| element.webkitRequestFullscreen\n\t\t\t\t|| element.mozRequestFullScreen\n\t\t\t\t|| element.msRequestFullscreen\n\t\t\t;\n\n\t\t\tif (requestFullscreen)\n\t\t\t{\n\t\t\t\trequestFullscreen.call(element).catch((error) => {\n\t\t\t\t\tconsole.error('Failed to enter fullscreen mode:', error);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconsole.warn('Fullscreen API is not supported in this browser');\n\t\t\t}\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error('Error attempting to enable fullscreen mode:', e);\n\t\t}\n\t}\n\n\texitFullScreen()\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst exitFullscreen = document.exitFullscreen\n\t\t\t\t|| document.mozCancelFullScreen\n\t\t\t\t|| document.webkitExitFullscreen\n\t\t\t\t|| document.msExitFullscreen\n\t\t\t\t|| document.cancelFullScreen\n\t\t\t;\n\n\t\t\tif (exitFullscreen)\n\t\t\t{\n\t\t\t\texitFullscreen.call(document).catch((error) => {\n\t\t\t\t\tconsole.error('Failed to exit fullscreen mode:', error);\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconsole.warn('Fullscreen API is not fully supported in this browser');\n\t\t\t}\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error('Error attempting to exit fullscreen mode:', e);\n\t\t}\n\t}\n\n\tonCallViewShowChatButtonClick()\n\t{\n\t\tAnalytics.getInstance().onShowChat({\n\t\t\tcallId: this.currentCall?.uuid,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t});\n\n\t\tthis.toggleChat();\n\t}\n\n\tonCallViewToggleUsersButtonClick()\n\t{\n\t\tthis.toggleUserList();\n\t}\n\n\t_onCallcontrolButtonClick(e)\n\t{\n\t\tif (!Util.canControlChangeSettings())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.participantsPermissionPopup)\n\t\t{\n\t\t\tthis.participantsPermissionPopup.close();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.participantsPermissionPopup = new ParticipantsPermissionPopup({\n\t\t\tturnOffAllParticipansStream: (options) => {\n\t\t\t\tthis._onCallViewTurnOffAllParticipansStreamButtonClick(options);\n\n\t\t\t\tAnalytics.getInstance().onTurnOffAllParticipansStream({\n\t\t\t\t\tcallId: this._getCallIdentifier(this.currentCall),\n\t\t\t\t\tcallType: this.getCallType(),\n\t\t\t\t\ttypeOfStream: options.data?.typeOfStream,\n\t\t\t\t});\n\t\t\t},\n\t\t\tonPermissionChanged: (options) => {\n\t\t\t\tthis.currentCall.changeSettings(options);\n\n\t\t\t\tif (!options.settingEnabled) // send only when it turned off\n\t\t\t\t{\n\t\t\t\t\tAnalytics.getInstance().onCallSettingsChanged({\n\t\t\t\t\t\tcallId: this._getCallIdentifier(this.currentCall),\n\t\t\t\t\t\tcallType: this.getCallType(),\n\t\t\t\t\t\ttypeOfSetting: options.typeOfSetting,\n\t\t\t\t\t\tsettingEnabled: options.settingEnabled,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tonClose: () => {\n\t\t\t\tthis.participantsPermissionPopup = null;\n\t\t\t\tthis._afterCloseParticipantsPermissionPopup();\n\t\t\t},\n\t\t\tonOpen: () => {\n\t\t\t\tthis._afterOpenParticipantsPermissionPopup();\n\n\t\t\t\tAnalytics.getInstance().onOpenCallSettings({\n\t\t\t\t\tcallId: this._getCallIdentifier(this.currentCall),\n\t\t\t\t\tcallType: this.getCallType(),\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\n\t\tif (this.participantsPermissionPopup)\n\t\t{\n\t\t\tthis.participantsPermissionPopup.toggle();\n\t\t}\n\t}\n\n\tonCallViewFeedbackButtonClick()\n\t{\n\t\tBX.loadExt('ui.feedback.form').then(() => {\n\t\t\tBX.UI.Feedback.Form.open({\n\t\t\t\tid: `call_feedback_${this.currentCall.uuid}-${this.currentCall.instanceId}-${Math.random()}`,\n\t\t\t\tforms: [\n\t\t\t\t\t{ zones: ['ru', 'by', 'kz'], id: 406, sec: '9lhjhn', lang: 'ru' },\n\t\t\t\t\t{ zones: ['de'], id: 754, sec: '6upe49', lang: 'de' },\n\t\t\t\t\t{ zones: ['es'], id: 750, sec: 'whk4la', lang: 'es' },\n\t\t\t\t\t{ zones: ['com.br'], id: 752, sec: 'is01cs', lang: 'com.br' },\n\t\t\t\t\t{ zones: ['en'], id: 748, sec: 'pds0h6', lang: 'en' },\n\t\t\t\t],\n\t\t\t\tpresets: {\n\t\t\t\t\tsender_page: 'call',\n\t\t\t\t\tcall_type: this.currentCall.provider,\n\t\t\t\t\tcall_amount: this.currentCall.users.length + 1,\n\t\t\t\t\tcall_id: `id: ${this.currentCall.uuid}, instanceId: ${this.currentCall.instanceId}`,\n\t\t\t\t\tid_of_user: this.currentCall.userId,\n\t\t\t\t\tfrom_domain: location.origin\n\t\t\t\t},\n\t\t\t});\n\t\t})\n\t}\n\n\tonCallUserClick(e)\n\t{\n\t\tAnalytics.getInstance().onClickUser({\n\t\t\tcallId: this.currentCall.uuid,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\tlayout: Object.keys(Call.View.Layout).find(key => Call.View.Layout[key] === e.layout),\n\t\t});\n\t}\n\n\tonCallCopilotButtonClick()\n\t{\n\t\tthis.onChangeStateCopilot();\n\n\t\t// todo: code below supports only legacy provider;\n\t\t// to support the new provider, logic from the common call controller must be added\n\t\t/* if (!Util.isAIServiceEnabled())\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(CallAI.serviceEnabled, {\n\t\t\t\tcacheable: false\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tthis.copilotPopup = new Call.CopilotPopup({\n\t\t\tisCopilotActive: this.currentCall.isCopilotActive,\n\t\t\tisCopilotFeaturesEnabled: this.currentCall.isCopilotFeaturesEnabled,\n\t\t\tupdateCopilotState: () => {\n\t\t\t\tthis.onChangeStateCopilot();\n\t\t\t},\n\t\t\tonClose: () => {\n\t\t\t\tthis.copilotPopup = null;\n\t\t\t}\n\t\t});\n\n\t\tif (this.copilotPopup)\n\t\t{\n\t\t\tthis.copilotPopup.toggle();\n\t\t} */\n\t}\n\n\tonUpdateCallCopilotState({ isTrackRecordOn })\n\t{\n\t\tconst updateCopilotActive = this.currentCall.scheme\n\t\t\t? this.currentCall.scheme === Call.CallScheme.classic\n\t\t\t: !CallSettingsManager.jwtCallsEnabled;\n\n\t\tif (updateCopilotActive)\n\t\t{\n\t\t\tthis.currentCall.isCopilotActive = isTrackRecordOn;\n\t\t}\n\t\tthis.callView.updateCopilotState(this.currentCall.isCopilotActive);\n\t}\n\n\t_onBlockCameraButton()\n\t{\n\t\tif (!this.callView)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callView.blockSwitchCamera();\n\t}\n\n\t_onUnblockCameraButton()\n\t{\n\t\tif (!this.callView) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callView.unblockSwitchCamera();\n\t}\n\n\t_onBlockMicrophoneButton()\n\t{\n\t\tif (!this.callView) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callView.blockSwitchMicrophone();\n\t}\n\n\t_onUnblockMicrophoneButton()\n\t{\n\t\tif (!this.callView) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callView.unblockSwitchMicrophone();\n\t}\n\n\tonCameraPublishing(e)\n\t{\n\t\tif (e.publishing)\n\t\t{\n\t\t\tthis.onBlockCameraButton();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.onUnblockCameraButton();\n\t\t}\n\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.updateButtons();\n\t\t}\n\t}\n\n\tonMicrophonePublishingd(e)\n\t{\n\t\tif (!this.callView)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.publishing)\n\t\t{\n\t\t\tthis.onBlockMicrophoneButton();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.onUnblockMicrophoneButton();\n\t\t}\n\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.updateButtons();\n\t\t}\n\t}\n\n\tonChangeStateCopilot()\n\t{\n\t\tconst action = !this.currentCall.isCopilotActive ? 'call.Track.start' : 'call.Track.stop';\n\t\tBX.ajax.runAction(action, {\n\t\t\tdata: { callId: this.currentCall.id }\n\t\t}).then(() => {\n\t\t\tthis.onUpdateCallCopilotState({\n\t\t\t\tisTrackRecordOn: !this.currentCall.isCopilotActive,\n\t\t\t});\n\t\t});\n\t}\n\n\tonCallViewFloorRequestButtonClick()\n\t{\n\t\tAnalytics.getInstance().onFloorRequest({\n\t\t\tcallId: this.currentCall.uuid,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t});\n\n\t\tconst floorState = this.callView.getUserFloorRequestState(this.callEngine.getCurrentUserId());\n\t\tconst talkingState = this.callView.getUserTalking(this.callEngine.getCurrentUserId());\n\n\t\tthis.callView.setUserFloorRequestState(this.callEngine.getCurrentUserId(), !floorState);\n\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.currentCall.requestFloor(!floorState);\n\t\t}\n\n\t\tclearTimeout(this.callViewFloorRequestTimeout);\n\t\tif (talkingState && !floorState)\n\t\t{\n\t\t\tthis.callViewFloorRequestTimeout = setTimeout(() =>\n\t\t\t{\n\t\t\t\tif (this.currentCall)\n\t\t\t\t{\n\t\t\t\t\tthis.currentCall.requestFloor(false);\n\t\t\t\t}\n\t\t\t}, 1500);\n\t\t}\n\n\t\tif (this.riseYouHandToTalkPopup && !floorState)\n\t\t{\n\t\t\tthis.riseYouHandToTalkPopup.close();\n\t\t\tthis.riseYouHandToTalkPopup = null;\n\t\t}\n\t}\n\n\t_onCallViewTurnOffAllParticipansStreamButtonClick(options)\n\t{\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.currentCall.turnOffAllParticipansStream(options);\n\t\t}\n\t}\n\n\tbindCallEvents()\n\t{\n\t\tthis.currentCall.addEventListener(Call.Event.onUserInvited, this.onCallUserInvitedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserJoined, this.onCallUserJoinedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onDestroy, this.onCallDestroyHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserStateChanged, this.onCallUserStateChangedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserMicrophoneState, this.onCallUserMicrophoneStateHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserCameraState, this.onCallUserCameraStateHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onNeedResetMediaDevicesState, this.onNeedResetMediaDevicesStateHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserVideoPaused, this.onCallUserVideoPausedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onLocalMediaReceived, this.onCallLocalMediaReceivedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onLocalMediaStopped, this.onCallLocalMediaStoppedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onRemoteMediaReceived, this.onCallRemoteMediaReceivedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onRemoteMediaStopped, this.onCallRemoteMediaStoppedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserVoiceStarted, this.onCallUserVoiceStartedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserVoiceStopped, this.onCallUserVoiceStoppedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserStatsReceived, this.onUserStatsReceivedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserScreenState, this.onCallUserScreenStateHandler);\n\t\tEvent.bind(this.currentCall, Call.Event.onUserCommonRecordState, this.#onCallUserCommonRecordStateHandler);\n\t\tEvent.bind(this.currentCall, Call.Event.onCloudRecordStatusChanged, this.#onCloudRecordStatusChangedHandler)\n\t\tthis.currentCall.addEventListener(Call.Event.onUserFloorRequest, this.onCallUserFloorRequestHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onMicrophoneLevel, this.onMicrophoneLevelHandler);\n\t\t//this.currentCall.addEventListener(Call.Event.onDeviceListUpdated, this._onCallDeviceListUpdatedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onCallFailure, this.onCallFailureHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onJoin, this._onCallJoinHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onLeave, this.onCallLeaveHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onReconnecting, this.onReconnectingHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onReconnected, this.onReconnectedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onReconnectingFailed, this.onReconnectingFailedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUpdateLastUsedCameraId, this.onUpdateLastUsedCameraIdHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onConnectionQualityChanged, this.onCallConnectionQualityChangedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onToggleRemoteParticipantVideo, this.onCallToggleRemoteParticipantVideoHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onGetUserMediaEnded, this._onGetUserMediaEndedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onSwitchTrackRecordStatus, this._onSwitchTrackRecordStatusHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onCameraPublishing, this.onCameraPublishingHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onMicrophonePublishing, this.onMicrophonePublishingdHandler);\n\n\t\tthis.currentCall.addEventListener(Call.Event.onTurnOnCamera, this._onTurnOnCameraHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onAllParticipantsAudioMuted, this._onAllParticipantsAudioMutedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onAllParticipantsVideoMuted, this._onAllParticipantsVideoMutedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onAllParticipantsScreenshareMuted, this._onAllParticipantsScreenshareHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onRoomSettingsChanged, this._onRoomSettingsChangedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserPermissionsChanged, this._onUserPermissionsChangedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserRoleChanged, this._onUserRoleChangedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onYouMuteAllParticipants, this._onYouMuteAllParticipantsHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onParticipantMuted, this._onParticipantMutedHandler);\n\t}\n\n\tremoveCallEvents()\n\t{\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserInvited, this.onCallUserInvitedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserJoined, this.onCallUserJoinedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onDestroy, this.onCallDestroyHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserStateChanged, this.onCallUserStateChangedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserMicrophoneState, this.onCallUserMicrophoneStateHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserCameraState, this.onCallUserCameraStateHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onNeedResetMediaDevicesState, this.onNeedResetMediaDevicesStateHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserVideoPaused, this.onCallUserVideoPausedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onLocalMediaReceived, this.onCallLocalMediaReceivedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onRemoteMediaReceived, this.onCallRemoteMediaReceivedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onRemoteMediaStopped, this.onCallRemoteMediaStoppedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserVoiceStarted, this.onCallUserVoiceStartedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserVoiceStopped, this.onCallUserVoiceStoppedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserStatsReceived, this.onUserStatsReceivedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserScreenState, this.onCallUserScreenStateHandler);\n\t\tEvent.unbind(this.currentCall, Call.Event.onUserCommonRecordState, this.#onCallUserCommonRecordStateHandler);\n\t\tEvent.unbind(this.currentCall, Call.Event.onCloudRecordStatusChanged, this.#onCloudRecordStatusChangedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserFloorRequest, this.onCallUserFloorRequestHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onMicrophoneLevel, this.onMicrophoneLevelHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onConnectionQualityChanged, this.onCallConnectionQualityChangedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onToggleRemoteParticipantVideo, this.onCallToggleRemoteParticipantVideoHandler);\n\t\t//this.currentCall.removeEventListener(Call.Event.onDeviceListUpdated, this._onCallDeviceListUpdatedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onCallFailure, this.onCallFailureHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onLeave, this.onCallLeaveHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onReconnecting, this.onReconnectingHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onReconnected, this.onReconnectedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onReconnectingFailed, this.onReconnectingFailedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUpdateLastUsedCameraId, this.onUpdateLastUsedCameraIdHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onGetUserMediaEnded, this._onGetUserMediaEndedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onSwitchTrackRecordStatus, this._onSwitchTrackRecordStatusHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onCameraPublishing, this.onCameraPublishingHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onMicrophonePublishing, this.onMicrophonePublishingdHandler);\n\t\t\n\t\tthis.currentCall.removeEventListener(Call.Event.onTurnOnCamera, this._onTurnOnCameraHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onAllParticipantsAudioMuted, this._onAllParticipantsAudioMutedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onAllParticipantsVideoMuted, this._onAllParticipantsVideoMutedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onAllParticipantsScreenshareMuted, this._onAllParticipantsScreenshareHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onRoomSettingsChanged, this._onRoomSettingsChangedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserPermissionsChanged, this._onUserPermissionsChangedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserRoleChanged, this._onUserRoleChangedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onYouMuteAllParticipants, this._onYouMuteAllParticipantsHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onParticipantMuted, this._onParticipantMutedHandler);\n\t}\n\n\tremoveAdditionalEvents()\n\t{\n\t\twindow.removeEventListener('focus', () => {\n\t\t\tthis.onWindowFocus();\n\t\t});\n\n\t\twindow.removeEventListener('blur', () => {\n\t\t\tthis.onWindowBlur();\n\t\t});\n\n\t\tdocument.body.removeEventListener('click',(evt) =>\n\t\t{\n\t\t\tthis.onDocumentBodyClick(evt);\n\t\t});\n\t}\n\n\tonCallUserInvited(e)\n\t{\n\t\tthis.callView.addUser(e.userId);\n\n\t\tUtil.getUsers(this.currentCall.id, [e.userId]).then(userData => {\n\t\t\tthis.controller.getStore().dispatch('users/set', Object.values(userData));\n\t\t\tthis.controller.getStore().dispatch('conference/setUsers', {users: Object.keys(userData)});\n\t\t\tthis.callView.updateUserData(userData)\n\t\t});\n\t}\n\n\tonCallUserJoined(e)\n\t{\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.updateUserData(e.userData);\n\t\t\tthis.callView.addUser(e.userId, Call.UserState.Connected);\n\t\t}\n\t}\n\n\tonCallUserStateChanged(e)\n\t{\n\t\tif (e.state !== Call.UserState.Connected && this.loopTimers[e.userId] === undefined)\n\t\t{\n\t\t\tthis.loopConnectionQuality(e.userId, 1);\n\t\t}\n\n\t\tif (e.state === Call.UserState.Connected)\n\t\t{\n\t\t\tthis.clearConnectionQualityTimer(e.userId);\n\t\t\tthis.callView.setUserConnectionQuality(e.userId, 5);\n\n\t\t\tif (false && CallAI.serviceEnabled)\n\t\t\t{\n\t\t\t\tthis.callView.unblockButtons(['copilot']);\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\te.state === Call.UserState.Ready\n\t\t\t&& e.previousState === Call.UserState.Connected\n\t\t\t&& !Object.keys(this.currentCall).includes(e.userId)\n\t\t)\n\t\t{\n\t\t\te.state = Call.UserState.Idle;\n\t\t}\n\n\t\tif (e.state === Call.UserState.Idle && e.previousState === Call.UserState.Connected)\n\t\t{\n\t\t\tif (!this.#canCloudRecord() && e.userId === this.commonRecord.initiatorId)\n\t\t\t{\n\t\t\t\tthis.#stopCommonRecord();\n\t\t\t}\n\t\t}\n\n\t\tthis.callView.setUserState(e.userId, e.state);\n\t\tthis.updateCallUser(e.userId,{state: e.state});\n\n\t\tif (!this.#isCommonRecordStarted())\n\t\t{\n\t\t\tthis.callView.unblockButtons(['record']);\n\t\t}\n\t\t/*if (e.direction)\n\t\t{\n\t\t\tthis.callView.setUserDirection(e.userId, e.direction);\n\t\t}*/\n\t}\n\n\tonCallUserMicrophoneState(e)\n\t{\n\t\tif (e.userId == this.currentCall.userId)\n\t\t{\n\t\t\tCall.Hardware.isMicrophoneMuted = !e.microphoneState;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.callView.setUserMicrophoneState(e.userId, e.microphoneState);\n\t\t\tthis.updateCallUser(e.userId, {microphoneState: e.microphoneState});\n\t\t}\n\t}\n\n\tonCallUserCameraState(e)\n\t{\n\t\tthis.callView.setUserCameraState(e.userId, e.cameraState);\n\t\tthis.updateCallUser(e.userId, {cameraState: e.cameraState});\n\t}\n\n\tonNeedResetMediaDevicesState(e)\n\t{\n\t\tCall.Hardware.isMicrophoneMuted = true;\n\t\tCall.Hardware.isCameraOn = false;\n\t}\n\n\tonCallUserVideoPaused(e)\n\t{\n\t\tthis.callView.setUserVideoPaused(e.userId, e.videoPaused);\n\t}\n\n\tonCallLocalMediaReceived(e)\n\t{\n\t\tconsole.log(\"Received local media stream \" + e);\n\t\tif (this.callView)\n\t\t{\n\t\t\tconst flipVideo = (e.tag == \"main\" || e.mediaRenderer) ? Call.Hardware.enableMirroring : false;\n\n\t\t\tthis.callView.setLocalStream(e);\n\t\t\tthis.callView.flipLocalVideo(flipVideo);\n\n\t\t\tthis.callView.setButtonActive(\"screen\", this.currentCall.isScreenSharingStarted());\n\t\t\tif (this.currentCall.isScreenSharingStarted())\n\t\t\t{\n\t\t\t\tthis.screenShareStartTime = new Date();\n\t\t\t\tAnalytics.getInstance().onScreenShareStarted({\n\t\t\t\t\tcallId: this.currentCall.uuid,\n\t\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\t});\n\n\t\t\t\tthis.togglePictureInPictureCallWindow();\n\n\t\t\t\tif (!DesktopApi.isDesktop())\n\t\t\t\t{\n\t\t\t\t\tthis.showWebScreenSharePopup();\n\t\t\t\t}\n\n\t\t\t\tthis.callView.updateButtons();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tAnalytics.getInstance().onScreenShareStopped({\n\t\t\t\t\tcallId: this.currentCall.uuid,\n\t\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\t\tstatus: Analytics.AnalyticsStatus.success,\n\t\t\t\t\tscreenShareLength: Util.getTimeText(this.screenShareStartTime),\n\t\t\t\t});\n\t\t\t\tthis.screenShareStartTime = null;\n\n\t\t\t\tthis.togglePictureInPictureCallWindow();\n\n\t\t\t\tif (this.floatingScreenShareWindow)\n\t\t\t\t{\n\t\t\t\t\tthis.floatingScreenShareWindow.close();\n\t\t\t\t}\n\n\t\t\t\tif (this.webScreenSharePopup)\n\t\t\t\t{\n\t\t\t\t\tthis.webScreenSharePopup.close();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!this.currentCall.callFromMobile && !this.isViewerMode())\n\t\t\t{\n\t\t\t\tthis.checkAvailableCamera();\n\t\t\t\tthis.checkAvailableMicrophone();\n\t\t\t}\n\t\t}\n\n\t\tif (this.currentCall && Call.Hardware.isCameraOn && e.tag === 'main' && e.stream.getVideoTracks().length === 0)\n\t\t{\n\t\t\tCall.Hardware.isCameraOn = false;\n\t\t}\n\t}\n\n\tonCallLocalMediaStopped(e)\n\t{\n\t\tif (this.callView && e.kind === 'audio')\n\t\t{\n\t\t\tCall.Hardware.isMicrophoneMuted = true;\n\t\t\tthis.showNotification(Loc.getMessage('CALL_ERROR_MICROPHONE_STREAM_STOPPED'));\n\t\t}\n\t}\n\n\tonCallRemoteMediaReceived(e)\n\t{\n\t\tconst getStreamType = (stream) =>\n\t\t{\n\t\t\tif (stream?.getVideoTracks()?.length)\n\t\t\t{\n\t\t\t\treturn 'video';\n\t\t\t}\n\n\t\t\tif (stream?.getAudioTracks()?.length)\n\t\t\t{\n\t\t\t\treturn 'audio';\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.callView)\n\t\t{\n\t\t\tif ('track' in e)\n\t\t\t{\n\t\t\t\tthis.callView.setUserMedia(e.userId, e.kind, e.track)\n\t\t\t}\n\t\t\tif ('mediaRenderer' in e && e.mediaRenderer.kind === 'audio' && getStreamType(e.mediaRenderer.stream) === 'audio')\n\t\t\t{\n\t\t\t\tthis.callView.setUserMedia(e.userId, 'audio', e.mediaRenderer.stream.getAudioTracks()[0]);\n\t\t\t}\n\t\t\tif ('mediaRenderer' in e && e.mediaRenderer.kind === 'sharing' && getStreamType(e.mediaRenderer.stream) === 'audio')\n\t\t\t{\n\t\t\t\tthis.callView.setUserMedia(e.userId, 'sharingAudio', e.mediaRenderer.stream.getAudioTracks()[0]);\n\t\t\t}\n\t\t\tif ('mediaRenderer' in e && (e.mediaRenderer.kind === 'video' || e.mediaRenderer.kind === 'sharing') && getStreamType(e.mediaRenderer.stream) === 'video')\n\t\t\t{\n\t\t\t\tthis.callView.setVideoRenderer(e.userId, e.mediaRenderer);\n\t\t\t}\n\t\t}\n\t}\n\n\tonCallRemoteMediaStopped(e)\n\t{\n\t\tif (this.callView)\n\t\t{\n\t\t\tif ('mediaRenderer' in e)\n\t\t\t{\n\t\t\t\tif (e.kind === 'video' || e.kind === 'sharing')\n\t\t\t\t{\n\t\t\t\t\te.mediaRenderer.stream = null;\n\t\t\t\t\tthis.callView.setVideoRenderer(e.userId, e.mediaRenderer);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.callView.setUserMedia(e.userId, e.kind, null);\n\t\t\t}\n\t\t}\n\t}\n\n\tisLegacyCall(provider, scheme = null): boolean\n\t{\n\t\tif (scheme)\n\t\t{\n\t\t\treturn scheme === Call.CallScheme.classic;\n\t\t}\n\n\t\tconst isLegacyPlainCall = provider === Call.Provider.Plain && !CallSettingsManager.isJwtInPlainCallsEnabled();\n\t\tconst isLegacyBitrixCall = provider === Call.Provider.Bitrix && !CallSettingsManager.jwtCallsEnabled;\n\n\t\treturn isLegacyPlainCall || isLegacyBitrixCall;\n\t}\n\n\t_getCallIdentifier(call)\n\t{\n\t\tif (!call)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.isLegacyCall(call.provider, call.scheme) ? call.id : call.uuid;\n\t}\n\n\tgetCallType()\n\t{\n\t\treturn Analytics.AnalyticsType.videoconf;\n\t}\n\n\tloopConnectionQuality(userId, quality, timeout = 200)\n\t{\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.loopTimers[userId] = setTimeout(() => {\n\t\t\t\tthis.callView.setUserConnectionQuality(userId, quality);\n\t\t\t\tconst newQuality = quality >= 4 ? 1 : quality + 1;\n\t\t\t\tthis.loopConnectionQuality(userId, newQuality, timeout);\n\t\t\t}, timeout);\n\t\t}\n\t}\n\n\tclearConnectionQualityTimer(userId)\n\t{\n\t\tif (this.loopTimers[userId] !== undefined)\n\t\t{\n\t\t\tclearTimeout(this.loopTimers[userId]);\n\t\t\tdelete this.loopTimers[userId];\n\t\t}\n\t}\n\n\tonCallConnectionQualityChanged(e)\n\t{\n\t\tthis.clearConnectionQualityTimer(e.userId);\n\n\t\tthis.callView.setUserConnectionQuality(e.userId, e.score);\n\t}\n\n\tonGetUserMediaEnded()\n\t{\n\t\tthis.updateMediaDevices();\n\t}\n\n\tonCallToggleRemoteParticipantVideo(e)\n\t{\n\t\tif (this.toogleParticipantsVideoBaloon)\n\t\t{\n\t\t\tif (e.isVideoShown)\n\t\t\t{\n\t\t\t\tthis.toogleParticipantsVideoBaloon.close();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!e.isVideoShown)\n\t\t{\n\t\t\tthis.toogleParticipantsVideoBaloon = BX.UI.Notification.Center.notify({\n\t\t\t\tcontent: Text.encode(BX.message('IM_M_CALL_REMOTE_PARTICIPANTS_VIDEO_MUTED')),\n\t\t\t\tautoHide: false,\n\t\t\t\tposition: \"top-right\",\n\t\t\t\tcloseButton: false,\n\t\t\t})\n\t\t}\n\t}\n\n\tonCallUserVoiceStarted(e)\n\t{\n\t\tif (e.local)\n\t\t{\n\t\t\tif (this.currentCall.muted && this.allowMutePopup)\n\t\t\t{\n\t\t\t\tthis.showMicMutedNotification();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callView.setUserTalking(e.userId, true);\n\n\t\tif (e.userId == this.callView.localUser.id)\n\t\t{\n\t\t\tthis.callView.setUserFloorRequestState(e.userId, false);\n\t\t}\n\n\t\tthis.updateCallUser(e.userId, {talking: true, floorRequestState: false});\n\t}\n\n\tonCallUserVoiceStopped(e)\n\t{\n\t\tthis.callView.setUserTalking(e.userId, false);\n\t\tthis.updateCallUser(e.userId, {talking: false});\n\t}\n\n\t_onBlockUnblockCamMicButtons()\n\t{\n\t\tif (Util.havePermissionToBroadcast('cam'))\n\t\t{\n\t\t\tthis._onUnblockCameraButton();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._onBlockCameraButton();\n\t\t}\n\n\t\tif (Util.havePermissionToBroadcast('mic'))\n\t\t{\n\t\t\tthis._onUnblockMicrophoneButton();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis._onBlockMicrophoneButton();\n\t\t}\n\t}\n\n\t_onTurnOnCamera(e)\n\t{\n\t\tthis._onCallViewToggleVideoButtonClickHandler({video: true, calledProgrammatically: true});\n\t}\n\n\t_onAllParticipantsAudioMuted(e)\n\t{\n\t\tconst userModel = this.callView.userRegistry.get(e.userId);\n\n\t\tlet content = '<div class = \"bx-call-view-participants-control-stream-notify-icon bx-call-view-mic-muted\"></div>'\n\t\t\t+ (Text.encode(Util.getCustomMessage(\"CALL_USER_TURNED_OFF_MIC_FOR_ALL_MSGVER_1\", {\n\t\t\t\tgender: (userModel.data.gender? userModel.data.gender.toUpperCase() : 'M'),\n\t\t\t\tname: userModel.data.name\n\t\t\t})));\n\n\t\tif (content && (!e.reason || e.reason !== 'settings'))\n\t\t{\n\t\t\tthis.createCallControlNotify({content: content, isAllow: false});\n\t\t}\n\n\t\tif (Util.isRegularUser(Util.getCurrentUserRole()))\n\t\t{\n\t\t\tthis._onCallViewToggleMuteHandler({muted: true, calledProgrammatically: true});\n\t\t}\n\t}\n\n\t_onAllParticipantsVideoMuted(e)\n\t{\n\n\t\tconst userModel = this.callView.userRegistry.get(e.userId);\n\n\t\tlet content = '<div class = \"bx-call-view-participants-control-stream-notify-icon bx-call-view-cam-muted\"></div>'\n\t\t\t+ (Text.encode(Util.getCustomMessage(\"CALL_USER_TURNED_OFF_CAM_FOR_ALL_MSGVER_1\", {\n\t\t\t\tgender: (userModel.data.gender? userModel.data.gender.toUpperCase() : 'M'),\n\t\t\t\tname: userModel.data.name\n\t\t\t})));\n\n\t\tif (content && (!e.reason || e.reason !== 'settings'))\n\t\t{\n\t\t\tthis.createCallControlNotify({content: content, isAllow: false});\n\t\t}\n\n\t\tif (Util.isRegularUser(Util.getCurrentUserRole()))\n\t\t{\n\t\t\tthis._onCallViewToggleVideoButtonClickHandler({video: false, calledProgrammatically: true});\n\t\t}\n\t}\n\n\t_onAllParticipantsScreenshareMuted(e)\n\t{\n\t\tconst userModel = this.callView.userRegistry.get(e.userId);\n\n\t\tlet content = '<div class = \"bx-call-view-participants-control-stream-notify-icon bx-call-view-cam-muted\"></div>'\n\t\t\t+ (Text.encode(Util.getCustomMessage(\"CALL_USER_TURNED_OFF_SCREENSHARE_FOR_ALL_MSGVER_1\", {\n\t\t\t\tgender: (userModel.data.gender? userModel.data.gender.toUpperCase() : 'M'),\n\t\t\t\tname: userModel.data.name\n\t\t\t})));\n\n\t\tif (content && (!e.reason || e.reason !== 'settings'))\n\t\t{\n\t\t\tthis.createCallControlNotify({content: content, isAllow: false});\n\t\t}\n\n\t\tif (this.currentCall.isScreenSharingStarted() && Util.isRegularUser(Util.getCurrentUserRole()))\n\t\t{\n\t\t\tthis.onCallViewToggleScreenSharingButtonClick();\n\t\t}\n\t}\n\n\t_onParticipantMuted(e)\n\t{\n\t\tif (e.data?.track.muted) // tbh always should be in \"true\"..\n\t\t{\n\t\t\tlet contentIcon = 'mic';\n\t\t\tlet contentPhrase = '';\n\t\t\tconst initiatorUserModel = this.callView.userRegistry.get(e.data.fromUserId);\n\t\t\tconst targetUserModel = this.callView.userRegistry.get(e.data.toUserId);\n\t\t\tconst initiatorGender = (initiatorUserModel.data.gender ? initiatorUserModel.data.gender.toUpperCase() : 'M');\n\n\t\t\tif (e.data.toUserId == this.callEngine.getCurrentUserId())\n\t\t\t{\n\t\t\t\tif (e.data.track.type === 0)\n\t\t\t\t{\n\t\t\t\t\tcontentPhrase = 'CALL_CONTROL_MODERATOR_TURNED_OFF_YOUR_MIC_MSGVER_1' + '_' + initiatorGender;\n\t\t\t\t\tthis._onCallViewToggleMuteHandler({muted: true, calledProgrammatically: true});\n\t\t\t\t}\n\t\t\t\telse if (e.data.track.type === 1)\n\t\t\t\t{\n\t\t\t\t\tcontentIcon = 'cam';\n\t\t\t\t\tcontentPhrase = 'CALL_CONTROL_MODERATOR_TURNED_OFF_YOUR_CAM_MSGVER_1' + '_' + initiatorGender;\n\t\t\t\t\tthis._onCallViewToggleVideoButtonClickHandler({video: false, calledProgrammatically: true});\n\t\t\t\t}\n\t\t\t\telse if (e.data.track.type === 2)\n\t\t\t\t{\n\t\t\t\t\tcontentIcon = 'screenshare';\n\t\t\t\t\tcontentPhrase = 'CALL_CONTROL_MODERATOR_TURNED_OFF_YOUR_SCREENSHARE' + '_' + initiatorGender;\n\t\t\t\t\tif (this.currentCall.isScreenSharingStarted())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.onCallViewToggleScreenSharingButtonClick();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (e.data.fromUserId == this.callEngine.getCurrentUserId())\n\t\t\t\t{\n\t\t\t\t\tif (e.data.track.type === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentPhrase = 'CALL_CONTROL_YOU_TURNED_OFF_USER_MIC';\n\t\t\t\t\t}\n\t\t\t\t\telse if (e.data.track.type === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentIcon = 'cam';\n\t\t\t\t\t\tcontentPhrase = 'CALL_CONTROL_YOU_TURNED_OFF_USER_CAM';\n\t\t\t\t\t}\n\t\t\t\t\telse if (e.data.track.type === 2)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentIcon = 'screenshare';\n\t\t\t\t\t\tcontentPhrase = 'CALL_CONTROL_YOU_TURNED_OFF_USER_SCREENSHARE';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (e.data.track.type === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentPhrase = 'CALL_CONTROL_MODERATOR_TURNED_OFF_USER_MIC_MSGVER_1' + '_' + initiatorGender;\n\t\t\t\t\t}\n\t\t\t\t\telse if (e.data.track.type === 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentIcon = 'cam';\n\t\t\t\t\t\tcontentPhrase = 'CALL_CONTROL_MODERATOR_TURNED_OFF_USER_CAM_MSGVER_1' + '_' + initiatorGender;\n\t\t\t\t\t}\n\t\t\t\t\telse if (e.data.track.type === 2)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontentIcon = 'screenshare';\n\t\t\t\t\t\tcontentPhrase = 'CALL_CONTROL_MODERATOR_TURNED_OFF_USER_SCREENSHARE' + '_' + initiatorGender;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet content =\n\t\t\t\t'<div class = \"bx-call-view-participants-control-stream-notify-icon bx-call-view-'+contentIcon+'-muted\"></div>'\n\t\t\t\t+ (Text.encode(Util.getCustomMessage(contentPhrase, {\n\t\t\t\t\tgender: initiatorGender,\n\t\t\t\t\tinitiator_name: initiatorUserModel.data.name,\n\t\t\t\t\ttarget_name: targetUserModel.data.name,\n\t\t\t\t})));\n\n\t\t\tthis.createCallControlNotify({content: content, isAllow: false});\n\t\t}\n\t}\n\n\t_onYouMuteAllParticipants(e)\n\t{\n\t\tlet typesOfMute = {0: 'mic', 1: 'cam', 2: 'screenshare'};\n\t\tlet typesOfMuteMessage = {0: 'CALL_YOU_TURNED_OFF_MIC_FOR_ALL_MSGVER_1', 1: 'CALL_YOU_TURNED_OFF_CAM_FOR_ALL_MSGVER_1', 2: 'CALL_YOU_TURNED_OFF_SCREENSHARE_FOR_ALL_MSGVER_1'};\n\n\t\tlet content = '<div class = \"bx-call-view-participants-control-stream-notify-icon bx-call-view-'+(typesOfMute[e.data.track.type])+'-muted\"></div>'\n\t\t\t+ (BX.message[(typesOfMuteMessage[e.data.track.type])]);\n\n\t\tthis.createCallControlNotify({content: content, isAllow: false});\n\t}\n\n\t_onUserPermissionsChanged(e)\n\t{\n\t\tconst initiatorUserModel = this.callView.userRegistry.get(e.data.fromUserId);\n\t\tconst initiatorGender = (initiatorUserModel.data.gender ? initiatorUserModel.data.gender.toUpperCase() : 'M');\n\n\t\tlet contentPhrase = 'CALL_ADMIN_ALLOWED_TURN_ON_ALL_FOR_YOU_BY_HANDRAISE_' + initiatorGender;\n\n\t\tif (!e.data.allow)\n\t\t{\n\t\t\tcontentPhrase = 'CALL_ADMIN_NOT_ALLOWED_TURN_ON_ALL_FOR_YOU_BY_HANDRAISE_' + initiatorGender;\n\t\t\tconst floorState = this.callView.getUserFloorRequestState(this.callEngine.getCurrentUserId());\n\n\t\t\tif (floorState)\n\t\t\t{\n\t\t\t\tthis.onCallViewFloorRequestButtonClick();\n\t\t\t}\n\t\t}\n\n\t\tconst content = Text.encode(Util.getCustomMessage(contentPhrase, {\n\t\t\tgender: initiatorGender,\n\t\t\tinitiator_name: initiatorUserModel.data.name,\n\t\t}));\n\n\t\tif (content)\n\t\t{\n\t\t\tthis.createCallControlNotify({content: content, isAllow: e.data.allow});\n\t\t}\n\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.setUserPermissionToSpeakState(e.data.toUserId, e.data.allow);\n\t\t}\n\n\t\tthis.callView.updateButtons();\n\t\tthis._onBlockUnblockCamMicButtons();\n\t}\n\n\t_onUserRoleChanged(e)\n\t{\n\t\tif (e.data.toUserId == this.callEngine.getCurrentUserId())\n\t\t{\n\t\t\tconst content = BX.message('CALL_YOU_HAVE_BEEN_APPOINTED_AS_ADMIN');\n\n\t\t\tif (content)\n\t\t\t{\n\t\t\t\tthis.promotedToAdminTimeout = setTimeout(\n\t\t\t\t\t() => this.createCallControlNotify({content: content, isAllow: true}),\n\t\t\t\t\tthis.promotedToAdminTimeoutValue\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (this.riseYouHandToTalkPopup)\n\t\t\t{\n\t\t\t\tthis.riseYouHandToTalkPopup.close();\n\t\t\t\tthis.riseYouHandToTalkPopup = null;\n\t\t\t}\n\n\t\t\tif (this.callView)\n\t\t\t{\n\t\t\t\tthis.callView.updateButtons();\n\t\t\t\tthis.callView.updateFloorRequestNotification();\n\t\t\t}\n\n\t\t\tthis._onBlockUnblockCamMicButtons();\n\t\t}\n\t}\n\n\t_onRoomSettingsChanged(e)\n\t{\n\t\tlet typesOfMute = {'audio': 'mic', 'video': 'cam', 'screen_share': 'screenshare'};\n\n\t\tlet content = '';\n\t\tlet isAllow = false;\n\n\t\tconst initiatorUserModel = this.callView.userRegistry.get(e.data.fromUserId);\n\t\tconst initiatorGender = (initiatorUserModel.data.gender ? initiatorUserModel.data.gender.toUpperCase() : 'M');\n\n\t\tif (e.data.eft === true)\n\t\t{\n\t\t\tif (e.data.fromUserId == this.currentCall.userId)\n\t\t\t{\n\t\t\t\tconst typesOfMuteMessage =\n\t\t\t\t\t{\n\t\t\t\t\t\t'audio': 'CALL_YOU_PROHIBITED_MIC_FOR_ALL_BY_SETTINGS',\n\t\t\t\t\t\t'video': 'CALL_YOU_PROHIBITED_CAM_FOR_ALL_BY_SETTINGS',\n\t\t\t\t\t\t'screen_share': 'CALL_YOU_PROHIBITED_SCREENSHARE_FOR_ALL_BY_SETTINGS',\n\t\t\t\t\t};\n\n\t\t\t\tcontent = '<div class = \"bx-call-view-participants-control-stream-notify-icon bx-call-view-'+(typesOfMute[e.data.act])+'-muted\"></div>'\n\t\t\t\t\t+ (BX.message[(typesOfMuteMessage[e.data.act])]);\n\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst typesOfMuteMessage =\n\t\t\t\t\t{\n\t\t\t\t\t\t'audio': 'CALL_ADMIN_PROHIBITED_MIC_FOR_ALL_BY_SETTINGS',\n\t\t\t\t\t\t'video': 'CALL_ADMIN_PROHIBITED_CAM_FOR_ALL_BY_SETTINGS',\n\t\t\t\t\t\t'screen_share': 'CALL_ADMIN_PROHIBITED_SCREENSHARE_FOR_ALL_BY_SETTINGS',\n\t\t\t\t\t};\n\n\t\t\t\tlet contentPhrase = typesOfMuteMessage[e.data.act] + '_' + initiatorGender;\n\n\t\t\t\tcontent = '<div class = \"bx-call-view-participants-control-stream-notify-icon bx-call-view-'+(typesOfMute[e.data.act])+'-muted\"></div>'\n\t\t\t\t\t+ (Text.encode(Util.getCustomMessage(contentPhrase, {\n\t\t\t\t\t\tgender: initiatorGender,\n\t\t\t\t\t\tinitiator_name: initiatorUserModel.data.name,\n\t\t\t\t\t})));\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tisAllow = true;\n\t\t\tif (e.data.fromUserId == this.currentCall.userId)\n\t\t\t{\n\t\t\t\tif (this.riseYouHandToTalkPopup)\n\t\t\t\t{\n\t\t\t\t\tthis.riseYouHandToTalkPopup.close();\n\t\t\t\t\tthis.riseYouHandToTalkPopup = null;\n\t\t\t\t}\n\t\t\t\tconst typesOfMuteMessage =\n\t\t\t\t\t{\n\t\t\t\t\t\t'audio': 'CALL_YOU_ALLOWED_MIC_FOR_ALL_BY_SETTINGS',\n\t\t\t\t\t\t'video': 'CALL_YOU_ALLOWED_CAM_FOR_ALL_BY_SETTINGS',\n\t\t\t\t\t\t'screen_share': 'CALL_YOU_ALLOWED_SCREENSHARE_FOR_ALL_BY_SETTINGS',\n\t\t\t\t\t};\n\n\t\t\t\tcontent = '<div class = \"bx-call-view-participants-control-stream-notify-icon bx-call-view-'+(typesOfMute[e.data.act])+'-unmuted\"></div>'\n\t\t\t\t\t+ (BX.message[(typesOfMuteMessage[e.data.act])]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst typesOfMuteMessage =\n\t\t\t\t\t{\n\t\t\t\t\t\t'audio': 'CALL_ADMIN_ALLOWED_MIC_FOR_ALL_BY_SETTINGS',\n\t\t\t\t\t\t'video': 'CALL_ADMIN_ALLOWED_CAM_FOR_ALL_BY_SETTINGS',\n\t\t\t\t\t\t'screen_share': 'CALL_ADMIN_ALLOWED_SCREENSHARE_FOR_ALL_BY_SETTINGS',\n\t\t\t\t\t};\n\n\t\t\t\tlet contentPhrase = typesOfMuteMessage[e.data.act] + '_' + initiatorGender;\n\n\t\t\t\tcontent = '<div class = \"bx-call-view-participants-control-stream-notify-icon bx-call-view-'+(typesOfMute[e.data.act])+'-unmuted\"></div>'\n\t\t\t\t\t+ (Text.encode(Util.getCustomMessage(contentPhrase, {\n\t\t\t\t\t\tgender: initiatorGender,\n\t\t\t\t\t\tinitiator_name: initiatorUserModel.data.name,\n\t\t\t\t\t})));\n\n\t\t\t\tif (this.riseYouHandToTalkPopup && e.data.act === 'audio')\n\t\t\t\t{\n\t\t\t\t\tthis.riseYouHandToTalkPopup.close();\n\t\t\t\t\tthis.riseYouHandToTalkPopup = null;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tif (this.callView && !isAllow)\n\t\t{\n\t\t\tthis.callView.setAllUserPermissionToSpeakState(false);\n\t\t}\n\n\t\tif (content)\n\t\t{\n\t\t\tthis.createCallControlNotify({content: content, isAllow: isAllow});\n\t\t}\n\n\t\tif (this.participantsPermissionPopup)\n\t\t{\n\t\t\tthis.participantsPermissionPopup.updateStatePermissions();\n\t\t}\n\n\t\tif (e.data.eft === true && e.data.act === 'audio' && !Util.havePermissionToBroadcast('mic'))\n\t\t{\n\t\t\tthis.lastCalledChangeSettingsUserName = initiatorUserModel.data.name;\n\t\t\tthis.showRiseYouHandToTalkNotification({initiatorName: this.lastCalledChangeSettingsUserName});\n\t\t}\n\n\t\tthis.callView.updateButtons();\n\t\tthis._onBlockUnblockCamMicButtons();\n\t}\n\n\tshowRiseYouHandToTalkNotification(params)\n\t{\n\t\tif (!this.callView)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.riseYouHandToTalkPopup)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.mutePopup)\n\t\t{\n\t\t\tthis.mutePopup.close();\n\t\t\tthis.mutePopup = null;\n\t\t}\n\n\t\tthis.riseYouHandToTalkPopup = new Call.Hint({\n\t\t\tcallFolded: false,\n\t\t\tbindElement: this.callView.buttons.microphone.elements.icon,\n\t\t\ttargetContainer: this.callView.container,\n\t\t\ticon: 'mic',\n\t\t\tshowAngle: false,\n\t\t\tinitiatorName: params.initiatorName,\n\t\t\tcustomClassName: 'bx-call-view-popup-call-hint-rise-hand-to-talk',\n\t\t\tautoCloseDelay: (30 * 60 * 1000), // show it 30 minutes\n\t\t\tcustomRender: function(){\n\t\t\t\tlet handRaiseContentElement = Dom.create(\"div\", {\n\t\t\t\t\tprops: {className: \"bx-call-view-popup-call-hint-rise-block\"},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tLoc.getMessage('CALL_ADMIN_PROHIBITED_TURN_ON_PARTICIPANTS_MICROPHONES_HINT', {\n\t\t\t\t\t\t\t'#INITIATOR_NAME#': this.initiatorName,\n\t\t\t\t\t\t\t'[hint-label]': `<div class=\"bx-call-view-popup-call-hint-text\">`,\n\t\t\t\t\t\t\t'[/hint-label]': '</div>',\n\t\t\t\t\t\t\t'#RISE_HAND_ICON#': `<div class=\"ui-btn bx-call-view-popup-call-hint-hand-raise-icon\"></div>`,\n\t\t\t\t\t\t\t'[label-or]': `<div class=\"bx-call-view-popup-call-hint-hand-raise-or-label\">`,\n\t\t\t\t\t\t\t'[/label-or]': '</div>',\n\t\t\t\t\t\t\t'#REQUEST_NOW_BUTTON#': `<div class = \"bx-call-view-popup-call-hint-button-placeholder\"></div>`,\n\t\t\t\t\t\t}),\n\t\t\t\t\t],\n\t\t\t\t});\n\n\t\t\t\tlet buttonPlaceholder = handRaiseContentElement.getElementsByClassName('bx-call-view-popup-call-hint-button-placeholder')[0];\n\n\t\t\t\tbuttonPlaceholder.replaceWith(this.createAskSpeakButton().render());\n\n\t\t\t\treturn handRaiseContentElement;\n\t\t\t},\n\t\t\tbuttons: [],\n\t\t\tonClose: () =>\n\t\t\t{\n\t\t\t\tthis.riseYouHandToTalkPopup.close();\n\t\t\t\tthis.riseYouHandToTalkPopup = null;\n\t\t\t},\n\t\t\tonAskSpeakButtonClicked: () =>\n\t\t\t{\n\t\t\t\tthis.onCallViewFloorRequestButtonClick();\n\n\t\t\t\tif (this.riseYouHandToTalkPopup)\n\t\t\t\t{\n\t\t\t\t\tthis.riseYouHandToTalkPopup.close();\n\t\t\t\t\tthis.riseYouHandToTalkPopup = null;\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t\tthis.riseYouHandToTalkPopup.show();\n\t}\n\n\t_afterOpenParticipantsPermissionPopup()\n\t{\n\t\tif (this.participantsPermissionPopup)\n\t\t{\n\t\t\tlet balloons = BX.UI.Notification.Center.balloons;\n\n\t\t\tfor (let baloonId in balloons)\n\t\t\t{\n\t\t\t\tballoons[baloonId].container?.classList.add(BALLOON_OFFSET_CLASS_NAME);\n\t\t\t\tballoons[baloonId].offsetClassNameSetted = true;\n\t\t\t}\n\t\t}\n\t}\n\n\t_afterCloseParticipantsPermissionPopup()\n\t{\n\t\tlet balloons = BX.UI.Notification.Center.balloons;\n\n\t\tfor (let baloonId in balloons)\n\t\t{\n\t\t\tballoons[baloonId].container?.classList.remove(BALLOON_OFFSET_CLASS_NAME);\n\t\t\tballoons[baloonId].offsetClassNameSetted = false;\n\t\t}\n\t}\n\n\tcreateCallControlNotify(_p)\n\t{\n\t\tif (!this.callView)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet balloonClassName = 'ui-notification-balloon-content bx-call-control-notification ';\n\n\t\tif (_p.isAllow === false)\n\t\t{\n\t\t\tballoonClassName += 'bx-call-control-notification-disallow ';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tballoonClassName += 'bx-call-control-notification-allow ';\n\t\t}\n\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: _p.content,\n\t\t\tposition: \"top-right\",\n\t\t\tautoHideDelay: 8000,\n\t\t\tcategory: _p.category || '',\n\t\t\tcloseButton: true,\n\t\t\trender: function() {\n\n\t\t\t\tconst actions = this.getActions().map(action => action.getContainer());\n\n\t\t\t\treturn BX.create(\"div\", {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: balloonClassName,\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create(\"div\", {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: \"ui-notification-balloon-message\",\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\thtml: this.getContent(),\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create(\"div\", {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: \"ui-notification-balloon-actions\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: actions\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tthis.isCloseButtonVisible() ?  this.getCloseButton(): null\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\n\t\tthis._afterOpenParticipantsPermissionPopup();\n\t}\n\n\tonUserStatsReceived(e)\n\t{\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.setUserStats(e.userId, e.report);\n\t\t}\n\t}\n\n\tonCallUserScreenState(e)\n\t{\n\t\tif(this.callView)\n\t\t{\n\t\t\tthis.callView.setUserScreenState(e.userId, e.screenState);\n\t\t}\n\t\tthis.updateCallUser(e.userId, {screenState: e.screenState});\n\t}\n\n\t/**\n\t * @param {Object} event\n\t * @param {number} event.code\n\t * @param {number} event.initiatorId\n\t * @param {number} event.userId\n\t * @param { boolean } event.justJoined\n\t * @param {Object} event.commonRecordState\n\t * @private\n\t */\n\t#onCloudRecordStatusChanged(event)\n\t{\n\t\tif (this.controller.getUserId() === event.userId)\n\t\t{\n\t\t\tconst state = event.commonRecordState.state;\n\t\t\tconst callId = this.currentCall.uuid;\n\t\t\tconst callType = Analytics.AnalyticsType.videoconf;\n\n\t\t\tswitch (state)\n\t\t\t{\n\t\t\t\tcase Call.CallCommonRecordState.Started: {\n\t\t\t\t\tif (this.commonRecord.state === Call.CallCommonRecordState.Resumed)\n\t\t\t\t\t{\n\t\t\t\t\t\tAnalytics.getInstance().onRecordResumed({\n\t\t\t\t\t\t\tcallId,\n\t\t\t\t\t\t\tcallType,\n\t\t\t\t\t\t\terrorCode: null,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tAnalytics.getInstance().onRecordStart({\n\t\t\t\t\t\t\tcallId,\n\t\t\t\t\t\t\tcallType,\n\t\t\t\t\t\t\trecordType: event.commonRecordState.type,\n\t\t\t\t\t\t\terrorCode: null,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase Call.CallCommonRecordState.Paused: {\n\t\t\t\t\tAnalytics.getInstance().onRecordPaused({\n\t\t\t\t\t\tcallId,\n\t\t\t\t\t\tcallType,\n\t\t\t\t\t\terrorCode: null,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase Call.CallCommonRecordState.Stopped: {\n\t\t\t\t\tAnalytics.getInstance().onRecordStop({\n\t\t\t\t\t\tcallId,\n\t\t\t\t\t\tcallType,\n\t\t\t\t\t\tsubSection: Analytics.AnalyticsSubSection.window,\n\t\t\t\t\t\telement: Analytics.AnalyticsElement.recordButton,\n\t\t\t\t\t\trecordTime: Util.getRecordTimeText(this.commonRecord.info, true),\n\t\t\t\t\t});\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase Call.CallCommonRecordState.Destroyed: {\n\t\t\t\t\tAnalytics.getInstance().onRecordDelete({\n\t\t\t\t\t\tcallId,\n\t\t\t\t\t\tcallType,\n\t\t\t\t\t\terrorCode: null,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tdefault: {\n\t\t\t\t\tif (Util.isCloudRecordLogEnabled())\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.error(`Unknown record state: ${status}`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (event.userId && event.userId !== this.controller.getUserId())\n\t\t{\n\t\t\tif (event.justJoined)\n\t\t\t{\n\t\t\t\tif (event.commonRecordState.state === Call.CallCommonRecordState.Started)\n\t\t\t\t{\n\t\t\t\t\tif (Call.CallCloudRecord.isCisRegion)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.callView.showCommonRecordStartNotify(event.userId, Call.CallCommonRecordState.Started);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.callView.showCommonRecordStartModal();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.callView.showCommonRecordStartNotify(event.userId, event.commonRecordState.state);\n\t\t\t}\n\t\t}\n\n\t\tthis.commonRecord.state = event.commonRecordState.state;\n\t\tthis.callView.setCommonRecordState(event.commonRecordState);\n\t\tthis.commonRecord.initiatorId = event.initiatorId;\n\n\t\tif (Util.isCommonRecordStateInactive(event.commonRecordState.state))\n\t\t{\n\t\t\tthis.commonRecord.info = null;\n\t\t\tthis.commonRecord.initiatorId = null;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.commonRecord.info = structuredClone(event.commonRecordState);\n\t\t}\n\n\t\tthis.callView.unblockButtons(['record']);\n\t\tthis.callView.setButtonActive('record', [Call.CloudRecordStatus.STARTED, Call.CloudRecordStatus.PAUSED].includes(event.code));\n\t}\n\n\t#onCallUserCommonRecordState(event)\n\t{\n\t\tif (this.#canCloudRecord())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { commonRecordState, userId } = event;\n\t\tconst { state, userId: initiatorId } = commonRecordState;\n\n\t\tthis.commonRecord.state = state;\n\t\tthis.callView.setCommonRecordState(commonRecordState);\n\t\tthis.commonRecord.initiatorId = initiatorId;\n\n\t\tif ([Call.CallCommonRecordState.Stopped, Call.CallCommonRecordState.Destroyed].includes(state))\n\t\t{\n\t\t\tthis.commonRecord.initiatorId = null;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.commonRecord.info = commonRecordState;\n\t\t}\n\n\t\tif (!this.commonRecord.notifyShowed && state === Call.CallCommonRecordState.Started && initiatorId !== this.controller.getUserId())\n\t\t{\n\t\t\tthis.commonRecord.notifyShowed = true;\n\t\t\tthis.callView.showCommonRecordStartNotify(initiatorId);\n\t\t}\n\n\t\tif (Util.isCommonRecordStateInactive(state) && initiatorId !== this.controller.getUserId())\n\t\t{\n\t\t\tthis.commonRecord.notifyShowed = false;\n\t\t}\n\n\t\tif (!this.#canCommonRecord() || userId !== this.controller.getUserId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst isStartedByMe = state === Call.CallCommonRecordState.Started && initiatorId === this.controller.getUserId();\n\t\tconst isStopped = state === Call.CallCommonRecordState.Stopped;\n\n\t\tif (isStartedByMe)\n\t\t{\n\n\t\t\tconst callType = Analytics.AnalyticsType.videoconf;\n\t\t\tconst callId = this.currentCall.uuid;\n\t\t\tconst { id: dialogId, name: dialogName } = this.currentCall.associatedEntity;\n\n\t\t\tconst callDate = BX.Main.Date.format(this.params.formatRecordDate || 'd.m.Y');\n\n\t\t\tlet fileName = Loc.getMessage('IM_CALL_RECORD_NAME');\n\n\t\t\tif (fileName)\n\t\t\t{\n\t\t\t\tfileName = fileName\n\t\t\t\t\t.replace('#CHAT_TITLE#', dialogName)\n\t\t\t\t\t.replace('#CALL_ID#', callId)\n\t\t\t\t\t.replace('#DATE#', callDate)\n\t\t\t\t;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfileName = `call_record_${callId}`;\n\t\t\t}\n\n\t\t\tthis.callEngine.getRestClient().callMethod('call.Call.onStartRecord', { callUuid: this.currentCall.uuid });\n\n\t\t\tAnalytics.getInstance().onRecordStart({ callId, callType, recordType: this.commonRecord.type, errorCode: null });\n\n\t\t\tBXDesktopSystem.CallRecordStart({\n\t\t\t\twindowId: window.bxdWindowId || window.document.title,\n\t\t\t\tfileName,\n\t\t\t\tcallId, // now not used\n\t\t\t\tcallDate,\n\t\t\t\tdialogId,\n\t\t\t\tdialogName,\n\t\t\t\tvideo: this.commonRecord.type !== Call.CallCommonRecordType.Audio,\n\t\t\t\tmuted: Call.Hardware.isMicrophoneMuted,\n\t\t\t\tcropTop: 72,\n\t\t\t\tcropBottom: 90,\n\t\t\t\tshareMethod: 'im.disk.record.share',\n\t\t\t\tcallType,\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (isStopped)\n\t\t{\n\t\t\tAnalytics.getInstance().onRecordStop({\n\t\t\t\tcallId: this.currentCall.uuid,\n\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\tsubSection: Analytics.AnalyticsSubSection.window,\n\t\t\t\telement: Analytics.AnalyticsElement.recordButton,\n\t\t\t\trecordTime: Util.getRecordTimeText(this.commonRecord.info),\n\t\t\t});\n\n\t\t\tthis.#stopCommonRecord();\n\t\t}\n\t}\n\n\tonCallUserFloorRequest(e)\n\t{\n\t\tthis.callView.setUserFloorRequestState(e.userId, e.requestActive);\n\t\tthis.updateCallUser(e.userId, {floorRequestState: e.requestActive});\n\t}\n\n\tonMicrophoneLevel(e)\n\t{\n\t\tthis.callView.setMicrophoneLevel(e.level);\n\t}\n\n\tonCallJoin(e)\n\t{\n\t\tif (!e.local)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isViewerMode())\n\t\t{\n\t\t\tthis.callView.unblockButtons(['floorRequest', 'screen']);\n\t\t\tthis.checkAvailableCamera();\n\t\t\tthis.checkAvailableMicrophone();\n\t\t}\n\n\t\tif (this.callView.getConnectedUserCount(false))\n\t\t{\n\t\t\tthis.callView.unblockButtons(['record']);\n\t\t}\n\n\t\tthis.callView.setUiState(Call.View.UiState.Connected);\n\t}\n\n\tonCallFailure(e)\n\t{\n\t\tthis.setConferenceHasErrorInCall(true);\n\t\tconst errorCode = e.code || e.name || e.error;\n\n\t\tlet errorMessage = '';\n\t\tlet isUnknownError = false;\n\n\t\tif (e.name === 'VoxConnectionError' || e.name === 'AuthResult')\n\t\t{\n\t\t\tUtil.reportConnectionResult(e.call.id, false);\n\t\t}\n\n\t\tswitch (errorCode)\n\t\t{\n\t\t\tcase Call.StartCallErrorCode.ErrorUnexpectedAnswer:\n\t\t\t\terrorMessage = Loc.getMessage('IM_CALL_ERROR_UNEXPECTED_ANSWER');\n\t\t\t\tbreak;\n\n\t\t\tcase Call.StartCallErrorCode.BlankAnswerWithErrorCode:\n\t\t\t\terrorMessage = Loc.getMessage('IM_CALL_ERROR_BLANK_ANSWER');\n\t\t\t\tbreak;\n\n\t\t\tcase Call.StartCallErrorCode.BlankAnswer:\n\t\t\t\terrorMessage = Loc.getMessage('IM_CALL_ERROR_BLANK_ANSWER');\n\t\t\t\tbreak;\n\n\t\t\tcase Call.StartCallErrorCode.AccessDenied:\n\t\t\t\terrorMessage = Loc.getMessage('IM_CALL_ERROR_ACCESS_DENIED');\n\t\t\t\tbreak;\n\n\t\t\tcase Call.StartCallErrorCode.NoWebrtc:\n\t\t\t\terrorMessage = Loc.getMessage(this.isHttps ? 'IM_CALL_NO_WEBRT' : 'IM_CALL_ERROR_HTTPS_REQUIRED');\n\t\t\t\tbreak;\n\n\t\t\tcase Call.StartCallErrorCode.UnknownError:\n\t\t\t\tisUnknownError = true;\n\t\t\t\terrorMessage = Loc.getMessage('IM_CALL_ERROR_UNKNOWN');\n\t\t\t\tbreak;\n\n\t\t\tcase Call.StartCallErrorCode.NetworkError:\n\t\t\t\terrorMessage = Loc.getMessage('IM_CALL_ERROR_NETWORK');\n\t\t\t\tbreak;\n\n\t\t\tcase Call.StartCallErrorCode.NotAllowedError:\n\t\t\t\terrorMessage = Loc.getMessage('IM_CALL_ERROR_HARDWARE_ACCESS_DENIED');\n\t\t\t\tbreak;\n\n\t\t\tcase Call.StartCallErrorCode.NotReadableError:\n\t\t\t\terrorMessage = Loc.getMessage('IM_CALL_ERROR_HARDWARE');\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tif (errorCode === Call.StartCallErrorCode.AuthorizeError || e.name === 'AuthResult')\n\t\t\t\t{\n\t\t\t\t\terrorMessage = Loc.getMessage('IM_CALL_ERROR_AUTHORIZATION');\n\t\t\t\t}\n\t\t\t\telse if (errorCode == 403 && e.name === 'Failed')\n\t\t\t\t{\n\t\t\t\t\terrorMessage = Loc.getMessage('IM_CALL_ERROR_HARDWARE_ACCESS_DENIED');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tisUnknownError = true;\n\t\t\t\t\terrorMessage = Loc.getMessage('IM_CALL_ERROR_UNKNOWN_WITH_CODE', { '#ERROR_CODE#': errorCode });\n\t\t\t\t}\n\t\t}\n\n\t\tif (this.callView)\n\t\t{\n\t\t\tif (isUnknownError)\n\t\t\t{\n\t\t\t\tthis.callView.showSelfTest();\n\t\t\t}\n\t\t\telse if (errorCode === Call.DisconnectReason.SecurityKeyChanged)\n\t\t\t{\n\t\t\t\tthis.callView.showSecurityKeyError();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.callView.showFatalError({ text: errorMessage });\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showNotification(errorMessage);\n\t\t}\n\n\t\tthis.autoCloseCallView = false;\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.removeVideoStrategy();\n\t\t\tthis.removeCallEvents();\n\n\t\t\tif (this.currentCallIsNew)\n\t\t\t{\n\t\t\t\t// todo: possibly delete\n\t\t\t\tthis.callEngine.getRestClient().callMethod('im.call.interrupt', {callId: this.currentCall.id});\n\t\t\t}\n\n\t\t\tthis.currentCall.destroy();\n\t\t\tthis.currentCall = null;\n\t\t\tthis.currentCallIsNew = false;\n\t\t}\n\n\t\tif (this.promotedToAdminTimeout)\n\t\t{\n\t\t\tclearTimeout(this.promotedToAdminTimeout);\n\t\t}\n\n\t\tCall.Hardware.isMicrophoneMuted = false;\n\t}\n\n\tonCallLeave(e)\n\t{\n\t\tif (!e.local)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.webScreenSharePopup)\n\t\t{\n\t\t\tthis.webScreenSharePopup.close();\n\t\t}\n\n\t\tthis.#stopCommonRecord();\n\n\t\tthis.commonRecord.state = Call.CallCommonRecordState.Stopped;\n\t\tthis.commonRecord.type = Call.CallCommonRecordType.None;\n\n\t\tthis.togglePictureInPictureCallWindow({ isForceClose: true });\n\n\t\tif (!this.getActiveCallUsers().length)\n\t\t{\n\t\t\tAnalytics.getInstance().onFinishCall({\n\t\t\t\tcallId: this.currentCall?.uuid,\n\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\tstatus: Analytics.AnalyticsStatus.lastUserLeft,\n\t\t\t\tchatId: this.currentCall?.associatedEntity.id,\n\t\t\t\tcallUsersCount: this.getCallUsers(true).length,\n\t\t\t\tcallLength: Util.getTimeText(this.currentCall.startDate),\n\t\t\t});\n\t\t}\n\n\t\tthis.endCall();\n\t}\n\n\tonCallDestroy(e)\n\t{\n\t\tthis.currentCall = null;\n\n\t\tif (this.promotedToAdminTimeout)\n\t\t{\n\t\t\tclearTimeout(this.promotedToAdminTimeout);\n\t\t}\n\n\t\tif (this.floatingScreenShareWindow)\n\t\t{\n\t\t\tthis.floatingScreenShareWindow.close;\n\t\t}\n\n\t\tif (this.webScreenSharePopup)\n\t\t{\n\t\t\tthis.webScreenSharePopup.close();\n\t\t}\n\n\t\tif (this.riseYouHandToTalkPopup)\n\t\t{\n\t\t\tthis.riseYouHandToTalkPopup.close();\n\t\t\tthis.riseYouHandToTalkPopup = null;\n\t\t}\n\n\t\tthis.#stopCommonRecord();\n\n\t\tthis.restart();\n\t}\n\n\tonCheckDevicesSave(changedValues)\n\t{\n\t\tif (changedValues['camera'])\n\t\t{\n\t\t\tCall.Hardware.defaultCamera = changedValues['camera'];\n\t\t}\n\n\t\tif (changedValues['microphone'])\n\t\t{\n\t\t\tCall.Hardware.defaultMicrophone = changedValues['microphone'];\n\t\t}\n\n\t\tif (changedValues['audioOutput'])\n\t\t{\n\t\t\tCall.Hardware.defaultSpeaker = changedValues['audioOutput'];\n\t\t}\n\n\t\tif (changedValues['preferHDQuality'])\n\t\t{\n\t\t\tCall.Hardware.preferHdQuality = changedValues['preferHDQuality'];\n\t\t}\n\n\t\tif (changedValues['enableMicAutoParameters'])\n\t\t{\n\t\t\tCall.Hardware.enableMicAutoParameters = changedValues['enableMicAutoParameters'];\n\t\t}\n\t}\n\n\tsetCameraState(state)\n\t{\n\t\tCall.Hardware.isCameraOn = state;\n\t}\n\t/* endregion 01. Call methods */\n\n\t/* region 02. Component methods */\n\t/* region 01. General actions */\n\tisChatShowed()\n\t{\n\t\treturn this.getConference().common.showChat;\n\t}\n\n\ttoggleChat()\n\t{\n\t\tconst rightPanelMode = this.getConference().common.rightPanelMode;\n\t\tif (rightPanelMode === RightPanelMode.hidden)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.chat});\n\t\t\tthis.callView.setButtonActive('chat', true);\n\t\t}\n\t\telse if (rightPanelMode === RightPanelMode.chat)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.hidden});\n\t\t\tthis.callView.setButtonActive('chat', false);\n\t\t}\n\t\telse if (rightPanelMode === RightPanelMode.users)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.split});\n\t\t\tthis.callView.setButtonActive('chat', true);\n\t\t}\n\t\telse if (rightPanelMode === RightPanelMode.split)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.users});\n\t\t\tthis.callView.setButtonActive('chat', false);\n\t\t}\n\t}\n\n\ttoggleUserList()\n\t{\n\t\tconst rightPanelMode = this.getConference().common.rightPanelMode;\n\t\tif (rightPanelMode === RightPanelMode.hidden)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.users});\n\t\t\tthis.callView.setButtonActive('users', true);\n\t\t}\n\t\telse if (rightPanelMode === RightPanelMode.users)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.hidden});\n\t\t\tthis.callView.setButtonActive('users', false);\n\t\t}\n\t\telse if (rightPanelMode === RightPanelMode.chat)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.split});\n\t\t\tthis.callView.setButtonActive('users', true);\n\t\t}\n\t\telse if (rightPanelMode === RightPanelMode.split)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.chat});\n\t\t\tthis.callView.setButtonActive('users', false);\n\t\t}\n\t}\n\n\tpinUser(user)\n\t{\n\t\tif (!this.callView)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tthis.callView.pinUser(user.id);\n\t\tthis.callView.setLayout(Call.View.Layout.Centered);\n\t}\n\n\tunpinUser()\n\t{\n\t\tif (!this.callView)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tthis.callView.unpinUser();\n\t}\n\n\tchangeBackground()\n\t{\n\t\tif (!Call.Hardware)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tCall.BackgroundDialog.open();\n\t}\n\n\topenChat(user)\n\t{\n\t\tDesktopApi.emitToMainWindow('bxConferenceOpenChat', [user.id]);\n\t}\n\n\topenProfile(user)\n\t{\n\t\tDesktopApi.emitToMainWindow('bxConferenceOpenProfile', [user.id]);\n\t}\n\n\tsetDialogInited()\n\t{\n\t\tthis.dialogInited = true;\n\t\tlet dialogData = this.getDialogData();\n\t\tdocument.title = dialogData.name;\n\t}\n\n\tchangeVideoconfUrl(newUrl)\n\t{\n\t\twindow.history.pushState(\"\", \"\", newUrl);\n\t}\n\n\tsendNewMessageNotify(params)\n\t{\n\t\tconst MAX_LENGTH = 40;\n\t\tconst AUTO_HIDE_TIME = 4000;\n\n\t\tif (!this.checkIfMessageNotifyIsNeeded(params))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t\tconst text = Utils.text.purify(params.message.text, params.message.params, params.files);\n\t\tlet avatar = '';\n\t\tlet userName = '';\n\n\t\t// avatar and username only for non-system messages\n\t\tif (params.message.senderId > 0 && params.message.system !== 'Y')\n\t\t{\n\t\t\tconst messageAuthor = this.controller.getStore().getters['users/get'](params.message.senderId, true);\n\t\t\tuserName = messageAuthor.name;\n\t\t\tavatar = messageAuthor.avatar;\n\t\t}\n\n\t\tNotifier.notify({\n\t\t\tid: `im-videconf-${params.message.id}`,\n\t\t\ttitle: userName,\n\t\t\ticon: avatar,\n\t\t\ttext\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tcheckIfMessageNotifyIsNeeded(params)\n\t{\n\t\tif (!Util.isConferenceChatEnabled())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst rightPanelMode = this.getConference().common.rightPanelMode;\n\t\treturn !Utils.device.isMobile()\n\t\t\t&& params.chatId === this.getChatId()\n\t\t\t&& (rightPanelMode !== RightPanelMode.chat || rightPanelMode !== RightPanelMode.split)\n\t\t\t&& params.message.senderId !== this.controller.getUserId()\n\t\t\t&& !this.getConference().common.error;\n\t}\n\n\tonInputFocus(e)\n\t{\n\t\tthis.callView.setHotKeyTemporaryBlock(true);\n\t}\n\n\tonInputBlur(e)\n\t{\n\t\tthis.callView.setHotKeyTemporaryBlock(false);\n\t}\n\n\tcloseReconnectionBaloon()\n\t{\n\t\tif (this.reconnectionBaloon)\n\t\t{\n\t\t\tthis.reconnectionBaloon.close();\n\t\t\tthis.reconnectionBaloon = null;\n\t\t}\n\t}\n\n\tsetReconnectingCameraId(id)\n\t{\n\t\tthis.reconnectingCameraId = id;\n\n\t\tif (id) {\n\t\t\tthis.updateCameraSettingsInCurrentCallAfterReconnecting(id)\n\t\t}\n\t}\n\n\tupdateCameraSettingsInCurrentCallAfterReconnecting(cameraId)\n\t{\n\t\tif (this.currentCall.cameraId === cameraId) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst devicesList = Call.Hardware.getCameraList();\n\n\t\tif (!devicesList.find(device => device.deviceId === cameraId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.currentCall.setCameraId(cameraId);\n\t\tthis.setReconnectingCameraId(null);\n\t}\n\n\tonUpdateLastUsedCameraId()\n\t{\n\t\tconst cameraId = this.currentCall.cameraId;\n\t\tif (cameraId)\n\t\t{\n\t\t\tthis.lastUsedCameraId = cameraId;\n\t\t}\n\t}\n\n\tonReconnecting(e)\n\t{\n\t\tif (!(this.currentCall.provider === Call.Provider.Bitrix || this.currentCall.provider === Call.Provider.Plain))\n\t\t{\n\t\t\t// todo: restore after fixing balloon resurrection issue\n\t\t\t// related to multiple simultaneous calls to the balloon manager\n\t\t\t// now it's enabled for Bitrix24 calls as a temp solution\n\t\t\treturn false;\n\t\t}\n\n\t\tAnalytics.getInstance().onReconnect({\n\t\t\tcallId: this.currentCall.uuid,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\treconnectionReason: e.reconnectionReason,\n\t\t\treconnectionReasonInfo: e.reconnectionReasonInfo,\n\t\t\treconnectionEventCount: e.reconnectionEventCount,\n\t\t\tisVpnActive: this.#isVpnConnected(),\n\t\t});\n\n\t\t// noinspection UnreachableCodeJS\n\n\t\tif (this.reconnectionBaloon)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.reconnectionBaloon = BX.UI.Notification.Center.notify({\n\t\t\tcontent: Text.encode(BX.message('IM_CALL_RECONNECTING')),\n\t\t\tautoHide: false,\n\t\t\tposition: \"top-right\",\n\t\t\tcloseButton: false,\n\t\t})\n\t}\n\n\tonReconnected()\n\t{\n\t\tthis.setReconnectingCameraId(this.lastUsedCameraId)\n\t\tif (!(this.currentCall.provider === Call.Provider.Bitrix || this.currentCall.provider === Call.Provider.Plain))\n\t\t{\n\t\t\t// todo: restore after fixing balloon resurrection issue\n\t\t\t// related to multiple simultaneous calls to the balloon manager\n\t\t\t// now it's enabled for Bitrix24 calls as a temp solution\n\t\t\treturn false;\n\t\t}\n\n\t\t// noinspection UnreachableCodeJS\n\t\tthis.closeReconnectionBaloon();\n\t}\n\n\tonReconnectingFailed(e)\n\t{\n\t\tAnalytics.getInstance().onReconnectError({\n\t\t\tcallId: this.currentCall?.id,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\terrorCode: e?.code,\n\t\t\tisVpnActive: this.#isVpnConnected(),\n\t\t});\n\t}\n\n\tsetUserWasRenamed()\n\t{\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.localUser.userModel.wasRenamed = true;\n\t\t}\n\t}\n\t/* endregion 01. General actions */\n\n\t/* region 02. Store actions */\n\tsetError(errorCode)\n\t{\n\t\tconst currentError = this.getConference().common.error;\n\t\t// if user kicked from call - dont show him end of call form\n\t\tif (currentError && currentError === ConferenceErrorCode.kickedFromCall)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.controller.getStore().commit('conference/setError', {errorCode});\n\t}\n\n\ttoggleSmiles()\n\t{\n\t\tthis.controller.getStore().commit('conference/toggleSmiles');\n\t}\n\n\tsetJoinType(joinWithVideo)\n\t{\n\t\tthis.controller.getStore().commit('conference/setJoinType', {joinWithVideo});\n\t}\n\n\tsetConferenceStatus(conferenceStarted)\n\t{\n\t\tthis.controller.getStore().commit('conference/setConferenceStatus', {conferenceStarted});\n\t}\n\n\tsetConferenceHasErrorInCall(hasErrorInCall)\n\t{\n\t\tthis.controller.getStore().commit('conference/setConferenceHasErrorInCall', {hasErrorInCall});\n\t}\n\n\tsetConferenceStartDate(conferenceStartDate)\n\t{\n\t\tthis.controller.getStore().commit('conference/setConferenceStartDate', {conferenceStartDate});\n\t}\n\n\tsetUserReadyToJoin()\n\t{\n\t\tthis.controller.getStore().commit('conference/setUserReadyToJoin');\n\t}\n\n\tupdateCallUser(userId, fields)\n\t{\n\t\tthis.controller.getStore().dispatch('call/updateUser', {id: userId, fields});\n\t}\n\t/* endregion 02. Store actions */\n\n\t/* region 03. Rest actions */\n\tsetUserName(name)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.restClient.callMethod('im.call.user.update', {\n\t\t\t\tname: name,\n\t\t\t\tchat_id: this.getChatId()\n\t\t\t}).then(resolve).catch((error) => {\n\t\t\t\treject(error)\n\t\t\t});\n\t\t});\n\t}\n\n\tcheckPassword(password)\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.restClient.callMethod('im.videoconf.password.check', { password, alias: this.params.alias })\n\t\t\t\t.then(result => {\n\t\t\t\t\tif (result.data() === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.restClient.setPassword(password);\n\t\t\t\t\t\tthis.controller.getStore().commit('conference/common', {\n\t\t\t\t\t\t\tpassChecked: true\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.initUserComplete();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treject();\n\t\t\t\t\t}\n\t\t\t\t}).catch(result => {\n\t\t\t\tconsole.error('Password check error', result);\n\t\t\t});\n\t\t});\n\t}\n\n\tchangeLink()\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.restClient.callMethod('im.videoconf.share.change', {\n\t\t\t\tdialog_id: this.getDialogId()\n\t\t\t}).then(() => {\n\t\t\t\tresolve();\n\t\t\t}).catch((error) => {\n\t\t\t\treject(error)\n\t\t\t});\n\t\t});\n\t}\n\t/* endregion 03. Rest actions */\n\t/* endregion 02. Component methods */\n\n\t/* endregion 02. Methods */\n\n\t/* region 03. Utils */\n\tready()\n\t{\n\t\tif (this.inited)\n\t\t{\n\t\t\tlet promise = new BX.Promise;\n\t\t\tpromise.resolve(this);\n\n\t\t\treturn promise;\n\t\t}\n\n\t\treturn this.initPromise;\n\t}\n\n\tgetConference()\n\t{\n\t\treturn this.controller.getStore().state.conference;\n\t}\n\n\tisBroadcast()\n\t{\n\t\treturn this.getConference().common.isBroadcast;\n\t}\n\n\tgetBroadcastPresenters()\n\t{\n\t\treturn this.getConference().common.presenters;\n\t}\n\n\tisExternalUser()\n\t{\n\t\treturn !!this.getUserHash();\n\t}\n\n\tgetCallConfig(videoEnabled: Boolean, callUuid: String): Object\n\t{\n\t\tconst callConfig = {\n\t\t\tvideoEnabled,\n\t\t\ttype: Call.Type.Permanent,\n\t\t\tentityType: 'chat',\n\t\t\tentityId: this.getDialogId(),\n\t\t\tprovider: Call.Provider.Bitrix,\n\t\t\tenableMicAutoParameters: Call.Hardware.enableMicAutoParameters,\n\t\t\tjoinExisting: true,\n\t\t\ttoken: this.callToken,\n\t\t\tchatInfo: {\n\t\t\t\tadvanced: {\n\t\t\t\t\tchatType: 'videoconf',\n\t\t\t\t\tentityData1: '',\n\t\t\t\t\tentityData2: '',\n\t\t\t\t\tentityData3: '',\n\t\t\t\t\tentityId: this.getDialogId(),\n\t\t\t\t\tentityType: 'VIDEOCONF',\n\t\t\t\t},\n\t\t\t\tavatar: '/bitrix/js/im/images/blank.gif',\n\t\t\t\tavatarColor: '#ab7761',\n\t\t\t\tid: this.getDialogId(),\n\t\t\t\tchatId: this.getChatId(),\n\t\t\t\tname: this.params.conferenceTitle,\n\t\t\t\ttype: 'chat',\n\t\t\t\tuserCounter: this.getDialogData()?.userCounter,\n\t\t\t},\n\t\t};\n\n\t\tif (callUuid)\n\t\t{\n\t\t\tcallConfig.roomId = callUuid;\n\t\t}\n\n\t\treturn callConfig;\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn parseInt(this.params.chatId);\n\t}\n\n\tgetDialogId()\n\t{\n\t\treturn this.params.dialogId;\n\t}\n\n\tgetDialogData()\n\t{\n\t\tif (!this.dialogInited)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.getStore().getters['dialogues/get'](this.getDialogId());\n\t}\n\n\tgetHost()\n\t{\n\t\treturn location.origin || '';\n\t}\n\n\tgetStartupErrorCode()\n\t{\n\t\treturn this.params.startupErrorCode? this.params.startupErrorCode : '';\n\t}\n\n\tisHttps()\n\t{\n\t\treturn location.protocol === 'https:';\n\t}\n\n\tgetUserHash()\n\t{\n\t\treturn this.getConference().user.hash;\n\t}\n\n\tgetUserHashCookie()\n\t{\n\t\tlet userHash = '';\n\n\t\tlet cookie = Cookie.get(null, 'BITRIX_CALL_HASH');\n\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t{\n\t\t\tuserHash = cookie;\n\t\t}\n\n\t\treturn userHash;\n\t}\n\n\tswitchToSessAuth()\n\t{\n\t\tthis.restClient.restClient.queryParams = undefined;\n\n\t\treturn true;\n\t}\n\n\t#getDefaultCommonRecord()\n\t{\n\t\treturn {\n\t\t\tstate: Call.CallCommonRecordState.Stopped,\n\t\t\ttype: Call.CallCommonRecordType.None,\n\t\t\tinitiatorId: null,\n\t\t\tinfo: null,\n\t\t\tnotifyShowed: false,\n\t\t};\n\t}\n\n\t#showCloudRecordPromo()\n\t{\n\t\tif (\n\t\t\tthis.callView\n\t\t\t&& (this.currentCall && this.currentCall.isAnyoneParticipating())\n\t\t\t&& Call.CallCloudRecord.serviceEnabled\n\t\t)\n\t\t{\n\t\t\tthis.callView.showCloudRecordPromo(this.currentCall.isCloudRecordFeaturesEnabled, this.currentCall.id);\n\t\t}\n\t}\n\n\t/* endregion 03. Utils */\n}\n\nConferenceApplication.FeatureState = {\n\tEnabled: 'enabled',\n\tDisabled: 'disabled',\n\tLimited: 'limited',\n};\n\nexport { ConferenceApplication };\n"],"names":["RestAuth","Object","freeze","guest","CallRestClient","params","queryAuthRestore","setAuthId","restClient","RestClient","endpoint","queryParams","cors","authId","customAuthId","match","call_auth_id","console","error","call_custom_auth_id","chatId","call_chat_id","alias","videoconf_id","password","videoconf_password","method","callback","sendCallback","logTag","Utils","getLogTrackingParams","name","promise","BX","Promise","callMethod","then","result","fulfill","ex","hash","RestMethod","widgetUserRegister","warn","error_description","reject","calls","bHaltOnError","resultCallback","hasOwnProperty","callBatch","BALLOON_OFFSET_CLASS_NAME","ConferenceApplication","inited","hardwareInited","dialogInited","initPromise","userId","parseInt","siteId","dialogId","toString","passwordRequired","isBroadcast","Messenger","Lib","Logger","setConfig","loggerConfig","messagesQueue","template","rootNode","node","document","createElement","event","VueVendorV2","callContainer","preCall","currentCall","callToken","videoStrategy","callDetails","showFeedback","callScheme","promotedToAdminTimeoutValue","promotedToAdminTimeout","featureConfig","forEach","limit","id","localVideoStream","lastUsedCameraId","reconnectingCameraId","conferencePageTagInterval","onCallUserInvitedHandler","onCallUserInvited","bind","onCallUserJoinedHandler","onCallUserJoined","onCallUserStateChangedHandler","onCallUserStateChanged","onCallUserMicrophoneStateHandler","onCallUserMicrophoneState","onCallUserCameraStateHandler","onCallUserCameraState","onNeedResetMediaDevicesStateHandler","onNeedResetMediaDevicesState","onCallUserVideoPausedHandler","onCallUserVideoPaused","onCallLocalMediaReceivedHandler","debounce","onCallLocalMediaReceived","onCallLocalMediaStoppedHandler","onCallLocalMediaStopped","onCallRemoteMediaReceivedHandler","onCallRemoteMediaReceived","onCallRemoteMediaStoppedHandler","onCallRemoteMediaStopped","onCallUserVoiceStartedHandler","onCallUserVoiceStarted","onCallUserVoiceStoppedHandler","onCallUserVoiceStopped","onUserStatsReceivedHandler","onUserStatsReceived","onCallUserScreenStateHandler","onCallUserScreenState","onCallUserFloorRequestHandler","onCallUserFloorRequest","onMicrophoneLevelHandler","onMicrophoneLevel","_onCallJoinHandler","onCallJoin","onCallFailureHandler","onCallFailure","onCallLeaveHandler","onCallLeave","onCallDestroyHandler","onCallDestroy","onInputFocusHandler","onInputFocus","onInputBlurHandler","onInputBlur","onReconnectingHandler","onReconnecting","onReconnectedHandler","onReconnected","onReconnectingFailedHandler","onReconnectingFailed","onUpdateLastUsedCameraIdHandler","onUpdateLastUsedCameraId","onCallConnectionQualityChangedHandler","onCallConnectionQualityChanged","onCallToggleRemoteParticipantVideoHandler","onCallToggleRemoteParticipantVideo","_onGetUserMediaEndedHandler","onGetUserMediaEnded","_onSwitchTrackRecordStatusHandler","onUpdateCallCopilotState","onCameraPublishingHandler","onCameraPublishing","onMicrophonePublishingdHandler","onMicrophonePublishingd","_onTurnOnCameraHandler","_onTurnOnCamera","_onAllParticipantsAudioMutedHandler","_onAllParticipantsAudioMuted","_onAllParticipantsVideoMutedHandler","_onAllParticipantsVideoMuted","_onAllParticipantsScreenshareHandler","_onAllParticipantsScreenshareMuted","_onYouMuteAllParticipantsHandler","_onYouMuteAllParticipants","_onRoomSettingsChangedHandler","_onRoomSettingsChanged","_onUserPermissionsChangedHandler","_onUserPermissionsChanged","_onUserRoleChangedHandler","_onUserRoleChanged","_onParticipantMutedHandler","_onParticipantMuted","onPreCallDestroyHandler","onPreCallDestroy","onPreCallUserStateChangedHandler","onPreCallUserStateChanged","waitingForCallStatus","waitingForCallStatusTimeout","callEventReceived","commonRecord","floatingScreenShareWindow","webScreenSharePopup","screenShareStartTime","mutePopup","riseYouHandToTalkPopup","allowMutePopup","loopTimers","isFileChooserActive","pictureInPictureDebounceForOpen","isWindowFocus","DesktopApi","isDesktop","ConferenceChannel","getInstance","setExecuter","callUuid","currentCallUuid","hasView","Boolean","callView","hasActiveCall","BXDesktopSystem","SetActiveTab","initDesktopEvents","initAdditionalEvents","initRestClient","subscribePreCallChanges","subscribeNotifierEvents","initPullClient","initCore","setModelData","initComponent","initCallInterface","initHardware","initUserComplete","resolve","Call","onBackToCallClick","onFloatingScreenShareBackToCallClick","onStopSharingClick","onFloatingScreenShareStopClick","onChangeScreenClick","onFloatingScreenShareChangeScreenClick","subscribe","title","x","y","width","height","app","setSharingData","show","counter","controller","getStore","commit","messageCount","status","showVpnIsActiveNotification","EventEmitter","EventType","textarea","focus","blur","conference","userRenameFocus","userRenameBlur","window","addEventListener","onWindowFocus","onWindowBlur","body","evt","onDocumentBodyClick","getHost","setConfId","conferenceId","addCustomEvent","onCallCreated","Notifier","getData","startsWith","toggleChat","isIntranetOrExtranet","pullClient","PullClient","serverEnabled","skipStorageInit","configTimestamp","skipCheckRevision","getPublicListMethod","PULL","start","Controller","host","languageId","language","pull","client","rest","vuexBuilder","database","browser","isIe","databaseName","databaseType","VuexBuilder","DatabaseType","localStorage","models","ConferenceModel","create","CallModel","Application","Core","ready","dialog","getChatId","getDialogId","options","darkBackground","presentersIds","presenters","map","presenter","dispatch","broadcastMode","passChecked","conferenceTitle","getStartupErrorCode","setError","createVue","el","data","vue","getElementById","hiddenButtons","isViewerMode","push","Util","isConferenceChatEnabled","container","showChatButtons","showUsersButton","showShareButton","getFeatureState","FeatureState","Disabled","showRecordButton","userLimit","getUserLimit","layout","device","isMobile","Layout","Mobile","Centered","uiState","UiState","Preparing","blockedButtons","localUserState","Idle","hiddenTopButtons","getBroadcastPresenters","length","broadcastingMode","broadcastingPresenters","isCopilotFeaturesEnabled","isCopilotActive","isVideoconf","Event","onButtonClick","onCallButtonClick","onReplaceCamera","onCallReplaceCamera","onReplaceMicrophone","onCallReplaceMicrophone","onReplaceSpeaker","onCallReplaceSpeaker","onHasMainStream","onCallViewHasMainStream","onChangeHdVideo","onCallViewChangeHdVideo","onChangeNoiseSuppression","onCallViewChangeNoiseSuppression","onChangeMicAutoParams","onCallViewChangeMicAutoParams","onChangeFaceImprove","onCallViewChangeFaceImprove","onUserRename","onCallViewUserRename","onUserPinned","onCallViewUserPinned","onToggleSubscribe","onCallToggleSubscribe","onCommonRecordMenu","setCallback","onChangeVideoQuality","_onChangeVideoQuality","onTurnOffParticipantMic","_onCallViewTurnOffParticipantMic","onTurnOffParticipantCam","_onCallViewTurnOffParticipantCam","onTurnOffParticipantScreenshare","_onCallViewTurnOffParticipantScreenshare","onAllowSpeakPermission","_onCallViewAllowSpeakPermission","onDisallowSpeakPermission","_onCallViewDisallowSpeakPermission","blockAddUser","blockHistoryButton","errorCode","Type","isString","isPlainObject","code","message","initUser","tryJoinExistingCall","initCall","startPageTagInterval","initPullHandlers","subscribeToStoreChanges","initComplete","getConference","common","setUserId","switchToSessAuth","hashFromCookie","getUserHashCookie","CallTokenManager","setQueryParams","setChatId","SidePanel","Instance","disableAnchorBinding","user_hash","USER_ID","setLocalUserId","setCurrentUserId","getUserId","setUserToken","userToken","created","userCount","clearInterval","setInterval","LocalStorage","set","callEngine","getConferencePageTag","url","CallSettingsManager","jwtCallsEnabled","callTypeKey","ajax","runAction","entityType","entityId","provider","Bitrix","Permanent","success","call","SCHEME","jwt","instantiateCall","logToken","userData","users","connectionData","setTimeout","setConferenceStatus","setRestClient","setPullClient","unblockButtons","ImCallPullHandler","store","application","mutation","state","payload","type","fields","updateUserData","platform","isBitrixDesktop","Number","isNaN","sendLog","setButtonCounter","actionName","dialogMuted","previousCounter","isExternalUser","localUser","userModel","allowRename","emitToMainWindow","init","values","microphoneList","ConferenceErrorCode","missingMicrophone","checkAvailableCamera","checkAvailableMicrophone","enableMediaSelection","Events","deviceChanged","_onDeviceChange","isHttps","unsupportedBrowser","unsafeConnection","e","allAddedDevice","added","allRemovedDevice","removed","getRemovedUsedDevices","microphoneId","cameraId","speakerId","useDevicesInCurrentCall","UI","Notification","Center","notify","content","deviceInfo","label","position","autoHideDelay","closeButton","actions","events","click","balloon","close","removeDevicesFromCurrentCall","hasCamera","defaultCamera","cameraList","some","cameraItem","deviceId","hasMicrophone","defaultMicrophone","micItem","blockSwitchCamera","unblockSwitchCamera","blockSwitchMicrophone","unblockSwitchMicrophone","isCameraButtonHasBlocked","isButtonBlocked","onBlockCameraButton","onUnblockCameraButton","setDefaultCameraIfNeeded","isActiveState","$emit","updateButtons","onBlockMicrophoneButton","onUnblockMicrophoneButton","setDefaultMicrophoneIfNeeded","deviceList","isForceUse","i","kind","newDeviceId","getDefaultDeviceIdByGroupId","groupId","setMicrophoneId","setCameraId","isCameraOn","updateCameraSettingsInCurrentCallAfterReconnecting","setSpeakerId","microphoneIds","keys","includes","deviceGroup","getDeviceGroupIdByDeviceId","cameraIds","speakerIds","audioOutputList","videoEnabled","viewerMode","initCallPromise","getDialogData","setLayout","Grid","setUiState","Calling","showNotification","stopLocalVideoStream","callTokenPromise","getToken","setToken","createCall","getCallConfig","useHdVideo","clearTimeout","isTrackRecordOn","getters","appendUsers","getUsers","getCallUsers","releasePreCall","bindCallEvents","updateCallUser","microphoneState","isMicrophoneMuted","isNew","Analytics","onStartVideoconf","callId","uuid","withVideo","mediaParams","video","audio","AnalyticsStatus","isVpnActive","userCounter","associatedEntity","inviteUsers","answer","joinAsViewer","onJoinVideoconf","checkVpnStatus","isObject","JoinResponseError","onStartCallError","callType","AnalyticsType","videoconf","errorMessage","prop","getBoolean","setLocalUserDirection","RecvOnly","SendRecv","isLegacyCall","classic","getCallWithId","scheme","onJoinCallError","finishCall","onRecordStop","subSection","AnalyticsSubSection","contextMenu","element","AnalyticsElement","finishForAllButton","disconnectButton","recordTime","getRecordTimeText","info","setConferenceHasErrorInCall","wasConnected","getBrowserForStatistics","IsMobile","isConference","removeCallEvents","removeAdditionalEvents","hangup","destroy","location","href","releaseLocalMedia","closeReconnectionBaloon","userLeftCall","unsubscribe","trace","kickedFromCall","disconnect","endCall","includeSelf","userStates","activeUsers","Connected","Connecting","stream","getCurrentDeviceList","log","getTracks","tr","stop","micId","Enabled","articleCode","getFeature","InfoHelper","notificationText","Text","encode","Loc","getMessage","category","havePermissionToBroadcast","bindElement","buttons","microphone","elements","icon","targetContainer","createUnmuteButton","onClose","Button","baseClass","text","size","Size","EXTRA_SMALL","color","Color","LIGHT_BORDER","noCaps","round","onCallViewToggleMuteButtonClick","muted","screen","root","onCallViewToggleScreenSharingButtonClick","currentUserId","isCurrentUserPresenter","updatePreCallCounter","onUserStateChanged","onDestroy","setConferenceStartDate","startDate","userReadyToJoin","joinWithVideo","joinCall","removeEventListener","userInCallCount","getParticipatingUsers","strategyType","VideoStrategy","OnlySpeaker","AllowAll","setReconnectingCameraId","defaultSpeaker","setMainStream","turnOffParticipantStream","typeOfStream","fromUserId","getCurrentUserId","onTurnOffParticipantStream","_getCallIdentifier","getCallType","typeOfSetting","allowSpeakPermission","allow","onAllowPermissionToSpeakResponse","onDisallowPermissionToSpeakResponse","preferHdQuality","allowHdVideo","enableNoiseSuppression","allowNoiseSuppression","turnNoiseSuppression","enableMicAutoParameters","allowMicAutoParams","isCameraWasEnabledBeforeQualityChanged","videoQuality","otherUsers","setVideoQualityForStreams","setCameraSmoothingStatus","faceImproveEnabled","newName","renameGuestMobile","renameGuest","pinned","toggleRemoteParticipantVideo","participants","showVideo","renameRequested","setUserName","response","wasRenamed","renameSlider","buttonName","handlers","onCallViewHangupButtonClick","hangupOptions","_onCallViewHangupOptionsButtonClick","onCallViewCloseButtonClick","toggleMute","toggleScreenSharing","record","toggleVideo","onCallViewToggleVideoButtonClick","toggleSpeaker","onCallViewToggleSpeakerButtonClick","showChat","onCallViewShowChatButtonClick","toggleUsers","onCallViewToggleUsersButtonClick","share","onCallViewShareButtonClick","fullscreen","onCallViewFullScreenButtonClick","floorRequest","onCallViewFloorRequestButtonClick","feedback","onCallViewFeedbackButtonClick","callcontrol","_onCallcontrolButtonClick","onUserClick","onCallUserClick","copilot","onCallCopilotButtonClick","onDisconnectCall","finishButton","hangupOptionsMenu","targetNodeWidth","offsetWidth","menuItems","onclick","onFinishCall","finishedForAll","callUsersCount","callLength","getTimeText","PopupMenuWindow","className","background","contentBackground","darkMode","contentBorderRadius","borderRadius","angle","offsetTop","bindOptions","cacheable","subMenuOptions","maxWidth","onShow","popup","getTarget","getPopupContainer","style","display","offsetLeft","setOffset","setAngle","offset","items","onToggleMicrophone","_onCallViewToggleMuteHandler","Hardware","currentRoom","speaker","requestRoomSpeaker","setIsMicrophoneMuted","calledProgrammatically","floatingWindow","setAudioMuted","showRiseYouHandToTalkNotification","initiatorName","lastCalledChangeSettingsUserName","CallRecordMute","onScreenShareBtnClick","Limited","showFeatureLimitSlider","isScreenSharingStarted","stopScreenSharing","CallRecordStopSharing","startScreenSharing","togglePictureInPictureCallWindow","config","isActiveStatePictureInPictureCallWindow","isForceOpen","isForceClose","isActivePiPFromController","toggleStatePictureInPictureCallWindow","initialized","setIsCameraOn","onToggleCamera","_onCallViewToggleVideoButtonClickHandler","muteSpeaker","speakerMuted","fromHotKey","notifyWidth","clientWidth","Clipboard","copy","link","toggleFullScreen","activateWindow","changeTab","hide","isActive","setWindowFocusState","clearPictureInPictureDebounceForOpen","target","matches","onInputFileOpenedStateUpdate","onWindowDesktopFocus","updateWindowFocusState","onWindowDesktopBlur","webkitFullscreenElement","fullscreenElement","isFullScreen","exitFullScreen","enterFullScreen","requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","msExitFullscreen","cancelFullScreen","onShowChat","toggleUserList","canControlChangeSettings","participantsPermissionPopup","ParticipantsPermissionPopup","turnOffAllParticipansStream","_onCallViewTurnOffAllParticipansStreamButtonClick","onTurnOffAllParticipansStream","onPermissionChanged","changeSettings","settingEnabled","onCallSettingsChanged","_afterCloseParticipantsPermissionPopup","onOpen","_afterOpenParticipantsPermissionPopup","onOpenCallSettings","toggle","loadExt","Feedback","Form","open","instanceId","Math","random","forms","zones","sec","lang","presets","sender_page","call_type","call_amount","call_id","id_of_user","from_domain","origin","onClickUser","find","key","onChangeStateCopilot","updateCopilotActive","updateCopilotState","publishing","action","onFloorRequest","floorState","getUserFloorRequestState","talkingState","getUserTalking","setUserFloorRequestState","requestFloor","callViewFloorRequestTimeout","onUserInvited","onUserJoined","onUserMicrophoneState","onUserCameraState","onUserVideoPaused","onLocalMediaReceived","onLocalMediaStopped","onRemoteMediaReceived","onRemoteMediaStopped","onUserVoiceStarted","onUserVoiceStopped","onUserScreenState","onUserCommonRecordState","onCloudRecordStatusChanged","onUserFloorRequest","onJoin","onLeave","onConnectionQualityChanged","onToggleRemoteParticipantVideo","onSwitchTrackRecordStatus","onMicrophonePublishing","onTurnOnCamera","onAllParticipantsAudioMuted","onAllParticipantsVideoMuted","onAllParticipantsScreenshareMuted","onRoomSettingsChanged","onUserPermissionsChanged","onUserRoleChanged","onYouMuteAllParticipants","onParticipantMuted","unbind","addUser","undefined","loopConnectionQuality","clearConnectionQualityTimer","setUserConnectionQuality","Ready","previousState","initiatorId","setUserState","setUserMicrophoneState","setUserCameraState","cameraState","setUserVideoPaused","videoPaused","flipVideo","tag","mediaRenderer","enableMirroring","setLocalStream","flipLocalVideo","setButtonActive","Date","onScreenShareStarted","showWebScreenSharePopup","onScreenShareStopped","screenShareLength","callFromMobile","getVideoTracks","getStreamType","getAudioTracks","setUserMedia","track","setVideoRenderer","isLegacyPlainCall","Plain","isJwtInPlainCallsEnabled","isLegacyBitrixCall","quality","timeout","newQuality","score","updateMediaDevices","toogleParticipantsVideoBaloon","isVideoShown","autoHide","local","showMicMutedNotification","setUserTalking","talking","floorRequestState","_onUnblockCameraButton","_onBlockCameraButton","_onUnblockMicrophoneButton","_onBlockMicrophoneButton","userRegistry","get","getCustomMessage","gender","toUpperCase","reason","createCallControlNotify","isAllow","isRegularUser","getCurrentUserRole","contentIcon","contentPhrase","initiatorUserModel","targetUserModel","toUserId","initiatorGender","initiator_name","target_name","typesOfMute","typesOfMuteMessage","setUserPermissionToSpeakState","_onBlockUnblockCamMicButtons","updateFloorRequestNotification","eft","act","setAllUserPermissionToSpeakState","updateStatePermissions","callFolded","showAngle","customClassName","autoCloseDelay","customRender","handRaiseContentElement","Dom","props","children","buttonPlaceholder","getElementsByClassName","replaceWith","createAskSpeakButton","render","onAskSpeakButtonClicked","balloons","baloonId","classList","add","offsetClassNameSetted","remove","_p","balloonClassName","getActions","getContainer","html","getContent","isCloseButtonVisible","getCloseButton","setUserStats","report","setUserScreenState","screenState","requestActive","setMicrophoneLevel","level","getConnectedUserCount","isUnknownError","reportConnectionResult","ErrorUnexpectedAnswer","BlankAnswerWithErrorCode","BlankAnswer","AccessDenied","NoWebrtc","UnknownError","NetworkError","NotAllowedError","NotReadableError","AuthorizeError","showSelfTest","SecurityKeyChanged","showSecurityKeyError","showFatalError","autoCloseCallView","removeVideoStrategy","currentCallIsNew","getRestClient","Stopped","None","getActiveCallUsers","lastUserLeft","restart","changedValues","rightPanelMode","RightPanelMode","hidden","mode","chat","split","user","pinUser","unpinUser","dialogData","newUrl","history","pushState","checkIfMessageNotifyIsNeeded","purify","files","avatar","userName","senderId","system","messageAuthor","setHotKeyTemporaryBlock","reconnectionBaloon","devicesList","getCameraList","onReconnect","reconnectionReason","reconnectionReasonInfo","reconnectionEventCount","onReconnectError","currentError","conferenceStarted","hasErrorInCall","conferenceStartDate","chat_id","setPassword","dialog_id","getUserHash","callConfig","joinExisting","token","chatInfo","advanced","chatType","entityData1","entityData2","entityData3","avatarColor","roomId","startupErrorCode","protocol","userHash","cookie","Cookie","isValidApi","getDesktopVersion","serviceEnabled","tariffAvailable","Destroyed","IsVpnConnected","isPlainCall","AUDIO","VIDEO","blockButtons","setCloudRecordState","STARTED","sendLocalRecordState","Started","date","CallRecordStop","setCommonRecordState","getDefaultCommonRecordState","isAnyoneParticipating","hotkey","Video","Audio","showConfirmModal","yesButtonText","noButtonText","choice","Paused","Resumed","PAUSED","CallRecordPause","STOPPED","DESTROYED","onRecordBtnClick","openArticle","tariffSlider","showCloudRecordInfoPopup","isCloudRecordFeaturesEnabled","showCommonRecordMenuPopup","Helper","commonRecordState","onRecordResumed","onRecordStart","recordType","onRecordPaused","recordButton","onRecordDelete","isCloudRecordLogEnabled","justJoined","isCisRegion","showCommonRecordStartNotify","showCommonRecordStartModal","isCommonRecordStateInactive","structuredClone","notifyShowed","isStartedByMe","isStopped","dialogName","callDate","Main","format","formatRecordDate","fileName","replace","CallRecordStart","windowId","bxdWindowId","cropTop","cropBottom","shareMethod"],"mappings":"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"}