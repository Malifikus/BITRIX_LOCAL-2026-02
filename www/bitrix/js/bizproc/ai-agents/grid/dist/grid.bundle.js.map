{"version":3,"file":"grid.bundle.js","sources":["../src/field/base-field.js","../src/field/agent-info-field.js","../src/grid-icons.js","../src/constants.js","../src/field/photo-field.js","../src/field/used-by-field.js","../src/field/full-name-field.js","../src/field/employee-field.js","../src/api.js","../src/row-helper.js","../src/field/launch-control-field.js","../src/field/load-indicator-field.js","../src/action/base-action.js","../src/action/edit-action.js","../src/action/delete-action.js","../src/action/restart-action.js","../src/action/group/group-delete-action.js","../src/action/action-map.js","../src/action/action-factory.js","../src/handler/template-setup-handler.js","../src/grid-manager.js","../src/panel.js"],"sourcesContent":["import { Dom } from 'main.core';\n\nexport class BaseField\n{\n\t#fieldId: ?string;\n\t#gridId: ?string;\n\t#fieldNode: ?HTMLElement;\n\n\tconstructor(params: {\n\t\tfieldId: string,\n\t\tgridId: string,\n\t\tfieldNode: HTMLElement,\n\t}) {\n\t\tthis.#fieldId = params?.fieldId;\n\t\tthis.#gridId = params?.gridId;\n\t\tthis.#fieldNode = params?.fieldNode;\n\t}\n\n\tsetFieldNode(node: ?HTMLElement): void\n\t{\n\t\tthis.#fieldNode = node;\n\t}\n\n\tgetGridId(): string\n\t{\n\t\treturn this.#gridId;\n\t}\n\n\tgetFieldId(): string\n\t{\n\t\treturn this.#fieldId;\n\t}\n\n\tgetGrid(): BX.Main.grid | null\n\t{\n\t\tlet grid = null;\n\n\t\tif (this.#gridId)\n\t\t{\n\t\t\tgrid = BX.Main.gridManager.getById(this.#gridId);\n\t\t}\n\n\t\treturn grid?.instance;\n\t}\n\n\tgetFieldNode(): HTMLElement\n\t{\n\t\tif (!this.#fieldNode)\n\t\t{\n\t\t\tthis.#fieldNode = document.getElementById(this.getFieldId());\n\t\t}\n\n\t\treturn this.#fieldNode;\n\t}\n\n\tappendToFieldNode(element: HTMLElement): void\n\t{\n\t\tDom.append(element, this.getFieldNode());\n\t}\n}\n","import { Dom } from 'main.core';\nimport { Text as TypographyText } from 'ui.system.typography';\n\nimport type { AgentInfoFieldType } from '../types';\nimport { BaseField } from './base-field';\n\nexport class AgentInfoField extends BaseField\n{\n\trender(params: AgentInfoFieldType): void\n\t{\n\t\tconst nameNode = TypographyText.render(\n\t\t\tparams.name ?? '',\n\t\t\t{\n\t\t\t\tsize: 'md',\n\t\t\t\taccent: true,\n\t\t\t\ttag: 'div',\n\t\t\t\tclassName: 'bizproc-ai-agents-grid-agent-name bizproc-ai-agents-one-line-height',\n\t\t\t},\n\t\t);\n\n\t\tDom.attr(nameNode, 'data-test-id', 'bizproc-ai-agents-grid-agent-title');\n\n\t\tconst descriptionNode = TypographyText.render(\n\t\t\tparams.description ?? '',\n\t\t\t{\n\t\t\t\tsize: 'xs',\n\t\t\t\taccent: false,\n\t\t\t\ttag: 'div',\n\t\t\t\tclassName: 'bizproc-ai-agents-grid-agent-description bizproc-ai-agents-two-lines-height',\n\t\t\t},\n\t\t);\n\n\t\tthis.appendToFieldNode(nameNode);\n\t\tthis.appendToFieldNode(descriptionNode);\n\t}\n}\n","export default class GridIcons\n{\n\tstatic LOAD = `\n\t\t<svg class=\"agent-grid-load-icon\" width=\"28\" height=\"20\" viewBox=\"0 0 28 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t<g clip-path=\"url(#clip0_762_45517)\">\n\t\t\t\t<rect class=\"agent-grid-load-bar\" y=\"16\" width=\"4\" height=\"5\"/>\n\t\t\t</g>\n\t\t\t<g clip-path=\"url(#clip1_762_45517)\">\n\t\t\t\t<rect class=\"agent-grid-load-bar\" x=\"6\" y=\"12\" width=\"4\" height=\"10\"/>\n\t\t\t</g>\n\t\t\t<g clip-path=\"url(#clip2_762_45517)\">\n\t\t\t\t<rect class=\"agent-grid-load-bar\" x=\"12\" y=\"8\" width=\"4\" height=\"20\"/>\n\t\t\t</g>\n\t\t\t<g clip-path=\"url(#clip3_762_45517)\">\n\t\t\t\t<rect class=\"agent-grid-load-bar\" x=\"18\" y=\"-8\" width=\"4\" height=\"28\"/>\n\t\t\t</g>\n\t\t\t<g clip-path=\"url(#clip4_762_45517)\">\n\t\t\t\t<rect class=\"agent-grid-load-bar\" x=\"24\" width=\"4\" height=\"38\"/>\n\t\t\t</g>\n\t\t\t<defs>\n\t\t\t\t<clipPath id=\"clip0_762_45517\">\n\t\t\t\t<path d=\"M0 18C0 16.8954 0.895431 16 2 16C3.10457 16 4 16.8954 4 18V20H0V18Z\" fill=\"white\" />\n\t\t\t\t</clipPath>\n\t\t\t\t<clipPath id=\"clip1_762_45517\">\n\t\t\t\t<path d=\"M6 14C6 12.8954 6.89543 12 8 12C9.10457 12 10 12.8954 10 14V20H6V14Z\" fill=\"white\" />\n\t\t\t\t</clipPath>\n\t\t\t\t<clipPath id=\"clip2_762_45517\">\n\t\t\t\t<path d=\"M12 10C12 8.89543 12.8954 8 14 8C15.1046 8 16 8.89543 16 10V20H12V10Z\" fill=\"white\" />\n\t\t\t\t</clipPath>\n\t\t\t\t<clipPath id=\"clip3_762_45517\">\n\t\t\t\t<path d=\"M18 6C18 4.89543 18.8954 4 20 4C21.1046 4 22 4.89543 22 6V20H18V6Z\" fill=\"white\" />\n\t\t\t\t</clipPath>\n\t\t\t\t<clipPath id=\"clip4_762_45517\">\n\t\t\t\t<path d=\"M24 2C24 0.895431 24.8954 0 26 0C27.1046 0 28 0.895431 28 2V20H24V2Z\" fill=\"white\" />\n\t\t\t\t</clipPath>\n\t\t\t</defs>\n\t\t</svg>\n\t`;\n\n\tstatic AGENT_CHAT = `\n\t\t<svg class=\"agent-grid-chat-icon-img\" width=\"18\" height=\"18\" viewBox=\"0 0 18 18\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t<path\n\t\t\td=\"M10.1064 3.64648C11.349 3.64655 12.3564 4.65388 12.3564 5.89648V6.49707H13.0693C14.229 6.49707 15.1697 7.43706 15.1699 8.59668V11.3604C15.1699 12.1141 14.7723 12.7751 14.1758 13.1455V13.7129C14.1756 14.6424 13.0518 15.1075 12.3945 14.4502L11.4043 13.4609H8.83984C7.6802 13.4608 6.74023 12.52 6.74023 11.3604V8.59668C6.74045 7.43718 7.68033 6.49726 8.83984 6.49707H11.3066V5.89648C11.3066 5.23378 10.7691 4.69635 10.1064 4.69629H5.08008C4.41751 4.69649 3.88086 5.23386 3.88086 5.89648V8.82227C3.8809 9.26438 4.11903 9.65203 4.47949 9.86133L5.00293 10.165V11.6611L5.89355 10.7715V11.3203C5.89355 11.5894 5.96379 11.8422 6.08789 12.0605L5.73438 12.415C5.07702 13.0724 3.95312 12.6064 3.95312 11.6768V10.7695C3.28205 10.3802 2.83012 9.65397 2.83008 8.82227V5.89648C2.83008 4.65397 3.83761 3.64668 5.08008 3.64648H10.1064ZM8.83984 7.54688C8.26023 7.54706 7.79025 8.01707 7.79004 8.59668V11.3604C7.79004 11.9401 8.2601 12.41 8.83984 12.4102H11.8389L13.126 13.6973V12.5615L13.6221 12.2539C13.923 12.067 14.1191 11.7361 14.1191 11.3604V8.59668C14.1189 8.01696 13.6491 7.54688 13.0693 7.54688H8.83984Z\"\n\t\t\tfill=\"#525C69\"/>\n\t\t</svg>\n\t`;\n\n\tstatic DEPARTMENT = `\n\t\t\t<svg width=\"12\" height=\"10\" viewBox=\"0 0 12 10\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t    <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n\t\t        d=\"M1.95676 6.28648C2.77587 5.81165 3.78874 5.66414 4.70642 5.66414C5.62411 5.66414 6.63698 5.81165 7.45609 6.28648C8.29896 6.77509 8.90893 7.59628 9.0059 8.85475C9.03899 9.28426 8.68791 9.61043 8.29506 9.61043H1.11778C0.724933 9.61043 0.373856 9.28426 0.406952 8.85474C0.503923 7.59628 1.11389 6.77509 1.95676 6.28648ZM1.20349 8.82018H8.20935C8.11169 7.88548 7.66355 7.32017 7.05977 6.97016C6.41198 6.59465 5.55879 6.45438 4.70642 6.45438C3.85406 6.45438 3.00086 6.59465 2.35308 6.97016C1.7493 7.32017 1.30116 7.88548 1.20349 8.82018Z\"\n\t\t        fill=\"white\" />\n\t\t    <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n\t\t        d=\"M4.27024 0.867925C4.10176 0.923778 3.97998 0.989802 3.92655 1.02913C3.41436 1.40617 3.16091 2.22309 3.34019 3.03986C3.51311 3.82762 4.00839 4.31314 4.70162 4.31314C5.1431 4.31314 5.46803 4.12537 5.70647 3.81951C5.95916 3.49536 6.11633 3.02833 6.12825 2.53082C6.14018 2.03261 6.00512 1.58104 5.77044 1.2737C5.5543 0.990653 5.22474 0.786338 4.70165 0.786338C4.59177 0.786338 4.43616 0.812924 4.27024 0.867925ZM3.45807 0.392728C1.78723 1.62268 2.34174 5.10338 4.70162 5.10338C7.53484 5.10338 7.77944 -0.00390625 4.70165 -0.00390625C4.2688 -0.00390625 3.73551 0.188492 3.45807 0.392728Z\"\n\t\t        fill=\"white\" />\n\t\t    <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n\t\t        d=\"M7.35878 0.787574C7.84175 0.804938 8.15155 1.00343 8.35793 1.2737C8.59262 1.58104 8.72768 2.03261 8.71574 2.53082C8.70383 3.02833 8.54666 3.49536 8.29396 3.81951C8.05552 4.12537 7.73059 4.31314 7.28912 4.31314C7.25733 4.31314 7.22596 4.31212 7.19502 4.31009L6.67579 5.01706C6.86428 5.07305 7.06883 5.10338 7.28912 5.10338C10.1223 5.10338 10.3669 -0.00390625 7.28914 -0.00390625C7.10718 -0.00390625 6.90747 0.0300948 6.71648 0.084683L7.35878 0.787574ZM9.66755 9.61073H10.8825C11.2754 9.61073 11.6265 9.28456 11.5934 8.85505C11.4964 7.59658 10.8864 6.77539 10.0436 6.28678C9.43126 5.93184 8.71069 5.75979 8.00254 5.69554L9.00673 6.691C9.2353 6.76427 9.45073 6.85654 9.64725 6.97046C10.251 7.32047 10.6992 7.88578 10.7968 8.82049H9.66755V9.61073Z\"\n\t\t        fill=\"white\" />\n\t\t    <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n\t\t        d=\"M1.95676 6.28648C2.77587 5.81165 3.78874 5.66414 4.70642 5.66414C5.62411 5.66414 6.63698 5.81165 7.45609 6.28648C8.29896 6.77509 8.90893 7.59628 9.0059 8.85475C9.03899 9.28426 8.68791 9.61043 8.29506 9.61043H1.11778C0.724933 9.61043 0.373856 9.28426 0.406952 8.85474C0.503923 7.59628 1.11389 6.77509 1.95676 6.28648ZM1.20349 8.82018H8.20935C8.11169 7.88548 7.66355 7.32017 7.05977 6.97016C6.41198 6.59465 5.55879 6.45438 4.70642 6.45438C3.85406 6.45438 3.00086 6.59465 2.35308 6.97016C1.7493 7.32017 1.30116 7.88548 1.20349 8.82018Z\"\n\t\t        fill=\"white\" />\n\t\t    <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n\t\t        d=\"M4.27024 0.867925C4.10176 0.923778 3.97998 0.989802 3.92655 1.02913C3.41436 1.40617 3.16091 2.22309 3.34019 3.03986C3.51311 3.82762 4.00839 4.31314 4.70162 4.31314C5.1431 4.31314 5.46803 4.12537 5.70647 3.81951C5.95916 3.49536 6.11633 3.02833 6.12825 2.53082C6.14018 2.03261 6.00512 1.58104 5.77044 1.2737C5.5543 0.990653 5.22474 0.786338 4.70165 0.786338C4.59177 0.786338 4.43616 0.812924 4.27024 0.867925ZM3.45807 0.392728C1.78723 1.62268 2.34174 5.10338 4.70162 5.10338C7.53484 5.10338 7.77944 -0.00390625 4.70165 -0.00390625C4.2688 -0.00390625 3.73551 0.188492 3.45807 0.392728Z\"\n\t\t        fill=\"white\" />\n\t\t    <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n\t\t        d=\"M7.35878 0.787574C7.84175 0.804938 8.15155 1.00343 8.35793 1.2737C8.59262 1.58104 8.72768 2.03261 8.71574 2.53082C8.70383 3.02833 8.54666 3.49536 8.29396 3.81951C8.05552 4.12537 7.73059 4.31314 7.28912 4.31314C7.25733 4.31314 7.22596 4.31212 7.19502 4.31009L6.67579 5.01706C6.86428 5.07305 7.06883 5.10338 7.28912 5.10338C10.1223 5.10338 10.3669 -0.00390625 7.28914 -0.00390625C7.10718 -0.00390625 6.90747 0.0300948 6.71648 0.084683L7.35878 0.787574ZM9.66755 9.61073H10.8825C11.2754 9.61073 11.6265 9.28456 11.5934 8.85505C11.4964 7.59658 10.8864 6.77539 10.0436 6.28678C9.43126 5.93184 8.71069 5.75979 8.00254 5.69554L9.00673 6.691C9.2353 6.76427 9.45073 6.85654 9.64725 6.97046C10.251 7.32047 10.6992 7.88578 10.7968 8.82049H9.66755V9.61073Z\"\n\t\t        fill=\"white\" />\n\t\t</svg>\n\t`;\n}\n","export const AJAX_REQUEST_TYPE = {\n\tCOMPONENT: 'component',\n\tCONTROLLER: 'controller',\n};\n\nexport const ACTION_TYPE = {\n\tDELETE: 'delete',\n\tGROUP_DELETE: 'group-delete',\n\tEDIT: 'edit',\n\tRESTART: 'restart',\n};\n\nexport const TEMPLATE_SETUP_EVENT_NAME = {\n\tSUCCESS: 'Bizproc.AiAgentsGrid.TemplateSetup:success',\n};\n\nexport const USER_MINI_PROFILE_ATTRIBUTES = {\n\tUSER_ID: 'bx-tooltip-user-id',\n\tCONTEXT: 'bx-tooltip-context',\n};\n\nexport const USER_MINI_PROFILE_CONTEXT = {\n\tB24: 'b24',\n};\n","import { Dom } from 'main.core';\nimport { AvatarRound } from 'ui.avatar';\n\nimport { EmployeeFieldType } from '../types';\nimport { BaseField } from './base-field';\n\nexport class PhotoField extends BaseField\n{\n\trender(params: EmployeeFieldType): void\n\t{\n\t\tconst avatarOptions = {\n\t\t\tsize: 24,\n\t\t\tuserpicPath: params?.user?.photoUrl,\n\t\t};\n\n\t\tconst avatar = new AvatarRound(avatarOptions);\n\n\t\tthis.addMiniProfile(params);\n\n\t\tavatar?.renderTo(this.getFieldNode());\n\n\t\tDom.addClass(this.getFieldNode(), 'agent-grid_user-photo');\n\t}\n\n\taddMiniProfile(params: EmployeeFieldType): void\n\t{\n\t\tDom.attr(this.getFieldNode(), 'bx-tooltip-user-id', params?.user?.id);\n\t\tDom.attr(this.getFieldNode(), 'bx-tooltip-context', 'b24');\n\t}\n}\n","import { Popup } from 'main.popup';\nimport { Tag, Dom, Text, Event, Type } from 'main.core';\n\nimport { Text as TypographyText } from 'ui.system.typography';\n\nimport { Messenger } from 'im.public';\n\nimport { Structure } from 'humanresources.company-structure.public';\n\nimport type { UsedByFieldFieldType, UserFieldType, DepartmentFieldType } from '../types';\nimport GridIcons from '../grid-icons';\nimport { BaseField } from './base-field';\nimport { PhotoField } from './photo-field';\n\nexport class UsedByField extends BaseField\n{\n\tstatic MAX_VISIBLE_AVATARS_COMBINED = 3;\n\tstatic MAX_VISIBLE_AVATARS_USERS_ONLY = 5;\n\tstatic MAX_COUNTER_VALUE = 99;\n\n\t#combinedPopup: Popup | null;\n\n\trender(params: UsedByFieldFieldType): void\n\t{\n\t\tconst { users = [], chatId, chatName, departments = {} } = params;\n\n\t\tconst container = Tag.render`\n\t\t\t<div class=\"agent-grid-used-by-container\"></div>\n\t\t`;\n\n\t\tconst hasUsers = users && users.length > 0;\n\t\tconst hasDepartments = departments && Object.keys(departments).length > 0;\n\n\t\tif (hasUsers && hasDepartments)\n\t\t{\n\t\t\tthis.#renderCombinedView(container, departments, users);\n\t\t}\n\t\telse if (hasDepartments)\n\t\t{\n\t\t\tthis.#renderDepartmentsOnlyView(container, departments, users);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#renderUsersOnlyView(container, departments, users);\n\t\t}\n\n\t\tthis.#createChatNode(container, chatId, chatName);\n\n\t\tthis.appendToFieldNode(container);\n\t}\n\n\t#renderCombinedView(\n\t\tcontainer: HTMLElement,\n\t\tdepartments: DepartmentFieldType[],\n\t\tusers: UserFieldType[],\n\t): void\n\t{\n\t\tDom.addClass(container, 'agent-grid-used-by-container-with-users-and-departments');\n\n\t\tthis.#createDepartmentsCounter(container, departments, users, UsedByField.MAX_VISIBLE_AVATARS_COMBINED);\n\t\tthis.#createAvatarsContainer(container, departments, users, UsedByField.MAX_VISIBLE_AVATARS_COMBINED);\n\t}\n\n\t#renderUsersOnlyView(\n\t\tcontainer: HTMLElement,\n\t\tdepartments: DepartmentFieldType[],\n\t\tusers: UserFieldType[],\n\t): void\n\t{\n\t\tthis.#createAvatarsContainer(container, departments, users, UsedByField.MAX_VISIBLE_AVATARS_USERS_ONLY);\n\t}\n\n\t#renderDepartmentsOnlyView(\n\t\tcontainer: HTMLElement,\n\t\tdepartments: DepartmentFieldType[],\n\t\tusers: UserFieldType[],\n\t): void\n\t{\n\t\tthis.#createDepartmentsNode(container, departments, users);\n\t}\n\n\t#createAvatarsContainer(\n\t\tcontainer: HTMLElement,\n\t\tdepartments: DepartmentFieldType[],\n\t\tusers: UserFieldType[],\n\t\tmaxVisibleAvatars: number,\n\t): void\n\t{\n\t\tconst placeholderAvatarsCount = 3;\n\t\tconst avatarsContainer = Tag.render`<div data-test-id=\"bizproc-ai-agents-grid-used-by-avatars-container\" class=\"agent-grid-user-avatars\"></div>`;\n\n\t\tif (!users || users.length === 0)\n\t\t{\n\t\t\tfor (let i = 0; i < placeholderAvatarsCount; i++)\n\t\t\t{\n\t\t\t\tconst avatarContainer = Tag.render`<span></span>`;\n\t\t\t\tDom.append(avatarContainer, avatarsContainer);\n\n\t\t\t\t(new PhotoField({ fieldNode: avatarContainer })).render({});\n\t\t\t}\n\t\t\tDom.append(avatarsContainer, container);\n\n\t\t\treturn;\n\t\t}\n\n\t\tusers.slice(0, maxVisibleAvatars).forEach((user) => {\n\t\t\tconst avatarContainer = Tag.render`<span></span>`;\n\t\t\tDom.append(avatarContainer, avatarsContainer);\n\n\t\t\t(new PhotoField({ fieldNode: avatarContainer })).render({ user });\n\t\t});\n\n\t\tif (users.length > maxVisibleAvatars)\n\t\t{\n\t\t\tconst remainingCount = users.length - maxVisibleAvatars;\n\t\t\tconst counterClass = 'agent-grid-avatar-counter-number';\n\t\t\tconst counterWrapperClass = 'agent-grid-avatar-counter';\n\n\t\t\tconst counter = this.#createCounterNode(\n\t\t\t\tremainingCount,\n\t\t\t\tdepartments,\n\t\t\t\tusers,\n\t\t\t\tcounterClass,\n\t\t\t\tcounterWrapperClass,\n\t\t\t);\n\n\t\t\tDom.append(counter, avatarsContainer);\n\t\t}\n\n\t\tDom.append(avatarsContainer, container);\n\t}\n\n\t#createDepartmentsCounter(\n\t\tcontainer: HTMLElement,\n\t\tdepartments: DepartmentFieldType[],\n\t\tusers: UserFieldType[],\n\t\tmaxVisibleAvatars: ?number,\n\t): void\n\t{\n\t\tconst departmentsCount = Object.keys(departments).length;\n\t\tif (departmentsCount === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet withOpenPopupEvent = true;\n\n\t\tif (\n\t\t\tmaxVisibleAvatars\n\t\t\t&& users?.length > maxVisibleAvatars\n\t\t)\n\t\t{\n\t\t\twithOpenPopupEvent = false;\n\t\t}\n\n\t\tconst counterClass = 'agent-grid-department-counter agent-grid-department-counter-with-users';\n\t\tconst counterWrapperClass = '';\n\t\tconst withPlusPrefix = false;\n\t\tconst counterNode = this.#createCounterNode(\n\t\t\tdepartmentsCount,\n\t\t\tdepartments,\n\t\t\tusers,\n\t\t\tcounterClass,\n\t\t\tcounterWrapperClass,\n\t\t\twithPlusPrefix,\n\t\t\twithOpenPopupEvent,\n\t\t);\n\n\t\tif (counterNode)\n\t\t{\n\t\t\tDom.append(counterNode, container);\n\t\t}\n\t}\n\n\t#createDepartmentsNode(\n\t\tcontainer: HTMLElement,\n\t\tdepartments: ?DepartmentFieldType[],\n\t\tusers: UserFieldType[],\n\t): void\n\t{\n\t\tif (!departments)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst departmentIds = Object.keys(departments);\n\t\tconst departmentsCount = departmentIds.length;\n\n\t\tif (departmentsCount === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst firstDepartmentId = Text.toInteger(departmentIds[0]);\n\t\tconst firstDepartmentName = departments[firstDepartmentId] ?? '';\n\t\tconst departmentNode = this.#getDepartmentNode(firstDepartmentName, firstDepartmentId);\n\n\t\tif (departmentsCount > 1)\n\t\t{\n\t\t\tconst remainingCount = departmentsCount - 1;\n\t\t\tconst counterClass = 'agent-grid-department-counter-number';\n\t\t\tconst counterWrapperClass = 'agent-grid-department-counter';\n\n\t\t\tconst counterNode = this.#createCounterNode(\n\t\t\t\tremainingCount,\n\t\t\t\tdepartments,\n\t\t\t\tusers,\n\t\t\t\tcounterClass,\n\t\t\t\tcounterWrapperClass,\n\t\t\t);\n\n\t\t\tif (counterNode)\n\t\t\t{\n\t\t\t\tDom.append(counterNode, departmentNode);\n\t\t\t}\n\t\t}\n\n\t\tDom.append(departmentNode, container);\n\t}\n\n\t#getDisplayedNumber(remainingCount: number): number\n\t{\n\t\treturn remainingCount > UsedByField.MAX_COUNTER_VALUE\n\t\t\t? UsedByField.MAX_COUNTER_VALUE\n\t\t\t: remainingCount\n\t\t;\n\t}\n\n\t#createCounterNode(\n\t\tcount: number,\n\t\tdepartments: DepartmentFieldType[],\n\t\tusers: UserFieldType[],\n\t\tcounterClassName: string = '',\n\t\tcounterWrapperClassName: string = '',\n\t\twithPlusPrefix = true,\n\t\twithOpenPopupEvent = true,\n\t): null | HTMLElement\n\t{\n\t\tif (count <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst counterWrapper = Tag.render`<div class=\"${counterWrapperClassName}\"></div>`;\n\n\t\tconst displayedNumber = this.#getDisplayedNumber(count);\n\t\tlet counterText = String(displayedNumber);\n\t\tif (withPlusPrefix)\n\t\t{\n\t\t\tcounterText = `+${counterText}`;\n\t\t}\n\n\t\tconst numberNode = TypographyText.render(\n\t\t\tcounterText,\n\t\t\t{\n\t\t\t\tsize: '3xs',\n\t\t\t\taccent: false,\n\t\t\t\ttag: 'span',\n\t\t\t\tclassName: counterClassName,\n\t\t\t},\n\t\t);\n\n\t\tDom.append(numberNode, counterWrapper);\n\n\t\tif (withOpenPopupEvent)\n\t\t{\n\t\t\tEvent.bind(counterWrapper, 'click', (event) => {\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tthis.#toggleCombinedPopup(departments, users, counterWrapper);\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(numberNode, 'agent-grid-counter-default-cursor');\n\t\t}\n\n\t\treturn counterWrapper;\n\t}\n\n\t#toggleCombinedPopup(\n\t\tdepartments: DepartmentFieldType[],\n\t\tusers: UserFieldType[],\n\t\tbindElement: HTMLElement,\n\t): void\n\t{\n\t\tif (this.#combinedPopup && this.#combinedPopup.isShown())\n\t\t{\n\t\t\tthis.#combinedPopup.close();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#openCombinedPopup(departments, users, bindElement);\n\t\t}\n\t}\n\n\t#createChatNode(\n\t\tcontainer: HTMLElement,\n\t\tchatId: ?string,\n\t\tchatName: ?string,\n\t): void\n\t{\n\t\tif (!chatId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst chatNameNode = TypographyText.render(\n\t\t\tchatName || '',\n\t\t\t{\n\t\t\t\tsize: '2xs',\n\t\t\t\taccent: false,\n\t\t\t\ttag: 'span',\n\t\t\t\tclassName: 'agent-grid-chat-name',\n\t\t\t},\n\t\t);\n\n\t\tconst encodedChatName = Text.encode(chatName || '');\n\t\tconst chatContainer = Tag.render`\n\t\t\t<div class=\"agent-grid-chat-container\" title=\"${encodedChatName}\">\n\t\t\t\t${GridIcons.AGENT_CHAT}\n\t\t\t\t<a href=\"#\" class=\"agent-grid-chat-link\">\n\t\t\t\t\t${chatNameNode}\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(chatContainer, 'click', (event) => {\n\t\t\tevent.preventDefault();\n\t\t\tthis.openChat(chatId);\n\t\t});\n\n\t\tDom.append(chatContainer, container);\n\t}\n\n\topenChat(chatId: string): void\n\t{\n\t\tif (!chatId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tMessenger.openChat(chatId);\n\t}\n\n\t#openCombinedPopup(\n\t\tdepartments: ?DepartmentFieldType[],\n\t\tusers: UserFieldType[],\n\t\tbindElement: HTMLElement,\n\t)\n\t{\n\t\tconst contentNode = Tag.render`<div class=\"agent-grid-departments-list-wrapper\"></div>`;\n\n\t\tthis.#fillDepartmentsListContent(departments, contentNode);\n\t\tthis.#fillUsersListContent(users, contentNode);\n\n\t\tthis.#combinedPopup = new Popup({\n\t\t\tcontent: contentNode,\n\t\t\tbindElement,\n\t\t\tcacheable: false,\n\t\t\tminWidth: 300,\n\t\t\tminHeight: 50,\n\t\t\tmaxWidth: 400,\n\t\t\tmaxHeight: 200,\n\t\t\tpadding: 0,\n\t\t\tautoHide: true,\n\t\t\tclassName: 'agents-grid-popup',\n\t\t});\n\n\t\tthis.#combinedPopup.show();\n\t\tthis.#combinedPopup.subscribe('onClose', () => {\n\t\t\tthis.#combinedPopup = null;\n\t\t});\n\t}\n\n\t#fillDepartmentsListContent(\n\t\tdepartments: DepartmentFieldType[],\n\t\tcontentNode: HTMLElement,\n\t): HTMLElement\n\t{\n\t\tif (!departments || Object.keys(departments).length === 0)\n\t\t{\n\t\t\treturn contentNode;\n\t\t}\n\n\t\tObject.entries(departments).forEach(([id, name]) => {\n\t\t\tconst nodeId = Text.toInteger(id);\n\t\t\tconst departmentNode = this.#getDepartmentNode(name, nodeId, true);\n\t\t\tDom.append(departmentNode, contentNode);\n\t\t});\n\n\t\treturn contentNode;\n\t}\n\n\t#getDepartmentNode(\n\t\tdepartment: string,\n\t\tnodeId: number,\n\t\tshouldAddHover: boolean = false,\n\t): HTMLElement\n\t{\n\t\tconst departmentWrapper = Tag.render`\n\t\t\t<div class=\"${shouldAddHover ? 'agent-grid-department-in-list' : 'agent-grid-department'}\"></div>\n\t\t`;\n\t\tconst circle = Tag.render`<div class=\"agent-grid-department-circle\">${GridIcons.DEPARTMENT}</div>`;\n\t\tconst label = TypographyText.render(\n\t\t\tdepartment,\n\t\t\t{\n\t\t\t\tsize: 'xs',\n\t\t\t\taccent: false,\n\t\t\t\ttag: 'span',\n\t\t\t\tclassName: 'agent-grid-department-label',\n\t\t\t},\n\t\t);\n\n\t\tDom.attr(label, 'title', department);\n\t\tDom.append(circle, departmentWrapper);\n\t\tDom.append(label, departmentWrapper);\n\n\t\tEvent.bind(departmentWrapper, 'click', (event: MouseEvent) => {\n\t\t\tevent.stopPropagation();\n\n\t\t\tStructure?.open({\n\t\t\t\tfocusNodeId: nodeId,\n\t\t\t});\n\t\t});\n\n\t\treturn departmentWrapper;\n\t}\n\n\t#fillUsersListContent(\n\t\tusers: UserFieldType[],\n\t\tcontentNode: HTMLElement,\n\t): HTMLElement\n\t{\n\t\tif (!users || users.length === 0)\n\t\t{\n\t\t\treturn contentNode;\n\t\t}\n\n\t\tusers.forEach((user) => {\n\t\t\tconst departmentNode = this.#getUserWithNameNode(user, true);\n\t\t\tDom.append(departmentNode, contentNode);\n\t\t});\n\n\t\treturn contentNode;\n\t}\n\n\t#getUserWithNameNode(user: UserFieldType): HTMLElement\n\t{\n\t\tconst userFullName = user?.fullName || '';\n\t\tconst userWrapper = Tag.render`<div title=\"${userFullName}\" class=\"agent-grid-user-in-list\"></div>`;\n\t\tconst imageWrapper = Tag.render`<div class=\"agent-grid-user-img-container\"></div>`;\n\n\t\tnew PhotoField({ fieldNode: imageWrapper }).render({ user });\n\n\t\tconst label = TypographyText.render(\n\t\t\tuserFullName,\n\t\t\t{\n\t\t\t\tsize: 'xs',\n\t\t\t\taccent: false,\n\t\t\t\ttag: 'span',\n\t\t\t\tclassName: 'agent-grid-user-full-name',\n\t\t\t},\n\t\t);\n\n\t\tEvent.bind(userWrapper, 'click', () => this.#openUserProfile(user?.profileLink));\n\n\t\tDom.append(imageWrapper, userWrapper);\n\t\tDom.append(label, userWrapper);\n\n\t\treturn userWrapper;\n\t}\n\n\t#openUserProfile(profileLink: ?string): void\n\t{\n\t\tif (Type.isStringFilled(profileLink))\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(profileLink);\n\t\t}\n\t}\n}\n","import { Tag, Loc, Dom } from 'main.core';\nimport { Text as TypographyText } from 'ui.system.typography';\n\nimport { BaseField } from './base-field';\nimport { EmployeeFieldType } from '../types';\nimport { USER_MINI_PROFILE_ATTRIBUTES, USER_MINI_PROFILE_CONTEXT } from '../constants';\n\nexport class FullNameField extends BaseField\n{\n\trender(params: EmployeeFieldType): void\n\t{\n\t\tconst user = params?.user ?? {};\n\t\tconst fullName = user.fullName ?? Loc.getMessage('BIZPROC_AI_AGENTS_LAUNCHED_BY_PLACEHOLDER');\n\t\tconst profileLink = user.profileLink ?? null;\n\t\tconst userId = user.id ?? null;\n\n\t\tconst fullNameElement = this.#createFullNameElement(fullName, userId, profileLink);\n\n\t\tconst container = Tag.render`\n\t\t\t<div class=\"agent-grid_full-name-container\">${fullNameElement}</div>\n\t\t`;\n\n\t\tthis.appendToFieldNode(container);\n\t}\n\n\t#createFullNameElement(fullName: string, userId: ?string, profileLink: ?string): HTMLElement\n\t{\n\t\tconst typographyOptions = {\n\t\t\tsize: 'xs',\n\t\t\taccent: false,\n\t\t\ttag: 'span',\n\t\t\tclassName: 'agent-grid_full-name-label',\n\t\t};\n\n\t\tconst nameNode = TypographyText.render(fullName, typographyOptions);\n\n\t\tDom.attr(nameNode, USER_MINI_PROFILE_ATTRIBUTES.USER_ID, userId);\n\t\tDom.attr(nameNode, USER_MINI_PROFILE_ATTRIBUTES.CONTEXT, USER_MINI_PROFILE_CONTEXT.B24);\n\n\t\tif (!profileLink)\n\t\t{\n\t\t\tDom.addClass(nameNode, 'agent-grid_full-name-label-placeholder');\n\n\t\t\treturn nameNode;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<a href=\"${profileLink}\" class=\"agent-grid_full-name-link\">\n\t\t\t\t${nameNode}\n\t\t\t</a>\n\t\t`;\n\t}\n}\n","import { Tag, Text, Dom } from 'main.core';\n\nimport type { EmployeeFieldType } from '../types';\nimport { PhotoField } from './photo-field';\nimport { FullNameField } from './full-name-field';\nimport { BaseField } from './base-field';\n\nexport class EmployeeField extends BaseField\n{\n\trender(params: EmployeeFieldType): void\n\t{\n\t\tconst photoFieldId = Text.getRandom(6);\n\t\tconst fullNameFieldId = Text.getRandom(6);\n\t\tthis.appendToFieldNode(Tag.render`<span id=\"${photoFieldId}\"></span>`);\n\t\tthis.appendToFieldNode(Tag.render`<span class=\"agent-grid_full-name-wrapper\" id=\"${fullNameFieldId}\"></span>`);\n\n\t\t(new PhotoField({ fieldId: photoFieldId })).render(params);\n\t\t(new FullNameField({ fieldId: fullNameFieldId })).render(params);\n\n\t\tDom.addClass(this.getFieldNode(), 'agent-grid_employee-card-container');\n\n\t\tDom.attr(this.getFieldNode(), 'data-test-id', 'bizproc-ai-agents-grid-started-by-employee-card');\n\t}\n}\n","import { ajax } from 'main.core';\nimport { CopyAndStartActionResponse, FetchAiAgentRowResponse } from './types';\n\nconst post = async (action: string, data: Object): Promise => {\n\tconst response = await ajax.runAction(`bizproc.v2.${action}`, {\n\t\tmethod: 'POST',\n\t\tjson: data || {},\n\t});\n\n\tif (response.status === 'success')\n\t{\n\t\treturn response.data;\n\t}\n\n\treturn null;\n};\n\nconst gridApi: { ... } = {\n\tstartTemplate: (templateId: number): Promise<void> => {\n\t\treturn post('Integration.AiAgent.Template.start', { templateId });\n\t},\n\tcopyAndStartTemplate: (templateId: number): Promise<CopyAndStartActionResponse> => {\n\t\treturn post('Integration.AiAgent.Template.copyAndStart', { templateId });\n\t},\n\tfetchRow: (templateId: number): Promise<FetchAiAgentRowResponse> => {\n\t\treturn post('Integration.AiAgent.Template.fetchRow', { templateId });\n\t},\n};\n\nexport {\n\tgridApi,\n\tpost,\n};\n","import { Dom } from 'main.core';\nimport type { GridColumns, GridRowAction, AddRowOptions } from './types';\n\nexport class RowHelper\n{\n\t#grid: BX.Main.grid;\n\n\tconstructor(grid: ?BX.Main.grid)\n\t{\n\t\tthis.#grid = grid;\n\t}\n\n\tsetGrid(grid: BX.Main.grid)\n\t{\n\t\tthis.#grid = grid;\n\t}\n\n\tstatic prepareNewRowParams(\n\t\tcolumns: GridColumns,\n\t\trowActions: GridRowAction[],\n\t): AddRowOptions\n\t{\n\t\treturn {\n\t\t\tid: columns?.ID,\n\t\t\tcolumns,\n\t\t\tactions: rowActions,\n\t\t\tprepend: true,\n\t\t\tanimation: true,\n\t\t};\n\t}\n\n\tgetByTemplateId(templateId: string | number): ?BX.Grid.Row\n\t{\n\t\tconst rowsCollectionWrapper: BX.Grid.Rows = this.#grid?.getRows();\n\n\t\treturn rowsCollectionWrapper?.getById(templateId);\n\t}\n\n\tmarkAsLoading(row: BX.Grid.Row): void\n\t{\n\t\tif (!row)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\trow.stateLoad();\n\t}\n\n\tmarkAsLoaded(row)\n\t{\n\t\tif (!row)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\trow.stateUnload();\n\t}\n\n\taddToGrid(addRowOptions: AddRowOptions): void\n\t{\n\t\tthis.#grid?.getRealtime()?.addRow(addRowOptions);\n\t}\n\n\tupdate(\n\t\trow: BX.Grid.Row,\n\t\tupdateColumns: GridColumns,\n\t): void\n\t{\n\t\tif (!row)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\trow.setCellsContent(updateColumns);\n\t}\n\n\thighlight(row: BX.Grid.Row): void\n\t{\n\t\tif (!row)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(row.getNode(), 'ai-agents-grid-row-highlighted');\n\t\tsetTimeout(() => {\n\t\t\tDom.removeClass(row, 'ai-agents-grid-row-highlighted');\n\t\t}, 2500);\n\t}\n}\n","import { Dom, Loc, Type } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\nimport { Button, ButtonSize } from 'ui.buttons';\nimport { Text as TypographyText } from 'ui.system.typography';\nimport { gridApi as Api } from '../api';\nimport { RowHelper } from '../row-helper';\n\nimport type { LaunchControlFieldType } from '../types';\nimport { BaseField } from './base-field';\n\nexport class LaunchControlField extends BaseField\n{\n\trender(params: LaunchControlFieldType): void\n\t{\n\t\tif (Type.isNumber(params.launchedAt) && params.launchedAt > 0)\n\t\t{\n\t\t\tthis.#renderLaunchedDate(params.launchedAt);\n\t\t}\n\t\telse if (Type.isNumber(params.agentId))\n\t\t{\n\t\t\tthis.#renderLaunchButton(params);\n\t\t}\n\t}\n\n\t#renderLaunchButton(params: { agentId: number }): void\n\t{\n\t\tconst button = new Button({\n\t\t\ttext: Loc.getMessage('BIZPROC_AI_AGENTS_BUTTON_LAUNCH'),\n\t\t\tsize: ButtonSize.SMALL,\n\t\t\ttag: Button.Tag.DIV,\n\t\t\tuseAirDesign: true,\n\t\t\tonclick: async (buttonInstance: Button, event): Promise<void> => {\n\t\t\t\tconst grid = this.getGrid();\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tbuttonInstance.setWaiting(true);\n\n\t\t\t\tgrid?.tableFade();\n\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tconst result = await Api.copyAndStartTemplate(params.agentId);\n\t\t\t\t\tbuttonInstance.setWaiting(false);\n\n\t\t\t\t\tconst columns = result?.columns;\n\t\t\t\t\tconst actions = result?.actions;\n\n\t\t\t\t\tconst newRowFields = RowHelper.prepareNewRowParams(\n\t\t\t\t\t\tcolumns,\n\t\t\t\t\t\tactions,\n\t\t\t\t\t);\n\n\t\t\t\t\tgrid?.tableUnfade();\n\n\t\t\t\t\tnew RowHelper(grid).addToGrid(newRowFields);\n\t\t\t\t}\n\t\t\t\tcatch (error)\n\t\t\t\t{\n\t\t\t\t\tbuttonInstance.setWaiting(false);\n\t\t\t\t\tlet message = error?.errors?.[0]?.message;\n\t\t\t\t\tif (!message)\n\t\t\t\t\t{\n\t\t\t\t\t\tmessage = Loc.getMessage('BIZPROC_AI_AGENTS_BUTTON_LAUNCH_ERROR');\n\t\t\t\t\t}\n\n\t\t\t\t\tgrid?.tableUnfade();\n\t\t\t\t\tBX.UI.Notification.Center.notify({ content: message });\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\n\t\tDom.attr(button.getContainer(), 'data-test-id', 'bizproc-ai-agents-grid-action-start-button');\n\n\t\tthis.appendToFieldNode(button.render());\n\t}\n\n\t#renderLaunchedDate(timestamp: number): void\n\t{\n\t\tconst formattedDate = DateTimeFormat.format('j F, G:i', timestamp);\n\n\t\tconst dateNode = TypographyText.render(\n\t\t\tformattedDate,\n\t\t\t{\n\t\t\t\tsize: 'xs',\n\t\t\t\ttag: 'div',\n\t\t\t\tclassName: 'launch-control-field-date',\n\t\t\t},\n\t\t);\n\n\t\tDom.attr(dateNode, 'data-test-id', 'bizproc-ai-agents-grid-started-at');\n\n\t\tthis.appendToFieldNode(dateNode);\n\t}\n}\n","import { Tag, Dom } from 'main.core';\nimport { Text as TypographyText } from 'ui.system.typography';\n\nimport GridIcons from '../grid-icons';\nimport type { LoadIndicatorFieldType } from '../types';\nimport { BaseField } from './base-field';\n\nexport class LoadIndicatorField extends BaseField\n{\n\trender(params: LoadIndicatorFieldType): void\n\t{\n\t\tconst percentage = Number.isFinite(params?.percentage) ? params.percentage : 0;\n\t\tconst showPercentage = percentage > 0;\n\t\tlet percentageNode = null;\n\n\t\tconst percentPerBar = 20;\n\t\tconst activeBarsCount = Math.ceil(percentage / percentPerBar);\n\n\t\tconst svgNode = Tag.render`<div>${GridIcons.LOAD}</div>`;\n\n\t\tconst bars = svgNode.querySelectorAll('.agent-grid-load-bar');\n\t\tbars.forEach((bar, index) => {\n\t\t\tconst currentBarIndex = index + 1;\n\t\t\tif (currentBarIndex <= activeBarsCount && percentage > 0)\n\t\t\t{\n\t\t\t\tDom.addClass(bar, '--active');\n\t\t\t}\n\n\t\t\tDom.style(bar, '--level', currentBarIndex);\n\t\t});\n\n\t\tif (showPercentage)\n\t\t{\n\t\t\tconst percentageNodeText = `${percentage}%`;\n\n\t\t\tpercentageNode = TypographyText.render(\n\t\t\t\tpercentageNodeText,\n\t\t\t\t{\n\t\t\t\t\tsize: 'xs',\n\t\t\t\t\taccent: false,\n\t\t\t\t\ttag: 'div',\n\t\t\t\t\tclassName: 'agent-grid-load-percentage',\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\tconst container = Tag.render`\n\t\t\t<div class=\"agent-grid-load-indicator\">\n\t\t\t  ${percentageNode ?? ''}\n\t\t\t  <div\n\t\t\t\tclass=\"agent-grid-load-container\"\n\t\t\t  >\n\t\t\t\t${svgNode}\n\t\t\t  </div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.appendToFieldNode(container);\n\t}\n}\n","import { Loc, Type } from 'main.core';\nimport { MessageBox } from 'ui.dialogs.messagebox';\n\nimport type {\n\tActionConfig,\n\tBaseActionType,\n} from '../types';\n\nimport { AJAX_REQUEST_TYPE } from '../constants';\n\n/**\n * @abstract\n */\nexport class BaseAction\n{\n\tgrid: ?BX.Main.grid;\n\tfilter: ?Object;\n\tshowPopups: ?boolean;\n\n\t/**\n\t * @abstract\n\t */\n\tstatic getActionId(): string\n\t{\n\t\tthrow new Error('not implemented');\n\t}\n\n\t/**\n\t * @returns {ActionConfig}\n\t */\n\tgetActionConfig(): ActionConfig\n\t{\n\t\tthrow new Error('not implemented');\n\t}\n\n\tconstructor(params: BaseActionType)\n\t{\n\t\tthis.grid = params.grid;\n\t\tthis.filter = params.filter;\n\t\tthis.showPopups = params.showPopups ?? true;\n\t}\n\n\tsetActionParams(params: Object): void\n\t{\n\t}\n\n\tgetActionData(): Object\n\t{\n\t\treturn {};\n\t}\n\n\tasync execute(): void\n\t{\n\t\tawait this.onBeforeActionRequest();\n\n\t\tconst confirmationPopup = this.showPopups\n\t\t\t? this.getConfirmationPopup()\n\t\t\t: null\n\t\t;\n\n\t\tif (confirmationPopup)\n\t\t{\n\t\t\tconfirmationPopup.setOkCallback(async () => {\n\t\t\t\tconfirmationPopup.close();\n\t\t\t\tawait this.run();\n\t\t\t});\n\n\t\t\tconfirmationPopup.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tawait this.run();\n\t\t}\n\t}\n\n\tasync run(): void\n\t{\n\t}\n\n\tasync onBeforeActionRequest(): void\n\t{\n\t}\n\n\tonAfterActionRequest(): void\n\t{\n\t\tthis.grid.reload(() => {\n\t\t\tthis.grid.tableUnfade();\n\t\t});\n\t}\n\n\tasync sendActionRequest(): void\n\t{\n\t\ttry\n\t\t{\n\t\t\tthis.grid.tableFade();\n\n\t\t\tconst actionConfig = this.getActionConfig();\n\t\t\tconst actionData = this.getActionData();\n\t\t\tconst ajaxOptions = {\n\t\t\t\t...actionConfig.options,\n\t\t\t\tjson: actionData,\n\t\t\t\tmethod: 'POST',\n\t\t\t};\n\n\t\t\tlet result = null;\n\n\t\t\tswitch (actionConfig.type)\n\t\t\t{\n\t\t\t\tcase AJAX_REQUEST_TYPE.CONTROLLER:\n\t\t\t\t\tresult = await BX.ajax.runAction(\n\t\t\t\t\t\t`bizproc.v2.${actionConfig.name}`,\n\t\t\t\t\t\tajaxOptions,\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AJAX_REQUEST_TYPE.COMPONENT:\n\t\t\t\t\tresult = await BX.ajax.runComponentAction(\n\t\t\t\t\t\tactionConfig.component,\n\t\t\t\t\t\tactionConfig.name,\n\t\t\t\t\t\tajaxOptions,\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t{\n\t\t\t\t\tconst errorMessage = `Unknown action type: ${actionConfig.type}`;\n\t\t\t\t\tthis.handleError(errorMessage);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.handleSuccess(result);\n\t\t}\n\t\tcatch (result)\n\t\t{\n\t\t\tthis.handleError(result);\n\t\t}\n\t\tfinally\n\t\t{\n\t\t\tawait this.onAfterActionRequest();\n\t\t}\n\t}\n\n\thandleSuccess(result: any): void\n\t{\n\t}\n\n\thandleError(result: any): void\n\t{\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: this.getErrorMessageFromResult(result),\n\t\t});\n\t}\n\n\tgetConfirmationPopup(): MessageBox | null\n\t{\n\t\treturn null;\n\t}\n\n\tgetErrorMessageFromResult(result: any): ?string\n\t{\n\t\tif (Type.isStringFilled(result))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tif (Type.isStringFilled(result?.errors?.[0]?.message))\n\t\t{\n\t\t\treturn result.errors[0].message;\n\t\t}\n\n\t\tconsole.error(result);\n\n\t\treturn Loc.getMessage('BIZPROC_AI_AGENTS_GRID_DEFAULT_ACTION_ERROR');\n\t}\n}\n","import type { EditActionParams } from '../types';\nimport { ACTION_TYPE } from '../constants';\nimport { BaseAction } from './base-action';\n\nexport class EditAction extends BaseAction\n{\n\tstatic getActionId(): string\n\t{\n\t\treturn ACTION_TYPE.EDIT;\n\t}\n\n\tasync run(): Promise<void>\n\t{\n\t\tawait super.run();\n\t\tthis.#openDesigner();\n\t}\n\n\tsetActionParams(params: EditActionParams): void\n\t{\n\t\tthis.editUri = params.editUri;\n\t}\n\n\t#openDesigner(): void\n\t{\n\t\tif (!this.editUri)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\twindow.open(this.editUri, '_blank');\n\t}\n}\n","import { Loc, Type } from 'main.core';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\n\nimport { ACTION_TYPE, AJAX_REQUEST_TYPE } from '../constants';\n\nimport type {\n\tDeleteActionParams,\n\tActionConfig,\n\tDeleteActionDataType,\n} from '../types';\n\nimport { BaseAction } from './base-action';\n\nexport class DeleteAction extends BaseAction\n{\n\ttemplateId: number;\n\n\tstatic getActionId(): string\n\t{\n\t\treturn ACTION_TYPE.DELETE;\n\t}\n\n\tasync run(): void\n\t{\n\t\tawait this.sendActionRequest();\n\t}\n\n\tsetActionParams(params: DeleteActionParams): void\n\t{\n\t\tthis.templateId = Number.parseInt(params.templateId, 10);\n\t}\n\n\tgetActionConfig(): ActionConfig\n\t{\n\t\treturn {\n\t\t\ttype: AJAX_REQUEST_TYPE.CONTROLLER,\n\t\t\tname: 'Integration.AiAgent.Template.delete',\n\t\t};\n\t}\n\n\tgetActionData(): DeleteActionDataType\n\t{\n\t\tconst data: DeleteActionDataType = {\n\t\t\t...super.getActionData(),\n\t\t};\n\n\t\tif (!this.templateId || !Type.isNumber(this.templateId))\n\t\t{\n\t\t\treturn data;\n\t\t}\n\n\t\tdata.agentIds = [this.templateId];\n\n\t\treturn data;\n\t}\n\n\tgetConfirmationPopup(): MessageBox\n\t{\n\t\tconst message = Loc.getMessage('BIZPROC_AI_AGENTS_GRID_DELETE_ACTION_CONFIRM_MESSAGE');\n\t\tconst title = Loc.getMessage('BIZPROC_AI_AGENTS_GRID_DELETE_ACTION_CONFIRM_TITLE');\n\t\tconst buttons = MessageBoxButtons.OK_CANCEL;\n\t\tconst okCaption = Loc.getMessage('BIZPROC_AI_AGENTS_GRID_DELETE_ACTION_BUTTON_OK');\n\t\tconst cancelCaption = Loc.getMessage('BIZPROC_AI_AGENTS_GRID_DELETE_ACTION_BUTTON_CANCEL');\n\n\t\treturn new MessageBox({\n\t\t\tmessage,\n\t\t\ttitle,\n\t\t\tbuttons,\n\t\t\tokCaption,\n\t\t\tonCancel: (messageBox) => {\n\t\t\t\tmessageBox.close();\n\t\t\t},\n\t\t\tcancelCaption,\n\t\t});\n\t}\n}\n","import { Type, Loc } from 'main.core';\n\nimport { ACTION_TYPE, AJAX_REQUEST_TYPE } from '../constants';\n\nimport type {\n\tRestartActionParams,\n\tActionConfig,\n\tRestartActionDataType,\n} from '../types';\n\nimport { BaseAction } from './base-action';\n\nexport class RestartAction extends BaseAction\n{\n\ttemplateId: ?number;\n\n\tstatic getActionId(): string\n\t{\n\t\treturn ACTION_TYPE.RESTART;\n\t}\n\n\tasync run(): void\n\t{\n\t\tawait this.sendActionRequest();\n\t}\n\n\tsetActionParams(params: RestartActionParams): void\n\t{\n\t\tthis.templateId = Number.parseInt(params.templateId, 10);\n\t}\n\n\tgetActionConfig(): ActionConfig\n\t{\n\t\treturn {\n\t\t\ttype: AJAX_REQUEST_TYPE.CONTROLLER,\n\t\t\tname: 'Integration.AiAgent.Template.start',\n\t\t};\n\t}\n\n\tgetActionData(): RestartActionDataType\n\t{\n\t\tconst data: RestartActionDataType = {\n\t\t\t...super.getActionData(),\n\t\t};\n\n\t\tif (!this.templateId || !Type.isNumber(this.templateId))\n\t\t{\n\t\t\treturn data;\n\t\t}\n\n\t\tdata.templateId = this.templateId;\n\n\t\treturn data;\n\t}\n\n\thandleSuccess(result: any): void\n\t{\n\t\t/*\n\t\t// temporary disabled\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage('BIZPROC_AI_AGENTS_GRID_RESTART_ACTION_NOTIFICATION_TITLE'),\n\t\t});\n\t\t */\n\t}\n}\n","import { Loc } from 'main.core';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\n\nimport { ACTION_TYPE } from '../../constants';\nimport type { DeleteActionDataType } from '../../types';\nimport { DeleteAction } from '../delete-action';\n\nexport class GroupDeleteAction extends DeleteAction\n{\n\tstatic getActionId(): string\n\t{\n\t\treturn ACTION_TYPE.GROUP_DELETE;\n\t}\n\n\tgetSelectedIds(): string[]\n\t{\n\t\treturn this.grid.getRows().getSelectedIds();\n\t}\n\n\tgetActionData(): DeleteActionDataType\n\t{\n\t\tconst data = {\n\t\t\t...super.getActionData(),\n\t\t};\n\n\t\tdata.agentIds = this.getSelectedIds();\n\n\t\treturn data;\n\t}\n\n\tgetConfirmationPopup(): MessageBox\n\t{\n\t\tif (this.getSelectedIds()?.length === 1)\n\t\t{\n\t\t\treturn super.getConfirmationPopup();\n\t\t}\n\n\t\tconst message = Loc.getMessage('BIZPROC_AI_AGENTS_GRID_GROUP_DELETE_ACTION_CONFIRM_MESSAGE');\n\t\tconst title = Loc.getMessage('BIZPROC_AI_AGENTS_GRID_GROUP_DELETE_ACTION_CONFIRM_TITLE');\n\t\tconst buttons = MessageBoxButtons.OK_CANCEL;\n\t\tconst okCaption = Loc.getMessage('BIZPROC_AI_AGENTS_GRID_DELETE_ACTION_BUTTON_OK');\n\t\tconst cancelCaption = Loc.getMessage('BIZPROC_AI_AGENTS_GRID_DELETE_ACTION_BUTTON_CANCEL');\n\n\t\treturn new MessageBox({\n\t\t\tmessage,\n\t\t\ttitle,\n\t\t\tbuttons,\n\t\t\tokCaption,\n\t\t\tonCancel: (messageBox) => {\n\t\t\t\tmessageBox.close();\n\t\t\t},\n\t\t\tcancelCaption,\n\t\t});\n\t}\n}\n","import { EditAction } from './edit-action';\nimport { DeleteAction } from './delete-action';\nimport { RestartAction } from './restart-action';\n\nimport { GroupDeleteAction } from './group/group-delete-action';\n\nexport const actionMap = new Map([\n\t[EditAction.getActionId(), EditAction],\n\t[DeleteAction.getActionId(), DeleteAction],\n\t[RestartAction.getActionId(), RestartAction],\n]);\n\nexport const groupActionMap = new Map([\n\t[GroupDeleteAction.getActionId(), GroupDeleteAction],\n]);\n","import type { BaseActionType } from '../types';\n\nimport type { BaseAction } from './base-action';\nimport { actionMap, groupActionMap } from './action-map';\n\nexport class ActionFactory\n{\n\tstatic createFromMap(\n\t\tactionMapping: Map<string, BaseAction>,\n\t\tactionId: string,\n\t\toptions: BaseActionType,\n\t): BaseAction | null\n\t{\n\t\tconst ActionClass = actionMapping.get(actionId);\n\n\t\treturn ActionClass ? new ActionClass(options) : null;\n\t}\n\n\tstatic create(actionId: string, options: BaseActionType): BaseAction | null\n\t{\n\t\treturn this.createFromMap(actionMap, actionId, options);\n\t}\n\n\tstatic createGroupAction(actionId: string, options: BaseActionType): BaseAction | null\n\t{\n\t\treturn this.createFromMap(groupActionMap, actionId, options);\n\t}\n}\n","import { Loc } from 'main.core';\nimport type { BaseEvent } from 'main.core.events';\nimport { gridApi } from '../api';\nimport { RowHelper } from '../row-helper';\nimport type { FetchAiAgentRowResponse } from '../types';\n\nexport class TemplateSetupHandler\n{\n\t#grid: BX.Main.grid;\n\n\tconstructor(grid: BX.Main.grid)\n\t{\n\t\tthis.#grid = grid;\n\t}\n\n\tasync handle(event: BaseEvent): Promise<void>\n\t{\n\t\tconst eventData = event.getData();\n\t\tconst templateId = eventData?.templateId;\n\n\t\tif (!templateId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst rowHelper = new RowHelper(this.#grid);\n\t\tconst row = rowHelper.getByTemplateId(templateId);\n\n\t\tif (!row)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\trowHelper.markAsLoading(row);\n\n\t\t\tconst updatedTemplateRow: FetchAiAgentRowResponse = await gridApi.fetchRow(templateId);\n\n\t\t\tif (!updatedTemplateRow)\n\t\t\t{\n\t\t\t\tthrow new Error(Loc.getMessage('BIZPROC_AI_AGENTS_GRID_DEFAULT_ACTION_ERROR'));\n\t\t\t}\n\n\t\t\trowHelper.update(row, updatedTemplateRow.columns);\n\t\t\trowHelper.markAsLoaded(row);\n\t\t\trowHelper.highlight(row);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\trowHelper.markAsLoaded(row);\n\t\t\tthis.#notifyUser(error.message || Loc.getMessage('BIZPROC_AI_AGENTS_GRID_DEFAULT_ACTION_ERROR'));\n\n\t\t\tthis.#grid.reload();\n\t\t}\n\t}\n\n\t#notifyUser(text: string): void\n\t{\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: text,\n\t\t});\n\t}\n}\n","import { Type } from 'main.core';\nimport { type BaseEvent, EventEmitter } from 'main.core.events';\n\nimport { ActionFactory } from './action/action-factory';\nimport { TEMPLATE_SETUP_EVENT_NAME } from './constants';\nimport { TemplateSetupHandler } from './handler/template-setup-handler';\nimport type { runActionConfig, SetFilterType, SetSortType } from './types';\n\nexport class GridManager\n{\n\tstatic instances: Array<GridManager> = [];\n\t#grid: BX.Main.grid;\n\n\tconstructor(gridId: string)\n\t{\n\t\tthis.#grid = BX.Main.gridManager.getById(gridId)?.instance;\n\n\t\tthis.#subscribeToEvents();\n\t}\n\n\tstatic getInstance(gridId: string): GridManager\n\t{\n\t\tif (!this.instances[gridId])\n\t\t{\n\t\t\tthis.instances[gridId] = new GridManager(gridId);\n\t\t}\n\n\t\treturn this.instances[gridId];\n\t}\n\n\tstatic setSort(options: SetSortType): void\n\t{\n\t\tconst grid = BX.Main.gridManager.getById(options.gridId)?.instance;\n\n\t\tif (Type.isObject(grid))\n\t\t{\n\t\t\tgrid.tableFade();\n\t\t\tgrid.getUserOptions().setSort(options.sortBy, options.order, () => {\n\t\t\t\tgrid.reload();\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic setFilter(options: SetFilterType): void\n\t{\n\t\tconst grid = BX.Main.gridManager.getById(options.gridId)?.instance;\n\t\tconst filter = BX.Main.filterManager.getById(options.gridId);\n\n\t\tif (Type.isObject(grid) && Type.isObject(filter))\n\t\t{\n\t\t\tfilter.getApi().extendFilter(options.filter);\n\t\t}\n\t}\n\n\tgetGrid(): BX.Main.grid\n\t{\n\t\treturn this.#grid;\n\t}\n\n\trunAction(config: runActionConfig): void\n\t{\n\t\tconst actionId = config.actionId;\n\t\tconst options = config.options;\n\t\toptions.grid = this.#grid;\n\n\t\tconst action = ActionFactory.create(actionId, options);\n\t\tif (action)\n\t\t{\n\t\t\taction.setActionParams({ ...config.params });\n\t\t\taction.execute();\n\t\t}\n\t}\n\n\treload()\n\t{\n\t\tthis.#grid?.reload();\n\t}\n\n\t#subscribeToEvents()\n\t{\n\t\tEventEmitter.subscribe(\n\t\t\tTEMPLATE_SETUP_EVENT_NAME.SUCCESS,\n\t\t\t(event: BaseEvent) => new TemplateSetupHandler(this.#grid).handle(event),\n\t\t);\n\t}\n}\n","import { ActionFactory } from './action/action-factory';\n\nexport type ActionParamsType = {\n\tactionId: string,\n\tgridId: string,\n\tfilter: Array,\n\tshowPopups: ?boolean;\n}\n\nexport class Panel\n{\n\tstatic executeAction(params: ActionParamsType)\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst action = ActionFactory.createGroupAction(params.actionId, {\n\t\t\t\tgrid: BX.Main.gridManager.getById(params.gridId)?.instance,\n\t\t\t\tfilter: params.filter,\n\t\t\t});\n\n\t\t\taction.execute();\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('Error executing action:', error);\n\t\t}\n\t}\n}\n"],"names":["BaseField","constructor","params","fieldId","gridId","fieldNode","setFieldNode","node","getGridId","getFieldId","getGrid","grid","BX","Main","gridManager","getById","instance","getFieldNode","document","getElementById","appendToFieldNode","element","Dom","append","AgentInfoField","render","nameNode","TypographyText","name","size","accent","tag","className","attr","descriptionNode","description","GridIcons","LOAD","AGENT_CHAT","DEPARTMENT","AJAX_REQUEST_TYPE","COMPONENT","CONTROLLER","ACTION_TYPE","DELETE","GROUP_DELETE","EDIT","RESTART","TEMPLATE_SETUP_EVENT_NAME","SUCCESS","USER_MINI_PROFILE_ATTRIBUTES","USER_ID","CONTEXT","USER_MINI_PROFILE_CONTEXT","B24","PhotoField","avatarOptions","userpicPath","user","photoUrl","avatar","AvatarRound","addMiniProfile","renderTo","addClass","id","UsedByField","users","chatId","chatName","departments","container","Tag","hasUsers","length","hasDepartments","Object","keys","openChat","Messenger","MAX_VISIBLE_AVATARS_COMBINED","MAX_VISIBLE_AVATARS_USERS_ONLY","maxVisibleAvatars","placeholderAvatarsCount","avatarsContainer","i","avatarContainer","slice","forEach","remainingCount","counterClass","counterWrapperClass","counter","departmentsCount","withOpenPopupEvent","withPlusPrefix","counterNode","departmentIds","firstDepartmentId","Text","toInteger","firstDepartmentName","departmentNode","MAX_COUNTER_VALUE","count","counterClassName","counterWrapperClassName","counterWrapper","displayedNumber","counterText","String","numberNode","Event","bind","event","stopPropagation","bindElement","isShown","close","chatNameNode","encodedChatName","encode","chatContainer","preventDefault","contentNode","Popup","content","cacheable","minWidth","minHeight","maxWidth","maxHeight","padding","autoHide","show","subscribe","entries","nodeId","department","shouldAddHover","departmentWrapper","circle","label","Structure","open","focusNodeId","userFullName","fullName","userWrapper","imageWrapper","profileLink","Type","isStringFilled","SidePanel","Instance","FullNameField","Loc","getMessage","userId","fullNameElement","typographyOptions","EmployeeField","photoFieldId","getRandom","fullNameFieldId","post","action","data","response","ajax","runAction","method","json","status","gridApi","startTemplate","templateId","copyAndStartTemplate","fetchRow","RowHelper","setGrid","prepareNewRowParams","columns","rowActions","ID","actions","prepend","animation","getByTemplateId","rowsCollectionWrapper","getRows","markAsLoading","row","stateLoad","markAsLoaded","stateUnload","addToGrid","addRowOptions","getRealtime","addRow","update","updateColumns","setCellsContent","highlight","getNode","setTimeout","removeClass","LaunchControlField","isNumber","launchedAt","agentId","button","Button","text","ButtonSize","SMALL","DIV","useAirDesign","onclick","buttonInstance","setWaiting","tableFade","result","Api","newRowFields","tableUnfade","error","message","errors","UI","Notification","Center","notify","getContainer","timestamp","formattedDate","DateTimeFormat","format","dateNode","LoadIndicatorField","percentage","Number","isFinite","showPercentage","percentageNode","percentPerBar","activeBarsCount","Math","ceil","svgNode","bars","querySelectorAll","bar","index","currentBarIndex","style","percentageNodeText","BaseAction","getActionId","Error","getActionConfig","filter","showPopups","setActionParams","getActionData","execute","onBeforeActionRequest","confirmationPopup","getConfirmationPopup","setOkCallback","run","onAfterActionRequest","reload","sendActionRequest","actionConfig","actionData","ajaxOptions","options","type","runComponentAction","component","errorMessage","handleError","handleSuccess","getErrorMessageFromResult","console","EditAction","editUri","window","DeleteAction","parseInt","agentIds","title","buttons","MessageBoxButtons","OK_CANCEL","okCaption","cancelCaption","MessageBox","onCancel","messageBox","RestartAction","GroupDeleteAction","getSelectedIds","actionMap","Map","groupActionMap","ActionFactory","createFromMap","actionMapping","actionId","ActionClass","get","create","createGroupAction","TemplateSetupHandler","handle","eventData","getData","rowHelper","updatedTemplateRow","GridManager","getInstance","instances","setSort","isObject","getUserOptions","sortBy","order","setFilter","filterManager","getApi","extendFilter","config","EventEmitter","Panel","executeAction"],"mappings":"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"}