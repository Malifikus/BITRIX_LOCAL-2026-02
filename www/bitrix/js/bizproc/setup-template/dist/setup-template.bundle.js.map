{"version":3,"file":"setup-template.bundle.js","sources":["../src/constants.js","../src/component/item/constant-field/textual.js","../src/component/item/constant-field/select.js","../src/component/item/constant-field/user.js","../src/component/item/constant-field/textarea.js","../src/component/item/constant-field/knowledge.js","../src/component/item/constant-field/project.js","../src/component/item/constant-field/file.js","../src/component/item/constant.js","../src/component/item/delimiter.js","../src/component/item/description.js","../src/component/item/title.js","../src/component/item/title-with-icon.js","../src/component/item.js","../src/component/app.js","../src/index.js"],"sourcesContent":["import type { ConstantType, DelimiterType, ItemType } from './types';\n\nexport const ITEM_TYPES: Record<string, ItemType> = Object.freeze({\n\tDELIMITER: 'delimiter',\n\tTITLE: 'title',\n\tTITLE_WITH_ICON: 'titleWithIcon',\n\tDESCRIPTION: 'description',\n\tCONSTANT: 'constant',\n});\n\nexport const CONSTANT_TYPES: Record<string, ConstantType> = Object.freeze({\n\tSTRING: 'string',\n\tINT: 'int',\n\tUSER: 'user',\n\tFILE: 'file',\n\tTEXT: 'text',\n\tSELECT: 'select',\n\tKNOWLEDGE: 'rag_knowledge_base',\n\tPROJECT: 'project',\n});\n\nexport const DELIMITER_TYPES: Record<string, DelimiterType> = Object.freeze({\n\tLINE: 'line',\n});\n\nexport const TEMPLATE_SETUP_EVENT_NAME = {\n\tSUCCESS: 'Bizproc.AiAgentsGrid.TemplateSetup:success',\n};\n\nexport const PRESET_TITLE_ICONS = {\n\tIMAGE: 'o-image',\n\tATTACH: 'o-attach',\n\tSETTINGS: 'o-settings',\n\tSTARS: 'o-ai-stars',\n};\n","import { Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\n\n// @vue/component\nexport const ConstantTextual = {\n\tname: 'ConstantTextual',\n\tprops: {\n\t\t/** @type ConstantItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmodelValue: {\n\t\t\ttype: [String, Array],\n\t\t\tdefault: '',\n\t\t},\n\t},\n\temits: ['update:modelValue'],\n\tcomputed:\n\t{\n\t\tmultipleValues(): Array<string | null>\n\t\t{\n\t\t\tconst model = this.modelValue;\n\n\t\t\treturn Type.isArray(model) && model.length > 0 ? model : [''];\n\t\t},\n\t\tshowRemoveIcon(): boolean\n\t\t{\n\t\t\treturn this.item.multiple && this.multipleValues.length > 1;\n\t\t},\n\t},\n\tmethods: {\n\t\tupdateConstant(newValue: string): void\n\t\t{\n\t\t\tthis.$emit('update:modelValue', newValue);\n\t\t},\n\t\tupdateSingleValue(event: BaseEvent): void\n\t\t{\n\t\t\tthis.updateConstant(event.target.value);\n\t\t},\n\t\tupdateValueAtIndex(index, event: BaseEvent): void\n\t\t{\n\t\t\tconst newValues = [...this.multipleValues];\n\t\t\tnewValues[index] = event.target.value;\n\t\t\tthis.updateConstant(newValues);\n\t\t},\n\t\tasync addField(): void\n\t\t{\n\t\t\tconst newValues = [...this.multipleValues, ''];\n\t\t\tthis.updateConstant(newValues);\n\n\t\t\tawait this.$nextTick();\n\t\t\tconst inputs = this.$refs.inputFields;\n\t\t\tif (inputs && inputs.length > 0)\n\t\t\t{\n\t\t\t\tconst lastInput = inputs[inputs.length - 1];\n\t\t\t\tlastInput.focus();\n\t\t\t}\n\t\t},\n\t\tremoveField(index): void\n\t\t{\n\t\t\tconst newValues = [...this.multipleValues];\n\t\t\tnewValues.splice(index, 1);\n\t\t\tthis.updateConstant(newValues);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<template v-if=\"item.multiple\">\n\t\t\t\t<div v-for=\"(val, index) in multipleValues\" :key=\"index\" class=\"bizproc-setup-template__field-item\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tref=\"inputFields\"\n\t\t\t\t\t\t\t:value=\"val\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t@input=\"updateValueAtIndex(index, $event)\"\n\t\t\t\t\t\t\tdata-test-id=\"bizproc-setup-template__form-text-multiple\"\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span\n\t\t\t\t\t\tv-if=\"showRemoveIcon\"\n\t\t\t\t\t\t@click=\"removeField(index)\"\n\t\t\t\t\t\tdata-test-id=\"bizproc-setup-template__form-text-delete-btn\"\n\t\t\t\t\t\tclass=\"bizproc-setup-template__field-remove ui-icon-set --cross-m\"\n\t\t\t\t\t></span>\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\t@click=\"addField\"\n\t\t\t\t\tclass=\"bizproc-setup-template__add-btn\"\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tdata-test-id=\"bizproc-setup-template__form-text-add-btn\"\n\t\t\t\t>\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_JS_AI_AGENTS_ACTIVATOR_FORM_ADD_FIELD') }}\n\t\t\t\t</button>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t<input\n\t\t\t\t\t\t:value=\"modelValue\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t@input=\"updateSingleValue\"\n\t\t\t\t\t\tdata-test-id=\"bizproc-setup-template__form-text-single\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","// @vue/component\nexport const ConstantSelect = {\n\tname: 'ConstantSelect',\n\tprops: {\n\t\t/** @type ConstantItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmodelValue: {\n\t\t\ttype: [String, Array],\n\t\t\tdefault: '',\n\t\t},\n\t},\n\temits: ['update:modelValue'],\n\tcomputed:\n\t{\n\t\tselectedValue:\n\t\t{\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\treturn this.modelValue;\n\t\t\t},\n\t\t\tset(newValue: string): void\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', newValue);\n\t\t\t},\n\t\t},\n\t\toptions(): Array<{ id: string, name: string }>\n\t\t{\n\t\t\treturn this.item.options || [];\n\t\t},\n\t\tshowScroll(): boolean\n\t\t{\n\t\t\treturn this.options.length > 7;\n\t\t},\n\t},\n\tmethods: {\n\t\tgetFieldId(option: { id: string, name: string }): string\n\t\t{\n\t\t\treturn `select-opt-${this.item.id}-${option.id}`;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"{ 'bizproc-setup-template__field-select': showScroll }\">\n\t\t\t<template v-if=\"item.multiple\">\n\t\t\t\t<div v-for=\"option in options\" :key=\"option.id\" class=\"ui-ctl ui-ctl-checkbox\">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t:value=\"option.name\"\n\t\t\t\t\t\tv-model=\"selectedValue\"\n\t\t\t\t\t\t:id=\"getFieldId(option)\"\n\t\t\t\t\t>\n\t\t\t\t\t<label class=\"ui-ctl-label-text\" :for=\"getFieldId(option)\">{{ option.name }}</label>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<div v-for=\"option in options\" :key=\"option.id\" class=\"ui-ctl ui-ctl-radio\">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t:value=\"option.name\"\n\t\t\t\t\t\tv-model=\"selectedValue\"\n\t\t\t\t\t\t:id=\"getFieldId(option)\"\n\t\t\t\t\t>\n\t\t\t\t\t<label class=\"ui-ctl-label-text\" :for=\"getFieldId(option)\">{{ option.name }}</label>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { Loc, Type } from 'main.core';\nimport { TagSelector } from 'ui.entity-selector';\n\nconst ENTITY_TYPES = Object.freeze({\n\tUSER: 'user',\n\tDEPARTMENT: 'structure-node',\n});\n\nconst VALUE_PARSERS = [\n\t{\n\t\ttemplate: /^group_hrr(\\d+)$/,\n\t\tformat: (match) => [ENTITY_TYPES.DEPARTMENT, match[1]],\n\t},\n\t{\n\t\ttemplate: /^group_hr(\\d+)$/,\n\t\tformat: (match) => [ENTITY_TYPES.DEPARTMENT, `${match[1]}:F`],\n\t},\n\t{\n\t\ttemplate: /^user_(\\d+)$/,\n\t\tformat: (match) => [ENTITY_TYPES.USER, match[1]],\n\t},\n];\n\n// @vue/component\nexport const ConstantUser = {\n\tname: 'ConstantUser',\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmodelValue: {\n\t\t\ttype: [String, Array],\n\t\t\tdefault: '',\n\t\t},\n\t},\n\temits: ['update:modelValue'],\n\tmounted(): void\n\t{\n\t\tthis.initializeSelector();\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tif (this.tagSelector)\n\t\t{\n\t\t\tthis.tagSelector.getDialog().destroy();\n\t\t\tthis.tagSelector = null;\n\t\t}\n\t},\n\tmethods: {\n\t\tsyncValue(): void\n\t\t{\n\t\t\tif (!this.tagSelector)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst tags = this.tagSelector.getTags();\n\t\t\tconst newValues = tags.map((tag) => {\n\t\t\t\tconst rawId = tag.getId();\n\t\t\t\tconst title = tag.getTitle();\n\t\t\t\tconst entityId = tag.getEntityId();\n\n\t\t\t\tif (entityId === ENTITY_TYPES.USER)\n\t\t\t\t{\n\t\t\t\t\treturn `${title}[${rawId}]`;\n\t\t\t\t}\n\n\t\t\t\tif (entityId === ENTITY_TYPES.DEPARTMENT)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isString(rawId) && rawId.endsWith(':F'))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst id = rawId.replace(':F', '');\n\n\t\t\t\t\t\treturn `${title}[HR${id}]`;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn `${title}[HRR${rawId}]`;\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t}).filter(Boolean);\n\n\t\t\tif (this.item.multiple)\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', newValues.join(';'));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', newValues.length > 0 ? newValues[0] : '');\n\t\t\t}\n\t\t},\n\t\tgetPreselectedItems(): Array\n\t\t{\n\t\t\tconst valuesToParse = this.normalizeModelValue();\n\t\t\tif (valuesToParse.length === 0)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst parsedValues = valuesToParse.map((element) => this.parseValue(element));\n\n\t\t\treturn parsedValues.filter(Boolean);\n\t\t},\n\t\tnormalizeModelValue(): Array<string>\n\t\t{\n\t\t\tconst { modelValue, item } = this;\n\n\t\t\tif (item.multiple && Type.isStringFilled(modelValue))\n\t\t\t{\n\t\t\t\treturn modelValue.split(';');\n\t\t\t}\n\n\t\t\tif (Type.isArray(modelValue))\n\t\t\t{\n\t\t\t\treturn modelValue;\n\t\t\t}\n\n\t\t\treturn modelValue ? [String(modelValue)] : [];\n\t\t},\n\t\tparseValue(rawValue: string): Array | null\n\t\t{\n\t\t\tconst value = String(rawValue).trim();\n\t\t\tif (!value)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tfor (const parser of VALUE_PARSERS)\n\t\t\t{\n\t\t\t\tconst match = value.match(parser.template);\n\t\t\t\tif (match)\n\t\t\t\t{\n\t\t\t\t\treturn parser.format(match);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn [ENTITY_TYPES.USER, value];\n\t\t},\n\t\tinitializeSelector(): void\n\t\t{\n\t\t\tthis.tagSelector = new TagSelector({\n\t\t\t\tmultiple: this.item.multiple,\n\t\t\t\tshowCreateButton: false,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\tcontext: `BIZPROC_USER_SELECTOR_${this.item.id}`,\n\t\t\t\t\tpreselectedItems: this.getPreselectedItems(),\n\t\t\t\t\tpopupOptions: {\n\t\t\t\t\t\tclassName: 'bizproc-setup-template__no-tabs-selector-popup',\n\t\t\t\t\t},\n\t\t\t\t\twidth: 500,\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: ENTITY_TYPES.USER,\n\t\t\t\t\t\t\toptions: { inviteEmployeeLink: false },\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: ENTITY_TYPES.DEPARTMENT,\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tselectMode: 'usersAndDepartments',\n\t\t\t\t\t\t\t\tallowSelectRootDepartment: true,\n\t\t\t\t\t\t\t\tallowFlatDepartments: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tmultiple: this.item.multiple,\n\t\t\t\t\tshowAvatars: true,\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\tcompactView: true,\n\t\t\t\t\theight: 250,\n\t\t\t\t},\n\t\t\t\taddButtonCaption: Loc.getMessage('BIZPROC_JS_AI_AGENTS_ACTIVATOR_FORM_ADD_USER'),\n\t\t\t\tevents: {\n\t\t\t\t\tonAfterTagAdd: this.syncValue,\n\t\t\t\t\tonAfterTagRemove: this.syncValue,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.tagSelector.renderTo(this.$refs.container);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div ref=\"container\" data-test-id=\"bizproc-setup-template__form-user\"></div>\n\t`,\n};\n","import { BaseEvent } from 'main.core.events';\nimport { Type } from 'main.core';\n\nconst MAX_TEXT_LENGTH = 2000;\n\n// @vue/component\nexport const ConstantTextarea = {\n\tname: 'ConstantTextarea',\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmodelValue: {\n\t\t\ttype: [String, Array],\n\t\t\tdefault: '',\n\t\t},\n\t},\n\temits: ['update:modelValue'],\n\tcomputed:\n\t\t{\n\t\t\tmultipleValues(): Array<string>\n\t\t\t{\n\t\t\t\tconst model = this.modelValue;\n\t\t\t\tif (Type.isArray(model) && model.length > 0)\n\t\t\t\t{\n\t\t\t\t\treturn model;\n\t\t\t\t}\n\n\t\t\t\treturn [''];\n\t\t\t},\n\t\t\tmaxTextLength(): number\n\t\t\t{\n\t\t\t\treturn MAX_TEXT_LENGTH;\n\t\t\t},\n\t\t\tshowRemoveIcon(): boolean\n\t\t\t{\n\t\t\t\treturn this.item.multiple && this.multipleValues.length > 1;\n\t\t\t},\n\t\t},\n\tmethods: {\n\t\tgetCounterText(value: string): string\n\t\t{\n\t\t\tconst length = (value || '').length;\n\n\t\t\treturn `${length}/${this.maxTextLength}`;\n\t\t},\n\t\tonSingleInput(event: BaseEvent): void\n\t\t{\n\t\t\tlet currentValue = event.target.value;\n\t\t\tif (currentValue.length > this.maxTextLength)\n\t\t\t{\n\t\t\t\tcurrentValue = currentValue.slice(0, this.maxTextLength);\n\t\t\t\tevent.target.value = currentValue;\n\t\t\t}\n\t\t\tthis.$emit('update:modelValue', currentValue);\n\t\t},\n\t\tonMultipleInput(event: BaseEvent, index: number): void\n\t\t{\n\t\t\tlet currentValue = event.target.value;\n\t\t\tif (currentValue.length > this.maxTextLength)\n\t\t\t{\n\t\t\t\tcurrentValue = currentValue.slice(0, this.maxTextLength);\n\t\t\t\tevent.target.value = currentValue;\n\t\t\t}\n\t\t\tconst newValues = [...this.multipleValues];\n\t\t\tnewValues[index] = currentValue;\n\n\t\t\tthis.$emit('update:modelValue', newValues);\n\t\t},\n\t\tasync addField(): void\n\t\t{\n\t\t\tif (!this.item.multiple)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst newValues = [...this.multipleValues, ''];\n\t\t\tthis.$emit('update:modelValue', newValues);\n\n\t\t\tawait this.$nextTick();\n\t\t\tconst fields = this.$refs.textareaFields;\n\t\t\tif (fields && fields.length > 0)\n\t\t\t{\n\t\t\t\tconst lastField = fields[fields.length - 1];\n\t\t\t\tlastField.focus();\n\t\t\t}\n\t\t},\n\t\tremoveField(index: number): void\n\t\t{\n\t\t\tif (!this.showRemoveIcon)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst newValues = [...this.multipleValues];\n\t\t\tnewValues.splice(index, 1);\n\t\t\tthis.$emit('update:modelValue', newValues);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bizproc-setup-template__multiple-wrapper\">\n\t\t\t<template v-if=\"!item.multiple\">\n\t\t\t\t<div class=\"bizproc-setup-template__textarea-wrapper\">\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textarea ui-ctl-w100\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t:value=\"modelValue\"\n\t\t\t\t\t\t\t:maxlength=\"maxTextLength\"\n\t\t\t\t\t\t\t@input=\"onSingleInput\"\n\t\t\t\t\t\t\tdata-test-id=\"bizproc-setup-template__form-textarea-single\"\n\t\t\t\t\t\t></textarea>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bizproc-setup-template__char-counter\">\n\t\t\t\t\t\t{{ getCounterText(modelValue) }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"(value, index) in multipleValues\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\tclass=\"bizproc-setup-template__field-item\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"bizproc-setup-template__textarea-wrapper\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textarea ui-ctl-w100\">\n\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\tref=\"textareaFields\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t:value=\"value\"\n\t\t\t\t\t\t\t\t:maxlength=\"maxTextLength\"\n\t\t\t\t\t\t\t\t@input=\"onMultipleInput($event, index)\"\n\t\t\t\t\t\t\t\tdata-test-id=\"bizproc-setup-template__form-textarea-multiple\"\n\t\t\t\t\t\t\t></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bizproc-setup-template__char-counter\">\n\t\t\t\t\t\t\t{{ getCounterText(value) }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span\n\t\t\t\t\t\tv-if=\"showRemoveIcon\"\n\t\t\t\t\t\t@click=\"removeField(index)\"\n\t\t\t\t\t\tdata-test-id=\"bizproc-setup-template__form-textarea-delete-btn\"\n\t\t\t\t\t\tclass=\"bizproc-setup-template__field-remove ui-icon-set --cross-m\"\n\t\t\t\t\t></span>\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\t@click=\"addField\"\n\t\t\t\t\tclass=\"bizproc-setup-template__add-btn\"\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tdata-test-id=\"bizproc-setup-template__form-textarea-add-btn\"\n\t\t\t\t>\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_JS_AI_AGENTS_ACTIVATOR_FORM_ADD_FIELD') }}\n\t\t\t\t</button>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { RagAppComponent } from 'bizproc.rag-selector';\n\n// @vue/component\nexport const ConstantKnowledge = {\n\tname: 'ConstantKnowledge',\n\tcomponents: {\n\t\tRagAppComponent,\n\t},\n\tprops: {\n\t\t/** @type ConstantItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmodelValue: {\n\t\t\ttype: [Array, String],\n\t\t\tdefault: () => [],\n\t\t},\n\t\tisRequired: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['update:modelValue'],\n\tcomputed: {\n\t\tvalue: {\n\t\t\tget(): string | Array<string>\n\t\t\t{\n\t\t\t\treturn this.modelValue;\n\t\t\t},\n\t\t\tset(newValue: string | Array<string>): void\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', newValue);\n\t\t\t},\n\t\t},\n\t\tshowDescription(): boolean\n\t\t{\n\t\t\treturn this.item.description && this.item.description.length > 0;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-form-row\" data-test-id=\"bizproc-setup-template__form-knowledge\">\n\t\t\t<div class=\"bizproc-setup-template__knowledge-title\">\n\t\t\t\t{{ item.name }}\n\t\t\t</div>\n\t\t\t<div v-if=\"showDescription\" class=\"bizproc-setup-template__text\">\n\t\t\t\t{{ item.description }}\n\t\t\t</div>\n\t\t\t<RagAppComponent\n\t\t\t\tv-model=\"value\"\n\t\t\t\t:isMultiple=\"item.multiple\"\n\t\t\t\t:isRequired=\"isRequired\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport type { ItemId } from 'ui.entity-selector';\nimport { TagItem, TagSelector } from 'ui.entity-selector';\n\nconst ENTITY_TYPES = Object.freeze({\n\tPROJECT: 'project',\n});\n\n// @vue/component\nexport const ConstantProject = {\n\tname: 'ConstantProject',\n\tprops: {\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmodelValue: {\n\t\t\ttype: [String, Array, Number],\n\t\t\tdefault: '',\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['update:modelValue'],\n\tmounted(): void\n\t{\n\t\tthis.initializeSelector();\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tif (this.tagSelector)\n\t\t{\n\t\t\tthis.tagSelector.getDialog().destroy();\n\t\t\tthis.tagSelector = null;\n\t\t}\n\t},\n\tmethods: {\n\t\tsyncValue(): void\n\t\t{\n\t\t\tif (!this.tagSelector)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst tags = this.tagSelector.getTags();\n\t\t\tconst newValues = tags.map((tag: TagItem) => {\n\t\t\t\treturn tag.getId();\n\t\t\t}).filter(Boolean);\n\n\t\t\tif (this.item.multiple)\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', newValues);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', newValues.length > 0 ? newValues[0] : '');\n\t\t\t}\n\t\t},\n\t\tgetPreselectedItems(): Array<ItemId>\n\t\t{\n\t\t\treturn this.normalizeModelValues().map((value: number): ItemId => [ENTITY_TYPES.PROJECT, value]);\n\t\t},\n\t\tnormalizeModelValues(): Array<number>\n\t\t{\n\t\t\tif (Type.isArray(this.modelValue))\n\t\t\t{\n\t\t\t\treturn this.modelValue\n\t\t\t\t\t.map((v) => Number(v))\n\t\t\t\t\t.filter((v: number) => Type.isNumber(v))\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.modelValue\n\t\t\t\t? [Number(this.modelValue)].filter((v: number) => Type.isNumber(v))\n\t\t\t\t: []\n\t\t\t;\n\t\t},\n\t\tinitializeSelector(): void\n\t\t{\n\t\t\tthis.tagSelector = new TagSelector({\n\t\t\t\tmultiple: this.item.multiple,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\tcontext: `BIZPROC_PROJECT_SELECTOR_${this.item.id}`,\n\t\t\t\t\tpopupOptions: {\n\t\t\t\t\t\tclassName: 'bizproc-setup-template__no-tabs-selector-popup',\n\t\t\t\t\t},\n\t\t\t\t\twidth: 500,\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: ENTITY_TYPES.PROJECT,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tmultiple: this.item.multiple,\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\tcompactView: true,\n\t\t\t\t\theight: 250,\n\t\t\t\t\tpreselectedItems: this.getPreselectedItems(),\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonAfterTagAdd: this.syncValue,\n\t\t\t\t\tonAfterTagRemove: this.syncValue,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.tagSelector.renderTo(this.$refs.container);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div ref=\"container\" data-test-id=\"bizproc-setup-template__form-project\"></div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { TileWidgetComponent } from 'ui.uploader.tile-widget';\nimport { UploaderEvent, UploaderFile, Uploader } from 'ui.uploader.core';\n\nimport type { TileWidgetOptions } from 'ui.uploader.tile-widget';\nimport type { UploaderOptions } from 'ui.uploader.core';\n\n// @vue/component\nexport const ConstantFile = {\n\tname: 'ConstantFile',\n\tcomponents: {\n\t\tTileWidgetComponent,\n\t},\n\tinject: ['templateId'],\n\tprops: {\n\t\t/** @type ConstantItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmodelValue: {\n\t\t\ttype: [String, Array, Number],\n\t\t\tdefault: '',\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['update:modelValue'],\n\tcomputed: {\n\t\tuploaderOptions(): UploaderOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tcontroller: 'bizproc.fileUploader.setupTemplateUploaderController',\n\t\t\t\tcontrollerOptions: {\n\t\t\t\t\ttemplateId: this.templateId,\n\t\t\t\t},\n\t\t\t\tfiles: this.normalizeModelValues(),\n\t\t\t\tmultiple: this.item.multiple,\n\t\t\t\tautoUpload: true,\n\t\t\t\thiddenFieldsContainer: this.$refs.uploaderHiddenFields,\n\t\t\t\tevents: {\n\t\t\t\t\t[UploaderEvent.FILE_COMPLETE]: (): void => {\n\t\t\t\t\t\tthis.syncValue();\n\t\t\t\t\t},\n\t\t\t\t\t[UploaderEvent.FILE_REMOVE]: (): void => {\n\t\t\t\t\t\tthis.syncValue();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\twidgetOptions(): TileWidgetOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\treadonly: this.disabled,\n\t\t\t\thideDropArea: this.disabled,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tsyncValue(): void\n\t\t{\n\t\t\tconst uploader: Uploader = this.$refs?.tileWidget?.uploader;\n\t\t\tif (!uploader)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst fileIds: Array<string | number> = uploader\n\t\t\t\t.getFiles()\n\t\t\t\t.map((value: UploaderFile): string => value.getServerFileId())\n\t\t\t\t.filter((id) => Type.isStringFilled(id) || Type.isNumber(id))\n\t\t\t;\n\n\t\t\tif (this.item.multiple)\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', fileIds);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', fileIds.length > 0 ? fileIds[0] : '');\n\t\t\t}\n\t\t},\n\t\tnormalizeModelValues(): Array<number | string>\n\t\t{\n\t\t\tif (Type.isArray(this.modelValue))\n\t\t\t{\n\t\t\t\treturn this.modelValue;\n\t\t\t}\n\n\t\t\treturn this.modelValue ? [this.modelValue] : [];\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div ref=\"uploaderHiddenFields\"></div>\n\t\t<TileWidgetComponent :uploaderOptions=\"uploaderOptions\" :widgetOptions=\"widgetOptions\" ref=\"tileWidget\"/>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { ConstantTextual } from './constant-field/textual';\nimport { ConstantSelect } from './constant-field/select';\nimport { ConstantUser } from './constant-field/user';\nimport { ConstantTextarea } from './constant-field/textarea';\nimport { ConstantKnowledge } from './constant-field/knowledge';\nimport { ConstantProject } from './constant-field/project';\nimport { ConstantFile } from './constant-field/file';\nimport { CONSTANT_TYPES } from '../../constants';\n\nconst ConstantFieldMap = {\n\t[CONSTANT_TYPES.TEXT]: 'ConstantTextarea',\n\t[CONSTANT_TYPES.STRING]: 'ConstantTextual',\n\t[CONSTANT_TYPES.INT]: 'ConstantTextual',\n\t[CONSTANT_TYPES.SELECT]: 'ConstantSelect',\n\t[CONSTANT_TYPES.USER]: 'ConstantUser',\n\t[CONSTANT_TYPES.KNOWLEDGE]: 'ConstantKnowledge',\n\t[CONSTANT_TYPES.PROJECT]: 'ConstantProject',\n\t[CONSTANT_TYPES.FILE]: 'ConstantFile',\n};\n\n// @vue/component\nexport const ConstantComponent = {\n\tname: 'ConstantComponent',\n\tcomponents: {\n\t\tConstantTextual,\n\t\tConstantSelect,\n\t\tConstantUser,\n\t\tConstantTextarea,\n\t\tConstantKnowledge,\n\t\tConstantProject,\n\t\tConstantFile,\n\t},\n\tprops: {\n\t\t/** @type ConstantItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tformData: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\terror: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\temits: ['constantUpdate'],\n\tcomputed:\n\t{\n\t\tconstantValue:\n\t\t{\n\t\t\tget(): string | Array<string>\n\t\t\t{\n\t\t\t\treturn this.getCurrentConstantValue();\n\t\t\t},\n\t\t\tset(newValue): void\n\t\t\t{\n\t\t\t\tthis.$emit('constantUpdate', this.item.id, newValue);\n\t\t\t},\n\t\t},\n\t\tfieldComponent(): ?string\n\t\t{\n\t\t\treturn ConstantFieldMap[this.item.constantType] || null;\n\t\t},\n\t\tisRequired(): boolean\n\t\t{\n\t\t\treturn this.item.required;\n\t\t},\n\t\tisKnowledgeField(): boolean\n\t\t{\n\t\t\treturn this.item.constantType === CONSTANT_TYPES.KNOWLEDGE;\n\t\t},\n\t},\n\tmethods: {\n\t\tgetCurrentConstantValue(): string | Array<string>\n\t\t{\n\t\t\tconst currentValue = this.formData[this.item.id];\n\n\t\t\tif (this.item.multiple)\n\t\t\t{\n\t\t\t\tif (Type.isArray(currentValue))\n\t\t\t\t{\n\t\t\t\t\treturn currentValue;\n\t\t\t\t}\n\n\t\t\t\tif (currentValue)\n\t\t\t\t{\n\t\t\t\t\treturn [currentValue];\n\t\t\t\t}\n\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn currentValue ?? '';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<template v-if=\"isKnowledgeField\">\n\t\t\t<component\n\t\t\t\t:is=\"fieldComponent\"\n\t\t\t\t:item=\"item\"\n\t\t\t\tv-model=\"constantValue\"\n\t\t\t\t:isRequired=\"isRequired\"\n\t\t\t/>\n\t\t</template>\n\t\t<template v-else>\n\t\t\t<div class=\"ui-form-row\" :class=\"{ '--error': error }\">\n\t\t\t\t<div\n\t\t\t\t\t:class=\"{ '--required': isRequired }\"\n\t\t\t\t\tclass=\"ui-form-label bizproc-setup-template__label\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-ctl-label-text bizproc-setup-template__label-text\">{{ item.name }}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-form-content\">\n\t\t\t\t\t<component\n\t\t\t\t\t\tv-if=\"fieldComponent\"\n\t\t\t\t\t\t:is=\"fieldComponent\"\n\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\tv-model=\"constantValue\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div v-if=\"error\" class=\"bizproc-setup-template__error-text\">\n\t\t\t\t\t\t<div class=\"ui-icon-set --warning\"></div>\n\t\t\t\t\t\t{{ error }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t`,\n};\n","// eslint-disable-next-line no-unused-vars\nimport type { DelimiterItem } from '../../types';\n\n// @vue/component\nexport const DelimiterComponent = {\n\tname: 'DelimiterComponent',\n\tprops: {\n\t\t/** @type DelimiterItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bizproc-setup-template__delimiter\"></div>\n\t`,\n};\n","// eslint-disable-next-line no-unused-vars\nimport type { DescriptionItem } from '../../types';\n\n// @vue/component\nexport const DescriptionComponent = {\n\tname: 'DescriptionComponent',\n\tprops: {\n\t\t/** @type DescriptionItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bizproc-setup-template__text --with-linebreak\">\n\t\t\t{{ item.text }}\n\t\t</div>\n\t`,\n};\n","// eslint-disable-next-line no-unused-vars\nimport type { TitleItem } from '../../types';\n\n// @vue/component\nexport const TitleComponent = {\n\tname: 'TitleComponent',\n\tprops: {\n\t\t/** @type TitleItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bizproc-setup-template__heading\">\n\t\t\t{{ item.text }}\n\t\t</div>\n\t`,\n};\n","import { PRESET_TITLE_ICONS } from '../../constants';\n\n// eslint-disable-next-line no-unused-vars\nimport type { TitleIconItem } from '../../types';\n\n// @vue/component\nexport const TitleIconComponent = {\n\tname: 'TitleIconComponent',\n\tprops: {\n\t\t/** @type TitleIconItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tcurrentIconCssClass(): string\n\t\t{\n\t\t\treturn PRESET_TITLE_ICONS[this.item.icon] || PRESET_TITLE_ICONS.IMAGE;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bizproc-setup-template__heading --icon\">\n\t\t\t<i class=\"ui-icon-set\" :class=\"'--' + currentIconCssClass\"></i>\n\t\t\t<div class=\"bizproc-setup-template__heading-text\">\n\t\t\t\t{{ item.text }}\n\t\t\t</div>\n\t\t</div>\n\n\t`,\n};\n","import { ITEM_TYPES } from '../constants';\nimport { ConstantComponent } from './item/constant';\nimport { DelimiterComponent } from './item/delimiter';\nimport { DescriptionComponent } from './item/description';\nimport { TitleComponent } from './item/title';\nimport { TitleIconComponent } from './item/title-with-icon';\n\nimport '../css/style.css';\n\nconst componentMap = {\n\t[ITEM_TYPES.TITLE]: 'TitleComponent',\n\t[ITEM_TYPES.TITLE_WITH_ICON]: 'TitleIconComponent',\n\t[ITEM_TYPES.DESCRIPTION]: 'DescriptionComponent',\n\t[ITEM_TYPES.DELIMITER]: 'DelimiterComponent',\n\t[ITEM_TYPES.CONSTANT]: 'ConstantComponent',\n};\n\n// @vue/component\nexport const FormElement = {\n\tname: 'FormElement',\n\tcomponents: {\n\t\tTitleComponent,\n\t\tTitleIconComponent,\n\t\tDelimiterComponent,\n\t\tDescriptionComponent,\n\t\tConstantComponent,\n\t},\n\tprops: {\n\t\t/** @type Item */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tformData: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\terrors: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['constantUpdate'],\n\tcomputed: {\n\t\tcomponentName(): ?string\n\t\t{\n\t\t\treturn componentMap[this.item.itemType] || null;\n\t\t},\n\t\tconstantFormData(): Object | undefined\n\t\t{\n\t\t\tif (this.item.itemType === ITEM_TYPES.CONSTANT)\n\t\t\t{\n\t\t\t\treturn this.formData;\n\t\t\t}\n\n\t\t\treturn undefined;\n\t\t},\n\t},\n\tmethods: {\n\t\tconstantUpdate(constantId: string, value: string): void\n\t\t{\n\t\t\tthis.$emit('constantUpdate', constantId, value);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<component\n\t\t\tv-if=\"componentName\"\n\t\t\t:is=\"componentName\"\n\t\t\t:item=\"item\"\n\t\t\t:formData=\"constantFormData\"\n\t\t\t:error=\"errors[item.id]\"\n\t\t\t@constantUpdate=\"constantUpdate\"\n\t\t/>\n\t`,\n};\n","import { ajax, Type } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport { ITEM_TYPES, CONSTANT_TYPES, TEMPLATE_SETUP_EVENT_NAME } from '../constants';\nimport { FormElement } from './item';\nimport 'ui.alerts';\nimport 'ui.sidepanel-content';\nimport 'ui.forms';\nimport 'ui.layout-form';\nimport '../css/style.css';\n\nimport type { ConstantItem } from '../types';\n\nconst TOTAL_STEPS_COUNT = 2;\n\nconst BEFORE_SUBMIT_EVENT = 'Bizproc:SetupTemplate:beforeSubmit';\n\n// @vue/component\nexport const ActivatorAppComponent = {\n\tname: 'ActivatorAppComponent',\n\tcomponents: { FormElement },\n\tprovide(): {templateId: number}\n\t{\n\t\treturn {\n\t\t\ttemplateId: this.templateId,\n\t\t};\n\t},\n\tprops: {\n\t\ttemplateId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\ttemplateName: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttemplateDescription: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tinstanceId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\t/** @type Array<Block> */\n\t\tblocks: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): {\n\t\tisLoading: boolean,\n\t\tsubmitError: string,\n\t\tformData: { [key: string]: any },\n\t\tvalidationErrors: { [key: string]: string },\n\t\tcurrentStep: number,\n\t\t}\n\t{\n\t\treturn {\n\t\t\tcurrentStep: 1,\n\t\t\tisLoading: false,\n\t\t\tsubmitError: '',\n\t\t\tvalidationErrors: {},\n\t\t\tformData: this.getFormDataWithDefaultValues(),\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tallConstants(): Array<ConstantItem>\n\t\t{\n\t\t\treturn this.blocks\n\t\t\t\t.flatMap((block) => block.items)\n\t\t\t\t.filter((item) => item.itemType === ITEM_TYPES.CONSTANT)\n\t\t\t;\n\t\t},\n\t\tisBtnDisabled(): boolean\n\t\t{\n\t\t\treturn this.isLoading;\n\t\t},\n\t\tisFirstStep(): boolean\n\t\t{\n\t\t\treturn this.currentStep === 1;\n\t\t},\n\t\ttotalSteps(): number\n\t\t{\n\t\t\treturn TOTAL_STEPS_COUNT;\n\t\t},\n\t\tbuttonText(): string\n\t\t{\n\t\t\tconst messageCode = this.isFirstStep\n\t\t\t\t? 'BIZPROC_JS_AI_AGENTS_ACTIVATOR_CONTINUE_BUTTON'\n\t\t\t\t: 'BIZPROC_JS_AI_AGENTS_ACTIVATOR_RUN_BUTTON'\n\t\t\t;\n\n\t\t\treturn this.$Bitrix.Loc.getMessage(messageCode);\n\t\t},\n\t\tbuttonClickHandler(): Function\n\t\t{\n\t\t\treturn this.isFirstStep ? this.proceedToNextStep : this.handleSubmit;\n\t\t},\n\t},\n\tmethods: {\n\t\tgetFormDataWithDefaultValues(): { [key: string]: any }\n\t\t{\n\t\t\tconst initialData = {};\n\t\t\tthis.blocks.forEach((block) => {\n\t\t\t\tblock.items.forEach((item) => {\n\t\t\t\t\tif (item.itemType === ITEM_TYPES.CONSTANT)\n\t\t\t\t\t{\n\t\t\t\t\t\tinitialData[item.id] = item.default ?? '';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn initialData;\n\t\t},\n\t\tgetPreparedDataForRequest(): { [key: string]: any }\n\t\t{\n\t\t\tconst preparedData = {};\n\n\t\t\tthis.allConstants.forEach((item) => {\n\t\t\t\tconst key = item.id;\n\t\t\t\tconst value = this.formData[key];\n\n\t\t\t\tif (this.isValueEmpty(value))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (Type.isArray(value))\n\t\t\t\t{\n\t\t\t\t\tlet preparedValues = value.filter((val) => !this.isValueEmpty(val));\n\t\t\t\t\tif (preparedValues.length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (item.constantType === CONSTANT_TYPES.INT)\n\t\t\t\t\t{\n\t\t\t\t\t\tpreparedValues = preparedValues.map(Number);\n\t\t\t\t\t}\n\n\t\t\t\t\tpreparedData[key] = preparedValues;\n\t\t\t\t}\n\t\t\t\telse if (item.constantType === CONSTANT_TYPES.INT)\n\t\t\t\t{\n\t\t\t\t\tpreparedData[key] = Number(value);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpreparedData[key] = value;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn preparedData;\n\t\t},\n\t\tactivateTemplateRequest(): Promise<void>\n\t\t{\n\t\t\tconst FILL_TEMPLATE_ACTION = 'bizproc.v2.SetupTemplate.fill';\n\n\t\t\tconst constantValues = this.getPreparedDataForRequest();\n\n\t\t\treturn ajax.runAction(FILL_TEMPLATE_ACTION, {\n\t\t\t\tdata: {\n\t\t\t\t\ttemplateId: this.templateId,\n\t\t\t\t\tinstanceId: this.instanceId,\n\t\t\t\t\tconstantValues,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tgetErrorFromResponse(response: Object): string\n\t\t{\n\t\t\tif (!response.errors)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tif (!Type.isArrayFilled(response.errors))\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('BIZPROC_JS_AI_AGENTS_ACTIVATOR_UNEXPECTED_ERROR');\n\t\t\t}\n\n\t\t\tconst [firstError] = response.errors;\n\n\t\t\treturn firstError.message;\n\t\t},\n\t\tasync handleSubmit(): Promise<void>\n\t\t{\n\t\t\tif (!this.validateForm())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tthis.submitError = '';\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst eventRes: boolean[] = await EventEmitter.emitAsync(BEFORE_SUBMIT_EVENT);\n\t\t\t\tif (eventRes.includes(false))\n\t\t\t\t{\n\t\t\t\t\tthis.isLoading = false;\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tawait this.activateTemplateRequest();\n\t\t\t\tconst event = new BaseEvent(\n\t\t\t\t\t{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\ttemplateId: this.templateId,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tEventEmitter.emit(TEMPLATE_SETUP_EVENT_NAME.SUCCESS, event);\n\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tthis.submitError = this.getErrorFromResponse(error);\n\t\t\t}\n\n\t\t\tthis.isLoading = false;\n\t\t},\n\t\thandleCancel(): void\n\t\t{\n\t\t\tBX.SidePanel.Instance.close();\n\t\t},\n\t\tonConstantUpdate(constantId: string, value: string): void\n\t\t{\n\t\t\tthis.formData[constantId] = value;\n\n\t\t\tif (this.validationErrors[constantId] && !this.isValueEmpty(value))\n\t\t\t{\n\t\t\t\tdelete this.validationErrors[constantId];\n\t\t\t}\n\t\t},\n\t\tisValueEmpty(value: string): boolean\n\t\t{\n\t\t\tif (Type.isArray(value) && value.length === 0)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst stringValue = (value ?? '').toString();\n\n\t\t\treturn stringValue.trim().length === 0;\n\t\t},\n\t\tvalidateForm(): boolean\n\t\t{\n\t\t\tthis.validationErrors = {};\n\t\t\tconst simpleConstants = this.allConstants.filter((item) => item.constantType !== CONSTANT_TYPES.KNOWLEDGE);\n\n\t\t\tsimpleConstants.forEach((item) => {\n\t\t\t\tconst value = this.formData[item.id];\n\t\t\t\tif (item.required && this.isValueEmpty(value))\n\t\t\t\t{\n\t\t\t\t\tthis.validationErrors[item.id] = this.$Bitrix.Loc.getMessage('BIZPROC_JS_AI_AGENTS_ACTIVATOR_FORM_VALIDATION_ERROR');\n\t\t\t\t}\n\t\t\t\telse if (item.constantType === CONSTANT_TYPES.INT && this.isNotNumber(value))\n\t\t\t\t{\n\t\t\t\t\tthis.validationErrors[item.id] = this.$Bitrix.Loc.getMessage('BIZPROC_JS_AI_AGENTS_ACTIVATOR_FORM_VALIDATION_ERROR_INT', { '#FIELD_NAME#': item.name });\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn Object.keys(this.validationErrors).length === 0;\n\t\t},\n\t\tisNotNumber(value: string): boolean\n\t\t{\n\t\t\tconst check = (val) => {\n\t\t\t\tif (this.isValueEmpty(val))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn Number.isNaN(Number(val));\n\t\t\t};\n\n\t\t\tif (Type.isArray(value))\n\t\t\t{\n\t\t\t\treturn value.some((item) => check(item));\n\t\t\t}\n\n\t\t\treturn check(value);\n\t\t},\n\t\tproceedToNextStep(): void\n\t\t{\n\t\t\tthis.currentStep++;\n\t\t},\n\t\tisCurrentStep(step: number): boolean\n\t\t{\n\t\t\treturn this.currentStep === step;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bizproc-setup-template__form\" data-test-id=\"bizproc-setup-template__form-container\">\n\t\t\t<div class=\"ui-sidepanel-layout-header\">\n\t\t\t\t<div class=\"ui-sidepanel-layout-title\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_JS_AI_AGENTS_ACTIVATOR_TITLE') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-sidepanel-layout-content ui-sidepanel-layout-content-margin\">\n\t\t\t\t<div class=\"ui-sidepanel-layout-content-inner\">\n\t\t\t\t\t<div class=\"bizproc-setup-template__progress-bar\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-for=\"step in totalSteps\"\n\t\t\t\t\t\t\t:key=\"step\"\n\t\t\t\t\t\t\tclass=\"bizproc-setup-template__progress-item\"\n\t\t\t\t\t\t\t:class=\"{ '--active': isCurrentStep(step) }\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<template v-if=\"isFirstStep\">\n\t\t\t\t\t\t<div class=\"ui-slider-section\">\n\t\t\t\t\t\t\t<div class=\"bizproc-setup-template__heading\">\n\t\t\t\t\t\t\t\t{{ templateName }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"bizproc-setup-template__subject\">\n\t\t\t\t\t\t\t\t{{ templateDescription }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div v-if=\"submitError\" class=\"ui-alert ui-alert-danger\">\n\t\t\t\t\t\t\t<span class=\"ui-alert-message\">{{ submitError }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<template v-for=\"block in blocks\" :key=\"block.id\">\n\t\t\t\t\t\t\t<div class=\"ui-slider-section\">\n\t\t\t\t\t\t\t\t<div class=\"ui-slider-content-box\">\n\t\t\t\t\t\t\t\t\t<FormElement\n\t\t\t\t\t\t\t\t\t\tv-for=\"item in block.items\"\n\t\t\t\t\t\t\t\t\t\t:key=\"item.id\"\n\t\t\t\t\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t\t\t\t\t:formData=\"formData\"\n\t\t\t\t\t\t\t\t\t\t:errors=\"validationErrors\"\n\t\t\t\t\t\t\t\t\t\t@constantUpdate=\"onConstantUpdate\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-sidepanel-layout-footer-anchor\"></div>\n\t\t\t<div class=\"ui-sidepanel-layout-footer\">\n\t\t\t\t<div class=\"ui-sidepanel-layout-buttons ui-sidepanel-layout-buttons-align-left\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"ui-btn --air ui-btn-lg --style-filled ui-btn-no-caps\"\n\t\t\t\t\t\t:class=\"{'ui-btn-wait': isLoading}\"\n\t\t\t\t\t\t:disabled=\"isBtnDisabled\"\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t@click=\"buttonClickHandler\"\n\t\t\t\t\t\tdata-test-id=\"bizproc-setup-template__form-submit-button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class=\"ui-btn-text\">\n\t\t\t\t\t\t\t<span class=\"ui-btn-text-inner\">\n\t\t\t\t\t\t\t\t{{ buttonText }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclass=\"ui-btn --air ui-btn-lg --style-plain ui-btn-no-caps\"\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t@click=\"handleCancel\"\n\t\t\t\t\t\tdata-test-id=\"bizproc-setup-template__form-cancel-button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class=\"ui-btn-text\">\n\t\t\t\t\t\t\t<span class=\"ui-btn-text-inner\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_JS_AI_AGENTS_ACTIVATOR_CANCEL_BUTTON') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Tag } from 'main.core';\nimport { PULL } from 'pull.client';\nimport { BitrixVue, VueCreateAppResult } from 'ui.vue3';\nimport { ActivatorAppComponent } from './component/app';\nimport type { SetupActivityPushData } from './types';\n\ntype SetupTemplateOptions = {\n\tcontainer: HTMLElement,\n\tpushData: SetupActivityPushData,\n};\n\nexport { ActivatorAppComponent } from './component/app';\nexport { FormElement } from './component/item';\n\nexport class SetupTemplate\n{\n\t#pushData: SetupActivityPushData;\n\t#container: HTMLElement;\n\t#application: ?VueCreateAppResult;\n\tconstructor(options: SetupTemplateOptions)\n\t{\n\t\tthis.#container = options.container;\n\t\tthis.#pushData = options.pushData;\n\t}\n\n\tmount(): void\n\t{\n\t\tthis.#application = BitrixVue.createApp(ActivatorAppComponent, {\n\t\t\ttemplateId: this.#pushData.templateId,\n\t\t\ttemplateName: this.#pushData.templateName,\n\t\t\ttemplateDescription: this.#pushData.templateDescription,\n\t\t\tinstanceId: this.#pushData.instanceId,\n\t\t\tblocks: this.#pushData.blocks,\n\t\t});\n\t\tthis.#application.mount(this.#container);\n\t}\n\n\tunmount(): void\n\t{\n\t\tif (this.#application)\n\t\t{\n\t\t\tthis.#application.unmount();\n\t\t}\n\t}\n\n\tstatic createLayout(params: SetupActivityPushData): HTMLElement\n\t{\n\t\tconst container = Tag.render`<div class=\"ui-sidepanel-layout\"></div>`;\n\t\tconst app = new SetupTemplate({\n\t\t\tcontainer,\n\t\t\tpushData: params,\n\t\t});\n\t\tapp.mount();\n\n\t\treturn container;\n\t}\n\n\tstatic showSidePanel(params: SetupActivityPushData): void\n\t{\n\t\tBX.SidePanel.Instance.open('bizproc:setup-template-fill', {\n\t\t\twidth: 600,\n\t\t\tcacheable: false,\n\t\t\tcontentCallback: () => SetupTemplate.createLayout(params),\n\t\t});\n\t}\n\n\tstatic subscribeOnPull(): void\n\t{\n\t\tPULL.subscribe({\n\t\t\tmoduleId: 'bizproc',\n\t\t\tcommand: 'setupTemplateActivityBlocks',\n\t\t\tcallback: (pushData: SetupActivityPushData): void => {\n\t\t\t\tSetupTemplate.showSidePanel(pushData);\n\t\t\t},\n\t\t});\n\t}\n}\n"],"names":["ITEM_TYPES","Object","freeze","DELIMITER","TITLE","TITLE_WITH_ICON","DESCRIPTION","CONSTANT","CONSTANT_TYPES","STRING","INT","USER","FILE","TEXT","SELECT","KNOWLEDGE","PROJECT","DELIMITER_TYPES","LINE","TEMPLATE_SETUP_EVENT_NAME","SUCCESS","PRESET_TITLE_ICONS","IMAGE","ATTACH","SETTINGS","STARS","ConstantTextual","name","props","item","type","required","modelValue","String","Array","default","emits","computed","multipleValues","model","Type","isArray","length","showRemoveIcon","multiple","methods","updateConstant","newValue","$emit","updateSingleValue","event","target","value","updateValueAtIndex","index","newValues","addField","$nextTick","inputs","$refs","inputFields","lastInput","focus","removeField","splice","template","ConstantSelect","selectedValue","get","set","options","showScroll","getFieldId","option","id","ENTITY_TYPES","DEPARTMENT","VALUE_PARSERS","format","match","ConstantUser","mounted","initializeSelector","beforeUnmount","tagSelector","getDialog","destroy","syncValue","tags","getTags","map","tag","rawId","getId","title","getTitle","entityId","getEntityId","isString","endsWith","replace","filter","Boolean","join","getPreselectedItems","valuesToParse","normalizeModelValue","parsedValues","element","parseValue","isStringFilled","split","rawValue","trim","parser","TagSelector","showCreateButton","dialogOptions","context","preselectedItems","popupOptions","className","width","entities","inviteEmployeeLink","selectMode","allowSelectRootDepartment","allowFlatDepartments","showAvatars","dropdownMode","compactView","height","addButtonCaption","Loc","getMessage","events","onAfterTagAdd","onAfterTagRemove","renderTo","container","MAX_TEXT_LENGTH","ConstantTextarea","maxTextLength","getCounterText","onSingleInput","currentValue","slice","onMultipleInput","fields","textareaFields","lastField","ConstantKnowledge","components","RagAppComponent","isRequired","showDescription","description","ConstantProject","Number","disabled","normalizeModelValues","v","isNumber","ConstantFile","TileWidgetComponent","inject","uploaderOptions","controller","controllerOptions","templateId","files","autoUpload","hiddenFieldsContainer","uploaderHiddenFields","UploaderEvent","FILE_COMPLETE","FILE_REMOVE","widgetOptions","readonly","hideDropArea","uploader","tileWidget","fileIds","getFiles","getServerFileId","ConstantFieldMap","ConstantComponent","formData","error","constantValue","getCurrentConstantValue","fieldComponent","constantType","isKnowledgeField","DelimiterComponent","DescriptionComponent","TitleComponent","TitleIconComponent","currentIconCssClass","icon","componentMap","FormElement","errors","componentName","itemType","constantFormData","undefined","constantUpdate","constantId","TOTAL_STEPS_COUNT","BEFORE_SUBMIT_EVENT","ActivatorAppComponent","provide","templateName","templateDescription","instanceId","blocks","data","currentStep","isLoading","submitError","validationErrors","getFormDataWithDefaultValues","allConstants","flatMap","block","items","isBtnDisabled","isFirstStep","totalSteps","buttonText","messageCode","$Bitrix","buttonClickHandler","proceedToNextStep","handleSubmit","initialData","forEach","getPreparedDataForRequest","preparedData","key","isValueEmpty","preparedValues","val","activateTemplateRequest","FILL_TEMPLATE_ACTION","constantValues","ajax","runAction","getErrorFromResponse","response","isArrayFilled","firstError","message","validateForm","eventRes","EventEmitter","emitAsync","includes","BaseEvent","emit","BX","SidePanel","Instance","close","handleCancel","onConstantUpdate","stringValue","toString","simpleConstants","isNotNumber","keys","check","isNaN","some","isCurrentStep","step","SetupTemplate","constructor","pushData","mount","BitrixVue","createApp","unmount","createLayout","params","Tag","render","app","showSidePanel","open","cacheable","contentCallback","subscribeOnPull","PULL","subscribe","moduleId","command","callback"],"mappings":";;;;;CAEO,MAAMA,UAAoC,GAAGC,MAAM,CAACC,MAAM,CAAC;GACjEC,SAAS,EAAE,WAAW;GACtBC,KAAK,EAAE,OAAO;GACdC,eAAe,EAAE,eAAe;GAChCC,WAAW,EAAE,aAAa;GAC1BC,QAAQ,EAAE;CACX,CAAC,CAAC;AAEF,CAAO,MAAMC,cAA4C,GAAGP,MAAM,CAACC,MAAM,CAAC;GACzEO,MAAM,EAAE,QAAQ;GAChBC,GAAG,EAAE,KAAK;GACVC,IAAI,EAAE,MAAM;GACZC,IAAI,EAAE,MAAM;GACZC,IAAI,EAAE,MAAM;GACZC,MAAM,EAAE,QAAQ;GAChBC,SAAS,EAAE,oBAAoB;GAC/BC,OAAO,EAAE;CACV,CAAC,CAAC;AAEF,CAAO,MAAMC,eAA8C,GAAGhB,MAAM,CAACC,MAAM,CAAC;GAC3EgB,IAAI,EAAE;CACP,CAAC,CAAC;AAEF,CAAO,MAAMC,yBAAyB,GAAG;GACxCC,OAAO,EAAE;CACV,CAAC;AAED,CAAO,MAAMC,kBAAkB,GAAG;GACjCC,KAAK,EAAE,SAAS;GAChBC,MAAM,EAAE,UAAU;GAClBC,QAAQ,EAAE,YAAY;GACtBC,KAAK,EAAE;CACR,CAAC;;CC/BD;AACA,CAAO,MAAMC,eAAe,GAAG;GAC9BC,IAAI,EAAE,iBAAiB;GACvBC,KAAK,EAAE;;KAENC,IAAI,EAAE;OACLC,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;MACV;KACDC,UAAU,EAAE;OACXF,IAAI,EAAE,CAACG,MAAM,EAAEC,KAAK,CAAC;OACrBC,OAAO,EAAE;;IAEV;GACDC,KAAK,EAAE,CAAC,mBAAmB,CAAC;GAC5BC,QAAQ,EACR;KACCC,cAAc,GACd;OACC,MAAMC,KAAK,GAAG,IAAI,CAACP,UAAU;OAE7B,OAAOQ,cAAI,CAACC,OAAO,CAACF,KAAK,CAAC,IAAIA,KAAK,CAACG,MAAM,GAAG,CAAC,GAAGH,KAAK,GAAG,CAAC,EAAE,CAAC;MAC7D;KACDI,cAAc,GACd;OACC,OAAO,IAAI,CAACd,IAAI,CAACe,QAAQ,IAAI,IAAI,CAACN,cAAc,CAACI,MAAM,GAAG,CAAC;;IAE5D;GACDG,OAAO,EAAE;KACRC,cAAc,CAACC,QAAgB,EAC/B;OACC,IAAI,CAACC,KAAK,CAAC,mBAAmB,EAAED,QAAQ,CAAC;MACzC;KACDE,iBAAiB,CAACC,KAAgB,EAClC;OACC,IAAI,CAACJ,cAAc,CAACI,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC;MACvC;KACDC,kBAAkB,CAACC,KAAK,EAAEJ,KAAgB,EAC1C;OACC,MAAMK,SAAS,GAAG,CAAC,GAAG,IAAI,CAACjB,cAAc,CAAC;OAC1CiB,SAAS,CAACD,KAAK,CAAC,GAAGJ,KAAK,CAACC,MAAM,CAACC,KAAK;OACrC,IAAI,CAACN,cAAc,CAACS,SAAS,CAAC;MAC9B;KACD,MAAMC,QAAQ,GACd;OACC,MAAMD,SAAS,GAAG,CAAC,GAAG,IAAI,CAACjB,cAAc,EAAE,EAAE,CAAC;OAC9C,IAAI,CAACQ,cAAc,CAACS,SAAS,CAAC;OAE9B,MAAM,IAAI,CAACE,SAAS,EAAE;OACtB,MAAMC,MAAM,GAAG,IAAI,CAACC,KAAK,CAACC,WAAW;OACrC,IAAIF,MAAM,IAAIA,MAAM,CAAChB,MAAM,GAAG,CAAC,EAC/B;SACC,MAAMmB,SAAS,GAAGH,MAAM,CAACA,MAAM,CAAChB,MAAM,GAAG,CAAC,CAAC;SAC3CmB,SAAS,CAACC,KAAK,EAAE;;MAElB;KACDC,WAAW,CAACT,KAAK,EACjB;OACC,MAAMC,SAAS,GAAG,CAAC,GAAG,IAAI,CAACjB,cAAc,CAAC;OAC1CiB,SAAS,CAACS,MAAM,CAACV,KAAK,EAAE,CAAC,CAAC;OAC1B,IAAI,CAACR,cAAc,CAACS,SAAS,CAAC;;IAE/B;GACDU,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA2CZ,CAAC;;CC7GD;AACA,CAAO,MAAMC,cAAc,GAAG;GAC7BvC,IAAI,EAAE,gBAAgB;GACtBC,KAAK,EAAE;;KAENC,IAAI,EAAE;OACLC,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;MACV;KACDC,UAAU,EAAE;OACXF,IAAI,EAAE,CAACG,MAAM,EAAEC,KAAK,CAAC;OACrBC,OAAO,EAAE;;IAEV;GACDC,KAAK,EAAE,CAAC,mBAAmB,CAAC;GAC5BC,QAAQ,EACR;KACC8B,aAAa,EACb;OACCC,GAAG,GACH;SACC,OAAO,IAAI,CAACpC,UAAU;QACtB;OACDqC,GAAG,CAACtB,QAAgB,EACpB;SACC,IAAI,CAACC,KAAK,CAAC,mBAAmB,EAAED,QAAQ,CAAC;;MAE1C;KACDuB,OAAO,GACP;OACC,OAAO,IAAI,CAACzC,IAAI,CAACyC,OAAO,IAAI,EAAE;MAC9B;KACDC,UAAU,GACV;OACC,OAAO,IAAI,CAACD,OAAO,CAAC5B,MAAM,GAAG,CAAC;;IAE/B;GACDG,OAAO,EAAE;KACR2B,UAAU,CAACC,MAAoC,EAC/C;OACC,OAAQ,cAAa,IAAI,CAAC5C,IAAI,CAAC6C,EAAG,IAAGD,MAAM,CAACC,EAAG,EAAC;;IAEjD;GACDT,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA4BZ,CAAC;;CCpED,MAAMU,YAAY,GAAG1E,MAAM,CAACC,MAAM,CAAC;GAClCS,IAAI,EAAE,MAAM;GACZiE,UAAU,EAAE;CACb,CAAC,CAAC;CAEF,MAAMC,aAAa,GAAG,CACrB;GACCZ,QAAQ,EAAE,kBAAkB;GAC5Ba,MAAM,EAAGC,KAAK,IAAK,CAACJ,YAAY,CAACC,UAAU,EAAEG,KAAK,CAAC,CAAC,CAAC;CACtD,CAAC,EACD;GACCd,QAAQ,EAAE,iBAAiB;GAC3Ba,MAAM,EAAGC,KAAK,IAAK,CAACJ,YAAY,CAACC,UAAU,EAAG,GAAEG,KAAK,CAAC,CAAC,CAAE,IAAG;CAC7D,CAAC,EACD;GACCd,QAAQ,EAAE,cAAc;GACxBa,MAAM,EAAGC,KAAK,IAAK,CAACJ,YAAY,CAAChE,IAAI,EAAEoE,KAAK,CAAC,CAAC,CAAC;CAChD,CAAC,CACD;;CAED;AACA,CAAO,MAAMC,YAAY,GAAG;GAC3BrD,IAAI,EAAE,cAAc;GACpBC,KAAK,EAAE;KACNC,IAAI,EAAE;OACLC,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;MACV;KACDC,UAAU,EAAE;OACXF,IAAI,EAAE,CAACG,MAAM,EAAEC,KAAK,CAAC;OACrBC,OAAO,EAAE;;IAEV;GACDC,KAAK,EAAE,CAAC,mBAAmB,CAAC;GAC5B6C,OAAO,GACP;KACC,IAAI,CAACC,kBAAkB,EAAE;IACzB;GACDC,aAAa,GACb;KACC,IAAI,IAAI,CAACC,WAAW,EACpB;OACC,IAAI,CAACA,WAAW,CAACC,SAAS,EAAE,CAACC,OAAO,EAAE;OACtC,IAAI,CAACF,WAAW,GAAG,IAAI;;IAExB;GACDvC,OAAO,EAAE;KACR0C,SAAS,GACT;OACC,IAAI,CAAC,IAAI,CAACH,WAAW,EACrB;SACC;;OAGD,MAAMI,IAAI,GAAG,IAAI,CAACJ,WAAW,CAACK,OAAO,EAAE;OACvC,MAAMlC,SAAS,GAAGiC,IAAI,CAACE,GAAG,CAAEC,GAAG,IAAK;SACnC,MAAMC,KAAK,GAAGD,GAAG,CAACE,KAAK,EAAE;SACzB,MAAMC,KAAK,GAAGH,GAAG,CAACI,QAAQ,EAAE;SAC5B,MAAMC,QAAQ,GAAGL,GAAG,CAACM,WAAW,EAAE;SAElC,IAAID,QAAQ,KAAKrB,YAAY,CAAChE,IAAI,EAClC;WACC,OAAQ,GAAEmF,KAAM,IAAGF,KAAM,GAAE;;SAG5B,IAAII,QAAQ,KAAKrB,YAAY,CAACC,UAAU,EACxC;WACC,IAAIpC,cAAI,CAAC0D,QAAQ,CAACN,KAAK,CAAC,IAAIA,KAAK,CAACO,QAAQ,CAAC,IAAI,CAAC,EAChD;aACC,MAAMzB,EAAE,GAAGkB,KAAK,CAACQ,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC;aAElC,OAAQ,GAAEN,KAAM,MAAKpB,EAAG,GAAE;;WAG3B,OAAQ,GAAEoB,KAAM,OAAMF,KAAM,GAAE;;SAG/B,OAAO,IAAI;QACX,CAAC,CAACS,MAAM,CAACC,OAAO,CAAC;OAElB,IAAI,IAAI,CAACzE,IAAI,CAACe,QAAQ,EACtB;SACC,IAAI,CAACI,KAAK,CAAC,mBAAmB,EAAEO,SAAS,CAACgD,IAAI,CAAC,GAAG,CAAC,CAAC;QACpD,MAED;SACC,IAAI,CAACvD,KAAK,CAAC,mBAAmB,EAAEO,SAAS,CAACb,MAAM,GAAG,CAAC,GAAGa,SAAS,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;;MAE1E;KACDiD,mBAAmB,GACnB;OACC,MAAMC,aAAa,GAAG,IAAI,CAACC,mBAAmB,EAAE;OAChD,IAAID,aAAa,CAAC/D,MAAM,KAAK,CAAC,EAC9B;SACC,OAAO,EAAE;;OAGV,MAAMiE,YAAY,GAAGF,aAAa,CAACf,GAAG,CAAEkB,OAAO,IAAK,IAAI,CAACC,UAAU,CAACD,OAAO,CAAC,CAAC;OAE7E,OAAOD,YAAY,CAACN,MAAM,CAACC,OAAO,CAAC;MACnC;KACDI,mBAAmB,GACnB;OACC,MAAM;SAAE1E,UAAU;SAAEH;QAAM,GAAG,IAAI;OAEjC,IAAIA,IAAI,CAACe,QAAQ,IAAIJ,cAAI,CAACsE,cAAc,CAAC9E,UAAU,CAAC,EACpD;SACC,OAAOA,UAAU,CAAC+E,KAAK,CAAC,GAAG,CAAC;;OAG7B,IAAIvE,cAAI,CAACC,OAAO,CAACT,UAAU,CAAC,EAC5B;SACC,OAAOA,UAAU;;OAGlB,OAAOA,UAAU,GAAG,CAACC,MAAM,CAACD,UAAU,CAAC,CAAC,GAAG,EAAE;MAC7C;KACD6E,UAAU,CAACG,QAAgB,EAC3B;OACC,MAAM5D,KAAK,GAAGnB,MAAM,CAAC+E,QAAQ,CAAC,CAACC,IAAI,EAAE;OACrC,IAAI,CAAC7D,KAAK,EACV;SACC,OAAO,IAAI;;OAGZ,KAAK,MAAM8D,MAAM,IAAIrC,aAAa,EAClC;SACC,MAAME,KAAK,GAAG3B,KAAK,CAAC2B,KAAK,CAACmC,MAAM,CAACjD,QAAQ,CAAC;SAC1C,IAAIc,KAAK,EACT;WACC,OAAOmC,MAAM,CAACpC,MAAM,CAACC,KAAK,CAAC;;;OAI7B,OAAO,CAACJ,YAAY,CAAChE,IAAI,EAAEyC,KAAK,CAAC;MACjC;KACD8B,kBAAkB,GAClB;OACC,IAAI,CAACE,WAAW,GAAG,IAAI+B,6BAAW,CAAC;SAClCvE,QAAQ,EAAE,IAAI,CAACf,IAAI,CAACe,QAAQ;SAC5BwE,gBAAgB,EAAE,KAAK;SACvBC,aAAa,EAAE;WACdC,OAAO,EAAG,yBAAwB,IAAI,CAACzF,IAAI,CAAC6C,EAAG,EAAC;WAChD6C,gBAAgB,EAAE,IAAI,CAACf,mBAAmB,EAAE;WAC5CgB,YAAY,EAAE;aACbC,SAAS,EAAE;YACX;WACDC,KAAK,EAAE,GAAG;WACVC,QAAQ,EAAE,CACT;aACCjD,EAAE,EAAEC,YAAY,CAAChE,IAAI;aACrB2D,OAAO,EAAE;eAAEsD,kBAAkB,EAAE;;YAC/B,EACD;aACClD,EAAE,EAAEC,YAAY,CAACC,UAAU;aAC3BN,OAAO,EAAE;eACRuD,UAAU,EAAE,qBAAqB;eACjCC,yBAAyB,EAAE,IAAI;eAC/BC,oBAAoB,EAAE;;YAEvB,CACD;WACDnF,QAAQ,EAAE,IAAI,CAACf,IAAI,CAACe,QAAQ;WAC5BoF,WAAW,EAAE,IAAI;WACjBC,YAAY,EAAE,IAAI;WAClBC,WAAW,EAAE,IAAI;WACjBC,MAAM,EAAE;UACR;SACDC,gBAAgB,EAAEC,aAAG,CAACC,UAAU,CAAC,8CAA8C,CAAC;SAChFC,MAAM,EAAE;WACPC,aAAa,EAAE,IAAI,CAACjD,SAAS;WAC7BkD,gBAAgB,EAAE,IAAI,CAAClD;;QAExB,CAAC;OAEF,IAAI,CAACH,WAAW,CAACsD,QAAQ,CAAC,IAAI,CAAC/E,KAAK,CAACgF,SAAS,CAAC;;IAEhD;GACD1E,QAAQ,EAAG;;;CAGZ,CAAC;;CCrLD,MAAM2E,eAAe,GAAG,IAAI;;CAE5B;AACA,CAAO,MAAMC,gBAAgB,GAAG;GAC/BlH,IAAI,EAAE,kBAAkB;GACxBC,KAAK,EAAE;KACNC,IAAI,EAAE;OACLC,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;MACV;KACDC,UAAU,EAAE;OACXF,IAAI,EAAE,CAACG,MAAM,EAAEC,KAAK,CAAC;OACrBC,OAAO,EAAE;;IAEV;GACDC,KAAK,EAAE,CAAC,mBAAmB,CAAC;GAC5BC,QAAQ,EACP;KACCC,cAAc,GACd;OACC,MAAMC,KAAK,GAAG,IAAI,CAACP,UAAU;OAC7B,IAAIQ,cAAI,CAACC,OAAO,CAACF,KAAK,CAAC,IAAIA,KAAK,CAACG,MAAM,GAAG,CAAC,EAC3C;SACC,OAAOH,KAAK;;OAGb,OAAO,CAAC,EAAE,CAAC;MACX;KACDuG,aAAa,GACb;OACC,OAAOF,eAAe;MACtB;KACDjG,cAAc,GACd;OACC,OAAO,IAAI,CAACd,IAAI,CAACe,QAAQ,IAAI,IAAI,CAACN,cAAc,CAACI,MAAM,GAAG,CAAC;;IAE5D;GACFG,OAAO,EAAE;KACRkG,cAAc,CAAC3F,KAAa,EAC5B;OACC,MAAMV,MAAM,GAAG,CAACU,KAAK,IAAI,EAAE,EAAEV,MAAM;OAEnC,OAAQ,GAAEA,MAAO,IAAG,IAAI,CAACoG,aAAc,EAAC;MACxC;KACDE,aAAa,CAAC9F,KAAgB,EAC9B;OACC,IAAI+F,YAAY,GAAG/F,KAAK,CAACC,MAAM,CAACC,KAAK;OACrC,IAAI6F,YAAY,CAACvG,MAAM,GAAG,IAAI,CAACoG,aAAa,EAC5C;SACCG,YAAY,GAAGA,YAAY,CAACC,KAAK,CAAC,CAAC,EAAE,IAAI,CAACJ,aAAa,CAAC;SACxD5F,KAAK,CAACC,MAAM,CAACC,KAAK,GAAG6F,YAAY;;OAElC,IAAI,CAACjG,KAAK,CAAC,mBAAmB,EAAEiG,YAAY,CAAC;MAC7C;KACDE,eAAe,CAACjG,KAAgB,EAAEI,KAAa,EAC/C;OACC,IAAI2F,YAAY,GAAG/F,KAAK,CAACC,MAAM,CAACC,KAAK;OACrC,IAAI6F,YAAY,CAACvG,MAAM,GAAG,IAAI,CAACoG,aAAa,EAC5C;SACCG,YAAY,GAAGA,YAAY,CAACC,KAAK,CAAC,CAAC,EAAE,IAAI,CAACJ,aAAa,CAAC;SACxD5F,KAAK,CAACC,MAAM,CAACC,KAAK,GAAG6F,YAAY;;OAElC,MAAM1F,SAAS,GAAG,CAAC,GAAG,IAAI,CAACjB,cAAc,CAAC;OAC1CiB,SAAS,CAACD,KAAK,CAAC,GAAG2F,YAAY;OAE/B,IAAI,CAACjG,KAAK,CAAC,mBAAmB,EAAEO,SAAS,CAAC;MAC1C;KACD,MAAMC,QAAQ,GACd;OACC,IAAI,CAAC,IAAI,CAAC3B,IAAI,CAACe,QAAQ,EACvB;SACC;;OAED,MAAMW,SAAS,GAAG,CAAC,GAAG,IAAI,CAACjB,cAAc,EAAE,EAAE,CAAC;OAC9C,IAAI,CAACU,KAAK,CAAC,mBAAmB,EAAEO,SAAS,CAAC;OAE1C,MAAM,IAAI,CAACE,SAAS,EAAE;OACtB,MAAM2F,MAAM,GAAG,IAAI,CAACzF,KAAK,CAAC0F,cAAc;OACxC,IAAID,MAAM,IAAIA,MAAM,CAAC1G,MAAM,GAAG,CAAC,EAC/B;SACC,MAAM4G,SAAS,GAAGF,MAAM,CAACA,MAAM,CAAC1G,MAAM,GAAG,CAAC,CAAC;SAC3C4G,SAAS,CAACxF,KAAK,EAAE;;MAElB;KACDC,WAAW,CAACT,KAAa,EACzB;OACC,IAAI,CAAC,IAAI,CAACX,cAAc,EACxB;SACC;;OAED,MAAMY,SAAS,GAAG,CAAC,GAAG,IAAI,CAACjB,cAAc,CAAC;OAC1CiB,SAAS,CAACS,MAAM,CAACV,KAAK,EAAE,CAAC,CAAC;OAC1B,IAAI,CAACN,KAAK,CAAC,mBAAmB,EAAEO,SAAS,CAAC;;IAE3C;GACDU,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAyDZ,CAAC;;CCzJD;AACA,CAAO,MAAMsF,iBAAiB,GAAG;GAChC5H,IAAI,EAAE,mBAAmB;GACzB6H,UAAU,EAAE;sBACXC;IACA;GACD7H,KAAK,EAAE;;KAENC,IAAI,EAAE;OACLC,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;MACV;KACDC,UAAU,EAAE;OACXF,IAAI,EAAE,CAACI,KAAK,EAAED,MAAM,CAAC;OACrBE,OAAO,EAAE,MAAM;MACf;KACDuH,UAAU,EAAE;OACX5H,IAAI,EAAEwE,OAAO;OACbnE,OAAO,EAAE;;IAEV;GACDC,KAAK,EAAE,CAAC,mBAAmB,CAAC;GAC5BC,QAAQ,EAAE;KACTe,KAAK,EAAE;OACNgB,GAAG,GACH;SACC,OAAO,IAAI,CAACpC,UAAU;QACtB;OACDqC,GAAG,CAACtB,QAAgC,EACpC;SACC,IAAI,CAACC,KAAK,CAAC,mBAAmB,EAAED,QAAQ,CAAC;;MAE1C;KACD4G,eAAe,GACf;OACC,OAAO,IAAI,CAAC9H,IAAI,CAAC+H,WAAW,IAAI,IAAI,CAAC/H,IAAI,CAAC+H,WAAW,CAAClH,MAAM,GAAG,CAAC;;IAEjE;GACDuB,QAAQ,EAAG;;;;;;;;;;;;;;;CAeZ,CAAC;;CCnDD,MAAMU,cAAY,GAAG1E,MAAM,CAACC,MAAM,CAAC;GAClCc,OAAO,EAAE;CACV,CAAC,CAAC;;CAEF;AACA,CAAO,MAAM6I,eAAe,GAAG;GAC9BlI,IAAI,EAAE,iBAAiB;GACvBC,KAAK,EAAE;KACNC,IAAI,EAAE;OACLC,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;MACV;KACDC,UAAU,EAAE;OACXF,IAAI,EAAE,CAACG,MAAM,EAAEC,KAAK,EAAE4H,MAAM,CAAC;OAC7B3H,OAAO,EAAE;MACT;KACD4H,QAAQ,EAAE;OACTjI,IAAI,EAAEwE,OAAO;OACbnE,OAAO,EAAE;;IAEV;GACDC,KAAK,EAAE,CAAC,mBAAmB,CAAC;GAC5B6C,OAAO,GACP;KACC,IAAI,CAACC,kBAAkB,EAAE;IACzB;GACDC,aAAa,GACb;KACC,IAAI,IAAI,CAACC,WAAW,EACpB;OACC,IAAI,CAACA,WAAW,CAACC,SAAS,EAAE,CAACC,OAAO,EAAE;OACtC,IAAI,CAACF,WAAW,GAAG,IAAI;;IAExB;GACDvC,OAAO,EAAE;KACR0C,SAAS,GACT;OACC,IAAI,CAAC,IAAI,CAACH,WAAW,EACrB;SACC;;OAGD,MAAMI,IAAI,GAAG,IAAI,CAACJ,WAAW,CAACK,OAAO,EAAE;OACvC,MAAMlC,SAAS,GAAGiC,IAAI,CAACE,GAAG,CAAEC,GAAY,IAAK;SAC5C,OAAOA,GAAG,CAACE,KAAK,EAAE;QAClB,CAAC,CAACQ,MAAM,CAACC,OAAO,CAAC;OAElB,IAAI,IAAI,CAACzE,IAAI,CAACe,QAAQ,EACtB;SACC,IAAI,CAACI,KAAK,CAAC,mBAAmB,EAAEO,SAAS,CAAC;QAC1C,MAED;SACC,IAAI,CAACP,KAAK,CAAC,mBAAmB,EAAEO,SAAS,CAACb,MAAM,GAAG,CAAC,GAAGa,SAAS,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;;MAE1E;KACDiD,mBAAmB,GACnB;OACC,OAAO,IAAI,CAACwD,oBAAoB,EAAE,CAACtE,GAAG,CAAEtC,KAAa,IAAa,CAACuB,cAAY,CAAC3D,OAAO,EAAEoC,KAAK,CAAC,CAAC;MAChG;KACD4G,oBAAoB,GACpB;OACC,IAAIxH,cAAI,CAACC,OAAO,CAAC,IAAI,CAACT,UAAU,CAAC,EACjC;SACC,OAAO,IAAI,CAACA,UAAU,CACpB0D,GAAG,CAAEuE,CAAC,IAAKH,MAAM,CAACG,CAAC,CAAC,CAAC,CACrB5D,MAAM,CAAE4D,CAAS,IAAKzH,cAAI,CAAC0H,QAAQ,CAACD,CAAC,CAAC,CAAC;;OAI1C,OAAO,IAAI,CAACjI,UAAU,GACnB,CAAC8H,MAAM,CAAC,IAAI,CAAC9H,UAAU,CAAC,CAAC,CAACqE,MAAM,CAAE4D,CAAS,IAAKzH,cAAI,CAAC0H,QAAQ,CAACD,CAAC,CAAC,CAAC,GACjE,EAAE;MAEL;KACD/E,kBAAkB,GAClB;OACC,IAAI,CAACE,WAAW,GAAG,IAAI+B,6BAAW,CAAC;SAClCvE,QAAQ,EAAE,IAAI,CAACf,IAAI,CAACe,QAAQ;SAC5ByE,aAAa,EAAE;WACdC,OAAO,EAAG,4BAA2B,IAAI,CAACzF,IAAI,CAAC6C,EAAG,EAAC;WACnD8C,YAAY,EAAE;aACbC,SAAS,EAAE;YACX;WACDC,KAAK,EAAE,GAAG;WACVC,QAAQ,EAAE,CACT;aACCjD,EAAE,EAAEC,cAAY,CAAC3D;YACjB,CACD;WACD4B,QAAQ,EAAE,IAAI,CAACf,IAAI,CAACe,QAAQ;WAC5BqF,YAAY,EAAE,IAAI;WAClBC,WAAW,EAAE,IAAI;WACjBC,MAAM,EAAE,GAAG;WACXZ,gBAAgB,EAAE,IAAI,CAACf,mBAAmB;UAC1C;SACD+B,MAAM,EAAE;WACPC,aAAa,EAAE,IAAI,CAACjD,SAAS;WAC7BkD,gBAAgB,EAAE,IAAI,CAAClD;;QAExB,CAAC;OAEF,IAAI,CAACH,WAAW,CAACsD,QAAQ,CAAC,IAAI,CAAC/E,KAAK,CAACgF,SAAS,CAAC;;IAEhD;GACD1E,QAAQ,EAAG;;;CAGZ,CAAC;;CCzGD;AACA,CAAO,MAAMkG,YAAY,GAAG;GAC3BxI,IAAI,EAAE,cAAc;GACpB6H,UAAU,EAAE;0BACXY;IACA;GACDC,MAAM,EAAE,CAAC,YAAY,CAAC;GACtBzI,KAAK,EAAE;;KAENC,IAAI,EAAE;OACLC,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;MACV;KACDC,UAAU,EAAE;OACXF,IAAI,EAAE,CAACG,MAAM,EAAEC,KAAK,EAAE4H,MAAM,CAAC;OAC7B3H,OAAO,EAAE;MACT;KACD4H,QAAQ,EAAE;OACTjI,IAAI,EAAEwE,OAAO;OACbnE,OAAO,EAAE;;IAEV;GACDC,KAAK,EAAE,CAAC,mBAAmB,CAAC;GAC5BC,QAAQ,EAAE;KACTiI,eAAe,GACf;OACC,OAAO;SACNC,UAAU,EAAE,sDAAsD;SAClEC,iBAAiB,EAAE;WAClBC,UAAU,EAAE,IAAI,CAACA;UACjB;SACDC,KAAK,EAAE,IAAI,CAACV,oBAAoB,EAAE;SAClCpH,QAAQ,EAAE,IAAI,CAACf,IAAI,CAACe,QAAQ;SAC5B+H,UAAU,EAAE,IAAI;SAChBC,qBAAqB,EAAE,IAAI,CAACjH,KAAK,CAACkH,oBAAoB;SACtDtC,MAAM,EAAE;WACP,CAACuC,8BAAa,CAACC,aAAa,GAAG,MAAY;aAC1C,IAAI,CAACxF,SAAS,EAAE;YAChB;WACD,CAACuF,8BAAa,CAACE,WAAW,GAAG,MAAY;aACxC,IAAI,CAACzF,SAAS,EAAE;;;QAGlB;MACD;KACD0F,aAAa,GACb;OACC,OAAO;SACNC,QAAQ,EAAE,IAAI,CAACnB,QAAQ;SACvBoB,YAAY,EAAE,IAAI,CAACpB;QACnB;;IAEF;GACDlH,OAAO,EAAE;KACR0C,SAAS,GACT;OAAA;OACC,MAAM6F,QAAkB,kBAAG,IAAI,CAACzH,KAAK,8CAAV,YAAY0H,UAAU,qBAAtB,sBAAwBD,QAAQ;OAC3D,IAAI,CAACA,QAAQ,EACb;SACC;;OAGD,MAAME,OAA+B,GAAGF,QAAQ,CAC9CG,QAAQ,EAAE,CACV7F,GAAG,CAAEtC,KAAmB,IAAaA,KAAK,CAACoI,eAAe,EAAE,CAAC,CAC7DnF,MAAM,CAAE3B,EAAE,IAAKlC,cAAI,CAACsE,cAAc,CAACpC,EAAE,CAAC,IAAIlC,cAAI,CAAC0H,QAAQ,CAACxF,EAAE,CAAC,CAAC;OAG9D,IAAI,IAAI,CAAC7C,IAAI,CAACe,QAAQ,EACtB;SACC,IAAI,CAACI,KAAK,CAAC,mBAAmB,EAAEsI,OAAO,CAAC;QACxC,MAED;SACC,IAAI,CAACtI,KAAK,CAAC,mBAAmB,EAAEsI,OAAO,CAAC5I,MAAM,GAAG,CAAC,GAAG4I,OAAO,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;;MAEtE;KACDtB,oBAAoB,GACpB;OACC,IAAIxH,cAAI,CAACC,OAAO,CAAC,IAAI,CAACT,UAAU,CAAC,EACjC;SACC,OAAO,IAAI,CAACA,UAAU;;OAGvB,OAAO,IAAI,CAACA,UAAU,GAAG,CAAC,IAAI,CAACA,UAAU,CAAC,GAAG,EAAE;;IAEhD;GACDiC,QAAQ,EAAG;;;;CAIZ,CAAC;;CCxFD,MAAMwH,gBAAgB,GAAG;GACxB,CAACjL,cAAc,CAACK,IAAI,GAAG,kBAAkB;GACzC,CAACL,cAAc,CAACC,MAAM,GAAG,iBAAiB;GAC1C,CAACD,cAAc,CAACE,GAAG,GAAG,iBAAiB;GACvC,CAACF,cAAc,CAACM,MAAM,GAAG,gBAAgB;GACzC,CAACN,cAAc,CAACG,IAAI,GAAG,cAAc;GACrC,CAACH,cAAc,CAACO,SAAS,GAAG,mBAAmB;GAC/C,CAACP,cAAc,CAACQ,OAAO,GAAG,iBAAiB;GAC3C,CAACR,cAAc,CAACI,IAAI,GAAG;CACxB,CAAC;;CAED;AACA,CAAO,MAAM8K,iBAAiB,GAAG;GAChC/J,IAAI,EAAE,mBAAmB;GACzB6H,UAAU,EAAE;KACX9H,eAAe;KACfwC,cAAc;KACdc,YAAY;KACZ6D,gBAAgB;KAChBU,iBAAiB;KACjBM,eAAe;KACfM;IACA;GACDvI,KAAK,EAAE;;KAENC,IAAI,EAAE;OACLC,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;MACV;KACD4J,QAAQ,EAAE;OACT7J,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;MACV;KACD6J,KAAK,EAAE;OACN9J,IAAI,EAAEG,MAAM;OACZE,OAAO,EAAE;;IAEV;GACDC,KAAK,EAAE,CAAC,gBAAgB,CAAC;GACzBC,QAAQ,EACR;KACCwJ,aAAa,EACb;OACCzH,GAAG,GACH;SACC,OAAO,IAAI,CAAC0H,uBAAuB,EAAE;QACrC;OACDzH,GAAG,CAACtB,QAAQ,EACZ;SACC,IAAI,CAACC,KAAK,CAAC,gBAAgB,EAAE,IAAI,CAACnB,IAAI,CAAC6C,EAAE,EAAE3B,QAAQ,CAAC;;MAErD;KACDgJ,cAAc,GACd;OACC,OAAON,gBAAgB,CAAC,IAAI,CAAC5J,IAAI,CAACmK,YAAY,CAAC,IAAI,IAAI;MACvD;KACDtC,UAAU,GACV;OACC,OAAO,IAAI,CAAC7H,IAAI,CAACE,QAAQ;MACzB;KACDkK,gBAAgB,GAChB;OACC,OAAO,IAAI,CAACpK,IAAI,CAACmK,YAAY,KAAKxL,cAAc,CAACO,SAAS;;IAE3D;GACD8B,OAAO,EAAE;KACRiJ,uBAAuB,GACvB;OACC,MAAM7C,YAAY,GAAG,IAAI,CAAC0C,QAAQ,CAAC,IAAI,CAAC9J,IAAI,CAAC6C,EAAE,CAAC;OAEhD,IAAI,IAAI,CAAC7C,IAAI,CAACe,QAAQ,EACtB;SACC,IAAIJ,cAAI,CAACC,OAAO,CAACwG,YAAY,CAAC,EAC9B;WACC,OAAOA,YAAY;;SAGpB,IAAIA,YAAY,EAChB;WACC,OAAO,CAACA,YAAY,CAAC;;SAGtB,OAAO,EAAE;;OAGV,OAAOA,YAAY,WAAZA,YAAY,GAAI,EAAE;;IAE1B;GACDhF,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAgCZ,CAAC;;CClID;;CAGA;AACA,CAAO,MAAMiI,kBAAkB,GAAG;GACjCvK,IAAI,EAAE,oBAAoB;GAC1BC,KAAK,EAAE;;KAENC,IAAI,EAAE;OACLC,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;;IAEX;GACDkC,QAAQ,EAAG;;;CAGZ,CAAC;;CChBD;;CAGA;AACA,CAAO,MAAMkI,oBAAoB,GAAG;GACnCxK,IAAI,EAAE,sBAAsB;GAC5BC,KAAK,EAAE;;KAENC,IAAI,EAAE;OACLC,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;;IAEX;GACDkC,QAAQ,EAAG;;;;;CAKZ,CAAC;;CClBD;;CAGA;AACA,CAAO,MAAMmI,cAAc,GAAG;GAC7BzK,IAAI,EAAE,gBAAgB;GACtBC,KAAK,EAAE;;KAENC,IAAI,EAAE;OACLC,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;;IAEX;GACDkC,QAAQ,EAAG;;;;;CAKZ,CAAC;;CChBD;;CAGA;AACA,CAAO,MAAMoI,kBAAkB,GAAG;GACjC1K,IAAI,EAAE,oBAAoB;GAC1BC,KAAK,EAAE;;KAENC,IAAI,EAAE;OACLC,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;;IAEX;GACDM,QAAQ,EAAE;KACTiK,mBAAmB,GACnB;OACC,OAAOjL,kBAAkB,CAAC,IAAI,CAACQ,IAAI,CAAC0K,IAAI,CAAC,IAAIlL,kBAAkB,CAACC,KAAK;;IAEtE;GACD2C,QAAQ,EAAG;;;;;;;;;CASZ,CAAC;;CCrBD,MAAMuI,YAAY,GAAG;GACpB,CAACxM,UAAU,CAACI,KAAK,GAAG,gBAAgB;GACpC,CAACJ,UAAU,CAACK,eAAe,GAAG,oBAAoB;GAClD,CAACL,UAAU,CAACM,WAAW,GAAG,sBAAsB;GAChD,CAACN,UAAU,CAACG,SAAS,GAAG,oBAAoB;GAC5C,CAACH,UAAU,CAACO,QAAQ,GAAG;CACxB,CAAC;;CAED;AACA,OAAakM,WAAW,GAAG;GAC1B9K,IAAI,EAAE,aAAa;GACnB6H,UAAU,EAAE;KACX4C,cAAc;KACdC,kBAAkB;KAClBH,kBAAkB;KAClBC,oBAAoB;KACpBT;IACA;GACD9J,KAAK,EAAE;;KAENC,IAAI,EAAE;OACLC,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;MACV;KACD4J,QAAQ,EAAE;OACT7J,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;MACV;KACD2K,MAAM,EAAE;OACP5K,IAAI,EAAE7B,MAAM;OACZ8B,QAAQ,EAAE;;IAEX;GACDK,KAAK,EAAE,CAAC,gBAAgB,CAAC;GACzBC,QAAQ,EAAE;KACTsK,aAAa,GACb;OACC,OAAOH,YAAY,CAAC,IAAI,CAAC3K,IAAI,CAAC+K,QAAQ,CAAC,IAAI,IAAI;MAC/C;KACDC,gBAAgB,GAChB;OACC,IAAI,IAAI,CAAChL,IAAI,CAAC+K,QAAQ,KAAK5M,UAAU,CAACO,QAAQ,EAC9C;SACC,OAAO,IAAI,CAACoL,QAAQ;;OAGrB,OAAOmB,SAAS;;IAEjB;GACDjK,OAAO,EAAE;KACRkK,cAAc,CAACC,UAAkB,EAAE5J,KAAa,EAChD;OACC,IAAI,CAACJ,KAAK,CAAC,gBAAgB,EAAEgK,UAAU,EAAE5J,KAAK,CAAC;;IAEhD;GACDa,QAAQ,EAAG;;;;;;;;;;CAUZ,CAAC;;CC9DD,MAAMgJ,iBAAiB,GAAG,CAAC;CAE3B,MAAMC,mBAAmB,GAAG,oCAAoC;;CAEhE;AACA,OAAaC,qBAAqB,GAAG;GACpCxL,IAAI,EAAE,uBAAuB;GAC7B6H,UAAU,EAAE;KAAEiD;IAAa;GAC3BW,OAAO,GACP;KACC,OAAO;OACN3C,UAAU,EAAE,IAAI,CAACA;MACjB;IACD;GACD7I,KAAK,EAAE;KACN6I,UAAU,EAAE;OACX3I,IAAI,EAAEgI,MAAM;OACZ/H,QAAQ,EAAE;MACV;KACDsL,YAAY,EAAE;OACbvL,IAAI,EAAEG,MAAM;OACZF,QAAQ,EAAE;MACV;KACDuL,mBAAmB,EAAE;OACpBxL,IAAI,EAAEG,MAAM;OACZE,OAAO,EAAE;MACT;KACDoL,UAAU,EAAE;OACXzL,IAAI,EAAEG,MAAM;OACZF,QAAQ,EAAE;MACV;;KAEDyL,MAAM,EAAE;OACP1L,IAAI,EAAEI,KAAK;OACXH,QAAQ,EAAE;;IAEX;GACD0L,IAAI,GAOJ;KACC,OAAO;OACNC,WAAW,EAAE,CAAC;OACdC,SAAS,EAAE,KAAK;OAChBC,WAAW,EAAE,EAAE;OACfC,gBAAgB,EAAE,EAAE;OACpBlC,QAAQ,EAAE,IAAI,CAACmC,4BAA4B;MAC3C;IACD;GACDzL,QAAQ,EACR;KACC0L,YAAY,GACZ;OACC,OAAO,IAAI,CAACP,MAAM,CAChBQ,OAAO,CAAEC,KAAK,IAAKA,KAAK,CAACC,KAAK,CAAC,CAC/B7H,MAAM,CAAExE,IAAI,IAAKA,IAAI,CAAC+K,QAAQ,KAAK5M,UAAU,CAACO,QAAQ,CAAC;MAEzD;KACD4N,aAAa,GACb;OACC,OAAO,IAAI,CAACR,SAAS;MACrB;KACDS,WAAW,GACX;OACC,OAAO,IAAI,CAACV,WAAW,KAAK,CAAC;MAC7B;KACDW,UAAU,GACV;OACC,OAAOpB,iBAAiB;MACxB;KACDqB,UAAU,GACV;OACC,MAAMC,WAAW,GAAG,IAAI,CAACH,WAAW,GACjC,gDAAgD,GAChD,2CAA2C;OAG9C,OAAO,IAAI,CAACI,OAAO,CAACnG,GAAG,CAACC,UAAU,CAACiG,WAAW,CAAC;MAC/C;KACDE,kBAAkB,GAClB;OACC,OAAO,IAAI,CAACL,WAAW,GAAG,IAAI,CAACM,iBAAiB,GAAG,IAAI,CAACC,YAAY;;IAErE;GACD9L,OAAO,EAAE;KACRiL,4BAA4B,GAC5B;OACC,MAAMc,WAAW,GAAG,EAAE;OACtB,IAAI,CAACpB,MAAM,CAACqB,OAAO,CAAEZ,KAAK,IAAK;SAC9BA,KAAK,CAACC,KAAK,CAACW,OAAO,CAAEhN,IAAI,IAAK;WAC7B,IAAIA,IAAI,CAAC+K,QAAQ,KAAK5M,UAAU,CAACO,QAAQ,EACzC;aAAA;aACCqO,WAAW,CAAC/M,IAAI,CAAC6C,EAAE,CAAC,oBAAG7C,IAAI,CAACM,OAAO,4BAAI,EAAE;;UAE1C,CAAC;QACF,CAAC;OAEF,OAAOyM,WAAW;MAClB;KACDE,yBAAyB,GACzB;OACC,MAAMC,YAAY,GAAG,EAAE;OAEvB,IAAI,CAAChB,YAAY,CAACc,OAAO,CAAEhN,IAAI,IAAK;SACnC,MAAMmN,GAAG,GAAGnN,IAAI,CAAC6C,EAAE;SACnB,MAAMtB,KAAK,GAAG,IAAI,CAACuI,QAAQ,CAACqD,GAAG,CAAC;SAEhC,IAAI,IAAI,CAACC,YAAY,CAAC7L,KAAK,CAAC,EAC5B;WACC;;SAGD,IAAIZ,cAAI,CAACC,OAAO,CAACW,KAAK,CAAC,EACvB;WACC,IAAI8L,cAAc,GAAG9L,KAAK,CAACiD,MAAM,CAAE8I,GAAG,IAAK,CAAC,IAAI,CAACF,YAAY,CAACE,GAAG,CAAC,CAAC;WACnE,IAAID,cAAc,CAACxM,MAAM,KAAK,CAAC,EAC/B;aACC;;WAGD,IAAIb,IAAI,CAACmK,YAAY,KAAKxL,cAAc,CAACE,GAAG,EAC5C;aACCwO,cAAc,GAAGA,cAAc,CAACxJ,GAAG,CAACoE,MAAM,CAAC;;WAG5CiF,YAAY,CAACC,GAAG,CAAC,GAAGE,cAAc;UAClC,MACI,IAAIrN,IAAI,CAACmK,YAAY,KAAKxL,cAAc,CAACE,GAAG,EACjD;WACCqO,YAAY,CAACC,GAAG,CAAC,GAAGlF,MAAM,CAAC1G,KAAK,CAAC;UACjC,MAED;WACC2L,YAAY,CAACC,GAAG,CAAC,GAAG5L,KAAK;;QAE1B,CAAC;OAEF,OAAO2L,YAAY;MACnB;KACDK,uBAAuB,GACvB;OACC,MAAMC,oBAAoB,GAAG,+BAA+B;OAE5D,MAAMC,cAAc,GAAG,IAAI,CAACR,yBAAyB,EAAE;OAEvD,OAAOS,cAAI,CAACC,SAAS,CAACH,oBAAoB,EAAE;SAC3C5B,IAAI,EAAE;WACLhD,UAAU,EAAE,IAAI,CAACA,UAAU;WAC3B8C,UAAU,EAAE,IAAI,CAACA,UAAU;WAC3B+B;;QAED,CAAC;MACF;KACDG,oBAAoB,CAACC,QAAgB,EACrC;OACC,IAAI,CAACA,QAAQ,CAAChD,MAAM,EACpB;SACC,OAAO,EAAE;;OAGV,IAAI,CAAClK,cAAI,CAACmN,aAAa,CAACD,QAAQ,CAAChD,MAAM,CAAC,EACxC;SACC,OAAO,IAAI,CAAC8B,OAAO,CAACnG,GAAG,CAACC,UAAU,CAAC,iDAAiD,CAAC;;OAGtF,MAAM,CAACsH,UAAU,CAAC,GAAGF,QAAQ,CAAChD,MAAM;OAEpC,OAAOkD,UAAU,CAACC,OAAO;MACzB;KACD,MAAMlB,YAAY,GAClB;OACC,IAAI,CAAC,IAAI,CAACmB,YAAY,EAAE,EACxB;SACC;;OAGD,IAAI,CAACnC,SAAS,GAAG,IAAI;OACrB,IAAI,CAACC,WAAW,GAAG,EAAE;OACrB,IACA;SACC,MAAMmC,QAAmB,GAAG,MAAMC,6BAAY,CAACC,SAAS,CAAC/C,mBAAmB,CAAC;SAC7E,IAAI6C,QAAQ,CAACG,QAAQ,CAAC,KAAK,CAAC,EAC5B;WACC,IAAI,CAACvC,SAAS,GAAG,KAAK;WAEtB;;SAED,MAAM,IAAI,CAACyB,uBAAuB,EAAE;SACpC,MAAMlM,KAAK,GAAG,IAAIiN,0BAAS,CAC1B;WACC1C,IAAI,EAAE;aACLhD,UAAU,EAAE,IAAI,CAACA;;UAElB,CACD;SACDuF,6BAAY,CAACI,IAAI,CAACjP,yBAAyB,CAACC,OAAO,EAAE8B,KAAK,CAAC;SAC3DmN,EAAE,CAACC,SAAS,CAACC,QAAQ,CAACC,KAAK,EAAE;QAC7B,CACD,OAAO5E,KAAK,EACZ;SACC,IAAI,CAACgC,WAAW,GAAG,IAAI,CAAC6B,oBAAoB,CAAC7D,KAAK,CAAC;;OAGpD,IAAI,CAAC+B,SAAS,GAAG,KAAK;MACtB;KACD8C,YAAY,GACZ;OACCJ,EAAE,CAACC,SAAS,CAACC,QAAQ,CAACC,KAAK,EAAE;MAC7B;KACDE,gBAAgB,CAAC1D,UAAkB,EAAE5J,KAAa,EAClD;OACC,IAAI,CAACuI,QAAQ,CAACqB,UAAU,CAAC,GAAG5J,KAAK;OAEjC,IAAI,IAAI,CAACyK,gBAAgB,CAACb,UAAU,CAAC,IAAI,CAAC,IAAI,CAACiC,YAAY,CAAC7L,KAAK,CAAC,EAClE;SACC,OAAO,IAAI,CAACyK,gBAAgB,CAACb,UAAU,CAAC;;MAEzC;KACDiC,YAAY,CAAC7L,KAAa,EAC1B;OACC,IAAIZ,cAAI,CAACC,OAAO,CAACW,KAAK,CAAC,IAAIA,KAAK,CAACV,MAAM,KAAK,CAAC,EAC7C;SACC,OAAO,IAAI;;OAGZ,MAAMiO,WAAW,GAAG,CAACvN,KAAK,WAALA,KAAK,GAAI,EAAE,EAAEwN,QAAQ,EAAE;OAE5C,OAAOD,WAAW,CAAC1J,IAAI,EAAE,CAACvE,MAAM,KAAK,CAAC;MACtC;KACDoN,YAAY,GACZ;OACC,IAAI,CAACjC,gBAAgB,GAAG,EAAE;OAC1B,MAAMgD,eAAe,GAAG,IAAI,CAAC9C,YAAY,CAAC1H,MAAM,CAAExE,IAAI,IAAKA,IAAI,CAACmK,YAAY,KAAKxL,cAAc,CAACO,SAAS,CAAC;OAE1G8P,eAAe,CAAChC,OAAO,CAAEhN,IAAI,IAAK;SACjC,MAAMuB,KAAK,GAAG,IAAI,CAACuI,QAAQ,CAAC9J,IAAI,CAAC6C,EAAE,CAAC;SACpC,IAAI7C,IAAI,CAACE,QAAQ,IAAI,IAAI,CAACkN,YAAY,CAAC7L,KAAK,CAAC,EAC7C;WACC,IAAI,CAACyK,gBAAgB,CAAChM,IAAI,CAAC6C,EAAE,CAAC,GAAG,IAAI,CAAC8J,OAAO,CAACnG,GAAG,CAACC,UAAU,CAAC,sDAAsD,CAAC;UACpH,MACI,IAAIzG,IAAI,CAACmK,YAAY,KAAKxL,cAAc,CAACE,GAAG,IAAI,IAAI,CAACoQ,WAAW,CAAC1N,KAAK,CAAC,EAC5E;WACC,IAAI,CAACyK,gBAAgB,CAAChM,IAAI,CAAC6C,EAAE,CAAC,GAAG,IAAI,CAAC8J,OAAO,CAACnG,GAAG,CAACC,UAAU,CAAC,0DAA0D,EAAE;aAAE,cAAc,EAAEzG,IAAI,CAACF;YAAM,CAAC;;QAExJ,CAAC;OAEF,OAAO1B,MAAM,CAAC8Q,IAAI,CAAC,IAAI,CAAClD,gBAAgB,CAAC,CAACnL,MAAM,KAAK,CAAC;MACtD;KACDoO,WAAW,CAAC1N,KAAa,EACzB;OACC,MAAM4N,KAAK,GAAI7B,GAAG,IAAK;SACtB,IAAI,IAAI,CAACF,YAAY,CAACE,GAAG,CAAC,EAC1B;WACC,OAAO,KAAK;;SAGb,OAAOrF,MAAM,CAACmH,KAAK,CAACnH,MAAM,CAACqF,GAAG,CAAC,CAAC;QAChC;OAED,IAAI3M,cAAI,CAACC,OAAO,CAACW,KAAK,CAAC,EACvB;SACC,OAAOA,KAAK,CAAC8N,IAAI,CAAErP,IAAI,IAAKmP,KAAK,CAACnP,IAAI,CAAC,CAAC;;OAGzC,OAAOmP,KAAK,CAAC5N,KAAK,CAAC;MACnB;KACDsL,iBAAiB,GACjB;OACC,IAAI,CAAChB,WAAW,EAAE;MAClB;KACDyD,aAAa,CAACC,IAAY,EAC1B;OACC,OAAO,IAAI,CAAC1D,WAAW,KAAK0D,IAAI;;IAEjC;GACDnN,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAiFZ,CAAC;;;;ACpXD,CAY+C;CAAA;CAAA;AAE/C,CAAO,MAAMoN,aAAa,CAC1B;GAICC,WAAW,CAAChN,OAA6B,EACzC;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KACC,4CAAI,4BAAcA,OAAO,CAACqE,SAAS;KACnC,4CAAI,0BAAarE,OAAO,CAACiN,QAAQ;;GAGlCC,KAAK,GACL;KACC,4CAAI,gCAAgBC,iBAAS,CAACC,SAAS,CAACvE,qBAAqB,EAAE;OAC9D1C,UAAU,EAAE,4CAAI,wBAAWA,UAAU;OACrC4C,YAAY,EAAE,4CAAI,wBAAWA,YAAY;OACzCC,mBAAmB,EAAE,4CAAI,wBAAWA,mBAAmB;OACvDC,UAAU,EAAE,4CAAI,wBAAWA,UAAU;OACrCC,MAAM,EAAE,4CAAI,wBAAWA;MACvB,CAAC;KACF,4CAAI,8BAAcgE,KAAK,yCAAC,IAAI,0BAAY;;GAGzCG,OAAO,GACP;KACC,4CAAI,IAAI,+BACR;OACC,4CAAI,8BAAcA,OAAO,EAAE;;;GAI7B,OAAOC,YAAY,CAACC,MAA6B,EACjD;KACC,MAAMlJ,SAAS,GAAGmJ,aAAG,CAACC,MAAM,cAAC,yCAAuC,EAAC;KACrE,MAAMC,GAAG,GAAG,IAAIX,aAAa,CAAC;OAC7B1I,SAAS;OACT4I,QAAQ,EAAEM;MACV,CAAC;KACFG,GAAG,CAACR,KAAK,EAAE;KAEX,OAAO7I,SAAS;;GAGjB,OAAOsJ,aAAa,CAACJ,MAA6B,EAClD;KACCxB,EAAE,CAACC,SAAS,CAACC,QAAQ,CAAC2B,IAAI,CAAC,6BAA6B,EAAE;OACzDxK,KAAK,EAAE,GAAG;OACVyK,SAAS,EAAE,KAAK;OAChBC,eAAe,EAAE,MAAMf,aAAa,CAACO,YAAY,CAACC,MAAM;MACxD,CAAC;;GAGH,OAAOQ,eAAe,GACtB;KACCC,gBAAI,CAACC,SAAS,CAAC;OACdC,QAAQ,EAAE,SAAS;OACnBC,OAAO,EAAE,6BAA6B;OACtCC,QAAQ,EAAGnB,QAA+B,IAAW;SACpDF,aAAa,CAACY,aAAa,CAACV,QAAQ,CAAC;;MAEtC,CAAC;;CAEJ;;;;;;;;;;"}