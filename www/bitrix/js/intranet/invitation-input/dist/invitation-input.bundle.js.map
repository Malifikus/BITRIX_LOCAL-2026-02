{"version":3,"file":"invitation-input.bundle.js","sources":["../src/provider/invitation-provider.js","../src/provider/invitation-to-group.js","../src/provider/invitation-to-portal.js","../src/invitation-input.js"],"sourcesContent":["export class InvitationProvider\n{\n\tinvite(): Promise\n\t{\n\t\tthrow new Error('Implement the method \"invite\" in the child class');\n\t}\n}\n","import { ajax, Loc, Type } from 'main.core';\nimport { InvitationProvider } from './invitation-provider';\n\nexport class InvitationToGroup extends InvitationProvider\n{\n\t#groupId: number;\n\t#users: Object;\n\n\tconstructor(groupId: number, users: Object)\n\t{\n\t\tsuper();\n\t\tthis.#groupId = groupId;\n\t\tthis.#users = users;\n\t}\n\n\tinvite(): Promise\n\t{\n\t\treturn ajax.runAction('intranet.invite.inviteUsersToCollab', {\n\t\t\tdata: {\n\t\t\t\tcollabId: this.#groupId,\n\t\t\t\tusers: this.#users,\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tconst users = response?.data || [];\n\n\t\t\tlet messageKey = null;\n\t\t\tconst newUsers = users.filter((u) => u.status === 'INVITED');\n\t\t\tconst existingUsers = users.filter((u) => u.status === 'ACTIVE');\n\n\t\t\tif (users.length === 0)\n\t\t\t{\n\t\t\t\tmessageKey = 'INTRANET_INVITATION_INPUT_NO_USERS';\n\t\t\t}\n\t\t\telse if (existingUsers.length === users.length)\n\t\t\t{\n\t\t\t\tmessageKey = (existingUsers.length === 1)\n\t\t\t\t\t? 'INTRANET_INVITATION_INPUT_ALREADY_IN_COLLAB_SINGLE'\n\t\t\t\t\t: 'INTRANET_INVITATION_INPUT_ALREADY_IN_COLLAB_ALL'\n\t\t\t\t;\n\t\t\t}\n\t\t\telse if (newUsers.length !== users.length)\n\t\t\t{\n\t\t\t\tmessageKey = 'INTRANET_INVITATION_INPUT_ALREADY_IN_COLLAB_PARTIAL';\n\t\t\t}\n\n\t\t\tif (messageKey)\n\t\t\t{\n\t\t\t\tconst notificationText = Loc.getMessage(messageKey);\n\t\t\t\tif (Type.isStringFilled(notificationText))\n\t\t\t\t{\n\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: notificationText,\n\t\t\t\t\t\tautoHideDelay: 2500,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn response;\n\t\t});\n\t}\n}\n","import { ajax } from 'main.core';\nimport { InvitationProvider } from './invitation-provider';\n\nexport class InvitationToPortal extends InvitationProvider\n{\n\t#users: Object;\n\n\tconstructor(users: Object)\n\t{\n\t\tsuper();\n\t\tthis.#users = users;\n\t}\n\n\tinvite(): Promise\n\t{\n\t\treturn ajax.runAction('intranet.v2.Invitation.inviteUsers', {\n\t\t\tdata: {\n\t\t\t\tinvitations: this.#users,\n\t\t\t},\n\t\t});\n\t}\n}\n","import { Cache, Dom, Tag, Validation, Loc, Extension, Type } from 'main.core';\nimport { MemoryCache } from 'main.core.cache';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { TagSelector } from 'ui.entity-selector';\nimport './style.css';\nimport type { InvitationProvider } from './provider/invitation-provider';\nimport { InvitationToGroup } from './provider/invitation-to-group';\nimport { InvitationToPortal } from './provider/invitation-to-portal';\n\nexport type InvitationInputOptionType = {\n\tplaceholder: ?string,\n\tminHeight: ?number,\n\tshowErrorBeforeSubmit: ?boolean,\n\tshowErrorAfterSubmit: ?boolean,\n};\n\nexport const InvitationInputType = Object.freeze({\n\tPHONE: 'phone',\n\tEMAIL: 'email',\n\tALL: 'all',\n});\n\nexport class InvitationInput extends EventEmitter\n{\n\t#cache: MemoryCache = new Cache.MemoryCache();\n\t#invalidPhoneNumbersTagIds: Array<string> = [];\n\t#isReadySendInvitation: boolean = false;\n\t#placeholder: string;\n\t#inputType: InvitationInputType;\n\t#isPhoneEnabled: boolean;\n\t#isEmailEnabled: boolean;\n\t#userLang: string = null;\n\t#minHeight: ?number = null;\n\t#showErrorBeforeSubmit: boolean;\n\t#showErrorAfterSubmit: boolean;\n\n\tconstructor(options: InvitationInputOptionType)\n\t{\n\t\tsuper();\n\t\tthis.#inputType = options?.inputType ?? InvitationInputType.ALL;\n\t\tthis.setEventNamespace('BX.Intranet.InvitationInput');\n\n\t\tthis.#minHeight = options?.minHeight;\n\t\tthis.#showErrorBeforeSubmit = Type.isBoolean(options?.showErrorBeforeSubmit)\n\t\t\t? options.showErrorBeforeSubmit\n\t\t\t: false;\n\t\tthis.#showErrorAfterSubmit = Type.isBoolean(options?.showErrorAfterSubmit)\n\t\t\t? options.showErrorAfterSubmit\n\t\t\t: true;\n\n\t\tconst settings = Extension.getSettings('intranet.invitation-input');\n\t\tif (this.#inputType === InvitationInputType.PHONE && !settings?.isInvitationByPhoneAvailable)\n\t\t{\n\t\t\tthrow new Error('Incorrect component operation parameters.');\n\t\t}\n\n\t\tthis.#isPhoneEnabled = [InvitationInputType.ALL, InvitationInputType.PHONE].includes(this.#inputType)\n\t\t\t&& Boolean(settings?.isInvitationByPhoneAvailable);\n\t\tthis.#isEmailEnabled = [InvitationInputType.ALL, InvitationInputType.EMAIL].includes(this.#inputType);\n\t\tthis.#placeholder = Type.isStringFilled(options?.placeholder) ? options.placeholder : this.#getDefaultPlaceholder();\n\t}\n\n\tchangeLanguage(lang: string): void\n\t{\n\t\tif (Type.isString(lang))\n\t\t{\n\t\t\tthis.#userLang = lang;\n\t\t}\n\t}\n\n\tgetTagSelector(): TagSelector\n\t{\n\t\treturn this.#cache.remember('tagSelector', () => {\n\t\t\treturn new TagSelector({\n\t\t\t\tid: `intranet-invitation-input-${Math.random(4)}`,\n\t\t\t\tshowTextBox: true,\n\t\t\t\tshowAddButton: false,\n\t\t\t\tplaceholder: this.#placeholder,\n\t\t\t\ttagTextColor: '#1E8D36',\n\t\t\t\ttagBgColor: '#D4FDB0',\n\t\t\t\ttagMaxWidth: 200,\n\t\t\t\tevents: {\n\t\t\t\t\tonAfterTagRemove: this.#onAfterTagRemove.bind(this),\n\t\t\t\t\tonBeforeTagAdd: this.#onBeforeTagAdd.bind(this),\n\t\t\t\t\tonEnter: this.#onEnter.bind(this),\n\t\t\t\t\tonBlur: this.#onBlur.bind(this),\n\t\t\t\t\tonInput: this.#onInput.bind(this),\n\t\t\t\t\tonContainerClick: this.#onContainerClick.bind(this),\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tisReadySendInvitation(): boolean\n\t{\n\t\treturn this.#isReadySendInvitation;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('node', () => {\n\t\t\tthis.getTagSelector().renderTo(this.getWrapper());\n\t\t\tthis.getTagSelector().focusTextBox();\n\n\t\t\tif (Type.isNumber(this.#minHeight))\n\t\t\t{\n\t\t\t\tconst itemsContainer = (this.getTagSelector().getItemsContainer());\n\t\t\t\tDom.style(itemsContainer, 'min-height', `${this.#minHeight}px`);\n\t\t\t}\n\n\t\t\treturn this.getWrapper();\n\t\t});\n\t}\n\n\trenderTo(node: HTMLElement): void\n\t{\n\t\tDom.append(this.render(), node);\n\t}\n\n\tgetWrapper(): HTMLDivElement\n\t{\n\t\treturn this.#cache.remember('wrapper', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-invitation-wrapper\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tinviteToGroup(groupId: number): Promise\n\t{\n\t\tconst invitationProvider = new InvitationToGroup(\n\t\t\tgroupId,\n\t\t\tthis.#getPreparedUserList(),\n\t\t);\n\n\t\treturn this.#invite(invitationProvider);\n\t}\n\n\tinviteToPortal(): Promise\n\t{\n\t\tconst invitationProvider = new InvitationToPortal(this.#getPreparedUserList());\n\n\t\treturn this.#invite(invitationProvider);\n\t}\n\n\thasErrorTags(): boolean\n\t{\n\t\treturn this.#getErrorTags().length > 0;\n\t}\n\n\tisEmptyTags(): boolean\n\t{\n\t\treturn this.getTagSelector().getTags().length === 0;\n\t}\n\n\t#invite(invitationProvider: InvitationProvider): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.#removeErrorBlock();\n\n\t\t\tif (this.#getErrorTags().length > 0)\n\t\t\t{\n\t\t\t\tthis.#addErrorBlockByMessage(this.#getDefaultValidationMessage());\n\t\t\t\treject(this.#getDefaultValidationMessage());\n\t\t\t}\n\t\t\telse if (this.getTagSelector().getTags().length === 0)\n\t\t\t{\n\t\t\t\tthis.#addErrorBlockByMessage(this.#getEmptyValidationMessage());\n\t\t\t\treject(this.#getEmptyValidationMessage());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tinvitationProvider.invite().then(() => {\n\t\t\t\t\tthis.getTagSelector().removeTags();\n\t\t\t\t\tthis.#setUnreadySaveState();\n\t\t\t\t\tresolve();\n\t\t\t\t}).catch((response) => {\n\t\t\t\t\tif (this.#showErrorAfterSubmit)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#addErrorBlockByMessage(response.errors[0].message);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getTagSelector().removeTags();\n\t\t\t\t\t}\n\n\t\t\t\t\treject(response.errors[0].message);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\t#getPreparedUserList(): Array\n\t{\n\t\tthis.#removeErrorBlock();\n\t\tconst selector = this.getTagSelector();\n\t\tconst tags = selector.getTags();\n\t\tconst users = [];\n\n\t\ttags.forEach((tag) => {\n\t\t\tif (this.#isEmailEnabled && tag.getEntityType() === 'email')\n\t\t\t{\n\t\t\t\tusers.push({\n\t\t\t\t\temail: tag.getTitle(),\n\t\t\t\t\tlanguageId: this.#userLang,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttag.getEntityType() === 'phone'\n\t\t\t\t&& this.#isPhoneEnabled\n\t\t\t\t&& !this.#invalidPhoneNumbersTagIds.includes(tag.getId())\n\t\t\t)\n\t\t\t{\n\t\t\t\tusers.push({\n\t\t\t\t\tphone: tag.getTitle(),\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn users;\n\t}\n\n\t#getErrorTags(): Array\n\t{\n\t\tconst selector = this.getTagSelector();\n\t\tconst tags = selector.getTags();\n\t\tconst errorTags = [];\n\n\t\ttags.forEach((tag) => {\n\t\t\tif (tag.getEntityType() === 'error')\n\t\t\t{\n\t\t\t\terrorTags.push(tag);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttag.getEntityType() === 'phone'\n\t\t\t\t&& this.#isPhoneEnabled\n\t\t\t\t&& this.#invalidPhoneNumbersTagIds.includes(tag.getId())\n\t\t\t)\n\t\t\t{\n\t\t\t\terrorTags.push(tag);\n\t\t\t}\n\t\t});\n\n\t\treturn errorTags;\n\t}\n\n\t#setReadySaveState(): void\n\t{\n\t\tthis.emit('onReadySave');\n\t\tthis.#isReadySendInvitation = true;\n\t}\n\n\t#setUnreadySaveState(): void\n\t{\n\t\tthis.emit('onUnreadySave');\n\t\tthis.#isReadySendInvitation = false;\n\t}\n\n\t#getPhoneParser(): BX.PhoneNumberParser\n\t{\n\t\treturn BX.PhoneNumberParser.getInstance();\n\t}\n\n\t#getDefaultPlaceholder(): string\n\t{\n\t\tif (this.#isPhoneEnabled && !this.#isEmailEnabled)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_PLACEHOLDER_PHONE');\n\t\t}\n\t\telse if (!this.#isPhoneEnabled && this.#isEmailEnabled)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_PLACEHOLDER');\n\t\t}\n\n\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_PLACEHOLDER_WITH_PHONE');\n\t}\n\n\t#getDefaultValidationMessage(): string\n\t{\n\t\tif (this.#isPhoneEnabled && !this.#isEmailEnabled)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_VALIDATION_MESSAGE_PHONE');\n\t\t}\n\t\telse if (!this.#isPhoneEnabled && this.#isEmailEnabled)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_VALIDATION_MESSAGE');\n\t\t}\n\n\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_VALIDATION_MESSAGE_WITH_PHONE');\n\t}\n\n\t#getEmptyValidationMessage(): string\n\t{\n\t\tif (this.#isPhoneEnabled && !this.#isEmailEnabled)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_VALIDATION_MESSAGE_PHONE');\n\t\t}\n\t\telse if (!this.#isPhoneEnabled && this.#isEmailEnabled)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_EMPTY_MESSAGE');\n\t\t}\n\n\t\treturn Loc.getMessage('INTRANET_INVITATION_INPUT_EMPTY_MESSAGE_WITH_PHONE');\n\t}\n\n\t#onAfterTagRemove(event: BaseEvent): void\n\t{\n\t\tconst selector = event.getTarget();\n\n\t\tconst tags = selector.getTags();\n\t\tconst errorTags = tags.filter((item) => item.getEntityType() === 'error');\n\n\t\tif (errorTags.length === 0)\n\t\t{\n\t\t\tthis.#removeErrorBlock();\n\t\t}\n\n\t\tif (tags.length === 0)\n\t\t{\n\t\t\tthis.#setUnreadySaveState();\n\t\t}\n\t\telse if (errorTags.length === 0)\n\t\t{\n\t\t\tthis.#setReadySaveState();\n\n\t\t\tif (this.#showErrorBeforeSubmit)\n\t\t\t{\n\t\t\t\tthis.#removeErrorBlock();\n\t\t\t}\n\t\t}\n\t}\n\n\t#onBeforeTagAdd(event: BaseEvent): void\n\t{\n\t\tconst { tag } = event.getData();\n\t\tconst textBox = event.target.getTextBox();\n\t\ttextBox.placeholder = '';\n\t\tthis.#setReadySaveState();\n\n\t\tif (tag.getEntityType() === 'error')\n\t\t{\n\t\t\tthis.#setErrorStateForTag(tag);\n\n\t\t\tif (this.#showErrorBeforeSubmit)\n\t\t\t{\n\t\t\t\tthis.#addErrorBlockByMessage(this.#getDefaultValidationMessage());\n\t\t\t}\n\t\t}\n\n\t\tif (tag.getEntityType() === 'phone')\n\t\t{\n\t\t\tthis.#getPhoneParser().parse(tag.getTitle()).then((result) => {\n\t\t\t\tif (result.valid)\n\t\t\t\t{\n\t\t\t\t\ttag.setTitle(result.rawNumber);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.#setErrorStateForTag(tag);\n\t\t\t\t\tthis.#invalidPhoneNumbersTagIds.push(tag.getId());\n\t\t\t\t}\n\t\t\t\ttag.render();\n\t\t\t}).catch(() => {});\n\t\t}\n\t}\n\n\t#setErrorStateForTag(tag): void\n\t{\n\t\ttag.setTextColor('#E92F2A');\n\t\ttag.setBgColor('#FFDCDB');\n\t}\n\n\t#onEnter(event: BaseEvent): void\n\t{\n\t\tconst selector = event.getTarget();\n\t\tconst value = selector.getTextBoxValue();\n\n\t\tif (value && !/^\\s*$/.test(value))\n\t\t{\n\t\t\tthis.#addTagByValue(value);\n\t\t}\n\t}\n\n\t#onBlur(event: BaseEvent): void\n\t{\n\t\tthis.#onEnter(event);\n\t}\n\n\t#onInput(event: BaseEvent): void\n\t{\n\t\tthis.#setReadySaveState();\n\t\tconst selector = event.target;\n\t\tconst inputEvent = event.getData().event;\n\t\tconst specialSymbols = [' ', ','];\n\t\tlet value = selector.getTextBoxValue();\n\n\t\tconst index = specialSymbols.indexOf(inputEvent.data);\n\n\t\tif (index === -1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst symbol = specialSymbols[index];\n\n\t\tif (value.endsWith(symbol))\n\t\t{\n\t\t\tvalue = value.slice(0, -1);\n\t\t}\n\n\t\tif (value)\n\t\t{\n\t\t\tthis.#addTagByValue(value);\n\t\t}\n\t}\n\n\t#onContainerClick(): void\n\t{\n\t\tthis.getTagSelector().getTextBox().focus();\n\t}\n\n\t#getEntityTypeByValue(value: string): string\n\t{\n\t\tconst isPhone = this.#isPhoneEnabled ? this.#isPhone(value) : false;\n\t\tconst isEmail = this.#isEmailEnabled ? (Validation.isEmail(value) && /^[^@]+@[^@]+\\.[^@]+$/.test(value)) : false;\n\n\t\tif (isEmail)\n\t\t{\n\t\t\treturn 'email';\n\t\t}\n\n\t\tif (isPhone)\n\t\t{\n\t\t\treturn 'phone';\n\t\t}\n\n\t\treturn 'error';\n\t}\n\n\t#addTagByValue(value: string): void\n\t{\n\t\tconst selector = this.getTagSelector();\n\t\tconst parsedValues = this.#parseValue(value);\n\n\t\tparsedValues.forEach((part) => {\n\t\t\tselector.addTag({\n\t\t\t\tid: part,\n\t\t\t\ttitle: part,\n\t\t\t\tentityId: 'invitation-tag',\n\t\t\t\tentityType: this.#getEntityTypeByValue(part),\n\t\t\t});\n\t\t});\n\t\tselector.clearTextBox();\n\t}\n\n\t#parseValue(value: string): Array<string>\n\t{\n\t\tconst parts = value.split(/[\\s,]+/);\n\n\t\treturn parts.filter((part) => part.length > 0);\n\t}\n\n\t#isPhone(value: string): boolean\n\t{\n\t\treturn BX.PhoneNumber.getValidNumberRegex().test(value);\n\t}\n\n\t#addErrorBlockByMessage(message: string): void\n\t{\n\t\tif (this.getWrapper().querySelector('.intranet-invitation-input-error__wrapper'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst errorBlock = this.#createErrorBlockByMessage(message);\n\t\tthis.getWrapper().append(errorBlock);\n\t\tthis.#setUnreadySaveState();\n\n\t\tif (!Dom.hasClass(this.getTagSelector().getOuterContainer(), '--error'))\n\t\t{\n\t\t\tDom.addClass(this.getTagSelector().getOuterContainer(), '--error');\n\t\t}\n\t}\n\n\t#removeErrorBlock(): void\n\t{\n\t\tconst errorBlock = this.getWrapper()\n\t\t\t.querySelector('.intranet-invitation-input-error__wrapper');\n\n\t\tif (errorBlock)\n\t\t{\n\t\t\terrorBlock.remove();\n\t\t}\n\n\t\tif (Dom.hasClass(this.getTagSelector().getOuterContainer(), '--error'))\n\t\t{\n\t\t\tDom.removeClass(this.getTagSelector().getOuterContainer(), '--error');\n\t\t}\n\t}\n\n\t#createErrorBlockByMessage(message: string): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"intranet-invitation-input-error__wrapper\">\n\t\t\t\t<span class=\"ui-icon-set --warning\"></span>\n\t\t\t\t<span class=\"intranet-invitation-input-error__text\">${message}</span>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n"],"names":["InvitationProvider","invite","Error","InvitationToGroup","constructor","groupId","users","super","Object","writable","value","babelHelpers","ajax","runAction","data","collabId","this","then","response","messageKey","newUsers","filter","u","status","existingUsers","length","notificationText","Loc","getMessage","Type","isStringFilled","BX","UI","Notification","Center","notify","content","autoHideDelay","InvitationToPortal","invitations","InvitationInputType","freeze","PHONE","EMAIL","ALL","InvitationInput","EventEmitter","options","Cache","MemoryCache","inputType","setEventNamespace","minHeight","isBoolean","showErrorBeforeSubmit","showErrorAfterSubmit","settings","Extension","getSettings","isInvitationByPhoneAvailable","includes","Boolean","placeholder","changeLanguage","lang","isString","getTagSelector","remember","TagSelector","id","Math","random","showTextBox","showAddButton","tagTextColor","tagBgColor","tagMaxWidth","events","onAfterTagRemove","bind","onBeforeTagAdd","onEnter","onBlur","onInput","onContainerClick","isReadySendInvitation","render","renderTo","getWrapper","focusTextBox","isNumber","itemsContainer","getItemsContainer","Dom","style","node","append","Tag","inviteToGroup","invitationProvider","inviteToPortal","hasErrorTags","isEmptyTags","getTags","Promise","resolve","reject","removeTags","catch","errors","message","tags","forEach","tag","getEntityType","push","email","getTitle","languageId","getId","phone","errorTags","emit","PhoneNumberParser","getInstance","event","getTarget","item","getData","target","getTextBox","parse","result","valid","setTitle","rawNumber","setTextColor","setBgColor","getTextBoxValue","test","selector","inputEvent","specialSymbols","index","indexOf","symbol","endsWith","slice","focus","isPhone","Validation","isEmail","part","addTag","title","entityId","entityType","clearTextBox","split","PhoneNumber","getValidNumberRegex","querySelector","errorBlock","hasClass","getOuterContainer","addClass","remove","removeClass"],"mappings":"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"}