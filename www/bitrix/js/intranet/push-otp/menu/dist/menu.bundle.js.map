{"version":3,"file":"menu.bundle.js","sources":["../src/menu.js","../src/profile-deactivate.js"],"sourcesContent":["import { MenuManager } from 'main.popup';\n\nexport class Menu\n{\n\t#menuItems: Array;\n\t#bindElement: HTMLElement;\n\n\tconstructor(bind: HTMLElement, options)\n\t{\n\t\tthis.#bindElement = bind;\n\t\tthis.#menuItems = this.#createDeactivateMenuItems(options.days, options.callback);\n\t}\n\n\tshow(): void\n\t{\n\t\tMenuManager.show(\n\t\t\t'securityOtpDaysPopup',\n\t\t\tthis.#bindElement,\n\t\t\tthis.#menuItems,\n\t\t\t{\n\t\t\t\tmaxHeight: 200,\n\t\t\t\toffsetTop: 10,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose() {\n\t\t\t\t\t\tMenuManager.destroy('securityOtpDaysPopup');\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\t}\n\n\t#createDeactivateMenuItems(days: Array, callback: function): Array\n\t{\n\t\tconst menuItems = [];\n\t\tfor (const index in days)\n\t\t{\n\t\t\tmenuItems.push({\n\t\t\t\ttext: days[index],\n\t\t\t\tnumDays: index,\n\t\t\t\tonclick(event, item)\n\t\t\t\t{\n\t\t\t\t\tcallback(item);\n\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\treturn menuItems;\n\t}\n}\n","import { AvatarRound, AvatarBase } from 'ui.avatar';\nimport { Cache, Tag, Text, ajax, Loc } from 'main.core';\nimport { Dialog } from 'ui.system.dialog';\nimport { Button, AirButtonStyle, ButtonSize } from 'ui.buttons';\nimport { sendData } from 'ui.analytics';\n\nexport class ProfileDeactivate\n{\n\t#cache = new Cache.MemoryCache();\n\t#options: Object;\n\n\tconstructor(options: Object)\n\t{\n\t\tthis.#options = options;\n\t}\n\n\tgetProfileItem(): Object\n\t{\n\t\treturn {\n\t\t\ttext: Loc.getMessage('INTRANET_PUSH_OTP_MENU_PROFILE_DEACTIVATE_TITLE'),\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('INTRANET_PUSH_OTP_MENU_PROFILE_DEACTIVATE_BUTTON_1'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.#sendAnalyticsEvent();\n\t\t\t\t\t\tthis.#options.callback();\n\t\t\t\t\t\tthis.#getDialog(Loc.getMessage('INTRANET_PUSH_OTP_MENU_PROFILE_DEACTIVATE_BUTTON_1'), 1).show();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('INTRANET_PUSH_OTP_MENU_PROFILE_DEACTIVATE_BUTTON_2'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.#sendAnalyticsEvent();\n\t\t\t\t\t\tthis.#options.callback();\n\t\t\t\t\t\tthis.#getDialog(Loc.getMessage('INTRANET_PUSH_OTP_MENU_PROFILE_DEACTIVATE_BUTTON_2'), 2).show();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t}\n\n\t#sendAnalyticsEvent(): void\n\t{\n\t\tsendData({\n\t\t\ttool: 'user_settings',\n\t\t\tcategory: 'security',\n\t\t\tevent: 'click_turnoff_2fa_employee_temp',\n\t\t});\n\t}\n\n\t#getDialog(buttonText: string, days: number): Dialog\n\t{\n\t\treturn this.#cache.remember(`popup-days-${days}`, () => {\n\t\t\treturn new Dialog({\n\t\t\t\twidth: 600,\n\t\t\t\tcontent: this.#getPopupContent(),\n\t\t\t\thasOverlay: true,\n\t\t\t\tcenterButtons: [\n\t\t\t\t\tnew Button({\n\t\t\t\t\t\ttext: buttonText,\n\t\t\t\t\t\tstyle: AirButtonStyle.FILLED_ALERT,\n\t\t\t\t\t\tsize: ButtonSize.EXTRA_LARGE,\n\t\t\t\t\t\tuseAirDesign: true,\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tajax.runAction('intranet.v2.Otp.pauseOtp', {\n\t\t\t\t\t\t\t\tmode: 'ajax',\n\t\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\tsignedUserId: this.#options.signedUserId,\n\t\t\t\t\t\t\t\t\tdays,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\t\t\tthis.#getDialog(buttonText, days).hide();\n\t\t\t\t\t\t\t\tthis.#cache.delete(`popup-days-${days}`);\n\t\t\t\t\t\t\t\tBX.SidePanel.Instance.postMessageTop(window, 'userProfileSlider::reloadList', {});\n\t\t\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t\tnew Button({\n\t\t\t\t\t\ttext: Loc.getMessage('INTRANET_PUSH_OTP_MENU_PROFILE_DEACTIVATE_POPUP_BUTTON_CANCEL'),\n\t\t\t\t\t\tstyle: AirButtonStyle.PLAIN,\n\t\t\t\t\t\tsize: ButtonSize.EXTRA_LARGE,\n\t\t\t\t\t\tuseAirDesign: true,\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.#getDialog(buttonText, days).hide();\n\t\t\t\t\t\t\tthis.#cache.delete(`popup-days-${days}`);\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t],\n\t\t\t});\n\t\t});\n\t}\n\n\t#getPopupContent(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('popupContent', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-otp-deactivate-popup-content__wrapper\">\n\t\t\t\t\t<div class=\"intranet-otp-deactivate-popup-content__title\">${Loc.getMessage('INTRANET_PUSH_OTP_MENU_PROFILE_DEACTIVATE_POPUP_TITLE')}</div>\n\t\t\t\t\t<div class=\"intranet-otp-deactivate-popup-content-user__wrapper\">\n\t\t\t\t\t\t<div class=\"intranet-otp-deactivate-popup-content-user__avatar\">\n\t\t\t\t\t\t\t${this.#getAvatar().getContainer()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"intranet-otp-deactivate-popup-content-user-name__wrapper\">\n\t\t\t\t\t\t\t<div class=\"intranet-otp-deactivate-popup-content-user__name\">${Text.encode(this.#options.fullName)}</div>\n\t\t\t\t\t\t\t${this.#getWorkPosition()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"intranet-otp-deactivate-popup-content__description\">\n\t\t\t\t\t\t${Loc.getMessage('INTRANET_PUSH_OTP_MENU_PROFILE_DEACTIVATE_POPUP_DESCRIPTION')}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getMoreInfoLink()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getMoreInfoLink(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('moreInfoLink', () => {\n\t\t\tconst onclick = () => {\n\t\t\t\ttop.BX.Helper.show('redirect=detail&code=26676294');\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div onclick=\"${onclick}\" class=\"intranet-otp-deactivate-popup-content__article --ui-hoverable-alt\">\n\t\t\t\t\t<span>${Loc.getMessage('INTRANET_PUSH_OTP_MENU_PROFILE_DEACTIVATE_POPUP_MORE_LINK')}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getAvatar(): AvatarBase\n\t{\n\t\treturn this.#cache.remember('avatar', () => {\n\t\t\treturn new AvatarRound({\n\t\t\t\tsize: 54,\n\t\t\t\tuserpicPath: this.#options?.avatarUri ? encodeURI(this.#options.avatarUri) : null,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getWorkPosition(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('workPosition', () => {\n\t\t\tif (!this.#options.workPosition)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-otp-deactivate-popup-content-user__workposition\">${Text.encode(this.#options.workPosition)}</div>\n\t\t\t`;\n\t\t});\n\t}\n}\n"],"names":["days","callback","menuItems","index","push","text","numDays","onclick","event","item","this","popupWindow","close","sendData","tool","category","buttonText","babelHelpers","remember","Dialog","width","content","hasOverlay","centerButtons","Button","style","AirButtonStyle","FILLED_ALERT","size","ButtonSize","EXTRA_LARGE","useAirDesign","ajax","runAction","mode","method","data","signedUserId","then","hide","delete","BX","SidePanel","Instance","postMessageTop","window","location","reload","Loc","getMessage","PLAIN","Tag","render","getContainer","Text","encode","fullName","top","Helper","show","AvatarRound","userpicPath","_babelHelpers$classPr","avatarUri","encodeURI","workPosition","constructor","bind","options","Object","value","writable","MenuManager","maxHeight","offsetTop","offsetLeft","events","onPopupClose","destroy","Cache","MemoryCache","getProfileItem","items"],"mappings":"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"}