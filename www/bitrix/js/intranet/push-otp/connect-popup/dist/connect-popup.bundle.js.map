{"version":3,"file":"connect-popup.bundle.js","sources":["../src/view/stepper-controller.js","../src/view/base-view.js","../src/connect-popup.js","../src/repeating-request.js","../src/analytics.js","../src/view/qr-view.js","../src/view/send-number-view.js","../src/view/device-connected-view.js","../src/code-input.js","../src/view/enter-code-view.js","../src/view/success-view.js","../src/enable-push-otp-provider.js","../src/request.js"],"sourcesContent":["import { Tag, Type } from 'main.core';\n\nexport class StepperController\n{\n\t#totalSteps: number = 4;\n\t#currentStep: number = 1;\n\t#enabled: boolean = true;\n\n\tconstructor(options: Object = {})\n\t{\n\t\tif (Type.isNumber(options.totalSteps))\n\t\t{\n\t\t\tthis.#totalSteps = Math.max(1, options.totalSteps);\n\t\t}\n\n\t\tif (Type.isNumber(options.currentStep))\n\t\t{\n\t\t\tthis.#currentStep = this.#getBoundedStep(options.currentStep);\n\t\t}\n\n\t\tif (options.enabled === false)\n\t\t{\n\t\t\tthis.#enabled = false;\n\t\t}\n\t}\n\n\tsetEnabled(enabled: boolean): void\n\t{\n\t\tthis.#enabled = enabled !== false;\n\t}\n\n\tsetStepInfo(currentStep: number, totalSteps: number): void\n\t{\n\t\tif (Type.isNumber(totalSteps))\n\t\t{\n\t\t\tthis.#totalSteps = Math.max(1, totalSteps);\n\t\t}\n\n\t\tif (Type.isNumber(currentStep))\n\t\t{\n\t\t\tthis.#currentStep = this.#getBoundedStep(currentStep);\n\t\t}\n\t}\n\n\tgetStepInfo(): Object\n\t{\n\t\treturn {\n\t\t\tcurrent: this.#currentStep,\n\t\t\ttotal: this.#totalSteps,\n\t\t};\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (!this.#enabled)\n\t\t{\n\t\t\treturn Tag.render`<div></div>`;\n\t\t}\n\n\t\tconst indicators = [];\n\t\tfor (let i = 1; i <= this.#totalSteps; i++)\n\t\t{\n\t\t\tconst isActive = i <= this.#currentStep ? '--active' : '';\n\t\t\tindicators.push(Tag.render`<div class=\"intranet-push-otp-connect-popup__popup-step-item ${isActive}\"></div>`);\n\t\t}\n\n\t\treturn Tag.render`<div class=\"intranet-push-otp-connect-popup__popup-step\">${indicators}</div>`;\n\t}\n\n\t#getBoundedStep(step: number): number\n\t{\n\t\tconst normalizedStep = Math.max(1, step);\n\n\t\treturn Math.min(normalizedStep, this.#totalSteps);\n\t}\n}\n","import { Tag, Type } from 'main.core';\nimport './css/view.css';\nimport { EventEmitter } from 'main.core.events';\nimport { StepperController } from './stepper-controller';\n\nexport class BaseView extends EventEmitter\n{\n\t#id: string;\n\t#excludeFromSteps: boolean = false;\n\t#stepper: StepperController;\n\n\tconstructor(options = {})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Intranet.PushOtp.ConnectPopup.View');\n\t\tthis.#id = Type.isStringFilled(options.id) ? options.id : '';\n\t\tthis.#excludeFromSteps = options.excludeFromSteps === true;\n\t\tthis.#stepper = new StepperController({\n\t\t\tenabled: !this.#excludeFromSteps,\n\t\t});\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.#id;\n\t}\n\n\tisExcludedFromSteps(): boolean\n\t{\n\t\treturn this.#excludeFromSteps;\n\t}\n\n\tsetStepInfo(currentStep: number, totalSteps: number): void\n\t{\n\t\tthis.#stepper.setStepInfo(currentStep, totalSteps);\n\t}\n\n\tgetStepInfo(): Object\n\t{\n\t\treturn this.#stepper.getStepInfo();\n\t}\n\n\trenderStepIndicators(): HTMLElement\n\t{\n\t\treturn this.#stepper.render();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render``;\n\t}\n\n\tbeforeDismiss(option: Object): void\n\t{}\n\n\tafterShow(option: Object): void\n\t{}\n\n\tafterDismiss(option: Object): void\n\t{}\n\n\tbeforeShow(option: Object): void\n\t{}\n}\n","import { Tag, Type } from 'main.core';\nimport { BaseCache, MemoryCache } from 'main.core.cache';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { BaseView } from './view/base-view';\nimport './popup.css';\n\nexport class ConnectPopup extends EventEmitter\n{\n\t#cache: BaseCache = new MemoryCache();\n\t#view: BaseView;\n\t#viewCollection: Array = [];\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\t(Type.isArray(options.viewList) ? options.viewList : []).forEach((view) => {\n\t\t\tif (view instanceof BaseView)\n\t\t\t{\n\t\t\t\tthis.#viewCollection.push(view);\n\t\t\t}\n\t\t});\n\t\tthis.#view = Type.isStringFilled(options.viewCode)\n\t\t\t? this.getViewByCode(options.viewCode)\n\t\t\t: this.#getFirstView();\n\n\t\tthis.#updateStepInfo();\n\n\t\tthis.setEventNamespace('BX.Intranet.PushOtp.ConnectPopup');\n\n\t\tthis.#viewCollection.forEach((view) => {\n\t\t\tview.subscribe('onNextView', (event) => {\n\t\t\t\tconst viewCode = event.getData()?.viewCode;\n\t\t\t\tconst options = event.getData()?.options;\n\t\t\t\tType.isStringFilled(viewCode, this.getViewByCode(viewCode))\n\t\t\t\t\t? this.changeView(this.getViewByCode(viewCode), options)\n\t\t\t\t\t: this.nextView(options);\n\t\t\t});\n\t\t\tview.subscribe('onPreviousView', (event) => {\n\t\t\t\tconst viewCode = event.getData()?.viewCode;\n\t\t\t\tconst options = event.getData()?.options;\n\t\t\t\tType.isStringFilled(viewCode, this.getViewByCode(viewCode))\n\t\t\t\t\t? this.changeView(this.getViewByCode(viewCode), options)\n\t\t\t\t\t: this.previousView(options);\n\t\t\t});\n\t\t});\n\t}\n\n\t#updateStepInfo(): void\n\t{\n\t\tconst viewsWithSteps = this.#viewCollection.filter((view) => !view.isExcludedFromSteps());\n\t\tconst totalSteps = viewsWithSteps.length;\n\n\t\tlet stepIndex = 0;\n\t\tthis.#viewCollection.forEach((view) => {\n\t\t\tif (!view.isExcludedFromSteps())\n\t\t\t{\n\t\t\t\tstepIndex++;\n\t\t\t\tview.setStepInfo(stepIndex, totalSteps);\n\t\t\t}\n\t\t});\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.#getPopup().show();\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.#getPopup().close();\n\t}\n\n\tgetView(): BaseView\n\t{\n\t\treturn this.#view;\n\t}\n\n\tgetViewByCode(viewCode: string): ?BaseView\n\t{\n\t\tfor (const view of this.#viewCollection)\n\t\t{\n\t\t\tif (view.getId() === viewCode)\n\t\t\t{\n\t\t\t\treturn view;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#getPopup(): Popup\n\t{\n\t\treturn this.#cache.remember('popup', () => {\n\t\t\treturn this.#createPopup();\n\t\t});\n\t}\n\n\t#getNextView(): ?string\n\t{\n\t\tlet result = null;\n\t\tthis.#viewCollection.forEach((view, index) => {\n\t\t\tif (view.getId() === this.#view.getId())\n\t\t\t{\n\t\t\t\tconst nextView = this.#viewCollection[index + 1];\n\t\t\t\tif (nextView)\n\t\t\t\t{\n\t\t\t\t\tresult = nextView;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t#getPreviousView(): ?string\n\t{\n\t\tlet result = null;\n\t\tthis.#viewCollection.forEach((view, index) => {\n\t\t\tif (view.getId() === this.#view.getId())\n\t\t\t{\n\t\t\t\tconst previousView = this.#viewCollection[index - 1];\n\t\t\t\tif (previousView)\n\t\t\t\t{\n\t\t\t\t\tresult = previousView;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t#getFirstView(): ?BaseView\n\t{\n\t\treturn this.#viewCollection[0];\n\t}\n\n\tchangeView(view: BaseView, options: Object = {}): void\n\t{\n\t\tif (!(view instanceof BaseView))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst prevView = this.#view;\n\t\tthis.#view.beforeDismiss(options);\n\t\tthis.#view = view;\n\t\tthis.#view.beforeShow(options);\n\t\tthis.reload();\n\t\tthis.#view.afterShow(options);\n\t\tprevView.afterDismiss(options);\n\t}\n\n\tnextView(options: Object = {}): void\n\t{\n\t\tconst view = this.#getNextView();\n\t\tif (view)\n\t\t{\n\t\t\tthis.changeView(view, options);\n\t\t}\n\t\telse if (options.closeIfLast)\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\tpreviousView(options: Object = {}): void\n\t{\n\t\tconst view = this.#getPreviousView();\n\t\tif (view)\n\t\t{\n\t\t\tthis.changeView(view, options);\n\t\t}\n\t}\n\n\treload(): void\n\t{\n\t\tthis.#getPopup().setContent(this.#renderContent());\n\t}\n\n\t#createPopup(): Popup\n\t{\n\t\treturn new Popup({\n\t\t\tcontent: this.#renderContent(),\n\t\t\twidth: 700,\n\t\t\tcloseByEsc: true,\n\t\t\tcontentColor: 'white',\n\t\t\tautoHide: true,\n\t\t\tcloseIcon: true,\n\t\t\tevents: {\n\t\t\t\tonPopupShow: () => {\n\t\t\t\t\tthis.emit(\n\t\t\t\t\t\t'onShow',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontext: this,\n\t\t\t\t\t\t\tparent: this.#getPopup(),\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t\tthis.#view.afterShow();\n\t\t\t\t},\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tthis.#view.beforeDismiss();\n\t\t\t\t\tthis.emit(\n\t\t\t\t\t\t'onClose',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontext: this,\n\t\t\t\t\t\t\tparent: this.#getPopup(),\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#renderContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"intranet-push-otp-connect-popup__popup-content\">${this.#view.render()}</div>\n\t\t`;\n\t}\n}\n","export class RepeatingRequest\n{\n\tconstructor(interval: number)\n\t{\n\t\tthis.interval = interval;\n\t\tthis.timerId = null;\n\t}\n\n\tstart(request: () => Promise): void\n\t{\n\t\tif (this.timerId === null)\n\t\t{\n\t\t\trequest();\n\t\t\tthis.timerId = setInterval(() => {\n\t\t\t\trequest();\n\t\t\t}, this.interval);\n\t\t}\n\t}\n\n\tstop()\n\t{\n\t\tif (this.timerId !== null)\n\t\t{\n\t\t\tclearInterval(this.timerId);\n\t\t\tthis.timerId = null;\n\t\t}\n\t}\n}\n","import { sendData } from 'ui.analytics';\n\nexport class Analytics\n{\n\tstatic ADD_PHONE_SUCCESS = 'add_phone_success';\n\tstatic SHOW_INPUT_PHONE = 'show_input_phone';\n\tstatic SHOW_INPUT_PHONE_CODE = 'show_input_phone_code';\n\tstatic SHOW_INSTALL_APP = 'show_install_app';\n\tstatic SHOW_INSTALL_APP_SUCCESS = 'show_install_app_success';\n\n\tstatic sendEvent(eventName: string): void\n\t{\n\t\tsendData({\n\t\t\ttool: 'user_settings',\n\t\t\tcategory: 'security',\n\t\t\tevent: eventName,\n\t\t});\n\t}\n}\n","import { Loc, Tag, Type, Dom } from 'main.core';\nimport { Loader } from 'main.loader';\nimport 'ui.design-tokens';\nimport 'intranet.design-tokens';\nimport 'main.qrcode';\nimport './css/qr-view.css';\nimport { PULL, PullClient } from 'pull.client';\nimport { BaseView } from './base-view';\nimport 'ui.icon-set.outline';\nimport { RepeatingRequest } from '../repeating-request';\nimport { Analytics } from '../analytics';\n\nexport class QrView extends BaseView\n{\n\t#signedUserId: ?string;\n\t#pullConfig: Object;\n\t#callback: function;\n\t#linkProvider: function;\n\t#repeatingRequest: RepeatingRequest;\n\t#qrContainer: HTMLElement;\n\t#loader: Loader;\n\t#isAppSuccessConnected: boolean = false;\n\t#onAppConnected: () => {};\n\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.#signedUserId = options.signedUserId || null;\n\t\tthis.#repeatingRequest = options.repeatingRequest;\n\t\tthis.#pullConfig = Type.isObject(options.pullConfig) ? options.pullConfig : {};\n\t\tthis.#callback = Type.isFunction(options.callback) ? options.callback : () => {};\n\t\tthis.#linkProvider = Type.isFunction(options.linkProvider) ? options.linkProvider : () => new Promise();\n\t\tthis.#qrContainer = Tag.render`<div class=\"intranet-push-otp-connect-popup__qr-container\"></div>`;\n\t\tthis.#loader = new Loader({\n\t\t\ttarget: this.#qrContainer,\n\t\t\tmode: 'inline',\n\t\t\tsize: 120,\n\t\t});\n\t\tthis.#onAppConnected = Type.isFunction(options.onAppConnected) ? options.onAppConnected : () => {};\n\t}\n\n\t#renderTitle(): HTMLElement\n\t{\n\t\treturn Tag.render`<span>${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_CONNECT_TITLE')}</span>`;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#subscribeToScanQr();\n\t\tthis.#subscribeRefreshQr();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"intranet-push-otp-connect-popup__view-container\">\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup__popup-title\">\n\t\t\t\t\t\t${this.#renderTitle()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderStepIndicators()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-description-text\">\n\t\t\t\t\t${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_CONNECT_QR_DESCRIPTION')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-connect-container\">\n\t\t\t\t\t<div>${this.#qrContainer}</div>\n\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-guide-connect\">\n\t\t\t\t\t\t<ol class=\"intranet-push-otp-connect-popup-ol-list\">\n\t\t\t\t\t\t\t<li class=\"intranet-push-otp-connect-popup-ol-list-item --marker-1\">\n\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\tLoc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_LIST_1_MSGVER_1', {\n\t\t\t\t\t\t\t\t\t\t'[LINK]': '<a href=\"https://appgallery.huawei.com/app/C105947779\" target=\"_blank\" class=\"ui-link ui-link-primary\">',\n\t\t\t\t\t\t\t\t\t\t'[/LINK]': '</a>',\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li class=\"intranet-push-otp-connect-popup-ol-list-item --marker-2\">${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_LIST_2')}</li>\n\t\t\t\t\t\t\t<li class=\"intranet-push-otp-connect-popup-ol-list-item --marker-3\">${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_LIST_3')}</li>\n\t\t\t\t\t\t\t<li class=\"intranet-push-otp-connect-popup-ol-list-item --marker-4\">${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_LIST_4')}</li>\n\t\t\t\t\t\t</ol>\n\t\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup-alert\">\n\t\t\t\t\t\t\t<div style=\"--ui-icon-set__icon-size: 20px; --ui-icon-set__icon-color: #FF5752;\" class=\"ui-icon-set --o-alert\"></div>\n\t\t\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup-alert-text\">${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_DANGER')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-button-container\">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#makeQrCodeTo(element: HTMLElement, deeplink: string): void\n\t{\n\t\t// eslint-disable-next-line no-undef\n\t\tnew QRCode(element, {\n\t\t\ttext: deeplink,\n\t\t\twidth: 152,\n\t\t\theight: 152,\n\t\t\tcolorDark: '#000000',\n\t\t\tcolorLight: '#ffffff',\n\t\t\t// eslint-disable-next-line no-undef\n\t\t\tcorrectLevel: QRCode.CorrectLevel.H,\n\t\t});\n\t}\n\n\t#showQrCode(deeplink: string): HTMLElement\n\t{\n\t\tDom.clean(this.#qrContainer);\n\t\tthis.#makeQrCodeTo(this.#qrContainer, deeplink);\n\t}\n\n\tafterShow(option: Object): void\n\t{\n\t\tAnalytics.sendEvent(Analytics.SHOW_INSTALL_APP);\n\t\tthis.#repeatingRequest.start(this.#fetchQrCode.bind(this));\n\t}\n\n\tbeforeDismiss(option: Object): void\n\t{\n\t\tthis.#repeatingRequest.stop();\n\t}\n\n\t#fetchQrCode(): Promise\n\t{\n\t\tthis.#showLoader();\n\n\t\treturn this.#linkProvider()\n\t\t\t.then((response) => {\n\t\t\t\tconst link = response.data?.link;\n\t\t\t\tif (link)\n\t\t\t\t{\n\t\t\t\t\tthis.#showQrCode(link);\n\t\t\t\t}\n\t\t\t\tthis.#loader.hide();\n\t\t\t}).catch(() => {});\n\t}\n\n\t#subscribeToScanQr(): void\n\t{\n\t\tconst pull = new PullClient();\n\t\tpull.subscribe({\n\t\t\tmoduleId: 'security',\n\t\t\tcommand: 'pushOtpCode',\n\t\t\tcallback: (params) => {\n\t\t\t\tparams.signedUserId = this.#signedUserId;\n\t\t\t\tthis.#callback(params).then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tthis.#isAppSuccessConnected = true;\n\t\t\t\t\t\tconsole.log(this.#onAppConnected);\n\t\t\t\t\t\tthis.#onAppConnected(this);\n\t\t\t\t\t\tthis.emit(\n\t\t\t\t\t\t\t'onNextView',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tviewCode: '',\n\t\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\t\tdevice: params.device,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => console.error(response),\n\t\t\t\t).catch((error) => {\n\t\t\t\t\tconsole.error('Error in QR scan callback:', error);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t\tpull.start(this.#pullConfig);\n\t}\n\n\t#showLoader(): Loader\n\t{\n\t\tDom.clean(this.#qrContainer);\n\t\tthis.#loader.show();\n\t}\n\n\t#subscribeRefreshQr(): void\n\t{\n\t\tif (PULL)\n\t\t{\n\t\t\tPULL.subscribe({\n\t\t\t\ttype: 'BX.PullClient.SubscriptionType.Server',\n\t\t\t\tmoduleId: 'mobile',\n\t\t\t\tcommand: 'onDeeplinkShouldRefresh',\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tthis.success();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n\n\tisAppSuccessConnected(): boolean\n\t{\n\t\treturn this.#isAppSuccessConnected;\n\t}\n}\n","import { Dom, Loc, Reflection, Tag, Type, Text } from 'main.core';\nimport { BaseCache, MemoryCache } from 'main.core.cache';\nimport { BaseButton, Button } from 'ui.buttons';\nimport { BaseView } from './base-view';\nimport { PhoneFormatter } from 'ui.type';\nimport './css/send-number.css';\nimport 'main.phonenumber';\nimport { Analytics } from '../analytics';\n\nexport class SendNumberView extends BaseView\n{\n\t#signedUserId: ?string;\n\t#phoneNumber: string;\n\t#isPhoneNumberConfirmed: boolean;\n\t#changeClicked: boolean;\n\t#forceChangeMode: boolean = false;\n\t#container: BaseCache = new MemoryCache();\n\t#button: Button;\n\t#titleContainer: HTMLElement;\n\t#errorContainer: HTMLElement;\n\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.#signedUserId = options.signedUserId || null;\n\t\tthis.#phoneNumber = Type.isString(options.phoneNumber) ? PhoneFormatter.formatValue(options.phoneNumber) : '';\n\t\tthis.#isPhoneNumberConfirmed = options.isPhoneNumberConfirmed === true;\n\t\tthis.#changeClicked = false;\n\t\tthis.#button = this.#createSendBtn();\n\t\tthis.#titleContainer = Tag.render`\n\t\t\t<div class=\"intranet-push-otp-connect-popup__view-enter-code-subtitle\">${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_ENTER_CODE_SUBTITLE')}</div>\n\t\t`;\n\t\tthis.#errorContainer = Tag.render`\n\t\t\t<div class=\"intranet-push-otp-connect-popup__view-enter-code-errors\" id=\"enter-code-error-container\"></div>\n\t\t`;\n\t}\n\n\t#renderTitle(): HTMLElement\n\t{\n\t\treturn Tag.render`<span>${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_NUMBER_TITLE')}</span>`;\n\t}\n\n\t#renderCurrentPhoneNumber(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-phone-number-value\">${this.#phoneNumber}</div>\n\t\t\t\t${this.#renderChangeNumberBtn()}\n\t\t\t\t${this.#errorContainer}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderInputPhoneNumber(): HTMLElement\n\t{\n\t\tconst input = Dom.create('input', {\n\t\t\tattrs: {\n\t\t\t\tclassName: 'intranet-push-otp-connect-popup__view-phone-number-input',\n\t\t\t\ttype: 'text',\n\t\t\t\tname: 'phone_number',\n\t\t\t},\n\t\t\tprops: {\n\t\t\t\tvalue: PhoneFormatter.formatValue(this.#phoneNumber),\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tinput: (event) => {\n\t\t\t\t\tif (Type.isElementNode(event?.target))\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.target.value = PhoneFormatter.formatValue(event.target.value);\n\t\t\t\t\t\tthis.#phoneNumber = event.target.value;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tif (Reflection.getClass(BX.PhoneNumber))\n\t\t{\n\t\t\tconst phoneInput = new BX.PhoneNumber.Input({\n\t\t\t\tnode: input,\n\t\t\t});\n\n\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\tphoneInput.waitForInitialization().then(() => {\n\t\t\t\tconst countryCode = Text.encode(phoneInput.getCountryCode());\n\n\t\t\t\tif (countryCode)\n\t\t\t\t{\n\t\t\t\t\tinput.placeholder = `+${countryCode}`;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"intranet-push-otp-connect-popup__view-phone-number-input-box\">\n\t\t\t\t${this.#titleContainer}\n\t\t\t\t${input}\n\t\t\t\t${this.#errorContainer}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderChangeNumberBtn(): HTMLElement\n\t{\n\t\treturn Dom.create('a', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'intranet-push-otp-connect-popup__view-phone-number-link',\n\t\t\t},\n\t\t\thtml: Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_CHANGE_NUMBER_BTN'),\n\t\t\tevents: {\n\t\t\t\tclick: () => {\n\t\t\t\t\tthis.#phoneNumber = '';\n\t\t\t\t\tthis.#changeClicked = true;\n\t\t\t\t\tconst container = this.render().querySelector('.intranet-push-otp-connect-popup__view-connect-container');\n\t\t\t\t\tDom.clean(container);\n\t\t\t\t\tconst inputBox = this.#renderInputPhoneNumber();\n\t\t\t\t\tDom.append(inputBox, container);\n\t\t\t\t\tDom.append(Tag.render`<div class=\"intranet-push-otp-connect-popup__view-phone-number-phone\"></div>`, container);\n\t\t\t\t\tinputBox.querySelector('input')?.focus();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.#container.remember('view', () => {\n\t\t\tconst shouldShowInput = this.#forceChangeMode || !Type.isStringFilled(this.#phoneNumber);\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-container\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup__popup-title\">\n\t\t\t\t\t\t\t${this.#renderTitle()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.renderStepIndicators()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-description-text\">${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_NUMBER_DESC')}</div>\n\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-connect-container --space-between --code\">\n\t\t\t\t\t\t${shouldShowInput ? this.#renderInputPhoneNumber() : this.#renderCurrentPhoneNumber()}\n\t\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-phone-number-phone\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-button-container\">\n\t\t\t\t\t\t${this.#button.render()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#createSendBtn(): BaseButton\n\t{\n\t\treturn new Button({\n\t\t\ttext: Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_CONNECT_NEXT_BTN'),\n\t\t\tnoCaps: true,\n\t\t\tsize: Button.Size.MD,\n\t\t\tuseAirDesign: true,\n\t\t\tdisabled: false,\n\t\t\tonclick: (button) => {\n\t\t\t\tif (button.isWaiting() || button.isDisabled())\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.#cleanError();\n\t\t\t\tif (!this.#changeClicked && this.#isPhoneNumberConfirmed && !this.#forceChangeMode)\n\t\t\t\t{\n\t\t\t\t\tthis.#nextView('success');\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.#sendNumber();\n\t\t\t},\n\t\t});\n\t}\n\n\t#sendNumber(): void\n\t{\n\t\tif (this.#button.isWaiting())\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.#button.setWaiting(true);\n\t\tBX.ajax.runAction('intranet.v2.Otp.changeAuthPhone', {\n\t\t\tmethod: 'POST',\n\t\t\tdata: {\n\t\t\t\tsignedUserId: this.#signedUserId,\n\t\t\t\tphoneNumber: this.#phoneNumber,\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tthis.#button.setWaiting(false);\n\t\t\tif (response.data === true)\n\t\t\t{\n\t\t\t\tthis.#isPhoneNumberConfirmed = false;\n\t\t\t\tthis.#nextView();\n\t\t\t}\n\t\t}, (response) => {\n\t\t\tthis.#setError(response.errors);\n\t\t\tthis.#button.setWaiting(false);\n\t\t}).catch((response) => {\n\t\t\tthis.#setError(response.errors);\n\t\t\tthis.#button.setWaiting(false);\n\t\t});\n\t}\n\n\t#nextView(code: ?string = null): void\n\t{\n\t\tthis.emit(\n\t\t\t'onNextView',\n\t\t\t{\n\t\t\t\tviewCode: code,\n\t\t\t\toptions: {\n\t\t\t\t\tphoneNumber: this.#phoneNumber,\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\t}\n\n\t#setError(errors: Array): void\n\t{\n\t\tDom.clean(this.#errorContainer);\n\t\terrors.forEach((error) => {\n\t\t\tDom.append(Tag.render`<span>${error.message}</span>`, this.#errorContainer);\n\t\t});\n\t}\n\n\t#cleanError(): void\n\t{\n\t\tDom.clean(BX('enter-code-error-container'));\n\t}\n\n\tafterShow(option: Object): void\n\t{\n\t\tAnalytics.sendEvent(Analytics.SHOW_INPUT_PHONE);\n\t\tthis.render().querySelector('input')?.focus();\n\t}\n\n\tsetForceChangeMode(force: boolean): void\n\t{\n\t\tthis.#forceChangeMode = force;\n\t\tif (force)\n\t\t{\n\t\t\tthis.#phoneNumber = '';\n\t\t}\n\t}\n}\n","import { Loc, Tag, Type } from 'main.core';\nimport { BaseButton, Button } from 'ui.buttons';\nimport { BaseView } from './base-view';\nimport { Analytics } from '../analytics';\n\nexport class DeviceConnectedView extends BaseView\n{\n\t#button: Button;\n\t#phoneLabel: string;\n\t#phoneOs: string;\n\t#isProcessing: boolean = false;\n\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.#button = this.#createContinueBtn();\n\t\tthis.#phoneLabel = Type.isStringFilled(options.phoneLabel) ? options.phoneLabel : '';\n\t\tthis.#phoneOs = Type.isStringFilled(options.phoneOs) ? options.phoneOs : '';\n\t}\n\n\t#renderTitle(): HTMLElement\n\t{\n\t\treturn Tag.render`<span>${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_CONNECTED_TITLE')}</span>`;\n\t}\n\n\tbeforeShow(options: Object): void\n\t{\n\t\tthis.#phoneLabel = options?.device?.displayModel ?? '';\n\t\tthis.#phoneOs = options?.device?.manufacturer === 'Apple' ? 'ios' : 'android';\n\t\tthis.#isProcessing = false;\n\t}\n\n\tafterShow(option: Object)\n\t{\n\t\tAnalytics.sendEvent(Analytics.SHOW_INSTALL_APP_SUCCESS);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"intranet-push-otp-connect-popup__view-container\">\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup__popup-title\">\n\t\t\t\t\t\t${this.#renderTitle()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.renderStepIndicators()}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-description-text\">${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_CONNECT_DESC')}</div>\n\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-connect-container\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-connect-logo ${this.#phoneOs === 'ios' ? '' : '--android'}\"></div>\n\t\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-connect-logo-text\">${this.#phoneLabel}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-button-container\">\n\t\t\t\t\t${this.#button.render()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#createContinueBtn(): BaseButton\n\t{\n\t\treturn new Button({\n\t\t\ttext: Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_CONNECT_NEXT_BTN'),\n\t\t\tnoCaps: true,\n\t\t\tsize: Button.Size.MD,\n\t\t\tuseAirDesign: true,\n\t\t\tdisabled: false,\n\t\t\tonclick: (button) => {\n\t\t\t\tif (this.#isProcessing || button.isWaiting())\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.#isProcessing = true;\n\t\t\t\tthis.emit('onNextView', {\n\t\t\t\t\tviewCode: null,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tcloseIfLast: true,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n}\n","import { Dom, Event, Type } from 'main.core';\n\nexport type CodeInputOptions = {\n\tcodeLength?: number,\n\tname?: string,\n\tcomplete?: () => void,\n\tclassName?: string,\n\tcontainerClassName?: string,\n\tmask?: RegExp,\n\tautoFocus?: boolean,\n\tallowPaste?: boolean,\n}\n\nexport class CodeInput\n{\n\t#className: string;\n\t#containerClassName: string;\n\t#name: string;\n\t#mask: RegExp;\n\t#codeLength: number;\n\t#autoFocus: boolean;\n\t#allowPaste: boolean;\n\t#container: HTMLElement;\n\t#complete: () => void;\n\t#input: () => void;\n\n\tconstructor(options: CodeInputOptions = {})\n\t{\n\t\tthis.#codeLength = Type.isNumber(options.codeLength) ? options.codeLength : 6;\n\t\tthis.#name = Type.isString(options.name) ? options.name : 'confirm_code';\n\t\tthis.#mask = options.mask instanceof RegExp ? options.mask : /\\D/g;\n\t\tthis.#className = Type.isString(options.className) ? options.className : '';\n\t\tthis.#containerClassName = Type.isString(options.containerClassName) ? options.containerClassName : '';\n\t\tthis.#autoFocus = Type.isBoolean(options.autoFocus) ? options.autoFocus : true;\n\t\tthis.#allowPaste = Type.isBoolean(options.allowPaste) ? options.allowPaste : true;\n\t\tthis.#complete = Type.isFunction(options.complete) ? options.complete : () => {};\n\n\t\tthis.#input = Type.isFunction(options.input) ? options.input : () => {};\n\t}\n\n\t#createInput(): HTMLElement\n\t{\n\t\treturn Dom.create({\n\t\t\ttag: 'input',\n\t\t\tattrs: {\n\t\t\t\tclassName: this.#className,\n\t\t\t\tname: `${this.#name}[]`,\n\t\t\t\ttype: 'text',\n\t\t\t\tautocomplete: 'one-time-code',\n\t\t\t\tmaxlength: '1',\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tinput: this.#inputHandler.bind(this),\n\t\t\t\tkeydown: this.#keydownHandler.bind(this),\n\t\t\t\tfocus: this.#focusHandler.bind(this),\n\t\t\t},\n\t\t});\n\t}\n\n\t#inputHandler(event): void\n\t{\n\t\tconst target = event.target;\n\t\tthis.#input(target);\n\t\ttarget.value = target.value.replace(this.#mask, '').slice(0, 1);\n\n\t\tif (target.value.length > 0)\n\t\t{\n\t\t\tthis.#moveToNext(target);\n\t\t}\n\t}\n\n\t#keydownHandler(event): void\n\t{\n\t\tconst input = event.target;\n\t\tthis.#input(input);\n\t\tif (\n\t\t\t(event.key === 'Backspace' && input.value === '')\n\t\t\t|| event.key === 'ArrowLeft'\n\t\t)\n\t\t{\n\t\t\tconst prevInput = input.previousElementSibling;\n\t\t\tif (prevInput && prevInput.tagName === 'INPUT')\n\t\t\t{\n\t\t\t\tprevInput.focus();\n\t\t\t\tif (event.key === 'Backspace')\n\t\t\t\t{\n\t\t\t\t\tprevInput.value = '';\n\t\t\t\t}\n\t\t\t}\n\t\t\tevent.preventDefault();\n\t\t}\n\t\telse if (event.key === 'ArrowRight')\n\t\t{\n\t\t\tthis.#moveToNext(input);\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n\n\t#focusHandler(event): void\n\t{\n\t\tevent.target.select();\n\t}\n\n\t#pasteHandler(event): void\n\t{\n\t\tif (!this.#allowPaste)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst paste = (event.clipboardData || window.clipboardData).getData('text');\n\t\tconst digits = [...paste.replace(this.#mask, '')];\n\t\tconst inputs = this.#container.querySelectorAll('input');\n\n\t\tdigits.forEach((digit, idx) => {\n\t\t\tif (inputs[idx])\n\t\t\t{\n\t\t\t\tinputs[idx].value = digit;\n\t\t\t}\n\t\t});\n\n\t\tif (digits.length > 0)\n\t\t{\n\t\t\tconst lastFilledIndex = Math.min(digits.length - 1, inputs.length - 1);\n\t\t\tconst nextInput = inputs[lastFilledIndex + 1];\n\n\t\t\tif (nextInput)\n\t\t\t{\n\t\t\t\tnextInput.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tinputs[lastFilledIndex].blur();\n\t\t\t\tthis.#checkComplete();\n\t\t\t}\n\t\t}\n\n\t\tevent.preventDefault();\n\t}\n\n\t#moveToNext(currentInput): void\n\t{\n\t\tconst nextInput = currentInput.nextElementSibling;\n\t\tif (nextInput && nextInput.tagName === 'INPUT')\n\t\t{\n\t\t\tnextInput.focus();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcurrentInput.blur();\n\t\t\tthis.#checkComplete();\n\t\t}\n\t}\n\n\t#moveToPrevious(currentInput): void\n\t{\n\t\tconst prevInput = currentInput.previousElementSibling;\n\t\tif (prevInput && prevInput.tagName === 'INPUT')\n\t\t{\n\t\t\tprevInput.focus();\n\t\t}\n\t}\n\n\t#checkComplete(): void\n\t{\n\t\tif (this.getValue().length === this.#codeLength)\n\t\t{\n\t\t\tthis.#complete();\n\t\t}\n\t}\n\n\tgetValue(): string\n\t{\n\t\tconst inputs = this.#container.querySelectorAll('input');\n\n\t\treturn [...inputs].map((input) => input.value).join('');\n\t}\n\n\tsetInputClass(className: string): string\n\t{\n\t\tconst inputs = this.#container?.querySelectorAll('input') ?? [];\n\n\t\treturn [...inputs].forEach((input: HTMLInputElement) => {\n\t\t\tinput.className = className;\n\t\t});\n\t}\n\n\tsetValue(value: string): void\n\t{\n\t\tconst inputs = this.#container.querySelectorAll('input');\n\t\tconst digits = [...value.replace(this.#mask, '')];\n\n\t\tinputs.forEach((input: HTMLInputElement, idx) => {\n\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\tinput.value = digits[idx] || '';\n\t\t});\n\t}\n\n\tclear(): void\n\t{\n\t\tconst inputs = this.#container.querySelectorAll('input');\n\t\tinputs.forEach((input) => {\n\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\tinput.value = '';\n\t\t});\n\t\tif (this.#autoFocus && inputs[0])\n\t\t{\n\t\t\tinputs[0].focus();\n\t\t}\n\t}\n\n\tfocus(): void\n\t{\n\t\tconst firstEmpty = this.#container.querySelector('input:not([value]), input[value=\"\"]');\n\t\tconst target = firstEmpty || this.#container.querySelector('input');\n\t\tif (target)\n\t\t{\n\t\t\ttarget.focus();\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#container = Dom.create('div', {\n\t\t\tattrs: {\n\t\t\t\tclassName: this.#containerClassName,\n\t\t\t},\n\t\t});\n\n\t\tfor (let i = 0; i < this.#codeLength; i++)\n\t\t{\n\t\t\tDom.append(this.#createInput(), this.#container);\n\t\t}\n\n\t\tif (this.#allowPaste)\n\t\t{\n\t\t\tconst firstInput = this.#container.querySelector('input');\n\t\t\tif (firstInput)\n\t\t\t{\n\t\t\t\tEvent.bind(firstInput, 'paste', this.#pasteHandler.bind(this));\n\t\t\t}\n\t\t}\n\n\t\tif (this.#autoFocus)\n\t\t{\n\t\t\tsetTimeout(() => this.focus(), 0);\n\t\t}\n\n\t\treturn this.#container;\n\t}\n}\n","import { Loc, Tag, Type, Dom } from 'main.core';\nimport { BaseCache, MemoryCache } from 'main.core.cache';\nimport { AirButtonStyle, BaseButton, Button } from 'ui.buttons';\nimport { BaseView } from './base-view';\nimport { CodeInput } from '../code-input';\nimport './css/enter-code.css';\nimport { Analytics } from '../analytics';\n\nexport class EnterCodeView extends BaseView\n{\n\t#signedUserId: ?string;\n\t#cooldown: number = 0;\n\t#input: CodeInput;\n\t#button: Button;\n\t#errorContainer: HTMLElement;\n\t#timerContainer: HTMLElement;\n\t#cooldownInterval: number;\n\t#isPhoneNumberConfirmed: boolean = false;\n\t#codeSent: boolean = false;\n\t#container: BaseCache = new MemoryCache();\n\t#phoneNumber: string = '';\n\t#backButton: BaseButton;\n\t#isFirstView: boolean = false;\n\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.#signedUserId = options.signedUserId || null;\n\t\tthis.#phoneNumber = options.phoneNumber || '';\n\t\tthis.#backButton = this.#createBackBtn();\n\t\tthis.#input = new CodeInput({\n\t\t\tcodeLength: 6,\n\t\t\tname: 'confirm_code',\n\t\t\tclassName: 'confirm-code-input --primary',\n\t\t\tcontainerClassName: 'enter-confirm-code-container',\n\t\t\tcomplete: () => {\n\t\t\t\tthis.#button.setDisabled(false);\n\t\t\t\tthis.#confirmCode();\n\t\t\t},\n\t\t\tinput: () => {\n\t\t\t\tthis.#cleanError();\n\t\t\t},\n\t\t});\n\t\tthis.#button = this.#createConfirmCodeBtn();\n\t\tthis.#timerContainer = Tag.render`\n\t\t\t<div class=\"intranet-push-otp-connect-popup__view-enter-code-cooldown\" id=\"enter-code-cooldown-timer\">\n\t\t\t</div>\n\t\t`;\n\t\tthis.#errorContainer = Tag.render`\n\t\t\t<div class=\"intranet-push-otp-connect-popup__view-enter-code-errors\" id=\"enter-code-error-container\"></div>\n\t\t`;\n\t}\n\n\t#renderTitle(): HTMLElement\n\t{\n\t\treturn Tag.render`<span>${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_ENTER_CODE_TITLE')}</span>`;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.#container.remember('view', () => {\n\t\t\tconst stepInfo = this.getStepInfo();\n\t\t\tthis.#isFirstView = stepInfo.current === 1;\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-container\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup__popup-title\">\n\t\t\t\t\t\t\t${this.#renderTitle()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.renderStepIndicators()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-description-text\">\n\t\t\t\t\t\t${\n\t\t\t\t\t\t\tLoc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_ENTER_CODE_DESCRIPTION', {\n\t\t\t\t\t\t\t\t'#PHONE_NUMBER#': `<strong>${this.#phoneNumber}</strong>`,\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-enter-code-container --content-center\">\n\t\t\t\t\t\t\t${this.#input.render()}\n\t\t\t\t\t\t\t${this.#errorContainer}\n\t\t\t\t\t\t\t${this.#timerContainer}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"intranet-push-otp-connect-popup__view-button-container\">\n\t\t\t\t\t\t${this.#isFirstView ? '' : this.#backButton.render()}\n\t\t\t\t\t\t${this.#button.render()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#createConfirmCodeBtn(): Button\n\t{\n\t\treturn new Button({\n\t\t\ttext: Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_CONNECT_CONFIRM_BTN'),\n\t\t\tnoCaps: true,\n\t\t\tsize: Button.Size.MD,\n\t\t\tuseAirDesign: true,\n\t\t\tdisabled: true,\n\t\t\tonclick: () => {\n\t\t\t\tif (this.#codeSent)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.#confirmCode();\n\t\t\t},\n\t\t});\n\t}\n\n\tsendCode(): void\n\t{\n\t\tif (!this.#canSendCode())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#cleanError();\n\t\tthis.#button.setWaiting(true);\n\t\tthis.#codeSent = true;\n\n\t\tBX.ajax.runAction('intranet.v2.Otp.sendConfirmationCode', {\n\t\t\tmethod: 'POST',\n\t\t\tdata: {\n\t\t\t\tsignedUserId: this.#signedUserId,\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tif (response.status === 'success')\n\t\t\t{\n\t\t\t\tthis.#cooldown = Type.isNumber(response.data?.DATE_SEND) ? response.data?.DATE_SEND : 0;\n\t\t\t\tthis.#startCooldownTimer();\n\t\t\t}\n\t\t\tthis.#button.setWaiting(false);\n\t\t}, (response) => {\n\t\t\tthis.#setError(response.errors);\n\t\t\tthis.#cooldown = Type.isNumber(response.data?.DATE_SEND) ? response.data?.DATE_SEND : 0;\n\t\t\tthis.#startCooldownTimer();\n\t\t\tthis.#button.setWaiting(false);\n\t\t}).catch((error) => console.error(error));\n\t}\n\n\t#canSendCode(): boolean\n\t{\n\t\treturn this.#cooldown <= 0 && !this.#codeSent;\n\t}\n\n\t#startCooldownTimer(): void\n\t{\n\t\tclearInterval(this.#cooldownInterval);\n\t\tif (!this.#cooldown || !this.#timerContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst tickTimer = () => {\n\t\t\tif (this.#cooldown <= 0)\n\t\t\t{\n\t\t\t\tDom.clean(this.#timerContainer);\n\t\t\t\tDom.append(this.#renderResendBtn(), this.#timerContainer);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.clean(this.#timerContainer);\n\t\t\tDom.append(this.#renderTimer(), this.#timerContainer);\n\t\t\tthis.#cooldown--;\n\t\t};\n\n\t\ttickTimer();\n\t\tthis.#cooldownInterval = setInterval(() => {\n\t\t\ttickTimer();\n\t\t\tif (this.#cooldown < 0)\n\t\t\t{\n\t\t\t\tclearInterval(this.#cooldownInterval);\n\t\t\t}\n\t\t}, 1000);\n\t}\n\n\tbeforeDismiss(options: Object): void\n\t{\n\t\tclearInterval(this.#cooldownInterval);\n\t}\n\n\t#renderResendBtn(): HTMLElement\n\t{\n\t\treturn Dom.create('a', {\n\t\t\tattrs: { href: '#' },\n\t\t\tprops: {\n\t\t\t\tclassName: 'intranet-push-otp-connect-popup__view-enter-code-new',\n\t\t\t},\n\t\t\thtml: Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_RESEND_CODE'),\n\t\t\tevents: {\n\t\t\t\tclick: () => {\n\t\t\t\t\tthis.#codeSent = false;\n\t\t\t\t\tthis.sendCode();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#renderTimer(): HTMLElement\n\t{\n\t\treturn Tag.render`<span>${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_COOLDOWN', {\n\t\t\t'#SEC#': this.#cooldown,\n\t\t})}</span>`;\n\t}\n\n\t#confirmCode(): void\n\t{\n\t\tif (this.#button.isWaiting())\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.#cleanError();\n\t\tthis.#button.setWaiting(true);\n\t\tBX.ajax.runAction('intranet.v2.Otp.confirmationPhoneNumber', {\n\t\t\tmethod: 'POST',\n\t\t\tdata: {\n\t\t\t\tsignedUserId: this.#signedUserId,\n\t\t\t\tcode: this.#input.getValue(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tthis.#button.setWaiting(false);\n\t\t\tif (response.status === 'success')\n\t\t\t{\n\t\t\t\tthis.#isPhoneNumberConfirmed = true;\n\t\t\t\tthis.emit(\n\t\t\t\t\t'onNextView',\n\t\t\t\t\t{\n\t\t\t\t\t\tviewCode: null,\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tcloseIfLast: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t}, (response) => {\n\t\t\tthis.#setError(response.errors);\n\t\t\tthis.#button.setWaiting(false);\n\t\t}).catch((response) => {\n\t\t\tthis.#setError(response.errors);\n\t\t\tthis.#button.setWaiting(false);\n\t\t});\n\t}\n\n\t#setError(errors: Array): void\n\t{\n\t\tthis.#input.setInputClass('confirm-code-input --danger');\n\t\tDom.clean(this.#errorContainer);\n\t\terrors.forEach((error) => {\n\t\t\tDom.append(Tag.render`<span>${error.message}</span>`, this.#errorContainer);\n\t\t});\n\t}\n\n\t#cleanError(): void\n\t{\n\t\tthis.#input.setInputClass('confirm-code-input --primary');\n\t\tDom.clean(BX('enter-code-error-container'));\n\t}\n\n\tisPhoneNumberConfirmed(): boolean\n\t{\n\t\treturn this.#isPhoneNumberConfirmed;\n\t}\n\n\t#createBackBtn(): BaseButton\n\t{\n\t\treturn new Button({\n\t\t\ttext: Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_BUTTON_BACK'),\n\t\t\tnoCaps: true,\n\t\t\tsize: Button.Size.MD,\n\t\t\tstyle: AirButtonStyle.PLAIN_NO_ACCENT,\n\t\t\tuseAirDesign: true,\n\t\t\tdisabled: false,\n\t\t\tonclick: () => {\n\t\t\t\tthis.emit('onPreviousView');\n\t\t\t},\n\t\t});\n\t}\n\n\tbeforeShow(option: Object)\n\t{\n\t\tthis.#codeSent = false;\n\t\tif (option.phoneNumber)\n\t\t{\n\t\t\tthis.#phoneNumber = option.phoneNumber;\n\t\t}\n\t}\n\n\tafterShow(option: Object)\n\t{\n\t\tAnalytics.sendEvent(Analytics.SHOW_INPUT_PHONE_CODE);\n\t\tif (!this.#codeSent)\n\t\t{\n\t\t\tthis.sendCode();\n\t\t}\n\t}\n\n\tafterDismiss(option: Object)\n\t{\n\t\tthis.#container.delete('view');\n\t\tDom.clean(this.#errorContainer);\n\t\tDom.clean(this.#timerContainer);\n\t\tthis.#cooldown = 0;\n\t\tclearInterval(this.#cooldownInterval);\n\t\tthis.#input.clear();\n\t}\n}\n","import { Tag, Loc, Browser, Dom } from 'main.core';\nimport { BaseView } from './base-view';\nimport { Confetti } from 'ui.confetti';\nimport { Analytics } from '../analytics';\n\nexport class SuccessView extends BaseView\n{\n\trender(): HTMLElement\n\t{\n\t\t// eslint-disable-next-line no-undef\n\t\treturn Tag.render`\n\t\t\t<div class=\"intranet-push-otp-connect-popup-success-box\">\n\t\t\t\t<div class=\"intranet-push-otp-connect-popup-success-logo\"></div>\n\t\t\t\t<div class=\"intranet-push-otp-connect-popup-success-title\">${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_SUCCESS_TITLE')}</div>\n\t\t\t\t<div class=\"intranet-push-otp-connect-popup-success-subtitle\">${Loc.getMessage('INTRANET_PUSH_OTP_CONNECT_POPUP_SUCCESS_SUBTITLE')}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tafterShow(option: Object)\n\t{\n\t\tAnalytics.sendEvent(Analytics.ADD_PHONE_SUCCESS);\n\t\tsetTimeout(() => {\n\t\t\tthis.#setConfetti();\n\t\t}, 500);\n\t}\n\n\t#setConfetti(): void\n\t{\n\t\tif (Browser.isFirefox())\n\t\t{\n\t\t\tconst canvas = Tag.render`\n\t\t\t\t<canvas></canvas>\n\t\t\t`;\n\t\t\tDom.style(canvas, 'position', 'fixed');\n\t\t\tDom.style(canvas, 'top', '0px');\n\t\t\tDom.style(canvas, 'left', '0px');\n\t\t\tDom.style(canvas, 'pointer-events', 'none');\n\t\t\tDom.style(canvas, 'z-index', '11111');\n\t\t\tDom.style(canvas, 'width', '100%');\n\t\t\tDom.style(canvas, 'height', '100%');\n\t\t\tDom.append(canvas, document.body);\n\t\t\tconst confetti = Confetti.create(canvas, {\n\t\t\t\tresize: true,\n\t\t\t\tuseWorker: true,\n\t\t\t});\n\t\t\tconfetti({\n\t\t\t\tparticleCount: 250,\n\t\t\t\torigin: { y: 0.65 },\n\t\t\t\tspread: 100,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tConfetti.fire({\n\t\t\t\tparticleCount: 250,\n\t\t\t\tspread: 100,\n\t\t\t\torigin: { y: 0.65 },\n\t\t\t\tzIndex: 111_111,\n\t\t\t});\n\t\t}\n\t}\n}\n","import { ajax as Ajax } from 'main.core';\nimport { ConnectPopup } from './connect-popup';\nimport { DeviceConnectedView } from './view/device-connected-view';\nimport { EnterCodeView } from './view/enter-code-view';\nimport { QrView } from './view/qr-view';\nimport { SendNumberView } from './view/send-number-view';\nimport { SuccessView } from './view/success-view';\nimport { RepeatingRequest } from './repeating-request';\nimport { deeplinkRequest } from './request';\n\nexport class EnablePushOtpProvider\n{\n\t#options: Object;\n\t#defaultTtl = 600;\n\n\tconstructor(options)\n\t{\n\t\tthis.#options = options || {};\n\t}\n\n\tappConnectingHandler(params: Object): Promise\n\t{\n\t\tconst initParams = {};\n\t\tif (params?.device)\n\t\t{\n\t\t\tinitParams.deviceInfo = params.device;\n\t\t}\n\n\t\tif (params?.startTimestamp)\n\t\t{\n\t\t\tinitParams.startTimestamp = params?.startTimestamp ?? 0;\n\t\t}\n\n\t\tconst data = {\n\t\t\tsecret: params.secret,\n\t\t\ttype: 'push',\n\t\t\tsync1: params.code,\n\t\t\tsync2: '',\n\t\t\tsignedUserId: params.signedUserId,\n\t\t\tinitParams,\n\t\t};\n\n\t\treturn Ajax.runAction(\n\t\t\t'intranet.v2.Otp.setupPushOtp',\n\t\t\t{\n\t\t\t\tmode: 'ajax',\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata,\n\t\t\t},\n\t\t);\n\t}\n\n\t#createQrView(): QrView\n\t{\n\t\treturn new QrView({\n\t\t\tsignedUserId: this.#options.signedUserId,\n\t\t\tpullConfig: this.#options.pullConfig,\n\t\t\tlinkProvider: this.#options?.linkProvider ?? (() => deeplinkRequest(this.#options.intent, this.#defaultTtl)),\n\t\t\trepeatingRequest: this.#options?.repeatingRequest ?? new RepeatingRequest(this.#defaultTtl * 1000),\n\t\t\tcallback: this.#options?.appConnectingProvider ?? this.appConnectingHandler,\n\t\t\tonAppConnected: this.#options?.events?.onAppConnected,\n\t\t\tid: 'qr',\n\t\t});\n\t}\n\n\t#createConnectedView(): DeviceConnectedView\n\t{\n\t\treturn new DeviceConnectedView({\n\t\t\tid: 'connected',\n\t\t});\n\t}\n\n\t#createSendNumberView(): SendNumberView\n\t{\n\t\treturn new SendNumberView({\n\t\t\tsignedUserId: this.#options.signedUserId,\n\t\t\tphoneNumber: this.#options.phoneNumber,\n\t\t\tisPhoneNumberConfirmed: this.#options.isPhoneNumberConfirmed,\n\t\t\tid: 'number',\n\t\t});\n\t}\n\n\t#createEnterCodeView(): EnterCodeView\n\t{\n\t\treturn new EnterCodeView({\n\t\t\tid: 'code',\n\t\t\tsignedUserId: this.#options.signedUserId,\n\t\t\tphoneNumber: this.#options.phoneNumber,\n\t\t});\n\t}\n\n\t#createSuccessView(): SuccessView\n\t{\n\t\treturn new SuccessView({\n\t\t\tid: 'success',\n\t\t\texcludeFromSteps: true,\n\t\t});\n\t}\n\n\tcreate(code: ?string): ConnectPopup\n\t{\n\t\tconst viewList = [\n\t\t\tthis.#createQrView(),\n\t\t\tthis.#createConnectedView(),\n\t\t\tthis.#createSendNumberView(),\n\t\t\tthis.#createEnterCodeView(),\n\t\t\tthis.#createSuccessView(),\n\t\t];\n\n\t\treturn this.#createConnectPopup(viewList, code);\n\t}\n\n\tonlySmsOtpConfirm(): ConnectPopup\n\t{\n\t\tconst viewList = [\n\t\t\tthis.#createEnterCodeView(),\n\t\t];\n\n\t\treturn this.#createConnectPopup(viewList);\n\t}\n\n\tonlySmsOtpChange(): ConnectPopup\n\t{\n\t\tconst sendNumberView = this.#createSendNumberView();\n\t\tconst viewList = [\n\t\t\tsendNumberView,\n\t\t\tthis.#createEnterCodeView(),\n\t\t];\n\n\t\tconst popup = this.#createConnectPopup(viewList);\n\t\tsendNumberView.setForceChangeMode(true);\n\n\t\treturn popup;\n\t}\n\n\tonlyPushOtp(): ConnectPopup\n\t{\n\t\tconst viewList = [\n\t\t\tthis.#createQrView(),\n\t\t\tthis.#createConnectedView(),\n\t\t];\n\n\t\treturn this.#createConnectPopup(viewList);\n\t}\n\n\tfull(): ConnectPopup\n\t{\n\t\tconst viewList = [\n\t\t\tthis.#createQrView(),\n\t\t\tthis.#createConnectedView(),\n\t\t\tthis.#createSendNumberView(),\n\t\t\tthis.#createEnterCodeView(),\n\t\t\tthis.#createSuccessView(),\n\t\t];\n\n\t\treturn this.#createConnectPopup(viewList);\n\t}\n\n\tresumeOtpRequest(): Promise\n\t{\n\t\treturn BX.ajax.runAction(\n\t\t\t'intranet.v2.Otp.resumeOtp',\n\t\t\t{\n\t\t\t\tmode: 'ajax',\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdata: {\n\t\t\t\t\tsignedUserId: this.#options.signedUserId,\n\t\t\t\t},\n\t\t\t},\n\t\t);\n\t}\n\n\t#createConnectPopup(viewList: Array, viewCode: string = null): ConnectPopup\n\t{\n\t\tconst popup = new ConnectPopup({\n\t\t\tviewList,\n\t\t\tviewCode,\n\t\t});\n\t\tpopup.subscribe('onClose', () => {\n\t\t\tthis.#options?.events?.onPopupClose?.();\n\t\t});\n\n\t\treturn popup;\n\t}\n}\n","import { ajax as Ajax } from 'main.core';\n\nexport const resumeOtpRequest = (signedUserId: string) => {\n\treturn BX.ajax.runAction(\n\t\t'intranet.v2.Otp.resumeOtp',\n\t\t{\n\t\t\tmode: 'ajax',\n\t\t\tmethod: 'POST',\n\t\t\tdata: {\n\t\t\t\tsignedUserId,\n\t\t\t},\n\t\t},\n\t);\n};\n\nexport const pauseOtpRequest = (days: number, signedUserId: string) => {\n\treturn BX.ajax.runAction(\n\t\t'intranet.v2.Otp.pauseOtp',\n\t\t{\n\t\t\tmode: 'ajax',\n\t\t\tmethod: 'POST',\n\t\t\tdata: {\n\t\t\t\tsignedUserId,\n\t\t\t\tdays,\n\t\t\t},\n\t\t},\n\t);\n};\n\nexport const deeplinkRequest = (intent: string, ttl: number) => {\n\treturn Ajax.runAction('mobile.deeplink.get', {\n\t\tdata: {\n\t\t\tintent,\n\t\t\tttl,\n\t\t},\n\t});\n};\n"],"names":["StepperController","constructor","options","Object","value","writable","Type","isNumber","totalSteps","babelHelpers","Math","max","currentStep","this","enabled","setEnabled","setStepInfo","getStepInfo","current","total","render","Tag","indicators","i","isActive","push","step","normalizedStep","min","BaseView","EventEmitter","super","setEventNamespace","isStringFilled","id","excludeFromSteps","getId","isExcludedFromSteps","renderStepIndicators","beforeDismiss","option","afterShow","afterDismiss","beforeShow","ConnectPopup","MemoryCache","isArray","viewList","forEach","view","viewCode","getViewByCode","subscribe","event","getData","_event$getData","_event$getData2","changeView","nextView","_event$getData3","_event$getData4","previousView","show","close","getView","prevView","reload","closeIfLast","setContent","filter","length","stepIndex","remember","result","index","Popup","content","width","closeByEsc","contentColor","autoHide","closeIcon","events","onPopupShow","emit","context","parent","onPopupClose","RepeatingRequest","interval","timerId","start","request","setInterval","stop","clearInterval","Analytics","[object Object]","eventName","sendData","tool","category","ADD_PHONE_SUCCESS","SHOW_INPUT_PHONE","SHOW_INPUT_PHONE_CODE","SHOW_INSTALL_APP","SHOW_INSTALL_APP_SUCCESS","QrView","signedUserId","repeatingRequest","isObject","pullConfig","isFunction","callback","linkProvider","Promise","Loader","target","mode","size","onAppConnected","Loc","getMessage","[LINK]","[/LINK]","sendEvent","bind","isAppSuccessConnected","element","deeplink","QRCode","text","height","colorDark","colorLight","correctLevel","CorrectLevel","H","Dom","clean","then","response","link","data","_response$data","hide","catch","pull","PullClient","moduleId","command","params","console","log","device","error","PULL","type","success","SendNumberView","isString","phoneNumber","PhoneFormatter","formatValue","isPhoneNumberConfirmed","shouldShowInput","querySelector","_this$render$querySel","focus","setForceChangeMode","force","input","create","attrs","className","name","props","isElementNode","Reflection","getClass","BX","PhoneNumber","phoneInput","Input","node","waitForInitialization","countryCode","Text","encode","getCountryCode","placeholder","html","click","container","inputBox","append","_inputBox$querySelect","Button","noCaps","Size","MD","useAirDesign","disabled","onclick","button","isWaiting","isDisabled","setWaiting","ajax","runAction","method","errors","code","message","DeviceConnectedView","phoneLabel","phoneOs","_options$device","displayModel","_options$device2","manufacturer","CodeInput","codeLength","mask","RegExp","containerClassName","isBoolean","autoFocus","allowPaste","complete","getValue","querySelectorAll","map","join","setInputClass","_babelHelpers$classPr2","setValue","inputs","digits","replace","idx","clear","firstInput","Event","setTimeout","tag","autocomplete","maxlength","keydown","slice","key","prevInput","previousElementSibling","tagName","preventDefault","select","clipboardData","window","digit","lastFilledIndex","nextInput","blur","currentInput","nextElementSibling","EnterCodeView","setDisabled","stepInfo","#PHONE_NUMBER#","sendCode","status","DATE_SEND","_response$data2","_response$data3","_response$data4","delete","tickTimer","href","#SEC#","style","AirButtonStyle","PLAIN_NO_ACCENT","SuccessView","Browser","isFirefox","canvas","document","body","Confetti","resize","useWorker","confetti","particleCount","origin","y","spread","fire","zIndex","deeplinkRequest","intent","ttl","Ajax","_babelHelpers$classPr4","_babelHelpers$classPr6","appConnectingProvider","appConnectingHandler","_babelHelpers$classPr7","_babelHelpers$classPr8","popup","_babelHelpers$classPr9","_babelHelpers$classPr10","initParams","deviceInfo","startTimestamp","secret","sync1","sync2","onlySmsOtpConfirm","onlySmsOtpChange","sendNumberView","onlyPushOtp","full","resumeOtpRequest","days"],"mappings":"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"}