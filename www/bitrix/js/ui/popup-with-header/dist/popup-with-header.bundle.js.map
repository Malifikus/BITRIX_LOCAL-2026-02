{"version":3,"file":"popup-with-header.bundle.js","sources":["../src/round-player.js","../src/header-builder.js","../src/popup-header.js","../src/skeleton.js","../src/popup-with-header.js","../src/templates/base-template.js","../src/templates/sale-template.js"],"sourcesContent":["import { Dom, Tag, Text, Type } from 'main.core';\nimport { Loader } from 'main.loader';\nimport { ProgressRound } from 'ui.progressround'\nimport './player.css';\n\nexport type PlayerOptions = {\n\twrapper: HTMLElement,\n\twidth: number,\n\tscale: ?number,\n\tposterUrl: ?string,\n\tvideos: Array<{url: string, type: string}>,\n\tloop: boolean,\n\tautoplay: boolean,\n\tmuted: boolean,\n\tanalyticsCallback: ?Function,\n}\n\nexport class RoundPlayer\n{\n\tstatic PLAY_STATE_BACKGROUND = 'background';\n\tstatic PLAY_STATE_USER = 'user';\n\n\t#pausePlayerWidth: number;\n\t#scale: number;\n\t#videos: Array;\n\t#loop: true;\n\t#autoplay: false;\n\t#muted: true;\n\t#content: HTMLElement;\n\t#videoNode: HTMLVideoElement;\n\t#playerNode: HTMLElement;\n\t#progressBar: ProgressRound;\n\t#barPadding: number = 3;\n\t#posterUrl: string;\n\t#loader: Loader;\n\t#currentPlayState: string = RoundPlayer.PLAY_STATE_BACKGROUND;\n\t#playButton: HTMLElement;\n\t#stopButton: HTMLElement;\n\t#wrapper: HTMLElement;\n\t#hasAutoPlayed: boolean = false;\n\t#analyticsCallback: ?Function;\n\n\tconstructor(options: PlayerOptions)\n\t{\n\t\tthis.#wrapper = options.wrapper;\n\t\tthis.#pausePlayerWidth = options.width ?? 86;\n\t\tthis.#scale = Type.isNumber(options.scale) ? options.scale : 1;\n\t\tthis.#videos = Type.isArrayFilled(options.videos) ? options.videos : [];\n\t\tthis.#loop = Type.isBoolean(options.loop) ? options.loop : true;\n\t\tthis.#autoplay = Type.isBoolean(options.autoplay) ? options.autoplay : true;\n\t\tthis.#muted = Type.isBoolean(options.muted) ? options.muted : true;\n\t\tthis.#posterUrl = options.posterUrl;\n\t\tthis.#analyticsCallback = Type.isFunction(options.analyticsCallback) ? options.analyticsCallback : null;\n\n\t\tthis.#playerNode = Tag.render`<div class=\"ui-popupcomponentmaker__round-player\"></div>`;\n\t\tthis.#playButton = Tag.render`<div class=\"ui-popupcomponentmaker__round-player-btn\"></div>`;\n\t\tthis.#stopButton = Tag.render`<div class=\"ui-popupcomponentmaker__round-player-btn --stop-btn\"></div>`;\n\t\tlet poster = '';\n\t\tif (Type.isStringFilled(this.#posterUrl))\n\t\t{\n\t\t\tthis.#playerNode.style.backgroundImage = 'url(\"'+Text.encode(this.#posterUrl)+'\")';\n\t\t\tposter = 'poster=\"'+Text.encode(this.#posterUrl)+'\"';\n\t\t}\n\n\t\tconst autoplay = this.#autoplay ? 'autoplay' : '';\n\t\tconst muted = this.#muted ? 'muted' : '';\n\t\tthis.#videoNode = Tag.render`<video ${poster} ${autoplay} ${muted}></video>`;\n\t\tthis.#videoNode.muted = this.#muted;\n\t\tthis.#videoNode.autoplay = this.#autoplay;\n\t\t// this.#videoNode.loop = this.#loop;\n\n\t\tthis.#loader = new Loader({\n\t\t\tsize: 40\n\t\t});\n\t\tthis.#playerNode.style.width = this.#pausePlayerWidth + 'px';\n\n\t\tthis.#videoNode.addEventListener('timeupdate', this.#onTick.bind(this));\n\t\tthis.#videoNode.addEventListener('loadedmetadata', this.#onInitVideoMetadata.bind(this));\n\t\tthis.#playerNode.addEventListener('click', this.#onClickPlayer.bind(this));\n\t\tthis.#videoNode.addEventListener('ended', this.#onVideoEnded.bind(this));\n\t\tthis.#videoNode.addEventListener('play', this.#onPlay.bind(this));\n\t\tthis.#videoNode.addEventListener('pause', this.#onPause.bind(this));\n\t\tthis.#playButton.addEventListener('click', this.#onClickPlayer.bind(this));\n\t\tthis.#stopButton.addEventListener('click', this.#onClickStopButton.bind(this));\n\n\t\tthis.#videoNode.addEventListener('canplay', () => {\n\t\t\tthis.#loader.hide();\n\t\t});\n\t\tthis.#videoNode.addEventListener('waiting', () => {\n\t\t\tthis.#loader.show(this.#playerNode);\n\t\t});\n\t}\n\n\trender()\n\t{\n\t\tif (this.#content)\n\t\t{\n\t\t\treturn this.#content;\n\t\t}\n\n\t\tthis.#videos.forEach((video) => {\n\t\t\tDom.append(Tag.render`<source src=\"${video.url}\" type=\"${video.type}\">`, this.#videoNode);\n\t\t});\n\n\t\tDom.append(this.#videoNode, this.#playerNode);\n\t\tDom.append(this.#playButton, this.#wrapper);\n\t\tDom.append(this.#stopButton, this.#wrapper);\n\t\tDom.append(this.#playerNode, this.#wrapper);\n\n\t\tthis.#content = this.#wrapper;\n\n\t\treturn this.#content;\n\t}\n\n\trenderTo(wrapper: HTMLElement): HTMLElement\n\t{\n\t\tDom.append(wrapper, this.render());\n\n\t\treturn wrapper;\n\t}\n\n\t#onInitVideoMetadata(event): void\n\t{\n\t\tthis.#progressBar = new ProgressRound({\n\t\t\twidth: this.#pausePlayerWidth - 2 * this.#barPadding,\n\t\t\tlineSize: 2,\n\t\t\tmaxValue: this.#videoNode.duration,\n\t\t\tvalue: this.#videoNode.currentTime,\n\t\t\tcolorBar: '#fff',\n\t\t\tcolorTrack: 'rgba(0, 0, 0, 0)',\n\t\t});\n\n\t\tif (this.#autoplay)\n\t\t{\n\t\t\tthis.play();\n\t\t}\n\t}\n\n\t#onTick(): void\n\t{\n\t\tthis.#progressBar.update(this.#videoNode.currentTime);\n\t}\n\n\t#onClickPlayer(): void\n\t{\n\t\tif (this.#currentPlayState === RoundPlayer.PLAY_STATE_BACKGROUND)\n\t\t{\n\t\t\tthis.userPlay();\n\t\t\tDom.removeClass(this.render(), '--stop');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#videoNode.paused ? this.play() : this.pause();\n\t\t}\n\n\t\tif (this.#analyticsCallback)\n\t\t{\n\t\t\tthis.#analyticsCallback('click-player');\n\t\t}\n\t}\n\n\t#onClickStopButton(): void\n\t{\n\t\tif (this.#analyticsCallback)\n\t\t{\n\t\t\tthis.#analyticsCallback('click-player');\n\t\t}\n\n\t\tthis.stop();\n\t}\n\n\t#onVideoEnded(): void\n\t{\n\t\tif (this.#analyticsCallback && (!this.#videoNode.muted || !this.#hasAutoPlayed))\n\t\t{\n\t\t\tthis.#analyticsCallback('video_finished', `isMuted_${this.#videoNode.muted ? 'Y' : 'N'}`);\n\t\t}\n\n\t\tif (!this.#hasAutoPlayed)\n\t\t{\n\t\t\tthis.#hasAutoPlayed = this.#videoNode.muted;\n\t\t}\n\n\t\tthis.stop();\n\t\tDom.remove(this.#progressBar.getContainer());\n\t\tthis.setMute(true);\n\n\t\tif (this.#loop)\n\t\t{\n\t\t\tthis.play();\n\t\t}\n\t}\n\n\t#scaleTo(x: number)\n\t{\n\t\tthis.#playerNode.style.transform = `scale(${x})`;\n\t}\n\n\t#onPause(): void\n\t{\n\t\tthis.#scaleTo(1);\n\n\t\tif (this.#analyticsCallback && (!this.#videoNode.muted || !this.#hasAutoPlayed))\n\t\t{\n\t\t\tthis.#analyticsCallback('on-pause');\n\t\t}\n\t}\n\n\t#onPlay(): void\n\t{\n\t\tthis.#scaleTo(this.#scale);\n\n\t\tif (this.#analyticsCallback && (!this.#videoNode.muted || !this.#hasAutoPlayed))\n\t\t{\n\t\t\tthis.#analyticsCallback('on-play');\n\t\t}\n\t}\n\n\tplay(): void\n\t{\n\t\tthis.#videoNode.play();\n\t\tDom.removeClass(this.render(), '--stop');\n\t}\n\n\tsetMute(mute: boolean): void\n\t{\n\t\tthis.#videoNode.muted = mute;\n\t}\n\n\tgetPlayState(): string\n\t{\n\t\treturn this.#currentPlayState;\n\t}\n\n\tpause(): void\n\t{\n\t\tthis.#videoNode.pause();\n\t}\n\n\tstop(): void\n\t{\n\t\tthis.pause();\n\t\tthis.#currentPlayState = RoundPlayer.PLAY_STATE_BACKGROUND;\n\t\tthis.#videoNode.currentTime = 0;\n\t\tDom.addClass(this.render(), '--stop');\n\t}\n\n\tuserPlay()\n\t{\n\t\tthis.stop();\n\t\tthis.#currentPlayState = RoundPlayer.PLAY_STATE_USER;\n\t\tthis.#progressBar.setValue(0);\n\t\tDom.remove(this.#progressBar.getContainer());\n\t\tthis.#progressBar.renderTo(this.#playerNode);\n\t\tthis.setMute(false);\n\t\tthis.play();\n\t}\n}\n","import { Tag, Type, Dom } from 'main.core';\nimport { RoundPlayer, PlayerOptions } from './round-player';\nimport { PopupComponentsMakerItem } from 'ui.popupcomponentsmaker';\nimport { Button, ButtonColor, ButtonSize } from 'ui.buttons';\nimport { Icon, Actions } from 'ui.icon-set.api.core';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\nimport { Text, Headline } from 'ui.system.typography';\n\nexport type TitleHeaderOptions = {\n\ttitle: string | HTMLElement | null,\n\tsubtitle: string | HTMLElement | null\n}\n\nexport type ButtonOptions = {\n\tlabel: string,\n\turl: string,\n}\n\nexport type DescriptionHeaderOptions = {\n\ttitle: string,\n\tsubtitle: ?string,\n\tsubtitleDescription: ?string,\n\tmoreLabel: ?string,\n\tcode: ?string,\n\troundContent: PlayerOptions | string\n}\n\nexport type TariffHeaderOptions = {\n\ticon: ?Icon,\n\ticonClass: ?string,\n\ttop: TitleHeaderOptions,\n\tinfo: DescriptionHeaderOptions,\n\tbutton: ?ButtonOptions,\n\tanalyticsCallback: ?Function,\n}\n\nexport class HeaderBuilder\n{\n\t#options: TariffHeaderOptions = null;\n\t#content: HTMLElement;\n\t#player: ?RoundPlayer;\n\n\tconstructor(options: TariffHeaderOptions)\n\t{\n\t\tthis.#options = options;\n\t}\n\n\tbuildPlayer(playerOptions: PlayerOptions): RoundPlayer\n\t{\n\t\treturn new RoundPlayer({\n\t\t\twrapper: playerOptions.wrapper,\n\t\t\tpausePlayerWidth: playerOptions.width,\n\t\t\tscale: playerOptions.scale,\n\t\t\tposterUrl: playerOptions.posterUrl,\n\t\t\tvideos: playerOptions.videos,\n\t\t\tloop: playerOptions.loop,\n\t\t\tautoplay: playerOptions.autoplay,\n\t\t\tmuted: playerOptions.muted,\n\t\t\tanalyticsCallback: this.#options.analyticsCallback,\n\t\t});\n\t}\n\n\trenderPlayer(playerOptions: PlayerOptions): HTMLElement\n\t{\n\t\tif (this.#player)\n\t\t{\n\t\t\treturn this.#player;\n\t\t}\n\n\t\tconst wrapper = Tag.render`<div class=\"ui-popupcomponentsmaker__round-player-box\"/>`;\n\t\tthis.#player = this.buildPlayer({ ...playerOptions, wrapper });\n\n\t\tif (this.#player)\n\t\t{\n\t\t\treturn this.#player.render();\n\t\t}\n\n\t\treturn Tag.render``;\n\t}\n\n\tgetPlayer(): RoundPlayer\n\t{\n\t\treturn this.#player;\n\t}\n\n\trenderTitle(titleOptions: TitleHeaderOptions): HTMLElement\n\t{\n\t\tconst title = Tag.render`\n\t\t\t<div class=\"ui-popupcomponentsmaker-header-tariff__header-content\"></div>\n\t\t`;\n\n\t\tif (!Type.isNil(titleOptions.title))\n\t\t{\n\t\t\tDom.append(Tag.render`<div class=\"ui-popupcomponentsmaker-header-tariff__title\">${titleOptions.title}</div>`, title);\n\t\t}\n\n\t\tif (!Type.isNil(titleOptions.subtitle))\n\t\t{\n\t\t\tDom.append(Tag.render`<div class=\"ui-popupcomponentsmaker-header-tariff__subtitle\">${titleOptions.subtitle}</div>`, title);\n\t\t}\n\n\t\tif (!Type.isNil(titleOptions.headTitle))\n\t\t{\n\t\t\tconst headTitle = Text.render(titleOptions.headTitle, {\n\t\t\t\tsize: '4xs',\n\t\t\t\ttransform: 'uppercase',\n\t\t\t\taccent: true,\n\t\t\t\tclassName: 'ui-popupcomponentsmaker-header-tariff__uppertitle',\n\t\t\t});\n\t\t\tDom.append(headTitle, title);\n\t\t}\n\n\t\treturn title;\n\t}\n\n\trenderDescription(descriptionOptions: DescriptionHeaderOptions): HTMLElement\n\t{\n\t\tconst descriptionText = Tag.render`\n\t\t\t<div class=\"ui-popupcomponentsmaker-header-tariff__box\"></div>\n\t\t`;\n\n\t\tif (!Type.isNil(descriptionOptions.headTitle))\n\t\t{\n\t\t\tconst headTitle = Headline.render(descriptionOptions.headTitle, {\n\t\t\t\tsize: 'sm',\n\t\t\t\taccent: true,\n\t\t\t\tclassName: 'ui-popupcomponentsmaker-header-tariff__headtitle',\n\t\t\t});\n\n\t\t\tDom.append(headTitle, descriptionText);\n\t\t}\n\n\t\tlet moreLink = Tag.render``;\n\t\tif (!Type.isNil(descriptionOptions.code))\n\t\t{\n\t\t\tconst onclick = (e) => {\n\t\t\t\te.stopPropagation();\n\t\t\t\tFeaturePromotersRegistry.getPromoter({ code: descriptionOptions.code }).show();\n\t\t\t};\n\t\t\tmoreLink = Tag.render`<a onclick=\"${onclick}\" target=\"_blank\" class=\"ui-popupcomponentsmaker-header-tariff__more\">${descriptionOptions.moreLabel}</a>`;\n\t\t}\n\n\t\tif (!Type.isNil(descriptionOptions.title))\n\t\t{\n\t\t\tconst descTitle = Tag.render`<div class=\"ui-popupcomponentsmaker-header-tariff__title\">\n\t\t\t\t${`${descriptionOptions.title} `}\n\t\t\t\t${moreLink}\n\t\t\t</div>`;\n\n\t\t\tDom.append(descTitle, descriptionText);\n\t\t}\n\n\t\tif (!Type.isNil(descriptionOptions.subtitle))\n\t\t{\n\t\t\tDom.append(Tag.render`<div class=\"ui-popupcomponentsmaker-header-tariff__subtitle\">${descriptionOptions.subtitle}</div>`, descriptionText);\n\t\t}\n\n\t\tif (!Type.isNil(descriptionOptions.subtitleDescription))\n\t\t{\n\t\t\tDom.append(Tag.render`<div class=\"ui-popupcomponentsmaker-header-tariff__text\">${descriptionOptions.subtitleDescription}</div>`, descriptionText);\n\t\t}\n\n\t\tlet roundContent = '';\n\t\tif (Type.isPlainObject(descriptionOptions.roundContent))\n\t\t{\n\t\t\troundContent = this.renderPlayer(descriptionOptions.roundContent);\n\t\t}\n\t\telse if (Type.isStringFilled(descriptionOptions.roundContent))\n\t\t{\n\t\t\troundContent = this.renderIcon(descriptionOptions.roundContent, '--with-bg');\n\t\t}\n\t\telse if (Type.isDomNode(descriptionOptions.roundContent))\n\t\t{\n\t\t\troundContent = this.embedIcon(descriptionOptions.roundContent, '--with-bg');\n\t\t}\n\t\telse if (descriptionOptions?.avatarUrl)\n\t\t{\n\t\t\troundContent = this.renderAvatar(descriptionOptions.avatarUrl);\n\t\t}\n\n\t\tconst descriptionBlock = Tag.render`\n\t\t\t<div class=\"ui-popupcomponentsmaker-header-tariff__message-wrapper\">\n\t\t\t\t${roundContent}\n\t\t\t\t${descriptionText}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst description = new PopupComponentsMakerItem({\n\t\t\thtml: descriptionBlock,\n\t\t\twithoutBackground: false,\n\t\t});\n\n\t\tDom.addClass(description.getContainer(), 'ui-popupcomponentsmaker-header-tariff__section-message-wrapper');\n\n\t\tif (!Type.isNil(descriptionOptions.subtitleDescription))\n\t\t{\n\t\t\tdescription.getContainer().style.marginTop = '14px';\n\t\t}\n\n\t\tdescription.getContainer().classList.add('--transparent');\n\n\t\treturn description.getContainer();\n\t}\n\n\trenderBtn(btnOptions: ButtonOptions | Button): HTMLElement\n\t{\n\t\tconst btn = btnOptions instanceof Button\n\t\t\t? btnOptions\n\t\t\t: new Button({\n\t\t\t\ttext: btnOptions.label,\n\t\t\t\tcolor: ButtonColor.LIGHT_BORDER,\n\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\tlink: btnOptions.url,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tif (this.#options.analyticsCallback)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#options.analyticsCallback('click-button-header', btnOptions.url);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tround: true,\n\t\t\t\tnoCaps: true,\n\t\t\t})\n\t\t;\n\t\tbtn.addClass('ui-popupcomponentsmaker-header-tariff__button ui-btn-themes');\n\n\t\treturn btn.render();\n\t}\n\n\trenderIcon(iconClass: string, wrapperClass: string = ''): HTMLElement\n\t{\n\t\tif (Type.isStringFilled(iconClass))\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-popupcomponentsmaker-header-tariff__icon ${wrapperClass}\">\n\t\t\t\t\t<div class=\"ui-icon-set ${iconClass}\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render``;\n\t}\n\n\tembedIcon(icon: HTMLElement, wrapperClass: string = ''): HTMLElement\n\t{\n\t\tif (Type.isDomNode(icon))\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"ui-popupcomponentsmaker-header-tariff__icon ${wrapperClass}\">\n\t\t\t\t\t${icon}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render``;\n\t}\n\n\trenderAvatar(avatarUrl: string): HTMLElement\n\t{\n\t\tif (Type.isStringFilled(avatarUrl))\n\t\t{\n\t\t\tconst avatar = Tag.render`<div class=\"ui-popupcomponentsmaker-header-tariff__avatar\"</div>`;\n\t\t\tDom.style(avatar, 'background-image', `url(\"${avatarUrl}\")`);\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div style=\"align-self: flex-start;\">\n\t\t\t\t\t${avatar}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render``;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (this.#content)\n\t\t{\n\t\t\treturn this.#content;\n\t\t}\n\t\tlet btnContent = '';\n\t\tif (this.#options.button)\n\t\t{\n\t\t\tbtnContent = Tag.render`\n\t\t\t\t<div class=\"ui-popupcomponentsmaker-header-tariff__button-bar\">\n\t\t\t\t\t${this.renderBtn(this.#options.button)}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\t\tthis.#content = Tag.render`\n\t\t\t<div class=\"ui-popupcomponentsmaker-header-tariff__wrapper\">\n\t\t\t\t<div class=\"ui-popupcomponentsmaker-header-tariff__title-section\">\n\t\t\t\t\t${\n\t\t\t\t\t\tthis.#options.icon instanceof HTMLElement\n\t\t\t\t\t\t? this.embedIcon(this.#options.icon)\n\t\t\t\t\t\t: this.renderIcon(this.#options.iconClass, this.#options.top?.headTitle ? '--icon-small' : '')\n\t\t\t\t\t}\n\t\t\t\t\t${this.renderTitle(this.#options.top)}\n\t\t\t\t</div>\n\t\n\t\t\t\t${this.renderDescription(this.#options.info)}\n\t\t\t\t${btnContent}\n\t\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#content;\n\t}\n}\n","import { Dom, Tag, Text } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { PopupComponentsMakerItem } from 'ui.popupcomponentsmaker';\nimport type { TariffHeaderOptions } from './header-builder';\nimport { HeaderBuilder } from './header-builder';\nimport './header.css';\n\nexport class PopupHeader extends PopupComponentsMakerItem\n{\n\tconstructor(options = {})\n\t{\n\t\toptions.withoutBackground = true;\n\t\toptions.backgroundColor = null;\n\t\toptions.backgroundImage = null;\n\t\tsuper(options);\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\tif (!this.layout.container)\n\t\t{\n\t\t\tconst theme = this.#getThemePicker()?.getAppliedTheme();\n\t\t\tthis.layout.container = Tag.render`<div class=\"ui-popupcomponentsmaker__header\">${this.getContent()}</div>`;\n\t\t\tthis.bacgroundNode = Tag.render`<div class=\"ui-popupcomponentsmaker__header-background\"></div>`;\n\t\t\tDom.append(this.bacgroundNode, this.layout.container);\n\n\t\t\tif (theme)\n\t\t\t{\n\t\t\t\tthis.#applyTheme(this.bacgroundNode, theme);\n\t\t\t}\n\n\t\t\tEventEmitter.subscribe(\n\t\t\t\t'BX.Intranet.Bitrix24:ThemePicker:onThemeApply',\n\t\t\t\t(event) =>\n\t\t\t\t{\n\t\t\t\t\tthis.#applyTheme(this.bacgroundNode, event.data.theme);\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\treturn super.getContainer();\n\t}\n\n\t#getThemePicker(): ?BX.Intranet.Bitrix24.ThemePicker\n\t{\n\t\treturn BX.Intranet?.Bitrix24?.ThemePicker.Singleton ?? top.BX.Intranet?.Bitrix24?.ThemePicker.Singleton;\n\t}\n\n\t#applyTheme(container, theme): void\n\t{\n\t\tconst previewImage = `url('${Text.encode(theme.previewImage)}')`;\n\t\tDom.style(container, 'backgroundImage', previewImage);\n\n\t\tif (theme.previewColor)\n\t\t{\n\t\t\tDom.style(container, 'backgroundColor', theme.previewColor);\n\t\t}\n\n\t\tDom.removeClass(this.layout.container, 'bitrix24-dark-theme bitrix24-light-theme bitrix24-default-theme');\n\t\tlet themeClass = 'bitrix24-default-theme';\n\n\t\tif (theme.id !== 'default')\n\t\t{\n\t\t\tthemeClass = String(theme.id).indexOf('dark:') === 0 ? 'bitrix24-dark-theme' : 'bitrix24-light-theme';\n\t\t}\n\n\t\tDom.addClass(this.layout.container, themeClass);\n\t}\n\n\tstatic createByJson(popupId: string, options: TariffHeaderOptions): PopupHeader\n\t{\n\t\tconst builder = new HeaderBuilder(options);\n\t\tconst header = new PopupHeader({\n\t\t\thtml: builder.render(),\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Main.Popup:onClose', (event) => {\n\t\t\tif (popupId === event.target.uniquePopupId)\n\t\t\t{\n\t\t\t\tbuilder.getPlayer()?.stop();\n\t\t\t}\n\t\t});\n\n\t\treturn header;\n\t}\n}\n","import { Tag } from 'main.core';\n\nexport class Skeleton\n{\n\t#height: number;\n\t#width: number;\n\n\tconstructor(height: number = 447, width: number = 344)\n\t{\n\t\tthis.#height = height;\n\t\tthis.#width = width;\n\t}\n\n\tget(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div style=\"height: ${this.#height}px; width: ${this.#width}px;\" class=\"popup-with-header-skeleton__wrap\">\n\t\t\t\t<div class=\"popup-with-header-skeleton__header\">\n\t\t\t\t\t<div class=\"popup-with-header-skeleton__header-top\">\n\t\t\t\t\t\t<div class=\"popup-with-header-skeleton__header-circle\">\n\t\t\t\t\t\t\t<div class=\"popup-with-header-skeleton__header-circle-inner\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div style=\"width: 100%;\">\n\t\t\t\t\t\t\t<div style=\"margin-bottom: 12px; max-width: 219px; height: 6px; background: rgba(255,255,255,.8);\" class=\"popup-with-header-skeleton__line\"></div>\n\t\t\t\t\t\t\t<div style=\"max-width: 119px; height: 4px;\" class=\"popup-with-header-skeleton__line\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"popup-with-header-skeleton__header-bottom\">\n\t\t\t\t\t\t<div class=\"popup-with-header-skeleton__header-bottom-circle-box\">\n\t\t\t\t\t\t\t<div class=\"popup-with-header-skeleton__header-bottom-circle\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div style=\"width: 100%;\">\n\t\t\t\t\t\t\t<div style=\"margin-bottom: 9px; max-width: 193px; height: 5px;\" class=\"popup-with-header-skeleton__line\"></div>\n\t\t\t\t\t\t\t<div style=\"margin-bottom: 15px; max-width: 163px; height: 5px;\" class=\"popup-with-header-skeleton__line\"></div>\n\t\t\t\t\t\t\t<div style=\"margin-bottom: 9px; max-width: 156px; height: 2px;\" class=\"popup-with-header-skeleton__line\"></div>\n\t\t\t\t\t\t\t<div style=\"margin-bottom: 9px; max-width: 93px; height: 2px;\" class=\"popup-with-header-skeleton__line\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"popup-with-header-skeleton__bottom\">\n\t\t\t\t\t${this.#getInnerBlock()}\n\t\t\t\t\t${this.#getInnerBlock('--green')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getInnerBlock(btnClass: string = ''): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"popup-with-header-skeleton__bottom-inner\">\n\t\t\t\t<div class=\"popup-with-header-skeleton__bottom-title\">\n\t\t\t\t\t<div class=\"popup-with-header-skeleton__bottom-left\">\n\t\t\t\t\t\t<div style=\"margin-top: 9px; max-width: 183px; height: 5px;\" class=\"popup-with-header-skeleton__line\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"popup-with-header-skeleton__bottom-right\">\n\t\t\t\t\t\t<div class=\"popup-with-header-skeleton-btn ${btnClass}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"popup-with-header-skeleton__bottom-desc\">\n\t\t\t\t\t<div style=\"margin-bottom: 9px; max-width: 238px; height: 3px; background: rgba(149,156,164,.23);\" class=\"popup-with-header-skeleton__line --dark-animation\"></div>\n\t\t\t\t\t<div style=\"margin-bottom: 9px; max-width: 201px; height: 3px; background: rgba(149,156,164,.23);\" class=\"popup-with-header-skeleton__line --dark-animation\"></div>\n\t\t\t\t\t<div style=\"margin-bottom: 9px; max-width: 220px; height: 3px; background: rgba(149,156,164,.23);\" class=\"popup-with-header-skeleton__line --dark-animation\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import { Dom, Tag, Text, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { PopupComponentsMaker } from 'ui.popupcomponentsmaker';\nimport { PopupHeader } from './popup-header';\nimport { Popup } from 'main.popup';\nimport { BaseTemplate } from 'ui.popup-with-header';\nimport './styles.css';\nimport { Skeleton } from './skeleton';\n\nexport class PopupWithHeader extends PopupComponentsMaker\n{\n\theaderWrapper: ?HTMLElement;\n\t#popupOptions: Object;\n\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.header = (options.header instanceof PopupHeader) ? options.header : null;\n\t\tthis.template = options.template instanceof BaseTemplate ? options.template : null;\n\t\tthis.asyncData = (options.asyncData instanceof BX.Promise || options.asyncData instanceof Promise) ? options.asyncData : null;\n\t\tthis.animationTemplate = options.animationTemplate ?? true;\n\t\tthis.skeletonHeight = options.skeletonHeight ?? 447;\n\t\tthis.skeletonWidth = options.skeletonWidth ?? 344;\n\t\tthis.analyticsCallback = Type.isFunction(options.analyticsCallback) ? options.analyticsCallback : null;\n\t\tthis.#popupOptions = Type.isPlainObject(options.popupOptions) ? options.popupOptions : {};\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\tif (!this.popup)\n\t\t{\n\t\t\tconst popupWidth = this.width ? this.width : 344;\n\t\t\tconst popupId = this.id ? `${this.id}-popup` : null;\n\t\t\tlet content = [];\n\n\t\t\tif (!this.asyncData)\n\t\t\t{\n\t\t\t\tcontent = Tag.render`\n\t\t\t\t\t<div>\n\t\t\t\t\t\t${this.getHeaderWrapper()}\n\t\t\t\t\t<div>\n\t\t\t\t`;\n\t\t\t\tif (this.content.length > 0)\n\t\t\t\t{\n\t\t\t\t\tcontent.append(Tag.render`<div style=\"padding: 0 ${this.padding}px ${this.padding}px ${this.padding}px\">${this.getContentWrapper()}</div>`);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.popup = new Popup(popupId, this.target, ({\n\t\t\t\tclassName: 'ui-popupcomponentmaker',\n\t\t\t\tcontentBackground: 'transparent',\n\t\t\t\tcontentPadding: this.contentPadding,\n\t\t\t\tangle: this.useAngle\n\t\t\t\t\t? {\n\t\t\t\t\t\toffset: (popupWidth / 2) - 16,\n\t\t\t\t\t}\n\t\t\t\t\t: false,\n\t\t\t\toffsetTop: this.offsetTop,\n\t\t\t\twidth: popupWidth,\n\t\t\t\toffsetLeft: -(popupWidth / 2) + (this.target ? this.target.offsetWidth / 2 : 0) + 40,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tpadding: 0,\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tcontent,\n\t\t\t\tcacheable: this.cacheable,\n\t\t\t\t...this.#popupOptions,\n\t\t\t}));\n\n\t\t\tif (this.asyncData)\n\t\t\t{\n\t\t\t\tconst container = this.popup.getContentContainer();\n\t\t\t\tDom.clean(container);\n\t\t\t\tDom.append(this.getSkeleton(), container);\n\t\t\t\tthis.preparePopupAngly(container);\n\n\t\t\t\tif (Type.isDomNode(container.parentNode))\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(container.parentNode, '--with-header');\n\t\t\t\t}\n\n\t\t\t\tthis.asyncData.then((response) => {\n\t\t\t\t\tDom.clean(container);\n\t\t\t\t\tresponse.data.header.analyticsCallback = this.analyticsCallback;\n\t\t\t\t\tthis.header = PopupHeader.createByJson(popupId, response.data.header);\n\t\t\t\t\tlet hasContent = response.data.items && this.template;\n\n\t\t\t\t\tcontent = Tag.render`\n\t\t\t\t\t\t<div ${hasContent ? 'class=\"ui-popupcomponentmaker-wrap --with-border-radius-content\"' : ''}>\n\t\t\t\t\t\t\t${this.getHeaderWrapper()}\n\t\t\t\t\t\t<div>\n\t\t\t\t\t`;\n\n\t\t\t\t\tif (hasContent)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.template.setOptions({\n\t\t\t\t\t\t\titems: response.data.items,\n\t\t\t\t\t\t\tanalyticsCallback: this.analyticsCallback,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.content = this.template.getContent();\n\t\t\t\t\t\tthis.contentWrapper = null;\n\n\t\t\t\t\t\tif (Dom.hasClass(this.getHeaderWrapper(), '--empty-content'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.removeClass(this.getHeaderWrapper(), '--empty-content');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!this.getHeaderWrapper().querySelector('.ui-popupcomponentsmaker__round-player-box')\n\t\t\t\t\t\t\t&& !Dom.hasClass(this.getHeaderWrapper(), '--without-video')\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tDom.addClass(this.getHeaderWrapper(), '--without-video');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tDom.addClass(this.getHeaderWrapper(), '--with-border-radius-wrap');\n\n\t\t\t\t\t\tif (this.content.length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontent.append(Tag.render`<div class=\"ui-popupcomponentmaker__content-wrap-round\"><div class=\"ui-popupcomponentmaker__content-wrap\">${this.getContentWrapper()}</div></div>`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thasContent = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tDom.append(content, container);\n\n\t\t\t\t\tif (hasContent)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.popup.isShown())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.#prepareItemsContent(content);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.popup.subscribeOnce('onShow', () => {\n\t\t\t\t\t\t\t\tthis.#prepareItemsContent(content);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.popup.adjustPosition({ forceBindPosition: true, position: this.popup.isBottomAngle() ? 'top' : 'bottom' });\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.popup.getContentContainer().style.overflowX = null;\n\t\t}\n\n\t\treturn this.popup;\n\t}\n\n\t#prepareItemsContent(content: HTMLElement): void\n\t{\n\t\tDom.addClass(this.getContentWrapper(), 'ui-popup-with-header__content');\n\n\t\tif (this.popup.isBottomAngle() || !this.animationTemplate)\n\t\t{\n\t\t\tDom.style(this.getContentWrapper(), 'transition', 'none');\n\t\t}\n\n\t\tif (this.getContentWrapper().scrollHeight > 287 && !Dom.hasClass(this.getContentWrapper(), '--active-scroll'))\n\t\t{\n\t\t\tDom.style(this.getContentWrapper(), 'height', '287px');\n\t\t\tDom.style(this.getContentWrapper(), 'overflow-y', 'scroll');\n\t\t\tDom.addClass(content, 'active-scroll');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.getContentWrapper(), 'height', `${this.getContentWrapper().scrollHeight}px`);\n\t\t}\n\t}\n\n\tgetSkeleton(): HTMLElement\n\t{\n\t\tif (!this.skeleton)\n\t\t{\n\t\t\tthis.skeleton = (new Skeleton(this.skeletonHeight, this.skeletonWidth)).get();\n\n\t\t\tconst theme = this.#getThemePicker()?.getAppliedTheme();\n\t\t\tif (!theme)\n\t\t\t{\n\t\t\t\treturn this.skeleton;\n\t\t\t}\n\n\t\t\tconst headerContainer = this.skeleton.querySelector('.popup-with-header-skeleton__header');\n\t\t\tthis.#applyTheme(headerContainer, theme);\n\n\t\t\tEventEmitter.subscribe(\n\t\t\t\t'BX.Intranet.Bitrix24:ThemePicker:onThemeApply',\n\t\t\t\t(event) =>\n\t\t\t\t{\n\t\t\t\t\tthis.#applyTheme(headerContainer, event.data.theme);\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\treturn this.skeleton;\n\t}\n\n\tpreparePopupAngly(popupContainer: HTMLElement): void\n\t{\n\t\tconst angly = popupContainer?.parentNode?.querySelector('.popup-window-angly--arrow');\n\n\t\tif (Type.isDomNode(angly))\n\t\t{\n\t\t\tconst theme = this.#getThemePicker()?.getAppliedTheme();\n\t\t\tif (theme)\n\t\t\t{\n\t\t\t\tthis.#applyTheme(angly, theme);\n\n\t\t\t\tEventEmitter.subscribe(\n\t\t\t\t\t'BX.Intranet.Bitrix24:ThemePicker:onThemeApply',\n\t\t\t\t\t(event) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#applyTheme(angly, event.data.theme);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tDom.style(angly, 'background-position', 'center top');\n\t\t\tDom.addClass(popupContainer?.parentNode, '--with-header');\n\t\t}\n\t}\n\n\t#getThemePicker(): ?BX.Intranet.Bitrix24.ThemePicker\n\t{\n\t\treturn BX.Intranet?.Bitrix24?.ThemePicker.Singleton ?? top.BX.Intranet?.Bitrix24?.ThemePicker.Singleton;\n\t}\n\n\t#applyTheme(container, theme): void\n\t{\n\t\tconst previewImage = `url('${Text.encode(theme.previewImage)}')`;\n\t\tDom.style(container, 'backgroundImage', previewImage);\n\n\t\tif (theme.previewColor)\n\t\t{\n\t\t\tDom.style(container, 'backgroundColor', theme.previewColor);\n\t\t}\n\n\t\tDom.removeClass(container, 'bitrix24-dark-theme bitrix24-light-theme bitrix24-default-theme');\n\t\tlet themeClass = 'bitrix24-default-theme';\n\n\t\tif (theme.id !== 'default')\n\t\t{\n\t\t\tthemeClass = String(theme.id).indexOf('dark:') === 0 ? 'bitrix24-dark-theme' : 'bitrix24-light-theme';\n\t\t}\n\n\t\tDom.addClass(container, themeClass);\n\t}\n\n\tgetHeaderWrapper(): ?HTMLElement\n\t{\n\t\tif (!this.header)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (!this.headerWrapper)\n\t\t{\n\t\t\tthis.headerWrapper = Tag.render`\n\t\t\t\t<div class=\"ui-popupcomponentmaker__header-content\"></div>\n\t\t\t`;\n\n\t\t\tif (this.content.length <= 0)\n\t\t\t{\n\t\t\t\tthis.headerWrapper.classList.add('--empty-content');\n\t\t\t}\n\n\t\t\tconst sectionNode = this.getSection();\n\n\t\t\tif (this.header?.marginBottom)\n\t\t\t{\n\t\t\t\tType.isNumber(this.header.marginBottom)\n\t\t\t\t\t? sectionNode.style.marginBottom = `${this.header.marginBottom}px`\n\t\t\t\t\t: null;\n\t\t\t}\n\n\t\t\tif (this.header?.className)\n\t\t\t{\n\t\t\t\tDom.addClass(sectionNode, this.header.className);\n\t\t\t}\n\n\t\t\tif (Type.isDomNode(this.header?.html))\n\t\t\t{\n\t\t\t\tsectionNode.appendChild(this.getItem(this.header).getContainer());\n\t\t\t\tthis.headerWrapper.appendChild(sectionNode);\n\t\t\t}\n\n\t\t\tif (Type.isFunction(this.header?.html?.then))\n\t\t\t{\n\t\t\t\tthis.adjustPromise(this.header, sectionNode);\n\t\t\t\tthis.headerWrapper.appendChild(sectionNode);\n\t\t\t}\n\t\t}\n\n\t\treturn this.headerWrapper;\n\t}\n}\n","import type { ResultContent } from '../types/template';\n\nexport class BaseTemplate\n{\n\tgetContent(): Array<ResultContent>\n\t{\n\t\tthrow new Error('Must be implemented in a child class');\n\t}\n\n\tsetOptions(options): void\n\t{\n\t\tthis.options = options;\n\t}\n}","import { Cache, Dom, Tag, Type } from 'main.core';\nimport { AirButtonStyle, Button, ButtonColor, ButtonTag } from 'ui.buttons';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\nimport type {\n\tButtonConfig,\n\tMoreLinkConfig,\n\tSalePopupTemplateOptions,\n\tTextConfig,\n\tResultContent,\n\tSalePopupTemplateItemConfig,\n} from '../types/template';\nimport { BaseTemplate } from './base-template';\n\nexport class SaleTemplate extends BaseTemplate\n{\n\t#cache = new Cache.MemoryCache();\n\toptions: SalePopupTemplateOptions;\n\t#analyticsCallback: ?Function;\n\n\tconstructor(options: SalePopupTemplateOptions = {})\n\t{\n\t\tsuper();\n\t\tthis.options = options;\n\t\tthis.#analyticsCallback = Type.isFunction(options.analyticsCallback) ? options.analyticsCallback : null;\n\t}\n\n\tgetContent(): Array<ResultContent>\n\t{\n\t\treturn this.#cache.remember('popup-content', () => {\n\t\t\tconst content = [];\n\n\t\t\tthis.options.items.forEach((item, index) => {\n\t\t\t\tconst itemContent = this.#getItemContent(item);\n\n\t\t\t\tif (item.styles?.color)\n\t\t\t\t{\n\t\t\t\t\tDom.style(itemContent, 'color', item.styles.color);\n\t\t\t\t}\n\n\t\t\t\tcontent.push({\n\t\t\t\t\thtml: itemContent,\n\t\t\t\t\tbackground: item.styles?.background,\n\t\t\t\t\tmargin: index === 0 ? '12px 0 0 0' : null,\n\t\t\t\t\tborderColor: item.styles?.borderColor,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn content;\n\t\t});\n\t}\n\n\t#getItemContent(config: SalePopupTemplateItemConfig): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-popupconstructor-content-item-wrapper --noflex\">\n\t\t\t\t<div class=\"ui-popupconstructor-content-item-wrapper__header\">\n\t\t\t\t\t<div class=\"ui-popupconstructor-content-item-wrapper-title\">\n\t\t\t\t\t\t${config.icon ? this.#getIcon(config.icon) : null}\n\t\t\t\t\t\t${config.title ? this.#getTitle(config.title) : null}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-popupconstructor-content-item__header-button\">\n\t\t\t\t\t\t${config.button ? this.#getButton(config.button) : null}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t${config.description ? this.#getDescription(config.description) : null}\n\t\t\t\t\t${config.more ? this.#getMoreLink(config.more, config.button) : null}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getTitle(config: TextConfig): HTMLElement\n\t{\n\t\tconst title = Tag.render`\n\t\t\t<div class=\"ui-popupconstructor-content-item__title\">${config.text}</div>\n\t\t`;\n\n\t\tthis.#setTextStyles(title, config);\n\n\t\treturn title;\n\t}\n\n\t#getIcon(config: Object): HTMLElement\n\t{\n\t\tconst icon = Tag.render`\n\t\t\t<div class=\"ui-popupconstructor-content-item__icon ui-icon-set --${config.name}\"></div>\n\t\t`;\n\n\t\tif (config.color)\n\t\t{\n\t\t\tDom.style(icon, 'background-color', config.color);\n\t\t}\n\n\t\treturn icon;\n\t}\n\n\t#getDescription(config: TextConfig): HTMLElement\n\t{\n\t\tconst description = Tag.render`\n\t\t\t<div class=\"ui-popupconstructor-content-item__description\">\n\t\t\t\t${config.text}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#setTextStyles(description, config);\n\n\t\treturn description;\n\t}\n\n\t#getMoreLink(config: MoreLinkConfig, configMainButton: ButtonConfig): HTMLElement\n\t{\n\t\tconst onclick = () => {\n\t\t\tif (config.code)\n\t\t\t{\n\t\t\t\tFeaturePromotersRegistry.getPromoter({\n\t\t\t\t\tcode: config.code,\n\t\t\t\t}).show();\n\t\t\t}\n\t\t\telse if (config.articleId)\n\t\t\t{\n\t\t\t\ttop.BX.Helper.show(`redirect=detail&code=${config.articleId}`);\n\t\t\t}\n\n\t\t\tif (this.#analyticsCallback)\n\t\t\t{\n\t\t\t\tthis.#analyticsCallback('click-more', configMainButton.url);\n\t\t\t}\n\t\t};\n\n\t\tconst moreLink = Tag.render`\n\t\t\t<div class=\"ui-popupconstructor-content-item__more-link\" onclick=\"${onclick}\">${config.text.text}</div>\n\t\t`;\n\t\tthis.#setTextStyles(moreLink, config.text);\n\n\t\treturn moreLink;\n\t}\n\n\t#getButton(config: ButtonConfig): HTMLElement\n\t{\n\t\tconst buttonTag = config.target ? ButtonTag.BUTTON : ButtonTag.LINK;\n\n\t\tconst button = new Button({\n\t\t\ttext: config.text,\n\t\t\tsize: Button.Size.EXTRA_SMALL,\n\t\t\tuseAirDesign: true,\n\t\t\tstyle: config?.airStyle ?? AirButtonStyle.FILLED,\n\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\tnoCaps: true,\n\t\t\ttag: buttonTag,\n\t\t\tlink: config.target ? null : config.url,\n\t\t\twide: true,\n\t\t\tevents: {\n\t\t\t\tmousedown: () => {\n\t\t\t\t\tif (this.#analyticsCallback)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#analyticsCallback(config?.analyticsEvent ?? 'click-button', config.url);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\tonclick: () => {\n\t\t\t\tif (config.target)\n\t\t\t\t{\n\t\t\t\t\twindow.open(config.url, config.target);\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\n\t\tif (config.backgroundColor)\n\t\t{\n\t\t\tDom.style(button.render(), 'background-color', config.backgroundColor);\n\t\t\tbutton.setColor(Button.Color.LIGHT);\n\t\t}\n\n\t\treturn button.render();\n\t}\n\n\t#getButtonDescription(config: TextConfig): HTMLElement\n\t{\n\t\tconst buttonDescription = Tag.render`\n\t\t\t<div class=\"ui-popupconstructor-content-item__button-description\">\n\t\t\t\t${config.text}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#setTextStyles(buttonDescription, config);\n\n\t\treturn buttonDescription;\n\t}\n\n\t#setTextStyles(element: HTMLElement, config: TextConfig): void\n\t{\n\t\tif (config.color)\n\t\t{\n\t\t\tDom.style(element, 'color', config.color);\n\t\t}\n\n\t\tif (config.fontSize)\n\t\t{\n\t\t\tDom.style(element, 'font-size', config.fontSize);\n\t\t}\n\n\t\tif (config.weight)\n\t\t{\n\t\t\tDom.style(element, 'font-weight', config.weight);\n\t\t}\n\t}\n}\n"],"names":["RoundPlayer","constructor","options","PLAY_STATE_BACKGROUND","wrapper","width","Type","isNumber","scale","isArrayFilled","videos","isBoolean","loop","autoplay","muted","posterUrl","isFunction","analyticsCallback","Tag","render","poster","isStringFilled","style","backgroundImage","Text","encode","Loader","size","addEventListener","bind","hide","show","forEach","video","Dom","append","url","type","renderTo","play","removeClass","setMute","mute","getPlayState","pause","stop","currentTime","addClass","userPlay","PLAY_STATE_USER","setValue","remove","getContainer","event","ProgressRound","lineSize","maxValue","duration","value","colorBar","colorTrack","update","paused","x","transform","HeaderBuilder","buildPlayer","playerOptions","pausePlayerWidth","renderPlayer","getPlayer","renderTitle","titleOptions","title","isNil","subtitle","headTitle","accent","className","renderDescription","descriptionOptions","descriptionText","Headline","moreLink","code","onclick","e","stopPropagation","FeaturePromotersRegistry","getPromoter","moreLabel","descTitle","subtitleDescription","roundContent","isPlainObject","renderIcon","isDomNode","embedIcon","avatarUrl","renderAvatar","descriptionBlock","description","PopupComponentsMakerItem","html","withoutBackground","marginTop","classList","add","renderBtn","btnOptions","btn","Button","text","label","color","ButtonColor","LIGHT_BORDER","ButtonSize","SMALL","link","round","noCaps","iconClass","wrapperClass","icon","avatar","btnContent","button","HTMLElement","top","info","PopupHeader","backgroundColor","layout","container","theme","getAppliedTheme","getContent","bacgroundNode","EventEmitter","subscribe","data","createByJson","popupId","builder","header","target","uniquePopupId","BX","Intranet","Bitrix24","ThemePicker","Singleton","previewImage","previewColor","themeClass","id","String","indexOf","Skeleton","height","get","btnClass","PopupWithHeader","PopupComponentsMaker","template","BaseTemplate","asyncData","Promise","animationTemplate","skeletonHeight","skeletonWidth","popupOptions","getPopup","popup","popupWidth","content","getHeaderWrapper","length","padding","getContentWrapper","Popup","contentBackground","contentPadding","angle","useAngle","offset","offsetTop","offsetLeft","offsetWidth","autoHide","closeByEsc","animation","cacheable","getContentContainer","clean","getSkeleton","preparePopupAngly","parentNode","then","response","hasContent","items","setOptions","contentWrapper","hasClass","querySelector","isShown","subscribeOnce","adjustPosition","forceBindPosition","position","isBottomAngle","overflowX","skeleton","headerContainer","popupContainer","angly","headerWrapper","sectionNode","getSection","marginBottom","appendChild","getItem","adjustPromise","scrollHeight","Error","SaleTemplate","Cache","MemoryCache","remember","item","index","itemContent","styles","push","background","margin","borderColor","config","more","name","configMainButton","articleId","Helper","buttonTag","ButtonTag","BUTTON","LINK","Size","EXTRA_SMALL","useAirDesign","airStyle","AirButtonStyle","FILLED","PRIMARY","tag","wide","events","mousedown","analyticsEvent","window","open","setColor","Color","LIGHT","buttonDescription","element","fontSize","weight"],"mappings":"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"}