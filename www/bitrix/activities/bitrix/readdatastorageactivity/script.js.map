{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { Reflection, Type, Event, Dom, Loc } from 'main.core';\nimport {\n\tContext,\n\tConditionGroup,\n\tConditionGroupSelector,\n\tDocument,\n\tgetGlobalContext,\n\tsetGlobalContext,\n} from 'bizproc.automation';\n\nconst namespace = Reflection.namespace('BX.Bizproc.Activity');\n\ntype FieldType = {\n\tFieldName: string,\n\tType: string,\n\tMultiple: boolean,\n\tOptions: ?{},\n};\n\ntype StorageCodeData = {\n\telement: HTMLTextAreaElement,\n\tdependentElements: Array<HTMLElement>,\n\n\tisReturnFieldsRendered: boolean,\n\treturnFieldsProperty: FieldType,\n\treturnFieldsContainer: ?HTMLDivElement,\n};\n\nclass ReadDataStorageActivity\n{\n\tdocumentType: Array<string>;\n\tdocument: Document;\n\n\tstorageIdSelect: HTMLSelectElement;\n\n\t#storageCodeData: StorageCodeData = {\n\t\tdependentElements: [],\n\t\tisReturnFieldsRendered: true,\n\t};\n\n\tstorageIdDependentElements: NodeListOf<HTMLElement>;\n\n\treturnFieldsProperty: FieldType = {};\n\treturnFieldsMapContainer: HTMLDivElement;\n\treturnFieldsMap: Map<number, Map<string, object>>;\n\treturnFieldsIds: Array<string>;\n\n\tfilterFieldsContainer: HTMLDivElement | null;\n\tfilteringFieldsPrefix: string;\n\tfilterFieldsMap: Map<number, object>;\n\tconditionGroup: ConditionGroup | undefined;\n\n\tcurrentStorageId: number;\n\n\tconstructor(options)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.documentType = options.documentType;\n\t\t\tconst form = document.forms[options.formName];\n\n\t\t\tif (!Type.isNil(form))\n\t\t\t{\n\t\t\t\tthis.storageIdSelect = form.storage_id;\n\t\t\t\tthis.currentStorageId = Number(this.storageIdSelect?.value || 0);\n\t\t\t\tthis.storageIdDependentElements = form.querySelectorAll(\n\t\t\t\t\t'[data-role=\"bpa-sra-storage-id-dependent\"]',\n\t\t\t\t);\n\n\t\t\t\tthis.#storageCodeData.element = form.storage_code;\n\t\t\t\tthis.#storageCodeData.dependentElements.push(\n\t\t\t\t\t...form.querySelectorAll('[data-role=\"bpa-sra-storage-code-dependent\"]').values(),\n\t\t\t\t\tform.querySelector('[data-role=\"bpa-sra-filter-fields-container\"]').closest('tr'),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.document = new Document({\n\t\t\t\trawDocumentType: this.documentType,\n\t\t\t\tdocumentFields: options.documentFields,\n\t\t\t\ttitle: options.documentName,\n\t\t\t});\n\n\t\t\tthis.initAutomationContext();\n\t\t\tthis.initFilterFields(options);\n\t\t\tthis.initReturnFields(options);\n\n\t\t\tthis.render();\n\t\t}\n\t}\n\n\tinitFilterFields(options)\n\t{\n\t\tthis.conditionIdPrefix = 'id_bpa_sra_field_';\n\t\tthis.filterFieldsContainer = document.querySelector('[data-role=\"bpa-sra-filter-fields-container\"]');\n\t\tthis.filteringFieldsPrefix = options.filteringFieldsPrefix;\n\t\tthis.filterFieldsMap = new Map(\n\t\t\tObject.entries(options.filterFieldsMap)\n\t\t\t\t.map(([storageId, fieldsMap]) => [Number(storageId), fieldsMap]),\n\t\t);\n\n\t\tif (!Type.isNil(options.documentType))\n\t\t{\n\t\t\tBX.Bizproc.Automation.API.documentType = options.documentType;\n\t\t}\n\n\t\tthis.conditionGroup = new ConditionGroup(options.conditions);\n\t}\n\n\tinitReturnFields(options)\n\t{\n\t\tthis.returnFieldsProperty = options.returnFieldsProperty;\n\t\tthis.returnFieldsIds = Type.isArray(options.returnFieldsIds) ? options.returnFieldsIds : [];\n\n\t\tthis.returnFieldsMapContainer = document.querySelector('[data-role=\"bpa-sra-return-fields-container\"]');\n\t\tthis.returnFieldsMap = new Map();\n\t\tObject.entries(options.returnFieldsMap).forEach(([storageId, fieldsMap]) => {\n\t\t\tthis.returnFieldsMap.set(Number(storageId), new Map(Object.entries(fieldsMap)));\n\t\t});\n\n\t\tthis.#storageCodeData.returnFieldsProperty = options.returnFieldsByStorageCodeProperty;\n\t\tthis.#storageCodeData.returnFieldsContainer = document.querySelector('[data-role=\"bpa-sra-return-fields-by-storage-code-container\"]');\n\t}\n\n\tinitAutomationContext()\n\t{\n\t\ttry\n\t\t{\n\t\t\tgetGlobalContext();\n\t\t}\n\t\tcatch\n\t\t{\n\t\t\tsetGlobalContext(new Context({ document: this.document }));\n\t\t}\n\t}\n\n\tinit(): void\n\t{\n\t\tif (this.storageIdSelect)\n\t\t{\n\t\t\tEvent.bind(this.storageIdSelect, 'change', this.onStorageIdChange.bind(this));\n\t\t}\n\n\t\tif (this.#storageCodeData.element)\n\t\t{\n\t\t\tthis.renderFilterFields();\n\t\t\tEvent.bind(this.#storageCodeData.element, 'input', this.#onStorageCodeChange.bind(this));\n\t\t\tEvent.bind(this.#storageCodeData.element, 'focus', this.#onStorageCodeChange.bind(this));\n\t\t}\n\t}\n\n\tonStorageIdChange(): void\n\t{\n\t\tthis.currentStorageId = Number(this.storageIdSelect.value);\n\t\tif (this.currentStorageId > 0)\n\t\t{\n\t\t\tthis.#clearStorageCodeAndValue();\n\t\t}\n\n\t\tthis.conditionGroup = new ConditionGroup();\n\t\tthis.returnFieldsIds = [];\n\t\tthis.render();\n\t}\n\n\t#onStorageCodeChange(): void\n\t{\n\t\tif (this.currentStorageId <= 0 && this.#storageCodeData.returnFieldsContainer)\n\t\t{\n\t\t\tif (!Type.isStringFilled(this.#storageCodeData.element.value))\n\t\t\t{\n\t\t\t\tthis.#clearStorageCodeAndValue();\n\t\t\t}\n\n\t\t\tthis.render();\n\t\t}\n\t}\n\n\t#clearStorageCodeAndValue()\n\t{\n\t\tthis.#storageCodeData.dependentElements.forEach((element) => Dom.hide(element));\n\n\t\tthis.#storageCodeData.element.value = '';\n\t\tDom.clean(this.#storageCodeData.returnFieldsContainer);\n\t\tthis.#storageCodeData.isReturnFieldsRendered = false;\n\t\tthis.conditionGroup = new ConditionGroup();\n\t}\n\n\trender(): void\n\t{\n\t\tthis.#storageCodeData.dependentElements.forEach((element) => Dom.hide(element));\n\n\t\tif (Type.isNil(this.currentStorageId) || this.currentStorageId <= 0)\n\t\t{\n\t\t\tthis.storageIdDependentElements.forEach((element) => Dom.hide(element));\n\t\t\tthis.#renderStorageCodeFields();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.storageIdDependentElements.forEach((element) => Dom.show(element));\n\t\t\tthis.renderFilterFields();\n\t\t\tthis.renderReturnFields();\n\t\t}\n\t}\n\n\t#renderStorageCodeFields()\n\t{\n\t\tif (Type.isStringFilled(this.#storageCodeData.element.value))\n\t\t{\n\t\t\tthis.#storageCodeData.dependentElements.forEach((element) => Dom.show(element));\n\t\t\tif (!this.#storageCodeData.isReturnFieldsRendered)\n\t\t\t{\n\t\t\t\tthis.renderFilterFields();\n\n\t\t\t\tDom.clean(this.#storageCodeData.returnFieldsContainer);\n\t\t\t\tDom.append(\n\t\t\t\t\tBX.Bizproc.FieldType.renderControlDesigner(\n\t\t\t\t\t\tthis.documentType,\n\t\t\t\t\t\tthis.#storageCodeData.returnFieldsProperty,\n\t\t\t\t\t\tthis.#storageCodeData.returnFieldsProperty.FieldName,\n\t\t\t\t\t),\n\t\t\t\t\tthis.#storageCodeData.returnFieldsContainer,\n\t\t\t\t);\n\t\t\t\tthis.#storageCodeData.isReturnFieldsRendered = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tshowFieldSelector(targetInputId)\n\t{\n\t\tBPAShowSelector(targetInputId, 'string', '');\n\t}\n\n\trenderFilterFields(): void\n\t{\n\t\tif (!Type.isNil(this.conditionGroup))\n\t\t{\n\t\t\tconst selector = new ConditionGroupSelector(this.conditionGroup, {\n\t\t\t\tfields: Object.values(this.filterFieldsMap.get(this.currentStorageId) || {}),\n\t\t\t\tfieldPrefix: this.filteringFieldsPrefix,\n\t\t\t\tcustomSelector: Type.isFunction(BPAShowSelector) ? this.showFieldSelector : null,\n\t\t\t\tcaption: {\n\t\t\t\t\thead: Loc.getMessage('BIZPROC_SRA_FILTER_FIELDS_PROPERTY'),\n\t\t\t\t\tcollapsed: Loc.getMessage('BIZPROC_SRA_FILTER_FIELDS_COLLAPSED_TEXT'),\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tif (selector.modern && this.filterFieldsContainer && this.filterFieldsContainer.parentNode)\n\t\t\t{\n\t\t\t\tconst element = (\n\t\t\t\t\tthis.filterFieldsContainer.parentNode.firstElementChild === this.filterFieldsContainer\n\t\t\t\t\t\t? this.filterFieldsContainer.parentNode.parentNode.firstElementChild\n\t\t\t\t\t\t: this.filterFieldsContainer.parentNode.firstElementChild\n\t\t\t\t);\n\n\t\t\t\tDom.clean(element);\n\t\t\t}\n\n\t\t\tDom.clean(this.filterFieldsContainer);\n\t\t\tDom.append(selector.createNode(), this.filterFieldsContainer);\n\t\t}\n\t}\n\n\trenderReturnFields(): void\n\t{\n\t\tconst storageId = this.currentStorageId;\n\t\tconst fieldsMap = this.returnFieldsMap.get(storageId);\n\n\t\tif (!Type.isNil(fieldsMap))\n\t\t{\n\t\t\tconst fieldOptions = {};\n\t\t\tfieldsMap.forEach((field, fieldId) => {\n\t\t\t\tfieldOptions[fieldId] = field.Name;\n\t\t\t});\n\t\t\tthis.returnFieldsProperty.Options = fieldOptions;\n\n\t\t\tDom.clean(this.returnFieldsMapContainer);\n\t\t\tthis.returnFieldsMapContainer.appendChild(\n\t\t\t\tBX.Bizproc.FieldType.renderControl(\n\t\t\t\t\tthis.documentType,\n\t\t\t\t\tthis.returnFieldsProperty,\n\t\t\t\t\tthis.returnFieldsProperty.FieldName,\n\t\t\t\t\tthis.returnFieldsIds,\n\t\t\t\t\t'designer',\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t}\n}\n\nnamespace.ReadDataStorageActivity = ReadDataStorageActivity;\n"],"names":["namespace","Reflection","ReadDataStorageActivity","options","dependentElements","isReturnFieldsRendered","Type","isPlainObject","documentType","form","document","forms","formName","isNil","storageIdSelect","storage_id","currentStorageId","Number","value","storageIdDependentElements","querySelectorAll","element","storage_code","push","values","querySelector","closest","Document","rawDocumentType","documentFields","title","documentName","initAutomationContext","initFilterFields","initReturnFields","render","conditionIdPrefix","filterFieldsContainer","filteringFieldsPrefix","filterFieldsMap","Map","Object","entries","map","storageId","fieldsMap","BX","Bizproc","Automation","API","conditionGroup","ConditionGroup","conditions","returnFieldsProperty","returnFieldsIds","isArray","returnFieldsMapContainer","returnFieldsMap","forEach","set","returnFieldsByStorageCodeProperty","returnFieldsContainer","getGlobalContext","setGlobalContext","Context","Event","bind","onStorageIdChange","renderFilterFields","Dom","hide","show","renderReturnFields","targetInputId","BPAShowSelector","selector","ConditionGroupSelector","fields","get","fieldPrefix","customSelector","isFunction","showFieldSelector","caption","head","Loc","getMessage","collapsed","modern","parentNode","firstElementChild","clean","append","createNode","fieldOptions","field","fieldId","Name","Options","appendChild","FieldType","renderControl","FieldName","isStringFilled","renderControlDesigner"],"mappings":"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"}