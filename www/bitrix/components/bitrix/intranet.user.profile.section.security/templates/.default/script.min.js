this.BX=this.BX||{};(function(e,s,t,a,l,i,r,o,n,c,d){"use strict";var b=babelHelpers.classPrivateFieldLooseKey("id");var p=babelHelpers.classPrivateFieldLooseKey("title");var u=babelHelpers.classPrivateFieldLooseKey("width");var v=babelHelpers.classPrivateFieldLooseKey("cacheable");var P=babelHelpers.classPrivateFieldLooseKey("events");var h=babelHelpers.classPrivateFieldLooseKey("componentContent");var E=babelHelpers.classPrivateFieldLooseKey("buttons");var _=babelHelpers.classPrivateFieldLooseKey("extensions");var L=babelHelpers.classPrivateFieldLooseKey("prepareComponentResponse");class B{constructor(e){var s,t,a,l,i;Object.defineProperty(this,L,{value:S});Object.defineProperty(this,b,{writable:true,value:void 0});Object.defineProperty(this,p,{writable:true,value:void 0});Object.defineProperty(this,u,{writable:true,value:void 0});Object.defineProperty(this,v,{writable:true,value:void 0});Object.defineProperty(this,P,{writable:true,value:{}});Object.defineProperty(this,h,{writable:true,value:void 0});Object.defineProperty(this,E,{writable:true,value:[]});Object.defineProperty(this,_,{writable:true,value:[]});babelHelpers.classPrivateFieldLooseBase(this,b)[b]=e.id;babelHelpers.classPrivateFieldLooseBase(this,p)[p]=(s=e.title)!=null?s:"";babelHelpers.classPrivateFieldLooseBase(this,u)[u]=(t=e.width)!=null?t:1100;babelHelpers.classPrivateFieldLooseBase(this,v)[v]=e.cacheable!==false;babelHelpers.classPrivateFieldLooseBase(this,P)[P]=(a=e.events)!=null?a:{};babelHelpers.classPrivateFieldLooseBase(this,h)[h]=e.componentContent;babelHelpers.classPrivateFieldLooseBase(this,E)[E]=(l=e.buttons)!=null?l:[];babelHelpers.classPrivateFieldLooseBase(this,_)[_]=(i=e.extensions)!=null?i:[]}open(){a.SidePanel.Instance.open(babelHelpers.classPrivateFieldLooseBase(this,b)[b],{width:babelHelpers.classPrivateFieldLooseBase(this,u)[u],cacheable:babelHelpers.classPrivateFieldLooseBase(this,v)[v],contentCallback:()=>{var e;return s.Layout.createContent({title:(e=babelHelpers.classPrivateFieldLooseBase(this,p)[p])!=null?e:"",extensions:babelHelpers.classPrivateFieldLooseBase(this,_)[_],design:{section:false,margin:true},content:()=>babelHelpers.classPrivateFieldLooseBase(this,h)[h]().then(babelHelpers.classPrivateFieldLooseBase(this,L)[L]),buttons:()=>babelHelpers.classPrivateFieldLooseBase(this,E)[E]}).then((e=>{var s;return{html:(s=e==null?void 0:e.innerHTML)!=null?s:""}}))},events:babelHelpers.classPrivateFieldLooseBase(this,P)[P]})}}function S(e){var s,t,a,l;let i=e==null?void 0:(s=e.data)==null?void 0:s.html;((e==null?void 0:(t=e.data)==null?void 0:t.assets.css)||[]).forEach((e=>{i+=`<link rel="stylesheet" href="${e}">`}));((e==null?void 0:(a=e.data)==null?void 0:a.assets.js)||[]).forEach((e=>{i+=`<script src="${e}"><\/script>`}));((e==null?void 0:(l=e.data)==null?void 0:l.assets.string)||[]).forEach((e=>{i+=e}));return i}var R=babelHelpers.classPrivateFieldLooseKey("signedParameters");var y=babelHelpers.classPrivateFieldLooseKey("userId");var H=babelHelpers.classPrivateFieldLooseKey("isCloud");var O=babelHelpers.classPrivateFieldLooseKey("passwordNetworkUrl");var T=babelHelpers.classPrivateFieldLooseKey("signedUserId");var F=babelHelpers.classPrivateFieldLooseKey("setAnalyticsEventHandlers");class g{constructor(e){Object.defineProperty(this,F,{value:f});Object.defineProperty(this,R,{writable:true,value:void 0});Object.defineProperty(this,y,{writable:true,value:void 0});Object.defineProperty(this,H,{writable:true,value:void 0});Object.defineProperty(this,O,{writable:true,value:void 0});Object.defineProperty(this,T,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,R)[R]=e.signedParameters;babelHelpers.classPrivateFieldLooseBase(this,T)[T]=e.signedUserId;babelHelpers.classPrivateFieldLooseBase(this,y)[y]=e.userId;babelHelpers.classPrivateFieldLooseBase(this,H)[H]=e.isCloud===true;babelHelpers.classPrivateFieldLooseBase(this,O)[O]=c.Type.isStringFilled(e.passwordNetworkUrl)?e.passwordNetworkUrl:"";babelHelpers.classPrivateFieldLooseBase(this,F)[F](e)}open2FaSlider(){new B({id:"user_profile_2fa",title:c.Loc.getMessage("INTRANET_USER_SECURITY_PUSH_OTP_AUTH"),width:600,extensions:["intranet.push-otp.connect-popup"],componentContent:()=>BX.ajax.runComponentAction("bitrix:intranet.user.profile.security","otpList",{signedParameters:babelHelpers.classPrivateFieldLooseBase(this,R)[R],mode:"ajax",data:{userId:babelHelpers.classPrivateFieldLooseBase(this,y)[y]}}),events:{onClose:()=>{this.reload()}}}).open()}openOld2Fa(){BX.Intranet.UserProfile.Security.changeContent("otpList")}openChangePassword(){if(babelHelpers.classPrivateFieldLooseBase(this,H)[H]){if(c.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,O)[O])){window.open(babelHelpers.classPrivateFieldLooseBase(this,O)[O])}else{console.error("Password change URL is not defined.")}}else{this.openPasswordSlider()}}openPasswordSlider(){a.SidePanel.Instance.open(`/bitrix/components/bitrix/intranet.user.profile.password/index.php?userId=${c.Text.encode(babelHelpers.classPrivateFieldLooseBase(this,y)[y])}`,{cacheable:false,width:700})}openOldPassword(){BX.Intranet.UserProfile.Security.changeContent("changePassword")}reload(){BX.Intranet.UserProfile.Security.changeContent("otpConnected")}logoutAllRequest(){return BX.ajax.runAction("intranet.v2.Otp.logoutAll",{data:{signedUserId:babelHelpers.classPrivateFieldLooseBase(this,T)[T]}})}logoutAll(){var e;(e=this.logoutAllRequest())==null?void 0:e.then((e=>{BX.UI.Notification.Center.notify({content:c.Loc.getMessage("INTRANET_USER_SECURITY_EXIT_SUCCESS"),autoHide:true,position:"bottom-right",closeButton:false})}))}renderPhoneConfirmationCounter(e){const s=new t.Counter({color:t.Counter.Color.DANGER,size:t.Counter.Size.MEDIUM,value:1,style:t.CounterStyle.FILLED_ALERT,useAirDesign:true});s.renderTo(e)}}function f(e){if(e.emailElement){c.Event.bind(e.emailElement,"click",(()=>{o.sendData({tool:"user_settings",category:"security",event:"click",c_element:"email"})}))}if(e.phoneElement){c.Event.bind(e.phoneElement,"click",(()=>{o.sendData({tool:"user_settings",category:"security",event:"click",c_element:"phone"})}))}if(e.socservElement){c.Event.bind(e.socservElement,"click",(()=>{o.sendData({tool:"user_settings",category:"security",event:"click",c_element:"socserv"})}))}if(e.passwordElement){c.Event.bind(e.passwordElement,"click",(()=>{o.sendData({tool:"user_settings",category:"security",event:"click",c_element:"password"})}))}}var I=babelHelpers.classPrivateFieldLooseKey("getConnectPopup");var w=babelHelpers.classPrivateFieldLooseKey("sendAnalyticEvent");class U{static create(e){let s=null;if(e.canShowBannerPushOtp){if(!e.isOtpActive){const t=babelHelpers.classPrivateFieldLooseBase(this,I)[I](e);s=new l.PushOtp({title:e.title,text:e.text,clickEnableBtn:()=>{t.show();babelHelpers.classPrivateFieldLooseBase(this,w)[w]("banner_on")}})}else if(e.isNotPushOtp){let t=null;if(e.canDeactivate){t=s=>{const t=new r.Menu(s.button,{days:e.days,callback:s=>{i.pauseOtpRequest(s.numDays,e.signedUserId).then((()=>BX.Intranet.UserProfile.Security.changeContent("otpConnected"))).catch((e=>console.error(e)))}});t.show();babelHelpers.classPrivateFieldLooseBase(this,w)[w]("banner_off")}}const a=babelHelpers.classPrivateFieldLooseBase(this,I)[I](e);s=new l.PushOtp({title:e.title,text:e.text,clickEnableBtn:()=>{a.show();babelHelpers.classPrivateFieldLooseBase(this,w)[w]("banner_on")},clickDisableBtn:t})}}return s}}function C(e){const s=new i.EnablePushOtpProvider(e);return e.provideSmsOtp?s.full():s.onlyPushOtp()}function A(e){o.sendData({tool:"user_settings",category:"security",event:"click",c_element:e})}Object.defineProperty(U,w,{value:A});Object.defineProperty(U,I,{value:C});let N=e=>e,m,k,D;var j=babelHelpers.classPrivateFieldLooseKey("options");var x=babelHelpers.classPrivateFieldLooseKey("cache");var K=babelHelpers.classPrivateFieldLooseKey("getEmailRestoreButton");var M=babelHelpers.classPrivateFieldLooseKey("getPhoneRestoreButton");var X=babelHelpers.classPrivateFieldLooseKey("createSuccessContentByEmail");var Y=babelHelpers.classPrivateFieldLooseKey("createSuccessContentByPhone");var W=babelHelpers.classPrivateFieldLooseKey("createErrorContent");var $=babelHelpers.classPrivateFieldLooseKey("createPopup");class q{constructor(e){Object.defineProperty(this,$,{value:Z});Object.defineProperty(this,W,{value:V});Object.defineProperty(this,Y,{value:Q});Object.defineProperty(this,X,{value:J});Object.defineProperty(this,M,{value:G});Object.defineProperty(this,K,{value:z});Object.defineProperty(this,j,{writable:true,value:void 0});Object.defineProperty(this,x,{writable:true,value:new c.Cache.MemoryCache});babelHelpers.classPrivateFieldLooseBase(this,j)[j]=e}renderTo(e){if(babelHelpers.classPrivateFieldLooseBase(this,j)[j].useEmail){babelHelpers.classPrivateFieldLooseBase(this,K)[K]().renderTo(e)}if(babelHelpers.classPrivateFieldLooseBase(this,j)[j].usePhone){babelHelpers.classPrivateFieldLooseBase(this,M)[M]().renderTo(e)}}}function z(){return babelHelpers.classPrivateFieldLooseBase(this,x)[x].remember("emailRestoreButton",(()=>new n.Button({text:c.Loc.getMessage("INTRANET_USER_SECURITY_RESTORE_PASSWORD_BUTTON_EMAIL"),style:n.AirButtonStyle.OUTLINE,useAirDesign:true,onclick:e=>{e.setWaiting(true);c.ajax.runAction("bitrix24.v2.Password.restoreByEmail",{data:{userId:babelHelpers.classPrivateFieldLooseBase(this,j)[j].userId}}).then((()=>{e.setWaiting(false);babelHelpers.classPrivateFieldLooseBase(this,$)[$](babelHelpers.classPrivateFieldLooseBase(this,X)[X]()).show()})).catch((s=>{e.setWaiting(false);if(s.errors[0].message){babelHelpers.classPrivateFieldLooseBase(this,$)[$](babelHelpers.classPrivateFieldLooseBase(this,W)[W](s.errors[0].message)).show()}}))}})))}function G(){return babelHelpers.classPrivateFieldLooseBase(this,x)[x].remember("phoneRestoreButton",(()=>new n.Button({text:c.Loc.getMessage("INTRANET_USER_SECURITY_RESTORE_PASSWORD_BUTTON_PHONE"),style:n.AirButtonStyle.OUTLINE,useAirDesign:true,onclick:e=>{e.setWaiting(true);c.ajax.runAction("bitrix24.v2.Password.restoreByPhone",{data:{userId:babelHelpers.classPrivateFieldLooseBase(this,j)[j].userId}}).then((()=>{e.setWaiting(false);babelHelpers.classPrivateFieldLooseBase(this,$)[$](babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]()).show()})).catch((s=>{e.setWaiting(false);if(s.errors[0].message){babelHelpers.classPrivateFieldLooseBase(this,$)[$](babelHelpers.classPrivateFieldLooseBase(this,W)[W](s.errors[0].message)).show()}}))}})))}function J(){return c.Tag.render(m||(m=N`
			<div class="b24network-account-popup-inner">
				<div class="b24network-account-popup-title">
					${0}
				</div>
				<div class="b24network-account-popup-text">${0}</div>
				<div class="b24network-account-popup-text">${0}</div>
				<div class="b24network-account-popup-text">${0}</div>
			</div>
		`),c.Loc.getMessage("INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_TITLE_SUCCESS"),c.Loc.getMessage("INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_DESCRIPTION_BY_EMAIL_1"),c.Loc.getMessage("INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_DESCRIPTION_BY_EMAIL_2"),c.Loc.getMessage("INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_DESCRIPTION_BY_EMAIL_3"))}function Q(){return c.Tag.render(k||(k=N`
			<div class="b24network-account-popup-inner">
				<div class="b24network-account-popup-title">
					${0}
				</div>
				<div class="b24network-account-popup-text">${0}</div>
				<div class="b24network-account-popup-text">${0}</div>
				<div class="b24network-account-popup-text">${0}</div>
			</div>
		`),c.Loc.getMessage("INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_TITLE_SUCCESS"),c.Loc.getMessage("INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_DESCRIPTION_BY_PHONE_1"),c.Loc.getMessage("INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_DESCRIPTION_BY_PHONE_2"),c.Loc.getMessage("INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_DESCRIPTION_BY_PHONE_3"))}function V(e){return c.Tag.render(D||(D=N`
			<div class="b24network-account-popup-inner">
				<div class="b24network-account-popup-title">
					${0}
				</div>
				<div class="b24network-account-popup-text">${0}</div>
			</div>
		`),c.Loc.getMessage("INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_TITLE_ERROR"),c.Text.encode(e))}function Z(e){const s=new d.Popup({autoHide:true,className:"b24network-account-popup",closeByEsc:true,closeIcon:true,content:e,cacheable:false,width:450,buttons:[new n.CloseButton({onclick(){s.close()},useAirDesign:true})]});return s}e.SecuritySection=g;e.BannerFactory=U;e.RestoreNetworkPassword=q})(this.BX.Intranet=this.BX.Intranet||{},BX.UI.SidePanel,BX.UI,BX.SidePanel,BX.Intranet.NotifyBanner,BX.Intranet.PushOtp,BX.Intranet.PushOtp,BX.UI.Analytics,BX.UI,BX,BX.Main);
//# sourceMappingURL=script.map.js