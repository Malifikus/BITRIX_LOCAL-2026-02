{"version":3,"file":"textarea.bundle.js","sources":["../src/classes/resize-manager.js","../src/textarea.js"],"sourcesContent":["import { Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nconst EVENT_NAMESPACE = 'BX.Messenger.v2.Textarea.ResizeManager';\n\nexport class ResizeManager extends EventEmitter\n{\n\t#observer: ResizeObserver;\n\t#textareaHeight: number;\n\n\tstatic events = {\n\t\tonHeightChange: 'onHeightChange',\n\t};\n\n\tconstructor(): ResizeManager\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace(EVENT_NAMESPACE);\n\n\t\tthis.#initObserver();\n\t}\n\n\tobserveTextarea(element: HTMLElement)\n\t{\n\t\tthis.#observer.observe(element);\n\t\tthis.#textareaHeight = element.clientHeight;\n\t}\n\n\tunobserveTextarea(element: HTMLElement)\n\t{\n\t\tthis.#observer.unobserve(element);\n\t\tthis.#textareaHeight = 0;\n\t}\n\n\t#initObserver()\n\t{\n\t\tthis.#observer = new ResizeObserver(((entries: ResizeObserverEntry[]) => {\n\t\t\tentries.forEach((entry: ResizeObserverEntry) => {\n\t\t\t\tconst height = entry.borderBoxSize?.[0].blockSize;\n\t\t\t\tif (Type.isNumber(height) && height !== this.#textareaHeight)\n\t\t\t\t{\n\t\t\t\t\tthis.emit(ResizeManager.events.onHeightChange, { newHeight: height });\n\t\t\t\t\tthis.#textareaHeight = height;\n\t\t\t\t}\n\t\t\t});\n\t\t}));\n\t}\n}\n","import { Parser } from 'im.v2.lib.parser';\nimport { Quote } from 'im.v2.lib.quote';\nimport { Utils } from 'im.v2.lib.utils';\n\nexport { ResizeManager } from './classes/resize-manager';\n\ntype InsertTextConfig = {\n\ttext: string,\n\twithNewLine?: boolean,\n\treplace?: boolean\n};\n\ntype InsertMentionConfig = {\n\ttextToInsert: string,\n\ttextToReplace?: string\n};\n\nconst TAB = '\\t';\nconst NEW_LINE = '\\n';\nconst LETTER_CODE_PREFIX = 'Key';\n\n/* eslint-disable no-param-reassign */\nexport const Textarea = {\n\tprepareInlineQuote(textarea: HTMLTextAreaElement): string\n\t{\n\t\tconst selectedText = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n\t\tif (!selectedText)\n\t\t{\n\t\t\treturn textarea.value;\n\t\t}\n\n\t\tconst quoteText = Parser.prepareQuote({}, selectedText);\n\n\t\tconst textBefore = textarea.value.slice(0, textarea.selectionStart);\n\t\tconst textAfter = textarea.value.slice(textarea.selectionEnd);\n\n\t\treturn Quote.prepareInlineQuote(textBefore, textAfter, quoteText);\n\t},\n\taddTab(textarea: HTMLTextAreaElement): string\n\t{\n\t\tconst newSelectionPosition = textarea.selectionStart + 1;\n\n\t\tconst textBefore = textarea.value.slice(0, textarea.selectionStart);\n\t\tconst textAfter = textarea.value.slice(textarea.selectionEnd);\n\t\tconst textWithTab = `${textBefore}${TAB}${textAfter}`;\n\n\t\ttextarea.value = textWithTab;\n\t\ttextarea.selectionStart = newSelectionPosition;\n\t\ttextarea.selectionEnd = newSelectionPosition;\n\n\t\treturn textWithTab;\n\t},\n\tremoveTab(textarea: HTMLTextAreaElement): string\n\t{\n\t\tconst previousSymbol = textarea.value.slice(textarea.selectionStart - 1, textarea.selectionStart);\n\t\tif (previousSymbol !== TAB)\n\t\t{\n\t\t\treturn textarea.value;\n\t\t}\n\n\t\tconst newSelectionPosition = textarea.selectionStart - 1;\n\n\t\tconst textBefore = textarea.value.slice(0, textarea.selectionStart - 1);\n\t\tconst textAfter = textarea.value.slice(textarea.selectionEnd);\n\t\tconst textWithoutTab = `${textBefore}${textAfter}`;\n\n\t\ttextarea.value = textWithoutTab;\n\t\ttextarea.selectionStart = newSelectionPosition;\n\t\ttextarea.selectionEnd = newSelectionPosition;\n\n\t\treturn textWithoutTab;\n\t},\n\thandleDecorationTag(textarea: HTMLTextAreaElement, decorationKey: 'KeyB' | 'KeyI' | 'KeyU' | 'KeyS' | 'code'): string\n\t{\n\t\tdecorationKey = decorationKey.replace(LETTER_CODE_PREFIX, '').toLowerCase();\n\t\tconst LEFT_TAG = `[${decorationKey}]`;\n\t\tconst RIGHT_TAG = `[/${decorationKey}]`;\n\n\t\tconst selectedText = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n\t\tif (!selectedText)\n\t\t{\n\t\t\treturn textarea.value;\n\t\t}\n\n\t\tconst hasDecorationTag = (\n\t\t\tselectedText.toLowerCase().startsWith(LEFT_TAG)\n\t\t\t&& selectedText.toLowerCase().endsWith(RIGHT_TAG)\n\t\t);\n\t\tif (hasDecorationTag)\n\t\t{\n\t\t\treturn this.removeDecorationTag(textarea, decorationKey);\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn this.addDecorationTag(textarea, decorationKey);\n\t\t}\n\t},\n\taddDecorationTag(textarea: HTMLTextAreaElement, decorationKey: 'b' | 'i' | 'u' | 's' | 'code'): string\n\t{\n\t\tconst LEFT_TAG = `[${decorationKey}]`;\n\t\tconst RIGHT_TAG = `[/${decorationKey}]`;\n\n\t\treturn this.applyWrapping(textarea, LEFT_TAG, RIGHT_TAG);\n\t},\n\tremoveDecorationTag(textarea: HTMLTextAreaElement, decorationKey: 'b' | 'i' | 'u' | 's' | 'code'): string\n\t{\n\t\tconst LEFT_TAG = `[${decorationKey}]`;\n\t\tconst RIGHT_TAG = `[/${decorationKey}]`;\n\n\t\tconst decorationTagLength = LEFT_TAG.length + RIGHT_TAG.length;\n\t\tconst newSelectionStart = textarea.selectionStart;\n\t\tconst newSelectionEnd = textarea.selectionEnd - decorationTagLength;\n\n\t\tconst textBefore = textarea.value.slice(0, textarea.selectionStart);\n\n\t\tconst textInTagStart = textarea.selectionStart + LEFT_TAG.length;\n\t\tconst textInTagEnd = textarea.selectionEnd - RIGHT_TAG.length;\n\t\tconst textInTag = textarea.value.slice(textInTagStart, textInTagEnd);\n\n\t\tconst textAfter = textarea.value.slice(textarea.selectionEnd);\n\t\tconst textWithoutTag = `${textBefore}${textInTag}${textAfter}`;\n\n\t\ttextarea.value = textWithoutTag;\n\t\ttextarea.selectionStart = newSelectionStart;\n\t\ttextarea.selectionEnd = newSelectionEnd;\n\n\t\treturn textWithoutTag;\n\t},\n\taddNewLine(textarea: HTMLTextAreaElement): string\n\t{\n\t\tconst newSelectionPosition = textarea.selectionStart + 1;\n\n\t\tconst textBefore = textarea.value.slice(0, textarea.selectionStart);\n\t\tconst textAfter = textarea.value.slice(textarea.selectionEnd);\n\t\tconst textWithNewLine = `${textBefore}${NEW_LINE}${textAfter}`;\n\n\t\ttextarea.value = textWithNewLine;\n\t\ttextarea.selectionStart = newSelectionPosition;\n\t\ttextarea.selectionEnd = newSelectionPosition;\n\n\t\treturn textWithNewLine;\n\t},\n\tinsertText(textarea: HTMLTextAreaElement, config: InsertTextConfig = {}): string\n\t{\n\t\tconst { text, withNewLine = false, replace = false } = config;\n\t\tconst newSelectionPosition: number = textarea.selectionStart + text.length + 1;\n\t\tlet resultText = '';\n\n\t\tif (replace)\n\t\t{\n\t\t\tresultText = '';\n\t\t\ttextarea.value = '';\n\t\t\ttextarea.selectionStart = 0;\n\t\t\ttextarea.selectionEnd = 0;\n\t\t}\n\n\t\tif (textarea.value.length === 0)\n\t\t{\n\t\t\tresultText = text;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst textBefore = textarea.value.slice(0, textarea.selectionStart);\n\t\t\tconst textAfter = textarea.value.slice(textarea.selectionEnd);\n\t\t\tresultText = withNewLine ? `${textarea.value}${NEW_LINE}${text}` : `${textBefore} ${text} ${textAfter}`;\n\t\t}\n\n\t\ttextarea.focus({ preventScroll: true });\n\t\ttextarea.value = resultText;\n\t\ttextarea.selectionStart = newSelectionPosition;\n\t\ttextarea.selectionEnd = newSelectionPosition;\n\n\t\treturn resultText;\n\t},\n\tinsertMention(textarea: HTMLTextAreaElement, config: InsertMentionConfig = {}): string\n\t{\n\t\tconst { textToInsert, textToReplace = '' } = config;\n\t\tconst isMentionWithSymbol = textToReplace.length > 0;\n\t\tlet resultText = '';\n\t\tlet newSelectionPosition = textarea.selectionStart + textToInsert.length + 1;\n\n\t\tif (isMentionWithSymbol)\n\t\t{\n\t\t\tnewSelectionPosition -= textToReplace.length;\n\t\t\tconst textBefore = textarea.value.slice(0, textarea.selectionStart - textToReplace.length);\n\t\t\tconst textAfter = textarea.value.slice(textarea.selectionStart);\n\t\t\tresultText = `${textBefore}${textToInsert} ${textAfter}`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst textBefore = textarea.value.slice(0, textarea.selectionStart);\n\t\t\tconst textAfter = textarea.value.slice(textarea.selectionEnd);\n\n\t\t\tresultText = `${textBefore}${textToInsert} ${textAfter}`;\n\t\t}\n\n\t\ttextarea.focus({ preventScroll: true });\n\t\ttextarea.value = resultText;\n\t\ttextarea.selectionStart = newSelectionPosition;\n\t\ttextarea.selectionEnd = newSelectionPosition;\n\n\t\treturn resultText;\n\t},\n\taddUrlTag(textarea: HTMLTextAreaElement, linkUrl: string): string\n\t{\n\t\tif (!this.shouldHandleUrl(textarea, linkUrl))\n\t\t{\n\t\t\treturn textarea.value;\n\t\t}\n\n\t\treturn this.applyUrlWrapping(textarea, linkUrl);\n\t},\n\thandlePasteUrl(textarea: HTMLTextAreaElement, event: ClipboardEvent): string\n\t{\n\t\tconst pastedLinkUrl = event.clipboardData?.getData('text/plain');\n\n\t\tif (!this.shouldHandleUrl(textarea, pastedLinkUrl))\n\t\t{\n\t\t\treturn textarea.value;\n\t\t}\n\n\t\tevent.preventDefault();\n\n\t\treturn this.applyUrlWrapping(textarea, pastedLinkUrl);\n\t},\n\tshouldHandleUrl(textarea: HTMLTextAreaElement, linkUrl: string): boolean\n\t{\n\t\tconst selectedText = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n\t\tconst isUrl = Utils.text.checkUrl(linkUrl);\n\n\t\treturn isUrl && selectedText;\n\t},\n\tapplyUrlWrapping(textarea: HTMLTextAreaElement, linkUrl: string): string\n\t{\n\t\tconst LEFT_TAG = `[URL=${linkUrl}]`;\n\t\tconst RIGHT_TAG = '[/URL]';\n\n\t\treturn this.applyWrapping(textarea, LEFT_TAG, RIGHT_TAG);\n\t},\n\tapplyWrapping(textarea: HTMLTextAreaElement, leftTag: string, rightTag: string): string\n\t{\n\t\tconst selectedText = textarea.value.slice(textarea.selectionStart, textarea.selectionEnd);\n\t\tconst decorationTagLength = leftTag.length + rightTag.length;\n\t\tconst newSelectionStart = textarea.selectionStart;\n\t\tconst newSelectionEnd = textarea.selectionEnd + decorationTagLength;\n\n\t\tconst textBefore = textarea.value.slice(0, textarea.selectionStart);\n\t\tconst textAfter = textarea.value.slice(textarea.selectionEnd);\n\t\tconst textWithTag = `${textBefore}${leftTag}${selectedText}${rightTag}${textAfter}`;\n\n\t\ttextarea.value = textWithTag;\n\t\ttextarea.selectionStart = newSelectionStart;\n\t\ttextarea.selectionEnd = newSelectionEnd;\n\n\t\treturn textWithTag;\n\t},\n};\n"],"names":["EVENT_NAMESPACE","ResizeManager","EventEmitter","constructor","setEventNamespace","observeTextarea","element","observe","clientHeight","unobserveTextarea","unobserve","ResizeObserver","entries","forEach","entry","height","borderBoxSize","blockSize","Type","isNumber","emit","events","onHeightChange","newHeight","TAB","NEW_LINE","LETTER_CODE_PREFIX","Textarea","prepareInlineQuote","textarea","selectedText","value","slice","selectionStart","selectionEnd","quoteText","Parser","prepareQuote","textBefore","textAfter","Quote","addTab","newSelectionPosition","textWithTab","removeTab","previousSymbol","textWithoutTab","handleDecorationTag","decorationKey","replace","toLowerCase","LEFT_TAG","RIGHT_TAG","hasDecorationTag","startsWith","endsWith","removeDecorationTag","addDecorationTag","applyWrapping","decorationTagLength","length","newSelectionStart","newSelectionEnd","textInTagStart","textInTagEnd","textInTag","textWithoutTag","addNewLine","textWithNewLine","insertText","config","text","withNewLine","resultText","focus","preventScroll","insertMention","textToInsert","textToReplace","isMentionWithSymbol","addUrlTag","linkUrl","shouldHandleUrl","applyUrlWrapping","handlePasteUrl","event","pastedLinkUrl","clipboardData","getData","preventDefault","isUrl","Utils","checkUrl","leftTag","rightTag","textWithTag"],"mappings":"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"}