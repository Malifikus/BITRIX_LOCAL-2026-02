this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};(function(t,e,s,i,o,n,l,a,r,m,c,d,b,p,h,u,y,g,v,f,I,T,P,_,S,M,x,E,k,A,w,C,L,F,B,R,H,O,D,U,N,$,j,X,z,q,K,G,V,W,Q,Y,Z,J,tt,et,st,it,ot,nt,lt,at,rt,mt,ct){"use strict";const dt=new Set(["@","+"]);const bt=10;const pt=10;const ht=Object.freeze({showMentionPopup:"showMentionPopup",hideMentionPopup:"hideMentionPopup",insertMention:"insertMention"});var ut=babelHelpers.classPrivateFieldLooseKey("mentionPopupOpened");var yt=babelHelpers.classPrivateFieldLooseKey("mentionSymbol");var gt=babelHelpers.classPrivateFieldLooseKey("textarea");var vt=babelHelpers.classPrivateFieldLooseKey("emitter");var ft=babelHelpers.classPrivateFieldLooseKey("mentionReplacementMap");var It=babelHelpers.classPrivateFieldLooseKey("onClosedMentionKeyDown");var Tt=babelHelpers.classPrivateFieldLooseKey("onOpenedMentionKeyDown");var Pt=babelHelpers.classPrivateFieldLooseKey("checkMentionSymbol");var _t=babelHelpers.classPrivateFieldLooseKey("isValidQuery");var St=babelHelpers.classPrivateFieldLooseKey("isInsertMentionCombination");var Mt=babelHelpers.classPrivateFieldLooseKey("isOpenMentionCombination");var xt=babelHelpers.classPrivateFieldLooseKey("sendHidePopupEvent");var Et=babelHelpers.classPrivateFieldLooseKey("sendInsertMentionEvent");var kt=babelHelpers.classPrivateFieldLooseKey("getTextBeforeCursor");var At=babelHelpers.classPrivateFieldLooseKey("getMentionSymbolIndex");var wt=babelHelpers.classPrivateFieldLooseKey("getQuery");var Ct=babelHelpers.classPrivateFieldLooseKey("getQueryWithoutMentionSymbol");var Lt=babelHelpers.classPrivateFieldLooseKey("isNavigateCombination");var Ft=babelHelpers.classPrivateFieldLooseKey("isValidFirstSymbol");var Bt=babelHelpers.classPrivateFieldLooseKey("hasWhitespace");var Rt=babelHelpers.classPrivateFieldLooseKey("hasNumber");var Ht=babelHelpers.classPrivateFieldLooseKey("hasSpecialSymbol");class Ot extends g.EventEmitter{constructor(t){super();Object.defineProperty(this,Ht,{value:te});Object.defineProperty(this,Rt,{value:Jt});Object.defineProperty(this,Bt,{value:Zt});Object.defineProperty(this,Ft,{value:Yt});Object.defineProperty(this,Lt,{value:Qt});Object.defineProperty(this,Ct,{value:Wt});Object.defineProperty(this,wt,{value:Vt});Object.defineProperty(this,At,{value:Gt});Object.defineProperty(this,kt,{value:Kt});Object.defineProperty(this,Et,{value:qt});Object.defineProperty(this,xt,{value:zt});Object.defineProperty(this,Mt,{value:Xt});Object.defineProperty(this,St,{value:jt});Object.defineProperty(this,_t,{value:$t});Object.defineProperty(this,Pt,{value:Nt});Object.defineProperty(this,Tt,{value:Ut});Object.defineProperty(this,It,{value:Dt});Object.defineProperty(this,ut,{writable:true,value:false});Object.defineProperty(this,yt,{writable:true,value:""});Object.defineProperty(this,gt,{writable:true,value:void 0});Object.defineProperty(this,vt,{writable:true,value:void 0});Object.defineProperty(this,ft,{writable:true,value:{}});this.setEventNamespace(Ot.eventNamespace);const{textareaElement:e,context:{emitter:s}}=t;babelHelpers.classPrivateFieldLooseBase(this,gt)[gt]=e;babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]=s}onActiveMentionKeyDown(t){if(!babelHelpers.classPrivateFieldLooseBase(this,ut)[ut]){return}babelHelpers.classPrivateFieldLooseBase(this,Tt)[Tt](t)}onKeyDown(t){babelHelpers.classPrivateFieldLooseBase(this,It)[It](t)}onMentionPopupClose(){babelHelpers.classPrivateFieldLooseBase(this,ut)[ut]=false}setMentionReplacements(t){babelHelpers.classPrivateFieldLooseBase(this,ft)[ft]=t}addMentionReplacement(t,e){babelHelpers.classPrivateFieldLooseBase(this,ft)[ft][t]=e;return babelHelpers.classPrivateFieldLooseBase(this,ft)[ft]}getMentionSymbol(){return babelHelpers.classPrivateFieldLooseBase(this,yt)[yt]}replaceMentions(t){let e=t;Object.entries(babelHelpers.classPrivateFieldLooseBase(this,ft)[ft]).forEach((([t,s])=>{e=e.replaceAll(t,s)}));return e}extractMentions(t){const e="chat";const s={};const i=/\[(?<type>user|chat)=(?<dialogId>\w+)](?<mentionText>.*?)\[\/(user|chat)]/gi;const o=t.matchAll(i);for(const t of o){const{mentionText:i}=t.groups;let{type:o,dialogId:n}=t.groups;o=o.toLowerCase();if(o===e){n=`${o}${n}`}s[i]=ct.Utils.text.getMentionBbCode(n,i)}return s}clearMentionSymbol(){babelHelpers.classPrivateFieldLooseBase(this,yt)[yt]=""}clearMentionReplacements(){babelHelpers.classPrivateFieldLooseBase(this,ft)[ft]={}}}function Dt(t){if(!babelHelpers.classPrivateFieldLooseBase(this,Mt)[Mt](t)){return}setTimeout((()=>{if(!babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt]()){return}babelHelpers.classPrivateFieldLooseBase(this,ut)[ut]=true;this.emit(ht.showMentionPopup,{mentionQuery:""})}),bt)}function Ut(t){if(babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt](t)){t.preventDefault();return}if(babelHelpers.classPrivateFieldLooseBase(this,St)[St](t)){t.preventDefault();babelHelpers.classPrivateFieldLooseBase(this,Et)[Et](t);return}setTimeout((()=>{if(!babelHelpers.classPrivateFieldLooseBase(this,_t)[_t]()){babelHelpers.classPrivateFieldLooseBase(this,xt)[xt]();return}this.emit(ht.showMentionPopup,{mentionQuery:babelHelpers.classPrivateFieldLooseBase(this,Ct)[Ct]()})}),pt)}function Nt(){const t=babelHelpers.classPrivateFieldLooseBase(this,gt)[gt].selectionEnd;babelHelpers.classPrivateFieldLooseBase(this,yt)[yt]=babelHelpers.classPrivateFieldLooseBase(this,gt)[gt].value.slice(t-1,t);if(!dt.has(babelHelpers.classPrivateFieldLooseBase(this,yt)[yt])){return false}const e=babelHelpers.classPrivateFieldLooseBase(this,gt)[gt].value.slice(t-2,t-1);return e.length===0||babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt](e)}function $t(){const t=babelHelpers.classPrivateFieldLooseBase(this,wt)[wt]();if(t.length===0){return false}const e=babelHelpers.classPrivateFieldLooseBase(this,Ct)[Ct]().slice(0,1);if(e.length===0){return true}if(!babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft](e)){return false}return!babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt](e)}function jt(t){return t.key==="Enter"}function Xt(t){return t.key==="+"||t.key==="@"}function zt(){babelHelpers.classPrivateFieldLooseBase(this,ut)[ut]=false;babelHelpers.classPrivateFieldLooseBase(this,yt)[yt]="";this.emit(ht.hideMentionPopup)}function qt(t){t.preventDefault();babelHelpers.classPrivateFieldLooseBase(this,vt)[vt].emit(st.EventType.mention.selectItem);babelHelpers.classPrivateFieldLooseBase(this,xt)[xt]()}function Kt(){return babelHelpers.classPrivateFieldLooseBase(this,gt)[gt].value.slice(0,Math.max(0,babelHelpers.classPrivateFieldLooseBase(this,gt)[gt].selectionEnd))}function Gt(){const t=babelHelpers.classPrivateFieldLooseBase(this,kt)[kt]();return t.lastIndexOf(babelHelpers.classPrivateFieldLooseBase(this,yt)[yt])}function Vt(){const t=babelHelpers.classPrivateFieldLooseBase(this,kt)[kt]();const e=babelHelpers.classPrivateFieldLooseBase(this,At)[At]();if(e<0){return""}return t.slice(e,babelHelpers.classPrivateFieldLooseBase(this,gt)[gt].selectionEnd)}function Wt(){return babelHelpers.classPrivateFieldLooseBase(this,wt)[wt]().slice(1)}function Qt(t){return t.key==="ArrowUp"||t.key==="ArrowDown"}function Yt(t){return!(babelHelpers.classPrivateFieldLooseBase(this,Rt)[Rt](t)||babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt](t)||babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht](t))}function Zt(t){return/^\s/.test(t)}function Jt(t){return/\d$/.test(t)}function te(t){const e=/[!"#$%&'()*+,./<>@\\^_|-]/;return e.test(t)}Ot.eventNamespace="BX.Messenger.v2.Textarea.MentionManager";const ee=15e3;const se=5e3;var ie=babelHelpers.classPrivateFieldLooseKey("dialogId");var oe=babelHelpers.classPrivateFieldLooseKey("statusTimerMap");var ne=babelHelpers.classPrivateFieldLooseKey("requestDelayMap");var le=babelHelpers.classPrivateFieldLooseKey("isActive");var ae=babelHelpers.classPrivateFieldLooseKey("sendRequest");var re=babelHelpers.classPrivateFieldLooseKey("isSelfChat");class me{constructor(t){Object.defineProperty(this,re,{value:be});Object.defineProperty(this,ae,{value:de});Object.defineProperty(this,le,{value:ce});Object.defineProperty(this,ie,{writable:true,value:void 0});Object.defineProperty(this,oe,{writable:true,value:{}});Object.defineProperty(this,ne,{writable:true,value:{}});babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]=t}startAction(t){if(babelHelpers.classPrivateFieldLooseBase(this,le)[le](t)||babelHelpers.classPrivateFieldLooseBase(this,re)[re]()){return}babelHelpers.classPrivateFieldLooseBase(this,oe)[oe][t]=setTimeout((()=>{delete babelHelpers.classPrivateFieldLooseBase(this,oe)[oe][t]}),ee);babelHelpers.classPrivateFieldLooseBase(this,ne)[ne][t]=setTimeout((()=>{babelHelpers.classPrivateFieldLooseBase(this,ae)[ae](t)}),se)}stopAction(t){clearTimeout(babelHelpers.classPrivateFieldLooseBase(this,oe)[oe][t]);delete babelHelpers.classPrivateFieldLooseBase(this,oe)[oe][t];clearTimeout(babelHelpers.classPrivateFieldLooseBase(this,ne)[ne][t]);delete babelHelpers.classPrivateFieldLooseBase(this,ne)[ne][t]}}function ce(t){return Boolean(babelHelpers.classPrivateFieldLooseBase(this,oe)[oe][t])}function de(t){const e={dialogId:babelHelpers.classPrivateFieldLooseBase(this,ie)[ie],type:t};X.runAction(st.RestMethod.imV2ChatInputActionNotify,{data:e}).catch((([t])=>{console.error("InputSenderService: sendRequest error",t)}))}function be(){return Number(babelHelpers.classPrivateFieldLooseBase(this,ie)[ie])===V.Core.getUserId()}const pe={up:"up",down:"down"};var he=babelHelpers.classPrivateFieldLooseKey("calculateNewMaxPoint");class ue extends g.EventEmitter{constructor(t={}){super();Object.defineProperty(this,he,{value:ye});this.isDragging=false;const{direction:e,maxHeight:s,minHeight:i}=t;this.direction=e;this.maxHeight=s;this.minHeight=i;this.setEventNamespace(ue.eventNamespace)}onResizeStart(t,e){if(this.isDragging){return}this.isDragging=true;this.resizeCursorStartPoint=t.clientY;this.resizeHeightStartPoint=e;this.addResizeEvents()}onResizeContinue(t){if(!this.isDragging){return}this.resizeCursorControlPoint=t.clientY;const e=babelHelpers.classPrivateFieldLooseBase(this,he)[he]();const s=Math.max(e,this.minHeight);this.emit(ue.events.onHeightChange,{newHeight:s})}onResizeStop(){if(!this.isDragging){return}this.isDragging=false;this.removeResizeEvents();this.emit(ue.events.onResizeStop)}addResizeEvents(){this.onContinueDragHandler=this.onResizeContinue.bind(this);this.onStopDragHandler=this.onResizeStop.bind(this);document.addEventListener("mousemove",this.onContinueDragHandler);document.addEventListener("touchmove",this.onContinueDragHandler);document.addEventListener("touchend",this.onStopDragHandler);document.addEventListener("mouseup",this.onStopDragHandler);document.addEventListener("mouseleave",this.onStopDragHandler)}removeResizeEvents(){document.removeEventListener("mousemove",this.onContinueDragHandler);document.removeEventListener("touchmove",this.onContinueDragHandler);document.removeEventListener("touchend",this.onStopDragHandler);document.removeEventListener("mouseup",this.onStopDragHandler);document.removeEventListener("mouseleave",this.onStopDragHandler)}destroy(){this.removeResizeEvents()}}function ye(){const t=this.direction===pe.up?this.resizeCursorStartPoint-this.resizeCursorControlPoint:this.resizeCursorControlPoint-this.resizeCursorStartPoint;return Math.min(this.resizeHeightStartPoint+t,this.maxHeight)}ue.eventNamespace="BX.Messenger.v2.Textarea.ResizeManager";ue.events={onHeightChange:"onHeightChange",onResizeStop:"onResizeStop"};const ge="BX.Messenger.v2.Textarea.FormatToolbarManager";const ve=0;var fe=babelHelpers.classPrivateFieldLooseKey("timer");var Ie=babelHelpers.classPrivateFieldLooseKey("clearTimer");var Te=babelHelpers.classPrivateFieldLooseKey("hasValidSelection");class Pe extends g.EventEmitter{constructor(){super();Object.defineProperty(this,Te,{value:Se});Object.defineProperty(this,Ie,{value:_e});Object.defineProperty(this,fe,{writable:true,value:null});this.setEventNamespace(ge)}handleTextSelect(t,e){babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie]();const s={left:t.clientX,top:t.clientY};requestAnimationFrame((()=>{if(!babelHelpers.classPrivateFieldLooseBase(this,Te)[Te](e)){this.emit(Pe.events.hide);return}babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]=setTimeout((()=>{if(!babelHelpers.classPrivateFieldLooseBase(this,Te)[Te](e)){return}this.emit(Pe.events.show,{bindPosition:s})}),ve)}))}hide(){babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie]();this.emit(Pe.events.hide)}destroy(){babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie]()}}function _e(){if(babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]){clearTimeout(babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]);babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]=null}}function Se(t){if(!t){return false}return t.selectionStart!==t.selectionEnd}Pe.events={show:"show",hide:"hide"};const Me={audioend:"audioend",audiostart:"audiostart",end:"end",error:"error",nomatch:"nomatch",result:"result",soundend:"soundend",soundstart:"soundstart",speechend:"speechend",speechstart:"speechstart",start:"start"};const xe="BX.Messenger.v2.CopilotAudioManager";var Ee=babelHelpers.classPrivateFieldLooseKey("bindEvents");var ke=babelHelpers.classPrivateFieldLooseKey("getRecognizedText");var Ae=babelHelpers.classPrivateFieldLooseKey("getNewText");var we=babelHelpers.classPrivateFieldLooseKey("initSettings");class Ce extends g.EventEmitter{static isAvailable(){if(r.DesktopApi.isDesktop()){return r.DesktopApi.getApiVersion()>74}return Boolean(window.SpeechRecognition||window.webkitSpeechRecognition)}constructor(){super();Object.defineProperty(this,we,{value:Re});Object.defineProperty(this,Ae,{value:Be});Object.defineProperty(this,ke,{value:Fe});Object.defineProperty(this,Ee,{value:Le});this.recognizer=null;this.setEventNamespace(xe);this.recognizer=new(window.SpeechRecognition||window.webkitSpeechRecognition);babelHelpers.classPrivateFieldLooseBase(this,we)[we]();babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee]()}startRecognition(){this.recognizer.start()}stopRecognition(){this.recognizer.stop()}}function Le(){it.Event.bind(this.recognizer,Me.start,(()=>{this.lastRecognizedText="";this.emit(Ce.events.recognitionStart)}));it.Event.bind(this.recognizer,Me.error,(t=>{this.emit(Ce.events.recognitionError,t.error);console.error("Copilot: AudioManager: error",t.error)}));it.Event.bind(this.recognizer,Me.end,(()=>{this.lastRecognizedText="";this.emit(Ce.events.recognitionEnd)}));it.Event.bind(this.recognizer,Me.result,(t=>{const e=babelHelpers.classPrivateFieldLooseBase(this,ke)[ke](t);const s=babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae](e);if(s!==""){this.emit(Ce.events.recognitionResult,s)}this.lastRecognizedText=e}))}function Fe(t){let e="";Object.values(t.results).forEach((t=>{if(t.isFinal){return}const[s]=t;const{transcript:i}=s;e+=i}));return e}function Be(t){let e="";const s=this.lastRecognizedText.length;if(t.length>s){e=t.slice(s)}return e}function Re(){this.recognizer.continuous=true;this.recognizer.interimResults=true}Ce.events={recognitionStart:"recognitionStart",recognitionError:"recognitionError",recognitionEnd:"recognitionEnd",recognitionResult:"recognitionResult"};const He={name:"AudioInput",props:{dialogId:{type:String,required:true}},emits:["inputStart","inputResult"],data(){return{audioMode:false,audioUsed:false}},watch:{audioMode(t,e){if(e===false&&t===true){this.startAudio()}if(e===true&&t===false){this.stopAudio()}}},created(){this.getEmitter().subscribe(st.EventType.textarea.onAfterSendMessage,this.handleOnAfterSendMessage)},beforeUnmount(){this.getEmitter().unsubscribe(st.EventType.textarea.onAfterSendMessage,this.handleOnAfterSendMessage)},methods:{onClick(){if(this.audioMode){this.audioMode=false;return}this.audioMode=true},startAudio(){this.getAudioManager().startRecognition();this.bindAudioEvents()},stopAudio(){this.getAudioManager().stopRecognition();this.unbindAudioEvents()},bindAudioEvents(){this.getAudioManager().subscribe(Ce.events.recognitionResult,(t=>{const e=t.getData();this.$emit("inputResult",e);this.audioUsed=true}));this.getAudioManager().subscribe(Ce.events.recognitionStart,(()=>{this.$emit("inputStart")}));this.getAudioManager().subscribe(Ce.events.recognitionEnd,(()=>{this.audioMode=false}));this.getAudioManager().subscribe(Ce.events.recognitionError,(()=>{this.audioMode=false;k.Notifier.speech.onRecognitionError()}))},unbindAudioEvents(){this.getAudioManager().unsubscribeAll(Ce.events.recognitionResult);this.getAudioManager().unsubscribeAll(Ce.events.recognitionStart);this.getAudioManager().unsubscribeAll(Ce.events.recognitionEnd);this.getAudioManager().unsubscribeAll(Ce.events.recognitionError)},isAudioModeAvailable(){return Ce.isAvailable()},getAudioManager(){if(!this.audioManager){this.audioManager=new Ce}return this.audioManager},handleOnAfterSendMessage(){if(this.audioUsed){x.Analytics.getInstance().copilot.onUseAudioInput(this.dialogId);x.Analytics.getInstance().aiAssistant.onUseAudioInput(this.dialogId);this.audioUsed=false}this.audioMode=false},getEmitter(){return this.$Bitrix.eventEmitter},loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div\n\t\t\tv-if="isAudioModeAvailable()"\n\t\t\t@click="onClick"\n\t\t\tclass="bx-im-copilot-audio-input__container"\n\t\t\t:class="{'--active': audioMode}"\n\t\t></div>\n\t`};const Oe=[{id:1,code:"PEOPLE",showForWindows:true,emoji:[{symbol:"\ud83d\ude00"},{symbol:"\ud83d\ude03"},{symbol:"\ud83d\ude04"},{symbol:"\ud83d\ude01"},{symbol:"\ud83d\ude06"},{symbol:"\ud83d\ude05"},{symbol:"\ud83d\ude02"},{symbol:"\ud83e\udd23"},{symbol:"\ud83d\ude0a"},{symbol:"\ud83d\ude07"},{symbol:"\ud83d\ude42"},{symbol:"\ud83d\ude43"},{symbol:"\ud83d\ude09"},{symbol:"\ud83d\ude0c"},{symbol:"\ud83d\ude0d"},{symbol:"\ud83e\udd70"},{symbol:"\ud83d\ude18"},{symbol:"\ud83d\ude17"},{symbol:"\ud83d\ude19"},{symbol:"\ud83d\ude1a"},{symbol:"\ud83d\ude0b"},{symbol:"\ud83d\ude1b"},{symbol:"\ud83d\ude1d"},{symbol:"\ud83d\ude1c"},{symbol:"\ud83e\udd2a"},{symbol:"\ud83e\udd28"},{symbol:"\ud83e\uddd0"},{symbol:"\ud83e\udd13"},{symbol:"\ud83d\ude0e"},{symbol:"\ud83e\udd29"},{symbol:"\ud83e\udd73"},{symbol:"\ud83d\ude0f"},{symbol:"\ud83d\ude12"},{symbol:"\ud83d\ude1e"},{symbol:"\ud83d\ude14"},{symbol:"\ud83d\ude1f"},{symbol:"\ud83d\ude15"},{symbol:"\ud83d\ude41"},{symbol:"\ud83d\ude23"},{symbol:"\ud83d\ude2b"},{symbol:"\ud83d\ude29"},{symbol:"\ud83e\udd7a"},{symbol:"\ud83d\ude22"},{symbol:"\ud83d\ude2d"},{symbol:"\ud83d\ude24"},{symbol:"\ud83d\ude20"},{symbol:"\ud83d\ude21"},{symbol:"\ud83e\udd2c"},{symbol:"\ud83e\udd2f"},{symbol:"\ud83d\ude33"},{symbol:"\ud83e\udd75"},{symbol:"\ud83e\udd76"},{symbol:"\ud83d\ude31"},{symbol:"\ud83d\ude28"},{symbol:"\ud83d\ude30"},{symbol:"\ud83d\ude25"},{symbol:"\ud83d\ude13"},{symbol:"\ud83e\udd17"},{symbol:"\ud83e\udd14"},{symbol:"\ud83e\udd2d"},{symbol:"\ud83e\udd2b"},{symbol:"\ud83e\udd25"},{symbol:"\ud83d\ude36"},{symbol:"\ud83d\ude10"},{symbol:"\ud83d\ude11"},{symbol:"\ud83d\ude2c"},{symbol:"\ud83d\ude44"},{symbol:"\ud83d\ude2f"},{symbol:"\ud83d\ude26"},{symbol:"\ud83d\ude27"},{symbol:"\ud83d\ude2e"},{symbol:"\ud83d\ude32"},{symbol:"\ud83d\ude34"},{symbol:"\ud83e\udd24"},{symbol:"\ud83d\ude2a"},{symbol:"\ud83d\ude35"},{symbol:"\ud83e\udd10"},{symbol:"\ud83e\udd74"},{symbol:"\ud83e\udd22"},{symbol:"\ud83e\udd2e"},{symbol:"\ud83e\udd27"},{symbol:"\ud83d\ude37"},{symbol:"\ud83e\udd12"},{symbol:"\ud83e\udd15"},{symbol:"\ud83e\udd11"},{symbol:"\ud83e\udd20"},{symbol:"\ud83d\ude08"},{symbol:"\ud83d\udc7f"},{symbol:"\ud83d\udc79"},{symbol:"\ud83d\udc7a"},{symbol:"\ud83e\udd21"},{symbol:"\ud83d\udca9"},{symbol:"\ud83d\udc7b"},{symbol:"\u2620"},{symbol:"\ud83d\udc80"},{symbol:"\ud83d\udc7d"},{symbol:"\ud83d\udc7e"},{symbol:"\ud83e\udd16"},{symbol:"\ud83c\udf83"},{symbol:"\ud83d\ude3a"},{symbol:"\ud83d\ude38"},{symbol:"\ud83d\ude39"},{symbol:"\ud83d\ude3b"},{symbol:"\ud83d\ude3c"},{symbol:"\ud83d\ude3d"},{symbol:"\ud83d\ude40"},{symbol:"\ud83d\ude3f"},{symbol:"\ud83d\ude3e"},{symbol:"\ud83e\udd32"},{symbol:"\ud83d\udc50"},{symbol:"\ud83d\ude4c"},{symbol:"\ud83d\udc4f"},{symbol:"\ud83e\udd1d"},{symbol:"\ud83d\udc4d"},{symbol:"\ud83d\udc4e"},{symbol:"\ud83d\udc4a"},{symbol:"\u270a"},{symbol:"\ud83e\udd1b"},{symbol:"\ud83e\udd1c"},{symbol:"\ud83e\udd1e"},{symbol:"\u270c"},{symbol:"\ud83e\udd1f"},{symbol:"\ud83e\udd18"},{symbol:"\ud83d\udc4c"},{symbol:"\ud83d\udc48"},{symbol:"\ud83d\udc49"},{symbol:"\ud83d\udc46"},{symbol:"\ud83d\udc47"},{symbol:"\ud83e\udd1a"},{symbol:"\ud83d\udd90"},{symbol:"\ud83d\udd96"},{symbol:"\ud83d\udc4b"},{symbol:"\ud83e\udd19"},{symbol:"\ud83d\udcaa"},{symbol:"\ud83d\udd95"},{symbol:"\u270d"},{symbol:"\ud83d\ude4f"},{symbol:"\ud83e\uddb6"},{symbol:"\ud83e\uddb5"},{symbol:"\ud83d\udc84"},{symbol:"\ud83d\udc8b"},{symbol:"\ud83d\udc44"},{symbol:"\ud83e\uddb7"},{symbol:"\ud83d\udc45"},{symbol:"\ud83d\udc43"},{symbol:"\ud83d\udc63"},{symbol:"\ud83d\udc41"},{symbol:"\ud83d\udc40"},{symbol:"\ud83e\udde0"},{symbol:"\ud83d\udde3"},{symbol:"\ud83d\udc64"},{symbol:"\ud83d\udc65"},{symbol:"\ud83d\udc76"},{symbol:"\ud83d\udc67"},{symbol:"\ud83e\uddd2"},{symbol:"\ud83d\udc66"},{symbol:"\ud83d\udc69"},{symbol:"\ud83e\uddd1"},{symbol:"\ud83d\udc68"},{symbol:"\ud83d\udc71"},{symbol:"\ud83e\uddd4"},{symbol:"\ud83d\udc75"},{symbol:"\ud83e\uddd3"},{symbol:"\ud83d\udc74"},{symbol:"\ud83d\udc72"},{symbol:"\ud83d\udc73"},{symbol:"\ud83e\uddd5"},{symbol:"\ud83d\udc6e"},{symbol:"\ud83d\udc77"},{symbol:"\ud83d\udc82"},{symbol:"\ud83d\udd75"},{symbol:"\u2695"},{symbol:"\ud83c\udf3e"},{symbol:"\ud83c\udf73"},{symbol:"\ud83c\udf93"},{symbol:"\ud83c\udfa4"},{symbol:"\ud83c\udfeb"},{symbol:"\ud83c\udfed"},{symbol:"\ud83d\udcbb"},{symbol:"\ud83d\udcbc"},{symbol:"\ud83d\udc69"},{symbol:"\u2764"},{symbol:"\ud83d\udd27"},{symbol:"\ud83d\udd2c"},{symbol:"\ud83c\udfa8"},{symbol:"\ud83d\ude92"},{symbol:"\ud83d\ude80"},{symbol:"\ud83d\udc70"},{symbol:"\ud83e\udd35"},{symbol:"\ud83d\udc78"},{symbol:"\ud83e\udd34"},{symbol:"\ud83e\uddb8"},{symbol:"\ud83e\uddb9"},{symbol:"\ud83e\udd36"},{symbol:"\ud83c\udf85"},{symbol:"\ud83e\uddd9"},{symbol:"\ud83e\udddd"},{symbol:"\ud83e\udddb"},{symbol:"\ud83e\udddf"},{symbol:"\ud83e\uddde"},{symbol:"\ud83e\udddc"},{symbol:"\ud83e\uddda"},{symbol:"\ud83d\udc7c"},{symbol:"\ud83e\udd30"},{symbol:"\ud83e\udd31"},{symbol:"\ud83d\ude47"},{symbol:"\ud83d\udc81"},{symbol:"\ud83d\ude45"},{symbol:"\ud83d\ude46"},{symbol:"\ud83d\ude4b"},{symbol:"\ud83e\udd26"},{symbol:"\ud83e\udd37"},{symbol:"\ud83d\ude4e"},{symbol:"\ud83d\ude4d"},{symbol:"\ud83d\udc87"},{symbol:"\ud83d\udc86"},{symbol:"\ud83e\uddd6"},{symbol:"\ud83d\udc85"},{symbol:"\ud83e\udd33"},{symbol:"\ud83d\udc83"},{symbol:"\ud83d\udd7a"},{symbol:"\ud83d\udc6f"},{symbol:"\ud83d\udd74"},{symbol:"\ud83d\udeb6"},{symbol:"\ud83c\udfc3"},{symbol:"\ud83d\udc6b"},{symbol:"\ud83d\udc6d"},{symbol:"\ud83d\udc6c"},{symbol:"\ud83d\udc91"},{symbol:"\ud83d\udc8f"},{symbol:"\ud83d\udc6a"},{symbol:"\ud83e\uddf6"},{symbol:"\ud83e\uddf5"},{symbol:"\ud83e\udde5"},{symbol:"\ud83e\udd7c"},{symbol:"\ud83d\udc5a"},{symbol:"\ud83d\udc55"},{symbol:"\ud83d\udc56"},{symbol:"\ud83d\udc54"},{symbol:"\ud83d\udc57"},{symbol:"\ud83d\udc59"},{symbol:"\ud83d\udc58"},{symbol:"\ud83e\udd7f"},{symbol:"\ud83d\udc60"},{symbol:"\ud83d\udc61"},{symbol:"\ud83d\udc62"},{symbol:"\ud83d\udc5e"},{symbol:"\ud83d\udc5f"},{symbol:"\ud83e\udd7e"},{symbol:"\ud83e\udde6"},{symbol:"\ud83e\udde4"},{symbol:"\ud83e\udde3"},{symbol:"\ud83c\udfa9"},{symbol:"\ud83e\udde2"},{symbol:"\ud83d\udc52"},{symbol:"\ud83c\udf93"},{symbol:"\u26d1"},{symbol:"\ud83d\udc51"},{symbol:"\ud83d\udc8d"},{symbol:"\ud83d\udc5d"},{symbol:"\ud83d\udc5b"},{symbol:"\ud83d\udc5c"},{symbol:"\ud83d\udcbc"},{symbol:"\ud83c\udf92"},{symbol:"\ud83e\uddf3"},{symbol:"\ud83d\udc53"},{symbol:"\ud83d\udd76"},{symbol:"\ud83e\udd7d"},{symbol:"\ud83c\udf02"}]},{id:2,code:"ANIMALS",showForWindows:true,emoji:[{symbol:"\ud83d\udc36"},{symbol:"\ud83d\udc31"},{symbol:"\ud83d\udc2d"},{symbol:"\ud83d\udc39"},{symbol:"\ud83d\udc30"},{symbol:"\ud83e\udd8a"},{symbol:"\ud83d\udc3b"},{symbol:"\ud83d\udc3c"},{symbol:"\ud83d\udc28"},{symbol:"\ud83d\udc2f"},{symbol:"\ud83e\udd81"},{symbol:"\ud83d\udc2e"},{symbol:"\ud83d\udc37"},{symbol:"\ud83d\udc3d"},{symbol:"\ud83d\udc38"},{symbol:"\ud83d\udc35"},{symbol:"\ud83d\ude48"},{symbol:"\ud83d\ude49"},{symbol:"\ud83d\ude4a"},{symbol:"\ud83d\udc12"},{symbol:"\ud83d\udc14"},{symbol:"\ud83d\udc27"},{symbol:"\ud83d\udc26"},{symbol:"\ud83d\udc24"},{symbol:"\ud83d\udc23"},{symbol:"\ud83d\udc25"},{symbol:"\ud83e\udd86"},{symbol:"\ud83e\udd85"},{symbol:"\ud83e\udd89"},{symbol:"\ud83e\udd87"},{symbol:"\ud83d\udc3a"},{symbol:"\ud83d\udc17"},{symbol:"\ud83d\udc34"},{symbol:"\ud83e\udd84"},{symbol:"\ud83d\udc1d"},{symbol:"\ud83d\udc1b"},{symbol:"\ud83e\udd8b"},{symbol:"\ud83d\udc0c"},{symbol:"\ud83d\udc1e"},{symbol:"\ud83d\udc1c"},{symbol:"\ud83e\udd9f"},{symbol:"\ud83e\udd97"},{symbol:"\ud83d\udd77"},{symbol:"\ud83d\udd78"},{symbol:"\ud83e\udd82"},{symbol:"\ud83d\udc22"},{symbol:"\ud83d\udc0d"},{symbol:"\ud83e\udd8e"},{symbol:"\ud83e\udd96"},{symbol:"\ud83e\udd95"},{symbol:"\ud83d\udc19"},{symbol:"\ud83e\udd91"},{symbol:"\ud83e\udd90"},{symbol:"\ud83e\udd9e"},{symbol:"\ud83e\udd80"},{symbol:"\ud83d\udc21"},{symbol:"\ud83d\udc20"},{symbol:"\ud83d\udc1f"},{symbol:"\ud83d\udc2c"},{symbol:"\ud83d\udc33"},{symbol:"\ud83d\udc0b"},{symbol:"\ud83e\udd88"},{symbol:"\ud83d\udc0a"},{symbol:"\ud83d\udc05"},{symbol:"\ud83d\udc06"},{symbol:"\ud83e\udd93"},{symbol:"\ud83e\udd8d"},{symbol:"\ud83d\udc18"},{symbol:"\ud83e\udd9b"},{symbol:"\ud83e\udd8f"},{symbol:"\ud83d\udc2a"},{symbol:"\ud83d\udc2b"},{symbol:"\ud83e\udd92"},{symbol:"\ud83e\udd98"},{symbol:"\ud83d\udc03"},{symbol:"\ud83d\udc02"},{symbol:"\ud83d\udc04"},{symbol:"\ud83d\udc0e"},{symbol:"\ud83d\udc16"},{symbol:"\ud83d\udc0f"},{symbol:"\ud83d\udc11"},{symbol:"\ud83e\udd99"},{symbol:"\ud83d\udc10"},{symbol:"\ud83e\udd8c"},{symbol:"\ud83d\udc15"},{symbol:"\ud83d\udc29"},{symbol:"\ud83d\udc08"},{symbol:"\ud83d\udc13"},{symbol:"\ud83e\udd83"},{symbol:"\ud83e\udd9a"},{symbol:"\ud83e\udd9c"},{symbol:"\ud83e\udda2"},{symbol:"\ud83d\udd4a"},{symbol:"\ud83d\udc07"},{symbol:"\ud83e\udd9d"},{symbol:"\ud83e\udda1"},{symbol:"\ud83d\udc01"},{symbol:"\ud83d\udc00"},{symbol:"\ud83d\udc3f"},{symbol:"\ud83e\udd94"},{symbol:"\ud83d\udc3e"},{symbol:"\ud83d\udc09"},{symbol:"\ud83d\udc32"},{symbol:"\ud83c\udf35"},{symbol:"\ud83c\udf84"},{symbol:"\ud83c\udf32"},{symbol:"\ud83c\udf33"},{symbol:"\ud83c\udf34"},{symbol:"\ud83c\udf31"},{symbol:"\ud83c\udf3f"},{symbol:"\u2618"},{symbol:"\ud83c\udf40"},{symbol:"\ud83c\udf8d"},{symbol:"\ud83c\udf8b"},{symbol:"\ud83c\udf43"},{symbol:"\ud83c\udf42"},{symbol:"\ud83c\udf41"},{symbol:"\ud83c\udf44"},{symbol:"\ud83d\udc1a"},{symbol:"\ud83c\udf3e"},{symbol:"\ud83d\udc90"},{symbol:"\ud83c\udf37"},{symbol:"\ud83c\udf39"},{symbol:"\ud83e\udd40"},{symbol:"\ud83c\udf3a"},{symbol:"\ud83c\udf38"},{symbol:"\ud83c\udf3c"},{symbol:"\ud83c\udf3b"},{symbol:"\ud83c\udf1e"},{symbol:"\ud83c\udf1d"},{symbol:"\ud83c\udf1b"},{symbol:"\ud83c\udf1c"},{symbol:"\ud83c\udf1a"},{symbol:"\ud83c\udf15"},{symbol:"\ud83c\udf16"},{symbol:"\ud83c\udf17"},{symbol:"\ud83c\udf18"},{symbol:"\ud83c\udf11"},{symbol:"\ud83c\udf12"},{symbol:"\ud83c\udf13"},{symbol:"\ud83c\udf14"},{symbol:"\ud83c\udf19"},{symbol:"\ud83c\udf0e"},{symbol:"\ud83c\udf0d"},{symbol:"\ud83c\udf0f"},{symbol:"\ud83d\udcab"},{symbol:"\u2b50"},{symbol:"\ud83c\udf1f"},{symbol:"\u2728"},{symbol:"\u26a1"},{symbol:"\u2604"},{symbol:"\ud83d\udca5"},{symbol:"\ud83d\udd25"},{symbol:"\ud83c\udf2a"},{symbol:"\ud83c\udf08"},{symbol:"\u2600"},{symbol:"\ud83c\udf24"},{symbol:"\ud83c\udf25"},{symbol:"\ud83c\udf26"},{symbol:"\ud83c\udf27"},{symbol:"\ud83c\udf29"},{symbol:"\ud83c\udf28"},{symbol:"\u2744"},{symbol:"\u2603"},{symbol:"\u26c4"},{symbol:"\ud83c\udf2c"},{symbol:"\ud83d\udca8"},{symbol:"\ud83d\udca7"},{symbol:"\ud83d\udca6"},{symbol:"\u2614"},{symbol:"\u2602"},{symbol:"\ud83c\udf0a"},{symbol:"\ud83c\udf2b"}]},{id:3,code:"FOOD",showForWindows:true,emoji:[{symbol:"\ud83c\udf4f"},{symbol:"\ud83c\udf4e"},{symbol:"\ud83c\udf50"},{symbol:"\ud83c\udf4a"},{symbol:"\ud83c\udf4b"},{symbol:"\ud83c\udf4c"},{symbol:"\ud83c\udf49"},{symbol:"\ud83c\udf47"},{symbol:"\ud83c\udf53"},{symbol:"\ud83c\udf48"},{symbol:"\ud83c\udf52"},{symbol:"\ud83c\udf51"},{symbol:"\ud83e\udd6d"},{symbol:"\ud83c\udf4d"},{symbol:"\ud83e\udd65"},{symbol:"\ud83e\udd5d"},{symbol:"\ud83c\udf45"},{symbol:"\ud83c\udf46"},{symbol:"\ud83e\udd51"},{symbol:"\ud83e\udd66"},{symbol:"\ud83e\udd6c"},{symbol:"\ud83e\udd52"},{symbol:"\ud83c\udf36"},{symbol:"\ud83c\udf3d"},{symbol:"\ud83e\udd55"},{symbol:"\ud83e\udd54"},{symbol:"\ud83c\udf60"},{symbol:"\ud83e\udd50"},{symbol:"\ud83e\udd6f"},{symbol:"\ud83c\udf5e"},{symbol:"\ud83e\udd56"},{symbol:"\ud83e\udd68"},{symbol:"\ud83e\uddc0"},{symbol:"\ud83e\udd5a"},{symbol:"\ud83c\udf73"},{symbol:"\ud83e\udd5e"},{symbol:"\ud83e\udd53"},{symbol:"\ud83e\udd69"},{symbol:"\ud83c\udf57"},{symbol:"\ud83c\udf56"},{symbol:"\ud83e\uddb4"},{symbol:"\ud83c\udf2d"},{symbol:"\ud83c\udf54"},{symbol:"\ud83c\udf5f"},{symbol:"\ud83c\udf55"},{symbol:"\ud83e\udd6a"},{symbol:"\ud83e\udd59"},{symbol:"\ud83c\udf2e"},{symbol:"\ud83c\udf2f"},{symbol:"\ud83e\udd57"},{symbol:"\ud83e\udd58"},{symbol:"\ud83e\udd6b"},{symbol:"\ud83c\udf5d"},{symbol:"\ud83c\udf5c"},{symbol:"\ud83c\udf72"},{symbol:"\ud83c\udf5b"},{symbol:"\ud83c\udf63"},{symbol:"\ud83c\udf71"},{symbol:"\ud83e\udd5f"},{symbol:"\ud83c\udf64"},{symbol:"\ud83c\udf59"},{symbol:"\ud83c\udf5a"},{symbol:"\ud83c\udf58"},{symbol:"\ud83c\udf65"},{symbol:"\ud83e\udd60"},{symbol:"\ud83e\udd6e"},{symbol:"\ud83c\udf62"},{symbol:"\ud83c\udf61"},{symbol:"\ud83c\udf67"},{symbol:"\ud83c\udf68"},{symbol:"\ud83c\udf66"},{symbol:"\ud83e\udd67"},{symbol:"\ud83e\uddc1"},{symbol:"\ud83c\udf70"},{symbol:"\ud83c\udf82"},{symbol:"\ud83c\udf6e"},{symbol:"\ud83c\udf6d"},{symbol:"\ud83c\udf6c"},{symbol:"\ud83c\udf6b"},{symbol:"\ud83c\udf7f"},{symbol:"\ud83c\udf69"},{symbol:"\ud83c\udf6a"},{symbol:"\ud83c\udf30"},{symbol:"\ud83e\udd5c"},{symbol:"\ud83c\udf6f"},{symbol:"\ud83e\udd5b"},{symbol:"\ud83c\udf7c"},{symbol:"\u2615"},{symbol:"\ud83c\udf75"},{symbol:"\ud83e\udd64"},{symbol:"\ud83c\udf76"},{symbol:"\ud83c\udf7a"},{symbol:"\ud83c\udf7b"},{symbol:"\ud83e\udd42"},{symbol:"\ud83c\udf77"},{symbol:"\ud83e\udd43"},{symbol:"\ud83c\udf78"},{symbol:"\ud83c\udf79"},{symbol:"\ud83c\udf7e"},{symbol:"\ud83e\udd44"},{symbol:"\ud83c\udf74"},{symbol:"\ud83c\udf7d"},{symbol:"\ud83e\udd63"},{symbol:"\ud83e\udd61"},{symbol:"\ud83e\udd62"},{symbol:"\ud83e\uddc2"}]},{id:4,code:"HOBBY",showForWindows:true,emoji:[{symbol:"\u26bd"},{symbol:"\ud83c\udfc0"},{symbol:"\ud83c\udfc8"},{symbol:"\u26be"},{symbol:"\ud83e\udd4e"},{symbol:"\ud83c\udfbe"},{symbol:"\ud83c\udfd0"},{symbol:"\ud83c\udfc9"},{symbol:"\ud83e\udd4f"},{symbol:"\ud83c\udfb1"},{symbol:"\ud83c\udfd3"},{symbol:"\ud83c\udff8"},{symbol:"\ud83c\udfd2"},{symbol:"\ud83c\udfd1"},{symbol:"\ud83e\udd4d"},{symbol:"\ud83c\udfcf"},{symbol:"\ud83e\udd45"},{symbol:"\u26f3"},{symbol:"\ud83c\udff9"},{symbol:"\ud83c\udfa3"},{symbol:"\ud83e\udd4a"},{symbol:"\ud83e\udd4b"},{symbol:"\ud83c\udfbd"},{symbol:"\ud83d\udef9"},{symbol:"\ud83d\udef7"},{symbol:"\u26f8"},{symbol:"\ud83e\udd4c"},{symbol:"\ud83c\udfbf"},{symbol:"\u26f7"},{symbol:"\ud83c\udfc2"},{symbol:"\ud83c\udfcb"},{symbol:"\ud83e\udd3c"},{symbol:"\ud83e\udd38"},{symbol:"\u26f9"},{symbol:"\ud83e\udd3a"},{symbol:"\ud83e\udd3e"},{symbol:"\ud83c\udfcc"},{symbol:"\ud83c\udfc7"},{symbol:"\ud83e\uddd8"},{symbol:"\ud83c\udfc4"},{symbol:"\ud83c\udfca"},{symbol:"\ud83e\udd3d"},{symbol:"\ud83d\udea3"},{symbol:"\ud83e\uddd7"},{symbol:"\ud83d\udeb5"},{symbol:"\ud83d\udeb4"},{symbol:"\ud83c\udfc6"},{symbol:"\ud83e\udd47"},{symbol:"\ud83e\udd48"},{symbol:"\ud83e\udd49"},{symbol:"\ud83c\udfc5"},{symbol:"\ud83c\udf96"},{symbol:"\ud83c\udff5"},{symbol:"\ud83c\udf97"},{symbol:"\ud83c\udfab"},{symbol:"\ud83c\udf9f"},{symbol:"\ud83c\udfaa"},{symbol:"\ud83e\udd39"},{symbol:"\ud83c\udfad"},{symbol:"\ud83c\udfa8"},{symbol:"\ud83c\udfac"},{symbol:"\ud83c\udfa4"},{symbol:"\ud83c\udfa7"},{symbol:"\ud83c\udfbc"},{symbol:"\ud83c\udfb9"},{symbol:"\ud83e\udd41"},{symbol:"\ud83c\udfb7"},{symbol:"\ud83c\udfba"},{symbol:"\ud83c\udfb8"},{symbol:"\ud83c\udfbb"},{symbol:"\ud83c\udfb2"},{symbol:"\u265f"},{symbol:"\ud83c\udfaf"},{symbol:"\ud83c\udfb3"},{symbol:"\ud83c\udfae"},{symbol:"\ud83c\udfb0"},{symbol:"\ud83e\udde9"}]},{id:5,code:"TRAVEL",showForWindows:true,emoji:[{symbol:"\ud83d\ude97"},{symbol:"\ud83d\ude95"},{symbol:"\ud83d\ude99"},{symbol:"\ud83d\ude8c"},{symbol:"\ud83d\ude8e"},{symbol:"\ud83c\udfce"},{symbol:"\ud83d\ude93"},{symbol:"\ud83d\ude91"},{symbol:"\ud83d\ude92"},{symbol:"\ud83d\ude90"},{symbol:"\ud83d\ude9a"},{symbol:"\ud83d\ude9b"},{symbol:"\ud83d\ude9c"},{symbol:"\ud83d\udef4"},{symbol:"\ud83d\udeb2"},{symbol:"\ud83d\udef5"},{symbol:"\ud83c\udfcd"},{symbol:"\ud83d\udea8"},{symbol:"\ud83d\ude94"},{symbol:"\ud83d\ude8d"},{symbol:"\ud83d\ude98"},{symbol:"\ud83d\ude96"},{symbol:"\ud83d\udea1"},{symbol:"\ud83d\udea0"},{symbol:"\ud83d\ude9f"},{symbol:"\ud83d\ude83"},{symbol:"\ud83d\ude8b"},{symbol:"\ud83d\ude9e"},{symbol:"\ud83d\ude9d"},{symbol:"\ud83d\ude84"},{symbol:"\ud83d\ude85"},{symbol:"\ud83d\ude88"},{symbol:"\ud83d\ude82"},{symbol:"\ud83d\ude86"},{symbol:"\ud83d\ude87"},{symbol:"\ud83d\ude8a"},{symbol:"\ud83d\ude89"},{symbol:"\u2708"},{symbol:"\ud83d\udeeb"},{symbol:"\ud83d\udeec"},{symbol:"\ud83d\udee9"},{symbol:"\ud83d\udcba"},{symbol:"\ud83d\udef0"},{symbol:"\ud83d\ude80"},{symbol:"\ud83d\udef8"},{symbol:"\ud83d\ude81"},{symbol:"\ud83d\udef6"},{symbol:"\u26f5"},{symbol:"\ud83d\udea4"},{symbol:"\ud83d\udee5"},{symbol:"\ud83d\udef3"},{symbol:"\u26f4"},{symbol:"\ud83d\udea2"},{symbol:"\u2693"},{symbol:"\u26fd"},{symbol:"\ud83d\udea7"},{symbol:"\ud83d\udea6"},{symbol:"\ud83d\udea5"},{symbol:"\ud83d\ude8f"},{symbol:"\ud83d\uddfa"},{symbol:"\ud83d\uddff"},{symbol:"\ud83d\uddfd"},{symbol:"\ud83d\uddfc"},{symbol:"\ud83c\udff0"},{symbol:"\ud83c\udfef"},{symbol:"\ud83c\udfdf"},{symbol:"\ud83c\udfa1"},{symbol:"\ud83c\udfa2"},{symbol:"\ud83c\udfa0"},{symbol:"\u26f2"},{symbol:"\u26f1"},{symbol:"\ud83c\udfd6"},{symbol:"\ud83c\udfdd"},{symbol:"\ud83c\udfdc"},{symbol:"\ud83c\udf0b"},{symbol:"\u26f0"},{symbol:"\ud83c\udfd4"},{symbol:"\ud83d\uddfb"},{symbol:"\ud83c\udfd5"},{symbol:"\u26fa"},{symbol:"\ud83c\udfe0"},{symbol:"\ud83c\udfe1"},{symbol:"\ud83c\udfd8"},{symbol:"\ud83c\udfda"},{symbol:"\ud83c\udfd7"},{symbol:"\ud83c\udfed"},{symbol:"\ud83c\udfe2"},{symbol:"\ud83c\udfec"},{symbol:"\ud83c\udfe3"},{symbol:"\ud83c\udfe4"},{symbol:"\ud83c\udfe5"},{symbol:"\ud83c\udfe6"},{symbol:"\ud83c\udfe8"},{symbol:"\ud83c\udfea"},{symbol:"\ud83c\udfeb"},{symbol:"\ud83c\udfe9"},{symbol:"\ud83d\udc92"},{symbol:"\ud83c\udfdb"},{symbol:"\u26ea"},{symbol:"\ud83d\udd4c"},{symbol:"\ud83d\udd4d"},{symbol:"\ud83d\udd4b"},{symbol:"\u26e9"},{symbol:"\ud83d\udee4"},{symbol:"\ud83d\udee3"},{symbol:"\ud83d\uddfe"},{symbol:"\ud83c\udf91"},{symbol:"\ud83c\udfde"},{symbol:"\ud83c\udf05"},{symbol:"\ud83c\udf04"},{symbol:"\ud83c\udf20"},{symbol:"\ud83c\udf87"},{symbol:"\ud83c\udf86"},{symbol:"\ud83c\udf07"},{symbol:"\ud83c\udf06"},{symbol:"\ud83c\udfd9"},{symbol:"\ud83c\udf03"},{symbol:"\ud83c\udf0c"},{symbol:"\ud83c\udf09"},{symbol:"\ud83c\udf01"}]},{id:6,code:"OBJECTS",showForWindows:true,emoji:[{symbol:"\u231a"},{symbol:"\ud83d\udcf1"},{symbol:"\ud83d\udcf2"},{symbol:"\ud83d\udcbb"},{symbol:"\u2328"},{symbol:"\ud83d\udda5"},{symbol:"\ud83d\udda8"},{symbol:"\ud83d\uddb1"},{symbol:"\ud83d\uddb2"},{symbol:"\ud83d\udd79"},{symbol:"\ud83d\udddc"},{symbol:"\ud83d\udcbd"},{symbol:"\ud83d\udcbe"},{symbol:"\ud83d\udcbf"},{symbol:"\ud83d\udcc0"},{symbol:"\ud83d\udcfc"},{symbol:"\ud83d\udcf7"},{symbol:"\ud83d\udcf8"},{symbol:"\ud83d\udcf9"},{symbol:"\ud83c\udfa5"},{symbol:"\ud83d\udcfd"},{symbol:"\ud83c\udf9e"},{symbol:"\ud83d\udcde"},{symbol:"\u260e"},{symbol:"\ud83d\udcdf"},{symbol:"\ud83d\udce0"},{symbol:"\ud83d\udcfa"},{symbol:"\ud83d\udcfb"},{symbol:"\ud83c\udf99"},{symbol:"\ud83c\udf9a"},{symbol:"\ud83c\udf9b"},{symbol:"\ud83e\udded"},{symbol:"\u23f1"},{symbol:"\u23f2"},{symbol:"\u23f0"},{symbol:"\ud83d\udd70"},{symbol:"\u231b"},{symbol:"\u23f3"},{symbol:"\ud83d\udce1"},{symbol:"\ud83d\udd0b"},{symbol:"\ud83d\udd0c"},{symbol:"\ud83d\udca1"},{symbol:"\ud83d\udd26"},{symbol:"\ud83d\udd6f"},{symbol:"\ud83e\uddef"},{symbol:"\ud83d\udee2"},{symbol:"\ud83d\udcb8"},{symbol:"\ud83d\udcb5"},{symbol:"\ud83d\udcb4"},{symbol:"\ud83d\udcb6"},{symbol:"\ud83d\udcb7"},{symbol:"\ud83d\udcb0"},{symbol:"\ud83d\udcb3"},{symbol:"\ud83d\udc8e"},{symbol:"\u2696"},{symbol:"\ud83e\uddf0"},{symbol:"\ud83d\udd27"},{symbol:"\ud83d\udd28"},{symbol:"\u2692"},{symbol:"\ud83d\udee0"},{symbol:"\u26cf"},{symbol:"\ud83d\udd29"},{symbol:"\u2699"},{symbol:"\ud83e\uddf1"},{symbol:"\u26d3"},{symbol:"\ud83e\uddf2"},{symbol:"\ud83d\udd2b"},{symbol:"\ud83d\udca3"},{symbol:"\ud83e\udde8"},{symbol:"\ud83d\udd2a"},{symbol:"\ud83d\udde1"},{symbol:"\u2694"},{symbol:"\ud83d\udee1"},{symbol:"\ud83d\udeac"},{symbol:"\u26b0"},{symbol:"\u26b1"},{symbol:"\ud83c\udffa"},{symbol:"\ud83d\udd2e"},{symbol:"\ud83d\udcff"},{symbol:"\ud83e\uddff"},{symbol:"\ud83d\udc88"},{symbol:"\u2697"},{symbol:"\ud83d\udd2d"},{symbol:"\ud83d\udd2c"},{symbol:"\ud83d\udd73"},{symbol:"\ud83d\udc8a"},{symbol:"\ud83d\udc89"},{symbol:"\ud83e\uddec"},{symbol:"\ud83e\udda0"},{symbol:"\ud83e\uddeb"},{symbol:"\ud83e\uddea"},{symbol:"\ud83c\udf21"},{symbol:"\ud83e\uddf9"},{symbol:"\ud83e\uddfa"},{symbol:"\ud83e\uddfb"},{symbol:"\ud83d\udebd"},{symbol:"\ud83d\udeb0"},{symbol:"\ud83d\udebf"},{symbol:"\ud83d\udec1"},{symbol:"\ud83d\udec0"},{symbol:"\ud83e\uddfc"},{symbol:"\ud83e\uddfd"},{symbol:"\ud83e\uddf4"},{symbol:"\ud83d\udece"},{symbol:"\ud83d\udd11"},{symbol:"\ud83d\udddd"},{symbol:"\ud83d\udeaa"},{symbol:"\ud83d\udecb"},{symbol:"\ud83d\udecf"},{symbol:"\ud83d\udecc"},{symbol:"\ud83e\uddf8"},{symbol:"\ud83d\uddbc"},{symbol:"\ud83d\udecd"},{symbol:"\ud83d\uded2"},{symbol:"\ud83c\udf81"},{symbol:"\ud83c\udf88"},{symbol:"\ud83c\udf8f"},{symbol:"\ud83c\udf80"},{symbol:"\ud83c\udf8a"},{symbol:"\ud83c\udf89"},{symbol:"\ud83c\udf8e"},{symbol:"\ud83c\udfee"},{symbol:"\ud83c\udf90"},{symbol:"\ud83e\udde7"},{symbol:"\u2709"},{symbol:"\ud83d\udce9"},{symbol:"\ud83d\udce8"},{symbol:"\ud83d\udce7"},{symbol:"\ud83d\udc8c"},{symbol:"\ud83d\udce5"},{symbol:"\ud83d\udce4"},{symbol:"\ud83d\udce6"},{symbol:"\ud83c\udff7"},{symbol:"\ud83d\udcea"},{symbol:"\ud83d\udceb"},{symbol:"\ud83d\udcec"},{symbol:"\ud83d\udced"},{symbol:"\ud83d\udcee"},{symbol:"\ud83d\udcef"},{symbol:"\ud83d\udcdc"},{symbol:"\ud83d\udcc3"},{symbol:"\ud83d\udcc4"},{symbol:"\ud83d\udcd1"},{symbol:"\ud83e\uddfe"},{symbol:"\ud83d\udcca"},{symbol:"\ud83d\udcc8"},{symbol:"\ud83d\udcc9"},{symbol:"\ud83d\uddd2"},{symbol:"\ud83d\uddd3"},{symbol:"\ud83d\udcc6"},{symbol:"\ud83d\udcc5"},{symbol:"\ud83d\uddd1"},{symbol:"\ud83d\udcc7"},{symbol:"\ud83d\uddc3"},{symbol:"\ud83d\uddf3"},{symbol:"\ud83d\uddc4"},{symbol:"\ud83d\udccb"},{symbol:"\ud83d\udcc1"},{symbol:"\ud83d\udcc2"},{symbol:"\ud83d\uddc2"},{symbol:"\ud83d\uddde"},{symbol:"\ud83d\udcf0"},{symbol:"\ud83d\udcd3"},{symbol:"\ud83d\udcd4"},{symbol:"\ud83d\udcd2"},{symbol:"\ud83d\udcd5"},{symbol:"\ud83d\udcd7"},{symbol:"\ud83d\udcd8"},{symbol:"\ud83d\udcd9"},{symbol:"\ud83d\udcda"},{symbol:"\ud83d\udcd6"},{symbol:"\ud83d\udd16"},{symbol:"\ud83e\uddf7"},{symbol:"\ud83d\udd17"},{symbol:"\ud83d\udcce"},{symbol:"\ud83d\udd87"},{symbol:"\ud83d\udcd0"},{symbol:"\ud83d\udccf"},{symbol:"\ud83d\udccc"},{symbol:"\ud83d\udccd"},{symbol:"\u2702"},{symbol:"\ud83d\udd8a"},{symbol:"\ud83d\udd8b"},{symbol:"\u2712"},{symbol:"\ud83d\udd8c"},{symbol:"\ud83d\udd8d"},{symbol:"\ud83d\udcdd"},{symbol:"\u270f"},{symbol:"\ud83d\udd0d"},{symbol:"\ud83d\udd0e"},{symbol:"\ud83d\udd0f"},{symbol:"\ud83d\udd10"},{symbol:"\ud83d\udd12"},{symbol:"\ud83d\udd13"}]},{id:7,code:"SYMBOLS",showForWindows:true,emoji:[{symbol:"\u2764"},{symbol:"\ud83e\udde1"},{symbol:"\ud83d\udc9b"},{symbol:"\ud83d\udc9a"},{symbol:"\ud83d\udc99"},{symbol:"\ud83d\udc9c"},{symbol:"\ud83d\udda4"},{symbol:"\ud83d\udc94"},{symbol:"\u2763"},{symbol:"\ud83d\udc95"},{symbol:"\ud83d\udc9e"},{symbol:"\ud83d\udc93"},{symbol:"\ud83d\udc97"},{symbol:"\ud83d\udc96"},{symbol:"\ud83d\udc98"},{symbol:"\ud83d\udc9d"},{symbol:"\ud83d\udc9f"},{symbol:"\u262e"},{symbol:"\u271d"},{symbol:"\u262a"},{symbol:"\ud83d\udd49"},{symbol:"\u2638"},{symbol:"\u2721"},{symbol:"\ud83d\udd2f"},{symbol:"\ud83d\udd4e"},{symbol:"\u262f"},{symbol:"\u2626"},{symbol:"\ud83d\uded0"},{symbol:"\u26ce"},{symbol:"\u2648"},{symbol:"\u2649"},{symbol:"\u264a"},{symbol:"\u264b"},{symbol:"\u264c"},{symbol:"\u264d"},{symbol:"\u264e"},{symbol:"\u264f"},{symbol:"\u2650"},{symbol:"\u2651"},{symbol:"\u2652"},{symbol:"\u2653"},{symbol:"\ud83c\udd94"},{symbol:"\u269b"},{symbol:"\ud83c\ude51"},{symbol:"\u2622"},{symbol:"\u2623"},{symbol:"\ud83d\udcf4"},{symbol:"\ud83d\udcf3"},{symbol:"\ud83c\ude36"},{symbol:"\ud83c\ude1a"},{symbol:"\ud83c\ude38"},{symbol:"\ud83c\ude3a"},{symbol:"\ud83c\ude37"},{symbol:"\u2734"},{symbol:"\ud83c\udd9a"},{symbol:"\ud83d\udcae"},{symbol:"\ud83c\ude50"},{symbol:"\u3299"},{symbol:"\u3297"},{symbol:"\ud83c\ude34"},{symbol:"\ud83c\ude35"},{symbol:"\ud83c\ude39"},{symbol:"\ud83c\ude32"},{symbol:"\ud83c\udd70"},{symbol:"\ud83c\udd71"},{symbol:"\ud83c\udd8e"},{symbol:"\ud83c\udd91"},{symbol:"\ud83c\udd7e"},{symbol:"\ud83c\udd98"},{symbol:"\u274c"},{symbol:"\u2b55"},{symbol:"\ud83d\uded1"},{symbol:"\u26d4"},{symbol:"\ud83d\udcdb"},{symbol:"\ud83d\udeab"},{symbol:"\ud83d\udcaf"},{symbol:"\ud83d\udca2"},{symbol:"\u2668"},{symbol:"\ud83d\udeb7"},{symbol:"\ud83d\udeaf"},{symbol:"\ud83d\udeb3"},{symbol:"\ud83d\udeb1"},{symbol:"\ud83d\udd1e"},{symbol:"\ud83d\udcf5"},{symbol:"\ud83d\udead"},{symbol:"\u2757"},{symbol:"\u2755"},{symbol:"\u2753"},{symbol:"\u2754"},{symbol:"\u203c"},{symbol:"\u2049"},{symbol:"\ud83d\udd05"},{symbol:"\ud83d\udd06"},{symbol:"\u303d"},{symbol:"\u26a0"},{symbol:"\ud83d\udeb8"},{symbol:"\ud83d\udd31"},{symbol:"\u269c"},{symbol:"\ud83d\udd30"},{symbol:"\u267b"},{symbol:"\u2705"},{symbol:"\ud83c\ude2f"},{symbol:"\ud83d\udcb9"},{symbol:"\u2747"},{symbol:"\u2733"},{symbol:"\u274e"},{symbol:"\ud83c\udf10"},{symbol:"\ud83d\udca0"},{symbol:"\u24c2"},{symbol:"\ud83c\udf00"},{symbol:"\ud83d\udca4"},{symbol:"\ud83c\udfe7"},{symbol:"\ud83d\udebe"},{symbol:"\u267f"},{symbol:"\ud83c\udd7f"},{symbol:"\ud83c\ude33"},{symbol:"\ud83c\ude02"},{symbol:"\ud83d\udec2"},{symbol:"\ud83d\udec3"},{symbol:"\ud83d\udec4"},{symbol:"\ud83d\udec5"},{symbol:"\ud83d\udeb9"},{symbol:"\ud83d\udeba"},{symbol:"\ud83d\udebc"},{symbol:"\ud83d\udebb"},{symbol:"\ud83d\udeae"},{symbol:"\ud83c\udfa6"},{symbol:"\ud83d\udcf6"},{symbol:"\ud83c\ude01"},{symbol:"\ud83d\udd23"},{symbol:"\u2139"},{symbol:"\ud83d\udd24"},{symbol:"\ud83d\udd21"},{symbol:"\ud83d\udd20"},{symbol:"\ud83c\udd96"},{symbol:"\ud83c\udd97"},{symbol:"\ud83c\udd99"},{symbol:"\ud83c\udd92"},{symbol:"\ud83c\udd95"},{symbol:"\ud83c\udd93"},{symbol:"0"},{symbol:"1"},{symbol:"2"},{symbol:"3"},{symbol:"4"},{symbol:"5"},{symbol:"6"},{symbol:"7"},{symbol:"8"},{symbol:"9"},{symbol:"\ud83d\udd1f"},{symbol:"\ud83d\udd22"},{symbol:"#"},{symbol:"*"},{symbol:"\u23cf"},{symbol:"\u25b6"},{symbol:"\u23f8"},{symbol:"\u23ef"},{symbol:"\u23f9"},{symbol:"\u23fa"},{symbol:"\u23ed"},{symbol:"\u23ee"},{symbol:"\u23e9"},{symbol:"\u23ea"},{symbol:"\u23eb"},{symbol:"\u23ec"},{symbol:"\u25c0"},{symbol:"\ud83d\udd3c"},{symbol:"\ud83d\udd3d"},{symbol:"\u27a1"},{symbol:"\u2b05"},{symbol:"\u2b06"},{symbol:"\u2b07"},{symbol:"\u2197"},{symbol:"\u2198"},{symbol:"\u2199"},{symbol:"\u2196"},{symbol:"\u2195"},{symbol:"\u2194"},{symbol:"\u21aa"},{symbol:"\u21a9"},{symbol:"\u2934"},{symbol:"\u2935"},{symbol:"\ud83d\udd00"},{symbol:"\ud83d\udd01"},{symbol:"\ud83d\udd02"},{symbol:"\ud83d\udd04"},{symbol:"\ud83d\udd03"},{symbol:"\ud83c\udfb5"},{symbol:"\ud83c\udfb6"},{symbol:"\u2795"},{symbol:"\u2796"},{symbol:"\u2797"},{symbol:"\u2716"},{symbol:"\u267e"},{symbol:"\ud83d\udcb2"},{symbol:"\ud83d\udcb1"},{symbol:"\u2122"},{symbol:"\xa9"},{symbol:"\xae"},{symbol:"\ud83d\udc41"},{symbol:"\ud83d\udde8"},{symbol:"\ud83d\udd1a"},{symbol:"\ud83d\udd19"},{symbol:"\ud83d\udd1b"},{symbol:"\ud83d\udd1d"},{symbol:"\ud83d\udd1c"},{symbol:"\u3030"},{symbol:"\u27b0"},{symbol:"\u27bf"},{symbol:"\u2714"},{symbol:"\u2611"},{symbol:"\ud83d\udd18"},{symbol:"\u26aa"},{symbol:"\u26ab"},{symbol:"\ud83d\udd34"},{symbol:"\ud83d\udd35"},{symbol:"\ud83d\udd3a"},{symbol:"\ud83d\udd3b"},{symbol:"\ud83d\udd38"},{symbol:"\ud83d\udd39"},{symbol:"\ud83d\udd36"},{symbol:"\ud83d\udd37"},{symbol:"\ud83d\udd33"},{symbol:"\ud83d\udd32"},{symbol:"\u25aa"},{symbol:"\u25ab"},{symbol:"\u25fe"},{symbol:"\u25fd"},{symbol:"\u25fc"},{symbol:"\u25fb"},{symbol:"\u2b1b"},{symbol:"\u2b1c"},{symbol:"\ud83d\udd08"},{symbol:"\ud83d\udd07"},{symbol:"\ud83d\udd09"},{symbol:"\ud83d\udd0a"},{symbol:"\ud83d\udd14"},{symbol:"\ud83d\udd15"},{symbol:"\ud83d\udce3"},{symbol:"\ud83d\udce2"},{symbol:"\ud83d\udcac"},{symbol:"\ud83d\udcad"},{symbol:"\ud83d\uddef"},{symbol:"\u2660"},{symbol:"\u2663"},{symbol:"\u2665"},{symbol:"\u2666"},{symbol:"\ud83c\udccf"},{symbol:"\ud83c\udfb4"},{symbol:"\ud83c\udc04"},{symbol:"\ud83d\udd50"},{symbol:"\ud83d\udd51"},{symbol:"\ud83d\udd52"},{symbol:"\ud83d\udd53"},{symbol:"\ud83d\udd54"},{symbol:"\ud83d\udd55"},{symbol:"\ud83d\udd56"},{symbol:"\ud83d\udd57"},{symbol:"\ud83d\udd58"},{symbol:"\ud83d\udd59"},{symbol:"\ud83d\udd5a"},{symbol:"\ud83d\udd5b"},{symbol:"\ud83d\udd5c"},{symbol:"\ud83d\udd5d"},{symbol:"\ud83d\udd5e"},{symbol:"\ud83d\udd5f"},{symbol:"\ud83d\udd60"},{symbol:"\ud83d\udd61"},{symbol:"\ud83d\udd62"},{symbol:"\ud83d\udd63"},{symbol:"\ud83d\udd64"},{symbol:"\ud83d\udd65"},{symbol:"\ud83d\udd66"},{symbol:"\ud83d\udd67"}]},{id:8,code:"FLAGS",showForWindows:false,emoji:[{symbol:"\ud83c\udff3"},{symbol:"\ud83c\udff4"},{symbol:"\ud83c\udfc1"},{symbol:"\ud83d\udea9"},{symbol:"\ud83c\udff3\ufe0f\u200d\ud83c\udf08"},{symbol:"\ud83c\uddfa\ud83c\uddf3"},{symbol:"\ud83c\udde6\ud83c\uddeb"},{symbol:"\ud83c\udde6\ud83c\uddfd"},{symbol:"\ud83c\udde6\ud83c\uddf1"},{symbol:"\ud83c\udde9\ud83c\uddff"},{symbol:"\ud83c\udde6\ud83c\uddf8"},{symbol:"\ud83c\udde6\ud83c\udde9"},{symbol:"\ud83c\udde6\ud83c\uddf4"},{symbol:"\ud83c\udde6\ud83c\uddee"},{symbol:"\ud83c\udde6\ud83c\uddf6"},{symbol:"\ud83c\udde6\ud83c\uddec"},{symbol:"\ud83c\udde6\ud83c\uddf7"},{symbol:"\ud83c\udde6\ud83c\uddf2"},{symbol:"\ud83c\udde6\ud83c\uddfc"},{symbol:"\ud83c\udde6\ud83c\uddfa"},{symbol:"\ud83c\udde6\ud83c\uddf9"},{symbol:"\ud83c\udde6\ud83c\uddff"},{symbol:"\ud83c\udde7\ud83c\uddf8"},{symbol:"\ud83c\udde7\ud83c\udded"},{symbol:"\ud83c\udde7\ud83c\udde9"},{symbol:"\ud83c\udde7\ud83c\uddfe"},{symbol:"\ud83c\udde7\ud83c\uddea"},{symbol:"\ud83c\udde7\ud83c\uddff"},{symbol:"\ud83c\udde7\ud83c\uddef"},{symbol:"\ud83c\udde7\ud83c\uddf2"},{symbol:"\ud83c\udde7\ud83c\uddf9"},{symbol:"\ud83c\udde7\ud83c\uddf4"},{symbol:"\ud83c\udde7\ud83c\udde6"},{symbol:"\ud83c\udde7\ud83c\uddfc"},{symbol:"\ud83c\udde7\ud83c\uddf7"},{symbol:"\ud83c\uddee\ud83c\uddf4"},{symbol:"\ud83c\uddfb\ud83c\uddec"},{symbol:"\ud83c\udde7\ud83c\uddf3"},{symbol:"\ud83c\udde7\ud83c\uddec"},{symbol:"\ud83c\udde7\ud83c\uddeb"},{symbol:"\ud83c\udde7\ud83c\uddee"},{symbol:"\ud83c\uddf0\ud83c\udded"},{symbol:"\ud83c\udde8\ud83c\uddf2"},{symbol:"\ud83c\udde8\ud83c\udde6"},{symbol:"\ud83c\uddee\ud83c\udde8"},{symbol:"\ud83c\udde8\ud83c\uddfb"},{symbol:"\ud83c\udde7\ud83c\uddf6"},{symbol:"\ud83c\uddf0\ud83c\uddfe"},{symbol:"\ud83c\udde8\ud83c\uddeb"},{symbol:"\ud83c\uddf9\ud83c\udde9"},{symbol:"\ud83c\udde8\ud83c\uddf1"},{symbol:"\ud83c\udde8\ud83c\uddf3"},{symbol:"\ud83c\udde8\ud83c\uddfd"},{symbol:"\ud83c\udde8\ud83c\uddf4"},{symbol:"\ud83c\uddf0\ud83c\uddf2"},{symbol:"\ud83c\udde8\ud83c\uddec"},{symbol:"\ud83c\udde8\ud83c\udde9"},{symbol:"\ud83c\udde8\ud83c\uddf0"},{symbol:"\ud83c\udde8\ud83c\uddf7"},{symbol:"\ud83c\udde8\ud83c\uddee"},{symbol:"\ud83c\udded\ud83c\uddf7"},{symbol:"\ud83c\udde8\ud83c\uddfa"},{symbol:"\ud83c\udde8\ud83c\uddfc"},{symbol:"\ud83c\udde8\ud83c\uddfe"},{symbol:"\ud83c\udde8\ud83c\uddff"},{symbol:"\ud83c\udde9\ud83c\uddf0"},{symbol:"\ud83c\udde9\ud83c\uddef"},{symbol:"\ud83c\udde9\ud83c\uddf2"},{symbol:"\ud83c\udde9\ud83c\uddf4"},{symbol:"\ud83c\uddea\ud83c\udde8"},{symbol:"\ud83c\uddea\ud83c\uddec"},{symbol:"\ud83c\uddf8\ud83c\uddfb"},{symbol:"\ud83c\uddec\ud83c\uddf6"},{symbol:"\ud83c\uddea\ud83c\uddf7"},{symbol:"\ud83c\uddea\ud83c\uddf9"},{symbol:"\ud83c\uddea\ud83c\uddfa"},{symbol:"\ud83c\uddeb\ud83c\uddf0"},{symbol:"\ud83c\uddeb\ud83c\uddf4"},{symbol:"\ud83c\uddeb\ud83c\uddef"},{symbol:"\ud83c\uddeb\ud83c\uddee"},{symbol:"\ud83c\uddeb\ud83c\uddf7"},{symbol:"\ud83c\uddec\ud83c\uddeb"},{symbol:"\ud83c\uddf5\ud83c\uddeb"},{symbol:"\ud83c\uddec\ud83c\udde6"},{symbol:"\ud83c\uddec\ud83c\uddf2"},{symbol:"\ud83c\uddec\ud83c\uddea"},{symbol:"\ud83c\udde9\ud83c\uddea"},{symbol:"\ud83c\uddec\ud83c\udded"},{symbol:"\ud83c\uddec\ud83c\uddee"},{symbol:"\ud83c\uddec\ud83c\uddf7"},{symbol:"\ud83c\uddec\ud83c\uddf1"},{symbol:"\ud83c\uddec\ud83c\udde9"},{symbol:"\ud83c\uddec\ud83c\uddf5"},{symbol:"\ud83c\uddec\ud83c\uddfa"},{symbol:"\ud83c\uddec\ud83c\uddf9"},{symbol:"\ud83c\uddec\ud83c\uddf3"},{symbol:"\ud83c\uddec\ud83c\uddfc"},{symbol:"\ud83c\uddec\ud83c\uddfe"},{symbol:"\ud83c\udded\ud83c\uddf9"},{symbol:"\ud83c\udded\ud83c\uddf3"},{symbol:"\ud83c\udded\ud83c\uddf0"},{symbol:"\ud83c\udded\ud83c\uddfa"},{symbol:"\ud83c\uddee\ud83c\uddf8"},{symbol:"\ud83c\uddee\ud83c\uddf3"},{symbol:"\ud83c\uddee\ud83c\udde9"},{symbol:"\ud83c\uddee\ud83c\uddf7"},{symbol:"\ud83c\uddee\ud83c\uddf6"},{symbol:"\ud83c\uddee\ud83c\uddea"},{symbol:"\ud83c\uddee\ud83c\uddf2"},{symbol:"\ud83c\uddee\ud83c\uddf1"},{symbol:"\ud83c\uddee\ud83c\uddf9"},{symbol:"\ud83c\uddef\ud83c\uddf2"},{symbol:"\ud83c\uddef\ud83c\uddf5"},{symbol:"\ud83c\uddef\ud83c\uddea"},{symbol:"\ud83c\uddef\ud83c\uddf4"},{symbol:"\ud83c\uddf0\ud83c\uddff"},{symbol:"\ud83c\uddf0\ud83c\uddea"},{symbol:"\ud83c\uddf0\ud83c\uddee"},{symbol:"\ud83c\uddfd\ud83c\uddf0"},{symbol:"\ud83c\uddf0\ud83c\uddfc"},{symbol:"\ud83c\uddf0\ud83c\uddec"},{symbol:"\ud83c\uddf1\ud83c\udde6"},{symbol:"\ud83c\uddf1\ud83c\uddfb"},{symbol:"\ud83c\uddf1\ud83c\udde7"},{symbol:"\ud83c\uddf1\ud83c\uddf8"},{symbol:"\ud83c\uddf1\ud83c\uddf7"},{symbol:"\ud83c\uddf1\ud83c\uddfe"},{symbol:"\ud83c\uddf1\ud83c\uddee"},{symbol:"\ud83c\uddf1\ud83c\uddf9"},{symbol:"\ud83c\uddf1\ud83c\uddfa"},{symbol:"\ud83c\uddf2\ud83c\uddf4"},{symbol:"\ud83c\uddf2\ud83c\uddf0"},{symbol:"\ud83c\uddf2\ud83c\uddec"},{symbol:"\ud83c\uddf2\ud83c\uddfc"},{symbol:"\ud83c\uddf2\ud83c\uddfe"},{symbol:"\ud83c\uddf2\ud83c\uddfb"},{symbol:"\ud83c\uddf2\ud83c\uddf1"},{symbol:"\ud83c\uddf2\ud83c\uddf9"},{symbol:"\ud83c\uddf2\ud83c\udded"},{symbol:"\ud83c\uddf2\ud83c\uddf7"},{symbol:"\ud83c\uddf2\ud83c\uddfa"},{symbol:"\ud83c\uddfe\ud83c\uddf9"},{symbol:"\ud83c\uddf2\ud83c\uddfd"},{symbol:"\ud83c\uddeb\ud83c\uddf2"},{symbol:"\ud83c\uddf2\ud83c\udde9"},{symbol:"\ud83c\uddf2\ud83c\udde8"},{symbol:"\ud83c\uddf2\ud83c\uddf3"},{symbol:"\ud83c\uddf2\ud83c\uddea"},{symbol:"\ud83c\uddf2\ud83c\uddf8"},{symbol:"\ud83c\uddf2\ud83c\udde6"},{symbol:"\ud83c\uddf2\ud83c\uddff"},{symbol:"\ud83c\uddf3\ud83c\udde6"},{symbol:"\ud83c\uddf3\ud83c\uddf7"},{symbol:"\ud83c\uddf3\ud83c\uddf5"},{symbol:"\ud83c\uddf3\ud83c\uddf1"},{symbol:"\ud83c\uddf3\ud83c\udde8"},{symbol:"\ud83c\uddf3\ud83c\uddff"},{symbol:"\ud83c\uddf3\ud83c\uddee"},{symbol:"\ud83c\uddf3\ud83c\uddea"},{symbol:"\ud83c\uddf3\ud83c\uddec"},{symbol:"\ud83c\uddf3\ud83c\uddfa"},{symbol:"\ud83c\uddf3\ud83c\uddeb"},{symbol:"\ud83c\uddf0\ud83c\uddf5"},{symbol:"\ud83c\uddf2\ud83c\uddf5"},{symbol:"\ud83c\uddf3\ud83c\uddf4"},{symbol:"\ud83c\uddf4\ud83c\uddf2"},{symbol:"\ud83c\uddf5\ud83c\uddf0"},{symbol:"\ud83c\uddf5\ud83c\uddfc"},{symbol:"\ud83c\uddf5\ud83c\uddf8"},{symbol:"\ud83c\uddf5\ud83c\udde6"},{symbol:"\ud83c\uddf5\ud83c\uddec"},{symbol:"\ud83c\uddf5\ud83c\uddfe"},{symbol:"\ud83c\uddf5\ud83c\uddea"},{symbol:"\ud83c\uddf5\ud83c\udded"},{symbol:"\ud83c\uddf5\ud83c\uddf3"},{symbol:"\ud83c\uddf5\ud83c\uddf1"},{symbol:"\ud83c\uddf5\ud83c\uddf9"},{symbol:"\ud83c\uddf5\ud83c\uddf7"},{symbol:"\ud83c\uddf6\ud83c\udde6"},{symbol:"\ud83c\uddf7\ud83c\uddf4"},{symbol:"\ud83c\uddf7\ud83c\uddfa"},{symbol:"\ud83c\uddf7\ud83c\uddfc"},{symbol:"\ud83c\uddfc\ud83c\uddf8"},{symbol:"\ud83c\uddf8\ud83c\uddf2"},{symbol:"\ud83c\uddf8\ud83c\uddf9"},{symbol:"\ud83c\uddf8\ud83c\udde6"},{symbol:"\ud83c\uddf8\ud83c\uddf3"},{symbol:"\ud83c\uddf7\ud83c\uddf8"},{symbol:"\ud83c\uddf8\ud83c\udde8"},{symbol:"\ud83c\uddf8\ud83c\uddf1"},{symbol:"\ud83c\uddf8\ud83c\uddec"},{symbol:"\ud83c\uddf8\ud83c\uddfd"},{symbol:"\ud83c\uddf8\ud83c\uddf0"},{symbol:"\ud83c\uddf8\ud83c\uddee"},{symbol:"\ud83c\uddec\ud83c\uddf8"},{symbol:"\ud83c\uddf8\ud83c\udde7"},{symbol:"\ud83c\uddf8\ud83c\uddf4"},{symbol:"\ud83c\uddff\ud83c\udde6"},{symbol:"\ud83c\uddf0\ud83c\uddf7"},{symbol:"\ud83c\uddea\ud83c\uddf8"},{symbol:"\ud83c\uddf1\ud83c\uddf0"},{symbol:"\ud83c\uddf8\ud83c\udded"},{symbol:"\ud83c\uddf0\ud83c\uddf3"},{symbol:"\ud83c\uddf1\ud83c\udde8"},{symbol:"\ud83c\uddf5\ud83c\uddf2"},{symbol:"\ud83c\uddfb\ud83c\udde8"},{symbol:"\ud83c\uddf8\ud83c\udde9"},{symbol:"\ud83c\uddf8\ud83c\uddf7"},{symbol:"\ud83c\uddf8\ud83c\uddff"},{symbol:"\ud83c\uddf8\ud83c\uddea"},{symbol:"\ud83c\udde8\ud83c\udded"},{symbol:"\ud83c\uddf8\ud83c\uddfe"},{symbol:"\ud83c\uddf9\ud83c\uddfc"},{symbol:"\ud83c\uddf9\ud83c\uddef"},{symbol:"\ud83c\uddf9\ud83c\uddff"},{symbol:"\ud83c\uddf9\ud83c\udded"},{symbol:"\ud83c\uddf9\ud83c\uddf1"},{symbol:"\ud83c\uddf9\ud83c\uddec"},{symbol:"\ud83c\uddf9\ud83c\uddf0"},{symbol:"\ud83c\uddf9\ud83c\uddf4"},{symbol:"\ud83c\uddf9\ud83c\uddf3"},{symbol:"\ud83c\uddf9\ud83c\uddf7"},{symbol:"\ud83c\uddf9\ud83c\uddf2"},{symbol:"\ud83c\uddf9\ud83c\udde8"},{symbol:"\ud83c\uddf9\ud83c\uddfb"},{symbol:"\ud83c\uddfb\ud83c\uddee"},{symbol:"\ud83c\uddfa\ud83c\uddec"},{symbol:"\ud83c\uddfa\ud83c\udde6"},{symbol:"\ud83c\udde6\ud83c\uddea"},{symbol:"\ud83c\uddec\ud83c\udde7"},{symbol:"\ud83c\uddfa\ud83c\uddf8"},{symbol:"\ud83c\uddfa\ud83c\uddfe"},{symbol:"\ud83c\uddfa\ud83c\uddff"},{symbol:"\ud83c\uddfb\ud83c\uddfa"},{symbol:"\ud83c\uddfb\ud83c\udde6"},{symbol:"\ud83c\uddfb\ud83c\uddea"},{symbol:"\ud83c\uddfb\ud83c\uddf3"},{symbol:"\ud83c\uddfc\ud83c\uddeb"},{symbol:"\ud83c\uddea\ud83c\udded"},{symbol:"\ud83c\uddfe\ud83c\uddea"},{symbol:"\ud83c\uddff\ud83c\uddf2"},{symbol:"\ud83c\uddff\ud83c\uddfc"}]}];const De="\ud83d\ude0d";const Ue={name:"SmilesContent",props:{dialogId:{type:String,required:true}},emits:["close"],data(){return{smiles:[],sets:[],recentEmoji:new Set,selectedSetId:""}},computed:{categoryTitles(){const t=Oe.reduce(((t,e)=>{const s=`IM_TEXTAREA_EMOJI_CATEGORY_`;const i=it.Loc.getMessage(`${s}${e.code}`);return{...t,[e.code]:i}}),{});t[this.frequentlyUsedLoc]=it.Loc.getMessage(this.frequentlyUsedLoc);return t},visibleSmiles(){const t=this.smiles.filter((t=>t.setId===this.selectedSetId&&t.alternative!==false));return t},visibleRecentEmoji(){const t=[...this.recentEmoji];return t.slice(0,this.maxRecentEmoji)},lastSelectedSetId(){const t=this.sets.find((t=>!!t.selected));if(!t){return this.emojiSetTitle}return t.id}},created(){const t=h.SmileManager.getInstance();if(!t.smileList){return}const{sets:e,smiles:s}=t.smileList;this.sets=e;this.smiles=s;this.emojiSetTitle="emoji";this.selectedSetId=this.lastSelectedSetId;this.emoji=Oe;this.recentEmoji=new Set(t.recentEmoji);this.defaultEmojiIcon=De;this.maxRecentEmoji=18;this.frequentlyUsedLoc="IM_TEXTAREA_EMOJI_CATEGORY_FREQUENTLY"},beforeUnmount(){const t=h.SmileManager.getInstance();if(this.lastSelectedSetId!==this.selectedSetId){t.updateSelectedSet(this.selectedSetId)}if(this.visibleRecentEmoji.length>t.recentEmoji.size){t.updateRecentEmoji(new Set(this.recentEmoji))}},methods:{calculateRatioSize(t){const e=1.75;const s=`${t.width*e}px`;const i=`${t.height*e}px`;return{width:s,height:i}},onSmileClick(t,e){this.getEmitter().emit(st.EventType.textarea.insertText,{text:t,dialogId:this.dialogId});if(!ct.Utils.key.isAltOrOption(e)){this.$emit("close")}},onEmojiClick(t,e){this.onSmileClick(t,e);this.addEmojiToRecent(t)},addEmojiToRecent(t){this.recentEmoji.add(t)},getEmitter(){return this.$Bitrix.eventEmitter}},template:`\n\t\t<div class="bx-im-smiles-content__scope">\n\t\t\t<div class="bx-im-smiles-content__smiles-box">\n\t\t\t\t<img\n\t\t\t\t\tv-for="smile in visibleSmiles"\n\t\t\t\t\t:key="smile.id"\n\t\t\t\t\t:src="smile.image"\n\t\t\t\t\t:title="smile.name ?? smile.typing"\n\t\t\t\t\t:style="calculateRatioSize(smile)"\n\t\t\t\t\t:alt="smile.typing"\n\t\t\t\t\tclass="bx-im-smiles-content__smiles-box_smile"\n\t\t\t\t\t@click="onSmileClick(smile.typing, $event)"\n\t\t\t\t/>\n\t\t\t\t<template v-if="visibleSmiles.length === 0 && selectedSetId === emojiSetTitle">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if="recentEmoji.size > 0"\n\t\t\t\t\t\tclass="bx-im-smiles-content__smiles-box_category"\n\t\t\t\t\t\tkey="frequently-used"\n\t\t\t\t\t>\n\t\t\t\t\t\t<p class="bx-im-smiles-content__smiles-box_category-title">\n\t\t\t\t\t\t\t{{categoryTitles[frequentlyUsedLoc]}}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-for="symbol in visibleRecentEmoji"\n\t\t\t\t\t\t\tclass="bx-im-smiles-content__smiles-box_category-emoji"\n\t\t\t\t\t\t\trole="img"\n\t\t\t\t\t\t\t:key="'recent-'+ symbol"\n\t\t\t\t\t\t\t@click="onSmileClick(symbol, $event)"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{symbol}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-for="category in emoji"\n\t\t\t\t\t\t:key="category.id"\n\t\t\t\t\t\tclass="bx-im-smiles-content__smiles-box_category"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template v-if="category.showForWindows ?? true">\n\t\t\t\t\t\t\t<p class="bx-im-smiles-content__smiles-box_category-title">\n\t\t\t\t\t\t\t\t{{categoryTitles[category.code]}}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tv-for="element in category.emoji"\n\t\t\t\t\t\t\t\t:key="element.symbol"\n\t\t\t\t\t\t\t\tclass="bx-im-smiles-content__smiles-box_category-emoji"\n\t\t\t\t\t\t\t\trole="img"\n\t\t\t\t\t\t\t\t@click="onEmojiClick(element.symbol, $event)"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{element.symbol}}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t\t<div class="bx-im-smiles-content__sets">\n\t\t\t\t<span\n\t\t\t\t\tv-for="set in sets" :key="set.id"\n\t\t\t\t\tclass="bx-im-smiles-content__sets_set --img"\n\t\t\t\t\t:class="{\n\t\t\t\t\t\t'--selected': selectedSetId === set.id\n\t\t\t\t\t}"\n\t\t\t\t\t:title="set.name"\n\t\t\t\t\t@click="selectedSetId = set.id"\n\t\t\t\t>\n\t\t\t\t\t<img :src="set.image" />\n\t\t\t\t</span>\n\t\t\t\t<span\n\t\t\t\t\tclass="bx-im-smiles-content__sets_set --emoji"\n\t\t\t\t\t:class="{\n\t\t\t\t\t\t'--selected': selectedSetId === emojiSetTitle\n\t\t\t\t\t}"\n\t\t\t\t\t@click="selectedSetId = emojiSetTitle"\n\t\t\t\t>\n\t\t\t\t\t{{defaultEmojiIcon}}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t`};const Ne=15;class $e{constructor(){this.pageNumber=1;this.hasMoreItemsToLoad=true}getPopular(){return X.runAction(st.RestMethod.imBotGiphyListPopular,{}).catch((([t])=>{console.error("GiphyLoadService error",t);throw t}))}async getQuery(t,e){if(e){this.pageNumber++}else{this.pageNumber=1;this.hasMoreItemsToLoad=true}const s={data:{filter:{search:t},limit:Ne,offset:this.pageNumber*Ne}};const i=await X.runAction(st.RestMethod.imBotGiphyList,s).catch((([t])=>{console.error("GiphyLoadService error",t);throw t}));if(i.length<Ne){this.hasMoreItemsToLoad=false}return i}}const je=Object.freeze({open:"[url]",close:"[/url]"});const Xe={name:"GiphyContent",components:{Loader:Y.Loader,Spinner:Y.Spinner},props:{dialogId:{type:String,required:true}},emits:["close"],data(){return{searchQuery:"",gifList:[],popularGifList:[],isSearching:false,isLoading:false,isError:false,needBottomShadow:true}},computed:{itemsReceived(){return this.popularGifList.length>0},SpinnerSize:()=>Y.SpinnerSize,SpinnerColor:()=>Y.SpinnerColor,errorText(){if(this.gifList.length===0){return this.loc("IM_TEXTAREA_GIPHY_EMPTY_STATE")}if(this.isError){return this.loc("IM_TEXTAREA_GIPHY_UNAVAILABLE_STATE")}return""},errorClass(){return this.gifList.length===0||this.isError?"--is-error":""},showInputClearButton(){return this.searchQuery.length>0&&!this.isSearching},trimmedQuery(){return this.searchQuery.trim()}},created(){this.loadPopular();this.loadQueryWithDebounce=it.Runtime.debounce(this.loadQueryList,500,this)},methods:{handleResponse(t){this.isSearching=false;this.scrollToTop();this.gifList=t.length>0?t:[]},loadPopular(){this.getGifService().getPopular().then((t=>{this.popularGifList=t.length>0?t:[];this.handleResponse(this.popularGifList)})).catch((()=>{this.isError=true}))},loadQueryList(t,e){this.getGifService().getQuery(t,e).then((t=>{this.handleResponse(t)})).catch((()=>{this.isError=true}))},loc(t){return this.$Bitrix.Loc.getMessage(t)},getGifService(){if(!this.giphyLoader){this.giphyLoader=new $e}return this.giphyLoader},getSendingService(){if(!this.sendingService){this.sendingService=f.SendingService.getInstance()}return this.sendingService},onGifClick(t){const e=`${je.open}${t.original}${je.close}`;this.getSendingService().sendMessage({text:e,dialogId:this.dialogId});this.$emit("close")},onInputUpdate(){if(this.trimmedQuery.length>=3){this.isSearching=true;this.loadQueryWithDebounce(this.trimmedQuery,false)}if(this.trimmedQuery.length===0){this.gifList=this.popularGifList}},onInputClearClick(){this.searchQuery="";this.scrollToTop();this.onInputUpdate()},onEnterKeyPress(){if(this.gifList.length>0&&!this.isSearching){const t=this.gifList[0];this.onGifClick(t)}},needToLoadNextPage(t){return t.target.scrollTop+t.target.clientHeight>=t.target.scrollHeight-t.target.clientHeight},onScroll(t){this.needBottomShadow=t.target.scrollTop+t.target.clientHeight!==t.target.scrollHeight;if(this.isLoading){return}if(this.trimmedQuery.length===0){return}if(!this.needToLoadNextPage(t)||!this.getGifService().hasMoreItemsToLoad){return}this.isLoading=true;this.getGifService().getQuery(this.trimmedQuery,true).then((t=>{this.isLoading=false;this.gifList.push(...t)})).catch((()=>{this.isLoading=false;this.isError=true}))},scrollToTop(){const t=this.$refs.gifsContainer;if(t){t.scrollTop=0}},openHelpArticle(){const t="17942324";c.openHelpdeskArticle(t)}},template:`\n\t\t<div class="bx-im-smiles-content__scope bx-im-smile-popup-giphy-content__container">\n\t\t\t<div \n\t\t\t\tv-if="!itemsReceived" \n\t\t\t\tclass="bx-im-smiles-content-popup__loader"\n\t\t\t>\n\t\t\t\t<Spinner :color="SpinnerColor.blue" :size="SpinnerSize.S" />\n\t\t\t</div>\n\t\t\t<template v-else>\n\t\t\t\t<div \n\t\t\t\t\tv-if="itemsReceived"\n\t\t\t\t \tclass="bx-im-smile-popup-search-input__container"\n\t\t\t\t>\n\t\t\t\t\t<div class="bx-im-smile-popup-giphy-content__search-icon"></div>\n\t\t\t\t\t<input\n\t\t\t\t\t\t@input="onInputUpdate"\n\t\t\t\t\t\t@keydown.enter="onEnterKeyPress"\n\t\t\t\t\t\tv-model="searchQuery"\n\t\t\t\t\t\tclass="bx-im-smile-popup-giphy-content__input bx-im-smile-popup-search-input__element"\n\t\t\t\t\t\t:placeholder="loc('IM_TEXTAREA_GIPHY_INPUT_PLACEHOLDER')"\n\t\t\t\t\t/>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if="showInputClearButton"\n\t\t\t\t\t\tclass="bx-im-smile-popup-search-input__clear"\n\t\t\t\t\t\t@click="onInputClearClick"\n\t\t\t\t\t ></div>\n\t\t\t\t\t<div v-show="isSearching" class="bx-im-smile-popup-search-input__loader">\n\t\t\t\t\t\t<Spinner :color="SpinnerColor.grey" :size="SpinnerSize.XXS" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div \n\t\t\t\t\tclass="bx-im-smiles-content__smiles-box bx-im-smiles-content__gifs-box"\n\t\t\t\t \t:class="errorClass"\n\t\t\t\t \tref="gifsContainer"\n\t\t\t\t\t@scroll="onScroll"\n\t\t\t\t>\n\t\t\t\t\t<div \n\t\t\t\t\t\tv-if="gifList.length === 0" \n\t\t\t\t\t\tclass="bx-im-smiles-content__gifs-empty"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class="bx-im-smiles-content__gifs-empty_icon bx-im-messenger__search-icon --size-large"></div>\n\t\t\t\t\t\t<div class="bx-im-smiles-content__gifs-empty_title">\n\t\t\t\t\t\t\t{{ errorText }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div \n\t\t\t\t\t\tv-else-if="isError" \n\t\t\t\t\t\tclass="bx-im-smiles-content__gifs-empty"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tv-if="isError" \n\t\t\t\t\t\t\tclass="bx-im-smiles-content__gifs-warning_icon"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t\t<div class="bx-im-smiles-content__gifs-empty_title">\n\t\t\t\t\t\t\t{{ errorText }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div @click="openHelpArticle" class="bx-im-smiles-content__gifs-empty_link">\n\t\t\t\t\t\t\t{{ loc('IM_TEXTAREA_GIPHY_MORE') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div v-for="item in gifList" class="bx-im-smiles-content__gifs-item" :key="item.preview">\n\t\t\t\t\t\t\t<img @click="onGifClick(item)" class="bx-im-smiles-content__gifs-item_img"\n\t\t\t\t\t\t\t\t :src="item.preview"\n\t\t\t\t\t\t\t\t :data-original="item.original" alt="gif"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<div :class="needBottomShadow ? '' : '--is-hidden'" class="bx-im-smiles-content__gifs-gradient"></div>\n\t\t\t\t\t<Loader v-show="isLoading && !isError" class="bx-im-sidebar-detail__loader-container" />\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`};const ze={name:"SmilePopupMarketContent",components:{Spinner:Y.Spinner},props:{entityId:{type:String,required:true},dialogId:{type:String,required:true}},emits:["close"],data(){return{isLoading:true,handleResult:true}},computed:{SpinnerSize:()=>Y.SpinnerSize},watch:{entityId(t){this.isLoading=true;this.load(t)}},created(){this.marketManager=Z.MarketManager.getInstance()},mounted(){this.load(this.entityId)},beforeUnmount(){this.handleResult=false},methods:{load(t){const e={dialogId:this.dialogId};this.marketManager.loadPlacement(t,e).then((e=>{if(!this.handleResult||this.entityId!==t){return}it.Runtime.html(this.$refs["im-messenger-smile-selector-placement"],e)})).finally((()=>{this.isLoading=false}))},onClose(){this.handleResult=false;this.$emit("close")}},template:`\n\t\t<div class="bx-im-smile-popup-market-content__container">\n\t\t\t<div v-if="isLoading" class="bx-im-smile-popup-market-content__loader-container">\n\t\t\t\t<Spinner :size="SpinnerSize.S"/>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\tv-show="!isLoading"\n\t\t\t\tclass="bx-im-smile-popup-market-content__placement-container"\n\t\t\t\tref="im-messenger-smile-selector-placement"\n\t\t\t></div>\n\t\t</div>\n\t`};const qe=Object.freeze({default:"default",market:"market",giphy:"giphy"});const Ke={name:"SmilePopup",components:{MessengerPopup:lt.MessengerPopup,TabSmiles:Ue,TabGiphy:Xe,TabMarket:ze,MessengerTabs:m.MessengerTabs},props:{bindElement:{type:Object,required:true},dialogId:{type:String,required:true}},emits:["close"],data(){return{currentTab:qe.default,currentEntityId:""}},computed:{TabsColorScheme:()=>m.TabsColorScheme,TabType:()=>qe,popupConfig(){return{width:320,bindElement:this.bindElement,bindOptions:{position:"top"},offsetTop:25,offsetLeft:-110,padding:0}},marketMenuItems(){return Z.MarketManager.getInstance().getAvailablePlacementsByType(st.PlacementType.smilesSelector,this.dialogId)},isGiphyAvailable(){return O.FeatureManager.isFeatureAvailable(O.Feature.giphyAvailable)},tabs(){const t=[this.smilesTab];if(this.isGiphyAvailable){t.push(this.giphyTab)}return[...t,...this.marketTabs]},smilesTab(){return{id:1,title:this.$Bitrix.Loc.getMessage("IM_TEXTAREA_SMILE_SELECTOR_SMILES_TAB"),type:qe.default}},giphyTab(){return{id:1,title:"Giphy",type:qe.giphy}},marketTabs(){return this.marketMenuItems.map((t=>({id:t.id,title:t.title,type:qe.market})))}},methods:{tabSelect(t){this.currentTab=t.type;this.currentEntityId=t.id}},template:`\n\t\t<MessengerPopup\n\t\t\t:config="popupConfig"\n\t\t\t@close="$emit('close')"\n\t\t\tid="im-smiles-popup"\n\t\t>\n\t\t\t<div class="bx-im-smile-popup__container bx-im-smile-popup__scope">\n\t\t\t\t<div class="bx-im-smile-popup__tabs-container">\n\t\t\t\t\t<MessengerTabs :colorScheme="TabsColorScheme.gray" :tabs="tabs" @tabSelect="tabSelect"  />\n\t\t\t\t</div>\n\t\t\t\t<TabSmiles v-show="currentTab === TabType.default" :dialogId="dialogId" @close="$emit('close')" />\n\t\t\t\t<TabGiphy v-if="isGiphyAvailable" v-show="currentTab === TabType.giphy" @close="$emit('close')" :dialogId="dialogId" />\n\t\t\t\t<TabMarket v-if="currentTab === TabType.market" :entityId="currentEntityId" :dialogId="dialogId" />\n\t\t\t</div>\n\t\t</MessengerPopup>\n\t`};const Ge=24;const Ve={name:"SmileSelector",components:{BIcon:mt.BIcon,SmilePopup:Ke},props:{dialogId:{type:String,required:true}},data(){return{showPopup:false}},computed:{OutlineIcons:()=>mt.Outline,ICON_SIZE:()=>Ge,iconColor(){if(this.showPopup){return st.Color.accentBlue}return st.Color.gray40}},methods:{loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div ref="addSmile" class="bx-im-textarea__icon-container">\n\t\t\t<BIcon\n\t\t\t\t:name="OutlineIcons.SMILE"\n\t\t\t\t:title="loc('IM_TEXTAREA_ICON_SMILE')"\n\t\t\t\t:size="ICON_SIZE"\n\t\t\t\t:color="iconColor"\n\t\t\t\tclass="bx-im-textarea__icon"\n\t\t\t\t@click="showPopup = true"\n\t\t\t/>\n\t\t</div>\n\t\t<SmilePopup\n\t\t\tv-if="showPopup"\n\t\t\t:bindElement="$refs['addSmile']"\n\t\t\t:dialogId="dialogId"\n\t\t\t@close="showPopup = false"\n\t\t/>\n\t`};const We={name:"TabEmoji",props:{dialogId:{type:String,required:true}},data(){return{recentEmoji:new Set}},computed:{categoryTitles(){const t=Oe.reduce(((t,e)=>{const s="IM_TEXTAREA_EMOJI_CATEGORY_";const i=it.Loc.getMessage(`${s}${e.code}`);return{...t,[e.code]:i}}),{});t[this.frequentlyUsedLoc]=it.Loc.getMessage(this.frequentlyUsedLoc);return t},visibleRecentEmoji(){const t=[...this.recentEmoji];return t.slice(0,this.maxRecentEmoji)}},created(){const t=h.SmileManager.getInstance();if(!t.recentEmoji){return}this.emojiSetTitle="emoji";this.emoji=Oe;this.recentEmoji=new Set(t.recentEmoji);this.maxRecentEmoji=18;this.frequentlyUsedLoc="IM_TEXTAREA_EMOJI_CATEGORY_FREQUENTLY"},beforeUnmount(){const t=h.SmileManager.getInstance();if(this.visibleRecentEmoji.length>t.recentEmoji.size){t.updateRecentEmoji(new Set(this.recentEmoji))}},methods:{insertInTextarea(t){this.getEmitter().emit(st.EventType.textarea.insertText,{text:t,dialogId:this.dialogId})},onRecentEmojiClick(t){this.insertInTextarea(t)},onEmojiClick(t){this.insertInTextarea(t);this.addEmojiToRecent(t)},addEmojiToRecent(t){this.recentEmoji.add(t)},getEmitter(){return this.$Bitrix.eventEmitter}},template:`\n\t\t<div class="bx-im-emoji-content__scope">\n\t\t\t<div class="bx-im-emoji-content__box">\n\t\t\t\t<div\n\t\t\t\t\tv-if="recentEmoji.size > 0"\n\t\t\t\t\tclass="bx-im-emoji-content__box_category"\n\t\t\t\t\tkey="frequently-used"\n\t\t\t\t>\n\t\t\t\t\t<p class="bx-im-emoji-content__box_category-title">\n\t\t\t\t\t\t{{categoryTitles[frequentlyUsedLoc]}}\n\t\t\t\t\t</p>\n\t\t\t\t\t<span\n\t\t\t\t\t\tv-for="symbol in visibleRecentEmoji"\n\t\t\t\t\t\tclass="bx-im-emoji-content__box_category-emoji"\n\t\t\t\t\t\trole="img"\n\t\t\t\t\t\t:key="'recent-'+ symbol"\n\t\t\t\t\t\t@click="onRecentEmojiClick(symbol)"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{symbol}}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-for="category in emoji"\n\t\t\t\t\t:key="category.id"\n\t\t\t\t\tclass="bx-im-emoji-content__box_category"\n\t\t\t\t>\n\t\t\t\t\t<template v-if="category.showForWindows ?? true">\n\t\t\t\t\t\t<p class="bx-im-emoji-content__box_category-title">\n\t\t\t\t\t\t\t{{categoryTitles[category.code]}}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-for="element in category.emoji"\n\t\t\t\t\t\t\t:key="element.symbol"\n\t\t\t\t\t\t\tclass="bx-im-emoji-content__box_category-emoji"\n\t\t\t\t\t\t\trole="img"\n\t\t\t\t\t\t\t@click="onEmojiClick(element.symbol)"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{element.symbol}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};var Qe=babelHelpers.classPrivateFieldLooseKey("observer");var Ye=babelHelpers.classPrivateFieldLooseKey("visiblePacks");var Ze=babelHelpers.classPrivateFieldLooseKey("initObserver");var Je=babelHelpers.classPrivateFieldLooseKey("getThreshold");var ts=babelHelpers.classPrivateFieldLooseKey("handleIntersection");var es=babelHelpers.classPrivateFieldLooseKey("calculateActivePack");var ss=babelHelpers.classPrivateFieldLooseKey("getPackData");var is=babelHelpers.classPrivateFieldLooseKey("isAtBottom");class os extends g.EventEmitter{constructor(){super();Object.defineProperty(this,is,{value:cs});Object.defineProperty(this,ss,{value:ms});Object.defineProperty(this,es,{value:rs});Object.defineProperty(this,ts,{value:as});Object.defineProperty(this,Je,{value:ls});Object.defineProperty(this,Ze,{value:ns});Object.defineProperty(this,Qe,{writable:true,value:void 0});Object.defineProperty(this,Ye,{writable:true,value:new Map});this.setEventNamespace("BX.Messenger.v2.Textarea.TabStickers");babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze]()}observe(t){babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].observe(t)}unobserve(t){babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe].unobserve(t);babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye].delete(t)}}function ns(){babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe]=new IntersectionObserver((t=>babelHelpers.classPrivateFieldLooseBase(this,ts)[ts](t)),{threshold:babelHelpers.classPrivateFieldLooseBase(this,Je)[Je]()})}function ls(){const t=Array.from({length:11}).fill(0);return t.map(((t,e)=>e*.1))}function as(t){t.forEach((t=>{if(t.isIntersecting){if(!babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye].has(t.target)){babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye].set(t.target,babelHelpers.classPrivateFieldLooseBase(this,ss)[ss](t.target))}}else{babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye].delete(t.target)}}));if(babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye].size>0){babelHelpers.classPrivateFieldLooseBase(this,es)[es]()}}function rs(){const t=Array.from(babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye],(([t,e])=>({element:t,packData:e,top:t.getBoundingClientRect().top})));t.sort(((t,e)=>t.top-e.top));const e=t[0];const s=t[t.length-1];const i=s.element.parentElement;const o=babelHelpers.classPrivateFieldLooseBase(this,is)[is](i)?s.packData:e.packData;this.emit(os.CHANGE_ACTIVE_PACK_EVENT,{id:o.id,type:o.type})}function ms(t){const{packId:e,packType:s}=t.dataset;return{id:Number(e),type:s}}function cs(t){const e=94;const s=Math.floor(t.scrollHeight-t.scrollTop);const i=t.clientHeight+e;return s<=i}os.CHANGE_ACTIVE_PACK_EVENT="changeActivePack";const ds=24;const bs={name:"StickerPack",components:{BIcon:mt.BIcon,StickerPackForm:I.StickerPackForm,PackStickers:I.PackStickers},inject:["disableAutoHide","enableAutoHide"],props:{pack:{type:Object,required:true},dialogId:{type:String,required:true}},emits:["close"],data(){return{showPackForm:false}},computed:{OutlineIcons:()=>mt.Outline,Color:()=>st.Color,ICON_SIZE:()=>ds,canShowContextMenu(){return this.pack.type===st.StickerPackType.custom||this.isRecentPack},isRecentPack(){return this.pack.id===st.RecentPackId&&this.pack.type===st.RecentPackType}},methods:{onStickerClick({sticker:t}){void f.SendingService.getInstance().sendMessageWithSticker({dialogId:this.dialogId,stickerParams:{id:t.id,packId:t.packId,packType:t.packType}});this.$emit("close")},openPackMenu(t){var e;(e=ot.PopupManager.getPopupById(st.PopupType.stickerPackContextMenu))==null?void 0:e.close();if(!this.stickerPackMenu){this.stickerPackMenu=new v.StickerPackMenu;this.stickerPackMenu.subscribe("close",(()=>{if(!this.showPackForm){this.enableAutoHide()}}));this.stickerPackMenu.subscribe("closeParentPopup",(()=>{this.$emit("close")}));this.stickerPackMenu.subscribe("openEditor",(()=>{this.showPackForm=true}))}this.disableAutoHide();this.stickerPackMenu.openMenu({pack:this.pack,isRecent:this.isRecentPack,dialogId:this.dialogId},t.target)},openStickerMenu({event:t,sticker:e}){var s;(s=ot.PopupManager.getPopupById(st.PopupType.stickerContextMenu))==null?void 0:s.close();if(!this.stickerMenu){this.stickerMenu=new v.StickerMenu;this.stickerMenu.subscribe("closeParentPopup",(()=>{this.$emit("close")}));this.stickerMenu.subscribe("close",(()=>{this.enableAutoHide()}))}this.disableAutoHide();this.stickerMenu.openMenu({sticker:e,isRecent:this.isRecentPack,dialogId:this.dialogId},t.target)},loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div class="bx-im-sticker-pack__container">\n\t\t\t<div class="bx-im-sticker-pack__header">\n\t\t\t\t<div class="bx-im-sticker-pack__header-title --ellipsis">\n\t\t\t\t\t{{ pack.name }}\t\n\t\t\t\t</div>\n\t\t\t\t<BIcon\n\t\t\t\t\tv-if="canShowContextMenu"\n\t\t\t\t\t:name="OutlineIcons.MORE_M"\n\t\t\t\t\t:size="ICON_SIZE"\n\t\t\t\t\t:color="Color.gray40"\n\t\t\t\t\t:hoverable="true"\n\t\t\t\t\tclass="bx-im-sticker-pack__header-actions"\n\t\t\t\t\t@click="openPackMenu"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<PackStickers \n\t\t\t\t:pack="pack"\n\t\t\t\tclass="bx-im-sticker-pack__stickers"\n\t\t\t\t@clickSticker="onStickerClick"\n\t\t\t\t@openContextMenuSticker="openStickerMenu"\n\t\t\t/>\n\t\t\t<StickerPackForm v-if="showPackForm" :pack="pack" @close="showPackForm = false" />\n\t\t</div>\n\t`};const ps=2;const hs=8;const us={name:"PackSkeleton",components:{Shimmer:Y.Shimmer},computed:{STICKERS_IN_PACK:()=>hs,PACK_COUNT:()=>ps},template:`\n\t\t<div v-for="pack in PACK_COUNT" :key="pack" class="bx-im-sticker-pack-skeleton__container">\n\t\t\t<div class="bx-im-sticker-pack-skeleton__header">\n\t\t\t\t<Shimmer :width="280" :height="12" />\n\t\t\t</div>\n\t\t\t<div class="bx-im-sticker-pack-skeleton__stickers">\n\t\t\t\t<Shimmer v-for="sticker in STICKERS_IN_PACK" :key="sticker" :width="62" :height="62" />\n\t\t\t</div>\n\t\t</div>\n\t`};const ys={name:"HeaderAddButton",components:{BIcon:mt.BIcon,StickerPackForm:I.StickerPackForm},inject:["disableAutoHide","enableAutoHide"],data(){return{showPackForm:false}},computed:{OutlineIcons:()=>mt.Outline},methods:{onAddClick(){this.disableAutoHide();this.showPackForm=true},onPackFormClose(){this.enableAutoHide();this.showPackForm=false},loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div\n\t\t\tclass="bx-im-stickers-header-add-button__container"\n\t\t\t@click="onAddClick"\n\t\t>\n\t\t\t<BIcon\n\t\t\t\t:name="OutlineIcons.PLUS_S"\n\t\t\t\t:title="loc('IM_TEXTAREA_STICKER_SELECTOR_STICKERS_RECENT')"\n\t\t\t/>\n\t\t\t<StickerPackForm v-if="showPackForm" @close="onPackFormClose" />\n\t\t</div>\n\t`};const gs={name:"HeaderItem",components:{BIcon:mt.BIcon},props:{pack:{type:Object,required:true},isActive:{type:Boolean,required:true}},computed:{OutlineIcons:()=>mt.Outline,isRecentPack(){return this.pack.id===st.RecentPackId&&this.pack.type===st.RecentPackType},packName(){return this.pack.name},packCover(){return this.$store.getters["stickers/getPackCover"]({id:this.pack.id,type:this.pack.type})}},template:`\n\t\t<div \n\t\t\t:title="packName"\n\t\t\t:class="{'--active': this.isActive}" \n\t\t\tclass="bx-im-stickers-header__item" \n\t\t>\n\t\t\t<BIcon\n\t\t\t\tv-if="isRecentPack"\n\t\t\t\t:name="OutlineIcons.CLOCK"\n\t\t\t/>\n\t\t\t<BIcon\n\t\t\t\tv-else-if="!packCover"\n\t\t\t\t:name="OutlineIcons.STICKER"\n\t\t\t/>\n\t\t\t<img v-else :src="packCover" alt="" loading="lazy" draggable="false" />\n\t\t</div>\n\t`};const vs=7;const fs={name:"HeaderSkeleton",components:{Shimmer:Y.Shimmer},computed:{STICKERS_COUNT:()=>vs},template:`\n\t\t<div class="bx-im-stickers-header-skeleton__container">\n\t\t\t<Shimmer v-for="sticker in STICKERS_COUNT" :key="sticker" :width="36" :height="36" />\n\t\t</div>\n\t`};const Is=200;const Ts=52;const Ps={name:"HeaderTabs",components:{HeaderItem:gs,HeaderSkeleton:fs,HeaderAddButton:ys},props:{packs:{type:Array,required:true},activePack:{type:Object,required:true},isLoadingFirstPage:{type:Boolean,required:true},isLoadingNextPage:{type:Boolean,required:true}},emits:["changeActivePack","scrollNextPage"],data(){return{highlightOffsetLeft:Ts}},computed:{isLoading(){return this.isLoadingFirstPage||this.isLoadingNextPage},highlightPositionStyles(){return{left:`${this.highlightOffsetLeft}px`}}},watch:{activePack(t){const e=this.packs.findIndex((e=>e.id===t.id&&e.type===t.type));const s=36;const i=10;this.highlightOffsetLeft=Ts+e*(s+i);void this.$nextTick((()=>{this.scrollToActiveTab(e)}))}},methods:{async onScrollHeader(t){const e=t.target;if(this.isLoading||!this.needToLoad(e,Is)){return}this.$emit("scrollNextPage")},needToLoad(t,e){const s=t.scrollHeight-t.scrollTop-t.clientHeight;return s<=e},isPackActive(t){return t.id===this.activePack.id&&t.type===this.activePack.type},onHeaderPick(t){this.$emit("changeActivePack",{id:t.id,type:t.type})},scrollToActiveTab(t){const e=this.$refs.tabs.children[t+1];e.scrollIntoView({inline:"center",block:"nearest",behavior:"smooth"})},onWheel(t){const{deltaX:e,deltaY:s,shiftKey:i}=t;const o=Math.abs(e);const n=Math.abs(s);const l=o>n||i;if(l){return}t.preventDefault();this.$refs.tabs.scrollLeft+=Number(s)},loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div\n\t\t\tclass="bx-im-sticker-header-tabs__container"\n\t\t\t@scroll="onScrollHeader"\n\t\t\t@wheel="onWheel"\n\t\t\tref="tabs"\n\t\t>\n\t\t\t<HeaderAddButton class="bx-im-sticker-header-tabs__add-button" />\n\t\t\t<template v-if="!isLoadingFirstPage">\n\t\t\t\t<HeaderItem\n\t\t\t\t\tv-for="pack in packs"\n\t\t\t\t\t:key="pack.key"\n\t\t\t\t\t:pack="pack"\n\t\t\t\t\t:isActive="isPackActive(pack)"\n\t\t\t\t\tclass="bx-im-sticker-header-tabs__item"\n\t\t\t\t\t@click="onHeaderPick(pack)"\n\t\t\t\t/>\n\t\t\t\t<div class="bx-im-sticker-header-tabs__highlight-container" :style="highlightPositionStyles">\n\t\t\t\t\t<div class="bx-im-sticker-header-tabs__highlight"></div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<HeaderSkeleton v-if="isLoading" />\n\t\t</div>\n\t`};const _s=500;const Ss={name:"TabStickers",components:{Pack:bs,PackSkeleton:us,HeaderTabs:Ps,Spinner:Y.Spinner,StickerPackForm:I.StickerPackForm},directives:{"pack-observer":{mounted(t,e){e.instance.observer.observe(t)},beforeUnmount(t,e){e.instance.observer.unobserve(t)}}},inject:["disableAutoHide","enableAutoHide"],props:{dialogId:{type:String,required:true}},emits:["close","stickerActions","stickerPackActions"],data(){return{activePack:{id:st.RecentPackId,type:st.RecentPackType},isLoadingFirstPage:true,isLoadingNextPage:false,showSlider:false}},computed:{SpinnerColor:()=>Y.SpinnerColor,SpinnerSize:()=>Y.SpinnerSize,isLoading(){return this.isLoadingFirstPage||this.isLoadingNextPage},recentPack(){return{id:st.RecentPackId,key:`${st.RecentPackId}:${st.RecentPackType}`,type:st.RecentPackType,name:this.loc("IM_TEXTAREA_STICKER_SELECTOR_STICKERS_RECENT"),authorId:null}},packs(){const t=this.$store.getters["stickers/packs/getAddedPacks"];if(this.hasRecentStickers){return[this.recentPack,...t]}return t},hasRecentStickers(){return this.$store.getters["stickers/recent/get"].length>0}},async created(){this.initObserverManager();this.stickerService=u.StickerService.getInstance();await this.stickerService.initFirstPage();this.isLoadingFirstPage=false},methods:{initObserverManager(){this.observer=new os;this.observer.subscribe(os.CHANGE_ACTIVE_PACK_EVENT,(t=>{const{id:e,type:s}=t.getData();this.activePack={id:e,type:s}}))},scrollToPack({id:t,type:e}){const s=this.$refs.packListContainer.querySelector(`[data-pack-type="${e}"][data-pack-id="${t}"]`);if(s&&s.scrollIntoView){s.scrollIntoView({block:"start",behavior:"smooth"})}},needToLoad(t,e){const s=t.scrollHeight-t.scrollTop-t.clientHeight;return s<=e},closeContextMenus(){var t,e;(t=ot.PopupManager.getPopupById(st.PopupType.stickerContextMenu))==null?void 0:t.close();(e=ot.PopupManager.getPopupById(st.PopupType.stickerPackContextMenu))==null?void 0:e.close()},async loadNextPage(){this.isLoadingNextPage=true;await this.stickerService.loadNextPage();this.isLoadingNextPage=false},async onScrollBody(t){this.closeContextMenus();const e=t.target;if(this.isLoading||!this.needToLoad(e,_s)){return}void this.loadNextPage()},loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div class="bx-im-tab-stickers__container">\n\t\t\t<HeaderTabs\n\t\t\t\t:isLoadingFirstPage="isLoadingFirstPage"\n\t\t\t\t:isLoadingNextPage="isLoadingNextPage"\n\t\t\t\t:packs="packs"\n\t\t\t\t:activePack="activePack"\n\t\t\t\t@changeActivePack="scrollToPack"\n\t\t\t\t@scrollNextPage="loadNextPage"\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tclass="bx-im-tab-stickers__packs-container"\n\t\t\t\tref="packListContainer"\n\t\t\t\t@scroll="onScrollBody"\n\t\t\t>\n\t\t\t\t<PackSkeleton v-if="isLoadingFirstPage" />\n\t\t\t\t<template v-else>\n\t\t\t\t\t<Pack\n\t\t\t\t\t\tv-for="pack in packs"\n\t\t\t\t\t\tv-pack-observer\n\t\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t\t:key="pack.key"\n\t\t\t\t\t\t:pack="pack"\n\t\t\t\t\t\t:data-pack-id="pack.id"\n\t\t\t\t\t\t:data-pack-type="pack.type"\n\t\t\t\t\t\t@close="$emit('close')"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t\t<Spinner\n\t\t\t\t\tv-if="isLoadingNextPage"\n\t\t\t\t\t:size="SpinnerSize.XS"\n\t\t\t\t\t:color="SpinnerColor.mainPrimary"\n\t\t\t\t\tclass="bx-im-tab-stickers__loader"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`};const Ms={emoji:"emoji",stickers:"stickers"};const xs={name:"EmotePopup",components:{MessengerPopup:lt.MessengerPopup,TabEmoji:We,TabStickers:Ss,Chip:d.Chip,PulseAnimation:p.PulseAnimation},props:{bindElement:{type:Object,required:true},dialogId:{type:String,required:true}},emits:["close"],data(){return{currentTab:this.getInitialTab(),wasStickerTabOpened:false}},computed:{TabType:()=>Ms,PopupType:()=>st.PopupType,ChipDesign:()=>d.ChipDesign,ChipSize:()=>d.ChipSize,popupConfig(){return{width:365,bindElement:this.bindElement,bindOptions:{position:"top"},offsetTop:25,offsetLeft:-230,padding:0,contentBorderRadius:"18px",background:"transparent"}},needToShowPromo(){return T.PromoManager.getInstance().needToShow(st.PromoId.stickersAvailable)},needToShowPulse(){return this.needToShowPromo&&!this.wasStickerTabOpened}},created(){if(this.needToShowPromo){void T.PromoManager.getInstance().markAsWatched(st.PromoId.stickersAvailable)}},methods:{getInitialTab(){return b.LocalStorageManager.getInstance().get(st.LocalStorageKey.emotePopupTab,Ms.emoji)},loc(t){return this.$Bitrix.Loc.getMessage(t)},selectTab(t){this.currentTab=t;b.LocalStorageManager.getInstance().set(st.LocalStorageKey.emotePopupTab,t);if(t===Ms.stickers){this.wasStickerTabOpened=true}},getChipDesign(t){return this.currentTab===t?d.ChipDesign.Filled:d.ChipDesign.Outline}},template:`\n\t\t<MessengerPopup\n\t\t\t:config="popupConfig"\n\t\t\t:id="PopupType.emoteSelector"\n\t\t\t@close="$emit('close')"\n\t\t>\n\t\t\t<div class="bx-im-emote-popup__container">\n\t\t\t\t<TabEmoji \n\t\t\t\t\tv-show="currentTab === TabType.emoji" \n\t\t\t\t\t:dialogId="dialogId" \n\t\t\t\t/>\n\t\t\t\t<TabStickers \n\t\t\t\t\tv-if="currentTab === TabType.stickers"\n\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t@close="$emit('close')"\n\t\t\t\t/>\n\t\t\t\t<div class="bx-im-emote-popup__buttons-container">\n\t\t\t\t\t<Chip\n\t\t\t\t\t\t:size="ChipSize.Sm"\n\t\t\t\t\t\t:design="getChipDesign(TabType.emoji)"\n\t\t\t\t\t\t:text="loc('IM_TEXTAREA_STICKER_SELECTOR_EMOJI_TAB')"\n\t\t\t\t\t\t:rounded="true"\n\t\t\t\t\t\t@click="selectTab(TabType.emoji)"\n\t\t\t\t\t/>\n\t\t\t\t\t<PulseAnimation\n\t\t\t\t\t\t:showPulse="needToShowPulse"\n\t\t\t\t\t\t:innerSize="65"\n\t\t\t\t\t\t:outerSize="113"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Chip\n\t\t\t\t\t\t\t:size="ChipSize.Sm"\n\t\t\t\t\t\t\t:design="getChipDesign(TabType.stickers)"\n\t\t\t\t\t\t\t:text="loc('IM_TEXTAREA_STICKER_SELECTOR_STICKER_TAB')"\n\t\t\t\t\t\t\t:rounded="true"\n\t\t\t\t\t\t\t@click="selectTab(TabType.stickers)"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</PulseAnimation>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</MessengerPopup>\n\t`};const Es="im-sticker-promo-popup";const ks="bx-im-sticker-promo-popup__container";const As=1e3;const ws={name:"StickersPromoPopup",components:{MessengerPopup:lt.MessengerPopup},props:{bindElement:{type:Object,required:true}},emits:["close"],data(){return{isVisible:false}},computed:{PopupType:()=>st.PopupType,POPUP_ID:()=>Es,popupConfig(){return{bindElement:this.bindElement,className:ks,width:416,height:122,padding:12,overlay:false,offsetLeft:-300,autoHide:true,bindOptions:{position:"bottom"},closeIcon:true,angle:{offset:335,position:"bottom"},animation:"fading",events:{onPopupClose:()=>{void T.PromoManager.getInstance().markAsWatched(st.PromoId.stickersAvailable)}}}}},mounted(){this.timer=setTimeout((()=>{this.isVisible=true}),As)},beforeUnmount(){clearTimeout(this.timer)},methods:{loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<MessengerPopup\n\t\t\tv-if="isVisible"\n\t\t\t:config="popupConfig"\n\t\t\t:id="POPUP_ID"\n\t\t\t@close="$emit('close')"\n\t\t>\n\t\t\t<div class="bx-im-sticker-promo-popup__cover"></div>\n\t\t\t<div class="bx-im-sticker-promo-popup__info">\n\t\t\t\t<div class="bx-im-sticker-promo-popup__title">\n\t\t\t\t\t{{ loc('IM_TEXTAREA_EMOTE_POPUP_PROMO_TITLE') }}\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-im-sticker-promo-popup__description">\n\t\t\t\t\t{{ loc('IM_TEXTAREA_EMOTE_POPUP_PROMO_DESCRIPTION') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</MessengerPopup>\n\t`};const Cs=24;const Ls={name:"EmoteSelector",components:{BIcon:mt.BIcon,EmotePopup:xs,PulseAnimation:p.PulseAnimation,StickersPromoPopup:ws},props:{dialogId:{type:String,required:true}},data(){return{showPopup:false,wasSelectorOpened:false,selectorElement:null}},computed:{OutlineIcons:()=>mt.Outline,ICON_SIZE:()=>Cs,needToShowPromo(){return T.PromoManager.getInstance().needToShow(st.PromoId.stickersAvailable)},needToShowPulse(){return this.needToShowPromo&&!this.wasSelectorOpened},iconColor(){if(this.needToShowPulse){return st.Color.accentBlue}return st.Color.gray40}},mounted(){if(!this.needToShowPromo){return}this.selectorElement=this.$refs.stickerSelectorIcon},methods:{openSelector(){this.showPopup=true;this.wasSelectorOpened=true},loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div ref="stickerSelectorIcon" class="bx-im-textarea__icon-container">\n\t\t\t<PulseAnimation :showPulse="needToShowPulse">\n\t\t\t\t<BIcon\n\t\t\t\t\t:name="OutlineIcons.SMILE"\n\t\t\t\t\t:title="loc('IM_TEXTAREA_ICON_EMOTE')"\n\t\t\t\t\t:size="ICON_SIZE"\n\t\t\t\t\t:color="iconColor"\n\t\t\t\t\tclass="bx-im-textarea__icon"\n\t\t\t\t\t@click="openSelector"\n\t\t\t\t/>\n\t\t\t</PulseAnimation>\n\t\t</div>\n\t\t<EmotePopup\n\t\t\tv-if="showPopup"\n\t\t\t:bindElement="$refs.stickerSelectorIcon"\n\t\t\t:dialogId="dialogId"\n\t\t\t@close="showPopup = false"\n\t\t/>\n\t\t<StickersPromoPopup v-if="selectorElement" :bindElement="selectorElement" />\n\t`};const Fs="im-file-dialog";const Bs={name:"DiskPopup",emits:["close","diskFileSelect"],created(){if(!BX.DiskFileDialog){console.error("Couldn't initialize disk popup");return}this.subscribeEvents();this.open()},beforeUnmount(){this.unsubscribeEvents()},methods:{subscribeEvents(){BX.addCustomEvent(BX.DiskFileDialog,"inited",this.onInited);BX.addCustomEvent(BX.DiskFileDialog,"loadItems",this.onLoadItems)},unsubscribeEvents(){BX.removeCustomEvent(BX.DiskFileDialog,"inited",this.onInited);BX.removeCustomEvent(BX.DiskFileDialog,"loadItems",this.onLoadItems)},onInited(t){if(t!==Fs){return}BX.DiskFileDialog.obCallback[t]={saveButton:(t,e,s)=>{this.$emit("diskFileSelect",{files:s})},popupDestroy:()=>{this.unsubscribeEvents();this.$emit("close")}};BX.DiskFileDialog.openDialog(t)},onLoadItems(t,e){if(e!==Fs){return}BX.DiskFileDialog.target[e]=t.replace("/bitrix/tools/disk/uf.php","/bitrix/components/bitrix/im.messenger/file.ajax.php")},open(){it.ajax({url:`/bitrix/components/bitrix/im.messenger/file.ajax.php?action=selectFile&dialogName=${Fs}`,method:"GET",skipAuthCheck:true,timeout:30})}},template:"<template></template>"};const Rs=24;const Hs="/sign/doc/0/?chat_id=";const Os={components:{BIcon:mt.BIcon,MessengerMenu:S.MessengerMenu,MenuItem:S.MenuItem,DiskPopup:Bs},props:{dialogId:{type:String,required:true}},emits:["fileSelect","diskFileSelect"],data(){return{showMenu:false,showDiskPopup:false}},computed:{OutlineIcons:()=>mt.Outline,ICON_SIZE:()=>Rs,menuItems(){return[{icon:S.MenuItemIcon.file,title:this.loc("IM_TEXTAREA_SELECT_LOCAL_FILE"),clickHandler:this.onSelectLocalFile},{icon:S.MenuItemIcon.b24,title:this.loc("IM_TEXTAREA_SELECT_FILE_FROM_B24"),clickHandler:this.onSelectFromB24},{icon:S.MenuItemIcon.task,title:this.loc("IM_TEXTAREA_SELECT_TASK"),clickHandler:this.onCreateTaskClick},{icon:S.MenuItemIcon.meeting,title:this.loc("IM_TEXTAREA_SELECT_MEETING"),clickHandler:this.onCreateMeetingClick},{icon:S.MenuItemIcon.calendarSlot,title:this.loc("IM_TEXTAREA_SELECT_CALENDAR_SLOT"),clickHandler:this.onCreateCalendarSlotClick,showCondition:()=>this.isCalendarSlotAvailable},{icon:S.MenuItemIcon.documentSign,title:this.loc("IM_TEXTAREA_SELECT_DOCUMENT_SIGN"),clickHandler:this.onCreateDocumentSignClick,showCondition:()=>this.isDocumentSignAvailable},{icon:S.MenuItemIcon.vote,title:this.loc("IM_TEXTAREA_SELECT_VOTE"),clickHandler:this.onCreateVoteClick,showCondition:()=>this.isVoteCreationAvailable}]},availableMenuItems(){return this.menuItems.filter((t=>{if(!it.Type.isFunction(t.showCondition)){return true}return t.showCondition()}))},menuConfig(){return{width:278,bindElement:this.$refs.upload||{},bindOptions:{position:"top"},offsetTop:30,offsetLeft:-10,padding:0}},dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},chatType(){return this.dialog.type},chatId(){return this.dialog.chatId},isDocumentSignAvailable(){const t=O.FeatureManager.isFeatureAvailable(O.Feature.documentSignAvailable);if(!t){return false}return E.PermissionManager.getInstance().canPerformActionByRole(st.ActionByRole.createDocumentSign,this.dialogId)},isCalendarSlotAvailable(){return E.PermissionManager.getInstance().canPerformActionByRole(st.ActionByRole.createCalendarSlots,this.dialogId)},isVoteCreationAvailable(){if(!(_.VoteApplication!=null&&_.VoteApplication.canCreateVoteInChat(this.chatType))){return false}return O.FeatureManager.isFeatureAvailable(O.Feature.voteCreationAvailable)},iconColor(){if(this.showMenu){return st.Color.accentBlue}return st.Color.gray40}},methods:{onSelectLocalFile(){this.$refs.fileInput.click();this.showMenu=false},onSelectFromB24(){this.showDiskPopup=true;this.showMenu=false},onFileSelect(t){this.$emit("fileSelect",{event:t});this.showMenu=false},onDiskFileSelect(t){this.$emit("diskFileSelect",t)},loc(t){return this.$Bitrix.Loc.getMessage(t)},getEntityCreator(){if(!this.entityCreator){this.entityCreator=new M.EntityCreator(this.chatId)}return this.entityCreator},onCreateTaskClick(){void this.getEntityCreator().createTaskForChat();x.Analytics.getInstance().chatEntities.onCreateTaskFromTextareaClick(this.dialogId);this.showMenu=false},onCreateMeetingClick(){void this.getEntityCreator().createMeetingForChat();x.Analytics.getInstance().chatEntities.onCreateEventFromTextareaClick(this.dialogId);this.showMenu=false},onUploadButtonClick(){if(this.showMenu!==true){x.Analytics.getInstance().attachMenu.onOpenUploadMenu(this.dialogId)}this.showMenu=true},async onCreateCalendarSlotClick(t){if(!P.GroupSharingController){return}const e=V.Core.getStore().getters["chats/collabs/getByChatId"](this.chatId);if(!e||!e.collabId){return}try{const s=await P.GroupSharingController.getGroupSharing(e.collabId,t.target);s.openDialog();this.showMenu=false}catch(t){k.Notifier.onDefaultError();console.error("ChatTextarea: UploadMenu: select slots error",t)}},onCreateDocumentSignClick(){const t=Hs+this.chatId;BX.SidePanel.Instance.open(t,{cacheable:false})},onCreateVoteClick(){const t=x.Analytics.getInstance();const e=t.vote.getSerializedParams(this.dialogId);const s=`/bitrix/components/bitrix/voting.im.edit/slider.php?chatId=${this.chatId}&${e}`;BX.SidePanel.Instance.open(s,{cacheable:false,width:600,allowChangeHistory:false});x.Analytics.getInstance().chatEntities.onCreateVoteFromTextareaClick(this.dialogId);this.showMenu=false}},template:`\n\t\t<div ref="upload" class="bx-im-textarea__icon-container">\n\t\t\t<BIcon\n\t\t\t\t:name="OutlineIcons.ATTACH"\n\t\t\t\t:title="loc('IM_TEXTAREA_ICON_UPLOAD_TITLE')"\n\t\t\t\t:color="iconColor"\n\t\t\t\t:size="ICON_SIZE"\n\t\t\t\tclass="bx-im-textarea__icon"\n\t\t\t\t@click="onUploadButtonClick"\n\t\t\t/>\n\t\t</div>\n\t\t<MessengerMenu v-if="showMenu" :config="menuConfig" @close="showMenu = false" className="bx-im-file-menu__scope">\n\t\t\t<MenuItem\n\t\t\t\tv-for="item in availableMenuItems"\n\t\t\t\t:icon="item.icon"\n\t\t\t\t:title="item.title"\n\t\t\t\t@click="item.clickHandler"\n\t\t\t/>\n\t\t\t<input type="file" @change="onFileSelect" multiple class="bx-im-file-menu__file-input" ref="fileInput">\n\t\t</MessengerMenu>\n\t\t<DiskPopup v-if="showDiskPopup" @diskFileSelect="onDiskFileSelect" @close="showDiskPopup = false"/>\n\t`};const Ds={name:"FilePreviewItem",props:{file:{type:Object,required:true},maxNameLength:{type:Number,default:25}},computed:{fileIconClass(){return`ui-icon ui-icon-file-${this.file.icon}`},fileShortName(){return ct.Utils.file.getShortFileName(this.file.name,this.maxNameLength)},fileSize(){return ct.Utils.file.formatFileSize(this.file.size)},hasPreview(){return it.Type.isStringFilled(this.file.urlPreview)},imageStyles(){return{backgroundImage:`url(${this.file.urlPreview})`}}},template:`\n\t\t<div class="bx-im-upload-preview-file-item__file-container">\n\t\t\t<div class="bx-im-upload-preview-file-item__icon">\n\t\t\t\t<div v-if="hasPreview" :style="imageStyles" class="bx-im-upload-preview-file-item__preview"></div>\n\t\t\t\t<div v-else :class="fileIconClass"><i></i></div>\n\t\t\t</div>\n\t\t\t<div class="bx-im-upload-preview-file-item__info">\n\t\t\t\t<div class="bx-im-upload-preview-file-item__name">{{ fileShortName }}</div>\n\t\t\t\t<div class="bx-im-upload-preview-file-item__size">{{ fileSize }}</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const Us={name:"ErrorPreviewItem",template:`\n\t\t<div class="bx-im-upload-preview-file-item__item-error">\n\t\t\t<div class="bx-im-upload-preview-file-item__item-error-icon"></div>\n\t\t\t<div class="bx-im-upload-preview-file-item__item-error-text">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_TEXTAREA_UPLOAD_PREVIEW_POPUP_FILE_UPLOAD_ERROR') }}\n\t\t\t</div>\n\t\t</div>\n\t`};const Ns={name:"FileItem",components:{FilePreviewItem:Ds,ErrorPreviewItem:Us},props:{file:{type:Object,required:true},removable:{type:Boolean,default:false},highlightDropzone:{type:Object,default:null},viewerGroupBy:{type:String||null,default:null}},emits:["removeItem","itemDragStart","itemDragEnd","itemDragOver","itemDragLeave","itemDrop"],data(){return{isDraggable:false}},computed:{hasError(){return this.file.status===st.FileStatus.error},previewComponentName(){if(this.hasError){return Us.name}return Ds.name},draggableClasses(){const t={};if(this.highlightDropzone.fileId===this.file.id){t[`--dropzone-${this.highlightDropzone.position}`]=true}t["--draggable"]=this.isDraggable;return t},viewerAttributes(){if(this.file.viewerAttrs){return ct.Utils.file.getViewerDataAttributes({viewerAttributes:this.file.viewerAttrs,previewImageSrc:this.file.urlPreview,context:st.FileViewerContext.dialog})}return ct.Utils.file.getViewerDataAttributes({viewerAttributes:{viewer:true,viewerResized:true,viewerType:this.file.type,title:this.file.name,src:this.file.urlDownload,viewerGroupBy:this.viewerGroupBy},previewImageSrc:this.file.urlPreview,context:st.FileViewerContext.dialog})}},methods:{onRemoveClick(){this.$emit("removeItem",{file:this.file})},onDragStart(t){this.$emit("itemDragStart",{file:this.file,axis:"y",event:t});this.isDraggable=true},onDragEnd(t){this.$emit("itemDragEnd",{file:this.file,axis:"y",event:t});this.isDraggable=false;t.target.removeAttribute("draggable")},onDragOver(t){this.$emit("itemDragOver",{file:this.file,axis:"y",event:t})},onDragLeave(t){this.$emit("itemDragLeave",{file:this.file,axis:"y",event:t})},onDrop(t){this.$emit("itemDrop",{file:this.file,axis:"y",event:t});this.isDraggable=false},onMouseDown(){this.$refs.dragElement.setAttribute("draggable","true")}},template:`\n\t\t<div \n\t\t\tclass="bx-im-upload-preview-file-item__scope"\n\t\t\t:class="this.draggableClasses"\n\t\t\t@dragstart="onDragStart"\n\t\t\t@dragend="onDragEnd"\n\t\t\t@dragover="onDragOver"\n\t\t\t@dragleave="onDragLeave"\n\t\t\t@drop="onDrop"\n\t\t\tref="dragElement"\n\t\t>\n\t\t\t<div \n\t\t\t\tclass="bx-im-upload-preview-file-item__drag"\n\t\t\t\t@mousedown="onMouseDown"\n\t\t\t>\n\t\t\t\t<div class="bx-im-upload-preview-file-item__drag-icon"></div>\n\t\t\t</div>\n\t\t\t<component\n\t\t\t\t:is="previewComponentName"\n\t\t\t\t:file="file"\n\t\t\t\tv-bind="viewerAttributes"\n\t\t\t/>\n\t\t\t<div v-if="removable" class="bx-im-upload-preview-file-item__remove" @click="onRemoveClick">\n\t\t\t\t<div class="bx-im-upload-preview-file-item__remove-icon"></div>\n\t\t\t</div>\n\t\t</div>\n\t`};const $s=100;const js=74;const Xs=200;const zs={max:208,min:46};const qs={name:"UploadPreviewContent",components:{FileItem:Ns,SendButton:R.SendButton,MediaGallery:B.MediaGallery},props:{dialogId:{type:String,required:true},uploaderIds:{type:Array,required:true},uploadingId:{type:String||null,default:null},sourceFilesCount:{type:Number,required:true},textareaValue:{type:String,required:false,default:""},popupId:{type:String,required:true},allowAdjustPosition:{type:Boolean,default:true}},emits:["sendFiles","close","updateTitle"],data(){return{text:"",sendAsFile:false,chunks:[],uploaderChunks:[],textareaHeight:zs.min,textareaResizedHeight:0,draggedItemEvent:null,lastTargetItem:null,lastTargetPosition:null,highlightDropzone:{},draggedFile:null,axis:"x",insertPosition:null}},computed:{files(){return this.chunks.flat()},uploaderFiles(){const t=this.uploaderIds.flatMap((t=>this.getUploadingService().getFiles(t)));const e=this.files.map((t=>t.id));return e.map((e=>t.find((t=>t.getId()===e))))},isOverMaxFilesLimit(){return this.sourceFilesCount>$s},isMediaOnly(){return this.files.every((t=>t.type===st.FileType.image||t.type===st.FileType.video))},inputMaxLength(){const t=it.Extension.getSettings("im.v2.component.textarea");return t.get("maxLength")},allowedTextLimit(){return this.inputMaxLength-this.text.length},showInputLengthCounter(){return this.allowedTextLimit<=Xs},textareaHeightStyle(){return this.textareaHeight==="auto"?"auto":`${this.textareaHeight}px`},title(){const t=Math.min(this.files.length,$s);return this.$Bitrix.Loc.getMessage("IM_TEXTAREA_UPLOAD_PREVIEW_POPUP_COMPUTED_TITLE",{"#COUNT#":t})}},watch:{async text(){await this.adjustTextareaHeight();if(this.allowAdjustPosition){this.adjustPopupPosition()}},title(){this.$emit("updateTitle",this.title)},sendAsFile(t){this.uploaderFiles.forEach((e=>{e.setCustomData("sendAsFile",t)}))}},created(){this.initResizeManager();this.uploaderIds.forEach((t=>{const e=[];this.getUploadingService().getFiles(t).forEach((t=>{e.push(this.$store.getters["files/get"](t.getId()))}));this.chunks.push(e)}))},mounted(){this.text=this.textareaValue;this.insertText("");this.$refs.messageText.focus()},beforeUnmount(){this.insertText(this.text);C.DraftManager.getInstance().setDraftText(this.dialogId,this.text);this.resizeManager.destroy()},methods:{async adjustTextareaHeight(){this.textareaHeight="auto";await this.$nextTick();if(!this.$refs.messageText){return}const t=2;const e=Math.min(zs.max,this.$refs.messageText.scrollHeight+t);if(this.doesContentOverflowScreen(e)){const t=this.$refs.messageText.getBoundingClientRect().top;const e=window.innerHeight-t-js;this.textareaHeight=Math.max(zs.min,e);return}if(this.resizedTextareaHeight){this.textareaHeight=Math.max(e,this.resizedTextareaHeight);return}this.textareaHeight=Math.max(e,zs.min)},getUploadingService(){if(!this.uploadingService){this.uploadingService=F.UploadingService.getInstance()}return this.uploadingService},onCancel(){this.$emit("close",{text:this.text})},onSend(){const t=this.sendAsFile||!this.isMediaOnly;if(t){this.uploaderFiles.forEach((t=>{this.removePreviewParams(t);t.setTreatImageAsFile(true);t.setCustomData("sendAsFile",true)}))}this.$emit("sendFiles",{text:this.text,uploaderIds:this.uploaderIds,files:this.uploaderFiles,sendAsFile:t});this.text=""},onKeyDownHandler(t){const e=L.isSendMessageCombination(t);const s=L.isNewLineCombination(t);if(e&&!s){t.preventDefault();this.onSend();return}if(s){t.preventDefault();this.text=nt.Textarea.addNewLine(this.$refs.messageText)}},removePreviewParams(t){this.$store.dispatch("files/update",{id:t.getId(),fields:{image:false}})},insertText(t){this.getEmitter().emit(st.EventType.textarea.insertText,{text:t,dialogId:this.dialogId,replace:true})},initResizeManager(){this.resizeManager=new ue({direction:pe.down,minHeight:zs.min,maxHeight:zs.max});this.resizeManager.subscribe(ue.events.onHeightChange,(({data:{newHeight:t}})=>{this.textareaHeight=t}));this.resizeManager.subscribe(ue.events.onResizeStop,(()=>{this.resizedTextareaHeight=this.textareaHeight}))},onResizeStart(t){this.resizeManager.onResizeStart(t,this.textareaHeight)},doesContentOverflowScreen(t){const e=this.$refs.messageText.getBoundingClientRect().top;return e+t+js>window.innerHeight},onRemoveItem(t){const e=this.chunks.flat().filter((e=>e.id!==t.file.id));this.chunks=F.MultiUploadingService.makeChunks({files:e});if(this.chunks.length===0){this.onCancel()}},adjustPopupPosition(){var t;(t=ot.PopupManager.getPopupById(this.popupId))==null?void 0:t.adjustPosition({forceBindPosition:true,position:"bottom"})},onItemDragStart(t){this.draggedItemEvent=t;this.draggedFile=t.file;this.axis=t.axis||this.axis;t.event.dataTransfer.effectAllowed="move"},onItemDragEnd(t){t.event.preventDefault();delete this.highlightDropzone.fileId;delete this.highlightDropzone.position;const e=this.chunks.flat();const s=e.indexOf(this.draggedFile);const i=(()=>{const t=e.indexOf(this.lastTargetItem);if(this.lastTargetPosition==="before"){return t-1}return t})();e.splice(s,1);e.splice(i+1,0,this.draggedFile);this.chunks=F.MultiUploadingService.makeChunks({files:e});this.draggedFile=null},onItemDragOver(t){if(this.draggedFile){t.event.preventDefault();const e=t.file;const s=(()=>{const e=t.event.currentTarget.getBoundingClientRect();const s=(()=>{if(this.axis==="x"){return e.left+e.width/2}return e.top+e.height/2})();if(this.axis==="x"&&t.event.x>s||this.axis==="y"&&t.event.y>s){return"after"}return"before"})();if(e!==this.lastTargetItem||e===this.lastTargetItem&&s!==this.lastTargetPosition){this.lastTargetPosition=s;this.lastTargetItem=e;this.highlightDropzone={fileId:e.id,position:s}}}},onDrop(t){t.preventDefault()},getEmitter(){return this.$Bitrix.eventEmitter},loc(t,e={}){return this.$Bitrix.Loc.getMessage(t,e)}},template:`\n\t\t<div class="bx-im-upload-preview__container" @drop="onDrop">\n\t\t\t<div class="bx-im-upload-preview__items-container">\n\t\t\t\t<div v-if="isMediaOnly && !sendAsFile" v-for="chunk in chunks" class="bx-im-upload-preview__items-chunk">\n\t\t\t\t\t<MediaGallery\n\t\t\t\t\t\t:files="chunk"\n\t\t\t\t\t\t:allowRemoveItem="true"\n\t\t\t\t\t\t:allowSorting="true"\n\t\t\t\t\t\t:viewerGroupBy="uploadingId"\n\t\t\t\t\t\t@removeItem="onRemoveItem"\n\t\t\t\t\t\t@itemDragStart="onItemDragStart"\n\t\t\t\t\t\t@itemDragEnd="onItemDragEnd"\n\t\t\t\t\t\t@itemDragOver="onItemDragOver"\n\t\t\t\t\t\t:highlightDropzone="highlightDropzone"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div v-else v-for="chunk in chunks" class="bx-im-upload-preview__items-chunk">\n\t\t\t\t\t<FileItem\n\t\t\t\t\t\tv-for="fileItem in chunk"\n\t\t\t\t\t\t:file="fileItem"\n\t\t\t\t\t\t:removable="true"\n\t\t\t\t\t\t:allowSorting="true"\n\t\t\t\t\t\t:viewerGroupBy="uploadingId"\n\t\t\t\t\t\t@removeItem="onRemoveItem"\n\t\t\t\t\t\t@itemDragStart="onItemDragStart"\n\t\t\t\t\t\t@itemDragEnd="onItemDragEnd"\n\t\t\t\t\t\t@itemDragOver="onItemDragOver"\n\t\t\t\t\t\t:highlightDropzone="highlightDropzone"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="bx-im-upload-preview__controls-container">\n\t\t\t\t<div v-if="isOverMaxFilesLimit" class="bx-im-upload-preview__controls-files-limit-message">\n\t\t\t\t\t<span>{{ loc('IM_TEXTAREA_UPLOAD_PREVIEW_POPUP_FILES_LIMIT_MESSAGE_100') }}</span>\n\t\t\t\t</div>\n\t\t\t\t<label v-if="isMediaOnly" class="bx-im-upload-preview__control-compress-image">\n\t\t\t\t\t<input type="checkbox" class="bx-im-upload-preview__control-compress-image-checkbox" v-model="sendAsFile">\n\t\t\t\t\t{{ loc('IM_TEXTAREA_UPLOAD_PREVIEW_POPUP_SEND_WITHOUT_COMPRESSION') }}\n\t\t\t\t</label>\n\t\t\t\t<div class="bx-im-upload-preview__control-form">\n\t\t\t\t\t<div class="bx-im-upload-preview__message-text__wrapper">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tref="messageText"\n\t\t\t\t\t\t\tv-model="text"\n\t\t\t\t\t\t\t:placeholder="loc('IM_TEXTAREA_UPLOAD_PREVIEW_POPUP_INPUT_PLACEHOLDER_2')"\n\t\t\t\t\t\t\t:maxlength="inputMaxLength"\n\t\t\t\t\t\t\t:style="{'height': textareaHeightStyle}"\n\t\t\t\t\t\t\tclass="bx-im-upload-preview__message-text"\n\t\t\t\t\t\t\trows="1"\n\t\t\t\t\t\t\t@keydown="onKeyDownHandler"\n\t\t\t\t\t\t></textarea>\n\t\t\t\t\t\t<div v-if="showInputLengthCounter" class="bx-im-upload-preview__message-text__counter">\n\t\t\t\t\t\t\t<span>{{ this.allowedTextLimit }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div @mousedown="onResizeStart" class="bx-im-upload-preview__message-text__drag-handle"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<SendButton :dialogId="dialogId" @click="onSend" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const Ks="im-chat-upload-preview-popup";const Gs={name:"UploadPreviewPopup",components:{MessengerPopup:lt.MessengerPopup,UploadPreviewContent:qs,Loader:Y.Loader,Spinner:Y.Spinner},props:{dialogId:{type:String,required:true},uploaderIds:{type:Array,required:true},uploadingId:{type:String||null,default:null},sourceFilesCount:{type:Number,required:true},textareaValue:{type:String,required:false,default:""}},emits:["close","sendFiles"],data(){return{allowAdjustPosition:true}},computed:{POPUP_ID:()=>Ks,config(){return{width:400,targetContainer:document.body,fixed:true,draggable:{restrict:true},titleBar:" ",offsetTop:0,padding:0,closeIcon:true,contentColor:"transparent",contentPadding:0,className:"bx-im-upload-preview__scope",autoHide:true,closeByEsc:false,overlay:true}},files(){const t=this.getUploadingService();return this.uploaderIds.flatMap((e=>t.getFiles(e).map((t=>this.$store.getters["files/get"](t.getId())))))},isReady(){return this.files.every((t=>t.image!==null))}},watch:{isReady(){if(this.isReady){queueMicrotask((()=>{var t;(t=ot.PopupManager.getPopupById(Ks))==null?void 0:t.adjustPosition({forceBindPosition:true,position:"bottom"})}))}}},methods:{onSendFiles(t){this.$emit("sendFiles",t);this.$emit("close")},onUpdateTitle(t){var e;(e=ot.PopupManager.getPopupById(Ks))==null?void 0:e.setTitleBar(t)},getUploadingService(){return F.UploadingService.getInstance()},onDragStart(){this.allowAdjustPosition=false}},template:`\n\t\t<MessengerPopup\n\t\t\t:config="config"\n\t\t\t@close="$emit('close')"\n\t\t\t@popupDragStart="onDragStart"\n\t\t\t:id="POPUP_ID"\n\t\t>\n\t\t\t<UploadPreviewContent\n\t\t\t\tv-if="isReady"\n\t\t\t\t:dialogId="dialogId"\n\t\t\t\t:uploaderIds="uploaderIds"\n\t\t\t\t:uploadingId="uploadingId"\n\t\t\t\t:sourceFilesCount="sourceFilesCount"\n\t\t\t\t:textareaValue="textareaValue"\n\t\t\t\t:popupId="POPUP_ID"\n\t\t\t\t:allowAdjustPosition="allowAdjustPosition"\n\t\t\t\t@close="$emit('close')"\n\t\t\t\t@sendFiles="onSendFiles"\n\t\t\t\t@updateTitle="onUpdateTitle"\n\t\t\t/>\n\t\t\t<div v-else class="bx-im-upload-preview-popup-preparing">\n\t\t\t\t<Spinner></Spinner>\n\t\t\t</div>\n\t\t</MessengerPopup>\n\t`};const Vs={name:"MentionSearchEmptyState",template:`\n\t\t<div class="bx-im-mention-empty-state__scope bx-im-mention-empty-state__container">\n\t\t\t<span class="bx-im-mention-empty-state__icon"></span>\n\t\t\t<span class="bx-im-mention-empty-state__title">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_TEXTAREA_MENTION_EMPTY_STATE') }}\n\t\t\t</span>\n\t\t</div>\n\t`};const Ws={name:"MentionLoadingState",components:{Spinner:Y.Spinner},computed:{SpinnerSize:()=>Y.SpinnerSize,SpinnerColor:()=>Y.SpinnerColor},template:`\n\t\t<div class="bx-im-mention-loading-state__scope bx-im-mention-loading-state__container">\n\t\t\t<div class="bx-im-mention-loading-state__loader">\n\t\t\t\t<Spinner :size="SpinnerSize.XXS" :color="SpinnerColor.grey"/>\n\t\t\t</div>\n\t\t\t<span class="bx-im-mention-loading-state__title">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_TEXTAREA_MENTION_LOADING_STATE') }}\n\t\t\t</span>\n\t\t</div>\n\t`};const Qs={name:"MentionContentFooter",components:{Loader:Y.Loader},props:{isLoading:{type:Boolean,default:false}},computed:{arrowsControlTitle(){return this.$Bitrix.Loc.getMessage("IM_TEXTAREA_MENTION_ARROWS_CONTROL").replace("##ARROWS_ICON##","")},enterControlTitle(){return this.$Bitrix.Loc.getMessage("IM_TEXTAREA_MENTION_ENTER_CONTROL")},escControlTitle(){return this.$Bitrix.Loc.getMessage("IM_TEXTAREA_MENTION_ESC_CONTROL")}},template:`\n\t\t<div class="bx-im-mention-content-footer__container bx-im-mention-content-footer__scope">\n\t\t\t<div class="bx-im-mention-content-footer__controls">\n\t\t\t\t<div class="bx-im-mention-content-footer__control">\n\t\t\t\t\t<span class="bx-im-mention-content-footer__arrows-control-key"></span>\n\t\t\t\t\t<span class="bx-im-mention-content-footer__control-description">\n\t\t\t\t\t\t{{ arrowsControlTitle }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-im-mention-content-footer__control">\n\t\t\t\t\t<span class="bx-im-mention-content-footer__control-key">Enter</span>\n\t\t\t\t\t<span class="bx-im-mention-content-footer__control-description">{{ enterControlTitle }}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-im-mention-content-footer__control">\n\t\t\t\t\t<span class="bx-im-mention-content-footer__control-key">Esc</span>\n\t\t\t\t\t<span class="bx-im-mention-content-footer__control-description">{{ escControlTitle }}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<Loader v-if="isLoading" class="bx-im-mention-content-footer__loader" />\n\t\t</div>\n\t`};const Ys="ui.entityselector.doSearch";var Zs=babelHelpers.classPrivateFieldLooseKey("storeUpdater");var Js=babelHelpers.classPrivateFieldLooseKey("searchConfig");var ti=babelHelpers.classPrivateFieldLooseKey("searchRequest");var ei=babelHelpers.classPrivateFieldLooseKey("getDialogIdAndDate");class si{constructor(t){Object.defineProperty(this,ei,{value:oi});Object.defineProperty(this,ti,{value:ii});Object.defineProperty(this,Zs,{writable:true,value:void 0});Object.defineProperty(this,Js,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,Js)[Js]=t;babelHelpers.classPrivateFieldLooseBase(this,Zs)[Zs]=new j.StoreUpdater}async search(t){const e=await babelHelpers.classPrivateFieldLooseBase(this,ti)[ti](t);await babelHelpers.classPrivateFieldLooseBase(this,Zs)[Zs].update(e);return babelHelpers.classPrivateFieldLooseBase(this,ei)[ei](e)}async loadChatParticipants(t){const e={order:{lastSendMessageId:"desc"},dialogId:t,limit:50};try{const t=await X.runAction(st.RestMethod.imV2ChatMentionList,{data:e});const{users:s}=t;void(new N.UserManager).setUsersToModel(s);return babelHelpers.classPrivateFieldLooseBase(this,ei)[ei](s)}catch(t){console.error("Mention search service: load chat participants error",t);throw t}}}async function ii(t){const e={json:j.getSearchConfig(babelHelpers.classPrivateFieldLooseBase(this,Js)[Js])};e.json.searchQuery={queryWords:ct.Utils.text.getWordsFromString(t),query:t};let s=[];try{const t=await it.ajax.runAction(Ys,e);$.Logger.warn("Mention search service: request result",t);s=t.data.dialog.items}catch(t){$.Logger.warn("Mention search service: request error",t)}return s}function oi(t){return t.map((t=>{var e,s;return{dialogId:t.id.toString(),dateMessage:(e=(s=t.customData)==null?void 0:s.dateMessage)!=null?e:""}}))}var ni=babelHelpers.classPrivateFieldLooseKey("localSearch");var li=babelHelpers.classPrivateFieldLooseKey("baseServerSearch");var ai=babelHelpers.classPrivateFieldLooseKey("localCollection");var ri=babelHelpers.classPrivateFieldLooseKey("getDialogIds");class mi{constructor(t){Object.defineProperty(this,ri,{value:ci});Object.defineProperty(this,ni,{writable:true,value:void 0});Object.defineProperty(this,li,{writable:true,value:void 0});Object.defineProperty(this,ai,{writable:true,value:new Map});babelHelpers.classPrivateFieldLooseBase(this,ni)[ni]=new j.LocalSearch(t);babelHelpers.classPrivateFieldLooseBase(this,li)[li]=new si(t)}async loadChatParticipants(t){const e=await babelHelpers.classPrivateFieldLooseBase(this,li)[li].loadChatParticipants(t);e.forEach((t=>{babelHelpers.classPrivateFieldLooseBase(this,ai)[ai].set(t.dialogId,t)}));return babelHelpers.classPrivateFieldLooseBase(this,ri)[ri](e)}searchLocal(t){const e=[...babelHelpers.classPrivateFieldLooseBase(this,ai)[ai].values()];const s=babelHelpers.classPrivateFieldLooseBase(this,ni)[ni].search(t,e);const i=j.sortByDate(s);return babelHelpers.classPrivateFieldLooseBase(this,ri)[ri](i)}async search(t){const e=await babelHelpers.classPrivateFieldLooseBase(this,li)[li].search(t);e.forEach((t=>{babelHelpers.classPrivateFieldLooseBase(this,ai)[ai].set(t.dialogId,t)}));return babelHelpers.classPrivateFieldLooseBase(this,ri)[ri](e)}}function ci(t){return t.map((t=>t.dialogId))}const di={name:"MentionItem",components:{ChatAvatar:q.ChatAvatar,ChatTitle:K.ChatTitle},props:{id:{type:String,required:true},title:{type:String,default:""},subtitle:{type:String,default:""}},computed:{AvatarSize:()=>q.AvatarSize},template:`\n\t\t<slot name="avatar">\n\t\t\t<ChatAvatar\n\t\t\t\t:avatarDialogId="id"\n\t\t\t\t:size="AvatarSize.M"\n\t\t\t\tclass="bx-im-mention-item__avatar-container"\n\t\t\t/>\n\t\t</slot>\n\t\t<div class="bx-im-mention-item__content-container">\n\t\t\t<slot name="title">\n\t\t\t\t<ChatTitle\n\t\t\t\t\t:dialogId="id"\n\t\t\t\t\t:text="title"\n\t\t\t\t\t:withLeftIcon="false"\n\t\t\t\t\tclass="bx-im-mention-item__title"\n\t\t\t\t/>\n\t\t\t</slot>\n\t\t\t<slot name="subtitle">\n\t\t\t\t<div class="bx-im-mention-item__subtitle" :title="subtitle">{{ subtitle }}</div>\n\t\t\t</slot>\n\t\t</div>\n\t`};const bi={name:"AllParticipantsItem",components:{MentionItem:di},props:{item:{type:Object,required:true},selected:{type:Boolean,default:false},dialogId:{type:String,required:true}},computed:{currentItem(){return this.item}},methods:{loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div\n\t\t\t:class="{'--selected': selected}"\n\t\t\tclass="bx-im-mention-item__container bx-im-mention-item__scope"\n\t\t>\n\t\t\t<MentionItem\n\t\t\t\t:id="currentItem.id"\n\t\t\t\t:title="currentItem.title"\n\t\t\t\t:subtitle="currentItem.subtitle"\n\t\t\t>\n\t\t\t\t<template #avatar>\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass="bx-im-mention-item__all-avatar-container" \n\t\t\t\t\t\t:title="loc('IM_TEXTAREA_MENTION_ALL_PARTICIPANTS_AVATAR_TITLE')"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</MentionItem>\n\t\t</div>\n\t`};const pi={name:"CopilotMentionItem",components:{MentionItem:di},props:{item:{type:Object,required:true},selected:{type:Boolean,default:false},dialogId:{type:String,required:true}},computed:{subtitle(){return this.loc("IM_TEXTAREA_MENTION_COPILOT_SUBTITLE")},currentItem(){return this.item}},methods:{loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div\n\t\t\t:class="{'--selected': selected}"\n\t\t\tclass="bx-im-mention-item__container bx-im-mention-item__scope"\n\t\t>\n\t\t\t<MentionItem\n\t\t\t\t:id="currentItem.id"\n\t\t\t\t:title="currentItem.title"\n\t\t\t\t:subtitle="currentItem.subtitle"\n\t\t\t/>\n\t\t</div>\n\t`};const hi={name:"DefaultMentionItem",components:{ChatTitleWithHighlighting:K.ChatTitleWithHighlighting,MentionItem:di},props:{item:{type:Object,required:true},selected:{type:Boolean,default:false},query:{type:String,default:""},dialogId:{type:String,required:true}},computed:{dialog(){return this.$store.getters["chats/get"](this.item.id,true)},isUser(){return this.dialog.type===st.ChatType.user},subtitleWithHighlighting(){return G.highlightText(it.Text.encode(this.item.subtitle),this.query)},currentItem(){return this.item}},template:`\n\t\t<div\n\t\t\t:class="{'--selected': selected}"\n\t\t\tclass="bx-im-mention-item__container bx-im-mention-item__scope"\n\t\t>\n\t\t\t<MentionItem :id="currentItem.id">\n\t\t\t\t<template #title>\n\t\t\t\t\t<ChatTitleWithHighlighting\n\t\t\t\t\t\t:dialogId="currentItem.id"\n\t\t\t\t\t\t:textToHighlight="query"\n\t\t\t\t\t\t:text="currentItem.title"\n\t\t\t\t\t\tclass="bx-im-mention-item__title"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t\t<template #subtitle>\n\t\t\t\t\t<div v-if="isUser" class="bx-im-mention-item__subtitle" :title="currentItem.subtitle" v-html="subtitleWithHighlighting"></div>\n\t\t\t\t\t<div v-else class="bx-im-mention-item__subtitle" :title="currentItem.subtitle">{{ currentItem.subtitle }}</div>\n\t\t\t\t</template>\n\t\t\t</MentionItem>\n\t\t</div>\n\t`};var ui=babelHelpers.classPrivateFieldLooseKey("emitter");var yi=babelHelpers.classPrivateFieldLooseKey("handlersById");var gi=babelHelpers.classPrivateFieldLooseKey("emitBaseEvent");var vi=babelHelpers.classPrivateFieldLooseKey("emitAllParticipantsEvent");class fi{constructor(t){Object.defineProperty(this,vi,{value:Ti});Object.defineProperty(this,gi,{value:Ii});Object.defineProperty(this,ui,{writable:true,value:void 0});Object.defineProperty(this,yi,{writable:true,value:{[st.SpecialMentionDialogId.allParticipants]:t=>babelHelpers.classPrivateFieldLooseBase(this,vi)[vi](t),default:t=>babelHelpers.classPrivateFieldLooseBase(this,gi)[gi](t)}});const{emitter:e}=t;babelHelpers.classPrivateFieldLooseBase(this,ui)[ui]=e}emit(t){const e=babelHelpers.classPrivateFieldLooseBase(this,yi)[yi][t.id]||babelHelpers.classPrivateFieldLooseBase(this,yi)[yi].default;e(t)}}function Ii(t){const{id:e,dialogId:s,query:i}=t;const o=V.Core.getStore().getters["chats/get"](e,true).name;const n=ct.Utils.text.getMentionBbCode(e,o);babelHelpers.classPrivateFieldLooseBase(this,ui)[ui].emit(st.EventType.textarea.insertMention,{mentionText:o,mentionReplacement:n,textToReplace:i,dialogId:s})}function Ti(t){const{dialogId:e,query:s}=t;const i=it.Loc.getMessage("IM_TEXTAREA_MENTION_ALL_PARTICIPANTS_TEXT");const o=`[USER=${st.SpecialMentionDialogId.allParticipants}]${i}[/USER]`;babelHelpers.classPrivateFieldLooseBase(this,ui)[ui].emit(st.EventType.textarea.insertMention,{mentionText:i,mentionReplacement:o,textToReplace:s,dialogId:e})}function Pi(t,e,s){const i=it.Dom.getPosition(e);const o=it.Dom.getPosition(t);const n=o.top<i.top;const l=o.bottom>i.bottom;let a=e.scrollTop;if(n){a-=i.top-o.top+s}else if(l){a+=o.bottom-i.bottom+s}return a}function _i(t){return parseFloat(window.getComputedStyle(t).marginTop)}const Si=13;const Mi=200;const xi={name:"MentionItemsContainer",components:{AllParticipantsItem:bi,CopilotItem:pi,DefaultItem:hi,ScrollWithGradient:z.ScrollWithGradient},props:{dialogId:{type:String,required:true},query:{type:String,default:""},items:{type:Array,default:()=>[]}},emits:["close"],data(){return{selectedIndex:0}},computed:{GRADIENT_HEIGHT:()=>Si,CONTAINER_MAX_HEIGHT:()=>Mi,preparedQuery(){return this.query.trim().toLowerCase()},copilotBotDialogId(){return this.$store.getters["users/bots/getCopilotBotDialogId"]}},watch:{preparedQuery(){this.selectedIndex=0}},created(){it.Event.bind(window,"keydown",this.onKeyDown);this.getEmitter().subscribe(st.EventType.mention.selectItem,this.onInsertMentionText)},beforeUnmount(){it.Event.unbind(window,"keydown",this.onKeyDown);this.getEmitter().unsubscribe(st.EventType.mention.selectItem,this.onInsertMentionText)},methods:{getComponentToShow(t){var e;const s={[st.SpecialMentionDialogId.allParticipants]:bi,[this.copilotBotDialogId]:pi,default:hi};return(e=s[t])!=null?e:s.default},onKeyDown(t){if(this.items.length===0){return}const e=this.items.length-1;let s=this.selectedIndex;if(ct.Utils.key.isCombination(t,"ArrowDown")){s=s===e?0:s+1}if(ct.Utils.key.isCombination(t,"ArrowUp")){s=s===0?e:s-1}this.selectedIndex=s;const i=this.getDomElementByIndex(this.selectedIndex);if(!i){this.selectedIndex=0}this.scrollToItem(i)},getDomElementByIndex(t){return this.$refs["popup-items"].querySelector(`[data-index="${t}"]`)},scrollToItem(t){const e=this.$refs["scroll-gradient"].getContainer();const s=_i(this.$refs["popup-items"]);e.scrollTop=Pi(t,e,s)},onItemHover(t){this.selectedIndex=t},onInsertMentionText(){if(!it.Type.isArrayFilled(this.items)){return}this.insertMentionText()},onItemClick(){this.insertMentionText();this.$emit("close")},insertMentionText(){const{id:t}=this.items[this.selectedIndex];const e=new fi({emitter:this.getEmitter()});e.emit({id:t,dialogId:this.dialogId,query:this.query})},getEmitter(){return this.$Bitrix.eventEmitter}},template:`\n\t\t<ScrollWithGradient\n\t\t\tv-if="items.length > 0"\n\t\t\tref="scroll-gradient"\n\t\t\t:gradientHeight="GRADIENT_HEIGHT"\n\t\t\t:containerMaxHeight="CONTAINER_MAX_HEIGHT"\n\t\t\t:withShadow="false"\n\t\t>\n\t\t\t<div class="bx-im-mention-popup-content__items" ref="popup-items">\n\t\t\t\t<component\n\t\t\t\t\tv-for="(item, index) in items"\n\t\t\t\t\t:data-index="index"\n\t\t\t\t\t:is="getComponentToShow(item.id)"\n\t\t\t\t\t:item="item"\n\t\t\t\t\t:query="query"\n\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t:selected="index === selectedIndex"\n\t\t\t\t\t@click="onItemClick"\n\t\t\t\t\t@close="$emit('close')"\n\t\t\t\t\t@mouseover="onItemHover(index)"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</ScrollWithGradient>\n\t`};const Ei={[st.ChatType.openChannel]:it.Loc.getMessage("IM_TEXTAREA_MENTION_OPEN_CHANNEL_TYPE"),[st.ChatType.generalChannel]:it.Loc.getMessage("IM_TEXTAREA_MENTION_OPEN_CHANNEL_TYPE"),[st.ChatType.channel]:it.Loc.getMessage("IM_TEXTAREA_MENTION_PRIVATE_CHANNEL_TYPE"),[st.ChatType.collab]:it.Loc.getMessage("IM_TEXTAREA_MENTION_COLLAB_TYPE"),default:it.Loc.getMessage("IM_TEXTAREA_MENTION_CHAT_TYPE")};var ki=babelHelpers.classPrivateFieldLooseKey("getSubtitle");var Ai=babelHelpers.classPrivateFieldLooseKey("getDialog");class wi{constructor(t){Object.defineProperty(this,Ai,{value:Li});Object.defineProperty(this,ki,{value:Ci});this.dialogId=t}format(){return{id:this.dialogId,title:this.getTitle(),subtitle:babelHelpers.classPrivateFieldLooseBase(this,ki)[ki]()}}getTitle(){const t=babelHelpers.classPrivateFieldLooseBase(this,Ai)[Ai]();return t.name}}function Ci(){var t;const e=babelHelpers.classPrivateFieldLooseBase(this,Ai)[Ai]();if(e.type===st.ChatType.user){var s;return(s=V.Core.getStore().getters["users/getPosition"](this.dialogId))!=null?s:it.Loc.getMessage("IM_TEXTAREA_MENTION_USER_TYPE")}return(t=Ei[e.type])!=null?t:Ei.default}function Li(){return V.Core.getStore().getters["chats/get"](this.dialogId,true)}const Fi={name:"MentionPopupContent",components:{ContentFooter:Qs,SearchEmptyState:Vs,ScrollWithGradient:z.ScrollWithGradient,LoadingState:Ws,MentionItemsContainer:xi},props:{dialogId:{type:String,required:true},query:{type:String,default:""},searchChats:{type:Boolean,default:true}},emits:["close","adjustPosition"],data(){return{isLoading:false,searchResult:[],chatParticipants:[],chatParticipantsLoaded:false,currentServerQueries:0,needTopShadow:false,needBottomShadow:true}},computed:{dialog(){return V.Core.getStore().getters["chats/get"](this.dialogId,true)},items(){if(!this.isEmptyQuery){return this.formattedDynamicItems(this.searchResult)}return[...this.fixedItemsToShow,...this.dynamicItemsToShow]},fixedItemsToShow(){const t=[{id:this.copilotBotDialogId,title:new wi(this.copilotBotDialogId).getTitle(),subtitle:this.loc("IM_TEXTAREA_MENTION_COPILOT_SUBTITLE"),showCondition:this.needToShowFixedCopilot},{id:st.SpecialMentionDialogId.allParticipants,title:this.loc("IM_TEXTAREA_MENTION_ALL_PARTICIPANTS_TITLE"),subtitle:this.loc("IM_TEXTAREA_MENTION_ALL_PARTICIPANTS_SUBTITLE"),showCondition:this.needToShowAllParticipants}];return t.filter((t=>t.showCondition)).map((({id:t,title:e,subtitle:s})=>({id:t,title:e,subtitle:s})))},dynamicItemsToShow(){return this.formattedDynamicItems(this.dynamicItems)},dynamicItems(){if(this.needToShowRecentUsersOnStartScreen){return this.usersFromRecent}return this.chatParticipants},needToShowRecentUsersOnStartScreen(){return this.chatParticipantsLoaded&&this.chatParticipants.length<=1},usersFromRecent(){return j.getUsersFromRecentItems({withFakeUsers:false}).map((({dialogId:t})=>t))},preparedQuery(){return this.query.trim().toLowerCase()},isEmptyQuery(){return this.preparedQuery.length===0},isSearchEmptyState(){if(this.isLoading||this.isEmptyQuery){return false}return this.items.length===0},searchConfig(){return{chats:this.searchChats,users:true}},copilotBotDialogId(){return this.$store.getters["users/bots/getCopilotBotDialogId"]},needToShowFixedCopilot(){const t=U.ChannelManager.isChannel(this.dialogId);const e=(new D.CopilotManager).isCopilotChat(this.dialogId);if(t||e){return false}return O.FeatureManager.isFeatureAvailable(O.Feature.isCopilotMentionAvailable)},needToShowAllParticipants(){const{type:t}=this.dialog;if(t===st.ChatType.user){return false}return O.FeatureManager.isFeatureAvailable(O.Feature.mentionAllAvailable)}},watch:{async isLoading(){await this.adjustPosition()},async searchResult(){await this.adjustPosition()},preparedQuery(t,e){if(t===e){return}void this.startSearch(t)}},created(){this.initSettings();this.searchService=new mi(this.searchConfig);this.searchOnServerDelayed=it.Runtime.debounce(this.searchOnServer,400,this);void this.loadChatParticipants()},methods:{initSettings(){const t=it.Extension.getSettings("im.v2.component.textarea");const e=3;this.minTokenSize=t.get("minSearchTokenSize",e)},async loadChatParticipants(){this.isLoading=true;this.chatParticipants=await this.searchService.loadChatParticipants(this.dialogId);this.searchResult=this.chatParticipants;this.isLoading=false;this.chatParticipantsLoaded=true},async searchOnServer(t){this.currentServerQueries++;const e=await this.searchService.search(t);if(t!==this.preparedQuery){this.isLoading=false;return}this.searchResult=[...new Set([...this.searchResult,...e])];this.currentServerQueries--;this.stopLoader()},async startSearch(t){if(t.length>0){const e=this.searchService.searchLocal(t);if(t!==this.preparedQuery){return}this.searchResult=this.appendResult(e)}if(t.length>=this.minTokenSize){this.isLoading=true;await this.searchOnServerDelayed(t)}if(t.length===0){this.cleanSearchResult()}},stopLoader(){if(this.currentServerQueries>0){return}this.isLoading=false},cleanSearchResult(){this.searchResult=this.chatParticipants},async adjustPosition(){await this.$nextTick();this.$emit("adjustPosition")},appendResult(t){const e=this.searchResult.filter((e=>t.includes(e)));return[...new Set([...e,...t])]},isChat(t){return t.startsWith("chat")},formattedDynamicItems(t){return t.map((t=>new wi(t).format()))},loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div class="bx-im-mention-popup-content__container">\n\t\t\t<LoadingState v-if="isLoading" />\n\t\t\t<MentionItemsContainer\n\t\t\t\tv-else\n\t\t\t\t:dialogId="dialogId"\n\t\t\t\t:query="query"\n\t\t\t\t:items="items"\n\t\t\t\t@close="$emit('close')"\n\t\t\t/>\n\t\t\t<SearchEmptyState v-if="isSearchEmptyState" />\n\t\t\t<ContentFooter :isLoading="isLoading" />\n\t\t</div>\n\t`};const Bi="im-mention-popup";const Ri={name:"MentionPopup",components:{MessengerPopup:lt.MessengerPopup,MentionPopupContent:Fi},props:{bindElement:{type:Object,required:true},dialogId:{type:String,required:true},query:{type:String,default:""}},emits:["close"],computed:{POPUP_ID:()=>Bi,dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},isCopilotType(){return this.dialog.type===st.ChatType.copilot},isGroupCopilotChat(){return(new D.CopilotManager).isGroupCopilotChat(this.dialogId)},needToShowMentionPopup(){if(this.isCopilotType){return this.isGroupCopilotChat}return true},searchChats(){return!this.isCopilotType},config(){return{height:200,width:426,padding:0,bindElement:this.bindElement,offsetTop:2,offsetLeft:0,fixed:true,bindOptions:{position:"top"},className:"bx-im-mention-popup__scope"}}},template:`\n\t\t<MessengerPopup\n\t\t\tv-if="needToShowMentionPopup"\n\t\t\t:config="config"\n\t\t\t@close="$emit('close');"\n\t\t\t:id="POPUP_ID"\n\t\t\tv-slot="{adjustPosition}"\n\t\t>\n\t\t\t<MentionPopupContent \n\t\t\t\t:dialogId="dialogId"\n\t\t\t\t:query="query"\n\t\t\t\t:searchChats="searchChats"\n\t\t\t\t@close="$emit('close');"\n\t\t\t\t@adjustPosition="adjustPosition()"\n\t\t\t/>\n\t\t</MessengerPopup>\n\t`};const Hi={name:"EditPanel",props:{messageId:{type:[Number,String],required:true}},emits:["close"],computed:{message(){return this.$store.getters["messages/getById"](this.messageId)},preparedText(){return W.Parser.purifyMessage(this.message)}},methods:{loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div class="bx-im-message-panel__container">\n\t\t\t<div class="bx-im-message-panel__icon"></div>\n\t\t\t<div class="bx-im-message-panel__content">\n\t\t\t\t<div class="bx-im-message-panel__title">{{ loc('IM_TEXTAREA_EDIT_MESSAGE_TITLE') }}</div>\n\t\t\t\t<div class="bx-im-message-panel__text">{{ preparedText }}</div>\n\t\t\t</div>\n\t\t\t<div @click="$emit('close')" class="bx-im-message-panel__close"></div>\n\t\t</div>\n\t`};const Oi=40;const Di={name:"ReplyPanel",props:{messageId:{type:Number,required:true}},emits:["close"],computed:{message(){return this.$store.getters["messages/getById"](this.messageId)},replyAuthor(){return this.$store.getters["users/get"](this.message.authorId)},replyTitle(){return this.replyAuthor?this.replyAuthor.name:this.loc("IM_DIALOG_CHAT_QUOTE_DEFAULT_TITLE")},messageFile(){return this.$store.getters["messages/getMessageFiles"](this.message.id)[0]},isFile(){return this.messageFile&&this.messageFile.type===st.FileType.file},isVideo(){return this.messageFile&&this.messageFile.type===st.FileType.video},isImage(){return this.messageFile&&this.messageFile.type===st.FileType.image},isAudio(){return this.messageFile&&this.messageFile.type===st.FileType.audio},showIcon(){return this.messageFile?!this.messageFile.urlPreview:false},truncatedFileName(){return ct.Utils.file.getShortFileName(this.messageFile.name,Oi)},isMessageDeleted(){return this.message.isDeleted},isSticker(){return this.$store.getters["stickers/messages/isSticker"](this.message.id)},messageText(){if(this.isFile){return this.truncatedFileName}if(this.isAudio){return this.loc("IM_TEXTAREA_REPLY_AUDIO_TITLE")}if(this.isMessageDeleted){return this.loc("IM_TEXTAREA_REPLY_DELETED_TITLE")}if(this.isSticker){return this.loc("IM_TEXTAREA_REPLY_STICKER_TITLE")}return W.Parser.purify(this.message)},iconClass(){const t=ct.Utils.file.getIconTypeByFilename(this.messageFile.name);return`ui-icon-file-${t}`}},methods:{loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div class="bx-im-message-panel__container">\n\t\t\t<div class="bx-im-message-panel__icon --quote"></div>\n\t\t\t<div v-if="showIcon" class="bx-im-message-panel-file__icon">\n\t\t\t\t<div :class="iconClass" class="ui-icon"><i></i></div>\n\t\t\t</div>\n\t\t\t<div v-else-if="isImage || isVideo" class="bx-im-message-panel__image">\n\t\t\t\t<img \n\t\t\t\t\tv-if="this.messageFile.urlPreview" \n\t\t\t\t\tclass="bx-im-message-panel__image_img" \n\t\t\t\t\t:src="this.messageFile.urlPreview"\n\t\t                  :alt="this.messageFile.name"\n\t\t\t\t>\n\t\t\t</div>\n\t\t\t<div class="bx-im-message-panel__content">\n\t\t\t\t<div class="bx-im-message-panel__title">{{ replyTitle }}</div>\n\t\t\t\t<div class="bx-im-message-panel__text">{{ messageText }}</div>\n\t\t\t</div>\n\t\t\t<div @click="$emit('close')" class="bx-im-message-panel__close"></div>\n\t\t</div>\n\t`};const Ui=5;const Ni={name:"ForwardPanel",props:{context:{type:Object,required:true}},emits:["close"],computed:{forwardContext(){return this.context},messagesIds(){return this.forwardContext.messagesIds},sortedMessagesIds(){return[...this.messagesIds].sort()},authorsOfMessages(){return this.sortedMessagesIds.map((t=>{const e=this.$store.getters["messages/isForward"](t);const s=this.getMessage(t);const i=e?s.forward.userId:s.authorId;return this.$store.getters["users/get"](i,true)}))},uniqueUsers(){const t={};this.authorsOfMessages.forEach((e=>{if(!t[e.id]){t[e.id]=e}}));return Object.values(t)},forwardMessagesCount(){return this.messagesIds.length},forwardAuthorName(){const t=this.authorsOfMessages[0];let e=t.name;if(t.id===0){e=this.loc("IM_TEXTAREA_FORWARD_SYSTEM")}return`${e}: `},displayedAuthorNames(){const t=this.authorsOfMessages.filter((t=>t.id===0)).length;const e=this.uniqueUsers.slice(0,Ui);const s=[];e.forEach((e=>{if(e.id===0){return t>1?s.push(this.loc("IM_TEXTAREA_FORWARD_MESSAGES_SYSTEM")):s.push(this.loc("IM_TEXTAREA_FORWARD_SYSTEM"))}if(this.isOwnMessage(e)){return s.unshift(this.loc("IM_TEXTAREA_FORWARD_OWN_MESSAGE"))}return s.push(e.firstName)}));return s.join(", ")},formattedAuthorNames(){if(this.remainingAuthors>0){return it.Loc.getMessage("IM_TEXTAREA_FORWARD_TEXT_MORE",{"[name]":'<span class="bx-im-message-panel__forward-author_name">',"[/name]":"</span>","#USER_LIST#":it.Text.encode(this.displayedAuthorNames),"[remaining]":'<span class="bx-im-message-panel__forward-author_remaining">',"[/remaining]":"</span>","#COUNT#":this.remainingAuthors})}return this.loc("IM_TEXTAREA_FORWARD_TEXT",{"#USER_LIST#":it.Text.encode(this.displayedAuthorNames)})},remainingAuthors(){return this.uniqueUsers.length-Ui},messageText(){return W.Parser.purifyMessage(this.getMessage(this.messagesIds))},titleText(){if(this.forwardMessagesCount>1){return this.formattedMessageCounter}return this.loc("IM_TEXTAREA_FORWARD_TITLE")},formattedMessageCounter(){return it.Loc.getMessagePlural("IM_TEXTAREA_FORWARD_TITLE_MULTIPLE_COUNT",this.forwardMessagesCount,{"#COUNT_MESSAGES#":this.forwardMessagesCount})}},methods:{isOwnMessage(t){return t.id===V.Core.getUserId()&&this.uniqueUsers.length>1},getMessage(t){return this.$store.getters["messages/getById"](t)},loc(t,e={}){return this.$Bitrix.Loc.getMessage(t,e)}},template:`\n\t\t<div class="bx-im-message-panel__container">\n\t\t\t<div class="bx-im-message-panel__icon --forward"></div>\n\t\t\t<div class="bx-im-message-panel__content">\n\t\t\t\t<div class="bx-im-message-panel__title">{{ titleText }}</div>\n\t\t\t\t<div v-if="forwardMessagesCount > 1" class="bx-im-message-panel__text" :class="{'--compact': remainingAuthors > 0}">\n\t\t\t\t\t<div class="bx-im-message-panel__bulk-forward-author" v-html="formattedAuthorNames"></div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else class="bx-im-message-panel__text">\n\t\t\t\t\t<span class="bx-im-message-panel__forward-author">{{ forwardAuthorName }}</span>\n\t\t\t\t\t<span class="bx-im-message-panel__forward-message-text">{{ messageText }}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div @click="$emit('close')" class="bx-im-message-panel__close"></div>\n\t\t</div>\n\t`};const $i={name:"MarketAppPopup",components:{MessengerPopup:lt.MessengerPopup,Spinner:Y.Spinner},props:{bindElement:{type:Object,required:true},entityId:{type:String,required:true},width:{type:Number,required:true},height:{type:Number,required:true},dialogId:{type:String,required:true}},emits:["close"],data(){return{isLoading:true,handleResult:true}},computed:{SpinnerSize:()=>Y.SpinnerSize,popupConfig(){return{width:this.width,height:this.height,bindElement:this.bindElement,bindOptions:{position:"top"},offsetTop:0,offsetLeft:0,padding:0}}},created(){this.marketManager=Z.MarketManager.getInstance()},mounted(){const t={dialogId:this.dialogId};this.marketManager.loadPlacement(this.entityId,t).then((t=>{if(!this.handleResult){return}this.isLoading=false;it.Runtime.html(this.$refs["im-messenger-textarea-placement"],t)}))},methods:{onClose(){this.handleResult=false;this.$emit("close")}},template:`\n\t\t<MessengerPopup\n\t\t\t:config="popupConfig"\n\t\t\t@close="onClose"\n\t\t\tid="im-market-app-popup"\n\t\t>\n\t\t\t<div class="bx-im-market-app-popup__container">\n\t\t\t\t<div v-if="isLoading" class="bx-im-market-app-popup__loader-container">\n\t\t\t\t\t<Spinner :size="SpinnerSize.S"/>\n\t\t\t\t</div>\n\t\t\t\t<div ref="im-messenger-textarea-placement" class="bx-im-market-app-popup__placement-container"></div>\n\t\t\t</div>\n\t\t</MessengerPopup>\n\t`};const ji={name:"MarketAppItem",components:{MarketAppPopup:$i},props:{item:{type:Object,required:true},hideTitle:{type:Boolean,default:false},dialogId:{type:String,required:true}},data(){return{showApp:false}},computed:{marketItem(){return this.item},iconClass(){return`fa ${this.marketItem.options.iconName}`},iconColor(){return this.marketItem.options.color}},methods:{onAppClick(){this.showApp=!this.showApp}},template:`\n\t\t<div \n\t\t\tclass="bx-im-market-app-item__container" \n\t\t\t:class="{'--short': hideTitle}" \n\t\t\t:title="marketItem.title"\n\t\t\t@click="onAppClick"\n\t\t\tref="market-app"\n\t\t>\n\t\t\t<div class="bx-im-market-app-item__icon-container" :style="{backgroundColor: iconColor}">\n\t\t\t\t<i :class="iconClass" aria-hidden="true"></i>\n\t\t\t</div>\n\t\t\t<div v-if="!hideTitle" class="bx-im-market-app-item__title-container" :title="marketItem.title">\n\t\t\t\t<div class="bx-im-market-app-item__title-text">\n\t\t\t\t\t{{ marketItem.title }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<MarketAppPopup \n\t\t\t\tv-if="showApp" \n\t\t\t\t:bindElement="$refs['market-app']" \n\t\t\t\t:entityId="marketItem.id"\n\t\t\t\t:width="marketItem.options.width"\n\t\t\t\t:height="marketItem.options.height"\n\t\t\t\t:dialogId="dialogId"\n\t\t\t\t@close="onAppClick"\n\t\t\t/>\n\t\t</div>\n\t`};const Xi={name:"MarketShowMorePopupContentItem",components:{MarketAppPopup:$i},props:{item:{type:Object,required:true},dialogId:{type:String,required:true}},data(){return{showApp:false}},computed:{marketItem(){return this.item},iconClass(){return`fa ${this.marketItem.options.iconName}`},iconColor(){return this.marketItem.options.color}},methods:{onAppClick(){this.showApp=!this.showApp}},template:`\n\t\t<div \n\t\t\tclass="bx-im-market-show-more-popup-content-item__container"\n\t\t\t:title="marketItem.title"\n\t\t\t@click="onAppClick"\n\t\t\tref="market-app"\n\t\t>\n\t\t\t<div class="bx-im-market-show-more-popup-content-item__icon-container" :style="{backgroundColor: iconColor}">\n\t\t\t\t<i :class="iconClass" aria-hidden="true"></i>\n\t\t\t</div>\n\t\t\t<div class="bx-im-market-show-more-popup-content-item__title-container">\n\t\t\t\t<div class="bx-im-market-show-more-popup-content-item__title-text">\n\t\t\t\t\t{{ marketItem.title }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<MarketAppPopup\n\t\t\t\tv-if="showApp" \n\t\t\t\t:bindElement="$refs['market-app']" \n\t\t\t\t:entityId="marketItem.id"\n\t\t\t\t:width="marketItem.options.width"\n\t\t\t\t:height="marketItem.options.height" \n\t\t\t\t:dialogId="dialogId"\n\t\t\t\t@close="onAppClick"\n\t\t\t/>\n\t\t</div>\n\t`};const zi={name:"MarketShowMorePopupContent",components:{MarketShowMorePopupContentItem:Xi},props:{marketApps:{type:Array,required:true},dialogId:{type:String,required:true}},data(){return{isLoading:true,needTopShadow:false,needBottomShadow:true}},methods:{onListScroll(t){this.needBottomShadow=t.target.scrollTop+t.target.clientHeight!==t.target.scrollHeight;if(t.target.scrollTop===0){this.needTopShadow=false;return}this.needTopShadow=true}},template:`\n\t\t<div class="bx-im-market-show-more-popup-content__scope bx-im-market-show-more-popup-content__container">\n\t\t\t<div v-if="needTopShadow" class="bx-im-market-show-more-popup-content__shadow --top">\n\t\t\t\t<div class="bx-im-market-show-more-popup-content__shadow-inner"></div>\n\t\t\t</div>\n\t\t\t<div @scroll="onListScroll" class="bx-im-market-show-more-popup-content__items-container">\n\t\t\t\t<MarketShowMorePopupContentItem\n\t\t\t\t\tv-for="item in marketApps"\n\t\t\t\t\t:item="item"\n\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t@onAppClick="$emit('close')"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div v-if="needBottomShadow" class="bx-im-market-show-more-popup-content__shadow --bottom">\n\t\t\t\t<div class="bx-im-market-show-more-popup-content__shadow-inner"></div>\n\t\t\t</div>\n\t\t</div>\n\t`};const qi={name:"MarketShowMorePopup",components:{MessengerPopup:lt.MessengerPopup,MarketShowMorePopupContent:zi},props:{marketApps:{type:Array,required:true},dialogId:{type:String,required:true}},emits:["close"],data(){return{showPopup:false}},computed:{popupConfig(){return{titleBar:this.$Bitrix.Loc.getMessage("IM_TEXTAREA_MARKET_OTHER_APPS"),closeIcon:true,width:302,height:422,bindElement:this.$refs["textarea-show-more-market-apps"],bindOptions:{position:"top"},offsetTop:0,offsetLeft:0,padding:0,contentPadding:0,contentBackground:"#fff",className:"bx-im-market-show-more-popup__scope"}},showMoreButtonText(){return this.$Bitrix.Loc.getMessage("IM_TEXTAREA_MARKET_APPS_SHOW_MORE_BUTTON").replace("#NUMBER#",this.marketApps.length)}},template:`\n\t\t<div\n\t\t\t@click="showPopup = true"\n\t\t\tclass="bx-im-market-apps-panel__more-items-button"\n\t\t\t:class="{'--active': showPopup}"\n\t\t\tref="textarea-show-more-market-apps"\n\t\t>\n\t\t\t{{ showMoreButtonText }}\n\t\t</div>\n\t\t<MessengerPopup\n\t\t\tv-if="showPopup"\n\t\t\t:config="popupConfig"\n\t\t\t@close="showPopup = false"\n\t\t\tid="im-market-apps-more-popup"\n\t\t>\n\t\t\t<MarketShowMorePopupContent :marketApps='marketApps' :dialogId="dialogId" @close="showPopup = false" />\n\t\t</MessengerPopup>\n\t`};const Ki=5;const Gi=15;const Vi={name:"MarketAppsPanel",components:{MarketAppItem:ji,MarketShowMorePopup:qi,RichLoc:Q.RichLoc},props:{dialogId:{type:String,required:true}},computed:{marketMenuItems(){return Z.MarketManager.getInstance().getAvailablePlacementsByType(st.PlacementType.textarea,this.dialogId)},marketItemsToShow(){const t=this.hideTitle?Gi:Ki;return{displayedItems:this.marketMenuItems.slice(0,t),hiddenItems:this.marketMenuItems.slice(t)}},hideTitle(){return this.marketMenuItems.length>Ki},needMoreButton(){return this.marketItemsToShow.hiddenItems.length>0},isEmptyState(){return this.marketItemsToShow.displayedItems.length===0},emptyStateText(){return this.loc("IM_TEXTAREA_MARKET_APPS_EMPTY_STATE_MSGVER_2")}},methods:{onEmptyStateLinkClick(){Z.MarketManager.openChatMarket()},loc(t,e={}){return this.$Bitrix.Loc.getMessage(t,e)}},template:`\n\t\t<div class="bx-im-market-apps-panel__scope">\n\t\t\t<div v-if="isEmptyState" class="bx-im-market-apps-panel__empty-state-container">\n\t\t\t\t<div class="bx-im-market-apps-panel__empty-state-icon"></div>\n\t\t\t\t<div class="bx-im-market-apps-panel__empty-state-text">\n\t\t\t\t\t<RichLoc :text="emptyStateText" placeholder="[url]">\n\t\t\t\t\t\t<template #url="{ text }">\n\t\t\t\t\t\t\t<span class="bx-im-market-apps-panel__empty-state-link" @click="onEmptyStateLinkClick">\n\t\t\t\t\t\t\t\t{{ text }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</RichLoc>\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-im-market-apps-panel__empty-state-button"></div>\n\t\t\t</div>\n\t\t\t<div v-else class="bx-im-market-apps-panel__container">\n\t\t\t\t<div class="bx-im-market-apps-panel__items-container" :class="{'--short': hideTitle}">\n\t\t\t\t\t<MarketAppItem\n\t\t\t\t\t\tv-for="item in marketItemsToShow.displayedItems"\n\t\t\t\t\t\t:item="item"\n\t\t\t\t\t\t:hideTitle="hideTitle"\n\t\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<MarketShowMorePopup \n\t\t\t\t\tv-if="needMoreButton" \n\t\t\t\t\t:marketApps="marketItemsToShow.hiddenItems"\n\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`};const Wi={name:"TextareaPanel",components:{EditPanel:Hi,ReplyPanel:Di,ForwardPanel:Ni,MarketAppsPanel:Vi},props:{dialogId:{type:String,required:true},type:{type:String,required:true},context:{type:Object,required:true}},emits:["close"],computed:{PanelType:()=>st.TextareaPanelType,configContext(){return this.context}},template:`\n\t\t<EditPanel v-if="type === PanelType.edit" :messageId="configContext.messageId" @close="$emit('close')" />\n\t\t<ReplyPanel v-if="type === PanelType.reply" :messageId="configContext.messageId" @close="$emit('close')" />\n\t\t<ForwardPanel v-if="type === PanelType.forward" :context="configContext" @close="$emit('close')" />\n\t\t<MarketAppsPanel v-if="type === PanelType.market" :dialogId="dialogId" />\n\t`};const Qi=24;const Yi={name:"AutoDeleteSelector",components:{BIcon:mt.BIcon,AutoDeleteHint:J.AutoDeleteHint,AutoDeletePopup:J.AutoDeletePopup},props:{dialogId:{type:String,required:true}},data(){return{showAutoDeleteMessagesPopup:false,showAutoDeleteMessagesHintPopup:false,hintConfig:{width:316,offsetLeft:-106,offsetTop:5,angle:{offset:141}}}},computed:{OutlineIcons:()=>mt.Outline,ICON_SIZE:()=>Qi,Color:()=>st.Color,isAutoDeleteAllowed(){return et.AutoDeleteManager.isAutoDeleteAllowed(this.dialogId)},dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},autoDeleteDelayInHours(){return this.$store.getters["chats/autoDelete/getDelay"](this.dialog.chatId)}},methods:{onIconClick(){if(!this.isAutoDeleteAllowed){this.showAutoDeleteMessagesHintPopup=true;return}this.showAutoDeleteMessagesPopup=true},closePopup(){this.showAutoDeleteMessagesPopup=false},hideAutoDeleteMessagesHintPopup(){this.showAutoDeleteMessagesHintPopup=false},onAutoDeleteDelayChange(t){this.getChatService().setMessagesAutoDeleteDelay(this.dialogId,t);this.$emit("close")},getChatService(){if(!this.chatService){this.chatService=new tt.ChatService}return this.chatService},loc(t,e={}){return this.$Bitrix.Loc.getMessage(t,e)}},template:`\n\t\t<div ref="autoDeleteIcon" class="bx-im-textarea__icon-container">\n\t\t\t<BIcon \n\t\t\t\t:name="OutlineIcons.TIMER_DOT"\n\t\t\t\t:color="Color.accentBlue"\n\t\t\t\t:title="loc('IM_TEXTAREA_AUTO_DELETE_TITLE')"\n\t\t\t\t:size="ICON_SIZE"\n\t\t\t\tclass="bx-im-textarea__icon"\n\t\t\t\t@click="onIconClick"\n\t\t\t/>\n\t\t</div>\n\t\t<AutoDeletePopup\n\t\t\tv-if="showAutoDeleteMessagesPopup"\n\t\t\t:autoDeleteDelay="autoDeleteDelayInHours"\n\t\t\t@close="closePopup"\n\t\t\t@autoDeleteDelayChange="onAutoDeleteDelayChange"\n\t\t/>\n\t\t<AutoDeleteHint\n\t\t\tv-if="showAutoDeleteMessagesHintPopup"\n\t\t\t:bindElement="$refs['autoDeleteIcon']"\n\t\t\t:config="hintConfig"\n\t\t\t@close="hideAutoDeleteMessagesHintPopup"\n\t\t/>\n\t`};const Zi=34;const Ji={name:"LinkInput",components:{BInput:rt.BInput,BIcon:mt.BIcon},emits:["insertLink","close"],data(){return{linkUrl:""}},computed:{OutlineIcons:()=>mt.Outline,InputSize:()=>rt.InputSize,InputDesign:()=>rt.InputDesign,ICON_SIZE:()=>Zi,isValidLink(){if(this.linkUrl===""){return false}return ct.Utils.text.checkUrl(this.linkUrl)},acceptIconClass(){return{"--disabled":!this.isValidLink,"--active":this.isValidLink}}},methods:{onAccept(){this.$emit("insertLink",this.linkUrl)},onClose(){this.$emit("close")},loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<div class="bx-im-format-toolbar-link__container">\n\t\t\t<div class="bx-im-format-toolbar-link__content">\n\t\t\t\t<BInput\n\t\t\t\t\tv-model="linkUrl"\n\t\t\t\t\t:design="InputDesign.Primary"\n\t\t\t\t\t:label="loc('IM_TEXTAREA_FORMAT_TOOLBAR_LINK_LABEL')"\n\t\t\t\t\t:labelInline="true"\n\t\t\t\t\t:placeholder="loc('IM_TEXTAREA_FORMAT_TOOLBAR_LINK_PLACEHOLDER')"\n\t\t\t\t\t:size="InputSize.Md"\n\t\t\t\t\t:active="true"\n\t\t\t\t\tclass="bx-im-format-toolbar-link__input"\n\t\t\t\t\t@keydown.enter="onAccept"\n\t\t\t\t/>\n\t\t\t\t<BIcon\n\t\t\t\t\t:name="OutlineIcons.CHECK_S"\n\t\t\t\t\t:size="ICON_SIZE"\n\t\t\t\t\t:hoverableAlt="true"\n\t\t\t\t\tclass="bx-im-format-toolbar-link__action --accept"\n\t\t\t\t\t:class="acceptIconClass"\n\t\t\t\t\t@mousedown.prevent\n\t\t\t\t\t@click="onAccept"\n\t\t\t\t/>\n\t\t\t\t<BIcon\n\t\t\t\t\t:name="OutlineIcons.CROSS_S"\n\t\t\t\t\t:size="ICON_SIZE"\n\t\t\t\t\t:hoverableAlt="true"\n\t\t\t\t\tclass="bx-im-format-toolbar-link__action"\n\t\t\t\t\t@mousedown.prevent\n\t\t\t\t\t@click="onClose"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`};const to={bold:"bold",italic:"italic",underline:"underline",strikethrough:"strikethrough",link:"link",quote:"quote",code:"code",separator:"separator"};const eo="im-format-toolbar-popup";const so={name:"FormatToolbar",components:{MessengerPopup:lt.MessengerPopup,LinkInput:Ji,BIcon:mt.BIcon},props:{dialogId:{type:String,default:""},textarea:{type:HTMLTextAreaElement,required:true},targetPosition:{type:Object,required:true,validator(t){return it.Type.isNumber(t.left)&&it.Type.isNumber(t.top)}}},emits:["close","updateText"],data(){return{linkMode:false}},computed:{POPUP_ID:()=>eo,ToolbarItem:()=>to,config(){return{bindElement:this.targetPosition,bindOptions:{forceBindPosition:true,position:"top"},autoHide:true,padding:0,contentBorderRadius:12}},toolbarItems(){return[{name:to.bold,icon:mt.Outline.BOLD,title:this.loc("IM_TEXTAREA_FORMAT_TOOLBAR_ITEM_BOLD"),handler:()=>this.applyDecoration("KeyB")},{name:to.italic,icon:mt.Outline.ITALIC,title:this.loc("IM_TEXTAREA_FORMAT_TOOLBAR_ITEM_ITALIC"),handler:()=>this.applyDecoration("KeyI")},{name:to.underline,icon:mt.Outline.UNDERLINE,title:this.loc("IM_TEXTAREA_FORMAT_TOOLBAR_ITEM_UNDERLINE"),handler:()=>this.applyDecoration("KeyU")},{name:to.strikethrough,icon:mt.Outline.STRIKETHROUGH,title:this.loc("IM_TEXTAREA_FORMAT_TOOLBAR_ITEM_STRIKETHROUGH"),handler:()=>this.applyDecoration("KeyS")},{name:to.separator},{name:to.link,icon:mt.Outline.LINK,title:this.loc("IM_TEXTAREA_FORMAT_TOOLBAR_ITEM_LINK"),handler:()=>this.openLinkMode()},{name:to.code,icon:mt.Outline.DEVELOPER_RESOURCES,title:this.loc("IM_TEXTAREA_FORMAT_TOOLBAR_ITEM_CODE"),handler:()=>this.applyDecoration("code")}]}},methods:{openLinkMode(){this.linkMode=true},onCloseLinkMode(){this.linkMode=false},applyDecoration(t){const e=nt.Textarea.handleDecorationTag(this.textarea,t);this.updateText(e)},onInsertLink(t){const e=nt.Textarea.addUrlTag(this.textarea,t);this.updateText(e);this.$emit("close")},insertQuote(){const t=nt.Textarea.prepareInlineQuote(this.textarea);at.Quote.sendQuoteEvent({text:t,dialogId:this.dialogId,context:{emitter:this.getEmitter()},additionalParams:{replace:true}})},updateText(t){this.$emit("updateText",t)},getEmitter(){return this.$Bitrix.eventEmitter},loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<MessengerPopup\n\t\t\t:config="config"\n\t\t\t:id="POPUP_ID"\n\t\t\t@close="$emit('close')"\n\t\t>\n\t\t\t<LinkInput v-if="linkMode" @insertLink="onInsertLink" @close="onCloseLinkMode" />\n\t\t\t<div v-else class="bx-im-format-toolbar__container">\n\t\t\t\t<template v-for="item in toolbarItems">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if="item.name === ToolbarItem.separator"\n\t\t\t\t\t\tclass="bx-im-format-toolbar__separator"\n\t\t\t\t\t></div>\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\t:key="item.name"\n\t\t\t\t\t\t:name="item.icon"\n\t\t\t\t\t\t:title="item.title"\n\t\t\t\t\t\t:hoverableAlt="true"\n\t\t\t\t\t\tclass="bx-im-format-toolbar__item"\n\t\t\t\t\t\t@mousedown.prevent\n\t\t\t\t\t\t@click="item.handler"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</MessengerPopup>\n\t`};const io=new Set([st.TextareaPanelType.edit,st.TextareaPanelType.reply,st.TextareaPanelType.forward]);const oo={max:400,min:22};const no=24;const lo={components:{UploadMenu:Os,SmileSelector:Ve,EmoteSelector:Ls,SendButton:R.SendButton,UploadPreviewPopup:Gs,MentionPopup:Ri,TextareaPanel:Wi,AudioInput:He,AutoDeleteSelector:Yi,BIcon:mt.BIcon,FormatToolbar:so},props:{dialogId:{type:String,default:""},placeholder:{type:String,default:""},withMarket:{type:Boolean,default:true},withEdit:{type:Boolean,default:true},withUploadMenu:{type:Boolean,default:true},withSmileSelector:{type:Boolean,default:true},withAutoFocus:{type:Boolean,default:true},withMention:{type:Boolean,default:true}},emits:["mounted"],data(){return{text:"",textareaHeight:oo.min,showMention:false,mentionQuery:"",showUploadPreviewPopup:false,previewPopupUploaderIds:[],previewPopupUploadingId:null,previewPopupSourceFilesCount:0,panelType:st.TextareaPanelType.none,panelContext:{messageId:0},showFormatToolbar:false,formatToolbarPosition:{}}},computed:{OutlineIcons:()=>mt.Outline,ICON_SIZE:()=>no,dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},dialogInited(){return this.dialog.inited},replyMode(){return this.panelType===st.TextareaPanelType.reply},forwardMode(){return this.panelType===st.TextareaPanelType.forward},editMode(){return this.panelType===st.TextareaPanelType.edit},marketMode(){return this.panelType===st.TextareaPanelType.market},isDisabled(){return this.text.trim()===""&&!this.editMode&&!this.forwardMode},textareaPlaceholder(){if(!this.placeholder){return this.loc("IM_TEXTAREA_PLACEHOLDER_V3")}return this.placeholder},textareaStyle(){let t=`${this.textareaHeight}px`;if(this.textareaHeight==="auto"){t="auto"}return{height:t,maxHeight:t}},textareaMaxLength(){const t=it.Extension.getSettings("im.v2.component.textarea");return t.get("maxLength")},isEmptyText(){return this.text===""},isAutoDeleteEnabled(){return this.$store.getters["chats/autoDelete/isEnabled"](this.dialog.chatId)},marketIconColor(){if(this.marketMode){return st.Color.accentBlue}return st.Color.gray40},isFocused(){return this.$refs.textarea===document.activeElement},areStickersAvailable(){return O.FeatureManager.isFeatureAvailable(O.Feature.stickersAvailable)},showSmileSelector(){return this.withSmileSelector&&!this.areStickersAvailable},showEmoteSelector(){return this.withSmileSelector&&this.areStickersAvailable},isFormatToolbarAvailable(){const t=O.FeatureManager.isFeatureAvailable(O.Feature.isTextFormatToolbarAvailable);return t&&this.showFormatToolbar}},watch:{text(t){this.adjustTextareaHeight();this.getDraftManager().setDraftText(this.dialogId,t);if(it.Type.isStringFilled(t)){this.getInputActionService().startAction(n.InputAction.writing)}}},created(){this.initResizeManager();this.restoreTextareaHeight();void this.restorePanel();this.initSendingService();g.EventEmitter.subscribe(st.EventType.dialog.onMessageDeleted,this.onMessageDeleted);this.getEmitter().subscribe(st.EventType.textarea.sendMessage,this.onSendMessage);this.getEmitter().subscribe(st.EventType.textarea.insertText,this.onInsertText);this.getEmitter().subscribe(st.EventType.textarea.insertMention,this.onInsertMention);this.getEmitter().subscribe(st.EventType.textarea.insertForward,this.onInsertForward);this.getEmitter().subscribe(st.EventType.textarea.editMessage,this.onEditMessage);this.getEmitter().subscribe(st.EventType.textarea.replyMessage,this.onReplyMessage);this.getEmitter().subscribe(st.EventType.dialog.closeComments,this.onCloseComments);this.getEmitter().subscribe(st.EventType.textarea.openUploadPreview,this.onOpenUploadPreview);this.getEmitter().subscribe(st.EventType.key.onBeforeEscape,this.onBeforeEscape)},mounted(){void this.initMentionManager();if(this.withAutoFocus){this.focus()}this.$emit("mounted")},beforeUnmount(){this.resizeManager.destroy();this.getToolbarManager().destroy();this.unbindUploadingService();g.EventEmitter.unsubscribe(st.EventType.dialog.onMessageDeleted,this.onMessageDeleted);this.getEmitter().unsubscribe(st.EventType.textarea.sendMessage,this.onSendMessage);this.getEmitter().unsubscribe(st.EventType.textarea.insertMention,this.onInsertMention);this.getEmitter().unsubscribe(st.EventType.textarea.insertText,this.onInsertText);this.getEmitter().unsubscribe(st.EventType.textarea.insertForward,this.onInsertForward);this.getEmitter().unsubscribe(st.EventType.textarea.editMessage,this.onEditMessage);this.getEmitter().unsubscribe(st.EventType.textarea.replyMessage,this.onReplyMessage);this.getEmitter().unsubscribe(st.EventType.dialog.closeComments,this.onCloseComments);this.getEmitter().unsubscribe(st.EventType.textarea.openUploadPreview,this.onOpenUploadPreview);this.getEmitter().unsubscribe(st.EventType.key.onBeforeEscape,this.onBeforeEscape)},methods:{sendMessage(){this.text=this.text.trim();if(this.isDisabled||!this.dialogInited){return}const t=this.mentionManager.replaceMentions(this.text);if(this.hasActiveMessageAction()){this.handlePanelAction(t);this.closePanel()}else{this.getSendingService().sendMessage({text:t,dialogId:this.dialogId});o.SoundNotificationManager.getInstance().playOnce(st.SoundType.send)}this.getInputActionService().stopAction(n.InputAction.writing);this.clear();this.getDraftManager().clearDraft(this.dialogId);this.focus();this.getEmitter().emit(st.EventType.textarea.onAfterSendMessage)},handlePanelAction(t){if(this.editMode){this.handleEditAction(t)}else if(this.forwardMode){void this.getSendingService().forwardMessages({text:t,dialogId:this.dialogId,forwardIds:this.panelContext.messagesIds});o.SoundNotificationManager.getInstance().playOnce(st.SoundType.send)}else if(this.replyMode){this.getSendingService().sendMessage({text:t,dialogId:this.dialogId,replyId:this.panelContext.messageId});o.SoundNotificationManager.getInstance().playOnce(st.SoundType.send)}},handleEditAction(t){if(t===""&&!this.messageHasFiles(this.panelContext.messageId)){return this.getMessageService().deleteMessages([this.panelContext.messageId])}return this.getMessageService().editMessageText(this.panelContext.messageId,t)},messageHasFiles(t){const e=this.$store.getters["messages/getById"](t);if(!e){return false}return e.files.length>0},clear(){var t;this.text="";(t=this.mentionManager)==null?void 0:t.clearMentionReplacements()},hasActiveMessageAction(){return io.has(this.panelType)},closePanel(){if(this.editMode){this.clear()}this.panelType=st.TextareaPanelType.none;this.panelContext={messageId:0};this.draftManager.setDraftPanel(this.dialogId,this.panelType,this.panelContext)},openEditPanel(t){if(!this.withEdit){return}const e=this.$store.getters["messages/getById"](t);if(e.isDeleted){return}this.panelType=st.TextareaPanelType.edit;this.panelContext.messageId=t;const s=this.mentionManager.extractMentions(e.text);this.mentionManager.setMentionReplacements(s);this.text=W.Parser.prepareEdit(e);this.focus();this.draftManager.setDraftText(this.dialogId,this.text);this.draftManager.setDraftPanel(this.dialogId,this.panelType,this.panelContext);this.draftManager.setDraftMentions(this.dialogId,s)},openReplyPanel(t){if(this.editMode){this.clear()}this.panelType=st.TextareaPanelType.reply;this.panelContext.messageId=t;this.focus();this.draftManager.setDraftPanel(this.dialogId,this.panelType,this.panelContext)},openForwardPanel(t){this.panelType=st.TextareaPanelType.forward;this.panelContext.messageId=0;this.panelContext.messagesIds=t;this.clear();this.focus();this.draftManager.setDraftPanel(this.dialogId,this.panelType,this.panelContext)},toggleMarketPanel(){if(this.marketMode){this.panelType=st.TextareaPanelType.none;return}this.panelType=st.TextareaPanelType.market;this.panelContext.messageId=0},async adjustTextareaHeight(){this.textareaHeight="auto";await this.$nextTick();const t=Math.min(oo.max,this.$refs.textarea.scrollHeight);if(this.resizedTextareaHeight){this.textareaHeight=Math.max(t,this.resizedTextareaHeight);return}this.textareaHeight=Math.max(t,oo.min)},saveTextareaHeight(){const t=200;clearTimeout(this.saveTextareaTimeout);this.saveTextareaTimeout=setTimeout((()=>{b.LocalStorageManager.getInstance().set(st.LocalStorageKey.textareaHeight,this.resizedTextareaHeight)}),t)},restoreTextareaHeight(){const t=b.LocalStorageManager.getInstance().get(st.LocalStorageKey.textareaHeight);const e=Number.parseInt(t,10);if(!e){return}this.resizedTextareaHeight=e;this.textareaHeight=e},checkMessageExists(t){return this.$store.getters["messages/isExists"](t)},verifyPanelContext(t){if(t.messagesIds){return t.messagesIds.every((t=>this.checkMessageExists(t)))}return this.checkMessageExists(t.messageId)},async restorePanel(){const{text:t="",panelType:e=st.TextareaPanelType.none,panelContext:s={messageId:0}}=await this.getDraftManager().getDraft(this.dialogId);const i=this.panelType===st.TextareaPanelType.none;if(!i&&!this.verifyPanelContext(s)){return}this.text=t;if(i){this.panelType=e}this.panelContext=s},onBeforeEscape(){if(this.hasActiveMessageAction()){this.closePanel();return l.EscEventAction.handled}if(this.isFocused&&!this.isEmptyText){return l.EscEventAction.handled}return l.EscEventAction.ignored},onMouseUp(t){this.getToolbarManager().handleTextSelect(t,this.$refs.textarea)},async onKeyDown(t){x.Analytics.getInstance().onTypeMessage(this.dialog);this.getToolbarManager().hide();if(this.showMention&&this.withMention){this.mentionManager.onActiveMentionKeyDown(t);return}const e=L.isSendMessageCombination(t);const s=L.isNewLineCombination(t);if(e&&!s){t.preventDefault();this.sendMessage();return}if(s){this.handleNewLine();return}const i=ct.Utils.key.isCombination(t,"Tab");if(i){this.handleTab(t);return}const o=ct.Utils.key.isExactCombination(t,["Ctrl+b","Ctrl+i","Ctrl+u","Ctrl+s"]);if(o){t.preventDefault();this.text=nt.Textarea.handleDecorationTag(this.$refs.textarea,t.code);return}if(this.text===""&&ct.Utils.key.isCombination(t,"ArrowUp")){this.handleLastOwnMessageEdit(t);return}this.mentionManager.onKeyDown(t)},handleNewLine(){this.text=nt.Textarea.addNewLine(this.$refs.textarea)},handleTab(t){t.preventDefault();if(t.shiftKey){this.text=nt.Textarea.removeTab(this.$refs.textarea);return}this.text=nt.Textarea.addTab(this.$refs.textarea)},handleLastOwnMessageEdit(t){t.preventDefault();const e=this.$store.getters["messages/getLastOwnMessageId"](this.dialog.chatId);const s=a.MessageManager.isEditable(e);if(s){this.openEditPanel(e)}},onSendMessage(t){const{text:e,dialogId:s}=t.getData();if(this.dialogId!==s){return}this.getSendingService().sendMessage({text:e,dialogId:this.dialogId})},onResizeStart(t){this.resizeManager.onResizeStart(t,this.textareaHeight)},async onFileSelect({event:t,sendAsFile:e}){const s=this.getMultiUploadingService();const i=await s.upload({files:Object.values(t.target.files),sendAsFile:e,dialogId:this.dialogId,autoUpload:false});this.showUploadPreviewPopup=true;this.previewPopupUploaderIds=i.uploaderIds;this.previewPopupUploadingId=i.uploadingId;this.previewPopupSourceFilesCount=i.sourceFilesCount},onDiskFileSelect({files:t}){this.getUploadingService().uploadFileFromDisk(t,this.dialogId)},onInsertMention(t){const{mentionText:e,mentionReplacement:s,dialogId:i,isMentionSymbol:o=true}=t.getData();let{textToReplace:n=""}=t.getData();if(this.dialogId!==i){return}const l=this.mentionManager.addMentionReplacement(e,s);this.draftManager.setDraftMentions(this.dialogId,l);const a=o?this.mentionManager.getMentionSymbol():"";n=`${a}${n}`;this.text=nt.Textarea.insertMention(this.$refs.textarea,{textToInsert:e,textToReplace:n});this.mentionManager.clearMentionSymbol()},onInsertText(t){const{dialogId:e}=t.getData();if(this.dialogId!==e){return}this.text=nt.Textarea.insertText(this.$refs.textarea,t.getData())},onEditMessage(t){const{messageId:e,dialogId:s}=t.getData();if(this.dialogId!==s){return}this.openEditPanel(e)},onReplyMessage(t){const{messageId:e,dialogId:s}=t.getData();if(this.dialogId!==s){return}this.openReplyPanel(e)},onInsertForward(t){const{messagesIds:e,dialogId:s}=t.getData();if(this.dialogId!==s){return}this.openForwardPanel(e)},async onPaste(t){this.text=nt.Textarea.handlePasteUrl(this.$refs.textarea,t);if(!this.withUploadMenu){return}if(!t.clipboardData||!s.isFilePasted(t.clipboardData)){return}t.preventDefault();const e=this.getMultiUploadingService();const i=await e.upload({files:await s.getFilesFromDataTransfer(t.clipboardData),dialogId:this.dialogId,autoUpload:false});if(!it.Type.isArrayFilled(i.uploaderIds)){return}this.showUploadPreviewPopup=true;this.previewPopupUploaderIds=i.uploaderIds;this.previewPopupUploadingId=i.uploadingId;this.previewPopupSourceFilesCount=i.sourceFilesCount},onOpenUploadPreview(t){const{multiUploadingResult:e}=t.getData();this.showUploadPreviewPopup=true;this.previewPopupUploaderIds=e.uploaderIds;this.previewPopupUploadingId=e.uploadingId;this.previewPopupSourceFilesCount=e.sourceFilesCount},onMarketIconClick(){this.toggleMarketPanel()},onMessageDeleted(t){const{messageId:e}=t.getData();if(this.panelContext.messageId===e){this.closePanel()}if(this.panelContext.messagesIds&&this.panelContext.messagesIds.includes(e)){this.closePanel()}},onShowFormatToolbar(t){const{bindPosition:e}=t.getData();this.formatToolbarPosition=e;this.showFormatToolbar=true},onHideFormatToolbar(){this.showFormatToolbar=false},onFormatToolbarUpdateText(t){this.text=t},initResizeManager(){this.resizeManager=new ue({direction:pe.up,maxHeight:oo.max,minHeight:oo.min});this.resizeManager.subscribe(ue.events.onHeightChange,(({data:{newHeight:t}})=>{$.Logger.warn("Textarea: Resize height change",t);this.textareaHeight=t}));this.resizeManager.subscribe(ue.events.onResizeStop,(()=>{$.Logger.warn("Textarea: Resize stop");this.resizedTextareaHeight=this.textareaHeight;this.saveTextareaHeight()}))},initSendingService(){if(this.sendingService){return}this.sendingService=f.SendingService.getInstance()},async initMentionManager(){const{mentions:t={}}=await this.getDraftManager().getDraft(this.dialogId);this.mentionManager=new Ot({textareaElement:this.$refs.textarea,context:{emitter:this.getEmitter()}});this.mentionManager.setMentionReplacements(t);this.mentionManager.subscribe(ht.showMentionPopup,(t=>{const{mentionQuery:e}=t.getData();this.showMentionPopup(e)}));this.mentionManager.subscribe(ht.hideMentionPopup,(()=>{this.closeMentionPopup()}))},getSendingService(){return this.sendingService},getInputActionService(){if(!this.inputSenderService){this.inputSenderService=new me(this.dialogId)}return this.inputSenderService},getDraftManager(){if(!this.draftManager){this.draftManager=C.DraftManager.getInstance()}return this.draftManager},getToolbarManager(){if(!this.toolbarManager){this.toolbarManager=new Pe;this.toolbarManager.subscribe(Pe.events.show,this.onShowFormatToolbar);this.toolbarManager.subscribe(Pe.events.hide,this.onHideFormatToolbar)}return this.toolbarManager},getMessageService(){if(!this.messageService){this.messageService=new i.MessageService({chatId:this.dialog.chatId})}return this.messageService},getUploadingService(){if(!this.uploadingService){this.initUploadingService()}return this.uploadingService},initUploadingService(){this.uploadingService=F.UploadingService.getInstance();this.startFileUploadAction=()=>{this.getInputActionService().startAction(n.InputAction.sendingFile)};this.stopFileUploadAction=()=>{this.getInputActionService().stopAction(n.InputAction.sendingFile)};this.uploadingService.subscribe(F.UploadingService.event.uploadStart,this.startFileUploadAction);this.uploadingService.subscribe(F.UploadingService.event.uploadComplete,this.stopFileUploadAction);this.uploadingService.subscribe(F.UploadingService.event.uploadCancel,this.stopFileUploadAction);this.uploadingService.subscribe(F.UploadingService.event.uploadError,this.stopFileUploadAction)},unbindUploadingService(){if(!this.uploadingService){return}this.uploadingService.unsubscribe(F.UploadingService.event.uploadStart,this.startFileUploadAction);this.uploadingService.unsubscribe(F.UploadingService.event.uploadComplete,this.stopFileUploadAction);this.uploadingService.unsubscribe(F.UploadingService.event.uploadCancel,this.stopFileUploadAction);this.uploadingService.unsubscribe(F.UploadingService.event.uploadError,this.stopFileUploadAction)},getMultiUploadingService(){if(!this.multiUploadingService){this.multiUploadingService=new F.MultiUploadingService}return this.multiUploadingService},async onSendFilesFromPreviewPopup(t){this.text="";const{text:e,files:s,sendAsFile:i}=t;const o=this.mentionManager.replaceMentions(e);const n=await this.getMultiUploadingService().upload({files:s,dialogId:this.dialogId,autoUpload:false,sendAsFile:i});await n.loadAllComplete;n.uploaderIds.forEach(((t,e)=>{this.getUploadingService().sendMessageWithFiles({uploaderId:t,text:e===0?o:""})}));this.focus()},closeMentionPopup(){this.showMention=false;this.mentionQuery="";this.mentionManager.onMentionPopupClose()},showMentionPopup(t){this.mentionQuery=t;this.showMention=true},focus(){var t;(t=this.$refs.textarea)==null?void 0:t.focus({preventScroll:true})},loc(t){return this.$Bitrix.Loc.getMessage(t)},onAudioInputStart(){if(this.isEmptyText){return}this.text+=" "},onAudioInputResult(t){this.text+=t},onCloseComments(){this.restoreTextareaHeight()},getEmitter(){return this.$Bitrix.eventEmitter}},template:`\n\t\t<div class="bx-im-send-panel__scope bx-im-send-panel__container --ui-context-content-light">\n\t\t\t<div class="bx-im-textarea__container">\n\t\t\t\t<div @mousedown="onResizeStart" class="bx-im-textarea__drag-handle"></div>\n\t\t\t\t<TextareaPanel\n\t\t\t\t\t:type="panelType"\n\t\t\t\t\t:context="panelContext"\n\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t@close="closePanel"\n\t\t\t\t/>\n\t\t\t\t<div class="bx-im-textarea__content" ref="textarea-content" @click="focus">\n\t\t\t\t\t<div class="bx-im-textarea__top">\n\t\t\t\t\t\t<UploadMenu\n\t\t\t\t\t\t\tv-if="withUploadMenu"\n\t\t\t\t\t\t\t:dialogId="dialogId" \n\t\t\t\t\t\t\t@fileSelect="onFileSelect" \n\t\t\t\t\t\t\t@diskFileSelect="onDiskFileSelect" \n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tv-model="text"\n\t\t\t\t\t\t\t:style="textareaStyle"\n\t\t\t\t\t\t\t:placeholder="textareaPlaceholder"\n\t\t\t\t\t\t\t:maxlength="textareaMaxLength"\n\t\t\t\t\t\t\t@keydown="onKeyDown"\n\t\t\t\t\t\t\t@mouseup="onMouseUp"\n\t\t\t\t\t\t\t@paste="onPaste"\n\t\t\t\t\t\t\tclass="bx-im-textarea__element"\n\t\t\t\t\t\t\tref="textarea"\n\t\t\t\t\t\t\trows="1"\n\t\t\t\t\t\t></textarea>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="bx-im-textarea__bottom">\n\t\t\t\t\t\t<slot name="bottom-panel-buttons"></slot>\n\t\t\t\t\t\t<AutoDeleteSelector\n\t\t\t\t\t\t\tv-if="isAutoDeleteEnabled"\n\t\t\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\tv-if="withMarket"\n\t\t\t\t\t\t\t:name="OutlineIcons.APPS"\n\t\t\t\t\t\t\t:title="loc('IM_TEXTAREA_ICON_APPLICATION')"\n\t\t\t\t\t\t\t:size="ICON_SIZE"\n\t\t\t\t\t\t\t:color="marketIconColor"\n\t\t\t\t\t\t\tclass="bx-im-textarea__icon"\n\t\t\t\t\t\t\t@click="onMarketIconClick"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<SmileSelector\n\t\t\t\t\t\t\tv-if="showSmileSelector"\n\t\t\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<EmoteSelector\n\t\t\t\t\t\t\tv-if="showEmoteSelector"\n\t\t\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<AudioInput\n\t\t\t\t\t\t\t:dialogId="dialogId"\n\t\t\t\t\t\t\t@inputStart="onAudioInputStart"\n\t\t\t\t\t\t\t@inputResult="onAudioInputResult"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<SendButton :dialogId="dialogId" :editMode="editMode" :isDisabled="isDisabled" @click="sendMessage" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<UploadPreviewPopup\n\t\t\t\tv-if="showUploadPreviewPopup"\n\t\t\t\t:dialogId="dialogId"\n\t\t\t\t:uploaderIds="previewPopupUploaderIds"\n\t\t\t\t:uploadingId="previewPopupUploadingId"\n\t\t\t\t:sourceFilesCount="previewPopupSourceFilesCount"\n\t\t\t\t:textareaValue="text"\n\t\t\t\t@close="showUploadPreviewPopup = false"\n\t\t\t\t@sendFiles="onSendFilesFromPreviewPopup"\n\t\t\t/>\n\t\t\t<MentionPopup \n\t\t\t\tv-if="withMention && showMention" \n\t\t\t\t:bindElement="$refs['textarea-content']"\n\t\t\t\t:dialogId="dialogId"\n\t\t\t\t:query="mentionQuery"\n\t\t\t\t@close="closeMentionPopup"\n\t\t\t/>\n\t\t\t<FormatToolbar \n\t\t\t\tv-if="isFormatToolbarAvailable"\n\t\t\t\t:dialogId="dialogId" \n\t\t\t\t:textarea="$refs.textarea" \n\t\t\t\t:targetPosition="formatToolbarPosition"\n\t\t\t\t@updateText="onFormatToolbarUpdateText"\n\t\t\t\t@close="showFormatToolbar = false"\n\t\t\t/>\n\t\t</div>\n\t`};t.ChatTextarea=lo})(this.BX.Messenger.v2.Component=this.BX.Messenger.v2.Component||{},BX??{},BX?.UI?.Uploader??{},BX?.Messenger?.v2?.Service??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Component?.Elements??{},BX?.Messenger?.v2?.Lib??{},BX?.UI?.System?.Chip?.Vue??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Component?.Elements??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Provider?.Service??{},BX??{},BX?.Event??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Service??{},BX?.Messenger?.v2?.Component??{},BX?.Messenger?.v2?.Lib??{},BX?.Calendar?.Sharing??{},BX?.Vote??{},BX?.Messenger?.v2?.Component?.Elements??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX??{},BX?.Messenger?.v2?.Model??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Service??{},BX?.Messenger?.v2?.Component?.Elements??{},BX?.Messenger?.v2?.Component?.Elements??{},BX??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Component?.Elements??{},BX?.Messenger?.v2?.Component?.Elements??{},BX?.Messenger?.v2?.Component?.Elements??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Application??{},BX?.Messenger?.v2?.Lib??{},BX?.UI?.Vue3?.Components??{},BX?.Messenger?.v2?.Component?.Elements??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Component?.Elements??{},BX?.Messenger?.v2?.Service??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Const??{},BX??{},BX?.Main??{},BX?.Messenger?.v2?.Lib??{},BX?.Messenger?.v2?.Component?.Elements??{},BX?.Messenger?.v2?.Lib??{},BX?.UI?.System?.Input?.Vue??{},BX?.UI?.IconSet??{},BX?.Messenger?.v2?.Lib??{});
//# sourceMappingURL=textarea.bundle.map.js