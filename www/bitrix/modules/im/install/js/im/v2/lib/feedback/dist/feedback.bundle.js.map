{"version":3,"file":"feedback.bundle.js","sources":["../src/const/const.js","../src/feedback.js"],"sourcesContent":["const AI_ASSISTANT_FORM_ID = 'im.ai-assistant.feedback';\nconst COPILOT_FORM_ID = 'im.copilot.feedback';\nconst GENERAL_FORM_ID = 'im-v2-feedback';\n\nexport const FormContext = {\n\taiAssistantBot: 'chat_ai-assistant_one_by_one',\n\tcopilotBot: 'chat_copilot_tab_one_by_one',\n\tcopilotGroup: 'chat_copilot_tab_multi',\n\tgeneral: 'profile',\n};\n\nexport const FormConfigAiAssistant = {\n\tid: AI_ASSISTANT_FORM_ID,\n\tforms: [\n\t\t{ zones: ['es'], id: 838, lang: 'es', sec: 'm82wkx' },\n\t\t{ zones: ['en'], id: 834, lang: 'en', sec: 'qnauno' },\n\t\t{ zones: ['de'], id: 836, lang: 'de', sec: 'frcsm3' },\n\t\t{ zones: ['com.br'], id: 840, lang: 'com.br', sec: 'ufjnte' },\n\t\t{ zones: ['ru', 'kz', 'by', 'uz'], id: 2982, lang: 'ru', sec: 'vqmcxn' },\n\t],\n};\n\nexport const FormConfigCopilot = {\n\tid: COPILOT_FORM_ID,\n\tforms: [\n\t\t{ zones: ['es'], id: 684, lang: 'es', sec: 'svvq1x' },\n\t\t{ zones: ['en'], id: 686, lang: 'en', sec: 'tjwodz' },\n\t\t{ zones: ['de'], id: 688, lang: 'de', sec: 'nrwksg' },\n\t\t{ zones: ['com.br'], id: 690, lang: 'com.br', sec: 'kpte6m' },\n\t\t{ zones: ['ru', 'by', 'kz'], id: 692, lang: 'ru', sec: 'jbujn0' },\n\t],\n};\n\nexport const FormConfigGeneral = {\n\tid: GENERAL_FORM_ID,\n\tforms: [\n\t\t{ zones: ['ru'], id: 550, sec: '50my2x', lang: 'ru' },\n\t\t{ zones: ['en'], id: 560, sec: '621lbr', lang: 'en' },\n\t],\n};\n","import { Runtime } from 'main.core';\n\nimport { Core } from 'im.v2.application.core';\n\nimport {\n\tFormConfigAiAssistant,\n\tFormConfigCopilot,\n\tFormConfigGeneral,\n\tFormContext,\n} from './const/const';\n\nimport type {\n\tFormConfigType,\n\tCopilotFormParams,\n\tAiAssistantFormParams,\n} from './types/types';\n\nconst FEEDBACK_EXTENSION = 'ui.feedback.form';\n\nexport class FeedbackManager\n{\n\tasync openAiAssistantForm(params: AiAssistantFormParams): Promise<void>\n\t{\n\t\tconst { id, forms } = FormConfigAiAssistant;\n\t\tconst formattedId = `${id}-${this.#generateFormIdSuffix()}`;\n\t\tconst config = {\n\t\t\tid: formattedId,\n\t\t\tforms,\n\t\t\tpresets: {\n\t\t\t\tsender_page: FormContext.aiAssistantBot,\n\t\t\t\tcontextId: params.contextId ?? '',\n\t\t\t\tmessage: params.message ?? '',\n\t\t\t},\n\t\t};\n\n\t\tvoid this.#openForm(config);\n\t}\n\n\tasync openCopilotForm(params: CopilotFormParams): Promise<void>\n\t{\n\t\tconst { id, forms } = FormConfigCopilot;\n\t\tconst formattedId = `${id}-${this.#generateFormIdSuffix()}`;\n\t\tconst context = params.userCounter <= 2 ? FormContext.copilotBot : FormContext.copilotGroup;\n\t\tconst config = {\n\t\t\tid: formattedId,\n\t\t\tforms,\n\t\t\tpresets: {\n\t\t\t\tsender_page: context,\n\t\t\t\tlanguage: Core.getLanguageId(),\n\t\t\t\tcp_answer: params.text,\n\t\t\t},\n\t\t};\n\n\t\tvoid this.#openForm(config);\n\t}\n\n\tasync openGeneralForm(): Promise<void>\n\t{\n\t\tconst { id, forms } = FormConfigGeneral;\n\t\tconst config = {\n\t\t\tid,\n\t\t\tforms,\n\t\t\tpresets: { sender_page: FormContext.general },\n\t\t};\n\n\t\tvoid this.#openForm(config);\n\t}\n\n\tasync #openForm(config: FormConfigType): Promise<void>\n\t{\n\t\tawait Runtime.loadExtension(FEEDBACK_EXTENSION);\n\t\tBX.UI.Feedback.Form.open(config);\n\t}\n\n\t#generateFormIdSuffix(): number\n\t{\n\t\treturn Math.round(Math.random() * 1000);\n\t}\n}\n"],"names":["AI_ASSISTANT_FORM_ID","COPILOT_FORM_ID","GENERAL_FORM_ID","FormContext","aiAssistantBot","copilotBot","copilotGroup","general","FormConfigAiAssistant","id","forms","zones","lang","sec","FormConfigCopilot","FormConfigGeneral","FEEDBACK_EXTENSION","FeedbackManager","openAiAssistantForm","params","formattedId","config","presets","sender_page","contextId","message","openCopilotForm","context","userCounter","language","Core","getLanguageId","cp_answer","text","openGeneralForm","Runtime","loadExtension","BX","UI","Feedback","Form","open","Math","round","random"],"mappings":"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"}