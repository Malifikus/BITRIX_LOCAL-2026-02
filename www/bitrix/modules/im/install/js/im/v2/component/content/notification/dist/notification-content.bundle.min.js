this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};this.BX.Messenger.v2.Component=this.BX.Messenger.v2.Component||{};(function(t,e,i,n,s,o,a,r,c,l,u,d,h,m,f,p,v,g,I,b,T,_,C,y,S,N,E,A,k,x,D,B,O,P,L,M){"use strict";class F{constructor(){this.itemsToRead=new Set;this.changeReadStatusBlockTimeout={};this.store=O.Core.getStore();this.restClient=O.Core.getRestClient();this.readOnClientWithDebounce=B.Runtime.debounce(this.readOnClient,50,this);this.readRequestWithDebounce=B.Runtime.debounce(this.readRequest,500,this)}addToReadQueue(t){if(!B.Type.isArrayFilled(t)){return}t.forEach((t=>{if(!B.Type.isNumber(t)){return}const e=this.store.getters["notifications/getById"](t);if(e.read){return}this.itemsToRead.add(t)}))}read(){this.readOnClientWithDebounce();this.readRequestWithDebounce()}readRequest(){if(this.itemsToRead.size===0){return}const t=this.store.getters["notifications/getSortedCollection"];const e=t.filter((t=>t.sectionCode===M.NotificationTypesCodes.confirm));const i=new Set(e.map((t=>t.id)));const n=[...this.itemsToRead];const s=n.filter((t=>!i.has(t)));if(s.length===0){this.itemsToRead.clear();return}const o={ids:s};a.runAction(M.RestMethod.imV2NotifyRead,{data:o}).then((t=>{L.Logger.warn(`I have read all the notifications, total: ${s.length}`,t)})).catch((t=>{console.error("NotificationReadService: readRequest error",t.error())}));this.itemsToRead.clear()}readOnClient(){this.store.dispatch("notifications/read",{ids:[...this.itemsToRead],read:true})}readAll(t=[]){this.store.dispatch("notifications/readAllSimple",{excludeIds:t});const e={ids:t};a.runAction(M.RestMethod.imV2NotifyReadAll,{data:e}).then((e=>{const i=this.store.getters["notifications/getCounter"];const n=e.counter;if(n<i){void this.store.dispatch("notifications/setCounter",n)}L.Logger.warn(`I have read ALL the notifications, excluded: ${t.length}`,e)})).catch((t=>{console.error("NotificationReadService: readAll error",t)}))}changeReadStatus(t){let e=this.store.getters["notifications/getById"](t);let i=false;if(!e){e=this.store.getters["notifications/getSearchItemById"](t);i=true}if(!e){return}if(i){this.store.commit("notifications/updateSearchResult",[{id:e.id,fields:{read:!e.read}}])}else{this.store.dispatch("notifications/read",{ids:[e.id],read:!e.read})}clearTimeout(this.changeReadStatusBlockTimeout[e.id]);this.changeReadStatusBlockTimeout[e.id]=setTimeout((()=>{this.restClient.callMethod(M.RestMethod.imNotifyRead,{id:e.id,action:e.read?"N":"Y",only_current:"Y"}).then((()=>{L.Logger.warn(`Notification ${e.id} unread status set to ${!e.read}`)})).catch((t=>{console.error("NotificationReadService: changeReadStatus error",t.error())}))}),1500)}destroy(){L.Logger.warn("Notification read service destroyed")}}class w{constructor(){this.notificationReadService=new F;this.store=O.Core.getStore()}openMenu(t,e){if(this.menu){this.menu.destroy();this.menu=null}this.menu=new E.Menu({id:"im-notifications-header-menu",items:this.getHeaderMenuItems(t),closeOnItemClick:true,autoHide:true});this.menu.show(e)}getHeaderMenuItems(t){return[this.getOptionsItem(),this.getReadAllItem(t)]}getReadAllItem(t){return{title:B.Loc.getMessage("IM_NOTIFICATIONS_READ_ALL_BUTTON"),design:t?E.MenuItemDesign.Default:E.MenuItemDesign.Disabled,onClick:()=>{this.notificationReadService.readAll();this.menu.close()}}}getOptionsItem(){return{title:B.Loc.getMessage("IM_NOTIFICATIONS_OPTIONS_BUTTON"),onClick:()=>{void v.Messenger.openSettings({onlyPanel:M.SettingsSection.notification});this.menu.close()}}}destroy(){if(this.menu){this.menu.destroy();this.menu=null}if(this.notificationReadService){this.notificationReadService.destroy()}}}var R=babelHelpers.classPrivateFieldLooseKey("onCloseMenu");var U=babelHelpers.classPrivateFieldLooseKey("getMenuItems");var $=babelHelpers.classPrivateFieldLooseKey("getMarkAsUnreadItem");var V=babelHelpers.classPrivateFieldLooseKey("getUnSubscribeItem");var H=babelHelpers.classPrivateFieldLooseKey("getCurrentItemSettings");var j=babelHelpers.classPrivateFieldLooseKey("getParsedSettingName");var q=babelHelpers.classPrivateFieldLooseKey("isAtLeastWebEnabled");var Q=babelHelpers.classPrivateFieldLooseKey("hasNotificationButtons");var X=babelHelpers.classPrivateFieldLooseKey("getSubscribedTypes");var z=babelHelpers.classPrivateFieldLooseKey("areSubscribedTypesExist");var G=babelHelpers.classPrivateFieldLooseKey("getNotificationSettingsTypeValues");var W=babelHelpers.classPrivateFieldLooseKey("shouldShowItem");var K=babelHelpers.classPrivateFieldLooseKey("getLastSubscribedTypes");class Y{static closeMenuOnScroll(){try{var t;(t=Y.lastMenu)==null?void 0:t.close()}catch(t){console.error(t)}finally{Y.lastMenu=null;Y.lastMenuId=null}}constructor({store:t}){Object.defineProperty(this,K,{value:ut});Object.defineProperty(this,W,{value:lt});Object.defineProperty(this,G,{value:ct});Object.defineProperty(this,z,{value:rt});Object.defineProperty(this,X,{value:at});Object.defineProperty(this,Q,{value:ot});Object.defineProperty(this,q,{value:st});Object.defineProperty(this,j,{value:nt});Object.defineProperty(this,H,{value:it});Object.defineProperty(this,V,{value:et});Object.defineProperty(this,$,{value:tt});Object.defineProperty(this,U,{value:Z});Object.defineProperty(this,R,{value:J});this.store=t}openMenu(t,e){var i;if(Y.lastMenu&&Y.lastMenuId===t.id&&(i=Y.lastMenu.getPopup())!=null&&i.isShown()){Y.lastMenu.close();Y.lastMenu=null;Y.lastMenuId=null;return}if(this.menu){this.menu.destroy();this.menu=null}this.notificationItem=t;const n=babelHelpers.classPrivateFieldLooseBase(this,U)[U]();if(n.length===0){return}this.menu=new E.Menu({id:`im-notification-menu-${this.notificationItem.id}`,items:n,events:{onClose:()=>{if(Y.lastMenu===this.menu){babelHelpers.classPrivateFieldLooseBase(this,R)[R]()}},onDestroy:()=>{if(Y.lastMenu===this.menu){babelHelpers.classPrivateFieldLooseBase(this,R)[R]()}}}});this.menu.show(e);Y.lastMenu=this.menu;Y.lastMenuId=this.notificationItem.id}async toggleSubscription(){const t=babelHelpers.classPrivateFieldLooseBase(this,H)[H]();if(babelHelpers.classPrivateFieldLooseBase(this,z)[z]()){const e=babelHelpers.classPrivateFieldLooseBase(this,K)[K]();const i={...babelHelpers.classPrivateFieldLooseBase(this,j)[j](),lastSubscribedTypes:babelHelpers.classPrivateFieldLooseBase(this,K)[K](),shouldSubscribe:false};void(new r.SettingsService).toggleSubscription(i);c.Notifier.notification.onUnsubscribeComplete(t.label,((t,i)=>{const n={...babelHelpers.classPrivateFieldLooseBase(this,j)[j](),lastSubscribedTypes:e,shouldSubscribe:true};void(new r.SettingsService).toggleSubscription(n);i.close()}));l.Analytics.getInstance().notification.onUnsubscribeFromNotification({moduleId:i.notifyModule,optionName:i.notifyEvent})}else{const e={...babelHelpers.classPrivateFieldLooseBase(this,j)[j](),lastSubscribedTypes:babelHelpers.classPrivateFieldLooseBase(this,K)[K](),shouldSubscribe:true};void(new r.SettingsService).toggleSubscription(e);c.Notifier.notification.onSubscribeComplete(t.label)}}isEmpty(t){const e=this.notificationItem;this.notificationItem=t;const i=babelHelpers.classPrivateFieldLooseBase(this,U)[U]();this.notificationItem=e;return i.length===0}}function J(){Y.lastMenu=null;Y.lastMenuId=null}function Z(){return[babelHelpers.classPrivateFieldLooseBase(this,V)[V](),babelHelpers.classPrivateFieldLooseBase(this,$)[$]()].filter(Boolean)}function tt(){return{title:this.notificationItem.read?B.Loc.getMessage("IM_NOTIFICATIONS_ITEM_MENU_MARK_UNREAD"):B.Loc.getMessage("IM_NOTIFICATIONS_ITEM_MENU_MARK_READ"),onClick:()=>{B.Event.EventEmitter.emit(Y.events.markAsUnreadClick,this.notificationItem)}}}function et(){if(!babelHelpers.classPrivateFieldLooseBase(this,W)[W]()){return null}return{title:babelHelpers.classPrivateFieldLooseBase(this,z)[z]()?B.Loc.getMessage("IM_NOTIFICATIONS_ITEM_MENU_UNSUBSCRIBE"):B.Loc.getMessage("IM_NOTIFICATIONS_ITEM_MENU_SUBSCRIBE"),onClick:()=>{this.toggleSubscription()}}}function it(){var t;const e=this.store.getters["application/settings/get"](M.Settings.notifications);const{notifyModule:i,notifyEvent:n}=babelHelpers.classPrivateFieldLooseBase(this,j)[j]();return(t=e[i])==null?void 0:t.items[n]}function nt(){const{settingName:t}=this.notificationItem;const[e,i]=t.split("|");return{notifyModule:e,notifyEvent:i}}function st(){return!babelHelpers.classPrivateFieldLooseBase(this,H)[H]().disabled.includes(M.NotificationSettingsType.web)}function ot(){return this.notificationItem.notifyButtons&&this.notificationItem.notifyButtons.length>0}function at(){const t=babelHelpers.classPrivateFieldLooseBase(this,H)[H]();return babelHelpers.classPrivateFieldLooseBase(this,G)[G]().filter((e=>!t.disabled.includes(e)&&t[e]===true))}function rt(){return babelHelpers.classPrivateFieldLooseBase(this,X)[X]().length>0}function ct(){return Object.values(M.NotificationSettingsType)}function lt(){return babelHelpers.classPrivateFieldLooseBase(this,H)[H]()&&babelHelpers.classPrivateFieldLooseBase(this,q)[q]()&&!babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]()}function ut(){if(babelHelpers.classPrivateFieldLooseBase(this,z)[z]()){return babelHelpers.classPrivateFieldLooseBase(this,X)[X]()}if(babelHelpers.classPrivateFieldLooseBase(this,q)[q]()){return[M.NotificationSettingsType.web]}return[]}Y.events={markAsUnreadClick:"markAsUnreadClick"};Y.lastMenu=null;Y.lastMenuId=null;const dt=Object.freeze({changed:"changed",grid:"grid",text:"text",users:"users",title:"title"});const ht=Object.freeze({calendar:"--o-calendar-with-slots",task:"--o-task"});const mt=Object.freeze({default:"--o-crm",deal:"--o-handshake",lead:"--o-lead",contact:"--o-contact",quote:"--o-file",company:"--o-company",order:"--o-box",process:"--o-smart-process",call:"--o-phone-up",task:"--o-complete-task-list",meeting:"--o-calendar-with-slots",mail:"--o-mail",invoice:"--o-invoice"});const ft=Object.freeze({newsfeed:"--o-newsfeed",wiki:"--wiki",vote:"--o-complete-task-list",group:"--o-three-persons"});const pt=Object.freeze({bizproc:"--o-business-process",customSection:"--o-activity"});const vt={name:"DetailedAdditionalText",props:{notificationParams:{type:Object,required:true}},computed:{params(){return this.notificationParams},text(){var t,e,i;const n=(t=(e=this.params.entity)==null?void 0:(i=e.content)==null?void 0:i.additionalText)!=null?t:"";return p.Parser.decodeNotificationParam(n)},hasAdditionalText(){return this.text.length>0}},template:`\n\t\t<div v-if="hasAdditionalText" class="bx-im-content-notification-item-content__grid-additional-container">\n\t\t\t<span v-html="text" class="bx-im-content-notification-item-content__grid-additional-text"/>\n\t\t</div>\n\t`};const gt={date:x.Outline.CALENDAR_WITH_SLOTS,place:x.Outline.MEETING_POINT,repeat:x.Outline.REPEAT,user:x.Outline.PERSON,default:x.Outline.INFO_CIRCLE};const It=Object.freeze({user:"user",place:"place",date:"date",repeat:"repeat"});const bt={name:"DetailedGrid",components:{BIcon:x.BIcon,DetailedAdditionalText:vt},props:{notificationParams:{type:Object,required:true}},computed:{params(){return this.notificationParams},notificationType(){var t,e;return(t=(e=this.params.entity)==null?void 0:e.contentType)!=null?t:null},content(){return this.params.entity.content},isGridType(){return this.notificationType===dt.grid},items(){return this.content.items},formattedItems(){return this.items.map((t=>{if(t.type!=="user"){return t}return{...t,user:this.$store.getters["users/get"](Number(t.value))}}))}},methods:{getIconClass(t){return gt[t]||gt.default},getUserImage(t){return{backgroundImage:`url('${t.user.avatar}')`}},getItemValue(t){if(t.type==="user"&&t.user){return t.user.name}return t.value},isUserItem(t){return t.type==="user"&&t.user},isUserHasAvatar(t){return t.type==="user"&&t.user.avatar},getUserLink(t){return u.Utils.user.getProfileLink(t.id)}},template:`\n\t\t<div v-if="isGridType" class="bx-im-content-notification-item-content__details-block">\n\t\t\t<template v-for="(item, index) in formattedItems" :key="index">\n\t\t\t\t<div class="bx-im-content-notification-item-content__details-name"> {{ item.title }}</div>\n\t\t\t\t<div class="bx-im-content-notification-item-content__details-value">\n\t\t\t\t\t<template v-if="isUserHasAvatar(item)">\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass="bx-im-content-notification-item-content__details-icon ui-icon-set --user"\n\t\t\t\t\t\t\t:style="getUserImage(item)"\n\t\t\t\t\t\t></span>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\tv-if="getIconClass(item.type)"\n\t\t\t\t\t\t\tclass="bx-im-content-notification-item-content__details-icon"\n\t\t\t\t\t\t\t:name="getIconClass(item.type)"\n\t\t\t\t\t\t\t:size="16"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-if="isUserItem(item)">\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t:href="getUserLink(item.user)"\n\t\t\t\t\t\t\tclass="bx-im-content-notification-item-content__details-text"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ getItemValue(item) }}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass="bx-im-content-notification-item-content__details-text"\n\t\t\t\t\t\t\t:title="getItemValue(item)"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ getItemValue(item) }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t\t<DetailedAdditionalText :notificationParams="notificationParams"/>\n\t`};const Tt={name:"DetailedText",props:{notificationParams:{type:Object,required:true}},computed:{params(){return this.notificationParams},notificationType(){var t;return(t=this.params.entity.contentType)!=null?t:null},content(){return this.params.entity.content},isTextType(){return this.notificationType===dt.text},valueText(){var t;return p.Parser.decodeNotificationParam(((t=this.content)==null?void 0:t.value)||"")}},template:`\n\t\t<div v-if="isTextType" class="bx-im-content-notification-item-content__details-item">\n\t\t\t<span v-html="valueText" class="bx-im-content-notification-item-content__details-text --line-clamp-3"/>\n\t\t</div>\n\t`};const _t={name:"DetailedTitle",props:{notificationParams:{type:Object,required:true},icon:{type:String,default:""},color:{type:String,default:""}},computed:{params(){return this.notificationParams},title(){return this.params.entity.title||""},href(){return this.params.entity.href||""},showDetailedTitle(){return this.title!==""},hasHref(){return Boolean(this.href)}},template:`\n\t\t<div v-if="showDetailedTitle" class="bx-im-content-notification-item-content__details-header">\n\t\t\t<span\n\t\t\t\tclass="ui-icon-set"\n\t\t\t\t:class="icon"\n\t\t\t\t:style="color ? { '--ui-icon-set__icon-color': color } : {}"\n\t\t\t></span>\n\t\t\t<a\n\t\t\t\tv-if="hasHref"\n\t\t\t\t:href="href"\n\t\t\t\tclass="bx-im-content-notification-item-content__details-title --line-clamp-2"\n\t\t\t>{{ title }}</a>\n\t\t\t<span\n\t\t\t\tv-else\n\t\t\t\tclass="bx-im-content-notification-item-content__details-title --line-clamp-2"\n\t\t\t>{{ title }}</span>\n\t\t</div>\n\t`};const Ct={name:"DetailedChangedValue",props:{notificationParams:{type:Object,required:true}},computed:{params(){return this.notificationParams},notificationType(){var t;return(t=this.params.entity.contentType)!=null?t:null},content(){return this.params.entity.content},isChangedType(){return this.notificationType===dt.changed},prevValue(){return this.content.prev},nextValue(){return this.content.next}},template:`\n\t\t<div v-if="isChangedType" class="bx-im-content-notification-item-content__details-item --changed">\n\t\t\t<div class="bx-im-content-notification-item-content__details-content --prev">\n\t\t\t\t<span>\n\t\t\t\t\t{{ prevValue }}\n\t\t\t\t\t<span class="bx-im-content-notification-item-content__details-arrow ui-icon-set --arrow-right-m"></span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<div class="bx-im-content-notification-item-content__details-content">{{ nextValue }}</div>\n\t\t</div>\n\t`};const yt=2;const St={name:"DetailedUsers",props:{notificationParams:{type:Object,required:true}},computed:{params(){return this.notificationParams},notificationType(){var t;return(t=this.params.entity.contentType)!=null?t:null},content(){return this.params.entity.content},isUsersType(){return this.notificationType===dt.users},text(){return this.content.text},allUserIds(){return this.content.ids},usersToDisplay(){const t=this.allUserIds.slice(0,yt);return t.map((t=>this.$store.getters["users/get"](t)))},remainingCount(){return this.allUserIds.length-yt},formattedText(){let t=this.text.replace("#USER_LIST#",(()=>this.usersToDisplay.map((t=>this.getUserLink(t))).join(", ")));if(this.link){t=t.replace("[link]",`<a href="${this.link}" class="bx-im-content-notification-item-content__details-link" target="_self">`).replace("#COUNT#",this.remainingCount).replace("[/link]","</a>")}else{t=t.replace("#COUNT#",this.remainingCount)}return t},link(){var t;return(t=this.params.entity.href)!=null?t:null}},methods:{getUserLink(t){const e=u.Utils.user.getProfileLink(t.id);const i=B.Text.encode(t.name);return B.Dom.create({tag:"a",props:{className:"bx-im-content-notification-item-content__details-link",href:e,target:"_self"},text:i}).outerHTML}},template:`\n\t\t<div\n\t\t\tv-if="isUsersType"\n\t\t\tclass="bx-im-content-notification-item-content__details-users"\n\t\t\tv-html="formattedText"\n\t\t>\n\t\t</div>\n\t`};const Nt={name:"QuickAnswer",components:{UiButton:_.Button},props:{notification:{type:Object,required:true}},emits:["sendQuickAnswer"],data(){return{quickAnswerText:"",quickAnswerResultMessage:"",showQuickAnswer:false,isSending:false,successSentQuickAnswer:false}},computed:{ButtonSize:()=>_.ButtonSize,ButtonColor:()=>_.ButtonColor,AirButtonStyle:()=>_.AirButtonStyle},methods:{toggleQuickAnswer(){if(this.successSentQuickAnswer){this.showQuickAnswer=true;this.successSentQuickAnswer=false;this.quickAnswerResultMessage=""}else{this.showQuickAnswer=!this.showQuickAnswer}if(this.showQuickAnswer){this.$nextTick((()=>{this.$refs["textarea"].focus()}))}},sendQuickAnswer(){if(this.isSending||this.quickAnswerText.trim()===""){return}this.isSending=true;this.$emit("sendQuickAnswer",{id:this.notification.id,text:this.quickAnswerText.trim(),callbackSuccess:t=>{const{result_message:e}=t.data();const[i]=e;this.quickAnswerResultMessage=i;this.successSentQuickAnswer=true;this.quickAnswerText="";this.isSending=false},callbackError:()=>{this.isSending=false}})}},template:`\n\t\t<div class="bx-im-content-notification-quick-answer__container">\n\t\t\t<UiButton\n\t\t\t\tv-if="!showQuickAnswer"\n\t\t\t\t:size="ButtonSize.SMALL"\n\t\t\t\t:text="$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_QUICK_ANSWER_BUTTON')"\n\t\t\t\t:loading="isSending"\n\t\t\t\tclass="--air"\n\t\t\t\t:style="AirButtonStyle.OUTLINE_NO_ACCENT"\n\t\t\t\t@click="toggleQuickAnswer" \n\t\t\t\t@dblclick.stop\n\t\t\t>\n\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_NOTIFICATIONS_QUICK_ANSWER_BUTTON') }}\n\t\t\t</UiButton>\n\t\t\t<transition name="quick-answer-slide">\n\t\t\t\t<div \n\t\t\t\t\tv-if="showQuickAnswer && !successSentQuickAnswer" \n\t\t\t\t\tclass="bx-im-content-notification-quick-answer__textarea-container"\n\t\t\t\t>\n\t\t\t\t\t<textarea\n\t\t\t\t\t\tref="textarea"\n\t\t\t\t\t\tautofocus\n\t\t\t\t\t\tclass="bx-im-content-notification-quick-answer__textarea"\n\t\t\t\t\t\tv-model="quickAnswerText"\n\t\t\t\t\t\t:disabled="isSending"\n\t\t\t\t\t\t@keydown.enter.prevent\n\t\t\t\t\t\t@keyup.enter.prevent="sendQuickAnswer"\n\t\t\t\t\t/>\n\t\t\t\t\t<div \n\t\t\t\t\t\tv-if="!successSentQuickAnswer" \n\t\t\t\t\t\tclass="bx-im-content-notification-quick-answer__buttons-container"\n\t\t\t\t\t>\n\t\t\t\t\t\t<UiButton\n\t\t\t\t\t\t\t:size="ButtonSize.SMALL"\n\t\t\t\t\t\t\t:text="$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_QUICK_ANSWER_SEND')"\n\t\t\t\t\t\t\t:isLoading="isSending"\n\t\t\t\t\t\t\tclass="--air"\n\t\t\t\t\t\t\t:style="AirButtonStyle.FILLED"\n\t\t\t\t\t\t\t@click="sendQuickAnswer"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<UiButton\n\t\t\t\t\t\t\t:size="ButtonSize.SMALL"\n\t\t\t\t\t\t\tclass="--air"\n\t\t\t\t\t\t\t:style="AirButtonStyle.OUTLINE_NO_ACCENT"\n\t\t\t\t\t\t\t:text="$Bitrix.Loc.getMessage('IM_NOTIFICATIONS_QUICK_ANSWER_CANCEL')"\n\t\t\t\t\t\t\t:isDisabled="isSending"\n\t\t\t\t\t\t\t@click="toggleQuickAnswer"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t\t<div v-if="successSentQuickAnswer" class="bx-im-content-notification-quick-answer__result">\n\t\t\t\t<div class="bx-im-content-notification-quick-answer__success-icon"></div>\n\t\t\t\t<div class="bx-im-content-notification-quick-answer__success-text">{{ quickAnswerResultMessage }}</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const Et={name:"ItemConfirmButtons",components:{UiButton:_.Button},props:{buttons:{type:Array,required:true}},emits:["confirmButtonsClick"],computed:{ButtonSize:()=>_.ButtonSize,ButtonColor:()=>_.ButtonColor,preparedButtons(){return this.buttons.map((t=>{const[e,i]=t.COMMAND_PARAMS.split("|");const n=B.Text.decode(t.TEXT);return{id:e,value:i,text:n}}))}},methods:{click(t){this.$emit("confirmButtonsClick",t)},getButtonStyle(t){return t.value==="Y"?_.AirButtonStyle.FILLED:_.AirButtonStyle.OUTLINE_NO_ACCENT}},template:`\n\t\t<div class="bx-im-content-notification-item-confirm-buttons__container">\n\t\t\t<UiButton\n\t\t\t\tv-for="(button, index) in preparedButtons" :key="index"\n\t\t\t\t:text="button.text"\n\t\t\t\tclass="--air"\n\t\t\t\t:style="getButtonStyle(button)"\n\t\t\t\t:size="ButtonSize.SMALL"\n\t\t\t\t@click="click(button)"\n\t\t\t/>\n\t\t</div>\n\t`};const At=Object.freeze({default:"--default",biconector:"--bi-constructor",app:"--app",bizproc:"--bizproc",newsfeed:"--newsfeed",group:"--group",flow:"--flow",sign:"--sign",videoConf:"--video-conf",openLines:"--open-lines",voximplant:"--voximplant",booking:"--booking",calendar:"--calendar",b24:"--b24",mail:"--mail",tariff:"--license",disk:"--disk",crm:"--crm",company:"--company",contact:"--contact",deal:"--deal",lead:"--lead",quote:"--quote",order:"--order",smartProcess:"--smart-process",timeline:"--timeline",invoice:"--invoice"});const kt=Object.freeze({biconector:At.biconector,bizproc:At.bizproc,blog:At.newsfeed,socialnetwork:At.group,sign:At.sign,imconnector:At.openLines,imopenlines:At.openLines,voximplant:At.voximplant,voximplantcontroller:At.voximplant,booking:At.booking,calendar:At.calendar,intranet:At.b24,sender:At.mail,mail:At.mail,bitrix24:At.tariff,disk:At.disk,crm:At.crm});const xt={name:"ItemAvatar",components:{ChatAvatar:m.ChatAvatar},props:{notification:{type:Object,required:true}},computed:{AvatarSize:()=>m.AvatarSize,isSystem(){return this.userId===0},userId(){return this.notification.authorId},userDialogId(){return this.userId.toString()},user(){return this.$store.getters["users/get"](this.userId)},systemIconClass(){var t,e;const i=(t=this.notification.params)==null?void 0:(e=t.componentParams)==null?void 0:e.systemIcon;if(B.Type.isStringFilled(i)){return At[i]||At.default}let n=this.notification.moduleId;if(!n){var s;const t=(s=this.notification.settingName)!=null?s:"";n=t.split("|")[0].trim()}return kt[n]||At.default}},template:`\n\t\t<div class="bx-im-content-notification-item-avatar__container">\n\t\t\t<div \n\t\t\t\tv-if="isSystem || !user"\n\t\t\t\tclass="bx-im-content-notification-item-avatar__system-icon"\n\t\t\t\t:class="systemIconClass"\n\t\t\t></div>\n\t\t\t<ChatAvatar \n\t\t\t\tv-else \n\t\t\t\t:avatarDialogId="userDialogId" \n\t\t\t\t:contextDialogId="userDialogId" \n\t\t\t\t:size="AvatarSize.M" \n\t\t\t/>\n\t\t</div>\n\t`};const Dt={name:"ItemActions",props:{notification:{type:Object,required:true},canDelete:{type:Boolean,required:true}},computed:{notificationItem(){return this.notification},areActionsAvailable(){return this.notificationItem.notifyButtons.length===0},isMenuEmpty(){if(!this.notificationMenu){return true}return this.notificationMenu.isEmpty(this.notificationItem)}},created(){this.notificationMenu=new Y({store:this.$store})},methods:{onDeleteClick(){this.$emit("deleteClick")},onMenuButtonClick(t){this.notificationMenu.openMenu(this.notificationItem,t.currentTarget)},onMenuClose(){this.isMenuShown=false}},template:`\n\t\t<div v-if="areActionsAvailable" class="bx-im-content-notification-item__actions">\n\t\t\t<div\n\t\t\t\tv-if="!isMenuEmpty"\n\t\t\t\tclass="bx-im-content-notification-item__actions-more-button" \n\t\t\t\t@click="onMenuButtonClick" \n\t\t\t>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if="canDelete"\n\t\t\t\tclass="bx-im-content-notification-item__actions-delete-button"\n\t\t\t\t@click="onDeleteClick"\n\t\t\t>\n\t\t\t</div>\n\t\t</div>\n\t`};const Bt={name:"ItemReaction",props:{notification:{type:Object,required:true}},computed:{notificationItem(){return this.notification},type(){return this.notificationItem.params.componentParams.entity.reaction},reactionClass(){return f.reactionCssClass[this.type]}},template:`\n\t\t<div class="bx-im-content-notification-item-content__reaction" :class="reactionClass"></div>\n\t`};const Ot="#AUTHOR#";const Pt={name:"ItemSubject",components:{ChatTitle:g.ChatTitle},props:{notification:{type:Object,required:true}},emits:["userClick"],computed:{author(){return this.$store.getters["users/get"](this.notification.authorId,true)},authorDialogId(){return this.notification.authorId.toString()},titleClasses(){return{"bx-im-content-notification-item-header__title-text":true,"bx-im-content-notification-item-header__title-user-text":true,"--extranet":this.author.type===M.UserType.extranet}},subjectText(){var t,e;return p.Parser.decodeNotificationParam((t=(e=this.notification.params.componentParams)==null?void 0:e.subject)!=null?t:"")},parsedSubject(){let t=this.subjectText;if(this.subjectText.includes("#USER_COUNT#")){t=this.subjectText.replace("#USER_COUNT#",this.notification.params.users.length)}const e=t.split(Ot);return{before:e[0],after:e[1]}},beforeText(){return this.parsedSubject.before},afterText(){return this.parsedSubject.after}},template:`\n\t\t<div class="bx-im-content-notification-item-header__subject">\n\t\t\t<span\n\t\t\t\tv-html="beforeText"\n\t\t\t\tclass="bx-im-content-notification-item-header__subject-text"\n\t\t\t/>\n\t\t\t<ChatTitle\n\t\t\t\t:dialogId="authorDialogId"\n\t\t\t\t:showItsYou="false"\n\t\t\t\t:class="titleClasses"\n\t\t\t\t@click.prevent="$emit('userClick')"\n\t\t\t/>\n\t\t\t<slot></slot>\n\t\t\t<span\n\t\t\t\tv-html="afterText"\n\t\t\t\tclass="bx-im-content-notification-item-header__subject-text"\n\t\t\t/>\n\t\t</div>\n\t`};const Lt={name:"BaseNotificationItemHeader",components:{ChatTitle:g.ChatTitle,ItemSubject:Pt},props:{notification:{type:Object,required:true}},emits:["moreUsersClick"],computed:{notificationItem(){return this.notification},user(){return this.$store.getters["users/get"](this.notificationItem.authorId,true)},isSystem(){return this.notification.authorId===0},userDialogId(){return this.notification.authorId.toString()},hasMoreUsers(){var t;if(this.isSystem){return false}return Boolean((t=this.notificationItem.params)==null?void 0:t.users)&&this.notificationItem.params.users.length>0},moreUsers(){const t=this.$Bitrix.Loc.getMessage("IM_NOTIFICATIONS_MORE_USERS").split("#COUNT#");return{start:t[0],end:this.notificationItem.params.users.length+t[1]}}},methods:{onUserTitleClick(){if(this.isSystem){return}v.Messenger.openChat(this.userDialogId)},onMoreUsersClick(t){if(t.users){this.$emit("moreUsersClick",{event:t.event,users:t.users})}}},template:`\n\t\t<div class="bx-im-content-notification-item-header__container">\n\t\t\t<div class="bx-im-content-notification-item-header__title-container">\n\t\t\t\t<ItemSubject\n\t\t\t\t\t:notification="notification"\n\t\t\t\t\t@userClick="onUserTitleClick"\n\t\t\t\t>\n\t\t\t\t\t<span v-if="hasMoreUsers" class="bx-im-content-notification-item-header__more-users">\n\t\t\t\t\t\t<span class="bx-im-content-notification-item-header__more-users-start">{{ moreUsers.start }}</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass="bx-im-content-notification-item-header__more-users-dropdown"\n\t\t\t\t\t\t\t@click="onMoreUsersClick({users: notificationItem.params.users, event: $event})"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ moreUsers.end }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>\n\t\t\t\t</ItemSubject>\n\t\t\t</div>\n\t\t</div>\n\t`};const Mt={name:"PlainText",props:{notification:{type:Object,required:true}},computed:{params(){var t,e,i;return(t=(e=this.notification)==null?void 0:(i=e.params)==null?void 0:i.componentParams)!=null?t:{}},hasPlainText(){return this.text.length>0},text(){var t;const e=((t=this.params)==null?void 0:t.plainText)||"";return p.Parser.decodeNotificationParam(e)}},template:`\n\t\t<div v-if="hasPlainText" class="bx-im-content-notification-item-content__plain">\n\t\t\t<span v-html="text" class="bx-im-content-notification-item-content__plain-text"/>\n\t\t</div>\n\t`};const Ft={name:"BaseNotificationItem",components:{ItemAvatar:xt,QuickAnswer:Nt,PlainText:Mt,ItemConfirmButtons:Et,ItemActions:Dt,ItemReaction:Bt,Attach:d.Attach,BaseNotificationItemHeader:Lt},props:{notification:{type:Object,required:true}},emits:["buttonsClick","confirmButtonsClick","deleteClick","sendQuickAnswer","moreUsersClick"],computed:{NotificationTypesCodes:()=>M.NotificationTypesCodes,notificationItem(){return this.notification},params(){return this.notificationItem.params},componentParams(){var t,e;return(t=this.notificationItem)==null?void 0:(e=t.params)==null?void 0:e.componentParams},entity(){var t;return(t=this.componentParams)==null?void 0:t.entity},type(){return this.notification.sectionCode},isUnread(){return!this.notificationItem.read},userData(){return this.$store.getters["users/get"](this.notificationItem.authorId,true)},date(){return this.notificationItem.date},hasQuickAnswer(){var t;return Boolean(((t=this.params)==null?void 0:t.canAnswer)==="Y")},hasReaction(){var t;return B.Type.isStringFilled((t=this.entity)==null?void 0:t.reaction)},attachList(){var t;return(t=this.params)==null?void 0:t.attach},itemDate(){return h.DateFormatter.formatByTemplate(this.date,h.DateTemplate.notification)},canDelete(){return this.notificationItem.sectionCode===M.NotificationTypesCodes.simple},showDetailedBlock(){var t;const e=(t=this.entity)==null?void 0:t.contentType;return Boolean(e)},isSubjectOnly(){var t,e,i,n;return((t=this.params)==null?void 0:(e=t.componentParams)==null?void 0:e.subject)&&!((i=this.params)!=null&&(n=i.componentParams)!=null&&n.plainText)&&!this.entity}},created(){this.notificationReadService=new F;S.EventEmitter.subscribe(Y.events.markAsUnreadClick,this.markAsUnreadClick)},beforeUnmount(){this.notificationReadService.destroy();S.EventEmitter.unsubscribe(Y.events.markAsUnreadClick,this.markAsUnreadClick)},methods:{markAsUnreadClick(t){const e=t.getData();if(this.notificationItem.id===e.id){this.notificationReadService.changeReadStatus(this.notificationItem.id)}},onConfirmButtonsClick(t){this.$emit("confirmButtonsClick",t)},onSendQuickAnswer(t){this.$emit("sendQuickAnswer",t)},onDeleteClick(){this.$emit("deleteClick",this.notificationItem.id)},onUnsubscribeClick(){this.$emit("unsubscribeClick",this.notificationItem.id)},onContentClick(t){p.Parser.executeClickEvent(t,{emitter:this.getEmitter()})},onMoreUsersClick(t){this.$emit("moreUsersClick",t)},getEmitter(){return this.$Bitrix.eventEmitter}},template:`\n\t\t<div\n\t\t\tclass="bx-im-content-notification-item__container"\n\t\t\t:class="{'--unread': isUnread}"\n\t\t\t:data-test-id="'im-content-notification-item-container-' + notificationItem.id"\n\t\t>\n\t\t\t<ItemAvatar :notification="notificationItem"/>\n\t\t\t<div class="bx-im-content-notification-item__content-container" :class="{ '--subject-only': isSubjectOnly }">\n\t\t\t\t<slot name="header">\n\t\t\t\t\t<BaseNotificationItemHeader\n\t\t\t\t\t\t:notification="notificationItem"\n\t\t\t\t\t\t@moreUsersClick="onMoreUsersClick"\n\t\t\t\t\t/>\n\t\t\t\t</slot>\n\t\t\t\t<ItemActions\n\t\t\t\t\t:canDelete="canDelete"\n\t\t\t\t\t:notification="notificationItem"\n\t\t\t\t\t@deleteClick="onDeleteClick"\n\t\t\t\t\t@unsubscribeClick="onUnsubscribeClick"\n\t\t\t\t\t@markAsUnreadClick="markAsUnreadClick"\n\t\t\t\t/>\n\t\t\t\t<PlainText :notification="notificationItem" />\n\t\t\t\t<div \n\t\t\t\t\tclass="bx-im-content-notification-item-content__container"\n\t\t\t\t\t:class="{ '--subject-only': isSubjectOnly }"\n\t\t\t\t\t@click="onContentClick"\n\t\t\t\t>\n\t\t\t\t\t<div :class="{ 'bx-im-content-notification-item-content__details': showDetailedBlock }">\n\t\t\t\t\t\t<slot name="content"></slot>\n\t\t\t\t\t\t<ItemReaction v-if="hasReaction" :notification="notificationItem" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<QuickAnswer\n\t\t\t\t\t\tv-if="hasQuickAnswer"\n\t\t\t\t\t\t:notification="notificationItem"\n\t\t\t\t\t\t@sendQuickAnswer="onSendQuickAnswer"\n\t\t\t\t\t/>\n\t\t\t\t\t<template v-if="attachList">\n\t\t\t\t\t\t<template v-for="attachItem in attachList">\n\t\t\t\t\t\t\t<Attach :config="attachItem"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t\t<ItemConfirmButtons\n\t\t\t\t\t\tv-if="notificationItem.notifyButtons.length > 0"\n\t\t\t\t\t\t@confirmButtonsClick="onConfirmButtonsClick"\n\t\t\t\t\t\t:buttons="notificationItem.notifyButtons"\n\t\t\t\t\t/>\n\t\t\t\t\t<div class="bx-im-content-notification-item-content__date-container">\n\t\t\t\t\t\t<div class="bx-im-content-notification-item-content__date">{{ itemDate }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const wt={name:"CalendarNotificationItem",components:{DetailedTitle:_t,DetailedText:Tt,DetailedGrid:bt,DetailedChangedValue:Ct,DetailedUsers:St,BaseNotificationItem:Ft},props:{notification:{type:Object,required:true}},computed:{Color:()=>M.Color,notificationItem(){return this.notification},notificationParams(){var t,e;return(t=(e=this.notificationItem.params)==null?void 0:e.componentParams)!=null?t:null},iconClass(){return ht.calendar}},template:`\n\t\t<BaseNotificationItem :notification="notificationItem">\n\t\t\t<template #content>\n\t\t\t\t<DetailedTitle\n\t\t\t\t\t:notificationParams="notificationParams"\n\t\t\t\t\t:icon="iconClass" \n\t\t\t\t\t:color="Color.accentMainPrimaryAlt"\n\t\t\t\t/>\n\t\t\t\t<DetailedGrid :notificationParams="notificationParams" />\n\t\t\t\t<DetailedChangedValue :notificationParams="notificationParams" />\n\t\t\t\t<DetailedText :notificationParams="notificationParams" />\n\t\t\t\t<DetailedUsers :notificationParams="notificationParams" />\n\t\t\t</template>\n\t\t</BaseNotificationItem>\n\t`};const Rt={name:"CrmNotificationItem",components:{DetailedTitle:_t,DetailedText:Tt,DetailedGrid:bt,DetailedChangedValue:Ct,BaseNotificationItem:Ft},props:{notification:{type:Object,required:true}},computed:{Color:()=>M.Color,notificationItem(){return this.notification},notificationParams(){var t,e;return(t=(e=this.notificationItem.params)==null?void 0:e.componentParams)!=null?t:null},iconClass(){const t=this.notificationParams.entity.entityType;if(t&&mt[t]){return mt[t]}return mt.deal}},template:`\n\t\t<BaseNotificationItem :notification="notificationItem">\n\t\t\t<template #content>\n\t\t\t\t<DetailedTitle\n\t\t\t\t\t:notificationParams="notificationParams"\n\t\t\t\t\t:icon="iconClass"\n\t\t\t\t\t:color="Color.accentMainSuccessAlt"\n\t\t\t\t/>\n\t\t\t\t<DetailedGrid :notificationParams="notificationParams" />\n\t\t\t\t<DetailedChangedValue :notificationParams="notificationParams" />\n\t\t\t\t<DetailedText :notificationParams="notificationParams" />\n\t\t\t</template>\n\t\t</BaseNotificationItem>\n\t`};const Ut={name:"TaskNotificationItem",components:{DetailedTitle:_t,DetailedText:Tt,DetailedGrid:bt,DetailedChangedValue:Ct,BaseNotificationItem:Ft},props:{notification:{type:Object,required:true}},computed:{Color:()=>M.Color,notificationItem(){return this.notification},notificationParams(){var t,e;return(t=(e=this.notificationItem.params)==null?void 0:e.componentParams)!=null?t:null},iconClass(){return ht.task}},template:`\n\t\t<BaseNotificationItem :notification="notification">\n\t\t\t<template #content>\n\t\t\t\t<DetailedTitle\n\t\t\t\t\t:notificationParams="notificationParams"\n\t\t\t\t\t:icon="iconClass"\n\t\t\t\t\t:color="Color.accentMainSuccess"\n\t\t\t\t/>\n\t\t\t\t<DetailedChangedValue :notificationParams="notificationParams" />\n\t\t\t\t<DetailedGrid :notificationParams="notificationParams" />\n\t\t\t\t<DetailedText :notificationParams="notificationParams" />\n\t\t\t</template>\n\t\t</BaseNotificationItem>\n\t`};const $t={name:"BizprocNotificationItem",components:{DetailedTitle:_t,DetailedText:Tt,DetailedChangedValue:Ct,DetailedGrid:bt,BaseNotificationItem:Ft},props:{notification:{type:Object,required:true}},computed:{Color:()=>M.Color,notificationItem(){return this.notification},notificationParams(){var t,e;return(t=(e=this.notificationItem.params)==null?void 0:e.componentParams)!=null?t:null},iconClass(){const t=this.notificationParams.entity.entityType;if(t&&pt[t]){return pt[t]}return pt.bizproc}},template:`\n\t\t<BaseNotificationItem :notification="notificationItem">\n\t\t\t<template #content>\n\t\t\t\t<DetailedTitle\n\t\t\t\t\t:notificationParams="notificationParams"\n\t\t\t\t\t:icon="iconClass"\n\t\t\t\t\t:color="Color.orangeExtra"\n\t\t\t\t/>\n\t\t\t\t<DetailedGrid :notificationParams="notificationParams" />\n\t\t\t\t<DetailedChangedValue :notificationParams="notificationParams" />\n\t\t\t\t<DetailedText :notificationParams="notificationParams" />\n\t\t\t</template>\n\t\t</BaseNotificationItem>\n\t`};const Vt={name:"SonetNotificationItem",components:{DetailedTitle:_t,DetailedText:Tt,DetailedGrid:bt,DetailedChangedValue:Ct,BaseNotificationItem:Ft},props:{notification:{type:Object,required:true}},computed:{Color:()=>M.Color,notificationItem(){return this.notification},notificationParams(){var t,e;return(t=(e=this.notificationItem.params)==null?void 0:e.componentParams)!=null?t:null},iconClass(){const t=this.notificationParams.entity.entityType;if(t&&ft[t]){return ft[t]}return ft.newsfeed}},template:`\n\t\t<BaseNotificationItem :notification="notificationItem">\n\t\t\t<template #content>\n\t\t\t\t<DetailedTitle\n\t\t\t\t\t:notificationParams="notificationParams"\n\t\t\t\t\t:icon="iconClass"\n\t\t\t\t\t:color="Color.accentExtraAqua"\n\t\t\t\t/>\n\t\t\t\t<DetailedGrid :notificationParams="notificationParams" />\n\t\t\t\t<DetailedChangedValue :notificationParams="notificationParams" />\n\t\t\t\t<DetailedText :notificationParams="notificationParams" />\n\t\t\t</template>\n\t\t</BaseNotificationItem>\n\t`};const Ht={name:"CompatibilityNotificationItemHeader",components:{ChatTitle:g.ChatTitle},props:{notification:{type:Object,required:true}},emits:["moreUsersClick"],computed:{notificationItem(){return this.notification},user(){return this.$store.getters["users/get"](this.notificationItem.authorId,true)},hasName(){return this.notificationItem.authorId>0&&this.user.name.length>0},title(){if(this.notificationItem.title.length>0){return this.notificationItem.title}return this.$Bitrix.Loc.getMessage("IM_NOTIFICATIONS_ITEM_SYSTEM")},isSystem(){return this.notification.authorId===0},userDialogId(){return this.notification.authorId.toString()},titleClasses(){return{"bx-im-content-notification-item-header__title-text":true,"bx-im-content-notification-item-header__title-user-text":!this.isSystem,"--extranet":this.user.type===M.UserType.extranet,"--short":!this.hasMoreUsers}},hasMoreUsers(){var t;if(this.isSystem){return false}return Boolean((t=this.notificationItem.params)==null?void 0:t.users)&&this.notificationItem.params.users.length>0},moreUsers(){const t=this.$Bitrix.Loc.getMessage("IM_NOTIFICATIONS_MORE_USERS").split("#COUNT#");return{start:t[0],end:this.notificationItem.params.users.length+t[1]}}},methods:{onUserTitleClick(){if(this.isSystem){return}v.Messenger.openChat(this.userDialogId)},onMoreUsersClick(t){if(t.users){this.$emit("moreUsersClick",{event:t.event,users:t.users})}}},template:`\n\t\t<div class="bx-im-content-notification-item-header__container">\n\t\t\t<div class="bx-im-content-notification-item-header__title-container">\n\t\t\t\t<ChatTitle\n\t\t\t\t\tv-if="hasName"\n\t\t\t\t\t:dialogId="userDialogId"\n\t\t\t\t\t:showItsYou="false"\n\t\t\t\t\t:class="titleClasses"\n\t\t\t\t\t@click.prevent="onUserTitleClick"\n\t\t\t\t/>\n\t\t\t\t<span v-else @click.prevent="onUserTitleClick" :class="titleClasses">{{ title }}</span>\n\t\t\t\t<span v-if="hasMoreUsers" class="bx-im-content-notification-item-header__more-users">\n\t\t\t\t\t<span class="bx-im-content-notification-item-header__more-users-start">{{ moreUsers.start }}</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass="bx-im-content-notification-item-header__more-users-dropdown"\n\t\t\t\t\t\t@click="onMoreUsersClick({users: notificationItem.params.users, event: $event})"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ moreUsers.end }}\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t`};const jt={name:"DefaultNotificationItem",components:{BaseNotificationItem:Ft,CompatibilityNotificationItemHeader:Ht},props:{notification:{type:Object,required:true}},emits:["moreUsersClick"],computed:{content(){return p.Parser.decodeNotification(this.notification)}},methods:{onMoreUsersClick(t){this.$emit("moreUsersClick",t)}},template:`\n\t\t<BaseNotificationItem :notification="notification">\n\t\t\t<template #header>\n\t\t\t\t<CompatibilityNotificationItemHeader\n\t\t\t\t\t:notification="notification"\n\t\t\t\t\t@moreUsersClick="onMoreUsersClick"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<template #content>\n\t\t\t\t<div\n\t\t\t\t\tv-if="content.length > 0"\n\t\t\t\t\tclass="bx-im-content-notification-item-content__content-text"\n\t\t\t\t\tv-html="content"\n\t\t\t\t></div>\n\t\t\t</template>\n\t\t</BaseNotificationItem>\n\t`};const qt={name:"DefaultNotificationItem",components:{BaseNotificationItem:Ft},props:{notification:{type:Object,required:true}},computed:{Color:()=>M.Color,notificationItem(){return this.notification},notificationParams(){var t,e;return(t=(e=this.notificationItem.params)==null?void 0:e.componentParams)!=null?t:null}},template:`\n\t\t<BaseNotificationItem :notification="notificationItem"/>\n\t`};const Qt={TaskEntity:Ut,CalendarEntity:wt,CompatibilityEntity:jt,CrmEntity:Rt,BizprocEntity:$t,SonetEntity:Vt,DefaultEntity:qt};const Xt={name:"ItemPlaceholder",props:{itemsToShow:{type:Number,default:50}},template:`\n\t\t<div class="bx-im-content-notification-placeholder__container" v-for="index in itemsToShow">\n\t\t\t<div class="bx-im-content-notification-placeholder__element">\n\t\t\t\t<div class="bx-im-content-notification-placeholder__avatar-container">\n\t\t\t\t\t<div class="bx-im-content-notification-placeholder__avatar"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="bx-im-content-notification-placeholder__content-container">\n\t\t\t\t\t<div class="bx-im-content-notification-placeholder__content-inner">\n\t\t\t\t\t\t<div class="bx-im-content-notification-placeholder__content --top"></div>\n\t\t\t\t\t\t<div class="bx-im-content-notification-placeholder__content --short"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="bx-im-content-notification-placeholder__content --full"></div>\n\t\t\t\t\t<div class="bx-im-content-notification-placeholder__content --middle"></div>\n\t\t\t\t\t<div class="bx-im-content-notification-placeholder__content --bottom"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const zt={name:"ScrollButton",props:{unreadCounter:{type:Number,default:0},notificationsOnScreen:{type:Object,required:true}},emits:["scrollButtonClick"],computed:{notificationCollection(){return this.$store.getters["notifications/getSortedCollection"]},hasUnreadOnScreen(){return[...this.notificationsOnScreen].some((t=>{var e;return!((e=this.notificationMapCollection.get(t))!=null&&e.read)}))},firstUnreadId(){const t=this.notificationCollection.find((t=>!t.read));if(!t){return}return t.id},firstUnreadBelowVisible(){const t=Math.min(...this.notificationsOnScreen);const e=this.notificationCollection.find((e=>!e.read&&e.sectionCode===M.NotificationTypesCodes.simple&&t>e.id));if(!e){return}return e.id},hasUnreadBelowVisible(){let t=0;for(let e=0;e<=this.notificationCollection.length-1;e++){if(!this.notificationCollection[e].read){++t}if(this.notificationsOnScreen.has(this.notificationCollection[e].id)&&this.unreadCounter===t){return false}}return true},showScrollButton(){if(this.unreadCounter===0||this.hasUnreadOnScreen){return false}return true},arrowButtonClass(){const t=this.hasUnreadBelowVisible;return{"bx-im-notifications-scroll-button-arrow-down":t,"bx-im-notifications-scroll-button-arrow-up":!t}},formattedCounter(){if(this.unreadCounter>99){return"99+"}return`${this.unreadCounter}`},...I.mapState({notificationMapCollection:t=>t.notifications.collection})},methods:{onScrollButtonClick(){let t=null;if(this.firstUnreadBelowVisible){t=this.firstUnreadBelowVisible}else if(!this.hasUnreadBelowVisible){t=this.firstUnreadId}let e=null;if(t!==null){const i=`.bx-im-content-notification-item__container[data-id="${t}"]`;e=document.querySelector(i)}if(e){this.$emit("scrollButtonClick",e.offsetTop)}else{const t=this.notificationCollection[this.notificationCollection.length-1];const e=`.bx-im-content-notification-item__container[data-id="${t.id}"]`;const i=document.querySelector(e);this.$emit("scrollButtonClick",i.offsetTop)}}},template:`\n\t\t<transition name="bx-im-notifications-scroll-button">\n\t\t\t<div \n\t\t\t\tv-show="showScrollButton" \n\t\t\t\tclass="bx-im-content-notification-scroll-button__container" \n\t\t\t\t@click="onScrollButtonClick"\n\t\t\t>\n\t\t\t\t<div class="bx-im-content-notification-scroll-button__button">\n\t\t\t\t\t<div class="bx-im-notifications-scroll-button-counter">\n\t\t\t\t\t\t{{ formattedCounter }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div :class="arrowButtonClass"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t`};const Gt={name:"NotificationFilterValueChip",components:{Chip:b.Chip},props:{text:{type:String,required:true},title:{type:String,default:""}},emits:["clear"],computed:{ChipDesign:()=>b.ChipDesign,ChipSize:()=>b.ChipSize},template:`\n\t\t<Chip\n\t\t\tclass="bx-im-notification-filter_search-value__chip-container"\n\t\t\t:size="ChipSize.Xs"\n\t\t\t:design="ChipDesign.Tinted"\n\t\t\t:text="text"\n\t\t\t:withClear="true"\n\t\t\t:title="title"\n\t\t\t:compact="false"\n\t\t\t@clear="$emit('clear')"\n\t\t/>\n\t`};const Wt="anotherValues";const Kt={name:"NotificationFilterValuesContainer",components:{NotificationFilterValueChip:Gt},props:{nonEmptyEntries:{type:Array,required:true}},emits:["remove"],computed:{ANOTHER_TYPE:()=>Wt,firstNonEmptyField(){const t=this.nonEmptyEntries;return t.length>0?t[0]:null},secondNonEmptyField(){const t=this.nonEmptyEntries;return t.length>1?t[1]:null},remainingNonEmptyEntries(){const t=this.nonEmptyEntries;return t.length>1?t.slice(1):[]},firstTagTitle(){if(!this.firstNonEmptyField){return""}return this.formatEntry(this.firstNonEmptyField)},secondTagTitle(){if(!this.secondNonEmptyField){return""}return this.formatEntry(this.secondNonEmptyField)},remainingTagTitle(){if(this.remainingNonEmptyEntries.length===0){return""}return this.remainingNonEmptyEntries.map((t=>this.formatEntry(t))).join("\n")},hasNonEmptyEntries(){return this.nonEmptyEntries.length>0},hasSingleRemainingEntry(){return this.remainingNonEmptyEntries.length===1},hasMultipleRemainingEntries(){return this.remainingNonEmptyEntries.length>1}},methods:{loc(t,e={}){return this.$Bitrix.Loc.getMessage(t,e)},getTitle(t,e){if(!e&&t===this.ANOTHER_TYPE&&this.remainingNonEmptyEntries.length>0){return this.loc("IM_NOTIFICATIONS_FILTER_ANOTHER_VALUES_TAG",{"#COUNT#":String(this.remainingNonEmptyEntries.length)})}return this.formatEntry({key:t,value:e})},getTagTitle(t){if(t===oe.searchTypes){return"IM_NOTIFICATIONS_FILTER_TYPE_FIELD_TAG_TEXT"}if(t===oe.searchDate){return"IM_NOTIFICATIONS_FILTER_DATE_FIELD_TAG_TEXT"}if(t===oe.searchAuthors){return"IM_NOTIFICATIONS_FILTER_AUTHOR_FIELD_TAG_TEXT"}return""},formatValue(t,e){if(B.Type.isArray(e)){return e.join(", ")}return String(e)},formatEntry(t){const e=this.getTagTitle(t.key);if(e===""){return""}return this.loc(e,{"#VALUE#":this.formatValue(t.key,t.value)})},onRemoveSimpleTag(t){if(this.firstNonEmptyField){this.$emit("remove",[t])}},onRemoveRemainingTags(){const t=this.remainingNonEmptyEntries.map((t=>t.key));if(t.length>0){this.$emit("remove",t)}}},template:`\n\t\t<div\n\t\t\tv-if="hasNonEmptyEntries"\n\t\t\tclass="bx-im-notification-filter-value_tags-container"\n\t\t>\n\t\t\t<NotificationFilterValueChip\n\t\t\t\tv-if="firstNonEmptyField"\n\t\t\t\t:text="getTitle(firstNonEmptyField.key, firstNonEmptyField.value)"\n\t\t\t\t:title="firstTagTitle"\n\t\t\t\tdata-test-id="im_notifications-filter__chip-first"\n\t\t\t\t@clear="onRemoveSimpleTag(firstNonEmptyField.key)"\n\t\t\t/>\n\t\t\t<NotificationFilterValueChip\n\t\t\t\tv-if="hasSingleRemainingEntry"\n\t\t\t\t:text="getTitle(secondNonEmptyField.key, secondNonEmptyField.value)"\n\t\t\t\t:title="secondTagTitle"\n\t\t\t\tdata-test-id="im_notifications-filter__chip-second"\n\t\t\t\t@clear="onRemoveSimpleTag(secondNonEmptyField.key)"\n\t\t\t/>\n\t\t\t<NotificationFilterValueChip\n\t\t\t\tv-if="hasMultipleRemainingEntries"\n\t\t\t\t:text="getTitle(ANOTHER_TYPE)"\n\t\t\t\t:title="remainingTagTitle"\n\t\t\t\tdata-test-id="im_notifications-filter__chip-third"\n\t\t\t\t@clear="onRemoveRemainingTags()"\n\t\t\t/>\n\t\t\t<span class="bx-im-notification-filter-plus">+</span>\n\t\t</div>\n\t`};const Yt={name:"NotificationFilterSearchInput",components:{BIcon:x.BIcon,NotificationFilterValuesContainer:Kt},props:{displayData:{type:Object,required:true},modelValue:{type:String,default:""}},emits:["update:modelValue","focus","remove","clear"],data(){return{isFocused:false}},computed:{Color:()=>M.Color,OutlineIcons:()=>x.Outline,isSearchEmpty(){return this.modelValue===""},withTags(){return this.nonEmptyEntries.length>0},nonEmptyEntries(){const t=[];for(const[s,o]of Object.entries(this.displayData)){if(B.Type.isArrayFilled(o)){t.push({key:s,value:o});continue}if(B.Type.isStringFilled(o)){t.push({key:s,value:o})}if(s===oe.searchDate){var e,i,n;if(((e=o.date)==null?void 0:e.length)>0){t.push({key:s,value:o.date});continue}if(((i=o.dateFrom)==null?void 0:i.length)>0&&((n=o.dateTo)==null?void 0:n.length)>0){t.push({key:s,value:`${o.dateFrom} - ${o.dateTo}`})}}}return t},placeholderText(){if(this.nonEmptyEntries.length>0){return this.loc("IM_NOTIFICATIONS_FILTER_SEARCH_INPUT_PLACEHOLDER_WITH_TAGS")}return this.loc("IM_NOTIFICATIONS_FILTER_SEARCH_INPUT_PLACEHOLDER")}},watch:{searchValue(){this.$emit("updateSearch",this.searchValue)}},methods:{loc(t,e={}){return this.$Bitrix.Loc.getMessage(t,e)},onFocus(t){this.isFocused=true;this.$emit("focus",t)},onRemove(t){this.$emit("remove",t)},onInput(t){this.$emit("update:modelValue",t.target.value)}},template:`\n\t\t<div\n\t\t\tclass="bx-im-content-notification-filter-search"\n\t\t\t:class="{ '--focused': isFocused }"\n\t\t\tref="container"\n\t\t\tdata-test-id="im_content-notification-filter__search-container"\n\t\t>\n\t\t\t<NotificationFilterValuesContainer\n\t\t\t\t:nonEmptyEntries="nonEmptyEntries"\n\t\t\t\t@remove="onRemove"\n\t\t\t/>\n\t\t\t<input\n\t\t\t\tclass="bx-im-content-notification-filter-search__input"\n\t\t\t\ttype="text"\n\t\t\t\t:value="modelValue"\n\t\t\t\t:class="{ '--with-tags': this.withTags }"\n\t\t\t\t:placeholder="placeholderText"\n\t\t\t\tdata-test-id="im_notifications-filter__search-input"\n\t\t\t\t@focus="onFocus"\n\t\t\t\t@input="onInput"\n\t\t\t\t@blur="this.isFocused = false"\n\t\t\t/>\n\t\t\t<div class="bx-im-content-notification-filter-search__icons-block">\n\t\t\t\t<BIcon\n\t\t\t\t\t:name="OutlineIcons.SEARCH"\n\t\t\t\t\t:size="20"\n\t\t\t\t\t:color="Color.base5"\n\t\t\t\t\t:hoverable="true"\n\t\t\t\t\tclass="bx-im-content-notification-filter-search__icon-search"\n\t\t\t\t\t:class="{ '--without-delete-icon': isSearchEmpty }"\n\t\t\t\t/>\n\t\t\t\t<BIcon\n\t\t\t\t\t:name="OutlineIcons.CROSS_L"\n\t\t\t\t\t:size="20"\n\t\t\t\t\t:color="Color.base5"\n\t\t\t\t\t:hoverable="true"\n\t\t\t\t\tclass="bx-im-content-notification-filter-search__icon-delete"\n\t\t\t\t\t:class="{ '--hidden': isSearchEmpty }"\n\t\t\t\t\tdata-test-id="im_notifications-filter__search-reset"\n\t\t\t\t\t@click.stop="$emit('clear')"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`};const Jt={name:"NotificationFilterPopupActionButtons",components:{UiButton:_.Button},emits:["search","reset"],computed:{OutlineIcons:()=>C.Outline,ButtonSize:()=>_.ButtonSize,AirButtonStyle:()=>_.AirButtonStyle},methods:{loc(t,e={}){return this.$Bitrix.Loc.getMessage(t,e)}},template:`\n\t\t<div class="bx-im-content-notification-filter-popup__actions-container">\n\t\t\t<UiButton\n\t\t\t\t:text="loc('IM_NOTIFICATIONS_FILTER_SEARCH_BUTTON')"\n\t\t\t\tclass="--air"\n\t\t\t\t:style="AirButtonStyle.FILLED"\n\t\t\t\t:size="ButtonSize.LARGE"\n\t\t\t\t:leftIcon="OutlineIcons.SEARCH"\n\t\t\t\t:dataset="{ testId: 'im_content-notification-filter__popup-search-button' }"\n\t\t\t\t@click="$emit('search')"\n\t\t\t/>\n\t\t\t<UiButton\n\t\t\t\t:text="loc('IM_NOTIFICATIONS_FILTER_RESET_BUTTON')"\n\t\t\t\tclass="--air"\n\t\t\t\t:style="AirButtonStyle.PLAIN"\n\t\t\t\t:size="ButtonSize.LARGE"\n\t\t\t\t:dataset="{ testId: 'im_content-notification-filter__popup-reset-button' }"\n\t\t\t\t@click="$emit('reset')"\n\t\t\t/>\n\t\t</div>\n\t`};const Zt={name:"AuthorFilterField",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue","popupStateChange"],computed:{labelText(){return this.loc("IM_NOTIFICATIONS_FILTER_AUTHOR_FIELD_TITLE")}},mounted(){this.selector=this.getSelector();this.selector.renderTo(this.$refs["author-selector"])},methods:{loc(t,e={}){return this.$Bitrix.Loc.getMessage(t,e)},getSelector(){var t;const e=this.modelValue.map((t=>["user",t.id]));const i=new y.TagSelector({events:{onTagAdd:t=>{const{tag:e}=t.getData();if(!this.modelValue.some((t=>t.id===e.id))){var i,n;const t=[...this.modelValue,{id:e.id,name:(i=(n=e.title)==null?void 0:n.text)!=null?i:String(e.id)}];this.$emit("update:modelValue",t)}},onTagRemove:t=>{const{tag:e}=t.getData();const i=this.modelValue.filter((t=>t.id!==e.id));this.$emit("update:modelValue",i)}},multiple:true,dialogOptions:{height:250,width:380,preselectedItems:e,entities:[{id:"user",options:{intranetUsersOnly:true,inviteEmployeeLink:false}}],dropdownMode:true,hideOnDeselect:false,events:{onShow:()=>{this.$emit("popupStateChange",{popup:"author",active:true})},onHide:()=>{this.$emit("popupStateChange",{popup:"author",active:false})}}}});const n=(t=i.getDialog())==null?void 0:t.getContainer();if(n){B.Dom.attr(n,"data-test-id","im_notifications-filter__author-field-selector")}return i}},template:`\n\t\t<div class="bx-im-notifications-filter_field__container">\n\t\t\t<div class="bx-im-notifications-filter_field__label">{{ labelText }}</div>\n\t\t\t<div\n\t\t\t\tref="author-selector"\n\t\t\t\tclass="bx-im-notifications-filter_field__selector-container"\n\t\t\t\tdata-test-id="im_notifications-filter__author-field-container"\n\t\t\t/>\n\t\t</div>\n\t`};const te={name:"TypeFilterField",props:{modelValue:{type:Array,default:()=>[]},schema:{type:Object,required:false,default:null}},emits:["update:modelValue","popupStateChange"],computed:{labelText(){return this.loc("IM_NOTIFICATIONS_FILTER_TYPE_FIELD_TITLE")}},mounted(){this.selector=this.getSelector();this.selector.renderTo(this.$refs["type-selector"])},methods:{loc(t,e={}){return this.$Bitrix.Loc.getMessage(t,e)},getSelector(){var t;const e="im-notification-filter-type";const i=this.getTargetNode();const n=this.filterTypes().map((t=>({id:String(t.MODULE_ID),entityId:e,tabs:"recents",title:t.NAME,selected:this.modelValue.some((e=>e.id===String(t.MODULE_ID)))})));const s=new y.TagSelector({events:{onTagAdd:t=>{const{tag:e}=t.getData();if(!this.modelValue.some((t=>t.id===e.id))){var i,n;const t=[...this.modelValue,{id:e.id,name:(i=(n=e.title)==null?void 0:n.text)!=null?i:String(e.id)}];this.$emit("update:modelValue",t)}},onTagRemove:t=>{const{tag:e}=t.getData();const i=this.modelValue.filter((t=>t.id!==e.id));this.$emit("update:modelValue",i)}},multiple:true,dialogOptions:{height:250,width:300,multiple:true,dropdownMode:true,compactView:true,showAvatars:false,hideOnDeselect:false,enableSearch:false,targetNode:i,items:n,events:{"Item:onSelect":t=>{const{item:e}=t.getData();if(!this.modelValue.some((t=>t.id===e.id))){var i,n;const t=[...this.modelValue,{id:e.id,name:(i=(n=e.title)==null?void 0:n.text)!=null?i:String(e.id)}];this.$emit("update:modelValue",t)}},onShow:()=>{this.$emit("popupStateChange",{popup:"type",active:true})},onHide:()=>{this.$emit("popupStateChange",{popup:"type",active:false})}}}});const o=(t=s.getDialog())==null?void 0:t.getContainer();if(o){B.Dom.attr(o,"data-test-id","im_notifications-filter__types-field-selector")}return s},getTargetNode(){var t,e,i;return(t=(e=this.$refs["type-selector"])==null?void 0:(i=e.$refs)==null?void 0:i.inputContainer)!=null?t:this.$el},filterTypes(){const t={...this.schema};if(t.calendar){t.calendar.NAME=this.$Bitrix.Loc.getMessage("IM_NOTIFICATIONS_SEARCH_FILTER_TYPE_CALENDAR")}if(t.sender){t.sender.NAME=this.$Bitrix.Loc.getMessage("IM_NOTIFICATIONS_SEARCH_FILTER_TYPE_SENDER")}if(t.blog){t.blog.NAME=this.$Bitrix.Loc.getMessage("IM_NOTIFICATIONS_SEARCH_FILTER_TYPE_BLOG")}if(t.socialnetwork){t.socialnetwork.NAME=this.$Bitrix.Loc.getMessage("IM_NOTIFICATIONS_SEARCH_FILTER_TYPE_SOCIALNETWORK")}if(t.intranet){t.intranet.NAME=this.$Bitrix.Loc.getMessage("IM_NOTIFICATIONS_SEARCH_FILTER_TYPE_INTRANET")}const e=["tasks","calendar","crm","timeman","mail","disk","bizproc","voximplant","sender","blog","vote","socialnetwork","imopenlines","photogallery","intranet","forum"];const i=[];e.forEach((e=>{if(t[e]){i.push(t[e])}}));return i}},template:`\n\t\t<div class="bx-im-notifications-filter_field__container">\n\t\t\t<div class="bx-im-notifications-filter_field__label">{{ labelText }}</div>\n\t\t\t<div\n\t\t\t\tref="type-selector"\n\t\t\t\tclass="bx-im-notifications-filter_field__selector-container"\n\t\t\t\tdata-test-id="im_notifications-filter__type-field-container"\n\t\t\t/>\n\t\t</div>\n\t`};const ee={NONE:"none",SINGLE:"single",RANGE:"range"};const ie={name:"DateFilterField",components:{BIcon:x.BIcon,BInput:k.BInput},props:{modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue","popupStateChange"],data(){return{searchType:this.getCurrentSearchType()}},beforeUnmount(){var t;(t=this.menu)==null?void 0:t.destroy()},computed:{OutlineIcons:()=>x.Outline,InputSize:()=>k.InputSize,isFirstDateNotEmpty(){var t,e;return((t=this.modelValue.date)==null?void 0:t.length)>0||((e=this.modelValue.dateFrom)==null?void 0:e.length)>0},isSecondDateNotEmpty(){var t;return((t=this.modelValue.dateTo)==null?void 0:t.length)>0},labelText(){return this.loc("IM_NOTIFICATIONS_FILTER_DATE_FIELD_TITLE")},dateOptionText(){const t=this.getDateOptions().find((t=>t.id===this.searchType));return t?t.text:""},showFirstDateInput(){return this.searchType===ee.SINGLE||this.searchType===ee.RANGE},showSecondDateInput(){return this.searchType===ee.RANGE},firstDateValue(){if(this.searchType===ee.SINGLE){return this.modelValue.date||""}if(this.searchType===ee.RANGE){return this.modelValue.dateFrom||""}return""},secondDateValue(){if(this.searchType===ee.RANGE){return this.modelValue.dateTo||""}return""}},methods:{loc(t,e={}){return this.$Bitrix.Loc.getMessage(t,e)},getCurrentSearchType(){if(this.modelValue.date){return ee.SINGLE}if(this.modelValue.dateFrom&&this.modelValue.dateTo){return ee.RANGE}return ee.NONE},getDateOptions(){return[{id:ee.NONE,text:this.loc("IM_NOTIFICATIONS_FILTER_DATE_OPTION_NONE")},{id:ee.SINGLE,text:this.loc("IM_NOTIFICATIONS_FILTER_DATE_OPTION_SINGLE")},{id:ee.RANGE,text:this.loc("IM_NOTIFICATIONS_FILTER_DATE_OPTION_RANGE")}]},getOptionsMenuItems(){return this.getDateOptions().map((t=>({title:t.text,isSelected:t.id===this.searchType,onClick:()=>{this.searchType=t.id;this.$emit("update:modelValue",{});this.menu.updateItems(this.getOptionsMenuItems())}})))},onDateOptionClick(){this.$emit("popupStateChange",{popup:"dateOptions",active:true});if(!this.menu){var t;(t=N.PopupManager.getPopupById("im-notification-filter-date-option"))==null?void 0:t.destroy();this.menu=new E.Menu({id:"im-notification-filter-date-option",maxHeight:400,animation:"fading-slide",items:this.getOptionsMenuItems(),events:{onPopupAfterClose:()=>{this.$emit("popupStateChange",{popup:"dateOptions",active:false})}}})}this.menu.show(this.$refs.dateOption.$el);const e=this.menu.getPopupContainer();if(e){B.Dom.attr(e,"data-test-id","im_notifications-filter__type-field-menu")}},onDateFilterClick(t,e=false){this.$emit("popupStateChange",{popup:"datePicker",active:true});if(this.ignoreNextClick){this.ignoreNextClick=false;return}this.datePickerInstance=new A.DatePicker({targetNode:t.target,animation:"fading-slide",events:{[A.DatePickerEvent.SELECT]:t=>this.handleDatePickerSelect(t,e),onHide:()=>{this.datePickerInstance.destroy()}},popupOptions:{animation:"fading-slide",events:{onPopupAfterClose:()=>{this.$emit("popupStateChange",{popup:"datePicker",active:false})}}}});const i=e?this.secondDateValue:this.firstDateValue;if(i){const t=this.datePickerInstance.getDateFormat();this.datePickerInstance.selectDates([A.createDate(i,t)])}this.datePickerInstance.show()},onSecondDateFilterClick(t){this.onDateFilterClick(t,true)},handleDatePickerSelect(t,e=false){const{date:i}=t.getData();const n=this.datePickerInstance.formatDate(i);if(e){this.$emit("update:modelValue",{date:this.modelValue.date||"",dateFrom:this.modelValue.dateFrom||"",dateTo:n});return}if(this.searchType===ee.SINGLE){this.$emit("update:modelValue",{date:n,dateFrom:"",dateTo:""});return}this.$emit("update:modelValue",{date:this.modelValue.date||"",dateFrom:n,dateTo:this.modelValue.dateTo||""})},onFirstDateClear(){this.$emit("update:modelValue",{date:"",dateFrom:"",dateTo:this.modelValue.dateTo||""})},onSecondDateClear(){this.$emit("update:modelValue",{date:this.modelValue.date||"",dateFrom:this.modelValue.dateFrom||"",dateTo:""})}},template:`\n\t\t<div class="bx-im-notifications-filter_field__container">\n\t\t\t<div class="bx-im-notifications-filter_field__label">{{ labelText }}</div>\n\t\t\t<div class="bx-im-notifications-filter_field__selector-container bx-im-content-notification-date-field-container">\n\t\t\t\t<BInput\n\t\t\t\t\tv-model="dateOptionText"\n\t\t\t\t\tclass="bx-im-content-notification-date-field"\n\t\t\t\t\t:class="[{ '--with-margin': showFirstDateInput }, { '--range-option': showSecondDateInput }]"\n\t\t\t\t\tref="dateOption"\n\t\t\t\t\t:clickable="true"\n\t\t\t\t\t:dropdown="true"\n\t\t\t\t\t:size="InputSize.Lg"\n\t\t\t\t\tdata-test-id="im_notifications-filter__date-options-container"\n\t\t\t\t\t@click="onDateOptionClick"\n\t\t\t\t/>\n\t\t\t\t<BInput\n\t\t\t\t\tv-if="showFirstDateInput"\n\t\t\t\t\tv-model="firstDateValue"\n\t\t\t\t\tclass="bx-im-content-notification-date-field"\n\t\t\t\t\t:class="{'--with-margin': showSecondDateInput}"\n\t\t\t\t\t:icon="OutlineIcons.CALENDAR_WITH_SLOTS"\n\t\t\t\t\t:clickable="true"\n\t\t\t\t\t:withClear="isFirstDateNotEmpty"\n\t\t\t\t\t:size="InputSize.Lg"\n\t\t\t\t\tdata-test-id="im_notifications-filter__date-from-date-container"\n\t\t\t\t\t@clear="onFirstDateClear"\n\t\t\t\t\t@click="onDateFilterClick"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if="showSecondDateInput"\n\t\t\t\t\tclass="bx-im-content-notification-date-field-line"\n\t\t\t\t>\n\t\t\t\t\t<span class="bx-im-content-notification-date-field-line-item"/>\n\t\t\t\t</div>\n\t\t\t\t<BInput\n\t\t\t\t\tv-if="showSecondDateInput"\n\t\t\t\t\tv-model="secondDateValue"\n\t\t\t\t\tclass="bx-im-content-notification-date-field"\n\t\t\t\t\t:icon="OutlineIcons.CALENDAR_WITH_SLOTS"\n\t\t\t\t\t:clickable="true"\n\t\t\t\t\t:withClear="isSecondDateNotEmpty"\n\t\t\t\t\t:size="InputSize.Lg"\n\t\t\t\t\tdata-test-id="im_notifications-filter__date-to-date-container"\n\t\t\t\t\t@clear="onSecondDateClear"\n\t\t\t\t\t@click="onSecondDateFilterClick"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`};const ne="im-content-notification-filter-popup";const se={name:"NotificationFilterPopup",components:{MessengerPopup:T.MessengerPopup,NotificationFilterActionButtons:Jt,NotificationFilterAuthorField:Zt,NotificationFilterTypeField:te,NotificationFilterDateField:ie},props:{bindElement:{type:Object,required:true},schema:{type:Object,required:false,default:null},filterData:{type:Object,default:()=>({searchTypes:[],searchDate:{},searchAuthors:[]})}},emits:["close","search","reset","mounted","popupStateChange"],data(){return{searchTypes:this.filterData.searchTypes,searchDate:this.filterData.searchDate,searchAuthors:this.filterData.searchAuthors}},computed:{popupId:()=>ne,config(){return{width:560,height:350,bindElement:this.bindElement,offsetTop:10,autoHide:false,padding:0,contentPadding:0,bindOptions:{position:"bottom"},className:"bx-im-content-notification-filter-popup",animation:"fading-slide"}}},mounted(){this.$emit("mounted",this.$refs.wrapper)},methods:{buildData(){return{searchTypes:this.searchTypes,searchDate:this.searchDate,searchAuthors:this.searchAuthors}},onSearchClick(){this.$emit("search",this.buildData())},getContentElement(){return this.$refs.wrapper}},template:`\n\t\t<MessengerPopup\n\t\t\t:config="config"\n\t\t\t:id="popupId"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass="bx-im-content-notification-filter-popup__wrapper"\n\t\t\t\tref="wrapper"\n\t\t\t>\n\t\t\t\t<div class="bx-im-content-notification-filter-popup__fields-list bx-im-messenger__scope">\n\t\t\t\t\t<NotificationFilterAuthorField\n\t\t\t\t\t\tv-model="searchAuthors"\n\t\t\t\t\t\t@popupStateChange="$emit('popupStateChange', $event)"\n\t\t\t\t\t/>\n\t\t\t\t\t<NotificationFilterTypeField\n\t\t\t\t\t\tv-model="searchTypes"\n\t\t\t\t\t\t:schema="schema"\n\t\t\t\t\t\t@popupStateChange="$emit('popupStateChange', $event)"\n\t\t\t\t\t/>\n\t\t\t\t\t<NotificationFilterDateField\n\t\t\t\t\t\tv-model="searchDate"\n\t\t\t\t\t\t@popupStateChange="$emit('popupStateChange', $event)"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<NotificationFilterActionButtons\n\t\t\t\t\t@search="onSearchClick"\n\t\t\t\t\t@reset="this.$emit('reset')"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</MessengerPopup>\n\t`};const oe=Object.freeze({searchAuthors:"searchAuthors",searchTypes:"searchTypes",searchDate:"searchDate"});const ae={name:"NotificationFilter",components:{NotificationFilterSearchInput:Yt,NotificationFilterPopup:se},props:{schema:{type:Object,required:false,default:null}},emits:["search"],data(){return{isInputFocused:false,activePopups:{author:false,type:false,dateOptions:false,datePicker:false},filterData:{searchQuery:"",searchAuthors:[],searchTypes:[],searchDate:{}},popupElement:null}},computed:{displayData(){var t,e;const i=[];(t=this.filterData.searchTypes)==null?void 0:t.forEach((t=>{i.push(t.name)}));const n=[];(e=this.filterData.searchAuthors)==null?void 0:e.forEach((t=>{n.push(t.name)}));return{searchTypes:i,searchDate:this.filterData.searchDate,searchAuthors:n}}},watch:{"filterData.searchQuery":function(t){this.onSearchUpdate(t)}},mounted(){B.Event.bind(document,"click",this.handleClickOutside)},beforeUnmount(){B.Event.unbind(document,"click",this.handleClickOutside)},methods:{onInputFocus(){this.isInputFocused=!this.isInputFocused;this.clearActivePopups()},onPopupClose(){this.isInputFocused=false;this.clearActivePopups()},clearActivePopups(){this.activePopups={author:false,type:false,dateOptions:false,datePicker:false}},applyData(t={},e=false){var i,n,s,o,a;this.filterData={searchQuery:e?"":this.filterData.searchQuery,searchTypes:(i=t.searchTypes)!=null?i:[],searchDate:(n=t.searchDate)!=null?n:{},searchAuthors:(s=t.searchAuthors)!=null?s:[]};const r=[];if(B.Type.isArray(t.searchTypes)){t.searchTypes.forEach((t=>{r.push(t.id)}))}const c=[];if(B.Type.isArray(t.searchAuthors)){t.searchAuthors.forEach((t=>{c.push(t.id)}))}let{dateFrom:l,dateTo:u}=(o=t.searchDate)!=null?o:{};if(l&&u){const t=new Date(l).getTime();const e=new Date(u).getTime();if(e<t){[l,u]=[u,l]}}else{l="";u=""}const d={searchQuery:this.filterData.searchQuery,searchTypes:r,searchDate:(a=this.filterData.searchDate.date)!=null?a:"",searchDateFrom:l,searchDateTo:u,searchAuthors:c};this.$emit("search",d)},onPopupUpdate(t){this.applyData(t);this.isInputFocused=false},onFilterReset(){this.applyData({},true);this.isInputFocused=false},onSearchUpdate(){this.isInputFocused=false;this.applyData(this.filterData)},onTagsRemove(t){t.forEach((t=>{switch(t){case oe.searchTypes:{this.filterData.searchTypes=[];break}case oe.searchDate:{this.filterData.searchDate={};break}case oe.searchAuthors:{this.filterData.searchAuthors=[];break}default:{break}}}));this.isInputFocused=false;this.applyData(this.filterData)},onPopupStateChange({popup:t,active:e}){this.activePopups[t]=e},handleClickOutside(t){var e;if(!this.isInputFocused){return}const i=Object.values(this.activePopups).some((t=>t));if(i){return}const n=this.getInputElement();const s=n==null?void 0:n.contains(t.target);const o=(e=this.popupElement)==null?void 0:e.contains(t.target);if(!s&&!o){this.isInputFocused=false}},getInputElement(){return this.$refs.searchInput},onPopupMounted(t){this.popupElement=t}},template:`\n\t\t<div ref="searchInput">\n\t\t\t<NotificationFilterSearchInput\n\t\t\t\t:displayData="displayData"\n\t\t\t\tv-model="filterData.searchQuery"\n\t\t\t\t@clear="onFilterReset"\n\t\t\t\t@remove="onTagsRemove"\n\t\t\t\t@click="onInputFocus"\n\t\t\t/>\n\t\t</div>\n\t\t<NotificationFilterPopup\n\t\t\tv-if="isInputFocused"\n\t\t\t:schema="schema"\n\t\t\t:bindElement="getInputElement()"\n\t\t\t:filterData="filterData"\n\t\t\t@search="onPopupUpdate"\n\t\t\t@reset="onFilterReset"\n\t\t\t@close="onPopupClose"\n\t\t\t@mounted="onPopupMounted"\n\t\t\t@popupStateChange="onPopupStateChange"\n\t\t\tref="filterPopup"\n\t\t/>\n\t`};const re=50;class ce{constructor(){this.searchQuery="";this.searchTypes=[];this.searchDate=null;this.searchDateFrom=null;this.searchDateTo=null;this.searchAuthors=[];this.store=null;this.restClient=null;this.userManager=null;this.isLoading=false;this.lastId=0;this.hasMoreItemsToLoad=true;this.store=O.Core.getStore();this.restClient=O.Core.getRestClient();this.userManager=new P.UserManager}loadFirstPage({searchQuery:t,searchAuthors:e,searchTypes:i,searchDate:n,searchDateFrom:s,searchDateTo:o}){this.isLoading=true;this.searchQuery=t;this.searchAuthors=e;this.searchTypes=i;this.searchDate=n;this.searchDateFrom=s;this.searchDateTo=o;return this.requestItems({firstPage:true})}loadNextPage(){if(this.isLoading||!this.hasMoreItemsToLoad){return Promise.resolve()}this.isLoading=true;return this.requestItems()}searchInModel({searchQuery:t,searchAuthors:e,searchTypes:i,searchDate:n,searchDateFrom:s,searchDateTo:o}){this.searchQuery=t;this.searchAuthors=e;this.searchTypes=i;this.searchDate=n;this.searchDateFrom=s;this.searchDateTo=o;return this.store.getters["notifications/getSortedCollection"].filter((t=>{var e,i,n;let s=false;if(((e=this.searchQuery)==null?void 0:e.length)>=3){s=t.text.toLowerCase().includes(this.searchQuery.toLowerCase());if(!s){return s}}if(((i=this.searchTypes)==null?void 0:i.length)>0){const e=t.settingName.split("|")[0];s=this.searchTypes.includes(e);if(!s){return s}}if(this.searchDateFrom!==""&&this.searchDateTo!==""){const e=BX.parseDate(this.searchDateFrom);const i=BX.parseDate(this.searchDateTo);if(e instanceof Date&&i instanceof Date){const n=new Date(t.date.getTime()).setHours(0,0,0,0);const o=e.setHours(0,0,0,0);const a=i.setHours(0,0,0,0);s=n>=o&&n<=a;if(!s){return s}}}else if(this.searchDate!==""){const e=BX.parseDate(this.searchDate);if(e instanceof Date){const i=new Date(t.date.getTime()).setHours(0,0,0,0);const n=e.setHours(0,0,0,0);s=i===n;if(!s){return s}}}if(((n=this.searchAuthors)==null?void 0:n.length)>0){s=this.searchAuthors.includes(t.authorId);if(!s){return s}}return s}))}requestItems({firstPage:t=false}={}){const e=this.getSearchRequestParams(t);return this.restClient.callMethod(M.RestMethod.imNotifyHistorySearch,e).then((t=>{const e=t.data();L.Logger.warn("im.notify.history.search: first page results",e);this.hasMoreItemsToLoad=!this.isLastPage(e.notifications);if(!e||e.notifications.length===0){L.Logger.warn("im.notify.get: no notifications",e);return[]}this.lastId=this.getLastItemId(e.notifications);this.userManager.setUsersToModel(e.users);this.isLoading=false;return e.notifications})).catch((t=>{console.error("NotificationService: requestItems error",t.error())}))}getSearchRequestParams(t){const e={SEARCH_TEXT:this.searchQuery,SEARCH_TYPES:this.searchTypes,SEARCH_AUTHORS:this.searchAuthors,LIMIT:re,CONVERT_TEXT:"Y"};if(BX.parseDate(this.searchDateFrom)instanceof Date&&BX.parseDate(this.searchDateTo)instanceof Date){e.SEARCH_DATE_FROM=BX.parseDate(this.searchDateFrom).toISOString();e.SEARCH_DATE_TO=BX.parseDate(this.searchDateTo).toISOString()}else if(BX.parseDate(this.searchDate)instanceof Date){e.SEARCH_DATE=BX.parseDate(this.searchDate).toISOString()}if(!t){e.LAST_ID=this.lastId}return e}getLastItemId(t){return t[t.length-1].id}isLastPage(t){return!B.Type.isArrayFilled(t)||t.length<re}destroy(){L.Logger.warn("Notification search service destroyed")}}const le={name:"NotificationContent",components:{ItemPlaceholder:Xt,ScrollButton:zt,NotificationFilter:ae,UserListPopup:n.UserListPopup,Loader:s.Loader},directives:{"notifications-item-observer":{mounted(t,e){e.instance.observer.observe(t)},beforeUnmount(t,e){e.instance.observer.unobserve(t)}}},data(){return{isInitialLoading:false,initialLoadComplete:false,readQueue:new Set,isNextPageLoading:false,notificationsOnScreen:new Set,markedAsUnreadIds:new Set,windowFocused:false,showSearchResult:false,popupBindElement:null,showUserListPopup:false,userListIds:null,schema:{}}},computed:{NotificationTypesCodes:()=>M.NotificationTypesCodes,notificationCollection(){return this.$store.getters["notifications/getSortedCollection"]},confirmNotifications(){return this.notifications.filter((t=>t.sectionCode===M.NotificationTypesCodes.confirm))},hasConfirmNotifications(){return this.confirmNotifications.length>0},simpleNotifications(){return this.notifications.filter((t=>t.sectionCode!==M.NotificationTypesCodes.confirm))},confirmNotificationsCounter(){return this.confirmNotifications.length},formattedCounter(){return this.confirmNotificationsCounter>99?"99+":String(this.confirmNotificationsCounter)},searchResultCollection(){return this.$store.getters["notifications/getSearchResultCollection"]},notifications(){if(this.showSearchResult){return this.searchResultCollection}return this.notificationCollection},isReadAllAvailable(){if(this.showSearchResult){return false}return this.unreadCounter>0},isEmptyState(){return this.notifications.length===0&&!this.isInitialLoading&&!this.isNextPageLoading},emptyStateIcon(){return this.showSearchResult?"bx-im-content-notification__not-found-icon":"bx-im-content-notification__empty-state-icon"},emptyStateTitle(){return this.showSearchResult?this.$Bitrix.Loc.getMessage("IM_NOTIFICATIONS_SEARCH_RESULTS_NOT_FOUND"):this.$Bitrix.Loc.getMessage("IM_NOTIFICATIONS_NO_NEW_ITEMS")},enableAutoRead(){return this.$store.getters["application/settings/get"](M.Settings.notification.enableAutoRead)},...I.mapState({unreadCounter:t=>t.notifications.unreadCounter})},created(){this.notificationService=new i.NotificationService;this.notificationSearchService=new ce;this.notificationReadService=new F;this.headerMenu=new w;this.searchOnServerDelayed=B.Runtime.debounce(this.searchOnServer,1500,this);B.Event.bind(window,"focus",this.onWindowFocus);B.Event.bind(window,"blur",this.onWindowBlur);this.initObserver();S.EventEmitter.subscribe(Y.events.markAsUnreadClick,this.onMarkAsUnreadClick)},async mounted(){this.isInitialLoading=true;this.windowFocused=document.hasFocus();this.schema=await this.notificationService.loadFirstPage();this.isInitialLoading=false;this.initialLoadComplete=true;this.processReadQueue()},beforeUnmount(){if(this.initialLoadComplete&&this.enableAutoRead){this.notificationReadService.readAll([...this.markedAsUnreadIds])}this.notificationService.destroy();this.notificationSearchService.destroy();this.notificationReadService.destroy();if(this.headerMenu){this.headerMenu.destroy()}B.Event.unbind(window,"focus",this.onWindowFocus);B.Event.unbind(window,"blur",this.onWindowBlur);S.EventEmitter.unsubscribe(Y.events.markAsUnreadClick,this.onMarkAsUnreadClick)},methods:{initObserver(){this.observer=new IntersectionObserver((t=>{t.forEach((t=>{const e=Number.parseInt(t.target.dataset.id,10);if(!t.isIntersecting){this.notificationsOnScreen.delete(e);return}if(t.intersectionRatio>=.7||t.intersectionRatio>0&&t.intersectionRect.height>t.rootBounds.height/2){this.read(e);this.notificationsOnScreen.add(e)}else{this.notificationsOnScreen.delete(e)}}))}),{root:this.$refs.listNotifications,threshold:Array.from({length:101}).fill(0).map(((t,e)=>e*.01))})},read(t){if(!this.enableAutoRead){L.Logger.warn("Notifications: Auto read is disabled!");return}if(!this.windowFocused){return}if(B.Type.isNumber(t)){t=[t]}if(!this.initialLoadComplete){t.forEach((t=>this.readQueue.add(t)));return}const e=t.filter((t=>{const e=this.$store.getters["notifications/getById"](t);return e.sectionCode!==M.NotificationTypesCodes.confirm}));if(e.length>0){this.notificationReadService.addToReadQueue(e);this.notificationReadService.read()}},processReadQueue(){if(this.readQueue.size===0){return}L.Logger.warn(`Processing initial read queue with ${this.readQueue.size} items.`);const t=[...this.readQueue];this.readQueue.clear();this.read(t)},async searchOnServer(t){const e=await this.notificationSearchService.loadFirstPage(t);this.isNextPageLoading=false;this.setSearchResult(e)},setSearchResult(t){this.$store.dispatch("notifications/setSearchResult",{notifications:t})},getComponentForItem(t){var e;const i=(e=t.params)==null?void 0:e.componentId;if(i&&Qt[i]){return Qt[i]}return Qt.CompatibilityEntity},onScrollButtonClick(t){this.$refs.listNotifications.scroll({top:t,behavior:"smooth"})},onScroll(t){Y.closeMenuOnScroll();this.showUserListPopup=false;if(this.showSearchResult){this.onScrollSearchResult(t)}else{this.onScrollNotifications(t)}},onClickHeaderMenu(t){this.headerMenu.openMenu(this.isReadAllAvailable,t.currentTarget)},onScrollNotifications(t){if(!u.Utils.dom.isOneScreenRemaining(t.target)||!this.notificationService.hasMoreItemsToLoad||this.isInitialLoading||this.isNextPageLoading){return}this.isNextPageLoading=true;this.notificationService.loadNextPage().then((()=>{this.isNextPageLoading=false}))},async onScrollSearchResult(t){if(!u.Utils.dom.isOneScreenRemaining(t.target)||!this.notificationSearchService.hasMoreItemsToLoad||this.isInitialLoading||this.isNextPageLoading){return}this.isNextPageLoading=true;const e=await this.notificationSearchService.loadNextPage();this.isNextPageLoading=false;this.setSearchResult(e)},onConfirmButtonsClick(t){const{id:e,value:i}=t;const n=Number.parseInt(e,10);this.notificationsOnScreen.delete(n);this.notificationService.sendConfirmAction(n,i)},onDeleteClick(t){this.notificationsOnScreen.delete(t);this.notificationService.delete(t)},onMoreUsersClick(t){L.Logger.warn("onMoreUsersClick",t);this.popupBindElement=t.event.target;this.userListIds=t.users;this.showUserListPopup=true},onSearch(t){var e,i,n;if(((e=t.searchQuery)==null?void 0:e.length)<3&&((i=t.searchTypes)==null?void 0:i.length)===0&&t.searchDate===""&&(t.searchDateFrom===""||t.searchDateTo==="")&&((n=t.searchAuthors)==null?void 0:n.length)===0){this.showSearchResult=false;return}this.showSearchResult=true;const s=this.notificationSearchService.searchInModel(t);this.$store.dispatch("notifications/clearSearchResult");this.$store.dispatch("notifications/setSearchResult",{notifications:s,skipValidation:true});this.isNextPageLoading=true;this.searchOnServerDelayed(t)},onSendQuickAnswer(t){this.notificationService.sendQuickAnswer(t)},onWindowFocus(){this.windowFocused=true;this.read([...this.notificationsOnScreen])},onWindowBlur(){this.windowFocused=false},onLeave(t,e){const i=250;const{height:n}=t.getBoundingClientRect();B.Dom.style(t,"height",`${n}px`);requestAnimationFrame((()=>{B.Dom.addClass(t,"--leave");B.Dom.style(t,"height","0px")}));setTimeout(e,i)},onDoubleClick(t){const e=this.$store.getters["notifications/getById"](t)||this.$store.getters["notifications/getSearchItemById"](t);if(!e){return}B.Event.EventEmitter.emit(Y.events.markAsUnreadClick,e)},onMarkAsUnreadClick(t){const e=t.getData();if(!e){return}const i=e.id;if(e.read){this.markedAsUnreadIds.add(i)}else{this.markedAsUnreadIds.delete(i)}},getNotificationsBackgroundStyle(){return o.ThemeManager.getBackgroundStyleById(o.SpecialBackground.notifications)}},template:`\n\t\t<div class="bx-im-content-notification__container --ui-context-content-light">\n\t\t\t<div class="bx-im-content-notification__header-container">\n\t\t\t\t<div class="bx-im-content-notification__header">\n\t\t\t\t\t<div class="bx-im-content-notification__header-left-container">\n\t\t\t\t\t\t<div class="bx-im-content-notification__header-panel-container">\n\t\t\t\t\t\t\t<div class="bx-im-content-notification__panel-title_icon"></div>\n\t\t\t\t\t\t\t<div class="bx-im-content-notification__panel_text">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('IM_NOTIFICATIONS_HEADER') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<NotificationFilter\n\t\t\t\t\t\t\tv-if="this.initialLoadComplete && notificationCollection.length > 0"\n\t\t\t\t\t\t\t:schema="schema"\n\t\t\t\t\t\t\t@search="onSearch"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if="notificationCollection.length > 0" class="bx-im-content-notification__header-buttons-container">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass="bx-im-content-notification__header-menu"\n\t\t\t\t\t\t\t@click="onClickHeaderMenu"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="bx-im-content-notification__elements-container">\n\t\t\t\t<div\n\t\t\t\t\tclass="bx-im-content-notification__elements"\n\t\t\t\t\t@scroll.passive="onScroll"\n\t\t\t\t\tref="listNotifications"\n\t\t\t\t\t:style="getNotificationsBackgroundStyle()"\n\t\t\t\t>\n\t\t\t\t\t<div v-if="hasConfirmNotifications" class="bx-im-content-notification__elements-group">\n\t\t\t\t\t\t <div class="bx-im-content-notification__elements-title">\n\t\t\t\t\t\t\t {{ $Bitrix.Loc.getMessage('IM_NOTIFICATIONS_GROUP_TITLE') }}\n\t\t\t\t\t\t\t <div\n\t\t\t\t\t\t\t\t class="bx-im-content-notification__elements-group-counter"\n\t\t\t\t\t\t\t >\n\t\t\t\t\t\t\t\t {{ formattedCounter }}\n\t\t\t\t\t\t\t </div>\n\t\t\t\t\t\t </div>\n\t\t\t\t\t\t<TransitionGroup \n\t\t\t\t\t\t\tname="notification-confirm-item"\n\t\t\t\t\t\t\ttag="div" \n\t\t\t\t\t\t\t@leave="onLeave"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t\tv-for="notification in confirmNotifications"\n\t\t\t\t\t\t\t\t:is="getComponentForItem(notification)"\n\t\t\t\t\t\t\t\t:key="notification.id"\n\t\t\t\t\t\t\t\t:data-id="notification.id"\n\t\t\t\t\t\t\t\t:notification="notification"\n\t\t\t\t\t\t\t\t@confirmButtonsClick="onConfirmButtonsClick"\n\t\t\t\t\t\t\t\t@deleteClick="onDeleteClick"\n\t\t\t\t\t\t\t\t@moreUsersClick="onMoreUsersClick"\n\t\t\t\t\t\t\t\t@sendQuickAnswer="onSendQuickAnswer"\n\t\t\t\t\t\t\t\tv-notifications-item-observer\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</TransitionGroup>\n\t\t\t\t\t</div>\n\t\t\t\t\t<TransitionGroup \n\t\t\t\t\t\tname="notification-simple-item"\n\t\t\t\t\t\ttag="div"\n\t\t\t\t\t\t@leave="onLeave"\n\t\t\t\t\t>\n\t\t\t\t\t\t<component\n\t\t\t\t\t\t\tv-for="notification in simpleNotifications"\n\t\t\t\t\t\t\t:is="getComponentForItem(notification)"\n\t\t\t\t\t\t\t:key="notification.id"\n\t\t\t\t\t\t\t:data-id="notification.id"\n\t\t\t\t\t\t\t:notification="notification"\n\t\t\t\t\t\t\t@confirmButtonsClick="onConfirmButtonsClick"\n\t\t\t\t\t\t\t@deleteClick="onDeleteClick"\n\t\t\t\t\t\t\t@moreUsersClick="onMoreUsersClick"\n\t\t\t\t\t\t\t@sendQuickAnswer="onSendQuickAnswer"\n\t\t\t\t\t\t\t@dblclick="onDoubleClick(notification.id)"\n\t\t\t\t\t\t\tv-notifications-item-observer\n\t\t\t\t\t\t/>\n\t\t\t\t\t</TransitionGroup>\n\t\t\t\t\t<div v-if="isEmptyState" class="bx-im-content-notification__empty-state-container">\n\t\t\t\t\t\t<div :class="emptyStateIcon"></div>\n\t\t\t\t\t\t<span class="bx-im-content-notification__empty-state-title">\n\t\t\t\t\t\t\t{{ emptyStateTitle }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ItemPlaceholder v-if="isInitialLoading" />\n\t\t\t\t\t<div v-if="isNextPageLoading" class="bx-im-content-notification__loader-container">\n\t\t\t\t\t\t<Loader />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<ScrollButton\n\t\t\t\t\tv-if="!isInitialLoading || !isNextPageLoading"\n\t\t\t\t\t:unreadCounter="unreadCounter"\n\t\t\t\t\t:notificationsOnScreen="notificationsOnScreen"\n\t\t\t\t\t@scrollButtonClick="onScrollButtonClick"\n\t\t\t\t/>\n\t\t\t\t<UserListPopup\n\t\t\t\t\tv-if="showUserListPopup"\n\t\t\t\t\t:userIds="userListIds"\n\t\t\t\t\t:bindElement="popupBindElement"\n\t\t\t\t\t:showPopup="showUserListPopup"\n\t\t\t\t\t@close="showUserListPopup = false"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`};t.NotificationContent=le})(this.BX.Messenger.v2.Component.Content=this.BX.Messenger.v2.Component.Content||{},BX,BX.Messenger.v2.Service,BX.Messenger.v2.Component.Elements,BX.Messenger.v2.Component.Elements,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.Messenger.v2.Service,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.Messenger.v2.Component.Elements,BX.Messenger.v2.Lib,BX.Messenger.v2.Component.Elements,BX.Ui,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.Messenger.v2.Component.Elements,BX.Vue3.Vuex,BX.UI.System.Chip.Vue,BX.Messenger.v2.Component.Elements,BX.Vue3.Components,BX.UI.IconSet,BX.UI.EntitySelector,BX.Event,BX.Main,BX.UI.System,BX.UI.DatePicker,BX.UI.System.Input.Vue,BX.UI.IconSet,BX.Messenger.v2.Css,BX,BX.Messenger.v2.Application,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.Messenger.v2.Const);
//# sourceMappingURL=notification-content.bundle.map.js