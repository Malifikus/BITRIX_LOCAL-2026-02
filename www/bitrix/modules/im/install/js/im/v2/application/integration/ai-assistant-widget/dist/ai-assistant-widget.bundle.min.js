this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};(function(t,e,i,s,n,a,o,r,d,h,c,l){"use strict";const g="IM.AiAssistantWidget:minimize";const p={name:"AiAssistantWidgetChatHeader",components:{ChatHeader:c.ChatHeader,BIcon:d.BIcon},props:{dialogId:{type:String,default:""}},computed:{OutlineIcons:()=>d.Outline,Color:()=>l.Color},methods:{onMinimize(){h.EventEmitter.emit(g)},loc(t){return this.$Bitrix.Loc.getMessage(t)}},template:`\n\t\t<ChatHeader\n\t\t\t:dialogId="dialogId"\n\t\t\t:withCallButton="false"\n\t\t\t:withSearchButton="false"\n\t\t\t:withAddToChatButton="false"\n\t\t>\n\t\t\t<template #before-actions>\n\t\t\t\t<BIcon\n\t\t\t\t\t:name="OutlineIcons.CROSS_L"\n\t\t\t\t\t:hoverable="true"\n\t\t\t\t\t:color="Color.base4"\n\t\t\t\t\t:title="loc('IM_AI_ASSISTANT_WIDGET_MINIMIZE')"\n\t\t\t\t\tclass="bx-im-ai-assistant-chat-header__icon"\n\t\t\t\t\t@click="onMinimize"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</ChatHeader>\n\t`};const A={name:"AiAssistantWidgetChatContent",components:{AiAssistantWidgetChatHeader:p,AiAssistantBotContent:o.AiAssistantBotContent},props:{dialogId:{type:String,default:""},withSidebar:{type:Boolean,default:true}},created(){h.EventEmitter.subscribe(l.EventType.notifier.onBeforeShowMessage,this.onBeforeNotificationShow)},beforeUnmount(){h.EventEmitter.unsubscribe(l.EventType.notifier.onBeforeShowMessage,this.onBeforeNotificationShow)},methods:{onBeforeNotificationShow(t){const e=t.getData();if(e.dialogId!==this.dialogId){return r.NotifierShowMessageAction.show}return r.NotifierShowMessageAction.skip}},template:`\n\t\t<AiAssistantBotContent :dialogId="dialogId" :withSidebar="withSidebar">\n\t\t\t<template #header>\n\t\t\t\t<AiAssistantWidgetChatHeader :dialogId="dialogId"/>\n\t\t\t</template>\n\t\t</AiAssistantBotContent>\n\t`};const C={name:"AiAssistantWidgetChatOpener",components:{AiAssistantWidgetChatContent:A},props:{dialogId:{type:String,required:true}},computed:{dialog(){return this.$store.getters["chats/get"](this.dialogId,true)},chatId(){return this.dialog.chatId}},created(){return this.onChatOpen()},methods:{async onChatOpen(){if(this.dialog.inited){n.Logger.warn(`AiAssistantChatOpener: chat ${this.chatId} is already loaded`);return}await this.loadChat();s.Analytics.getInstance().aiAssistant.onOpenWidget(this.dialog);s.Analytics.getInstance().aiAssistant.onOpenChatAI(this.dialog,true)},async loadChat(){n.Logger.warn(`AiAssistantChatOpener: loading chat ${this.chatId}`);await this.getChatService().loadChatWithMessages(this.dialogId);n.Logger.warn(`AiAssistantChatOpener: chat ${this.chatId} is loaded`)},getChatService(){if(!this.chatService){this.chatSerivce=new a.ChatService}return this.chatSerivce}},template:`\n\t\t<div class="bx-im-messenger__scope bx-im-ai-assistant-chat-opener__container --ui-context-content-light">\n\t\t\t<AiAssistantWidgetChatContent :dialogId="dialogId" :withSidebar="false"/>\n\t\t</div>\n\t`};const u="AiAssistantWidgetApplication";var m=babelHelpers.classPrivateFieldLooseKey("initPromise");var v=babelHelpers.classPrivateFieldLooseKey("init");class B{constructor(){Object.defineProperty(this,v,{value:I});Object.defineProperty(this,m,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,m)[m]=babelHelpers.classPrivateFieldLooseBase(this,v)[v]()}ready(){return babelHelpers.classPrivateFieldLooseBase(this,m)[m]}async mount(t){await this.ready();const{rootContainer:i,aiAssistantBotId:s,onError:n}=t;if(!i){return Promise.reject(new Error("Provide node or selector for root container"))}const a=s.toString();return e.Core.createVue(this,{name:u,el:i,onError:n,components:{AiAssistantWidgetChatOpener:C},template:`<AiAssistantWidgetChatOpener dialogId="${a}" />`})}}async function I(){await e.Core.ready();return this}t.AiAssistantWidgetApplication=B})(this.BX.Messenger.v2.Application=this.BX.Messenger.v2.Application||{},BX.Messenger.v2.Application,BX.Messenger.v2.Css,BX.Messenger.v2.Lib,BX.Messenger.v2.Lib,BX.Messenger.v2.Service,BX.Messenger.v2.Component.Content,BX.Messenger.v2.Lib,BX.UI.IconSet,BX.Event,BX.Messenger.v2.Component.Content,BX.Messenger.v2.Const);
//# sourceMappingURL=ai-assistant-widget.bundle.map.js