this.BX=this.BX||{};this.BX.Messenger=this.BX.Messenger||{};this.BX.Messenger.v2=this.BX.Messenger.v2||{};(function(e,s,a,t,r,l,i){"use strict";var o=babelHelpers.classPrivateFieldLooseKey("chatId");var n=babelHelpers.classPrivateFieldLooseKey("restClient");var d=babelHelpers.classPrivateFieldLooseKey("onCalendarEntrySaveHandler");var c=babelHelpers.classPrivateFieldLooseKey("createMeeting");var b=babelHelpers.classPrivateFieldLooseKey("createTask");var v=babelHelpers.classPrivateFieldLooseKey("requestPreparedParams");var p=babelHelpers.classPrivateFieldLooseKey("openTaskSlider");var h=babelHelpers.classPrivateFieldLooseKey("openTaskV2Card");var u=babelHelpers.classPrivateFieldLooseKey("openPrefilledTaskV2Card");var P=babelHelpers.classPrivateFieldLooseKey("openCalendarSlider");var B=babelHelpers.classPrivateFieldLooseKey("onCalendarEntrySave");class F{constructor(e){Object.defineProperty(this,B,{value:g});Object.defineProperty(this,P,{value:M});Object.defineProperty(this,u,{value:I});Object.defineProperty(this,h,{value:C});Object.defineProperty(this,p,{value:f});Object.defineProperty(this,v,{value:H});Object.defineProperty(this,b,{value:y});Object.defineProperty(this,c,{value:L});Object.defineProperty(this,o,{writable:true,value:0});Object.defineProperty(this,n,{writable:true,value:void 0});Object.defineProperty(this,d,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,n)[n]=l.Core.getRestClient();babelHelpers.classPrivateFieldLooseBase(this,o)[o]=e}openTaskCreationForm(){babelHelpers.classPrivateFieldLooseBase(this,h)[h]()}createTaskForChat(){return babelHelpers.classPrivateFieldLooseBase(this,b)[b]()}createTaskForMessage(e){return babelHelpers.classPrivateFieldLooseBase(this,b)[b](e)}createMeetingForChat(){return babelHelpers.classPrivateFieldLooseBase(this,c)[c]()}createMeetingForMessage(e){return babelHelpers.classPrivateFieldLooseBase(this,c)[c](e)}}function L(e){const s={CHAT_ID:babelHelpers.classPrivateFieldLooseBase(this,o)[o]};if(e){s.MESSAGE_ID=e}return babelHelpers.classPrivateFieldLooseBase(this,v)[v](i.RestMethod.imChatCalendarPrepare,s).then((s=>{const{params:t}=s;const r="BX.Calendar:onEntrySave";babelHelpers.classPrivateFieldLooseBase(this,d)[d]=babelHelpers.classPrivateFieldLooseBase(this,B)[B].bind(this,t.sliderId,e);a.EventEmitter.subscribeOnce(r,babelHelpers.classPrivateFieldLooseBase(this,d)[d]);return babelHelpers.classPrivateFieldLooseBase(this,P)[P](t)}))}function y(e){const s={data:{chatId:babelHelpers.classPrivateFieldLooseBase(this,o)[o]}};if(e){s.data.messageId=e}return r.runAction(i.RestMethod.imV2ChatTaskPrepare,s).then((e=>{const{link:s,params:a}=e;return a.is_tasks_v2?babelHelpers.classPrivateFieldLooseBase(this,u)[u](a):babelHelpers.classPrivateFieldLooseBase(this,p)[p](s,a)}))}function H(e,s){return babelHelpers.classPrivateFieldLooseBase(this,n)[n].callMethod(e,s).then((e=>e.data())).catch((e=>{console.error(e)}))}function f(e,s){BX.SidePanel.Instance.open(e,{requestMethod:"post",requestParams:s,cacheable:false})}async function C(e={}){const{TaskCard:a}=await s.Runtime.loadExtension("tasks.v2.application.task-card");a.showCompactCard(e)}function I(e){var s,a,t,r;const l=(s=e.entityId)!=null?s:null;const i=(a=e.subEntityId)!=null?a:null;const o=e.auditors?e.auditors.split(",").map((e=>parseInt(e.trim(),10))):[];const n={groupId:(t=e.groupId)!=null?t:null,description:(r=e.description)!=null?r:null,auditorsIds:o,fileIds:e.UF_TASK_WEBDAV_FILES,analytics:{context:e.ta_sec,element:e.ta_el},source:{type:"chat",entityId:l,subEntityId:i}};void babelHelpers.classPrivateFieldLooseBase(this,h)[h](n)}function M(e){new(window.top.BX||window.BX).Calendar.SliderLoader(0,e).show()}function g(e,s,a){const t=a.getData();if(t.sliderId!==e){return}const r={CALENDAR_ID:t.responseData.entryId,CHAT_ID:babelHelpers.classPrivateFieldLooseBase(this,o)[o]};if(s){r.MESSAGE_ID=s}return babelHelpers.classPrivateFieldLooseBase(this,n)[n].callMethod(i.RestMethod.imChatCalendarAdd,r).catch((e=>{console.error(e)}))}e.EntityCreator=F})(this.BX.Messenger.v2.Lib=this.BX.Messenger.v2.Lib||{},BX,BX.Event,BX.Calendar,BX.Messenger.v2.Lib,BX.Messenger.v2.Application,BX.Messenger.v2.Const);
//# sourceMappingURL=entity-creator.bundle.map.js