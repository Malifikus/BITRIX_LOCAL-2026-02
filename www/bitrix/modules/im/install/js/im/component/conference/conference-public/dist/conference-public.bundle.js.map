{"version":3,"file":"conference-public.bundle.js","sources":["../src/event-handler/conference-textarea-handler.js","../src/event-handler/conference-textarea-upload-handler.js","../src/component/conference-smiles.js","../src/component/mic-level.js","../src/component/check-devices.js","../src/component/error.js","../src/component/orientation-disabled.js","../src/component/password-check.js","../src/component/loading-status.js","../src/component/request-permissions.js","../src/component/mobile-chat-button.js","../src/component/conference-info.js","../src/component/user-form.js","../src/component/chat-header.js","../src/component/waiting-for-start.js","../src/component/user-list/user-list-item.js","../src/component/user-list/user-list.js","../src/component/user-list/user-list-header.js","../src/conference-public.js"],"sourcesContent":["import { TextareaHandler } from \"im.event-handler\";\n\nexport class ConferenceTextareaHandler extends TextareaHandler\n{\n\tapplication: Object = null;\n\n\tconstructor($Bitrix)\n\t{\n\t\tsuper($Bitrix);\n\t\tthis.application = $Bitrix.Application.get();\n\t}\n\n\tonAppButtonClick({data: event})\n\t{\n\t\tif (event.appId === 'smile')\n\t\t{\n\t\t\tthis.application.toggleSmiles();\n\t\t}\n\t}\n}","import { TextareaUploadHandler } from 'im.event-handler';\nimport { Logger } from 'im.lib.logger';\n\nexport class ConferenceTextareaUploadHandler extends TextareaUploadHandler\n{\n\taddMessageWithFile(event)\n\t{\n\t\tconst message = event.getData();\n\n\t\tif (!this.getDiskFolderId())\n\t\t{\n\t\t\tthis.requestDiskFolderId(message.chatId).then(() => {\n\t\t\t\tthis.addMessageWithFile(event);\n\t\t\t}).catch(error => {\n\t\t\t\tLogger.error('addMessageWithFile error', error);\n\t\t\t\treturn false;\n\t\t\t});\n\n\t\t\treturn false;\n\t\t}\n\n\t\tmessage.chatId = this.getChatId();\n\n\t\tthis.setUploaderCustomHeaders();\n\n\t\tthis.uploader.addTask({\n\t\t\ttaskId: message.file.id,\n\t\t\tfileData: message.file.source.file,\n\t\t\tfileName: message.file.source.file.name,\n\t\t\tgenerateUniqueName: true,\n\t\t\tdiskFolderId: this.getDiskFolderId(),\n\t\t\tpreviewBlob: message.file.previewBlob,\n\t\t});\n\t}\n\n\tsetUploaderCustomHeaders()\n\t{\n\t\tif (!this.uploader.senderOptions.customHeaders)\n\t\t{\n\t\t\tthis.uploader.senderOptions.customHeaders = {};\n\t\t}\n\t\tthis.uploader.senderOptions.customHeaders['Call-Auth-Id'] = this.getUserHash();\n\t\tthis.uploader.senderOptions.customHeaders['Call-Chat-Id'] = this.getChatId();\n\t}\n\n\tgetUserHash(): string\n\t{\n\t\treturn this.controller.store.state.conference.user.hash;\n\t}\n\n\tgetActionCommitFile(): ?string\n\t{\n\t\treturn 'im.call.disk.commit';\n\t}\n\n\tgetActionUploadChunk(): ?string\n\t{\n\t\treturn 'im.call.disk.upload';\n\t}\n}","import 'ui.vue.components.smiles';\nimport { EventEmitter } from 'main.core.events';\nimport { EventType } from \"im.const\";\n\nconst ConferenceSmiles = {\n\tmethods:\n\t{\n\t\tonSelectSmile(event)\n\t\t{\n\t\t\tthis.$emit('selectSmile', event);\n\t\t},\n\t\tonSelectSet(event)\n\t\t{\n\t\t\tthis.$emit('selectSet', event);\n\t\t},\n\t\thideSmiles()\n\t\t{\n\t\t\tEventEmitter.emit(EventType.conference.hideSmiles);\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-im-component-smiles-box\">\n\t\t\t<div class=\"bx-im-component-smiles-box-close\" @click=\"hideSmiles\"></div>\n\t\t\t<div class=\"bx-im-component-smiles-box-list\">\n\t\t\t\t<bx-smiles\n\t\t\t\t\t@selectSmile=\"onSelectSmile\"\n\t\t\t\t\t@selectSet=\"onSelectSet\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n\nexport {ConferenceSmiles};","import { BitrixVue } from \"ui.vue\";\nimport { Type } from \"main.core\";\n\nconst MicLevel = {\n\tprops: ['localStream'],\n\tdata()\n\t{\n\t\treturn {\n\t\t\tbars: [],\n\t\t\tbarDisabledColor: 'rgba(255,255,255,0.42)',\n\t\t\tbarEnabledColor: '#1CAE6A'\n\t\t}\n\t},\n\twatch:\n\t{\n\t\tlocalStream(stream)\n\t\t{\n\t\t\tif (!Type.isNil(stream))\n\t\t\t{\n\t\t\t\tthis.startAudioCheck();\n\t\t\t}\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.bars = [...document.querySelectorAll('.bx-im-component-call-check-devices-micro-level-item')];\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_CHECK_DEVICES_');\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tstartAudioCheck()\n\t\t{\n\t\t\tthis.audioContext = new (window.AudioContext || window.webkitAudioContext)();\n\t\t\tthis.analyser = this.audioContext.createAnalyser();\n\t\t\tthis.microphone = this.audioContext.createMediaStreamSource(this.localStream);\n\t\t\tthis.scriptNode = this.audioContext.createScriptProcessor(2048, 1, 1);\n\n\t\t\tthis.analyser.smoothingTimeConstant = 0.8;\n\t\t\tthis.analyser.fftSize = 1024;\n\n\t\t\tthis.microphone.connect(this.analyser);\n\t\t\tthis.analyser.connect(this.scriptNode);\n\t\t\tthis.scriptNode.connect(this.audioContext.destination);\n\t\t\tthis.scriptNode.onaudioprocess = this.processVolume;\n\t\t},\n\t\tprocessVolume()\n\t\t{\n\t\t\tlet arr = new Uint8Array(this.analyser.frequencyBinCount);\n\t\t\tthis.analyser.getByteFrequencyData(arr);\n\t\t\tlet values = 0;\n\n\t\t\tfor (let i = 0; i < arr.length; i++)\n\t\t\t{\n\t\t\t\tvalues += arr[i];\n\t\t\t}\n\t\t\tlet average = values / arr.length;\n\n\t\t\tlet oneBarValue = 100 / this.bars.length;\n\t\t\tlet barsToColor = Math.round(average / oneBarValue);\n\t\t\tlet elementsToColor = this.bars.slice(0, barsToColor);\n\t\t\tthis.bars.forEach(elem => {\n\t\t\t\telem.style.backgroundColor = this.barDisabledColor;\n\t\t\t});\n\t\t\telementsToColor.forEach(elem => {\n\t\t\t\telem.style.backgroundColor = this.barEnabledColor;\n\t\t\t});\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-check-devices-row\">\n\t\t\t<div class=\"bx-im-component-call-check-devices-micro-icon\"></div>\n\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level\">\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-micro-level-item\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n\nexport {MicLevel};","import {BitrixVue} from \"ui.vue\";\nimport {MicLevel} from './mic-level';\nimport {Type} from \"main.core\";\nimport {Logger} from \"im.lib.logger\";\nimport {Utils} from \"im.lib.utils\";\nimport { MessageBox, MessageBoxButtons } from \"ui.dialogs.messagebox\";\n\nimport 'ui.forms';\n\nconst CheckDevices = {\n\tdata()\n\t{\n\t\treturn {\n\t\t\tisDestroyed: false,\n\t\t\tnoVideo: true,\n\t\t\tselectedCamera: null,\n\t\t\tselectedMic: null,\n\t\t\tvideoStream: null,\n\t\t\taudioStream: null,\n\t\t\tvideoStreamPromise: null,\n\t\t\taudioStreamPromise: null,\n\t\t\tshowMic: true,\n\t\t\tuserDisabledCamera: false,\n\t\t\tgettingVideo: false,\n\t\t\tisFlippedVideo: BX.Call.Hardware.enableMirroring,\n\t\t};\n\t},\n\tcreated()\n\t{\n\t\tthis.$root.$on('setCameraState', (state) => {this.onCameraStateChange(state)});\n\t\tthis.$root.$on('setMicState', (state) => {this.onMicStateChange(state)});\n\t\tthis.$root.$on('callLocalMediaReceived', () => { this.stopLocalVideo(); this.stopLocalAudio(); });\n\t\tthis.$root.$on('cameraSelected', (cameraId) => {this.onCameraSelected(cameraId)});\n\t\tthis.$root.$on('micSelected', (micId) => {this.onMicSelected(micId)});\n\n\t\tthis.getApplication().initHardware().then(() => {\n\t\t\tthis.getDefaultDevices();\n\t\t}).catch(() => {\n\t\t\tMessageBox.show({\n\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_HARDWARE_ERROR'),\n\t\t\t\tmodal: true,\n\t\t\t\tbuttons: MessageBoxButtons.OK\n\t\t\t});\n\t\t});\n\t},\n\tdestroyed()\n\t{\n\t\tthis.isDestroyed = true;\n\t\tthis.stopLocalVideo();\n\t\tthis.stopLocalAudio();\n\t},\n\tcomputed:\n\t{\n\t\tnoVideoText()\n\t\t{\n\t\t\tif (this.gettingVideo)\n\t\t\t{\n\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_CHECK_DEVICES_GETTING_CAMERA'];\n\t\t\t}\n\n\t\t\tif (this.userDisabledCamera)\n\t\t\t{\n\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_CHECK_DEVICES_DISABLED_CAMERA'];\n\t\t\t}\n\n\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_CHECK_DEVICES_NO_VIDEO'];\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_CHECK_DEVICES_');\n\t\t},\n\t\tcameraVideoClasses()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'bx-im-component-call-check-devices-camera-video' : true,\n\t\t\t\t'bx-im-component-call-check-devices-camera-video-flipped' : this.isFlippedVideo\n\t\t\t};\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tgetDefaultDevices()\n\t\t{\n\t\t\tif (BX.Call.Hardware.defaultCamera)\n\t\t\t{\n\t\t\t\tthis.selectedCamera = BX.Call.Hardware.defaultCamera;\n\t\t\t}\n\n\t\t\tif (BX.Call.Hardware.defaultMicrophone)\n\t\t\t{\n\t\t\t\tthis.selectedMic = BX.Call.Hardware.defaultMicrophone;\n\t\t\t}\n\n\t\t\tthis.getLocalVideoStream().then(() => {\n\t\t\t\tthis.getApplication().updateMediaDevices();\n\t\t\t\tif (!this.selectedCamera)\n\t\t\t\t{\n\t\t\t\t\tthis.selectedCamera = this.videoStream.getVideoTracks()[0].getSettings().deviceId;\n\t\t\t\t}\n\t\t\t\tthis.getApplication().setSelectedCamera(this.selectedCamera);\n\t\t\t}).catch((error) => {\n\t\t\t\tLogger.warn('Error getting default video stream', error);\n\t\t\t});\n\n\t\t\tthis.getLocalAudioStream().then(() => {\n\t\t\t\tif (!this.selectedMic)\n\t\t\t\t{\n\t\t\t\t\tthis.selectedMic = this.audioStream.getAudioTracks()[0].getSettings().deviceId;\n\t\t\t\t}\n\t\t\t\tthis.getApplication().setSelectedMic(this.selectedMic);\n\t\t\t}).catch((error) => {\n\t\t\t\tLogger.warn('Error getting default audio stream', error);\n\t\t\t});\n\t\t},\n\t\tgetLocalVideoStream()\n\t\t{\n\t\t\tif (this.videoStreamPromise)\n\t\t\t{\n\t\t\t\treturn this.videoStreamPromise;\n\t\t\t}\n\n\t\t\tthis.videoStreamPromise = new Promise((resolve, reject) => {\n\t\t\t\tthis.gettingVideo = true;\n\n\t\t\t\tconst constraints = {\n\t\t\t\t\tvideo: this.getVideoConstraints(),\n\t\t\t\t\taudio: false,\n\t\t\t\t};\n\n\t\t\t\tnavigator.mediaDevices.getUserMedia(constraints).then((stream) => {\n\t\t\t\t\tthis.setLocalStream(stream);\n\t\t\t\t\tthis.playLocalVideo();\n\n\t\t\t\t\tif (this.isDestroyed)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.stopLocalVideo();\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve();\n\t\t\t\t}).catch((error) => {\n\t\t\t\t\tLogger.warn('Getting video from camera error', error);\n\t\t\t\t\tthis.noVideo = true;\n\t\t\t\t\tthis.getApplication().setCameraState(false);\n\t\t\t\t\treject(error);\n\t\t\t\t}).finally(() => {\n\t\t\t\t\tthis.gettingVideo = false;\n\t\t\t\t\tthis.videoStreamPromise = null;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn this.videoStreamPromise;\n\t\t},\n\t\tgetLocalAudioStream()\n\t\t{\n\t\t\tif (this.audioStreamPromise)\n\t\t\t{\n\t\t\t\treturn this.audioStreamPromise;\n\t\t\t}\n\n\t\t\tthis.audioStreamPromise = new Promise((resolve, reject) => {\n\t\t\t\tconst constraints = {\n\t\t\t\t\taudio: { deviceId: { exact: this.selectedMic } },\n\t\t\t\t\tvideo: false,\n\t\t\t\t};\n\n\t\t\t\tnavigator.mediaDevices.getUserMedia(constraints).then((stream) => {\n\t\t\t\t\tthis.audioStream = stream;\n\n\t\t\t\t\tif (this.isDestroyed)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.stopLocalAudio();\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve();\n\t\t\t\t}).catch((error) => {\n\t\t\t\t\tLogger.warn('Getting audio from microphone error', error);\n\t\t\t\t\treject(error);\n\t\t\t\t}).finally(() => {\n\t\t\t\t\tthis.audioStreamPromise = null;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn this.audioStreamPromise;\n\t\t},\n\t\tsetLocalStream(stream)\n\t\t{\n\t\t\tthis.videoStream = stream;\n\t\t\tthis.getApplication().setLocalVideoStream(this.videoStream);\n\t\t},\n\t\tplayLocalVideo()\n\t\t{\n\t\t\tLogger.warn('playing local video');\n\t\t\tthis.noVideo = false;\n\t\t\tthis.userDisabledCamera = false;\n\t\t\tthis.getApplication().setCameraState(true);\n\t\t\tthis.$refs.video.volume = 0;\n\t\t\tthis.$refs.video.srcObject = this.videoStream;\n\t\t\tthis.$refs.video.play();\n\t\t},\n\t\tstopLocalVideo()\n\t\t{\n\t\t\tif (!this.videoStream)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.videoStream.getTracks().forEach((track) => track.stop());\n\t\t\tthis.videoStream = null;\n\t\t\tthis.getApplication().stopLocalVideoStream();\n\t\t},\n\t\tstopLocalAudio()\n\t\t{\n\t\t\tif (!this.audioStream)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.audioStream.getTracks().forEach((track) => track.stop());\n\t\t\tthis.audioStream = null;\n\t\t},\n\t\tonCameraSelected(cameraId)\n\t\t{\n\t\t\tthis.stopLocalVideo();\n\t\t\tthis.selectedCamera = cameraId;\n\t\t\tthis.getLocalVideoStream();\n\t\t},\n\t\tonMicSelected(micId)\n\t\t{\n\t\t\t/*this.stopLocalVideo();\n\t\t\tthis.selectedMic = micId;\n\t\t\tthis.getLocalStream();*/\n\t\t},\n\t\tonCameraStateChange(state)\n\t\t{\n\t\t\tif (state)\n\t\t\t{\n\t\t\t\tthis.noVideo = false;\n\t\t\t\tthis.getLocalVideoStream();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.stopLocalVideo();\n\t\t\t\tthis.userDisabledCamera = true;\n\t\t\t\tthis.noVideo = true;\n\t\t\t\tthis.getApplication().setCameraState(false);\n\t\t\t}\n\t\t},\n\t\tonMicStateChange(state)\n\t\t{\n\t\t\tif (state)\n\t\t\t{\n\t\t\t\tthis.getLocalAudioStream();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.stopLocalAudio();\n\t\t\t}\n\n\t\t\tthis.showMic = state;\n\t\t},\n\t\tisMobile()\n\t\t{\n\t\t\treturn Utils.device.isMobile();\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t},\n\t\tgetVideoConstraints()\n\t\t{\n\t\t\tconst videoConstraints = {};\n\n\t\t\tif (this.selectedCamera)\n\t\t\t{\n\t\t\t\tvideoConstraints.deviceId = { exact: this.selectedCamera };\n\t\t\t}\n\n\t\t\tif (!Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tvideoConstraints.width = { ideal: 1280 };\n\t\t\t\tvideoConstraints.height = { ideal: 720 };\n\t\t\t}\n\n\t\t\treturn videoConstraints;\n\t\t},\n\t},\n\tcomponents:\n\t\t{ MicLevel },\n\ttemplate: `\n\t<div class=\"bx-im-component-call-device-check-container\">\n\t\t<div class=\"bx-im-component-call-check-devices\">\n\t\t\t<div v-show=\"noVideo\">\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-camera-no-video\">\n\t\t\t\t\t<div class=\"bx-im-component-call-check-devices-camera-no-video-icon\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-check-devices-camera-no-video-text\">{{ noVideoText }}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-show=\"!noVideo\">\n\t\t\t\t<div class=\"bx-im-component-call-check-devices-camera-video-container\">\n\t\t\t\t\t<video :class=\"cameraVideoClasses\" ref=\"video\" muted autoplay playsinline></video>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<template v-if=\"!isMobile()\">\n\t\t\t\t<mic-level v-show=\"showMic\" :localStream=\"audioStream\"/>\n\t\t\t</template>\n\t\t</div>\n\t</div>\n\t`\n};\n\nexport {CheckDevices};\n","import { BitrixVue } from \"ui.vue\";\nimport { ConferenceErrorCode } from \"call.const\";\nimport { Cookie } from 'im.lib.cookie';\nimport { Utils } from \"im.lib.utils\";\nimport { Vuex } from \"ui.vue.vuex\";\nimport { State as CallState } from 'call.core';\n\nimport 'call.component.call-feedback';\n\nconst Error = {\n\tdata()\n\t{\n\t\treturn {\n\t\t\tdownloadAppArticleCode: 11387752,\n\t\t\tcallFeedbackSent: false\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\terrorCode()\n\t\t{\n\t\t\treturn this.conference.common.error;\n\t\t},\n\t\tbitrix24only()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.bitrix24only;\n\t\t},\n\t\tdetectIntranetUser()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.detectIntranetUser;\n\t\t},\n\t\tuserLimitReached()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.userLimitReached;\n\t\t},\n\t\tkickedFromCall()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.kickedFromCall;\n\t\t},\n\t\twrongAlias()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.wrongAlias;\n\t\t},\n\t\tconferenceFinished()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.finished;\n\t\t},\n\t\tunsupportedBrowser()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.unsupportedBrowser;\n\t\t},\n\t\tmissingMicrophone()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.missingMicrophone;\n\t\t},\n\t\tunsafeConnection()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.unsafeConnection;\n\t\t},\n\t\tnoSignalFromCamera()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.noSignalFromCamera;\n\t\t},\n\t\tuserLeftCall()\n\t\t{\n\t\t\treturn this.errorCode === ConferenceErrorCode.userLeftCall;\n\t\t},\n\t\tshowFeedback()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get().showFeedback;\n\t\t},\n\t\tcallDetails()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get().callDetails;\n\t\t},\n\t\tisExternalUser()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get().isExternalUser();\n\t\t},\n\t\tisFinishedByOrganizer()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get().currentCall?.state === CallState.Finished;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tconference: state => state.conference\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\treloadPage()\n\t\t{\n\t\t\tlocation.reload();\n\t\t},\n\t\tredirectToAuthorize()\n\t\t{\n\t\t\tlocation.href = location.origin + '/auth/?backurl=' + location.pathname;\n\t\t},\n\t\tcontinueAsGuest()\n\t\t{\n\t\t\tCookie.set(null, `VIDEOCONF_GUEST_${this.conference.common.alias}`, '', {path: '/'});\n\t\t\tlocation.reload(true);\n\t\t},\n\t\tgetBxLink()\n\t\t{\n\t\t\treturn `bx://videoconf/code/${this.$Bitrix.Application.get().getAlias()}`;\n\t\t},\n\t\topenHelpArticle()\n\t\t{\n\t\t\tif (BX.Helper)\n\t\t\t{\n\t\t\t\tBX.Helper.show(\"redirect=detail&code=\" + this.downloadAppArticleCode);\n\t\t\t}\n\t\t},\n\t\tisMobile()\n\t\t{\n\t\t\treturn Utils.device.isMobile();\n\t\t},\n\t\tonFeedbackSent()\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.callFeedbackSent = true;\n\t\t\t}, 1500);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-error-wrap\">\n\t\t\t<template v-if=\"bitrix24only\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-icon bx-im-component-call-error-icon-b24only\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_MESSAGE_B24_ONLY'] }}</div>\n\t\t\t\t\t\t<template v-if=\"!isMobile()\">\n\t\t\t\t\t\t\t<a @click.prevent=\"openHelpArticle\" class=\"bx-im-component-call-error-more-link\">{{ localize['BX_IM_COMPONENT_CALL_BUTTON_CREATE_OWN'] }}</a>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"detectIntranetUser\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-icon bx-im-component-call-error-icon-intranet\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_MESSAGE_PLEASE_LOG_IN'] }}</div>\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-buttons\">\n\t\t\t\t\t\t\t<button @click=\"redirectToAuthorize\" class=\"bx-im-component-call-error-button-authorize\">{{ this.localize['BX_IM_COMPONENT_CALL_BUTTON_AUTHORIZE'] }}</button>\n\t\t\t\t\t\t\t<button @click=\"continueAsGuest\" class=\"bx-im-component-call-error-button-as-guest\">{{ this.localize['BX_IM_COMPONENT_CALL_BUTTON_AS_GUEST'] }}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"userLimitReached\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-icon bx-im-component-call-error-icon-full\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_MESSAGE_USER_LIMIT'] }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"kickedFromCall\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-icon bx-im-component-call-error-icon-kicked\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_MESSAGE_KICKED'] }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"wrongAlias || conferenceFinished\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-icon bx-im-component-call-error-icon-finished\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_FINISHED'] }}</div>\n\t\t\t\t\t\t<template v-if=\"!isMobile()\">\n\t\t\t\t\t\t\t<a @click.prevent=\"openHelpArticle\" class=\"bx-im-component-call-error-more-link\">{{ localize['BX_IM_COMPONENT_CALL_BUTTON_CREATE_OWN'] }}</a>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"unsupportedBrowser\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-icon bx-im-component-call-error-icon-browser\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_UNSUPPORTED_BROWSER'] }}</div>\n\t\t\t\t\t\t<template v-if=\"!isMobile()\">\n\t\t\t\t\t\t\t<a @click.prevent=\"openHelpArticle\" class=\"bx-im-component-call-error-more-link\">{{ localize['BX_IM_COMPONENT_CALL_BUTTON_DETAILS'] }}</a>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"missingMicrophone\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_NO_MIC'] }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"unsafeConnection\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-icon bx-im-component-call-error-icon-https\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_NO_HTTPS'] }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"noSignalFromCamera\">\n\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_NO_SIGNAL_FROM_CAMERA'] }}</div>\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-buttons\">\n\t\t\t\t\t\t\t<button @click=\"reloadPage\" class=\"bx-im-component-call-error-button-reload\">{{ localize['BX_IM_COMPONENT_CALL_BUTTON_RELOAD'] }}</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"userLeftCall\">\n\t\t\t\t<template v-if=\"!callFeedbackSent && showFeedback\">\n\t\t\t\t\t<bx-im-component-call-feedback @feedbackSent=\"onFeedbackSent\" :callDetails=\"callDetails\" :darkMode=\"true\"/>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"bx-im-component-call-error-container\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-error-content\">\n\t\t\t\t\t\t\t<div class=\"bx-im-component-call-error-text\">\n\t\t\t\t\t\t\t\t<span v-if=\"isFinishedByOrganizer\">\n\t\t\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_ERROR_ORGANIZER_FINISHED_CONFERENCE'] }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span v-else>\n\t\t\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_ERROR_USER_LEFT_THE_CALL'] }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t<a v-if=\"!isExternalUser\" href=\"/\" class=\"bx-im-component-call-error-link\">{{ localize['BX_IM_COMPONENT_CALL_ERROR_RETURN_TO_PORTAL'] }}</a>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</template>\n\t\t</div>\n\t`\n};\n\nexport {Error};","const OrientationDisabled = {\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-orientation-disabled-wrap\">\n\t\t\t<div class=\"bx-im-component-call-orientation-disabled-icon\"></div>\n\t\t\t<div class=\"bx-im-component-call-orientation-disabled-text\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_ROTATE_DEVICE') }}\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n\nexport {OrientationDisabled};","import { BitrixVue } from \"ui.vue\";\nimport { Vuex } from \"ui.vue.vuex\";\nimport { EventEmitter } from \"main.core.events\";\nimport { EventType } from \"im.const\";\n\nconst PasswordCheck = {\n\tdata()\n\t{\n\t\treturn {\n\t\t\tpassword: '',\n\t\t\tcheckingPassword: '',\n\t\t\twrongPassword: ''\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.conference.setPasswordFocus, this.onSetPasswordFocus);\n\t},\n\tbeforeDestroy()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.conference.setPasswordFocus, this.onSetPasswordFocus);\n\t},\n\tcomputed:\n\t{\n\t\tconferenceTitle()\n\t\t{\n\t\t\treturn this.conference.common.conferenceTitle;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tconference: state => state.conference\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tonSetPasswordFocus()\n\t\t{\n\t\t\tthis.$refs['passwordInput'].focus();\n\t\t},\n\t\tcheckPassword()\n\t\t{\n\t\t\tif (!this.password || this.checkingPassword)\n\t\t\t{\n\t\t\t\tthis.wrongPassword = true;\n\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.checkingPassword = true;\n\t\t\tthis.wrongPassword = false;\n\t\t\tthis.getApplication().checkPassword(this.password)\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.wrongPassword = true;\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tthis.checkingPassword = false;\n\t\t\t\t});\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"bx-im-component-call-info-container\">\n\t\t\t\t<div class=\"bx-im-component-call-info-logo\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-info-title\">{{ conferenceTitle }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-component-call-password-container\">\n\t\t\t\t<template v-if=\"wrongPassword\">\n\t\t\t\t\t<div class=\"bx-im-component-call-password-error\">\n\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_PASSWORD_WRONG'] }}\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"bx-im-component-call-password-title\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-password-title-logo\"></div>\n\t\t\t\t\t\t<div class=\"bx-im-component-call-password-title-text\">\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_PASSWORD_TITLE'] }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<input\n\t\t\t\t\t@keyup.enter=\"checkPassword\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tv-model=\"password\"\n\t\t\t\t\tclass=\"bx-im-component-call-password-input\"\n\t\t\t\t\t:placeholder=\"localize['BX_IM_COMPONENT_CALL_PASSWORD_PLACEHOLDER']\"\n\t\t\t\t\tref=\"passwordInput\"\n\t\t\t\t/>\n\t\t\t\t<button @click=\"checkPassword\" class=\"ui-btn ui-btn-sm ui-btn-primary bx-im-component-call-password-button\">\n\t\t\t  \t\t{{ localize['BX_IM_COMPONENT_CALL_PASSWORD_JOIN'] }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n\nexport {PasswordCheck};","import { BitrixVue } from \"ui.vue\";\n\nconst LoadingStatus = {\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-loading\">\n\t\t\t<div class=\"bx-im-component-call-loading-text\">{{ localize['BX_IM_COMPONENT_CALL_LOADING'] }}</div>\n\t\t</div>\n\t`\n};\n\nexport {LoadingStatus};","import { BitrixVue } from \"ui.vue\";\nimport { MessageBox, MessageBoxButtons } from \"ui.dialogs.messagebox\";\nimport { EventEmitter } from \"main.core.events\";\nimport { EventType } from \"im.const\";\n\nconst NOT_ALLOWED_ERROR_CODE = 'NotAllowedError';\nconst NOT_FOUND_ERROR_CODE = 'NotFoundError';\n\nconst RequestPermissions = {\n\tprops: {\n\t\tskipRequest: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tEventEmitter.subscribe(EventType.conference.requestPermissions, this.onRequestPermissions);\n\t\tthis.getApplication().callView.blockButtons(['microphone', 'camera']);\n\t},\n\tbeforeDestroy()\n\t{\n\t\tEventEmitter.unsubscribe(EventType.conference.requestPermissions, this.onRequestPermissions);\n\t},\n\tcomputed:\n\t{\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t}\n\t},\n\tmethods:\n\t{\n\t\tonRequestPermissions()\n\t\t{\n\t\t\tthis.requestPermissions();\n\t\t},\n\t\tasync requestPermissions()\n\t\t{\n\t\t\tconst tryGetUserMedia = async (params = { video: 'exact' }) => {\n\t\t\t\tconst videoParams = params.video ? {\n\t\t\t\t\twidth: { ideal: 1280 },\n\t\t\t\t\theight: { ideal: 720 },\n\t\t\t\t\tdeviceId: { [params.video]: BX.Call.Hardware.defaultCamera },\n\t\t\t\t} : false;\n\n\t\t\t\tconst constraints = {\n\t\t\t\t\taudio: true,\n\t\t\t\t\tvideo: videoParams,\n\t\t\t\t};\n\n\t\t\t\tlet stream = null;\n\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tstream = await navigator.mediaDevices.getUserMedia(constraints);\n\t\t\t\t\tthis.setPermissionsRequestedFlag();\n\t\t\t\t\treturn videoParams ? ['microphone', 'camera'] : ['microphone'];\n\t\t\t\t}\n\t\t\t\tcatch (error) {\n\t\t\t\t\tif (error.name === NOT_ALLOWED_ERROR_CODE) {\n\t\t\t\t\t\tthrow error;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (params.video === 'exact') {\n\t\t\t\t\t\treturn tryGetUserMedia({ video: 'ideal' });\n\t\t\t\t\t}\n\t\t\t\t\telse if (params.video === 'ideal') {\n\t\t\t\t\t\treturn tryGetUserMedia({ video: false });\n\t\t\t\t\t}\n\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t\tfinally\n\t\t\t\t{\n\t\t\t\t\tstream?.getTracks().forEach(track => track.stop());\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait this.getApplication().initHardware();\n\t\t\t\tconst devices = await tryGetUserMedia({ video: 'exact' });\n\t\t\t\tthis.getApplication().callView.showButtons(['camera', 'microphone']);\n\t\t\t\tthis.getApplication().callView.unblockButtons(devices);\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tif (error.name === NOT_ALLOWED_ERROR_CODE)\n\t\t\t\t{\n\t\t\t\t\tthis.showMessageBox(this.localize['BX_IM_COMPONENT_CALL_NOT_ALLOWED_ERROR']);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.showMessageBox(this.localize['BX_IM_COMPONENT_CALL_HARDWARE_ERROR']);\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tBX.Call.Hardware.getCurrentDeviceList();\n\t\t\t}\n\t\t},\n\t\tsetPermissionsRequestedFlag()\n\t\t{\n\t\t\tthis.$nextTick(() => this.$store.dispatch('conference/setPermissionsRequested', {status: true}));\n\t\t},\n\t\tshowMessageBox(text)\n\t\t{\n\t\t\tMessageBox.show({\n\t\t\t\tmessage: text,\n\t\t\t\tmodal: true,\n\t\t\t\tbuttons: MessageBoxButtons.OK\n\t\t\t});\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-permissions-container\">\n\t\t\t<template v-if=\"!skipRequest\">\n\t\t\t\t<div class=\"bx-im-component-call-permissions-text\">{{ localize['BX_IM_COMPONENT_CALL_PERMISSIONS_TEXT'] }}</div>\n\t\t\t\t<button @click=\"requestPermissions\" class=\"bx-im-component-call-permissions-button\">\n\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_ENABLE_DEVICES_BUTTON'] }}\n\t\t\t\t</button>\n\t\t\t\t<slot></slot>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-im-component-call-permissions-text\">{{ localize['BX_IM_COMPONENT_CALL_PERMISSIONS_LOADING'] }}</div>\n\t\t\t\t<button class=\"ui-btn ui-btn-sm ui-btn-wait bx-im-component-call-permissions-button\">\n\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_PERMISSIONS_BUTTON'] }}\n\t\t\t\t</button>\n\t\t\t</template>\n\t\t</div>\n\t`\n};\n\nexport {RequestPermissions};","import { BitrixVue } from \"ui.vue\";\nimport { Vuex } from \"ui.vue.vuex\";\n\nconst MobileChatButton = {\n\tcomputed:\n\t{\n\t\tdialogCounter()\n\t\t{\n\t\t\tif (this.dialog)\n\t\t\t{\n\t\t\t\treturn this.dialog.counter;\n\t\t\t}\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId],\n\t\t\tconference: state => state.conference\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\topenChat()\n\t\t{\n\t\t\tthis.getApplication().toggleChat();\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-open-chat-button-container\">\n\t\t\t<div @click=\"openChat\" class=\"ui-btn ui-btn-sm ui-btn-icon-chat bx-im-component-call-open-chat-button\">\n\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_OPEN_CHAT'] }}\n\t\t\t\t<div v-if=\"dialogCounter > 0\" class=\"bx-im-component-call-open-chat-button-counter\">{{ dialogCounter }}</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n\nexport {MobileChatButton};\n","import { BitrixVue } from \"ui.vue\";\nimport { Vuex } from \"ui.vue.vuex\";\n\nconst ConferenceInfo = {\n\tprops: {\n\t\tcompactMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false\n\t\t}\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tconferenceDuration: '',\n\t\t\tdurationInterval: null\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tif (this.conferenceStarted)\n\t\t{\n\t\t\tthis.updateConferenceDuration();\n\t\t\tthis.durationInterval = setInterval(() => {\n\t\t\t\tthis.updateConferenceDuration();\n\t\t\t}, 1000);\n\t\t}\n\t},\n\tbeforeDestroy()\n\t{\n\t\tclearInterval(this.durationInterval);\n\t},\n\tcomputed:\n\t{\n\t\tconferenceStarted()\n\t\t{\n\t\t\treturn this.conference.common.conferenceStarted;\n\t\t},\n\t\tconferenceStartDate()\n\t\t{\n\t\t\treturn this.conference.common.conferenceStartDate;\n\t\t},\n\t\tconferenceTitle()\n\t\t{\n\t\t\treturn this.conference.common.conferenceTitle;\n\t\t},\n\t\tuserId()\n\t\t{\n\t\t\treturn this.application.common.userId;\n\t\t},\n\t\tisBroadcast()\n\t\t{\n\t\t\treturn this.conference.common.isBroadcast;\n\t\t},\n\t\tpresentersList()\n\t\t{\n\t\t\treturn this.conference.common.presenters;\n\t\t},\n\t\tpresentersInfo()\n\t\t{\n\t\t\treturn this.$store.getters['users/getList'](this.presentersList);\n\t\t},\n\t\tformattedPresentersList()\n\t\t{\n\t\t\tconst presentersCount = this.presentersList.length;\n\t\t\tconst prefix = presentersCount > 1 ? this.localize['BX_IM_COMPONENT_CALL_SPEAKERS_MULTIPLE'] : this.localize['BX_IM_COMPONENT_CALL_SPEAKER'];\n\t\t\tconst presenters = this.presentersInfo.map(user => user.name).join(', ');\n\n\t\t\treturn `${prefix}: ${presenters}`;\n\t\t},\n\t\tisCurrentUserPresenter()\n\t\t{\n\t\t\treturn this.presentersList.includes(this.userId);\n\t\t},\n\t\tconferenceStatusText()\n\t\t{\n\t\t\tif (this.conferenceStarted === true)\n\t\t\t{\n\t\t\t\treturn `${this.localize['BX_IM_COMPONENT_CALL_STATUS_STARTED']}, ${this.conferenceDuration}`;\n\t\t\t}\n\t\t\telse if (this.conferenceStarted === false)\n\t\t\t{\n\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_STATUS_NOT_STARTED'];\n\t\t\t}\n\t\t\telse if (this.conferenceStarted === null)\n\t\t\t{\n\t\t\t\treturn this.localize['BX_IM_COMPONENT_CALL_STATUS_LOADING'];\n\t\t\t}\n\t\t},\n\t\tconferenceStatusClasses()\n\t\t{\n\t\t\treturn [\n\t\t\t\t'bx-im-component-call-info-status',\n\t\t\t\tthis.conferenceStarted? 'bx-im-component-call-info-status-active' : 'bx-im-component-call-info-status-not-active'\n\t\t\t];\n\t\t},\n\t\tcontainerClasses()\n\t\t{\n\t\t\treturn [this.compactMode? 'bx-im-component-call-info-container-compact' : 'bx-im-component-call-info-container'];\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tconference: state => state.conference\n\t\t})\n\t},\n\twatch:\n\t{\n\t\tconferenceStarted(newValue)\n\t\t{\n\t\t\tif (newValue === true)\n\t\t\t{\n\t\t\t\tthis.durationInterval = setInterval(() => {\n\t\t\t\t\tthis.updateConferenceDuration();\n\t\t\t\t}, 1000);\n\t\t\t}\n\n\t\t\tthis.updateConferenceDuration();\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tupdateConferenceDuration()\n\t\t{\n\t\t\tif (!this.conferenceStartDate)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst startDate = this.conferenceStartDate;\n\t\t\tconst currentDate = new Date();\n\n\t\t\tlet durationInSeconds = Math.floor((currentDate - startDate) / 1000);\n\t\t\tlet minutes = 0;\n\t\t\tif (durationInSeconds > 60)\n\t\t\t{\n\t\t\t\tminutes = Math.floor(durationInSeconds / 60);\n\t\t\t\tif (minutes < 10)\n\t\t\t\t{\n\t\t\t\t\tminutes = '0' + minutes;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet seconds = durationInSeconds - (minutes * 60);\n\t\t\tif (seconds < 10)\n\t\t\t{\n\t\t\t\tseconds = '0' + seconds;\n\t\t\t}\n\t\t\tthis.conferenceDuration = `${minutes}:${seconds}`;\n\n\t\t\treturn true;\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div :class=\"containerClasses\">\n\t\t\t<template v-if=\"compactMode\">\n\t\t\t\t<div class=\"bx-im-component-call-info-title-container\">\n\t\t\t\t\t<div class=\"bx-im-component-call-info-logo\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-info-title\">{{ conferenceTitle }}</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"isBroadcast\" class=\"bx-im-component-call-info-speakers\">{{ formattedPresentersList }}</div>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"bx-im-component-call-info-logo\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-info-title\">{{ conferenceTitle }}</div>\n\t\t\t  \t<div v-if=\"isBroadcast\" class=\"bx-im-component-call-info-speakers\">{{ formattedPresentersList }}</div>\t\n\t\t\t</template>\n\t\t\t<div :class=\"conferenceStatusClasses\">{{ conferenceStatusText }}</div>\n\t\t</div>\n\t`\n};\n\nexport {ConferenceInfo};","import { BitrixVue } from \"ui.vue\";\nimport { Vuex } from \"ui.vue.vuex\";\nimport { Utils } from \"im.lib.utils\";\nimport { EventEmitter } from \"main.core.events\";\nimport { EventType } from \"im.const\";\nimport { Logger } from \"im.lib.logger\";\n\nconst UserForm = {\n\tdata()\n\t{\n\t\treturn {\n\t\t\tuserNewName: ''\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tconferenceStarted()\n\t\t{\n\t\t\treturn this.conference.common.conferenceStarted;\n\t\t},\n\t\tuserHasRealName()\n\t\t{\n\t\t\tif (this.user)\n\t\t\t{\n\t\t\t\treturn this.user.name !== this.localize['BX_IM_COMPONENT_CALL_DEFAULT_USER_NAME'];\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tintranetAvatarStyle()\n\t\t{\n\t\t\tif (this.user && !this.user.extranet && this.user.avatar)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tbackgroundImage: `url('${this.user.avatar}')`\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tlogoutLink()\n\t\t{\n\t\t\treturn `${this.publicLink}?logout=yes&sessid=${BX.bitrix_sessid()}`;\n\t\t},\n\t\tpublicLink()\n\t\t{\n\t\t\tif (this.dialog)\n\t\t\t{\n\t\t\t\treturn this.dialog.public.link;\n\t\t\t}\n\t\t},\n\t\tuserId()\n\t\t{\n\t\t\treturn this.application.common.userId;\n\t\t},\n\t\tisBroadcast()\n\t\t{\n\t\t\treturn this.conference.common.isBroadcast;\n\t\t},\n\t\tpresentersList()\n\t\t{\n\t\t\treturn this.conference.common.presenters;\n\t\t},\n\t\tisCurrentUserPresenter()\n\t\t{\n\t\t\treturn this.presentersList.includes(this.userId);\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t},\n\t\tvideoModeButtonClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-join-video'];\n\n\t\t\tif (!this.getApplication().hardwareInited)\n\t\t\t{\n\t\t\t\tclasses.push('disabled');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\taudioModeButtonClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-join-audio'];\n\n\t\t\tif (!this.getApplication().hardwareInited)\n\t\t\t{\n\t\t\t\tclasses.push('disabled');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tuser: state => state.users.collection[state.application.common.userId],\n\t\t\tapplication: state => state.application,\n\t\t\tconference: state => state.conference\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tstartConference({ video })\n\t\t{\n\t\t\tthis.getApplication().startCall(video);\n\t\t},\n\t\tasync joinConference({ video })\n\t\t{\n\t\t\tif (this.user.extranet && !this.userHasRealName)\n\t\t\t{\n\t\t\t\tawait this.setNewName();\n\t\t\t}\n\n\t\t\tif (!this.conferenceStarted)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.conference.waitForStart);\n\n\t\t\t\tthis.getApplication().setUserReadyToJoin();\n\t\t\t\tthis.getApplication().setJoinType(video);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst viewerMode = this.isBroadcast && !this.isCurrentUserPresenter;\n\t\t\t\tLogger.warn('ready to join call', video, viewerMode);\n\t\t\t\tif (viewerMode)\n\t\t\t\t{\n\t\t\t\t\tthis.getApplication().joinCall(this.getApplication().preCall.id, this.getApplication().preCall.uuid, {\n\t\t\t\t\t\tjoinAsViewer: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.getApplication().joinCall(this.getApplication().preCall.id, this.getApplication().preCall.uuid, { video });\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tasync setNewName()\n\t\t{\n\t\t\tif (this.userNewName.length > 0)\n\t\t\t{\n\t\t\t\tawait this.getApplication().renameGuest(this.userNewName);\n\t\t\t}\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t},\n\t\tisDesktop()\n\t\t{\n\t\t\treturn Utils.platform.isBitrixDesktop();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-form\">\n\t\t\t<template v-if=\"user && userHasRealName\">\n\t\t\t\t<template v-if=\"!user.extranet\">\n\t\t\t\t\t<div class=\"bx-im-component-call-intranet-name-container\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-intranet-name-title\">\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_INTRANET_NAME_TITLE'] }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-component-call-intranet-name-content\">\n\t\t\t\t\t\t\t<div class=\"bx-im-component-call-intranet-name-content-left\">\n\t\t\t\t\t\t\t\t<div class=\"bx-im-component-call-intranet-name-text\">{{ user.name }}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<template v-if=\"!isDesktop()\">\n\t\t\t\t\t\t\t\t<a :href=\"logoutLink\" class=\"bx-im-component-call-intranet-name-logout\">\n\t\t\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_INTRANET_LOGOUT'] }}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-else-if=\"user.extranet\">\n\t\t\t\t\t<div class=\"bx-im-component-call-guest-name-container\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-guest-name-text\">{{ user.name }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</template>\n\t\t\t<!-- New guest, need to specify name -->\n\t\t\t<template v-else-if=\"user && !userHasRealName\">\n\t\t\t\t<input\n\t\t\t\t\tv-model.trim=\"userNewName\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t:placeholder=\"localize['BX_IM_COMPONENT_CALL_NAME_PLACEHOLDER']\"\n\t\t\t\t\tclass=\"bx-im-component-call-name-input\"\n\t\t\t\t\tref=\"nameInput\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<!-- Buttons -->\n\t\t\t<template v-if=\"user\">\n\t\t\t\t<!-- Broadcast mode -->\n\t\t\t\t<template v-if=\"isBroadcast\">\n\t\t\t\t\t<!-- Speaker can start conference -->\n\t\t\t\t\t<template v-if=\"isCurrentUserPresenter && !conferenceStarted\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"startConference({video: true})\"\n\t\t\t\t\t\t\t:class=\"videoModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_START_WITH_VIDEO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"startConference({video: false})\"\n\t\t\t\t\t\t\t:class=\"audioModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_START_WITH_AUDIO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t\t<!-- Speakers can join with audio/video -->\n\t\t\t\t\t<template v-else-if=\"conferenceStarted && isCurrentUserPresenter\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"joinConference({video: true})\"\n\t\t\t\t\t\t\t:class=\"videoModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_JOIN_WITH_VIDEO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"joinConference({video: false})\"\n\t\t\t\t\t\t\t:class=\"audioModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_JOIN_WITH_AUDIO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t\t<!-- Others can join as viewers -->\n\t\t\t\t\t<template v-else-if=\"!isCurrentUserPresenter\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"joinConference({video: false})\"\n\t\t\t\t\t\t\tclass=\"bx-im-component-call-join-video\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_JOIN'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t\t<!-- End broadcast mode -->\n\t\t\t\t<template v-else-if=\"!isBroadcast\">\n\t\t\t\t\t<!-- Intranet user can start conference -->\n\t\t\t\t\t<template v-if=\"!user.extranet && !conferenceStarted\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"startConference({video: true})\"\n\t\t\t\t\t\t\t:class=\"videoModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_START_WITH_VIDEO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"startConference({video: false})\"\n\t\t\t\t\t\t\t:class=\"audioModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_START_WITH_AUDIO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t\t<!-- Others can join -->\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"joinConference({video: true})\"\n\t\t\t\t\t\t\t:class=\"videoModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_JOIN_WITH_VIDEO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t@click=\"joinConference({video: false})\"\n\t\t\t\t\t\t\t:class=\"audioModeButtonClasses\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_JOIN_WITH_AUDIO'] }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t</template>\n\t\t\t<!--End normal (not broadcast) mode-->\n\t\t</div>\n\t`\n};\n\nexport {UserForm};","import { BitrixVue } from \"ui.vue\";\nimport { Vuex } from \"ui.vue.vuex\";\nimport { Utils } from \"im.lib.utils\";\nimport { Desktop } from \"im.lib.desktop\";\n\nconst ChatHeader = {\n\tcreated()\n\t{\n\t\tthis.desktop = new Desktop();\n\t},\n\tcomputed:\n\t{\n\t\tshowTotalCounter()\n\t\t{\n\t\t\treturn Utils.platform.isBitrixDesktop()\n\t\t\t\t&& (this.desktop.getApiVersion() >= 60 || !Utils.platform.isWindows())\n\t\t\t\t&& !this.getApplication().isExternalUser()\n\t\t\t\t&& this.messageCount > 0;\n\t\t},\n\t\tmessageCount()\n\t\t{\n\t\t\treturn this.conference.common.messageCount;\n\t\t},\n\t\tformattedCounter()\n\t\t{\n\t\t\treturn this.messageCount > 99 ? '99+' : this.messageCount;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tconference: state => state.conference\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tonCloseChat()\n\t\t{\n\t\t\tthis.getApplication().toggleChat();\n\t\t},\n\t\tonTotalCounterClick()\n\t\t{\n\t\t\tif (opener && opener.BXDesktopWindow)\n\t\t\t{\n\t\t\t\topener.BXDesktopWindow.ExecuteCommand('show.active');\n\t\t\t}\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-right-header\">\n\t\t\t<div class=\"bx-im-component-call-right-header-left\">\n\t\t\t\t<div @click=\"onCloseChat\" class=\"bx-im-component-call-right-header-close\" :title=\"localize['BX_IM_COMPONENT_CALL_CHAT_CLOSE_TITLE']\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-right-header-title\">{{ localize['BX_IM_COMPONENT_CALL_CHAT_TITLE'] }}</div>\n \n\t\t\t</div>\n\t\t\t<template v-if=\"showTotalCounter\">\n\t\t\t\t<div @click=\"onTotalCounterClick\" class=\"bx-im-component-call-right-header-right bx-im-component-call-right-header-all-chats\">\n\t\t\t\t\t<div class=\"bx-im-component-call-right-header-all-chats-title\">{{ localize['BX_IM_COMPONENT_CALL_ALL_CHATS'] }}</div>\n\t\t\t\t\t<div class=\"bx-im-component-call-right-header-all-chats-counter\">{{ messageCount }}</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`\n};\n\nexport {ChatHeader};","import { BitrixVue } from \"ui.vue\";\nimport { Vuex } from \"ui.vue.vuex\";\n\nconst WaitingForStart = {\n\tcomputed:\n\t{\n\t\tuserCounter()\n\t\t{\n\t\t\treturn this.dialog.userCounter;\n\t\t},\n\t\tlocalize()\n\t\t{\n\t\t\treturn BitrixVue.getFilteredPhrases('BX_IM_COMPONENT_CALL_');\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tconference: state => state.conference,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId]\n\t\t})\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-wait-container\">\n\t\t\t<div class=\"bx-im-component-call-wait-main\">\n\t\t\t\t<div class=\"bx-im-component-call-wait-logo\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-wait-title\">{{ localize['BX_IM_COMPONENT_CALL_WAIT_START_TITLE'] }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-component-call-wait-user-counter\">\n\t\t\t\t{{ localize['BX_IM_COMPONENT_CALL_WAIT_START_USER_COUNT'] }} {{ userCounter }}\n\t\t\t</div>\n\t\t\t<slot></slot>\n\t\t</div>\n\t`\n};\n\nexport {WaitingForStart};","import { Vuex } from \"ui.vue.vuex\";\nimport { Utils } from \"im.lib.utils\";\nimport { Utils as UtilsV2 } from 'im.v2.lib.utils';\nimport { MenuManager } from \"main.popup\";\nimport { EventType } from 'im.const';\nimport { ConferenceUserState, ConferenceStateType } from 'call.const';\nimport { EventEmitter } from \"main.core.events\";\n\nconst UserListItem = {\n\tprops: {\n\t\tuserId: {\n\t\t\ttype: Number,\n\t\t\trequired: true\n\t\t}\n\t},\n\tdata: function() {\n\t\treturn {\n\t\t\trenameMode: false,\n\t\t\tnewName: '',\n\t\t\trenameRequested: false,\n\t\t\tmenuId: 'bx-messenger-context-popup-external-data',\n\t\t\tonlineStates: [ConferenceUserState.Ready, ConferenceUserState.Connected]\n\t\t}\n\t},\n\tcomputed:\n\t{\n\t\tuser()\n\t\t{\n\t\t\treturn this.$store.getters['users/get'](this.userId, true);\n\t\t},\n\t\t// statuses\n\t\tcurrentUser()\n\t\t{\n\t\t\treturn this.application.common.userId;\n\t\t},\n\t\tchatOwner()\n\t\t{\n\t\t\tif (!this.dialog)\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\treturn this.dialog.ownerId;\n\t\t},\n\t\tisCurrentUserOwner()\n\t\t{\n\t\t\treturn this.chatOwner === this.currentUser;\n\t\t},\n\t\tisCurrentUserExternal()\n\t\t{\n\t\t\treturn !!this.conference.user.hash;\n\t\t},\n\t\tisMobile()\n\t\t{\n\t\t\treturn Utils.device.isMobile();\n\t\t},\n\t\tisDesktop()\n\t\t{\n\t\t\treturn Utils.platform.isBitrixDesktop();\n\t\t},\n\t\tisGuestWithDefaultName()\n\t\t{\n\t\t\tconst guestDefaultName = this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_DEFAULT_USER_NAME');\n\n\t\t\treturn this.user.id === this.currentUser && this.user.extranet && this.user.name === guestDefaultName;\n\t\t},\n\t\tuserCallStatus()\n\t\t{\n\t\t\treturn this.$store.getters['call/getUser'](this.user.id);\n\t\t},\n\t\tisUserInCall()\n\t\t{\n\t\t\treturn this.onlineStates.includes(this.userCallStatus.state);\n\t\t},\n\t\tuserInCallCount()\n\t\t{\n\t\t\tconst usersInCall = Object.values(this.call.users).filter(user => {\n\t\t\t\treturn this.onlineStates.includes(user.state);\n\t\t\t});\n\n\t\t\treturn usersInCall.length;\n\t\t},\n\t\tisBroadcast()\n\t\t{\n\t\t\treturn this.conference.common.isBroadcast;\n\t\t},\n\t\tpresentersList()\n\t\t{\n\t\t\treturn this.conference.common.presenters;\n\t\t},\n\t\tisUserPresenter()\n\t\t{\n\t\t\treturn this.presentersList.includes(this.user.id);\n\t\t},\n\t\t// end statuses\n\t\tformattedSubtitle()\n\t\t{\n\t\t\tlet subtitle = '';\n\t\t\tconst role = this.$Bitrix.Loc.getMessage(\n\t\t\t\tthis.user.id === this.chatOwner\n\t\t\t\t\t? 'BX_IM_COMPONENT_CALL_USER_LIST_STATUS_OWNER'\n\t\t\t\t\t: 'BX_IM_COMPONENT_CALL_USER_LIST_STATUS_PARTICIPANT',\n\t\t\t);\n\n\t\t\tif (this.user.id === this.currentUser)\n\t\t\t{\n\t\t\t\tsubtitle = this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_STATUS_CURRENT_USER_MSGVER_1', {\n\t\t\t\t\t'#ROLE#': role,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsubtitle = role;\n\t\t\t}\n\n\t\t\t// if (!this.user.extranet && !this.user.isOnline)\n\t\t\t// {\n\t\t\t// \tsubtitles.push(this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_STATUS_OFFLINE'));\n\t\t\t// }\n\n\t\t\treturn subtitle;\n\t\t},\n\t\tisMenuNeeded()\n\t\t{\n\t\t\treturn this.getMenuItems.length > 0;\n\t\t},\n\t\tmenuItems()\n\t\t{\n\t\t\tconst items = [];\n\t\t\t// for self\n\t\t\tif (this.user.id === this.currentUser)\n\t\t\t{\n\t\t\t\t// self-rename\n\t\t\t\tif (this.isCurrentUserExternal)\n\t\t\t\t{\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_RENAME_SELF'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\tthis.onRenameStart();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// change background\n\t\t\t\tif (this.isDesktop)\n\t\t\t\t{\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_CHANGE_BACKGROUND'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\tthis.$emit('userChangeBackground');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\t// for other users\n\t\t\telse\n\t\t\t{\n\t\t\t\t// force-rename\n\t\t\t\tif (this.isCurrentUserOwner && this.user.externalAuthId === 'call')\n\t\t\t\t{\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_RENAME'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\tthis.onRenameStart();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// kick\n\t\t\t\tif (this.isCurrentUserOwner && !this.isUserPresenter)\n\t\t\t\t{\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_KICK'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\tthis.$emit('userKick', {user: this.user});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (this.isUserInCall && this.userCallStatus.cameraState && this.userInCallCount > 2)\n\t\t\t\t{\n\t\t\t\t\t// pin\n\t\t\t\t\tif (!this.userCallStatus.pinned)\n\t\t\t\t\t{\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_PIN'),\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\t\tthis.$emit('userPin', {user: this.user});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t// unpin\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_UNPIN'),\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\t\tthis.$emit('userUnpin');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\t// open 1-1 chat and profile\n\t\t\t\tif (this.isDesktop && !this.user.extranet)\n\t\t\t\t{\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_OPEN_CHAT'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\tthis.$emit('userOpenChat', {user: this.user});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\titems.push({\n\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_OPEN_PROFILE'),\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\t\tthis.$emit('userOpenProfile', {user: this.user});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// insert name\n\t\t\t\titems.push({\n\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_MENU_INSERT_NAME'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\tthis.$emit('userInsertName', {user: this.user});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn items;\n\t\t},\n\t\tavatarWrapClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-user-list-item-avatar-wrap'];\n\n\t\t\tif (this.userCallStatus.talking)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-avatar-wrap-talking');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\tavatarClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-user-list-item-avatar'];\n\n\t\t\tif (!this.user.avatar && this.user.extranet)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-avatar-extranet');\n\t\t\t}\n\t\t\telse if (!this.user.avatar && !this.user.extranet)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-avatar-default');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\tavatarStyle()\n\t\t{\n\t\t\tconst style = {};\n\n\t\t\tif (this.user.avatar)\n\t\t\t{\n\t\t\t\tstyle.backgroundImage = `url('${this.user.avatar}')`;\n\t\t\t}\n\t\t\telse if (!this.user.avatar && !this.user.extranet)\n\t\t\t{\n\t\t\t\tstyle.backgroundColor = this.user.color;\n\t\t\t}\n\n\t\t\treturn style;\n\t\t},\n\t\tavatarInnerText()\n\t\t{\n\t\t\tif (!this.user.avatar && !this.user.extranet)\n\t\t\t{\n\t\t\t\treturn UtilsV2.text.getFirstLetters(this.user.name).toUpperCase();\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tisCallStatusPanelNeeded()\n\t\t{\n\t\t\tif (this.isBroadcast)\n\t\t\t{\n\t\t\t\treturn this.conference.common.state === ConferenceStateType.call && this.isUserInCall && this.isUserPresenter;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.conference.common.state === ConferenceStateType.call && this.isUserInCall;\n\t\t\t}\n\t\t},\n\t\tcallMenuIconClasses()\n\t\t{\n\t\t\treturn ['bx-im-component-call-user-list-item-icons-icon bx-im-component-call-user-list-item-icons-menu'];\n\t\t},\n\t\tcallLeftIconClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-user-list-item-icons-icon bx-im-component-call-user-list-item-icons-left'];\n\n\t\t\tif (this.userCallStatus.floorRequestState)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-icons-floor-request visible');\n\t\t\t}\n\t\t\telse if (this.userCallStatus.screenState)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-icons-screen visible');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\tcallCenterIconClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-user-list-item-icons-icon bx-im-component-call-user-list-item-icons-center'];\n\n\t\t\tif (this.userCallStatus.microphoneState)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-icons-mic-on');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-icons-mic-off');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\tcallRightIconClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-user-list-item-icons-icon bx-im-component-call-user-list-item-icons-right'];\n\n\t\t\tif (this.userCallStatus.cameraState)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-icons-camera-on');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-icons-camera-off');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\tbodyClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-user-list-item-body'];\n\n\t\t\tif (!this.isUserInCall)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-body-offline');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\titemClasses()\n\t\t{\n\t\t\tconst classes = ['bx-im-component-call-user-list-item'];\n\n\t\t\tif (this.user.id === this.chatOwner)\n\t\t\t{\n\t\t\t\tclasses.push('bx-im-component-call-user-list-item-owner');\n\t\t\t}\n\n\t\t\treturn classes;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tapplication: state => state.application,\n\t\t\tconference: state => state.conference,\n\t\t\tcall: state => state.call,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId]\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\topenMenu()\n\t\t{\n\t\t\tif (this.menuPopup)\n\t\t\t{\n\t\t\t\tthis.closeMenu();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t//menu for other items\n\t\t\tconst existingMenu = MenuManager.getMenuById(this.menuId);\n\t\t\tif (existingMenu)\n\t\t\t{\n\t\t\t\texistingMenu.destroy();\n\t\t\t}\n\n\t\t\tthis.menuPopup = MenuManager.create({\n\t\t\t\tid: this.menuId,\n\t\t\t\tclassName: 'bx-conference-user-list-item-context-menu',\n\t\t\t\tbackground: '#00428F',\n\t\t\t\tcontentBackground: '#00428F',\n\t\t\t\tdarkMode: true,\n\t\t\t\tcontentBorderRadius: '6px',\n\t\t\t\tborderRadius: '6px',\n\t\t\t\tbindElement: this.$refs['user-menu'],\n\t\t\t\titems: this.menuItems,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => this.menuPopup.destroy(),\n\t\t\t\t\tonPopupDestroy: () => this.menuPopup = null\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.menuPopup.show();\n\t\t},\n\t\tcloseMenu()\n\t\t{\n\t\t\tthis.menuPopup.destroy();\n\t\t\tthis.menuPopup = null;\n\t\t},\n\t\tonRenameStart()\n\t\t{\n\t\t\tthis.newName = this.user.name;\n\t\t\tthis.renameMode = true;\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.$refs['rename-input'].focus();\n\t\t\t\tthis.$refs['rename-input'].select();\n\t\t\t});\n\t\t},\n\t\tonRenameKeyDown(event)\n\t\t{\n\t\t\t//enter\n\t\t\tif (event.keyCode === 13)\n\t\t\t{\n\t\t\t\tthis.changeName();\n\t\t\t}\n\t\t\t//escape\n\t\t\telse if (event.keyCode === 27)\n\t\t\t{\n\t\t\t\tthis.renameMode = false;\n\t\t\t}\n\t\t},\n\t\tchangeName()\n\t\t{\n\t\t\tif (this.user.name === this.newName.trim() || this.newName === '')\n\t\t\t{\n\t\t\t\tthis.renameMode = false;\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.$emit('userChangeName', {user: this.user, newName: this.newName});\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.renameMode = false;\n\t\t\t});\n\t\t},\n\t\tonFocus(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.conference.userRenameFocus, event);\n\t\t},\n\t\tonBlur(event)\n\t\t{\n\t\t\tEventEmitter.emit(EventType.conference.userRenameBlur, event);\n\t\t},\n\t},\n\t//language=Vue\n\ttemplate: `\n\t\t<div :class=\"itemClasses\">\n\t\t\t<!-- Avatar -->\n\t\t\t<div :class=\"avatarWrapClasses\">\n\t\t\t\t<div :class=\"avatarClasses\" :style=\"avatarStyle\">\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-item-avatar-inner-text\" v-if=\"avatarInnerText\">{{ avatarInnerText }}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<!-- Body -->\n\t\t\t<div :class=\"bodyClasses\">\n\t\t\t\t<!-- Introduce yourself blinking mode -->\n\t\t\t\t<template v-if=\"!renameMode && isGuestWithDefaultName\">\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-item-body-left\">\n\t\t\t\t\t\t<div @click=\"onRenameStart\" class=\"bx-im-component-call-user-list-introduce-yourself\">\n\t\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-introduce-yourself-text\">{{ $Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_INTRODUCE_YOURSELF') }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<!-- Rename mode -->\n\t\t\t\t<template v-else-if=\"renameMode\">\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-item-body-left\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-change-name-container\">\n\t\t\t\t\t\t\t<div @click=\"renameMode = false\" class=\"bx-im-component-call-user-list-change-name-cancel\"></div>\n\t\t\t\t\t\t\t<input @keydown=\"onRenameKeyDown\" @focus=\"onFocus\" @blur=\"onBlur\" v-model=\"newName\" :ref=\"'rename-input'\" type=\"text\" class=\"bx-im-component-call-user-list-change-name-input\">\n\t\t\t\t\t\t\t<div v-if=\"!renameRequested\" @click=\"changeName\" class=\"bx-im-component-call-user-list-change-name-confirm\"></div>\n\t\t\t\t\t\t\t<div v-else class=\"bx-im-component-call-user-list-change-name-loader\">\n\t\t\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-change-name-loader-icon\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-if=\"!renameMode && !isGuestWithDefaultName\">\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-item-body-left\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-item-name-wrap\">\n\t\t\t\t\t\t\t<!-- Name -->\n\t\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-item-name\">{{ user.name }}</div>\n\t\t\t\t\t\t\t<!-- Status subtitle -->\n\t\t\t\t\t\t\t<div v-if=\"formattedSubtitle !== ''\" class=\"bx-im-component-call-user-list-item-name-subtitle\">{{ formattedSubtitle }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-if=\"isCallStatusPanelNeeded\">\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-item-icons\">\n\t\t\t\t\t\t<!-- Context menu icon -->\n\t\t\t\t\t\t<div :class=\"callMenuIconClasses\" v-if=\"menuItems.length > 0 && !isMobile\" @click=\"openMenu\" ref=\"user-menu\"></div>\n\t\t\t\t\t\t<div :class=\"callLeftIconClasses\"></div>\n\t\t\t\t\t\t<div :class=\"callCenterIconClasses\"></div>\n\t\t\t\t\t\t<div :class=\"callRightIconClasses\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n\nexport {UserListItem};","import { Vuex } from \"ui.vue.vuex\";\nimport { Logger } from \"im.lib.logger\";\nimport { EventEmitter } from 'main.core.events';\nimport { EventType } from \"im.const\";\nimport { ConferenceRightPanelMode as RightPanelMode, ConferenceUserState } from 'call.const';\nimport { MessageBox, MessageBoxButtons } from \"ui.dialogs.messagebox\";\n\nimport {UserListItem} from './user-list-item';\n\nconst UserList = {\n\tcomponents: {UserListItem},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tusersPerPage: 50,\n\t\t\tfirstPageLoaded: false,\n\t\t\tpagesLoaded: 0,\n\t\t\thasMoreToLoad: true,\n\t\t\trename: {\n\t\t\t\tuser: 0,\n\t\t\t\tnewName: '',\n\t\t\t\trenameRequested: false\n\t\t\t}\n\t\t}\n\t},\n\tcreated()\n\t{\n\t\tLogger.warn('Conference: user list created');\n\t\tthis.requestUsers({firstPage: true});\n\t},\n\tbeforeDestroy()\n\t{\n\t\tthis.loaderObserver = null;\n\t},\n\tcomputed:\n\t{\n\t\tuserId()\n\t\t{\n\t\t\treturn this.application.common.userId;\n\t\t},\n\t\tisBroadcast()\n\t\t{\n\t\t\treturn this.conference.common.isBroadcast;\n\t\t},\n\t\tusersList()\n\t\t{\n\t\t\tconst users = this.conference.common.users.filter(user => {\n\t\t\t\treturn !this.presentersList.includes(user) && this.call.users[user] && [ConferenceUserState.Ready, ConferenceUserState.Connected].includes(this.call.users[user].state);\n\t\t\t});\n\n\t\t\treturn [...users].sort(this.userSortFunction);\n\t\t},\n\t\tpresentersList()\n\t\t{\n\t\t\treturn [...this.conference.common.presenters].sort(this.userSortFunction);\n\t\t},\n\t\trightPanelMode()\n\t\t{\n\t\t\treturn this.conference.common.rightPanelMode;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tuser: state => state.users.collection[state.application.common.userId],\n\t\t\tapplication: state => state.application,\n\t\t\tconference: state => state.conference,\n\t\t\tcall: state => state.call,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId]\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\trequestUsers({firstPage = false} = {})\n\t\t{\n\t\t\tthis.$Bitrix.RestClient.get().callMethod('im.dialog.users.list', {\n\t\t\t\t'DIALOG_ID': this.application.dialog.dialogId,\n\t\t\t\t'LIMIT': this.usersPerPage,\n\t\t\t\t'OFFSET': firstPage? 0 : (this.pagesLoaded * this.usersPerPage)\n\t\t\t}).then(result => {\n\t\t\t\tLogger.warn('Conference: getting next user list result', result.data());\n\t\t\t\tconst users = result.data();\n\t\t\t\tthis.pagesLoaded++;\n\t\t\t\tif (users.length < this.usersPerPage)\n\t\t\t\t{\n\t\t\t\t\tthis.hasMoreToLoad = false;\n\t\t\t\t}\n\n\t\t\t\tthis.$store.dispatch('users/set', users);\n\t\t\t\tconst usersIds = users.map(user => user.id);\n\n\t\t\t\treturn this.$store.dispatch('conference/setUsers', { users: usersIds });\n\t\t\t}).then(() => {\n\t\t\t\tif (firstPage)\n\t\t\t\t{\n\t\t\t\t\tthis.firstPageLoaded = true;\n\t\t\t\t}\n\t\t\t}).catch(result => {\n\t\t\t\tLogger.warn('Conference: error getting users list', result.error().ex);\n\t\t\t});\n\t\t},\n\t\tonUserMenuKick({user})\n\t\t{\n\t\t\tthis.showUserKickConfirm(user);\n\t\t},\n\t\tshowUserKickConfirm(user)\n\t\t{\n\t\t\tif (this.userKickConfirm)\n\t\t\t{\n\t\t\t\tthis.userKickConfirm.close();\n\t\t\t}\n\n\t\t\tlet confirmMessage = this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_KICK_INTRANET_USER_CONFIRM_TEXT');\n\t\t\tif (user.extranet)\n\t\t\t{\n\t\t\t\tconfirmMessage = this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_KICK_GUEST_USER_CONFIRM_TEXT');\n\t\t\t}\n\t\t\tthis.userKickConfirm = MessageBox.create({\n\t\t\t\tmessage: confirmMessage,\n\t\t\t\tmodal: true,\n\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\tonOk: () => {\n\t\t\t\t\tthis.kickUser(user);\n\t\t\t\t\tthis.userKickConfirm.close();\n\t\t\t\t},\n\t\t\t\tonCancel: () => {\n\t\t\t\t\tthis.userKickConfirm.close();\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.userKickConfirm.show();\n\t\t},\n\t\tkickUser(user)\n\t\t{\n\t\t\tthis.$store.dispatch('conference/removeUsers', { users: [user.id] });\n\t\t\tthis.$Bitrix.RestClient.get().callMethod('im.chat.user.delete', {\n\t\t\t\tuser_id: user.id,\n\t\t\t\tchat_id: this.application.dialog.chatId\n\t\t\t}).catch((error) => {\n\t\t\t\tLogger.error('Conference: removing user from chat error', error);\n\t\t\t\tthis.$store.dispatch('conference/setUsers', { users: [user.id] });\n\t\t\t});\n\t\t},\n\t\tonUserMenuInsertName({user})\n\t\t{\n\t\t\tif (this.rightPanelMode === RightPanelMode.hidden || this.rightPanelMode === RightPanelMode.users)\n\t\t\t{\n\t\t\t\tthis.getApplication().toggleChat();\n\t\t\t}\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tEventEmitter.emit(EventType.textarea.insertText, {text: `${user.name}, `, focus: true});\n\t\t\t});\n\t\t},\n\t\tonUserChangeName({user, newName})\n\t\t{\n\t\t\tconst method = user.id === this.userId ? 'im.call.user.update' : 'im.call.user.force.rename';\n\n\t\t\tconst oldName = user.name;\n\t\t\tthis.$store.dispatch('users/update', {\n\t\t\t\tid: user.id,\n\t\t\t\tfields: {name: newName, lastActivityDate: new Date()}\n\t\t\t});\n\t\t\tthis.$Bitrix.RestClient.get().callMethod(method, {\n\t\t\t\tname: newName,\n\t\t\t\tchat_id: this.application.dialog.chatId,\n\t\t\t\tuser_id: user.id\n\t\t\t}).then(() => {\n\t\t\t\tLogger.warn('Conference: rename completed', user.id, newName);\n\t\t\t\tif (oldName === this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_DEFAULT_USER_NAME'))\n\t\t\t\t{\n\t\t\t\t\tthis.getApplication().setUserWasRenamed();\n\t\t\t\t}\n\t\t\t}).catch((error) => {\n\t\t\t\tLogger.error('Conference: renaming error', error);\n\t\t\t\tthis.$store.dispatch('users/update', {\n\t\t\t\t\tid: user.id,\n\t\t\t\t\tfields: {name: oldName, lastActivityDate: new Date()}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tonUserMenuPin({user})\n\t\t{\n\t\t\tthis.getApplication().pinUser(user);\n\t\t},\n\t\tonUserMenuUnpin()\n\t\t{\n\t\t\tthis.getApplication().unpinUser();\n\t\t},\n\t\tonUserMenuChangeBackground()\n\t\t{\n\t\t\tthis.getApplication().changeBackground();\n\t\t},\n\t\tonUserMenuOpenChat({user})\n\t\t{\n\t\t\tthis.getApplication().openChat(user);\n\t\t},\n\t\tonUserMenuOpenProfile({user})\n\t\t{\n\t\t\tthis.getApplication().openProfile(user);\n\t\t},\n\t\t// Helpers\n\t\tgetLoaderObserver()\n\t\t{\n\t\t\tconst options = {\n\t\t\t\troot: document.querySelector('.bx-im-component-call-right-users'),\n\t\t\t\tthreshold: 0.01\n\t\t\t};\n\n\t\t\tconst callback = (entries, observer) => {\n\t\t\t\tentries.forEach(entry => {\n\t\t\t\t\tif (entry.isIntersecting && entry.intersectionRatio > 0.01)\n\t\t\t\t\t{\n\t\t\t\t\t\tLogger.warn('Conference: UserList: I see loader! Load next page!');\n\t\t\t\t\t\tthis.requestUsers();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t};\n\n\t\t\treturn new IntersectionObserver(callback, options);\n\t\t},\n\t\tuserSortFunction(userA, userB)\n\t\t{\n\t\t\tif (userA === this.userId)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (userB === this.userId)\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tif (this.call.users[userA] && (this.call.users[userA].floorRequestState || this.call.users[userA].screenState))\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (this.call.users[userB] && (this.call.users[userB].floorRequestState || this.call.users[userB].screenState))\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tif (this.call.users[userA] && [ConferenceUserState.Ready, ConferenceUserState.Connected].includes(this.call.users[userA].state))\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif (this.call.users[userB] && [ConferenceUserState.Ready, ConferenceUserState.Connected].includes(this.call.users[userB].state))\n\t\t\t{\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t}\n\t},\n\tdirectives:\n\t{\n\t\t'bx-im-directive-user-list-observer':\n\t\t\t{\n\t\t\t\tinserted(element, bindings, vnode)\n\t\t\t\t{\n\t\t\t\t\tvnode.context.loaderObserver = vnode.context.getLoaderObserver();\n\t\t\t\t\tvnode.context.loaderObserver.observe(element);\n\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tunbind(element, bindings, vnode)\n\t\t\t\t{\n\t\t\t\t\tif (vnode.context.loaderObserver)\n\t\t\t\t\t{\n\t\t\t\t\t\tvnode.context.loaderObserver.unobserve(element);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-user-list\">\n\t\t\t<!-- Loading first page -->\n\t\t\t<div v-if=\"!firstPageLoaded\" class=\"bx-im-component-call-user-list-loader\">\n\t\t\t\t<div class=\"bx-im-component-call-user-list-loader-icon\"></div>\n\t\t\t\t<div class=\"bx-im-component-call-user-list-loader-text\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_LOADING_USERS') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<!-- Loading completed -->\n\t\t\t<template v-else>\n\t\t\t\t<!-- Speakers list section (if broadcast) -->\n\t\t\t\t<template v-if=\"isBroadcast\">\n\t\t\t\t\t<!-- Speakers category title -->\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-category\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-category-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_CATEGORY_PRESENTERS') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-category-counter\">\n\t\t\t\t\t\t\t{{ presentersList.length }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<!-- Speakers list -->\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-items\">\n\t\t\t\t\t\t<template v-for=\"presenter in presentersList\">\n\t\t\t\t\t\t\t<UserListItem\n\t\t\t\t\t\t\t\t@userChangeName=\"onUserChangeName\"\n\t\t\t\t\t\t\t\t@userKick=\"onUserMenuKick\"\n\t\t\t\t\t\t\t\t@userInsertName=\"onUserMenuInsertName\"\n\t\t\t\t\t\t\t\t@userPin=\"onUserMenuPin\"\n\t\t\t\t\t\t\t\t@userUnpin=\"onUserMenuUnpin\"\n\t\t\t\t\t\t\t\t@userChangeBackground=\"onUserMenuChangeBackground\"\n\t\t\t\t\t\t\t\t@userOpenChat=\"onUserMenuOpenChat\"\n\t\t\t\t\t\t\t\t@userOpenProfile=\"onUserMenuOpenProfile\"\n\t\t\t\t\t\t\t\t:userId=\"presenter\"\n\t\t\t\t\t\t\t\t:key=\"presenter\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<!-- Participants list section (if there are any users) -->\n\t\t\t\t<template v-if=\"usersList.length > 0\">\n\t\t\t\t\t<!-- Show participants category title if broadcast -->\n\t\t\t\t\t<div v-if=\"isBroadcast\" class=\"bx-im-component-call-user-list-category bx-im-component-call-user-list-category-participants\">\n\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-category-text\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_CATEGORY_PARTICIPANTS') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bx-im-component-call-user-list-category-counter\">\n\t\t\t\t\t\t\t{{ usersList.length }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<!-- Participants list -->\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-items\">\n\t\t\t\t\t\t<template v-for=\"user in usersList\">\n\t\t\t\t\t\t\t<UserListItem\n\t\t\t\t\t\t\t\t@userChangeName=\"onUserChangeName\"\n\t\t\t\t\t\t\t\t@userKick=\"onUserMenuKick\"\n\t\t\t\t\t\t\t\t@userInsertName=\"onUserMenuInsertName\" \n\t\t\t\t\t\t\t\t@userPin=\"onUserMenuPin\"\n\t\t\t\t\t\t\t\t@userUnpin=\"onUserMenuUnpin\"\n\t\t\t\t\t\t\t\t@userChangeBackground=\"onUserMenuChangeBackground\"\n\t\t\t\t\t\t\t\t@userOpenChat=\"onUserMenuOpenChat\"\n\t\t\t\t\t\t\t\t@userOpenProfile=\"onUserMenuOpenProfile\"\n\t\t\t\t\t\t\t\t:userId=\"user\"\n\t\t\t\t\t\t\t\t:key=\"user\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<!-- Next page loader -->\n\t\t\t\t<div v-if=\"hasMoreToLoad\" v-bx-im-directive-user-list-observer class=\"bx-im-component-call-user-list-loader\">\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-loader-icon\"></div>\n\t\t\t\t\t<div class=\"bx-im-component-call-user-list-loader-text\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_LOADING_USERS') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\t\n\t\t</div>\n\t`\n};\n\nexport {UserList};\n","import { Vuex } from \"ui.vue.vuex\";\nimport { MenuManager } from 'main.popup';\nimport { Clipboard } from \"im.lib.clipboard\";\nimport { MessageBox, MessageBoxButtons } from \"ui.dialogs.messagebox\";\n\nconst UserListHeader = {\n\tcomputed:\n\t{\n\t\tuserId()\n\t\t{\n\t\t\treturn this.application.common.userId;\n\t\t},\n\t\tisCurrentUserOwner()\n\t\t{\n\t\t\tif (!this.dialog)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.dialog.ownerId === this.userId;\n\t\t},\n\t\t...Vuex.mapState({\n\t\t\tuser: state => state.users.collection[state.application.common.userId],\n\t\t\tapplication: state => state.application,\n\t\t\tconference: state => state.conference,\n\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId]\n\t\t})\n\t},\n\tmethods:\n\t{\n\t\tonCloseUsers()\n\t\t{\n\t\t\tthis.getApplication().toggleUserList();\n\t\t},\n\t\topenMenu()\n\t\t{\n\t\t\tif (this.menuPopup)\n\t\t\t{\n\t\t\t\tthis.closeMenu();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis.menuPopup = MenuManager.create({\n\t\t\t\tid: 'bx-im-component-call-user-list-header-popup',\n\t\t\t\tclassName: 'bx-conference-user-list-context-menu',\n\t\t\t\tbackground: '#00428F',\n\t\t\t\tcontentBackground: '#00428F',\n\t\t\t\tdarkMode: true,\n\t\t\t\tcontentBorderRadius: '6px',\n\t\t\t\tborderRadius: '6px',\n\t\t\t\tbindElement: this.$refs['user-list-header-menu'],\n\t\t\t\titems: this.getMenuItems(),\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: () => this.menuPopup.destroy(),\n\t\t\t\t\tonPopupDestroy: () => this.menuPopup = null\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.menuPopup.show();\n\t\t},\n\t\tcloseMenu()\n\t\t{\n\t\t\tthis.menuPopup.destroy();\n\t\t\tthis.menuPopup = null;\n\t\t},\n\t\tgetMenuItems()\n\t\t{\n\t\t\tconst items = [{\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_HEADER_MENU_COPY_LINK'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\tthis.onMenuCopyLink();\n\t\t\t\t}\n\t\t\t}];\n\t\t\tif (this.isCurrentUserOwner)\n\t\t\t{\n\t\t\t\titems.push({\n\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USER_LIST_HEADER_MENU_CHANGE_LINK'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.closeMenu();\n\t\t\t\t\t\tthis.onMenuChangeLink();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn items;\n\t\t},\n\t\tonMenuCopyLink()\n\t\t{\n\t\t\tconst publicLink = this.dialog.public.link;\n\t\t\tClipboard.copy(publicLink);\n\n\t\t\tconst notificationText = this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_LINK_COPIED');\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: notificationText,\n\t\t\t\tautoHideDelay: 4000\n\t\t\t})\n\t\t},\n\t\tonMenuChangeLink()\n\t\t{\n\t\t\tconst confirmMessage = this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_CHANGE_LINK_CONFIRM_TEXT');\n\t\t\tthis.changeLinkConfirm = MessageBox.create({\n\t\t\t\tmessage: confirmMessage,\n\t\t\t\tmodal: true,\n\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\tonOk: () => {\n\t\t\t\t\tthis.changeLink();\n\t\t\t\t\tthis.changeLinkConfirm.getPopupWindow().destroy();\n\t\t\t\t},\n\t\t\t\tonCancel: () => {\n\t\t\t\t\tthis.changeLinkConfirm.getPopupWindow().destroy();\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.changeLinkConfirm.show();\n\t\t},\n\t\tchangeLink()\n\t\t{\n\t\t\tthis.getApplication().changeLink().then(() => {\n\t\t\t\tconst notificationText = this.$Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_LINK_CHANGED');\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: notificationText,\n\t\t\t\t\tautoHideDelay: 4000\n\t\t\t\t})\n\t\t\t}).catch(error => {\n\t\t\t\tconsole.error('Conference: change link error', error);\n\t\t\t});\n\t\t},\n\t\tgetApplication()\n\t\t{\n\t\t\treturn this.$Bitrix.Application.get();\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"bx-im-component-call-user-list-header\">\n\t\t\t<div class=\"bx-im-component-call-user-list-header-top-actions\">\n\t\t\t\t<div class=\"bx-im-component-call-user-list-header-left\">\n\t\t\t\t\t<div @click=\"onCloseUsers\" class=\"bx-im-component-call-user-list-header-close\" :title=\"$Bitrix.Loc.getMessage['BX_IM_COMPONENT_CALL_CHAT_CLOSE_TITLE']\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bx-im-component-call-user-list-header-right\">\n\t\t\t\t\t<div @click=\"openMenu\" class=\"bx-im-component-call-user-list-header-more\" ref=\"user-list-header-menu\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"bx-im-component-call-user-list-header-users-summary\">\n\t\t\t\t<div class=\"bx-im-component-call-user-list-header-title\">{{ $Bitrix.Loc.getMessage('BX_IM_COMPONENT_CALL_USERS_LIST_TITLE') }}</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n\nexport {UserListHeader};","/**\n * Bitrix im\n * Pubic conference Vue component\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2021 Bitrix\n */\n\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\n\nimport {BitrixVue} from \"ui.vue\";\nimport {Vuex} from \"ui.vue.vuex\";\nimport {Utils} from \"im.lib.utils\";\nimport { EventType } from 'im.const';\nimport { ConferenceStateType, ConferenceErrorCode, ConferenceRightPanelMode as RightPanelMode } from 'call.const';\nimport { SendMessageHandler, ReadingHandler, ReactionHandler } from \"im.event-handler\";\nimport {ConferenceTextareaHandler} from \"./event-handler/conference-textarea-handler\";\nimport {ConferenceTextareaUploadHandler} from \"./event-handler/conference-textarea-upload-handler\";\nimport {EventEmitter} from \"main.core.events\";\n\n//global components\nimport \"im.component.dialog\";\nimport \"im.component.textarea\";\nimport \"ui.switcher\";\n\n//internal components\nimport {ConferenceSmiles} from './component/conference-smiles';\nimport {CheckDevices} from './component/check-devices';\nimport {Error} from \"./component/error\";\nimport {OrientationDisabled} from \"./component/orientation-disabled\";\nimport {PasswordCheck} from \"./component/password-check\";\nimport {LoadingStatus} from \"./component/loading-status\";\nimport {RequestPermissions} from \"./component/request-permissions\";\nimport {MobileChatButton} from \"./component/mobile-chat-button\";\nimport {ConferenceInfo} from \"./component/conference-info\";\nimport {UserForm} from \"./component/user-form\";\nimport {ChatHeader} from \"./component/chat-header\";\nimport {WaitingForStart} from \"./component/waiting-for-start\";\nimport {UserList} from \"./component/user-list/user-list\";\nimport {UserListHeader} from \"./component/user-list/user-list-header\";\n\n//css\nimport \"./conference-public.css\";\n\n//const\nconst popupModes = Object.freeze({\n\tpreparation: 'preparation'\n});\n\nBitrixVue.component('bx-im-component-conference-public',\n\t{\n\t\tcomponents: {\n\t\t\tError, CheckDevices, OrientationDisabled, PasswordCheck, LoadingStatus,\n\t\t\tRequestPermissions, MobileChatButton, ConferenceInfo, UserForm, ChatHeader, WaitingForStart, UserList, UserListHeader,\n\t\t\tConferenceSmiles\n\t\t},\n\t\tprops: {\n\t\t\tdialogId: { type: String, default: \"0\" }\n\t\t},\n\t\tdata: function()\n\t\t{\n\t\t\treturn {\n\t\t\t\twaitingForStart: false,\n\t\t\t\tpopupMode: popupModes.preparation,\n\t\t\t\tviewPortMetaNode: null,\n\t\t\t\tchatDrag: false,\n\t\t\t\t// in %\n\t\t\t\trightPanelSplitMode: {\n\t\t\t\t\tusersHeight: 50,\n\t\t\t\t\tchatHeight: 50,\n\t\t\t\t\tchatMinHeight: 30,\n\t\t\t\t\tchatMaxHeight: 80\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tcreated()\n\t\t{\n\t\t\tthis.initEventHandlers();\n\n\t\t\tEventEmitter.subscribe(EventType.conference.waitForStart, this.onWaitForStart);\n\t\t\tEventEmitter.subscribe(EventType.conference.hideSmiles, this.onHideSmiles);\n\n\t\t\tif (this.isMobile())\n\t\t\t{\n\t\t\t\tthis.setMobileMeta();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdocument.body.classList.add('bx-im-application-call-desktop-state');\n\t\t\t}\n\n\t\t\tif (!this.isDesktop())\n\t\t\t{\n\t\t\t\twindow.addEventListener('beforeunload', this.onBeforeUnload.bind(this));\n\t\t\t}\n\t\t},\n\t\tmounted()\n\t\t{\n\t\t\tif (!this.isHttps())\n\t\t\t{\n\t\t\t\tthis.getApplication().setError(ConferenceErrorCode.unsafeConnection);\n\t\t\t}\n\n\t\t\tif (!this.passwordChecked)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventType.conference.setPasswordFocus);\n\t\t\t}\n\t\t},\n\t\tbeforeDestroy()\n\t\t{\n\t\t\tthis.destroyHandlers();\n\n\t\t\tEventEmitter.unsubscribe(EventType.conference.waitForStart, this.onWaitForStart);\n\t\t\tEventEmitter.unsubscribe(EventType.conference.hideSmiles, this.onHideSmiles);\n\n\t\t\tclearInterval(this.durationInterval);\n\t\t},\n\t\tcomputed:\n\t\t\t{\n\t\t\t\tEventType: () => EventType,\n\t\t\t\tRightPanelMode: () => RightPanelMode,\n\t\t\t\tuserId()\n\t\t\t\t{\n\t\t\t\t\treturn this.application.common.userId;\n\t\t\t\t},\n\t\t\t\tdialogInited()\n\t\t\t\t{\n\t\t\t\t\tif (this.dialog)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this.dialog.init;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tconferenceStarted()\n\t\t\t\t{\n\t\t\t\t\treturn this.conference.common.conferenceStarted;\n\t\t\t\t},\n\t\t\t\thasErrorInCall()\n\t\t\t\t{\n\t\t\t\t\treturn this.conference.common.hasErrorInCall;\n\t\t\t\t},\n\t\t\t\tuserInited()\n\t\t\t\t{\n\t\t\t\t\treturn this.conference.common.inited;\n\t\t\t\t},\n\t\t\t\tuserHasRealName()\n\t\t\t\t{\n\t\t\t\t\tif (this.user)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this.user.name !== this.localize['BX_IM_COMPONENT_CALL_DEFAULT_USER_NAME'];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\trightPanelMode()\n\t\t\t\t{\n\t\t\t\t\treturn this.conference.common.rightPanelMode;\n\t\t\t\t},\n\t\t\t\tuserListClasses()\n\t\t\t\t{\n\t\t\t\t\tconst result = [];\n\t\t\t\t\tif (this.rightPanelMode === 'split')\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push('bx-im-component-call-right-top');\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.rightPanelMode === 'users')\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push('bx-im-component-call-right-full');\n\t\t\t\t\t}\n\n\t\t\t\t\treturn result;\n\t\t\t\t},\n\t\t\t\tuserListStyles()\n\t\t\t\t{\n\t\t\t\t\tif (this.rightPanelMode !== RightPanelMode.split)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn {};\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\theight: `${this.rightPanelSplitMode.usersHeight}%`\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tchatClasses()\n\t\t\t\t{\n\t\t\t\t\tconst result = [];\n\t\t\t\t\tif (this.rightPanelMode === 'split')\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push('bx-im-component-call-right-bottom');\n\t\t\t\t\t}\n\t\t\t\t\telse if (this.rightPanelMode === 'chat')\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push('bx-im-component-call-right-full');\n\t\t\t\t\t}\n\n\t\t\t\t\treturn result;\n\t\t\t\t},\n\t\t\t\tchatStyles()\n\t\t\t\t{\n\t\t\t\t\tif (this.rightPanelMode !== RightPanelMode.split)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn {};\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\theight: `${this.rightPanelSplitMode.chatHeight}%`\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tisChatShowed()\n\t\t\t\t{\n\t\t\t\t\treturn this.conference.common.showChat;\n\t\t\t\t},\n\t\t\t\tisPreparationStep()\n\t\t\t\t{\n\t\t\t\t\treturn this.conference.common.state === ConferenceStateType.preparation;\n\t\t\t\t},\n\t\t\t\tisBroadcast()\n\t\t\t\t{\n\t\t\t\t\treturn this.conference.common.isBroadcast;\n\t\t\t\t},\n\t\t\t\tpresentersList()\n\t\t\t\t{\n\t\t\t\t\treturn this.conference.common.presenters;\n\t\t\t\t},\n\t\t\t\tisCurrentUserPresenter()\n\t\t\t\t{\n\t\t\t\t\treturn this.presentersList.includes(this.userId);\n\t\t\t\t},\n\t\t\t\terrorCode()\n\t\t\t\t{\n\t\t\t\t\treturn this.conference.common.error;\n\t\t\t\t},\n\t\t\t\tpasswordChecked()\n\t\t\t\t{\n\t\t\t\t\treturn this.conference.common.passChecked;\n\t\t\t\t},\n\t\t\t\tpermissionsRequested()\n\t\t\t\t{\n\t\t\t\t\treturn this.conference.common.permissionsRequested;\n\t\t\t\t},\n\t\t\t\tcallContainerClasses()\n\t\t\t\t{\n\t\t\t\t\treturn [this.conference.common.callEnded ? 'with-clouds': ''];\n\t\t\t\t},\n\t\t\t\twrapClasses()\n\t\t\t\t{\n\t\t\t\t\tconst classes = ['bx-im-component-call-wrap'];\n\n\t\t\t\t\tif (this.isMobile() && this.isBroadcast && !this.isCurrentUserPresenter && this.isPreparationStep)\n\t\t\t\t\t{\n\t\t\t\t\t\tclasses.push('bx-im-component-call-mobile-viewer-mode');\n\t\t\t\t\t}\n\n\t\t\t\t\treturn classes;\n\t\t\t\t},\n\t\t\t\tcallComponentClasses()\n\t\t\t\t{\n\t\t\t\t\treturn ['bx-im-component-call'];\n\t\t\t\t},\n\t\t\t\tchatId()\n\t\t\t\t{\n\t\t\t\t\tif (this.application)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this.application.dialog.chatId;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn 0;\n\t\t\t\t},\n\t\t\t\tlocalize()\n\t\t\t\t{\n\t\t\t\t\treturn BitrixVue.getFilteredPhrases(['BX_IM_COMPONENT_CALL_', 'IM_DIALOG_CLIPBOARD_']);\n\t\t\t\t},\n\t\t\t\t...Vuex.mapState({\n\t\t\t\t\tconference: state => state.conference,\n\t\t\t\t\tapplication: state => state.application,\n\t\t\t\t\tuser: state => state.users.collection[state.application.common.userId],\n\t\t\t\t\tdialog: state => state.dialogues.collection[state.application.dialog.dialogId]\n\t\t\t\t})\n\t\t\t},\n\t\twatch:\n\t\t\t{\n\t\t\t\tisChatShowed(newValue)\n\t\t\t\t{\n\t\t\t\t\tif (this.isMobile())\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (newValue === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollOnStart, {chatId: this.chatId});\n\t\t\t\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\trightPanelMode(newValue)\n\t\t\t\t{\n\t\t\t\t\tif (newValue === RightPanelMode.chat || newValue === RightPanelMode.split)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollOnStart, {chatId: this.chatId});\n\t\t\t\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdialogInited(newValue)\n\t\t\t\t{\n\t\t\t\t\tif (newValue === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getApplication().setDialogInited();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t//to skip request permissions step in desktop\n\t\t\t\tuserInited(newValue)\n\t\t\t\t{\n\t\t\t\t\tif (newValue === true && this.isDesktop() && this.passwordChecked)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\t\tEventEmitter.emit(EventType.conference.requestPermissions);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tuser()\n\t\t\t\t{\n\t\t\t\t\tif (this.user && this.userHasRealName)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getApplication().setUserWasRenamed();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\tmethods:\n\t\t\t{\n\t\t\t\tinitEventHandlers()\n\t\t\t\t{\n\t\t\t\t\tthis.sendMessageHandler = new SendMessageHandler(this.$Bitrix);\n\t\t\t\t\tthis.textareaHandler = new ConferenceTextareaHandler(this.$Bitrix);\n\t\t\t\t\tthis.readingHandler = new ReadingHandler(this.$Bitrix);\n\t\t\t\t\tthis.reactionHandler = new ReactionHandler(this.$Bitrix);\n\t\t\t\t\tthis.textareaUploadHandler = new ConferenceTextareaUploadHandler(this.$Bitrix);\n\t\t\t\t},\n\t\t\t\tdestroyHandlers()\n\t\t\t\t{\n\t\t\t\t\tthis.sendMessageHandler.destroy();\n\t\t\t\t\tthis.textareaHandler.destroy();\n\t\t\t\t\tthis.readingHandler.destroy();\n\t\t\t\t\tthis.reactionHandler.destroy();\n\t\t\t\t\tthis.textareaUploadHandler.destroy();\n\t\t\t\t},\n\t\t\t\tonHideSmiles()\n\t\t\t\t{\n\t\t\t\t\tthis.getApplication().toggleSmiles();\n\t\t\t\t},\n\t\t\t\tonBeforeUnload(event)\n\t\t\t\t{\n\t\t\t\t\tif (!this.getApplication().callView)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.isPreparationStep)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tevent.returnValue = '';\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonSmilesSelectSmile(event)\n\t\t\t\t{\n\t\t\t\t\tEventEmitter.emit(EventType.textarea.insertText, { text: event.text });\n\t\t\t\t},\n\t\t\t\tonSmilesSelectSet()\n\t\t\t\t{\n\t\t\t\t\tEventEmitter.emit(EventType.textarea.setFocus);\n\t\t\t\t},\n\t\t\t\tonWaitForStart()\n\t\t\t\t{\n\t\t\t\t\tthis.waitingForStart = true;\n\t\t\t\t},\n\t\t\t\tonChatStartDrag(event)\n\t\t\t\t{\n\t\t\t\t\tif (this.chatDrag)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.chatDrag = true;\n\n\t\t\t\t\tthis.chatDragStartPoint = event.clientY;\n\t\t\t\t\tthis.chatDragStartHeight = this.rightPanelSplitMode.chatHeight;\n\n\t\t\t\t\tthis.addChatDragEvents();\n\t\t\t\t},\n\t\t\t\tonChatContinueDrag(event)\n\t\t\t\t{\n\t\t\t\t\tif (!this.chatDrag)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.chatDragControlPoint = event.clientY;\n\t\t\t\t\tconst availableHeight = document.body.clientHeight;\n\n\t\t\t\t\tconst maxHeightInPx = availableHeight * (this.rightPanelSplitMode.chatMaxHeight / 100);\n\t\t\t\t\tconst minHeightInPx = availableHeight * (this.rightPanelSplitMode.chatMinHeight / 100)\n\t\t\t\t\tconst startHeightInPx = availableHeight * (this.chatDragStartHeight / 100);\n\t\t\t\t\tconst chatHeightInPx = Math.max(\n\t\t\t\t\t\tMath.min(startHeightInPx + this.chatDragStartPoint - this.chatDragControlPoint, maxHeightInPx),\n\t\t\t\t\t\tminHeightInPx\n\t\t\t\t\t);\n\n\t\t\t\t\tconst chatHeight = (chatHeightInPx / availableHeight) * 100;\n\n\t\t\t\t\tif (this.rightPanelSplitMode.chatHeight !== chatHeight)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.rightPanelSplitMode.chatHeight = chatHeight;\n\t\t\t\t\t\tthis.rightPanelSplitMode.usersHeight = 100 - chatHeight;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonChatStopDrag(event)\n\t\t\t\t{\n\t\t\t\t\tif (!this.chatDrag)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.chatDrag = false;\n\t\t\t\t\tthis.removeChatDragEvents();\n\t\t\t\t\tEventEmitter.emit(EventType.dialog.scrollToBottom, {chatId: this.chatId, force: true});\n\t\t\t\t},\n\t\t\t\taddChatDragEvents()\n\t\t\t\t{\n\t\t\t\t\tdocument.addEventListener('mousemove', this.onChatContinueDrag);\n\t\t\t\t\tdocument.addEventListener('mouseup', this.onChatStopDrag);\n\t\t\t\t\tdocument.addEventListener('mouseleave', this.onChatStopDrag);\n\t\t\t\t},\n\t\t\t\tremoveChatDragEvents()\n\t\t\t\t{\n\t\t\t\t\tdocument.removeEventListener('mousemove', this.onChatContinueDrag);\n\t\t\t\t\tdocument.removeEventListener('mouseup', this.onChatStopDrag);\n\t\t\t\t\tdocument.removeEventListener('mouseleave', this.onChatStopDrag);\n\t\t\t\t},\n\n\t\t\t\tisMobile()\n\t\t\t\t{\n\t\t\t\t\treturn Utils.device.isMobile();\n\t\t\t\t},\n\t\t\t\tisDesktop()\n\t\t\t\t{\n\t\t\t\t\treturn Utils.platform.isBitrixDesktop();\n\t\t\t\t},\n\t\t\t\tsetMobileMeta()\n\t\t\t\t{\n\t\t\t\t\tif (!this.viewPortMetaNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.viewPortMetaNode = document.createElement('meta');\n\t\t\t\t\t\tthis.viewPortMetaNode.setAttribute('name', 'viewport');\n\t\t\t\t\t\tthis.viewPortMetaNode.setAttribute(\"content\", \"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0\");\n\t\t\t\t\t\tdocument.head.appendChild(this.viewPortMetaNode);\n\t\t\t\t\t}\n\n\t\t\t\t\tdocument.body.classList.add('bx-im-application-call-mobile-state');\n\n\t\t\t\t\tif (Utils.browser.isSafariBased())\n\t\t\t\t\t{\n\t\t\t\t\t\tdocument.body.classList.add('bx-im-application-call-mobile-safari-based');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tisHttps()\n\t\t\t\t{\n\t\t\t\t\treturn location.protocol === 'https:';\n\t\t\t\t},\n\t\t\t\tgetUserHash()\n\t\t\t\t{\n\t\t\t\t\treturn this.conference.user.hash;\n\t\t\t\t},\n\t\t\t\tgetApplication()\n\t\t\t\t{\n\t\t\t\t\treturn this.$Bitrix.Application.get();\n\t\t\t\t},\n\t\t\t\t/* endregion 03. Helpers */\n\t\t\t},\n\t\ttemplate: `\n\t<div :class=\"wrapClasses\">\n\t\t<div :class=\"callComponentClasses\">\n\t\t\t<div class=\"bx-im-component-call-left\">\n\t\t\t\t<div id=\"bx-im-component-call-container\" :class=\"callContainerClasses\"></div>\n\t\t\t\t<div v-if=\"isPreparationStep\" class=\"bx-im-component-call-left-preparation\" v-show=\"!hasErrorInCall\">\n\t\t\t\t\t<!-- Step 1: Errors page -->\n\t\t\t\t\t<Error v-if=\"errorCode\"/>\n\t\t\t\t\t<!-- Step 2: Password page -->\n\t\t\t\t\t<PasswordCheck v-else-if=\"!passwordChecked\"/>\n\t\t\t\t\t<template v-else-if=\"!errorCode && passwordChecked\">\n\t\t\t\t\t\t<!-- Step 3: Loading page -->\n\t\t\t\t\t\t<LoadingStatus v-if=\"!userInited\"/>\n\t\t\t\t\t\t<template v-else-if=\"userInited\">\n\t\t\t\t\t\t\t<!-- BROADCAST MODE -->\n\t\t\t\t\t\t  \t<template v-if=\"isBroadcast\">\n\t\t\t\t\t\t  \t\t<template v-if=\"!isDesktop() && !permissionsRequested && isCurrentUserPresenter\">\n\t\t\t\t\t\t\t\t\t<ConferenceInfo/>\n\t\t\t\t\t\t\t\t\t<RequestPermissions>\n\t\t\t\t\t\t\t\t\t\t<template v-if=\"isMobile()\">\n\t\t\t\t\t\t\t\t\t\t\t<MobileChatButton/>\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t</RequestPermissions>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<!-- Skip permissions request for desktop and show button with loader  -->\n\t\t\t\t\t\t\t\t<template v-if=\"isDesktop() && (!permissionsRequested || !user) && isCurrentUserPresenter\">\n\t\t\t\t\t\t\t\t\t<ConferenceInfo/>\n\t\t\t\t\t\t\t\t\t<div class=\"bx-im-component-call-info-separator\"></div>\n\t\t\t\t\t\t\t\t\t<RequestPermissions :skipRequest=\"true\"/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<!-- Step 5: Page with video and mic check -->\n\t\t\t\t\t\t\t\t<div v-if=\"permissionsRequested || !isCurrentUserPresenter\" class=\"bx-im-component-call-video-step-container\">\n\t\t\t\t\t\t\t\t\t<!-- Compact conference info -->\n\t\t\t\t\t\t\t\t\t<ConferenceInfo :compactMode=\"true\"/>\n\t\t\t\t\t\t\t\t\t<CheckDevices v-if=\"isCurrentUserPresenter\" />\n\t\t\t\t\t\t\t\t\t<!-- Bottom part of interface -->\n\t\t\t\t\t\t\t\t\t<div class=\"bx-im-component-call-bottom-container\">\n\t\t\t\t\t\t\t\t\t\t<UserForm v-if=\"!waitingForStart\"/>\n\t\t\t\t\t\t\t\t\t\t<WaitingForStart v-else>\n\t\t\t\t\t\t\t\t\t\t\t<template v-if=\"isMobile()\">\n\t\t\t\t\t\t\t\t\t\t\t\t<MobileChatButton/>\n\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t</WaitingForStart>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<!-- END BROADCAST MODE -->\n\t\t\t\t\t\t\t<!-- NORMAL MODE (NOT BROADCAST) -->\n\t\t\t\t\t\t  \t<template v-else-if=\"!isBroadcast\">\n\t\t\t\t\t\t\t\t<!-- Step 4: Permissions page -->\n\t\t\t\t\t\t\t\t<template v-if=\"!isDesktop() && !permissionsRequested\">\n\t\t\t\t\t\t\t\t\t<ConferenceInfo/>\n\t\t\t\t\t\t\t\t\t<div class=\"bx-im-component-call-info-separator\"></div>\n\t\t\t\t\t\t\t\t\t<RequestPermissions>\n\t\t\t\t\t\t\t\t\t\t<template v-if=\"isMobile()\">\n\t\t\t\t\t\t\t\t\t\t\t<MobileChatButton/>\n\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t</RequestPermissions>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<!-- Skip permissions request for desktop and show button with loader  -->\n\t\t\t\t\t\t\t\t<template v-if=\"isDesktop() && (!permissionsRequested || !user)\">\n\t\t\t\t\t\t\t\t\t<ConferenceInfo/>\n\t\t\t\t\t\t\t\t\t<div class=\"bx-im-component-call-info-separator\"></div>\n\t\t\t\t\t\t\t\t\t<RequestPermissions :skipRequest=\"true\"/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<!-- Step 5: Page with video and mic check -->\n\t\t\t\t\t\t\t\t<div v-else-if=\"permissionsRequested\" class=\"bx-im-component-call-video-step-container\">\n\t\t\t\t\t\t\t\t\t<!-- Compact conference info -->\n\t\t\t\t\t\t\t\t\t<ConferenceInfo :compactMode=\"true\"/>\n\t\t\t\t\t\t\t\t\t<CheckDevices/>\n\t\t\t\t\t\t\t\t\t<!-- Bottom part of interface -->\n\t\t\t\t\t\t\t\t\t<div class=\"bx-im-component-call-bottom-container\">\n\t\t\t\t\t\t\t\t\t\t<UserForm v-if=\"!waitingForStart\"/>\n\t\t\t\t\t\t\t\t\t\t<WaitingForStart v-else>\n\t\t\t\t\t\t\t\t\t\t\t<template v-if=\"isMobile()\">\n\t\t\t\t\t\t\t\t\t\t\t\t<MobileChatButton/>\n\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t</WaitingForStart>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<!-- END NORMAL MODE (NOT BROADCAST) -->\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<template v-if=\"userInited && !errorCode\">\n\t\t\t\t<transition :name=\"!isMobile()? 'videoconf-chat-slide': ''\">\n\t\t\t\t\t<div v-show=\"rightPanelMode !== RightPanelMode.hidden\" class=\"bx-im-component-call-right\">\n\t\t\t\t\t\t<!-- Start users list -->\n\t\t\t\t\t\t<div v-show=\"rightPanelMode === RightPanelMode.split || rightPanelMode === RightPanelMode.users\" :class=\"userListClasses\" :style=\"userListStyles\">\n\t\t\t\t\t\t\t<UserListHeader />\n\t\t\t\t\t\t\t<div class=\"bx-im-component-call-right-users\">\n\t\t\t\t\t\t\t\t<UserList />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<!-- End users list -->\n\t\t\t\t\t\t<!-- Start chat -->\n\t\t\t\t\t\t<div v-show=\"rightPanelMode === RightPanelMode.split || rightPanelMode === RightPanelMode.chat\" :class=\"chatClasses\" :style=\"chatStyles\">\n\t\t\t\t\t\t\t<!-- Resize handler -->\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-if=\"rightPanelMode === RightPanelMode.split\"\n\t\t\t\t\t\t\t\t@mousedown=\"onChatStartDrag\"\n\t\t\t\t\t\t\t\tclass=\"bx-im-component-call-right-bottom-resize-handle\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<ChatHeader />\n\t\t\t\t\t\t\t<div class=\"bx-im-component-call-right-chat\">\n\t\t\t\t\t\t\t\t<bx-im-component-dialog\n\t\t\t\t\t\t\t\t\t:userId=\"userId\"\n\t\t\t\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<keep-alive include=\"bx-im-component-call-smiles\">\n\t\t\t\t\t\t\t\t\t<ConferenceSmiles\n\t\t\t\t\t\t\t\t\t\tv-if=\"conference.common.showSmiles\"\n\t\t\t\t\t\t\t\t\t\t@selectSmile=\"onSmilesSelectSmile\"\n\t\t\t\t\t\t\t\t\t\t@selectSet=\"onSmilesSelectSet\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</keep-alive>\n\t\t\t\t\t\t\t\t<div v-if=\"user\" class=\"bx-im-component-call-textarea\">\n\t\t\t\t\t\t\t\t\t<bx-im-component-textarea\n\t\t\t\t\t\t\t\t\t\t:userId=\"userId\"\n\t\t\t\t\t\t\t\t\t\t:dialogId=\"dialogId\"\n\t\t\t\t\t\t\t\t\t\t:writesEventLetter=\"3\"\n\t\t\t\t\t\t\t\t\t\t:enableFile=\"true\"\n\t\t\t\t\t\t\t\t\t\t:enableEdit=\"true\"\n\t\t\t\t\t\t\t\t\t\t:enableCommand=\"false\"\n\t\t\t\t\t\t\t\t\t\t:enableMention=\"false\"\n\t\t\t\t\t\t\t\t\t\t:autoFocus=\"true\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<!-- End chat -->\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</transition>\n\t\t\t</template>\n\t\t</div>\n\t</div>\n\t`\n\t});\n"],"names":["ConferenceTextareaHandler","$Bitrix","application","Application","get","event","data","appId","toggleSmiles","TextareaHandler","ConferenceTextareaUploadHandler","message","getData","getDiskFolderId","requestDiskFolderId","chatId","then","addMessageWithFile","error","Logger","getChatId","setUploaderCustomHeaders","uploader","addTask","taskId","file","id","fileData","source","fileName","name","generateUniqueName","diskFolderId","previewBlob","senderOptions","customHeaders","getUserHash","controller","store","state","conference","user","hash","TextareaUploadHandler","ConferenceSmiles","methods","onSelectSmile","$emit","onSelectSet","hideSmiles","EventEmitter","emit","EventType","template","MicLevel","props","bars","barDisabledColor","barEnabledColor","watch","localStream","stream","Type","isNil","startAudioCheck","mounted","document","querySelectorAll","computed","localize","BitrixVue","getFilteredPhrases","audioContext","window","AudioContext","webkitAudioContext","analyser","createAnalyser","microphone","createMediaStreamSource","scriptNode","createScriptProcessor","smoothingTimeConstant","fftSize","connect","destination","onaudioprocess","processVolume","arr","Uint8Array","frequencyBinCount","getByteFrequencyData","values","i","length","average","oneBarValue","barsToColor","Math","round","elementsToColor","slice","forEach","elem","style","backgroundColor","CheckDevices","isDestroyed","noVideo","selectedCamera","selectedMic","videoStream","audioStream","videoStreamPromise","audioStreamPromise","showMic","userDisabledCamera","gettingVideo","isFlippedVideo","BX","Call","Hardware","enableMirroring","created","$root","$on","onCameraStateChange","onMicStateChange","stopLocalVideo","stopLocalAudio","cameraId","onCameraSelected","micId","onMicSelected","getApplication","initHardware","getDefaultDevices","MessageBox","show","Loc","getMessage","modal","buttons","MessageBoxButtons","OK","destroyed","noVideoText","cameraVideoClasses","defaultCamera","defaultMicrophone","getLocalVideoStream","updateMediaDevices","getVideoTracks","getSettings","deviceId","setSelectedCamera","warn","getLocalAudioStream","getAudioTracks","setSelectedMic","Promise","resolve","reject","constraints","video","getVideoConstraints","audio","navigator","mediaDevices","getUserMedia","setLocalStream","playLocalVideo","setCameraState","exact","setLocalVideoStream","$refs","volume","srcObject","play","getTracks","track","stop","stopLocalVideoStream","isMobile","Utils","device","videoConstraints","width","ideal","height","components","Error","downloadAppArticleCode","callFeedbackSent","errorCode","common","bitrix24only","ConferenceErrorCode","detectIntranetUser","userLimitReached","kickedFromCall","wrongAlias","conferenceFinished","finished","unsupportedBrowser","missingMicrophone","unsafeConnection","noSignalFromCamera","userLeftCall","showFeedback","callDetails","isExternalUser","isFinishedByOrganizer","currentCall","CallState","Finished","Vuex","mapState","reloadPage","location","reload","redirectToAuthorize","href","origin","pathname","continueAsGuest","Cookie","set","alias","path","getBxLink","getAlias","openHelpArticle","Helper","onFeedbackSent","setTimeout","OrientationDisabled","PasswordCheck","password","checkingPassword","wrongPassword","subscribe","setPasswordFocus","onSetPasswordFocus","beforeDestroy","unsubscribe","conferenceTitle","focus","checkPassword","LoadingStatus","NOT_ALLOWED_ERROR_CODE","RequestPermissions","skipRequest","type","Boolean","required","requestPermissions","onRequestPermissions","callView","blockButtons","tryGetUserMedia","params","videoParams","setPermissionsRequestedFlag","devices","showButtons","unblockButtons","showMessageBox","getCurrentDeviceList","$nextTick","$store","dispatch","status","text","MobileChatButton","dialogCounter","dialog","counter","dialogues","collection","dialogId","openChat","toggleChat","ConferenceInfo","compactMode","conferenceDuration","durationInterval","conferenceStarted","updateConferenceDuration","setInterval","clearInterval","conferenceStartDate","userId","isBroadcast","presentersList","presenters","presentersInfo","getters","formattedPresentersList","presentersCount","prefix","map","join","isCurrentUserPresenter","includes","conferenceStatusText","conferenceStatusClasses","containerClasses","newValue","startDate","currentDate","Date","durationInSeconds","floor","minutes","seconds","UserForm","userNewName","userHasRealName","intranetAvatarStyle","extranet","avatar","backgroundImage","logoutLink","publicLink","bitrix_sessid","link","videoModeButtonClasses","classes","hardwareInited","push","audioModeButtonClasses","users","startConference","startCall","joinConference","setNewName","waitForStart","setUserReadyToJoin","setJoinType","viewerMode","joinCall","preCall","uuid","joinAsViewer","renameGuest","isDesktop","platform","isBitrixDesktop","ChatHeader","desktop","Desktop","showTotalCounter","getApiVersion","isWindows","messageCount","formattedCounter","onCloseChat","onTotalCounterClick","opener","BXDesktopWindow","ExecuteCommand","WaitingForStart","userCounter","UserListItem","Number","renameMode","newName","renameRequested","menuId","onlineStates","ConferenceUserState","Ready","Connected","currentUser","chatOwner","ownerId","isCurrentUserOwner","isCurrentUserExternal","isGuestWithDefaultName","guestDefaultName","userCallStatus","isUserInCall","userInCallCount","usersInCall","Object","call","filter","isUserPresenter","formattedSubtitle","subtitle","role","isMenuNeeded","getMenuItems","menuItems","items","onclick","closeMenu","onRenameStart","externalAuthId","cameraState","pinned","avatarWrapClasses","talking","avatarClasses","avatarStyle","color","avatarInnerText","UtilsV2","getFirstLetters","toUpperCase","isCallStatusPanelNeeded","ConferenceStateType","callMenuIconClasses","callLeftIconClasses","floorRequestState","screenState","callCenterIconClasses","microphoneState","callRightIconClasses","bodyClasses","itemClasses","openMenu","menuPopup","existingMenu","MenuManager","getMenuById","destroy","create","className","background","contentBackground","darkMode","contentBorderRadius","borderRadius","bindElement","events","onPopupClose","onPopupDestroy","select","onRenameKeyDown","keyCode","changeName","trim","onFocus","userRenameFocus","onBlur","userRenameBlur","UserList","usersPerPage","firstPageLoaded","pagesLoaded","hasMoreToLoad","rename","requestUsers","firstPage","loaderObserver","usersList","sort","userSortFunction","rightPanelMode","RestClient","callMethod","result","usersIds","ex","onUserMenuKick","showUserKickConfirm","userKickConfirm","close","confirmMessage","OK_CANCEL","onOk","kickUser","onCancel","user_id","chat_id","onUserMenuInsertName","RightPanelMode","hidden","textarea","insertText","onUserChangeName","method","oldName","fields","lastActivityDate","setUserWasRenamed","onUserMenuPin","pinUser","onUserMenuUnpin","unpinUser","onUserMenuChangeBackground","changeBackground","onUserMenuOpenChat","onUserMenuOpenProfile","openProfile","getLoaderObserver","options","root","querySelector","threshold","callback","entries","observer","entry","isIntersecting","intersectionRatio","IntersectionObserver","userA","userB","directives","inserted","element","bindings","vnode","context","observe","unbind","unobserve","UserListHeader","onCloseUsers","toggleUserList","onMenuCopyLink","onMenuChangeLink","Clipboard","copy","notificationText","UI","Notification","Center","notify","content","autoHideDelay","changeLinkConfirm","changeLink","getPopupWindow","console","popupModes","freeze","preparation","component","String","waitingForStart","popupMode","viewPortMetaNode","chatDrag","rightPanelSplitMode","usersHeight","chatHeight","chatMinHeight","chatMaxHeight","initEventHandlers","onWaitForStart","onHideSmiles","setMobileMeta","body","classList","add","addEventListener","onBeforeUnload","bind","isHttps","setError","passwordChecked","destroyHandlers","dialogInited","init","hasErrorInCall","userInited","inited","userListClasses","userListStyles","split","chatClasses","chatStyles","isChatShowed","showChat","isPreparationStep","passChecked","permissionsRequested","callContainerClasses","callEnded","wrapClasses","callComponentClasses","scrollOnStart","setFocus","chat","setDialogInited","sendMessageHandler","SendMessageHandler","textareaHandler","readingHandler","ReadingHandler","reactionHandler","ReactionHandler","textareaUploadHandler","preventDefault","returnValue","onSmilesSelectSmile","onSmilesSelectSet","onChatStartDrag","chatDragStartPoint","clientY","chatDragStartHeight","addChatDragEvents","onChatContinueDrag","chatDragControlPoint","availableHeight","clientHeight","maxHeightInPx","minHeightInPx","startHeightInPx","chatHeightInPx","max","min","onChatStopDrag","removeChatDragEvents","scrollToBottom","force","removeEventListener","createElement","setAttribute","head","appendChild","browser","isSafariBased","protocol"],"mappings":"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"}