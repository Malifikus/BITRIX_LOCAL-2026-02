{"version":3,"file":"registry.bundle.js","sources":["../src/application.js","../src/messages.js","../src/dialogues.js","../src/users.js","../src/files.js","../src/recent.js","../src/notifications.js"],"sourcesContent":["/**\n * Bitrix Messenger\n * Application model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {DeviceType, DeviceOrientation} from 'im.const';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\n\nexport class ApplicationModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'application';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcommon:\n\t\t\t{\n\t\t\t\thost: this.getVariable('common.host', location.protocol+'//'+location.host),\n\t\t\t\tsiteId: this.getVariable('common.siteId', 'default'),\n\t\t\t\tuserId: this.getVariable('common.userId', 0),\n\t\t\t\tlanguageId: this.getVariable('common.languageId', 'en'),\n\t\t\t},\n\t\t\tdialog:\n\t\t\t{\n\t\t\t\tdialogId: this.getVariable('dialog.dialogId', '0'),\n\t\t\t\tchatId: this.getVariable('dialog.chatId', 0),\n\t\t\t\tdiskFolderId: this.getVariable('dialog.diskFolderId', 0),\n\t\t\t\tmessageLimit: this.getVariable('dialog.messageLimit', 20),\n\t\t\t\tenableReadMessages: this.getVariable('dialog.enableReadMessages', true),\n\t\t\t\tmessageExtraCount: 0,\n\t\t\t},\n\t\t\tdisk:\n\t\t\t{\n\t\t\t\tenabled: false,\n\t\t\t\tmaxFileSize: 5242880,\n\t\t\t},\n\t\t\tcall:\n\t\t\t{\n\t\t\t\tserverEnabled: false,\n\t\t\t\tmaxParticipants: 24,\n\t\t\t},\n\t\t\tmobile:\n\t\t\t{\n\t\t\t\tkeyboardShow: false,\n\t\t\t},\n\t\t\tdevice:\n\t\t\t{\n\t\t\t\ttype: this.getVariable('device.type', DeviceType.desktop),\n\t\t\t\torientation: this.getVariable('device.orientation', DeviceOrientation.portrait),\n\t\t\t},\n\t\t\toptions:\n\t\t\t{\n\t\t\t\tquoteEnable: this.getVariable('options.quoteEnable', true),\n\t\t\t\tquoteFromRight: this.getVariable('options.quoteFromRight', true),\n\t\t\t\tautoplayVideo: this.getVariable('options.autoplayVideo', true),\n\t\t\t\tdarkBackground: this.getVariable('options.darkBackground', false),\n\t\t\t\tshowSmiles: false\n\t\t\t},\n\t\t\terror:\n\t\t\t{\n\t\t\t\tactive: false,\n\t\t\t\tcode: '',\n\t\t\t\tdescription: '',\n\t\t\t},\n\t\t}\n\t}\n\n\tgetStateSaveException()\n\t{\n\t\treturn Object.assign({\n\t\t\tcommon: this.getVariable('saveException.common', null),\n\t\t\tdialog: this.getVariable('saveException.dialog', null),\n\t\t\tmobile: this.getVariable('saveException.mobile', null),\n\t\t\tdevice: this.getVariable('saveException.device', null),\n\t\t\terror: this.getVariable('saveException.error', null)\n\t\t});\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('set', this.validate(payload));\n\t\t\t},\n\t\t\tshowSmiles: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('showSmiles')\n\t\t\t},\n\t\t\thideSmiles: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('hideSmiles');\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tlet hasChange = false;\n\t\t\t\tfor (let group in payload)\n\t\t\t\t{\n\t\t\t\t\tif (!payload.hasOwnProperty(group))\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let field in payload[group])\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!payload[group].hasOwnProperty(field))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate[group][field] = payload[group][field];\n\t\t\t\t\t\thasChange = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (hasChange && this.isSaveNeeded(payload))\n\t\t\t\t{\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tincreaseDialogExtraCount(state, payload = {})\n\t\t\t{\n\t\t\t\tlet {count = 1} = payload;\n\n\t\t\t\tstate.dialog.messageExtraCount += count;\n\t\t\t},\n\t\t\tdecreaseDialogExtraCount(state, payload = {})\n\t\t\t{\n\t\t\t\tlet {count = 1} = payload;\n\n\t\t\t\tlet newCounter = state.dialog.messageExtraCount - count;\n\t\t\t\tif (newCounter <= 0)\n\t\t\t\t{\n\t\t\t\t\tnewCounter = 0;\n\t\t\t\t}\n\n\t\t\t\tstate.dialog.messageExtraCount = newCounter;\n\t\t\t},\n\t\t\tclearDialogExtraCount(state)\n\t\t\t{\n\t\t\t\tstate.dialog.messageExtraCount = 0;\n\t\t\t},\n\t\t\tshowSmiles(state)\n\t\t\t{\n\t\t\t\tstate.options.showSmiles = true;\n\t\t\t},\n\t\t\thideSmiles(state)\n\t\t\t{\n\t\t\t\tstate.options.showSmiles = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tvalidate(fields)\n\t{\n\t\tconst result = {};\n\n\t\tif (typeof fields.common === 'object' && fields.common)\n\t\t{\n\t\t\tresult.common = {};\n\n\t\t\tif (typeof fields.common.userId === 'number')\n\t\t\t{\n\t\t\t\tresult.common.userId = fields.common.userId;\n\t\t\t}\n\n\t\t\tif (typeof fields.common.languageId === 'string')\n\t\t\t{\n\t\t\t\tresult.common.languageId = fields.common.languageId;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.dialog === 'object' && fields.dialog)\n\t\t{\n\t\t\tresult.dialog = {};\n\n\t\t\tif (typeof fields.dialog.dialogId === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.dialogId = fields.dialog.dialogId.toString();\n\t\t\t\tresult.dialog.chatId = 0;\n\t\t\t}\n\t\t\telse if (typeof fields.dialog.dialogId === 'string')\n\t\t\t{\n\t\t\t\tresult.dialog.dialogId = fields.dialog.dialogId;\n\n\t\t\t\tif (typeof fields.dialog.chatId !== 'number')\n\t\t\t\t{\n\t\t\t\t\tlet chatId = fields.dialog.dialogId;\n\t\t\t\t\tif (chatId.startsWith('chat'))\n\t\t\t\t\t{\n\t\t\t\t\t\tchatId = fields.dialog.dialogId.substr(4);\n\t\t\t\t\t}\n\n\t\t\t\t\tchatId = parseInt(chatId);\n\n\t\t\t\t\tresult.dialog.chatId = !isNaN(chatId)? chatId: 0;\n\t\t\t\t\tfields.dialog.chatId = result.dialog.chatId;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.chatId === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.chatId = fields.dialog.chatId;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.diskFolderId === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.diskFolderId = fields.dialog.diskFolderId;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.messageLimit === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.messageLimit = fields.dialog.messageLimit;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.messageExtraCount === 'number')\n\t\t\t{\n\t\t\t\tresult.dialog.messageExtraCount = fields.dialog.messageExtraCount;\n\t\t\t}\n\n\t\t\tif (typeof fields.dialog.enableReadMessages === 'boolean')\n\t\t\t{\n\t\t\t\tresult.dialog.enableReadMessages = fields.dialog.enableReadMessages;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.disk === 'object' && fields.disk)\n\t\t{\n\t\t\tresult.disk = {};\n\n\t\t\tif (typeof fields.disk.enabled === 'boolean')\n\t\t\t{\n\t\t\t\tresult.disk.enabled = fields.disk.enabled;\n\t\t\t}\n\n\t\t\tif (typeof fields.disk.maxFileSize === 'number')\n\t\t\t{\n\t\t\t\tresult.disk.maxFileSize = fields.disk.maxFileSize;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.call === 'object' && fields.call)\n\t\t{\n\t\t\tresult.call = {};\n\n\t\t\tif (typeof fields.call.serverEnabled === 'boolean')\n\t\t\t{\n\t\t\t\tresult.call.serverEnabled = fields.call.serverEnabled;\n\t\t\t}\n\n\t\t\tif (typeof fields.call.maxParticipants === 'number')\n\t\t\t{\n\t\t\t\tresult.call.maxParticipants = fields.call.maxParticipants;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.mobile === 'object' && fields.mobile)\n\t\t{\n\t\t\tresult.mobile = {};\n\n\t\t\tif (typeof fields.mobile.keyboardShow === 'boolean')\n\t\t\t{\n\t\t\t\tresult.mobile.keyboardShow = fields.mobile.keyboardShow;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.device === 'object' && fields.device)\n\t\t{\n\t\t\tresult.device = {};\n\n\t\t\tif (typeof fields.device.type === 'string' && typeof DeviceType[fields.device.type] !== 'undefined')\n\t\t\t{\n\t\t\t\tresult.device.type = fields.device.type;\n\t\t\t}\n\n\t\t\tif (typeof fields.device.orientation === 'string' && typeof DeviceOrientation[fields.device.orientation] !== 'undefined')\n\t\t\t{\n\t\t\t\tresult.device.orientation = fields.device.orientation;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.error === 'object' && fields.error)\n\t\t{\n\t\t\tif (typeof fields.error.active === 'boolean')\n\t\t\t{\n\t\t\t\tresult.error = {\n\t\t\t\t\tactive: fields.error.active,\n\t\t\t\t\tcode: fields.error.code.toString() || '',\n\t\t\t\t\tdescription: fields.error.description.toString() || '',\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n}","/**\n * Bitrix Messenger\n * Messages model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\n\nimport {Vue} from 'ui.vue';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport { MutationType, RecentSection as Section, StorageLimit, EventType } from 'im.const';\nimport {Utils} from \"im.lib.utils\";\nimport { Logger } from \"im.lib.logger\";\n\nimport {EventEmitter} from 'main.core.events';\n\nconst IntersectionType = {\n\tempty: 'empty',\n\tequal: 'equal',\n\tnone: 'none',\n\tfound: 'found',\n\tfoundReverse: 'foundReverse',\n};\n\nexport class MessagesModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'messages';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcreated: 0,\n\t\t\tcollection: {},\n\t\t\tmutationType: {},\n\t\t\tsaveMessageList: {},\n\t\t\tsaveFileList: {},\n\t\t\tsaveUserList: {},\n\t\t\thost: this.getVariable('host', location.protocol+'//'+location.host),\n\t\t}\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\ttemplateId: 0,\n\t\t\ttemplateType: 'message',\n\t\t\tplaceholderType: 0,\n\n\t\t\tid: 0,\n\t\t\tchatId: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttext: \"\",\n\t\t\ttextConverted: \"\",\n\t\t\tparams: {\n\t\t\t\tTYPE : 'default',\n\t\t\t\tCOMPONENT_ID : 'bx-im-view-message',\n\t\t\t},\n\n\t\t\tpush: false,\n\t\t\tunread: false,\n\t\t\tsending: false,\n\t\t\terror: false,\n\t\t\tretry: false,\n\t\t\tblink: false,\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\n\t\t\tgetMutationType: state => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.mutationType[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn {initialType: MutationType.none, appliedType: MutationType.none};\n\t\t\t\t}\n\n\t\t\t\treturn state.mutationType[chatId];\n\t\t\t},\n\t\t\tgetLastId: state => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId] || state.collection[chatId].length <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tlet lastId = 0;\n\n\t\t\t\tfor (let i = 0; i < state.collection[chatId].length; i++)\n\t\t\t\t{\n\t\t\t\t\tlet element = state.collection[chatId][i];\n\t\t\t\t\tif (\n\t\t\t\t\t\telement.push\n\t\t\t\t\t\t|| element.sending\n\t\t\t\t\t\t|| element.id.toString().startsWith('temporary')\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (lastId < element.id)\n\t\t\t\t\t{\n\t\t\t\t\t\tlastId = element.id;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn lastId? lastId: null;\n\t\t\t},\n\t\t\tgetMessage: state => (chatId, messageId) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId] || state.collection[chatId].length <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tfor (let index = state.collection[chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tif (state.collection[chatId][index].id === messageId)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn state.collection[chatId][index];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\tget: state => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.collection[chatId] || state.collection[chatId].length <= 0)\n\t\t\t\t{\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[chatId];\n\t\t\t},\n\t\t\tgetBlank: state => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState();\n\t\t\t},\n\t\t\tgetSaveFileList: state => params =>\n\t\t\t{\n\t\t\t\treturn state.saveFileList;\n\t\t\t},\n\t\t\tgetSaveUserList: state => params =>\n\t\t\t{\n\t\t\t\treturn state.saveUserList;\n\t\t\t},\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tadd: (store, payload) =>\n\t\t\t{\n\t\t\t\tlet result = this.validate(Object.assign({}, payload));\n\t\t\t\tresult.params = Object.assign({}, this.getElementState().params, result.params);\n\t\t\t\tif (payload.id)\n\t\t\t\t{\n\t\t\t\t\tif (store.state.collection[payload.chatId])\n\t\t\t\t\t{\n\t\t\t\t\t\tconst countMessages = store.state.collection[payload.chatId].length-1;\n\t\t\t\t\t\tfor (let index = countMessages; index >= 0; index--)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst message = store.state.collection[payload.chatId][index];\n\t\t\t\t\t\t\tif (message.templateId === payload.id)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tresult.id = payload.id;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult.id = 'temporary' + (new Date).getTime() + store.state.created;\n\t\t\t\t}\n\t\t\t\tresult.templateId = result.id;\n\t\t\t\tresult.unread = false;\n\n\t\t\t\tstore.commit('add', Object.assign({}, this.getElementState(), result));\n\n\t\t\t\tif (payload.sending !== false)\n\t\t\t\t{\n\t\t\t\t\tstore.dispatch('actionStart', {\n\t\t\t\t\t\tid: result.id,\n\t\t\t\t\t\tchatId: result.chatId,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn result.id;\n\t\t\t},\n\t\t\tactionStart: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (/^\\d+$/.test(payload.id))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tVue.nextTick(() => {\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\tfields : {sending: true}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tactionError: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (/^\\d+$/.test(payload.id))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tVue.nextTick(() => {\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\tfields : {sending: false, error: true, retry: payload.retry !== false}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tactionFinish: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (/^\\d+$/.test(payload.id))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tVue.nextTick(() => {\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\tfields : {sending: false, error: false, retry: false}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(message => this.prepareMessage(message, {host: store.state.host}));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.prepareMessage(payload, {host: store.state.host});\n\t\t\t\t\t(payload = []).push(result);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType : MutationType.set,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\n\t\t\t\treturn 'set is done';\n\t\t\t},\n\t\t\taddPlaceholders: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload.placeholders instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload.placeholders = payload.placeholders.map(message => this.prepareMessage(message, { host: store.state.host }));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst insertType = payload.requestMode === 'history'? MutationType.setBefore : MutationType.setAfter;\n\t\t\t\tif (insertType === MutationType.setBefore)\n\t\t\t\t{\n\t\t\t\t\tpayload.placeholders = payload.placeholders.reverse();\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType,\n\t\t\t\t\tdata : payload.placeholders\n\t\t\t\t});\n\n\t\t\t\treturn payload.placeholders[0].id;\n\t\t\t},\n\t\t\tclearPlaceholders: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearPlaceholders', payload);\n\t\t\t},\n\t\t\tupdatePlaceholders: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload.data instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload.data = payload.data.map(message => this.prepareMessage(message, { host: store.state.host }));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updatePlaceholders', payload);\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tsetAfter: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(message => this.prepareMessage(message));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.prepareMessage(payload);\n\t\t\t\t\t(payload = []).push(result);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType : MutationType.setAfter,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetBefore: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(message => this.prepareMessage(message));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.prepareMessage(payload);\n\t\t\t\t\t(payload = []).push(result);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType : MutationType.setBefore,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (/^\\d+$/.test(payload.id))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\t\t\t\tif (/^\\d+$/.test(payload.chatId))\n\t\t\t\t{\n\t\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('initCollection', {chatId: payload.chatId});\n\n\t\t\t\tif (!store.state.collection[payload.chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet index = store.state.collection[payload.chatId].findIndex(el => el.id === payload.id);\n\t\t\t\tif (index < 0)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet result = this.validate(Object.assign({}, payload.fields));\n\n\t\t\t\tif (result.params)\n\t\t\t\t{\n\t\t\t\t\tresult.params = Object.assign(\n\t\t\t\t\t\t{},\n\t\t\t\t\t\tthis.getElementState().params,\n\t\t\t\t\t\tstore.state.collection[payload.chatId][index].params,\n\t\t\t\t\t\tresult.params\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid : payload.id,\n\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\tindex : index,\n\t\t\t\t\tfields : result\n\t\t\t\t});\n\n\t\t\t\tif (payload.fields.blink)\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\t\tfields : {blink: false}\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 1000);\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (!(payload.id instanceof Array))\n\t\t\t\t{\n\t\t\t\t\tpayload.id = [payload.id];\n\t\t\t\t}\n\n\t\t\t\tpayload.id = payload.id.map(id => {\n\t\t\t\t\tif (/^\\d+$/.test(id))\n\t\t\t\t\t{\n\t\t\t\t\t\tid = parseInt(id);\n\t\t\t\t\t}\n\t\t\t\t\treturn id;\n\t\t\t\t});\n\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\telements : payload.id,\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tclear: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tif (payload.keepPlaceholders)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('clearMessages', {\n\t\t\t\t\t\tchatId : payload.chatId\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstore.commit('clear', {\n\t\t\t\t\t\tchatId : payload.chatId\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tapplyMutationType: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tstore.commit('applyMutationType', {\n\t\t\t\t\tchatId : payload.chatId\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\treadMessages: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.readId = parseInt(payload.readId) || 0;\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tif (typeof store.state.collection[payload.chatId] === 'undefined')\n\t\t\t\t{\n\t\t\t\t\treturn {count: 0}\n\t\t\t\t}\n\n\t\t\t\tlet count = 0;\n\t\t\t\tfor (let index = store.state.collection[payload.chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tlet element = store.state.collection[payload.chatId][index];\n\t\t\t\t\tif (!element.unread)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (payload.readId === 0 || element.id <= payload.readId)\n\t\t\t\t\t{\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstore.commit('readMessages', {\n\t\t\t\t\tchatId: payload.chatId,\n\t\t\t\t\treadId: payload.readId,\n\t\t\t\t});\n\n\t\t\t\treturn {count};\n\t\t\t},\n\t\t\tunreadMessages: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.unreadId = parseInt(payload.unreadId) || 0;\n\t\t\t\tpayload.chatId = parseInt(payload.chatId);\n\n\t\t\t\tif (typeof store.state.collection[payload.chatId] === 'undefined' || !payload.unreadId)\n\t\t\t\t{\n\t\t\t\t\treturn {count: 0}\n\t\t\t\t}\n\n\t\t\t\tlet count = 0;\n\t\t\t\tfor (let index = store.state.collection[payload.chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tlet element = store.state.collection[payload.chatId][index];\n\t\t\t\t\tif (element.unread)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (element.id >= payload.unreadId)\n\t\t\t\t\t{\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstore.commit('unreadMessages', {\n\t\t\t\t\tchatId: payload.chatId,\n\t\t\t\t\tunreadId: payload.unreadId,\n\t\t\t\t});\n\n\t\t\t\treturn {count};\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tinitCollection: (state, payload) =>\n\t\t\t{\n\t\t\t\treturn this.initCollection(state, payload);\n\t\t\t},\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tstate.collection[payload.chatId].push(payload);\n\t\t\t\tstate.saveMessageList[payload.chatId].push(payload.id);\n\n\t\t\t\tstate.created += 1;\n\n\t\t\t\tstate.collection[payload.chatId].sort((a, b) => a.id - b.id);\n\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t\tLogger.warn('Messages model: saving state after add');\n\t\t\t},\n\t\t\tclearPlaceholders: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (!state.collection[payload.chatId])\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstate.collection[payload.chatId] = state.collection[payload.chatId].filter(element => {\n\t\t\t\t\treturn !element.id.toString().startsWith('placeholder');\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdatePlaceholders: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst firstPlaceholderId = `placeholder${payload.firstMessage}`;\n\t\t\t\tconst firstPlaceholderIndex = state.collection[payload.chatId].findIndex((message) => {\n\t\t\t\t\treturn message.id === firstPlaceholderId;\n\t\t\t\t});\n\t\t\t\t// Logger.warn('firstPlaceholderIndex', firstPlaceholderIndex);\n\t\t\t\tif (firstPlaceholderIndex >= 0)\n\t\t\t\t{\n\t\t\t\t\t// Logger.warn('before delete', state.collection[payload.chatId].length, [...state.collection[payload.chatId]]);\n\t\t\t\t\tstate.collection[payload.chatId].splice(firstPlaceholderIndex, payload.amount);\n\t\t\t\t\t// Logger.warn('after delete', state.collection[payload.chatId].length, [...state.collection[payload.chatId]]);\n\t\t\t\t\tstate.collection[payload.chatId].splice(firstPlaceholderIndex, 0, ...payload.data);\n\t\t\t\t\t// Logger.warn('after add', state.collection[payload.chatId].length, [...state.collection[payload.chatId]]);\n\t\t\t\t}\n\n\t\t\t\tstate.collection[payload.chatId].sort((a, b) => a.id - b.id);\n\t\t\t\tLogger.warn('Messages model: saving state after updating placeholders');\n\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t},\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tLogger.warn('Messages model: set mutation', payload);\n\t\t\t\tlet chats = [];\n\t\t\t\tlet chatsSave = [];\n\t\t\t\tlet isPush = false;\n\n\t\t\t\tpayload.data = MessagesModel.getPayloadWithTempMessages(state, payload);\n\n\t\t\t\tconst initialType = payload.insertType;\n\n\t\t\t\tif (payload.insertType === MutationType.set)\n\t\t\t\t{\n\t\t\t\t\tpayload.insertType = MutationType.setAfter;\n\n\t\t\t\t\tlet elements = {};\n\t\t\t\t\tpayload.data.forEach(element => {\n\t\t\t\t\t\tif (!elements[element.chatId])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\telements[element.chatId] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telements[element.chatId].push(element.id);\n\t\t\t\t\t});\n\n\t\t\t\t\tfor (let chatId in elements)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!elements.hasOwnProperty(chatId))\n\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\tthis.initCollection(state, {chatId});\n\t\t\t\t\t\tLogger.warn('Messages model: messages before adding from request - ', state.collection[chatId].length);\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tstate.saveMessageList[chatId].length > elements[chatId].length\n\t\t\t\t\t\t\t|| elements[chatId].length < StorageLimit.messages\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.collection[chatId] = state.collection[chatId].filter(element => elements[chatId].includes(element.id));\n\t\t\t\t\t\t\tstate.saveMessageList[chatId] = state.saveMessageList[chatId].filter(id => elements[chatId].includes(id));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tLogger.warn('Messages model: cache length', state.saveMessageList[chatId].length);\n\t\t\t\t\t\tlet intersection = this.manageCacheBeforeSet(\n\t\t\t\t\t\t\t[...state.saveMessageList[chatId].reverse()],\n\t\t\t\t\t\t\telements[chatId]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tLogger.warn('Messages model: set intersection with cache', intersection);\n\n\t\t\t\t\t\tif (intersection.type === IntersectionType.none)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (intersection.foundElements.length > 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstate.collection[chatId] = state.collection[chatId].filter(element => !intersection.foundElements.includes(element.id));\n\t\t\t\t\t\t\t\tstate.saveMessageList[chatId] = state.saveMessageList[chatId].filter(id => !intersection.foundElements.includes(id));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tLogger.warn('Messages model: no intersection - removing cache');\n\t\t\t\t\t\t\tthis.removeIntersectionCacheElements = state.collection[chatId].map(element => element.id);\n\n\t\t\t\t\t\t\tstate.collection[chatId] = state.collection[chatId].filter(element => !this.removeIntersectionCacheElements.includes(element.id));\n\t\t\t\t\t\t\tstate.saveMessageList[chatId] = state.saveMessageList[chatId].filter(id => !this.removeIntersectionCacheElements.includes(id));\n\t\t\t\t\t\t\tthis.removeIntersectionCacheElements = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (intersection.type === IntersectionType.foundReverse)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tLogger.warn('Messages model: found reverse intersection');\n\t\t\t\t\t\t\tpayload.insertType = MutationType.setBefore;\n\t\t\t\t\t\t\tpayload.data = payload.data.reverse();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tLogger.warn('Messages model: adding messages to model', payload.data);\n\t\t\t\tfor (let element of payload.data)\n\t\t\t\t{\n\t\t\t\t\tthis.initCollection(state, {chatId: element.chatId});\n\n\t\t\t\t\tlet index = state.collection[element.chatId].findIndex(localMessage => {\n\t\t\t\t\t\tif (MessagesModel.isTemporaryMessage(localMessage))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn localMessage.templateId === element.templateId;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn localMessage.id === element.id;\n\t\t\t\t\t});\n\t\t\t\t\tif (index > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.chatId][index] = Object.assign(\n\t\t\t\t\t\t\tstate.collection[element.chatId][index],\n\t\t\t\t\t\t\telement\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\telse if (payload.insertType === MutationType.setBefore)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.chatId].unshift(element);\n\t\t\t\t\t}\n\t\t\t\t\telse if (payload.insertType === MutationType.setAfter)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.chatId].push(element);\n\t\t\t\t\t}\n\n\t\t\t\t\tchats.push(element.chatId);\n\n\t\t\t\t\tif (this.store.getters['dialogues/canSaveChat'] && this.store.getters['dialogues/canSaveChat'](element.chatId))\n\t\t\t\t\t{\n\t\t\t\t\t\tchatsSave.push(element.chatId);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tchats = [...new Set(chats)];\n\t\t\t\tchatsSave = [...new Set(chatsSave)];\n\n\t\t\t\tisPush = payload.data.every(element => element.push === true);\n\t\t\t\tLogger.warn('Is it fake push message?', isPush);\n\t\t\t\tchats.forEach(chatId => {\n\t\t\t\t\tstate.collection[chatId].sort((a, b) => a.id - b.id);\n\n\t\t\t\t\tif (!isPush)\n\t\t\t\t\t{\n\t\t\t\t\t\t//send event that messages are ready and we can start reading etc\n\t\t\t\t\t\tLogger.warn('setting messagesSet = true for chatId = ', chatId);\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tEventEmitter.emit(EventType.dialog.messagesSet, {chatId});\n\t\t\t\t\t\t\tEventEmitter.emit(EventType.dialog.readVisibleMessages, {chatId});\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (initialType !== MutationType.setBefore)\n\t\t\t\t{\n\t\t\t\t\tchatsSave.forEach(chatId => {\n\t\t\t\t\t\tLogger.warn('Messages model: saving state after set');\n\t\t\t\t\t\tthis.saveState(state, chatId);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tlet index = -1;\n\t\t\t\tif (typeof payload.index !== 'undefined' && state.collection[payload.chatId][payload.index])\n\t\t\t\t{\n\t\t\t\t\tindex = payload.index;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tindex = state.collection[payload.chatId].findIndex(el => el.id === payload.id);\n\t\t\t\t}\n\n\t\t\t\tif (index >= 0)\n\t\t\t\t{\n\t\t\t\t\tlet isSaveState = (\n\t\t\t\t\t\tstate.saveMessageList[payload.chatId].includes(state.collection[payload.chatId][index].id)\n\t\t\t\t\t\t|| payload.fields.id && !payload.fields.id.toString().startsWith('temporary') && state.collection[payload.chatId][index].id.toString().startsWith('temporary')\n\t\t\t\t\t);\n\n\t\t\t\t\tstate.collection[payload.chatId][index] = Object.assign(\n\t\t\t\t\t\tstate.collection[payload.chatId][index],\n\t\t\t\t\t\tpayload.fields\n\t\t\t\t\t);\n\n\t\t\t\t\tif (isSaveState)\n\t\t\t\t\t{\n\t\t\t\t\t\tLogger.warn('Messages model: saving state after update');\n\t\t\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tstate.collection[payload.chatId] = state.collection[payload.chatId].filter(element => !payload.elements.includes(element.id));\n\n\t\t\t\tif (state.saveMessageList[payload.chatId].length > 0)\n\t\t\t\t{\n\t\t\t\t\tfor (let id of payload.elements)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (state.saveMessageList[payload.chatId].includes(id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tLogger.warn('Messages model: saving state after delete');\n\t\t\t\t\t\t\tthis.saveState(state, payload.chatId);\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tclear: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tstate.collection[payload.chatId] = [];\n\t\t\t\tstate.saveMessageList[payload.chatId] = [];\n\t\t\t},\n\t\t\tclearMessages: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tstate.collection[payload.chatId] = state.collection[payload.chatId].filter(element => {\n\t\t\t\t\treturn element.id.toString().startsWith('placeholder');\n\t\t\t\t});\n\t\t\t\tstate.saveMessageList[payload.chatId] = [];\n\t\t\t},\n\t\t\tapplyMutationType: (state, payload) =>\n\t\t\t{\n\t\t\t\tif (typeof state.mutationType[payload.chatId] === 'undefined')\n\t\t\t\t{\n\t\t\t\t\tVue.set(state.mutationType, payload.chatId, {applied: false, initialType: MutationType.none, appliedType: MutationType.none, scrollStickToTop: 0, scrollMessageId: 0});\n\t\t\t\t}\n\n\t\t\t\tstate.mutationType[payload.chatId].applied = true;\n\t\t\t},\n\t\t\treadMessages: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tlet saveNeeded = false;\n\t\t\t\tfor (let index = state.collection[payload.chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tlet element = state.collection[payload.chatId][index];\n\t\t\t\t\tif (!element.unread)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (payload.readId === 0 || element.id <= payload.readId)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[payload.chatId][index] = Object.assign(\n\t\t\t\t\t\t\tstate.collection[payload.chatId][index],\n\t\t\t\t\t\t\t{unread: false}\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsaveNeeded = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (saveNeeded)\n\t\t\t\t{\n\t\t\t\t\tLogger.warn('Messages model: saving state after reading');\n\t\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t\t}\n\t\t\t},\n\t\t\tunreadMessages: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, {chatId: payload.chatId});\n\n\t\t\t\tlet saveNeeded = false;\n\t\t\t\tfor (let index = state.collection[payload.chatId].length-1; index >= 0; index--)\n\t\t\t\t{\n\t\t\t\t\tlet element = state.collection[payload.chatId][index];\n\t\t\t\t\tif (element.unread)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (element.id >= payload.unreadId)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[payload.chatId][index] = Object.assign(\n\t\t\t\t\t\t\tstate.collection[payload.chatId][index],\n\t\t\t\t\t\t\t{unread: true}\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsaveNeeded = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (saveNeeded)\n\t\t\t\t{\n\t\t\t\t\tLogger.warn('Messages model: saving state after unreading');\n\t\t\t\t\tthis.saveState(state, payload.chatId);\n\t\t\t\t\tthis.updateSubordinateStates();\n\t\t\t\t}\n\t\t\t},\n\t\t}\n\t}\n\n\tinitCollection(state, payload)\n\t{\n\t\tif (typeof payload.chatId === 'undefined')\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\ttypeof payload.chatId === 'undefined'\n\t\t\t|| typeof state.collection[payload.chatId] !== 'undefined'\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tVue.set(state.collection, payload.chatId, payload.messages? [].concat(payload.messages): []);\n\t\tVue.set(state.saveMessageList, payload.chatId, []);\n\t\tVue.set(state.saveFileList, payload.chatId, []);\n\t\tVue.set(state.saveUserList, payload.chatId, []);\n\n\t\treturn true;\n\t}\n\n\tprepareMessage(message, options = {})\n\t{\n\t\tlet result = this.validate(Object.assign({}, message), options);\n\n\t\tresult.params = Object.assign({}, this.getElementState().params, result.params);\n\t\tif (!result.templateId)\n\t\t{\n\t\t\tresult.templateId = result.id;\n\t\t}\n\n\t\treturn Object.assign({}, this.getElementState(), result);\n\t}\n\n\tmanageCacheBeforeSet(cache, elements, recursive = false)\n\t{\n\t\tLogger.warn('manageCacheBeforeSet', cache, elements);\n\t\tlet result = {\n\t\t\ttype: IntersectionType.empty,\n\t\t\tfoundElements: [],\n\t\t\tnoneElements: []\n\t\t};\n\n\t\tif (!cache || cache.length <= 0)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tfor (let id of elements)\n\t\t{\n\t\t\tif (cache.includes(id))\n\t\t\t{\n\t\t\t\tif (result.type === IntersectionType.empty)\n\t\t\t\t{\n\t\t\t\t\tresult.type = IntersectionType.found;\n\t\t\t\t}\n\t\t\t\tresult.foundElements.push(id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (result.type === IntersectionType.empty)\n\t\t\t\t{\n\t\t\t\t\tresult.type = IntersectionType.none;\n\t\t\t\t}\n\t\t\t\tresult.noneElements.push(id);\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tresult.type === IntersectionType.found\n\t\t\t&& cache.length === elements.length\n\t\t\t&& result.foundElements.length === elements.length\n\t\t)\n\t\t{\n\t\t\tresult.type = IntersectionType.equal;\n\t\t}\n\t\telse if (\n\t\t\tresult.type === IntersectionType.none\n\t\t\t&& !recursive\n\t\t\t&& result.foundElements.length > 0\n\t\t)\n\t\t{\n\t\t\tlet reverseResult = this.manageCacheBeforeSet(cache.reverse(), elements.reverse(), true);\n\t\t\tif (reverseResult.type === IntersectionType.found)\n\t\t\t{\n\t\t\t\treverseResult.type = IntersectionType.foundReverse;\n\t\t\t\treturn reverseResult;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tupdateSaveLists(state, chatId)\n\t{\n\t\tif (!this.isSaveAvailable())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (\n\t\t\t!chatId\n\t\t\t|| !this.store.getters['dialogues/canSaveChat']\n\t\t\t|| !this.store.getters['dialogues/canSaveChat'](chatId)\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.initCollection(state, {chatId: chatId});\n\n\t\tlet count = 0;\n\t\tlet saveMessageList = [];\n\t\tlet saveFileList = [];\n\t\tlet saveUserList = [];\n\n\t\tlet dialog = this.store.getters['dialogues/getByChatId'](chatId);\n\t\tif (dialog && dialog.type === 'private')\n\t\t{\n\t\t\tsaveUserList.push(parseInt(dialog.dialogId));\n\t\t}\n\n\t\tlet readCounter = 0;\n\t\tfor (let index = state.collection[chatId].length-1; index >= 0; index--)\n\t\t{\n\t\t\tif (state.collection[chatId][index].id.toString().startsWith('temporary'))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (!state.collection[chatId][index].unread)\n\t\t\t{\n\t\t\t\treadCounter++;\n\t\t\t}\n\n\t\t\tif (count >= StorageLimit.messages && readCounter >= 50)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tsaveMessageList.unshift(state.collection[chatId][index].id);\n\n\t\t\tcount++;\n\t\t}\n\n\t\tsaveMessageList = saveMessageList.slice(0, StorageLimit.messages);\n\n\t\tstate.collection[chatId].filter(element => saveMessageList.includes(element.id)).forEach(element =>\n\t\t{\n\t\t\tif (element.authorId > 0)\n\t\t\t{\n\t\t\t\tsaveUserList.push(element.authorId);\n\t\t\t}\n\n\t\t\tif (element.params.FILE_ID instanceof Array)\n\t\t\t{\n\t\t\t\tsaveFileList = element.params.FILE_ID.concat(saveFileList);\n\t\t\t}\n\t\t});\n\n\t\tstate.saveMessageList[chatId] = saveMessageList;\n\t\tstate.saveFileList[chatId] = [...new Set(saveFileList)];\n\t\tstate.saveUserList[chatId] = [...new Set(saveUserList)];\n\n\t\treturn true;\n\t}\n\n\tgetSaveTimeout()\n\t{\n\t\treturn 150;\n\t}\n\n\tsaveState(state, chatId)\n\t{\n\t\tif (!this.updateSaveLists(state, chatId))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tsuper.saveState(() =>\n\t\t{\n\t\t\tlet storedState = {\n\t\t\t\tcollection: {},\n\t\t\t\tsaveMessageList: {},\n\t\t\t\tsaveUserList: {},\n\t\t\t\tsaveFileList: {},\n\t\t\t};\n\n\t\t\tfor (let chatId in state.saveMessageList)\n\t\t\t{\n\t\t\t\tif (!state.saveMessageList.hasOwnProperty(chatId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!state.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!storedState.collection[chatId])\n\t\t\t\t{\n\t\t\t\t\tstoredState.collection[chatId] = [];\n\t\t\t\t}\n\n\t\t\t\tstate.collection[chatId]\n\t\t\t\t\t.filter(element => state.saveMessageList[chatId].includes(element.id))\n\t\t\t\t\t.forEach(element => {\n\t\t\t\t\t\tif (element.templateType !== 'placeholder')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstoredState.collection[chatId].push(element);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\tLogger.warn('Cache after updating', storedState.collection[chatId]);\n\n\t\t\t\tstoredState.saveMessageList[chatId] = state.saveMessageList[chatId];\n\t\t\t\tstoredState.saveFileList[chatId] = state.saveFileList[chatId];\n\t\t\t\tstoredState.saveUserList[chatId] = state.saveUserList[chatId];\n\t\t\t}\n\n\t\t\treturn storedState;\n\t\t});\n\t}\n\n\tupdateSubordinateStates()\n\t{\n\t\tthis.store.dispatch('users/saveState');\n\t\tthis.store.dispatch('files/saveState');\n\t}\n\n\tvalidate(fields, options)\n\t{\n\t\tconst result = {};\n\n\t\tif (typeof fields.id === \"number\")\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\t\telse if (typeof fields.id === \"string\")\n\t\t{\n\t\t\tif (fields.id.startsWith('temporary') || fields.id.startsWith('placeholder') || Utils.types.isUuidV4(fields.id))\n\t\t\t{\n\t\t\t\tresult.id = fields.id;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.id = parseInt(fields.id);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.uuid === \"string\")\n\t\t{\n\t\t\tresult.templateId = fields.uuid;\n\t\t}\n\t\telse if (typeof fields.templateId === \"number\")\n\t\t{\n\t\t\tresult.templateId = fields.templateId;\n\t\t}\n\t\telse if (typeof fields.templateId === \"string\")\n\t\t{\n\t\t\tif (fields.templateId.startsWith('temporary') || Utils.types.isUuidV4(fields.templateId))\n\t\t\t{\n\t\t\t\tresult.templateId = fields.templateId;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.templateId = parseInt(fields.templateId);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.templateType === \"string\")\n\t\t{\n\t\t\tresult.templateType = fields.templateType;\n\t\t}\n\n\t\tif (typeof fields.placeholderType === \"number\")\n\t\t{\n\t\t\tresult.placeholderType = fields.placeholderType;\n\t\t}\n\n\t\tif (typeof fields.chat_id !== 'undefined')\n\t\t{\n\t\t\tfields.chatId = fields.chat_id;\n\t\t}\n\t\tif (typeof fields.chatId === \"number\" || typeof fields.chatId === \"string\")\n\t\t{\n\t\t\tresult.chatId = parseInt(fields.chatId);\n\t\t}\n\t\tif (typeof fields.date !== \"undefined\")\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\t// previous P&P format\n\t\tif (typeof fields.textLegacy === \"string\" || typeof fields.textLegacy === \"number\")\n\t\t{\n\t\t\tif (typeof fields.text === \"string\" || typeof fields.text === \"number\")\n\t\t\t{\n\t\t\t\tresult.text = fields.text.toString();\n\t\t\t}\n\n\t\t\tresult.textConverted = this.convertToHtml({\n\t\t\t\ttext: fields.textLegacy.toString(),\n\t\t\t\tisConverted: true\n\t\t\t});\n\n\t\t\tif (typeof fields.text === \"string\" || typeof fields.text === \"number\")\n\t\t\t{\n\t\t\t\tresult.text = fields.text;\n\t\t\t}\n\t\t}\n\t\telse // modern format\n\t\t{\n\t\t\tif (typeof fields.text_converted !== 'undefined')\n\t\t\t{\n\t\t\t\tfields.textConverted = fields.text_converted;\n\t\t\t}\n\t\t\tif (typeof fields.textConverted === \"string\" || typeof fields.textConverted === \"number\")\n\t\t\t{\n\t\t\t\tresult.textConverted = fields.textConverted.toString();\n\t\t\t}\n\t\t\tif (typeof fields.text === \"string\" || typeof fields.text === \"number\")\n\t\t\t{\n\t\t\t\tresult.text = fields.text.toString();\n\n\t\t\t\tlet isConverted = typeof result.textConverted !== 'undefined';\n\n\t\t\t\tresult.textConverted = this.convertToHtml({\n\t\t\t\t\ttext: isConverted? result.textConverted: result.text,\n\t\t\t\t\tisConverted\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.senderId !== 'undefined')\n\t\t{\n\t\t\tfields.authorId = fields.senderId;\n\t\t}\n\t\telse if (typeof fields.author_id !== 'undefined')\n\t\t{\n\t\t\tfields.authorId = fields.author_id;\n\t\t}\n\t\tif (typeof fields.authorId === \"number\" || typeof fields.authorId === \"string\")\n\t\t{\n\t\t\tif (fields.system === true || fields.system === 'Y')\n\t\t\t{\n\t\t\t\tresult.authorId = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.authorId = parseInt(fields.authorId);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.params === \"object\" && fields.params !== null)\n\t\t{\n\t\t\tconst params = this.validateParams(fields.params, options);\n\t\t\tif (params)\n\t\t\t{\n\t\t\t\tresult.params = params;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.push === \"boolean\")\n\t\t{\n\t\t\tresult.push = fields.push;\n\t\t}\n\n\t\tif (typeof fields.sending === \"boolean\")\n\t\t{\n\t\t\tresult.sending = fields.sending;\n\t\t}\n\n\t\tif (typeof fields.unread === \"boolean\")\n\t\t{\n\t\t\tresult.unread = fields.unread;\n\t\t}\n\n\t\tif (typeof fields.blink === \"boolean\")\n\t\t{\n\t\t\tresult.blink = fields.blink;\n\t\t}\n\n\t\tif (typeof fields.error === \"boolean\" || typeof fields.error === \"string\")\n\t\t{\n\t\t\tresult.error = fields.error;\n\t\t}\n\n\t\tif (typeof fields.retry === \"boolean\")\n\t\t{\n\t\t\tresult.retry = fields.retry;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateParams(params, options)\n\t{\n\t\tconst result = {};\n\t\ttry\n\t\t{\n\t\t\tfor (let field in params)\n\t\t\t{\n\t\t\t\tif (!params.hasOwnProperty(field))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (field === 'COMPONENT_ID')\n\t\t\t\t{\n\t\t\t\t\tif (typeof params[field] === \"string\" && BX.Vue.isComponent(params[field]))\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'LIKE')\n\t\t\t\t{\n\t\t\t\t\tif (params[field] instanceof Array)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult['REACTION'] = {like: params[field].map(element => parseInt(element))};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'CHAT_LAST_DATE')\n\t\t\t\t{\n\t\t\t\t\tresult[field] = Utils.date.cast(params[field]);\n\t\t\t\t}\n\t\t\t\telse if (field === 'AVATAR')\n\t\t\t\t{\n\t\t\t\t\tif (params[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field].startsWith('http') ? params[field] : options.host + params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'NAME')\n\t\t\t\t{\n\t\t\t\t\tif (params[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'LINK_ACTIVE')\n\t\t\t\t{\n\t\t\t\t\tif (params[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field].map(function(userId) {\n\t\t\t\t\t\t\treturn parseInt(userId)\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'ATTACH')\n\t\t\t\t{\n\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcatch (e) {}\n\n\t\tlet hasResultElements = false;\n\t\tfor (let field in result)\n\t\t{\n\t\t\tif (!result.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\thasResultElements = true;\n\t\t\tbreak\n\t\t}\n\n\t\treturn hasResultElements? result: null;\n\t}\n\n\tconvertToHtml(params = {})\n\t{\n\t\tlet {\n\t\t\tquote = true,\n\t\t\timage = true,\n\t\t\ttext = '',\n\t\t\tisConverted = false,\n\t\t\tenableBigSmile = true\n\t\t} = params;\n\n\t\ttext = text.trim();\n\n\t\tif (!isConverted)\n\t\t{\n\t\t\ttext = text.replace(/&/g, '&amp;').replace(/\"/g, '&quot;').replace(/</g, '&lt;').replace(/>/g, '&gt;');\n\t\t}\n\n\t\tif (text.startsWith('/me'))\n\t\t{\n\t\t\ttext = `<i>${text.substr(4)}</i>`;\n\t\t}\n\t\telse if (text.startsWith('/loud'))\n\t\t{\n\t\t\ttext = `<b>${text.substr(6)}</b>`;\n\t\t}\n\n\t\tconst quoteSign = \"&gt;&gt;\";\n\t\tif (quote && text.indexOf(quoteSign) >= 0)\n\t\t{\n\t\t\tlet textPrepareFlag = false;\n\t\t\tlet textPrepare = text.split(isConverted? \"<br />\": \"\\n\");\n\t\t\tfor (let i = 0; i < textPrepare.length; i++)\n\t\t\t{\n\t\t\t\tif (textPrepare[i].startsWith(quoteSign))\n\t\t\t\t{\n\t\t\t\t\ttextPrepare[i] = textPrepare[i].replace(quoteSign, '<div class=\"bx-im-message-content-quote\"><div class=\"bx-im-message-content-quote-wrap\">');\n\t\t\t\t\twhile (++i < textPrepare.length && textPrepare[i].startsWith(quoteSign))\n\t\t\t\t\t{\n\t\t\t\t\t\ttextPrepare[i] = textPrepare[i].replace(quoteSign, '');\n\t\t\t\t\t}\n\t\t\t\t\ttextPrepare[i - 1] += '</div></div><br>';\n\t\t\t\t\ttextPrepareFlag = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttext = textPrepare.join(\"<br />\");\n\t\t}\n\n\t\ttext = text.replace(/\\n/gi, '<br />');\n\n\t\ttext = text.replace(/\\t/gi, '&nbsp;&nbsp;&nbsp;&nbsp;');\n\n\t\t//text = this.decodeBbCode(text, false, enableBigSmile);\n\t\ttext = Utils.text.decodeBbCode(text, enableBigSmile);\n\n\t\tif (quote)\n\t\t{\n\t\t\ttext = text.replace(/------------------------------------------------------<br \\/>(.*?)\\[(.*?)\\](?: #(?:(?:chat)?\\d+|\\d+:\\d+)\\/\\d+)?<br \\/>(.*?)------------------------------------------------------(<br \\/>)?/g, function (whole, p1, p2, p3, p4, offset) {\n\t\t\t\treturn (offset > 0? '<br>': '') + \"<div class=\\\"bx-im-message-content-quote\\\"><div class=\\\"bx-im-message-content-quote-wrap\\\"><div class=\\\"bx-im-message-content-quote-name\\\"><span class=\\\"bx-im-message-content-quote-name-text\\\">\" + p1 + \"</span><span class=\\\"bx-im-message-content-quote-name-time\\\">\" + p2 + \"</span></div>\" + p3 + \"</div></div><br />\";\n\t\t\t});\n\t\t\ttext = text.replace(/------------------------------------------------------<br \\/>(.*?)------------------------------------------------------(<br \\/>)?/g, function (whole, p1, p2, p3, offset) {\n\t\t\t\treturn (offset > 0? '<br>': '') + \"<div class=\\\"bx-im-message-content-quote\\\"><div class=\\\"bx-im-message-content-quote-wrap\\\">\" + p1 + \"</div></div><br />\";\n\t\t\t});\n\t\t}\n\n\t\tif (image)\n\t\t{\n\t\t\tlet changed = false;\n\t\t\ttext = text.replace(/<a(.*?)>(http[s]{0,1}:\\/\\/.*?)<\\/a>/gi, function(whole, aInner, text, offset)\n\t\t\t{\n\t\t\t\tif(!text.match(/(\\.(jpg|jpeg|png|gif|webp)\\?|\\.(jpg|jpeg|png|gif|webp)$)/i) || text.indexOf(\"/docs/pub/\") > 0 || text.indexOf(\"logout=yes\") > 0)\n\t\t\t\t{\n\t\t\t\t\treturn whole;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tchanged = true;\n\t\t\t\t\treturn (offset > 0? '<br />':'')+'<a' +aInner+ ' target=\"_blank\" class=\"bx-im-element-file-image\"><img src=\"'+text+'\" class=\"bx-im-element-file-image-source-text\" onerror=\"BX.Messenger.Model.MessagesModel.hideErrorImage(this)\"></a></span>';\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (changed)\n\t\t\t{\n\t\t\t\ttext = text.replace(/<\\/span>(\\n?)<br(\\s\\/?)>/gi, '</span>').replace(/<br(\\s\\/?)>(\\n?)<br(\\s\\/?)>(\\n?)<span/gi, '<br /><span');\n\t\t\t}\n\t\t}\n\n\t\tif (enableBigSmile)\n\t\t{\n\t\t\ttext = text.replace(\n\t\t\t\t/^(\\s*<img\\s+src=[^>]+?data-code=[^>]+?data-definition=\"UHD\"[^>]+?style=\"width:)(\\d+)(px[^>]+?height:)(\\d+)(px[^>]+?class=\"bx-smile\"\\s*\\/?>\\s*)$/,\n\t\t\t\tfunction doubleSmileSize(match, start, width, middle, height, end) {\n\t\t\t\t\treturn start + (parseInt(width, 10) * 1.7) + middle + (parseInt(height, 10) * 1.7) + end;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tif (text.substr(-6) == '<br />')\n\t\t{\n\t\t\ttext = text.substr(0, text.length - 6);\n\t\t}\n\t\ttext = text.replace(/<br><br \\/>/gi, '<br />');\n\t\ttext = text.replace(/<br \\/><br>/gi, '<br />');\n\n\t\treturn text;\n\t};\n\n\tdecodeBbCode(text, textOnly = false, enableBigSmile = true)\n\t{\n\t\treturn MessagesModel.decodeBbCode({text, textOnly, enableBigSmile})\n\t}\n\n\tdecodeAttach(item)\n\t{\n\t\tif (Array.isArray(item))\n\t\t{\n\t\t\titem.forEach(arrayElement => {\n\t\t\t\tarrayElement = this.decodeAttach(arrayElement);\n\t\t\t});\n\t\t}\n\t\telse if (typeof item === 'object' && item !== null)\n\t\t{\n\t\t\tfor (const prop in item)\n\t\t\t{\n\t\t\t\tif (item.hasOwnProperty(prop))\n\t\t\t\t{\n\t\t\t\t\titem[prop] = this.decodeAttach(item[prop]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (typeof item === 'string')\n\t\t\t{\n\t\t\t\titem = Utils.text.htmlspecialcharsback(item);\n\t\t\t}\n\t\t}\n\n\t\treturn item;\n\t}\n\n\tstatic decodeBbCode(params = {})\n\t{\n\t\tlet {text, textOnly = false, enableBigSmile = true} = params;\n\n\t\tlet putReplacement = [];\n\t\ttext = text.replace(/\\[PUT(?:=(.+?))?\\](.+?)?\\[\\/PUT\\]/gi, function(whole)\n\t\t{\n\t\t\tvar id = putReplacement.length;\n\t\t\tputReplacement.push(whole);\n\t\t\treturn '####REPLACEMENT_PUT_'+id+'####';\n\t\t});\n\n\t\tlet sendReplacement = [];\n\t\ttext = text.replace(/\\[SEND(?:=(.+?))?\\](.+?)?\\[\\/SEND\\]/gi, function(whole)\n\t\t{\n\t\t\tvar id = sendReplacement.length;\n\t\t\tsendReplacement.push(whole);\n\t\t\treturn '####REPLACEMENT_SEND_'+id+'####';\n\t\t});\n\n\t\tlet codeReplacement = [];\n\t\ttext = text.replace(/\\[CODE\\]\\n?(.*?)\\[\\/CODE\\]/sig, function(whole, text) {\n\t\t\tlet id = codeReplacement.length;\n\t\t\tcodeReplacement.push(text);\n\t\t\treturn '####REPLACEMENT_CODE_'+id+'####';\n\t\t});\n\n\t\ttext = text.replace(/\\[url=([^\\]]+)\\](.*?)\\[\\/url\\]/gis, function(whole, link, text)\n\t\t{\n\t\t\tlet tag = document.createElement('a');\n\t\t\ttag.href = Utils.text.htmlspecialcharsback(link);\n\t\t\ttag.target = '_blank';\n\t\t\ttag.text = Utils.text.htmlspecialcharsback(text);\n\n\t\t\tlet allowList = [\n\t\t\t\t\"http:\",\n\t\t\t\t\"https:\",\n\t\t\t\t\"ftp:\",\n\t\t\t\t\"file:\",\n\t\t\t\t\"tel:\",\n\t\t\t\t\"callto:\",\n\t\t\t\t\"mailto:\",\n\t\t\t\t\"skype:\",\n\t\t\t\t\"viber:\",\n\t\t\t];\n\t\t\tif (allowList.indexOf(tag.protocol) <= -1)\n\t\t\t{\n\t\t\t\treturn whole;\n\t\t\t}\n\n\t\t\treturn tag.outerHTML;\n\t\t});\n\n\t\ttext = text.replace(/\\[url\\]([^\\]]+)\\[\\/url\\]/gis, function(whole, link)\n\t\t{\n\t\t\tlink = Utils.text.htmlspecialcharsback(link);\n\n\t\t\tlet tag = document.createElement('a');\n\t\t\ttag.href = link;\n\t\t\ttag.target = '_blank';\n\t\t\ttag.text = link;\n\n\t\t\tlet allowList = [\n\t\t\t\t\"http:\",\n\t\t\t\t\"https:\",\n\t\t\t\t\"ftp:\",\n\t\t\t\t\"file:\",\n\t\t\t\t\"tel:\",\n\t\t\t\t\"callto:\",\n\t\t\t\t\"mailto:\",\n\t\t\t\t\"skype:\",\n\t\t\t\t\"viber:\",\n\t\t\t];\n\t\t\tif (allowList.indexOf(tag.protocol) <= -1)\n\t\t\t{\n\t\t\t\treturn whole;\n\t\t\t}\n\n\t\t\treturn tag.outerHTML;\n\t\t});\n\n\t\ttext = text.replace(/\\[LIKE\\]/gi, '<span class=\"bx-smile bx-im-smile-like\"></span>');\n\t\ttext = text.replace(/\\[DISLIKE\\]/gi, '<span class=\"bx-smile bx-im-smile-dislike\"></span>');\n\n\t\ttext = text.replace(/\\[BR\\]/gi, '<br/>');\n\t\ttext = text.replace(/\\[([buis])\\](.*?)\\[(\\/[buis])\\]/gi, (whole, open, inner, close) => '<'+open+'>'+inner+'<'+close+'>'); // TODO tag USER\n\n\t\t// this code needs to be ported to im/install/js/im/view/message/body/src/body.js:229\n\t\ttext = text.replace(/\\[CHAT=(imol\\|)?([0-9]{1,})\\](.*?)\\[\\/CHAT\\]/gi, (whole, openlines, chatId, inner) => openlines? inner: '<span class=\"bx-im-mention\" data-type=\"CHAT\" data-value=\"chat'+chatId+'\">'+inner+'</span>'); // TODO tag CHAT\n\n\t\tif (false && Utils.device.isMobile())\n\t\t{\n\t\t\tlet replacements = [];\n\t\t\ttext = text.replace(/\\[CALL(?:=(.+?))?\\](.+?)?\\[\\/CALL\\]/gi, (whole, number, text) => {\n\t\t\t\tlet index = replacements.length;\n\t\t\t\treplacements.push({number, text});\n\t\t\t\treturn `####REPLACEMENT_MARK_${index}####`;\n\t\t\t});\n\n\t\t\ttext = text.replace(/[+]{0,1}(?:[-\\/. ()\\[\\]~;#,]*[0-9]){10,}[^\\n\\r<][-\\/. ()\\[\\]~;#,0-9^]*/g, (number) => {\n\t\t\t\tlet pureNumber = number.replace(/\\D/g, '');\n\t\t\t\treturn `[CALL=${pureNumber}]${number}[/CALL]`;\n\t\t\t});\n\n\t\t\treplacements.forEach((item, index) => {\n\t\t\t\ttext = text.replace(`####REPLACEMENT_MARK_${index}####`, `[CALL=${item.number}]${item.text}[/CALL]`)\n\t\t\t});\n\t\t}\n\n\t\ttext = text.replace(/\\[CALL(?:=(.+?))?\\](.+?)?\\[\\/CALL\\]/gi, (whole, number, text) => '<span class=\"bx-im-mention\" data-type=\"CALL\" data-value=\"'+Utils.text.htmlspecialchars(number)+'\">'+text+'</span>'); // TODO tag CHAT\n\n\t\ttext = text.replace(/\\[PCH=([0-9]{1,})\\](.*?)\\[\\/PCH\\]/gi, (whole, historyId, text) => text); // TODO tag PCH\n\n\t\tlet textElementSize = 0;\n\t\tif (enableBigSmile)\n\t\t{\n\t\t\ttextElementSize = text.replace(/\\[icon\\=([^\\]]*)\\]/gi, '').trim().length;\n\t\t}\n\n\t\ttext = text.replace(/\\[icon\\=([^\\]]*)\\]/gi, (whole) =>\n\t\t{\n\t\t\tlet url = whole.match(/icon\\=(\\S+[^\\s.,> )\\];\\'\\\"!?])/i);\n\t\t\tif (url && url[1])\n\t\t\t{\n\t\t\t\turl = url[1];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tlet attrs = {'src': url, 'border': 0};\n\n\t\t\tlet size = whole.match(/size\\=(\\d+)/i);\n\t\t\tif (size && size[1])\n\t\t\t{\n\t\t\t\tattrs['width'] = size[1];\n\t\t\t\tattrs['height'] = size[1];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tlet width = whole.match(/width\\=(\\d+)/i);\n\t\t\t\tif (width && width[1])\n\t\t\t\t{\n\t\t\t\t\tattrs['width'] = width[1];\n\t\t\t\t}\n\n\t\t\t\tlet height = whole.match(/height\\=(\\d+)/i);\n\t\t\t\tif (height && height[1])\n\t\t\t\t{\n\t\t\t\t\tattrs['height'] = height[1];\n\t\t\t\t}\n\n\t\t\t\tif (attrs['width'] && !attrs['height'])\n\t\t\t\t{\n\t\t\t\t\tattrs['height'] = attrs['width'];\n\t\t\t\t}\n\t\t\t\telse if (attrs['height'] && !attrs['width'])\n\t\t\t\t{\n\t\t\t\t\tattrs['width'] = attrs['height'];\n\t\t\t\t}\n\t\t\t\telse if (attrs['height'] && attrs['width'])\n\t\t\t\t{}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tattrs['width'] = 20;\n\t\t\t\t\tattrs['height'] = 20;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tattrs['width'] = attrs['width']>100? 100: attrs['width'];\n\t\t\tattrs['height'] = attrs['height']>100? 100: attrs['height'];\n\n\t\t\tif (enableBigSmile && textElementSize === 0 && attrs['width'] === attrs['height'] && attrs['width'] === 20)\n\t\t\t{\n\t\t\t\tattrs['width'] = 40;\n\t\t\t\tattrs['height'] = 40;\n\t\t\t}\n\n\t\t\tlet title = whole.match(/title\\=(.*[^\\s\\]])/i);\n\t\t\tif (title && title[1])\n\t\t\t{\n\t\t\t\ttitle = title[1];\n\t\t\t\tif (title.indexOf('width=') > -1)\n\t\t\t\t{\n\t\t\t\t\ttitle = title.substr(0, title.indexOf('width='))\n\t\t\t\t}\n\t\t\t\tif (title.indexOf('height=') > -1)\n\t\t\t\t{\n\t\t\t\t\ttitle = title.substr(0, title.indexOf('height='))\n\t\t\t\t}\n\t\t\t\tif (title.indexOf('size=') > -1)\n\t\t\t\t{\n\t\t\t\t\ttitle = title.substr(0, title.indexOf('size='))\n\t\t\t\t}\n\t\t\t\tif (title)\n\t\t\t\t{\n\t\t\t\t\tattrs['title'] = Utils.text.htmlspecialchars(title).trim();\n\t\t\t\t\tattrs['alt'] = attrs['title'];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet attributes = '';\n\t\t\tfor (let name in attrs)\n\t\t\t{\n\t\t\t\tif (attrs.hasOwnProperty(name))\n\t\t\t\t{\n\t\t\t\t\tattributes += name+'=\"'+attrs[name]+'\" ';\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\treturn '<img class=\"bx-smile bx-icon\" '+attributes+'>';\n\t\t});\n\n\t\tsendReplacement.forEach((value, index) => {\n\t\t\ttext = text.replace('####REPLACEMENT_SEND_'+index+'####', value);\n\t\t});\n\n\t\ttext = text.replace(/\\[SEND(?:=(?:.+?))?\\](?:.+?)?\\[\\/SEND]/gi, (match) =>\n\t\t{\n\t\t\treturn match.replace(/\\[SEND(?:=(.+))?\\](.+?)?\\[\\/SEND]/gi, (whole, command, text) =>\n\t\t\t{\n\t\t\t\tlet html = '';\n\n\t\t\t\ttext = text? text: command;\n\t\t\t\tcommand = (command? command: text).replace('<br />', '\\n');\n\n\t\t\t\tif (!textOnly && text)\n\t\t\t\t{\n\t\t\t\t\ttext = text.replace(/<([\\w]+)[^>]*>(.*?)<\\\\1>/i, \"$2\", text);\n\t\t\t\t\ttext = text.replace(/\\[([\\w]+)[^\\]]*\\](.*?)\\[\\/\\1\\]/i, \"$2\", text);\n\n\t\t\t\t\tcommand = command.split('####REPLACEMENT_PUT_').join('####REPLACEMENT_SP_');\n\n\t\t\t\t\thtml = '<!--IM_COMMAND_START-->' +\n\t\t\t\t\t\t'<span class=\"bx-im-message-command-wrap\">'+\n\t\t\t\t\t\t\t'<span class=\"bx-im-message-command\" data-entity=\"send\">'+text+'</span>'+\n\t\t\t\t\t\t\t'<span class=\"bx-im-message-command-data\">'+command+'</span>'+\n\t\t\t\t\t\t'</span>'+\n\t\t\t\t\t'<!--IM_COMMAND_END-->';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\thtml = text;\n\t\t\t\t}\n\n\t\t\t\treturn html;\n\t\t\t});\n\t\t});\n\n\t\tputReplacement.forEach((value, index) => {\n\t\t\ttext = text.replace('####REPLACEMENT_PUT_'+index+'####', value);\n\t\t});\n\n\t\ttext = text.replace(/\\[PUT(?:=(?:.+?))?\\](?:.+?)?\\[\\/PUT]/gi, (match) =>\n\t\t{\n\t\t\treturn match.replace(/\\[PUT(?:=(.+))?\\](.+?)?\\[\\/PUT]/gi, (whole, command, text) =>\n\t\t\t{\n\t\t\t\tlet html = '';\n\n\t\t\t\ttext = text? text: command;\n\t\t\t\tcommand = (command? command: text).replace('<br />', '\\n');\n\n\t\t\t\tif (!textOnly && text)\n\t\t\t\t{\n\t\t\t\t\ttext = text.replace(/<([\\w]+)[^>]*>(.*?)<\\/\\1>/i, \"$2\", text);\n\t\t\t\t\ttext = text.replace(/\\[([\\w]+)[^\\]]*\\](.*?)\\[\\/\\1\\]/i, \"$2\", text);\n\n\t\t\t\t\thtml = '<!--IM_COMMAND_START-->' +\n\t\t\t\t\t\t'<span class=\"bx-im-message-command-wrap\">'+\n\t\t\t\t\t\t\t'<span class=\"bx-im-message-command\" data-entity=\"put\">'+text+'</span>'+\n\t\t\t\t\t\t\t'<span class=\"bx-im-message-command-data\">'+command+'</span>'+\n\t\t\t\t\t\t'</span>'+\n\t\t\t\t\t'<!--IM_COMMAND_END-->';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\thtml = text;\n\t\t\t\t}\n\n\t\t\t\treturn html;\n\t\t\t});\n\t\t});\n\n\t\tcodeReplacement.forEach((code, index) => {\n\t\t\ttext = text.replace('####REPLACEMENT_CODE_'+index+'####',\n\t\t\t\t!textOnly? '<div class=\"bx-im-message-content-code\">'+code+'</div>': code\n\t\t\t)\n\t\t});\n\n\t\tif (sendReplacement.length > 0)\n\t\t{\n\t\t\tdo\n\t\t\t{\n\t\t\t\tsendReplacement.forEach((value, index) => {\n\t\t\t\t\ttext = text.replace('####REPLACEMENT_SEND_'+index+'####', value);\n\t\t\t\t});\n\t\t\t}\n\t\t\twhile (text.includes('####REPLACEMENT_SEND_'));\n\t\t}\n\n\t\ttext = text.split('####REPLACEMENT_SP_').join('####REPLACEMENT_PUT_');\n\n\t\tif (putReplacement.length > 0)\n\t\t{\n\t\t\tdo\n\t\t\t{\n\t\t\t\tputReplacement.forEach((value, index) => {\n\t\t\t\t\ttext = text.replace('####REPLACEMENT_PUT_'+index+'####', value);\n\t\t\t\t});\n\t\t\t}\n\t\t\twhile (text.includes('####REPLACEMENT_PUT_'));\n\t\t}\n\n\t\treturn text;\n\t}\n\n\tstatic hideErrorImage(element)\n\t{\n\t\tif (element.parentNode && element.parentNode)\n\t\t{\n\t\t\telement.parentNode.innerHTML = '<a href=\"'+element.src+'\" target=\"_blank\">'+element.src+'</a>';\n\t\t}\n\t\treturn true;\n\t};\n\n\tstatic isTemporaryMessage(element)\n\t{\n\t\treturn element.id\n\t\t\t&& (Utils.types.isUuidV4(element.id) || element.id.toString().startsWith('temporary'));\n\t}\n\n\tstatic getPayloadWithTempMessages(state, payload)\n\t{\n\t\tconst payloadData = [...payload.data];\n\n\t\tif (!Utils.platform.isBitrixMobile())\n\t\t{\n\t\t\treturn payloadData;\n\t\t}\n\n\t\tif (!payload.data || payload.data.length <= 0)\n\t\t{\n\t\t\treturn payloadData;\n\t\t}\n\n\t\t// consider that in the payload we have messages only for one chat, so we get the value from the first message.\n\t\tconst payloadChatId = payload.data[0].chatId;\n\t\tif (!state.collection[payloadChatId])\n\t\t{\n\t\t\treturn payloadData;\n\t\t}\n\n\t\tstate.collection[payloadChatId].forEach(message => {\n\t\t\tif (\n\t\t\t\tMessagesModel.isTemporaryMessage(message)\n\t\t\t\t&& !MessagesModel.existsInPayload(payload, message.templateId)\n\t\t\t\t&& MessagesModel.doesTaskExist(message)\n\t\t\t)\n\t\t\t{\n\t\t\t\tpayloadData.push(message);\n\t\t\t}\n\t\t});\n\n\t\treturn payloadData;\n\t}\n\n\tstatic existsInPayload(payload, templateId)\n\t{\n\t\treturn payload.data.find(payloadMessage => payloadMessage.templateId === templateId);\n\t}\n\n\tstatic doesTaskExist(message)\n\t{\n\t\tif (Array.isArray(message.params.FILE_ID))\n\t\t{\n\t\t\tlet foundUploadTasks = false;\n\t\t\tmessage.params.FILE_ID.forEach(fileId => {\n\t\t\t\tif (!foundUploadTasks)\n\t\t\t\t{\n\t\t\t\t\tfoundUploadTasks = window.imDialogUploadTasks.find(task => task.taskId.split('|')[1] === fileId);\n\t\t\t\t}\n\t\t\t})\n\n\t\t\treturn !!foundUploadTasks;\n\t\t}\n\n\t\tif (message.templateId)\n\t\t{\n\t\t\tconst foundMessageTask = window.imDialogMessagesTasks.find(task => task.taskId.split('|')[1] === message.templateId);\n\n\t\t\treturn !!foundMessageTask;\n\t\t}\n\n\t\treturn false;\n\t}\n}","/**\n * Bitrix Messenger\n * Dialogues model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {Vue} from 'ui.vue';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {StorageLimit} from \"im.const\";\nimport {Utils} from \"im.lib.utils\";\n\nexport class DialoguesModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'dialogues';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\thost: this.getVariable('host', location.protocol+'//'+location.host),\n\t\t\tcollection: {},\n\t\t\tsaveDialogList: [],\n\t\t\tsaveChatList: [],\n\t\t}\n\t}\n\n\tgetStateSaveException()\n\t{\n\t\treturn {\n\t\t\thost: null\n\t\t}\n\t}\n\n\tgetElementStateSaveException()\n\t{\n\t\treturn {\n\t\t\twritingList: null,\n\t\t\tquoteId: null\n\t\t}\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tdialogId: '0',\n\t\t\tchatId: 0,\n\t\t\tcounter: 0,\n\t\t\tuserCounter: 0,\n\t\t\tmessageCount: 0,\n\t\t\tunreadId: 0,\n\t\t\tlastMessageId: 0,\n\t\t\tmanagerList: [],\n\t\t\treadedList: [],\n\t\t\twritingList: [],\n\t\t\tmuteList: [],\n\t\t\ttextareaMessage: \"\",\n\t\t\tquoteId: 0,\n\t\t\teditId: 0,\n\t\t\tinit: false,\n\n\t\t\tname: \"\",\n\t\t\towner: 0,\n\t\t\textranet: false,\n\t\t\tavatar: \"\",\n\t\t\tcolor: \"#17A3EA\",\n\t\t\ttype: \"chat\",\n\t\t\tentityType: \"\",\n\t\t\tentityId: \"\",\n\t\t\tentityData1: \"\",\n\t\t\tentityData2: \"\",\n\t\t\tentityData3: \"\",\n\t\t\tdateCreate: new Date(),\n\t\t\trestrictions: {\n\t\t\t\tavatar: true,\n\t\t\t\textend: true,\n\t\t\t\tleave: true,\n\t\t\t\tleaveOwner: true,\n\t\t\t\trename: true,\n\t\t\t\tsend: true,\n\t\t\t\tuserList: true,\n\t\t\t\tmute: true,\n\t\t\t\tcall: true,\n\t\t\t},\n\t\t\tpublic: {\n\t\t\t\tcode: '',\n\t\t\t\tlink: ''\n\t\t\t}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => dialogId =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId];\n\t\t\t},\n\t\t\tgetByChatId: state => chatId =>\n\t\t\t{\n\t\t\t\tchatId = parseInt(chatId);\n\n\t\t\t\tfor (let dialogId in state.collection)\n\t\t\t\t{\n\t\t\t\t\tif (!state.collection.hasOwnProperty(dialogId))\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (state.collection[dialogId].chatId === chatId)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn state.collection[dialogId];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\tgetBlank: state => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState();\n\t\t\t},\n\t\t\tgetQuoteId: state => dialogId =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].quoteId;\n\t\t\t},\n\t\t\tgetEditId: state => dialogId =>\n\t\t\t{\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[dialogId].editId;\n\t\t\t},\n\t\t\tcanSaveChat: state => chatId =>\n\t\t\t{\n\t\t\t\tif (/^\\d+$/.test(chatId))\n\t\t\t\t{\n\t\t\t\t\tchatId = parseInt(chatId);\n\t\t\t\t}\n\t\t\t\treturn state.saveChatList.includes(parseInt(chatId));\n\t\t\t},\n\t\t\tcanSaveDialog: state => dialogId =>\n\t\t\t{\n\t\t\t\treturn state.saveDialogList.includes(dialogId.toString());\n\t\t\t},\n\t\t\tisPrivateDialog: state => dialogId =>\n\t\t\t{\n\t\t\t\tdialogId = dialogId.toString();\n\t\t\t\treturn state.collection[dialogId.toString()] && state.collection[dialogId].type === 'private';\n\t\t\t},\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(dialog => {\n\t\t\t\t\t\treturn Object.assign(\n\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\tthis.validate(Object.assign({}, dialog), {host: store.state.host}),\n\t\t\t\t\t\t\t{init: true}\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = [];\n\t\t\t\t\tresult.push(Object.assign(\n\t\t\t\t\t\t{},\n\t\t\t\t\t\tthis.validate(Object.assign({}, payload), {host: store.state.host}),\n\t\t\t\t\t\t{init: true}\n\t\t\t\t\t));\n\t\t\t\t\tpayload = result;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', payload);\n\t\t\t},\n\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.dialogId] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.dialogId].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\tfields : this.validate(Object.assign({}, payload.fields), {host: store.state.host})\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload.dialogId);\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\tupdateWriting: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.dialogId] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.dialogId].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet index = store.state.collection[payload.dialogId].writingList.findIndex(el => el.userId === payload.userId);\n\t\t\t\tif (payload.action)\n\t\t\t\t{\n\t\t\t\t\tif (index >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tlet writingList = [].concat(store.state.collection[payload.dialogId].writingList);\n\t\t\t\t\t\twritingList.unshift({\n\t\t\t\t\t\t\tuserId: payload.userId,\n\t\t\t\t\t\t\tuserName: payload.userName,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tactionName: 'updateWriting/1',\n\t\t\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\t\t\tfields : this.validate({writingList}, {host: store.state.host})\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (index >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet writingList = store.state.collection[payload.dialogId].writingList.filter(el => el.userId !== payload.userId);\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tactionName: 'updateWriting/2',\n\t\t\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\t\t\tfields : this.validate({writingList}, {host: store.state.host})\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\n\t\t\tupdateReaded: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.dialogId] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.dialogId].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet readedList = store.state.collection[payload.dialogId].readedList.filter(el => el.userId !== payload.userId);\n\n\t\t\t\tif (payload.action)\n\t\t\t\t{\n\t\t\t\t\treadedList.push({\n\t\t\t\t\t\tuserId: payload.userId,\n\t\t\t\t\t\tuserName: payload.userName || '',\n\t\t\t\t\t\tmessageId: payload.messageId,\n\t\t\t\t\t\tdate: payload.date || (new Date()),\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'updateReaded',\n\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\tfields : this.validate({readedList}, {host: store.state.host})\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t},\n\n\t\t\tincreaseCounter: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.dialogId] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.dialogId].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet counter = store.state.collection[payload.dialogId].counter;\n\t\t\t\tif (counter === 100)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet increasedCounter = counter + payload.count;\n\t\t\t\tif (increasedCounter > 100)\n\t\t\t\t{\n\t\t\t\t\tincreasedCounter = 100;\n\t\t\t\t}\n\n\t\t\t\tconst userId = store.rootState.application?.common.userId;\n\t\t\t\tconst dialogMuted = userId && store.state.collection[payload.dialogId].muteList.includes(userId);\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'increaseCounter',\n\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\tdialogMuted,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tcounter: increasedCounter,\n\t\t\t\t\t\tpreviousCounter: counter\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t},\n\n\t\t\tdecreaseCounter: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.dialogId] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.dialogId].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet counter = store.state.collection[payload.dialogId].counter;\n\t\t\t\tif (counter === 100)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tlet decreasedCounter = counter - payload.count;\n\t\t\t\tif (decreasedCounter < 0)\n\t\t\t\t{\n\t\t\t\t\tdecreasedCounter = 0;\n\t\t\t\t}\n\n\t\t\t\tlet unreadId = payload.unreadId > store.state.collection[payload.dialogId].unreadId? payload.unreadId: store.state.collection[payload.dialogId].unreadId;\n\n\t\t\t\tif (\n\t\t\t\t\tstore.state.collection[payload.dialogId].unreadId !== unreadId\n\t\t\t\t\t|| store.state.collection[payload.dialogId].counter !== decreasedCounter\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tconst previousCounter = store.state.collection[payload.dialogId].counter;\n\t\t\t\t\tif (decreasedCounter === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tunreadId = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst userId = store.rootState.application?.common.userId;\n\t\t\t\t\tconst dialogMuted = userId && store.state.collection[payload.dialogId].muteList.includes(userId);\n\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tactionName: 'decreaseCounter',\n\t\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\t\tdialogMuted,\n\t\t\t\t\t\tfields : {\n\t\t\t\t\t\t\tcounter: decreasedCounter,\n\t\t\t\t\t\t\tpreviousCounter,\n\t\t\t\t\t\t\tunreadId\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t},\n\n\t\t\tincreaseMessageCounter: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.dialogId] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.dialogId].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tconst currentCounter = store.state.collection[payload.dialogId].messageCount;\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tactionName: 'increaseMessageCount',\n\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\tfields : {\n\t\t\t\t\t\tmessageCount: currentCounter + payload.count,\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tsaveDialog: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.dialogId] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.dialogId].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('saveDialog', {\n\t\t\t\t\tdialogId : payload.dialogId,\n\t\t\t\t\tchatId : payload.chatId\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tinitCollection: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\t\t\t},\n\t\t\tsaveDialog: (state, payload) =>\n\t\t\t{\n\t\t\t\t// TODO if payload.dialogId is IMOL, skip update this flag\n\t\t\t\tif (!(payload.chatId > 0 && payload.dialogId.length > 0))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tlet saveDialogList = state.saveDialogList.filter(function(element) {\n\t\t\t\t\treturn element !== payload.dialogId;\n\t\t\t\t});\n\n\t\t\t\tsaveDialogList.unshift(payload.dialogId);\n\n\t\t\t\tsaveDialogList = saveDialogList.slice(0, StorageLimit.dialogues);\n\n\t\t\t\tif (state.saveDialogList.join(',') === saveDialogList.join(','))\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tstate.saveDialogList = saveDialogList;\n\n\n\t\t\t\tlet saveChatList = state.saveChatList.filter(function(element) {\n\t\t\t\t\treturn element !== payload.chatId;\n\t\t\t\t});\n\n\t\t\t\tsaveChatList.unshift(payload.chatId);\n\n\t\t\t\tstate.saveChatList = saveChatList.slice(0, StorageLimit.dialogues);\n\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tfor (let element of payload)\n\t\t\t\t{\n\t\t\t\t\tthis.initCollection(state, {dialogId: element.dialogId});\n\n\t\t\t\t\tstate.collection[element.dialogId] = Object.assign(\n\t\t\t\t\t\tthis.getElementState(),\n\t\t\t\t\t\tstate.collection[element.dialogId],\n\t\t\t\t\t\telement\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// TODO if payload.dialogId is IMOL, skip update cache\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\n\t\t\t\tstate.collection[payload.dialogId] = Object.assign(\n\t\t\t\t\tstate.collection[payload.dialogId],\n\t\t\t\t\tpayload.fields\n\t\t\t\t);\n\n\t\t\t\t// TODO if payload.dialogId is IMOL, skip update cache\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tdelete state.collection[payload.dialogId];\n\n\t\t\t\t// TODO if payload.dialogId is IMOL, skip update cache\n\t\t\t\tthis.saveState(state);\n\t\t\t}\n\t\t};\n\t}\n\n\tinitCollection(state, payload)\n\t{\n\t\tif (typeof state.collection[payload.dialogId] !== 'undefined')\n\t\t{\n\t\t\treturn true\n\t\t}\n\n\t\tVue.set(state.collection, payload.dialogId, this.getElementState());\n\n\t\tif (payload.fields)\n\t\t{\n\t\t\tstate.collection[payload.dialogId] = Object.assign(\n\t\t\t\tstate.collection[payload.dialogId],\n\t\t\t\tthis.validate(Object.assign({}, payload.fields), {host: state.host})\n\t\t\t);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetSaveTimeout()\n\t{\n\t\treturn 100;\n\t}\n\n\tsaveState(state = {})\n\t{\n\t\tif (!this.isSaveAvailable())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tsuper.saveState(() =>\n\t\t{\n\t\t\tlet storedState = {\n\t\t\t\tcollection: {},\n\t\t\t\tsaveDialogList: [].concat(state.saveDialogList),\n\t\t\t\tsaveChatList: [].concat(state.saveChatList),\n\t\t\t};\n\n\t\t\tstate.saveDialogList.forEach(dialogId => {\n\t\t\t\tif (!state.collection[dialogId])\n\t\t\t\t\treturn false;\n\n\t\t\t\tstoredState.collection[dialogId] = Object.assign(\n\t\t\t\t\tthis.getElementState(),\n\t\t\t\t\tthis.cloneState(state.collection[dialogId], this.getElementStateSaveException())\n\t\t\t\t);\n\t\t\t});\n\n\t\t\treturn storedState;\n\t\t});\n\t}\n\n\tvalidate(fields, options = {})\n\t{\n\t\tconst result = {};\n\n\t\toptions.host = options.host || this.getState().host;\n\n\t\tif (typeof fields.dialog_id !== 'undefined')\n\t\t{\n\t\t\tfields.dialogId = fields.dialog_id;\n\t\t}\n\t\tif (typeof fields.dialogId === \"number\" || typeof fields.dialogId === \"string\")\n\t\t{\n\t\t\tresult.dialogId = fields.dialogId.toString();\n\t\t}\n\n\t\tif (typeof fields.chat_id !== 'undefined')\n\t\t{\n\t\t\tfields.chatId = fields.chat_id;\n\t\t}\n\t\telse if (typeof fields.id !== 'undefined')\n\t\t{\n\t\t\tfields.chatId = fields.id;\n\t\t}\n\t\tif (typeof fields.chatId === \"number\" || typeof fields.chatId === \"string\")\n\t\t{\n\t\t\tresult.chatId = parseInt(fields.chatId);\n\t\t}\n\t\tif (typeof fields.quoteId === \"number\")\n\t\t{\n\t\t\tresult.quoteId = parseInt(fields.quoteId);\n\t\t}\n\t\tif (typeof fields.editId === \"number\")\n\t\t{\n\t\t\tresult.editId = parseInt(fields.editId);\n\t\t}\n\n\t\tif (typeof fields.counter === \"number\" || typeof fields.counter === \"string\")\n\t\t{\n\t\t\tresult.counter = parseInt(fields.counter);\n\t\t}\n\n\t\tif (typeof fields.user_counter === \"number\" || typeof fields.user_counter === \"string\")\n\t\t{\n\t\t\tresult.userCounter = parseInt(fields.user_counter);\n\t\t}\n\t\tif (typeof fields.userCounter === \"number\" || typeof fields.userCounter === \"string\")\n\t\t{\n\t\t\tresult.userCounter = parseInt(fields.userCounter);\n\t\t}\n\n\t\tif (typeof fields.message_count === \"number\" || typeof fields.message_count === \"string\")\n\t\t{\n\t\t\tresult.messageCount = parseInt(fields.message_count);\n\t\t}\n\t\tif (typeof fields.messageCount === \"number\" || typeof fields.messageCount === \"string\")\n\t\t{\n\t\t\tresult.messageCount = parseInt(fields.messageCount);\n\t\t}\n\n\t\tif (typeof fields.unread_id !== 'undefined')\n\t\t{\n\t\t\tfields.unreadId = fields.unread_id;\n\t\t}\n\t\tif (typeof fields.unreadId === \"number\" || typeof fields.unreadId === \"string\")\n\t\t{\n\t\t\tresult.unreadId = parseInt(fields.unreadId);\n\t\t}\n\n\t\tif (typeof fields.last_message_id !== 'undefined')\n\t\t{\n\t\t\tfields.lastMessageId = fields.last_message_id;\n\t\t}\n\t\tif (typeof fields.lastMessageId === \"number\" || typeof fields.lastMessageId === \"string\")\n\t\t{\n\t\t\tresult.lastMessageId = parseInt(fields.lastMessageId);\n\t\t}\n\n\t\tif (typeof fields.readed_list !== 'undefined')\n\t\t{\n\t\t\tfields.readedList = fields.readed_list;\n\t\t}\n\t\tif (typeof fields.readedList !== 'undefined')\n\t\t{\n\t\t\tresult.readedList = [];\n\n\t\t\tif (fields.readedList instanceof Array)\n\t\t\t{\n\t\t\t\tfields.readedList.forEach(element =>\n\t\t\t\t{\n\t\t\t\t\tlet record = {};\n\t\t\t\t\tif (typeof element.user_id !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\telement.userId = element.user_id;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof element.user_name !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\telement.userName = element.user_name;\n\t\t\t\t\t}\n\t\t\t\t\tif (typeof element.message_id !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\telement.messageId = element.message_id;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!element.userId || !element.userName || !element.messageId)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\trecord.userId = parseInt(element.userId);\n\t\t\t\t\trecord.userName = element.userName.toString();\n\t\t\t\t\trecord.messageId = parseInt(element.messageId);\n\n\t\t\t\t\trecord.date = Utils.date.cast(element.date);\n\n\t\t\t\t\tresult.readedList.push(record);\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.writing_list !== 'undefined')\n\t\t{\n\t\t\tfields.writingList = fields.writing_list;\n\t\t}\n\t\tif (typeof fields.writingList !== 'undefined')\n\t\t{\n\t\t\tresult.writingList = [];\n\n\t\t\tif (fields.writingList instanceof Array)\n\t\t\t{\n\t\t\t\tfields.writingList.forEach(element =>\n\t\t\t\t{\n\t\t\t\t\tlet record = {};\n\n\t\t\t\t\tif (!element.userId)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\trecord.userId = parseInt(element.userId);\n\t\t\t\t\trecord.userName = Utils.text.htmlspecialcharsback(element.userName);\n\n\t\t\t\t\tresult.writingList.push(record);\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.manager_list !== 'undefined')\n\t\t{\n\t\t\tfields.managerList = fields.manager_list;\n\t\t}\n\t\tif (typeof fields.managerList !== 'undefined')\n\t\t{\n\t\t\tresult.managerList = [];\n\n\t\t\tif (fields.managerList instanceof Array)\n\t\t\t{\n\t\t\t\tfields.managerList.forEach(userId =>\n\t\t\t\t{\n\t\t\t\t\tuserId = parseInt(userId);\n\t\t\t\t\tif (userId > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.managerList.push(userId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.mute_list !== 'undefined')\n\t\t{\n\t\t\tfields.muteList = fields.mute_list;\n\t\t}\n\t\tif (typeof fields.muteList !== 'undefined')\n\t\t{\n\t\t\tresult.muteList = [];\n\n\t\t\tif (fields.muteList instanceof Array)\n\t\t\t{\n\t\t\t\tfields.muteList.forEach(userId =>\n\t\t\t\t{\n\t\t\t\t\tuserId = parseInt(userId);\n\t\t\t\t\tif (userId > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.muteList.push(userId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (typeof fields.muteList === 'object')\n\t\t\t{\n\t\t\t\tObject.entries(fields.muteList).forEach(entry => {\n\t\t\t\t\tif (entry[1] === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst userId = parseInt(entry[0]);\n\t\t\t\t\t\tif (userId > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult.muteList.push(userId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.textareaMessage !== 'undefined')\n\t\t{\n\t\t\tresult.textareaMessage = fields.textareaMessage.toString();\n\t\t}\n\n\t\tif (typeof fields.title !== 'undefined')\n\t\t{\n\t\t\tfields.name = fields.title;\n\t\t}\n\t\tif (typeof fields.name === \"string\" || typeof fields.name === \"number\")\n\t\t{\n\t\t\tresult.name = Utils.text.htmlspecialcharsback(fields.name.toString());\n\t\t}\n\n\t\tif (typeof fields.owner !== 'undefined')\n\t\t{\n\t\t\tfields.ownerId = fields.owner;\n\t\t}\n\t\tif (typeof fields.ownerId === \"number\" || typeof fields.ownerId === \"string\")\n\t\t{\n\t\t\tresult.ownerId = parseInt(fields.ownerId);\n\t\t}\n\n\t\tif (typeof fields.extranet === \"boolean\")\n\t\t{\n\t\t\tresult.extranet = fields.extranet;\n\t\t}\n\n\t\tif (typeof fields.avatar === 'string')\n\t\t{\n\t\t\tlet avatar;\n\n\t\t\tif (!fields.avatar || fields.avatar.endsWith('/js/im/images/blank.gif'))\n\t\t\t{\n\t\t\t\tavatar = '';\n\t\t\t}\n\t\t\telse if (fields.avatar.startsWith('http'))\n\t\t\t{\n\t\t\t\tavatar = fields.avatar;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tavatar = options.host + fields.avatar;\n\t\t\t}\n\n\t\t\tif (avatar)\n\t\t\t{\n\t\t\t\tresult.avatar = encodeURI(avatar);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.color === \"string\")\n\t\t{\n\t\t\tresult.color = fields.color.toString();\n\t\t}\n\n\t\tif (typeof fields.type === \"string\")\n\t\t{\n\t\t\tresult.type = fields.type.toString();\n\t\t}\n\n\t\tif (typeof fields.entity_type !== 'undefined')\n\t\t{\n\t\t\tfields.entityType = fields.entity_type;\n\t\t}\n\t\tif (typeof fields.entityType === \"string\")\n\t\t{\n\t\t\tresult.entityType = fields.entityType.toString();\n\t\t}\n\t\tif (typeof fields.entity_id !== 'undefined')\n\t\t{\n\t\t\tfields.entityId = fields.entity_id;\n\t\t}\n\t\tif (typeof fields.entityId === \"string\" || typeof fields.entityId === \"number\")\n\t\t{\n\t\t\tresult.entityId = fields.entityId.toString();\n\t\t}\n\n\t\tif (typeof fields.entity_data_1 !== 'undefined')\n\t\t{\n\t\t\tfields.entityData1 = fields.entity_data_1;\n\t\t}\n\t\tif (typeof fields.entityData1 === \"string\")\n\t\t{\n\t\t\tresult.entityData1 = fields.entityData1.toString();\n\t\t}\n\n\t\tif (typeof fields.entity_data_2 !== 'undefined')\n\t\t{\n\t\t\tfields.entityData2 = fields.entity_data_2;\n\t\t}\n\t\tif (typeof fields.entityData2 === \"string\")\n\t\t{\n\t\t\tresult.entityData2 = fields.entityData2.toString();\n\t\t}\n\n\t\tif (typeof fields.entity_data_3 !== 'undefined')\n\t\t{\n\t\t\tfields.entityData3 = fields.entity_data_3;\n\t\t}\n\t\tif (typeof fields.entityData3 === \"string\")\n\t\t{\n\t\t\tresult.entityData3 = fields.entityData3.toString();\n\t\t}\n\n\t\tif (typeof fields.date_create !== 'undefined')\n\t\t{\n\t\t\tfields.dateCreate = fields.date_create;\n\t\t}\n\n\t\tif (typeof fields.dateCreate !== \"undefined\")\n\t\t{\n\t\t\tresult.dateCreate = Utils.date.cast(fields.dateCreate);\n\t\t}\n\n\t\tif (typeof fields.dateLastOpen !== \"undefined\")\n\t\t{\n\t\t\tresult.dateLastOpen = Utils.date.cast(fields.dateLastOpen);\n\t\t}\n\n\t\tif (typeof fields.restrictions === 'object' && fields.restrictions)\n\t\t{\n\t\t\tresult.restrictions = {};\n\n\t\t\tif (typeof fields.restrictions.avatar === 'boolean')\n\t\t\t{\n\t\t\t\tresult.restrictions.avatar = fields.restrictions.avatar;\n\t\t\t}\n\n\t\t\tif (typeof fields.restrictions.extend === 'boolean')\n\t\t\t{\n\t\t\t\tresult.restrictions.extend = fields.restrictions.extend;\n\t\t\t}\n\n\t\t\tif (typeof fields.restrictions.leave === 'boolean')\n\t\t\t{\n\t\t\t\tresult.restrictions.leave = fields.restrictions.leave;\n\t\t\t}\n\n\t\t\tif (typeof fields.restrictions.leave_owner === 'boolean')\n\t\t\t{\n\t\t\t\tresult.restrictions.leaveOwner = fields.restrictions.leave_owner;\n\t\t\t}\n\n\t\t\tif (typeof fields.restrictions.rename === 'boolean')\n\t\t\t{\n\t\t\t\tresult.restrictions.rename = fields.restrictions.rename;\n\t\t\t}\n\n\t\t\tif (typeof fields.restrictions.send === 'boolean')\n\t\t\t{\n\t\t\t\tresult.restrictions.send = fields.restrictions.send;\n\t\t\t}\n\n\t\t\tif (typeof fields.restrictions.user_list === 'boolean')\n\t\t\t{\n\t\t\t\tresult.restrictions.userList = fields.restrictions.user_list;\n\t\t\t}\n\n\t\t\tif (typeof fields.restrictions.mute === 'boolean')\n\t\t\t{\n\t\t\t\tresult.restrictions.mute = fields.restrictions.mute;\n\t\t\t}\n\n\t\t\tif (typeof fields.restrictions.call === 'boolean')\n\t\t\t{\n\t\t\t\tresult.restrictions.call = fields.restrictions.call;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.public === 'object' && fields.public)\n\t\t{\n\t\t\tresult.public = {};\n\n\t\t\tif (typeof fields.public.code === 'string')\n\t\t\t{\n\t\t\t\tresult.public.code = fields.public.code;\n\t\t\t}\n\n\t\t\tif (typeof fields.public.link === 'string')\n\t\t\t{\n\t\t\t\tresult.public.link = fields.public.link;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n}","/**\n * Bitrix Messenger\n * Users model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {Vue} from 'ui.vue';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {Utils} from \"im.lib.utils\";\n\nexport class UsersModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'users';\n\t}\n\n\tgetState()\n\t{\n\t\tthis.startOnlineCheckInterval();\n\n\t\treturn {\n\t\t\thost: this.getVariable('host', location.protocol+'//'+location.host),\n\t\t\tcollection: {},\n\t\t\tonlineList: [],\n\t\t\tmobileOnlineList: [],\n\t\t\tabsentList: []\n\t\t}\n\t}\n\n\tgetElementState(params = {})\n\t{\n\t\tlet {\n\t\t\tid = 0,\n\t\t\tname = this.getVariable('default.name', ''),\n\t\t\tfirstName = this.getVariable('default.name', ''),\n\t\t\tlastName = '',\n\t\t} = params;\n\n\t\treturn {\n\t\t\tid,\n\t\t\tname,\n\t\t\tfirstName,\n\t\t\tlastName,\n\t\t\tworkPosition: \"\",\n\t\t\tcolor: \"#048bd0\",\n\t\t\tavatar: \"\",\n\t\t\tgender: \"M\",\n\t\t\tbirthday: false,\n\t\t\tisBirthday: false,\n\t\t\textranet: false,\n\t\t\tnetwork: false,\n\t\t\tbot: false,\n\t\t\tconnector: false,\n\t\t\texternalAuthId: \"default\",\n\t\t\tstatus: \"online\",\n\t\t\tidle: false,\n\t\t\tlastActivityDate: false,\n\t\t\tmobileLastDate: false,\n\t\t\tisOnline: false,\n\t\t\tisMobileOnline: false,\n\t\t\tabsent: false,\n\t\t\tisAbsent: false,\n\t\t\tdepartments: [],\n\t\t\tphones: {\n\t\t\t\tworkPhone: \"\",\n\t\t\t\tpersonalMobile: \"\",\n\t\t\t\tpersonalPhone: \"\",\n\t\t\t\tinnerPhone: \"\",\n\t\t\t},\n\t\t\tinit: false\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => (userId, getTemporary = false) =>\n\t\t\t{\n\t\t\t\tuserId = parseInt(userId);\n\n\t\t\t\tif (userId <= 0)\n\t\t\t\t{\n\t\t\t\t\tif (getTemporary)\n\t\t\t\t\t{\n\t\t\t\t\t\tuserId = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t!getTemporary\n\t\t\t\t\t&& (!state.collection[userId] || !state.collection[userId].init)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (!state.collection[userId])\n\t\t\t\t{\n\t\t\t\t\treturn this.getElementState({id: userId});\n\t\t\t\t}\n\n\t\t\t\treturn state.collection[userId];\n\t\t\t},\n\t\t\tgetBlank: state => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState(params);\n\t\t\t},\n\t\t\tgetList: state => (userList) => {\n\t\t\t\tconst result = [];\n\n\t\t\t\tif (!Array.isArray(userList))\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tuserList.forEach(id => {\n\t\t\t\t\tif (state.collection[id])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(state.collection[id]);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(this.getElementState({id}));\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(user => {\n\t\t\t\t\t\treturn Object.assign(\n\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\tthis.getElementState(),\n\t\t\t\t\t\t\tthis.validate(Object.assign({}, user), {host: store.state.host}),\n\t\t\t\t\t\t\t{init: true}\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = [];\n\t\t\t\t\tresult.push(Object.assign(\n\t\t\t\t\t\t{},\n\t\t\t\t\t\tthis.getElementState(),\n\t\t\t\t\t\tthis.validate(Object.assign({}, payload), {host: store.state.host}),\n\t\t\t\t\t\t{init: true}\n\t\t\t\t\t));\n\t\t\t\t\tpayload = result;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', payload);\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tpayload.id = parseInt(payload.id);\n\n\t\t\t\tif (\n\t\t\t\t\ttypeof store.state.collection[payload.id] === 'undefined'\n\t\t\t\t\t|| store.state.collection[payload.id].init === false\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid : payload.id,\n\t\t\t\t\tfields : this.validate(Object.assign({}, payload.fields), {host: store.state.host})\n\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', payload.id);\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tsaveState: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('saveState', {});\n\t\t\t\treturn true;\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tfor (let element of payload)\n\t\t\t\t{\n\t\t\t\t\tthis.initCollection(state, {id: element.id});\n\n\t\t\t\t\tstate.collection[element.id] = Object.assign(state.collection[element.id], element);\n\n\t\t\t\t\tlet status = Utils.user.getOnlineStatus(element);\n\t\t\t\t\tif (status.isOnline)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.id].isOnline = true;\n\t\t\t\t\t\tthis.addToOnlineList(state, element.id);\n\t\t\t\t\t}\n\n\t\t\t\t\tlet mobileStatus = Utils.user.isMobileActive(element);\n\t\t\t\t\tif (mobileStatus)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.id].isMobileOnline = true;\n\t\t\t\t\t\tthis.addToMobileOnlineList(state, element.id);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (element.birthday)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet today = Utils.date.format(new Date(), \"d-m\");\n\t\t\t\t\t\tif (element.birthday === today)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.collection[element.id].isBirthday = true;\n\n\t\t\t\t\t\t\tlet timeToNextMidnight = this.getTimeToNextMidnight();\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tstate.collection[element.id].isBirthday = false;\n\t\t\t\t\t\t\t}, timeToNextMidnight);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (element.absent)\n\t\t\t\t\t{\n\t\t\t\t\t\telement.isAbsent = true;\n\n\t\t\t\t\t\tif (!state.absentList.includes(element.id))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.addToAbsentList(state, element.id);\n\n\t\t\t\t\t\t\tlet timeToNextMidnight = this.getTimeToNextMidnight();\n\t\t\t\t\t\t\tlet timeToNextDay = 1000*60*60*24;\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tsetInterval(() => this.startAbsentCheckInterval(state), timeToNextDay);\n\t\t\t\t\t\t\t}, timeToNextMidnight);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\n\t\t\t\tif (typeof payload.fields.lastActivityDate !== 'undefined' && state.collection[payload.id].lastActivityDate)\n\t\t\t\t{\n\t\t\t\t\tlet lastActivityDate = state.collection[payload.id].lastActivityDate.getTime();\n\t\t\t\t\tlet newActivityDate = payload.fields.lastActivityDate.getTime();\n\t\t\t\t\tif (newActivityDate > lastActivityDate)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet status = Utils.user.getOnlineStatus(payload.fields);\n\t\t\t\t\t\tif (status.isOnline)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstate.collection[payload.id].isOnline = true;\n\t\t\t\t\t\t\tthis.addToOnlineList(state, payload.fields.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\ttypeof payload.fields.mobileLastDate !== 'undefined'\n\t\t\t\t\t&& state.collection[payload.id].mobileLastDate !== payload.fields.mobileLastDate\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tlet mobileStatus = Utils.user.isMobileActive(payload.fields);\n\t\t\t\t\tif (mobileStatus)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[payload.id].isMobileOnline = true;\n\t\t\t\t\t\tthis.addToMobileOnlineList(state, payload.fields.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstate.collection[payload.id] = Object.assign(\n\t\t\t\t\tstate.collection[payload.id],\n\t\t\t\t\tpayload.fields\n\t\t\t\t);\n\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tdelete state.collection[payload.id];\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tsaveState: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t}\n\t}\n\n\tinitCollection(state, payload)\n\t{\n\t\tif (typeof state.collection[payload.id] !== 'undefined')\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tVue.set(state.collection, payload.id, this.getElementState());\n\n\t\treturn true;\n\t}\n\n\tgetSaveUserList()\n\t{\n\t\tif (!this.db)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tif (!this.store.getters['messages/getSaveUserList'])\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tlet list = this.store.getters['messages/getSaveUserList']();\n\t\tif (!list)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn list;\n\t}\n\n\tgetSaveTimeout()\n\t{\n\t\treturn 250;\n\t}\n\n\tsaveState(state)\n\t{\n\t\tif (!this.isSaveAvailable())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tsuper.saveState(() =>\n\t\t{\n\t\t\tlet list = this.getSaveUserList();\n\t\t\tif (!list)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet storedState = {\n\t\t\t\tcollection: {},\n\t\t\t};\n\n\t\t\tlet exceptionList = {\n\t\t\t\tabsent: true,\n\t\t\t\tidle: true,\n\t\t\t\tmobileLastDate: true,\n\t\t\t\tlastActivityDate: true,\n\t\t\t};\n\n\t\t\tfor (let chatId in list)\n\t\t\t{\n\t\t\t\tif (!list.hasOwnProperty(chatId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlist[chatId].forEach(userId =>\n\t\t\t\t{\n\t\t\t\t\tif (!state.collection[userId])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tstoredState.collection[userId] = this.cloneState(state.collection[userId], exceptionList);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn storedState;\n\t\t});\n\t}\n\n\tvalidate(fields, options = {})\n\t{\n\t\tconst result = {};\n\n\t\toptions.host = options.host || this.getState().host;\n\n\t\tif (typeof fields.id === \"number\" || typeof fields.id === \"string\")\n\t\t{\n\t\t\tresult.id = parseInt(fields.id);\n\t\t}\n\n\t\tif (typeof fields.first_name !== \"undefined\")\n\t\t{\n\t\t\tfields.firstName = Utils.text.htmlspecialcharsback(fields.first_name);\n\t\t}\n\t\tif (typeof fields.last_name !== \"undefined\")\n\t\t{\n\t\t\tfields.lastName = Utils.text.htmlspecialcharsback(fields.last_name);\n\t\t}\n\t\tif (typeof fields.name === \"string\" || typeof fields.name === \"number\")\n\t\t{\n\t\t\tfields.name = Utils.text.htmlspecialcharsback(fields.name.toString());\n\t\t\tresult.name = fields.name;\n\t\t}\n\n\t\tif (typeof fields.firstName === \"string\" || typeof fields.firstName === \"number\")\n\t\t{\n\t\t\tresult.firstName = Utils.text.htmlspecialcharsback(fields.firstName.toString());\n\t\t}\n\t\tif (typeof fields.lastName === \"string\" || typeof fields.lastName === \"number\")\n\t\t{\n\t\t\tresult.lastName = Utils.text.htmlspecialcharsback(fields.lastName.toString());\n\t\t}\n\n\t\tif (typeof fields.work_position !== \"undefined\")\n\t\t{\n\t\t\tfields.workPosition = fields.work_position;\n\t\t}\n\t\tif (typeof fields.workPosition === \"string\" || typeof fields.workPosition === \"number\")\n\t\t{\n\t\t\tresult.workPosition = fields.workPosition.toString();\n\t\t}\n\n\t\tif (typeof fields.color === \"string\")\n\t\t{\n\t\t\tresult.color = fields.color;\n\t\t}\n\n\t\tif (typeof fields.avatar === 'string')\n\t\t{\n\t\t\tlet avatar;\n\n\t\t\tif (!fields.avatar || fields.avatar.endsWith('/js/im/images/blank.gif'))\n\t\t\t{\n\t\t\t\tavatar = '';\n\t\t\t}\n\t\t\telse if (fields.avatar.startsWith('http'))\n\t\t\t{\n\t\t\t\tavatar = fields.avatar;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tavatar = options.host + fields.avatar;\n\t\t\t}\n\n\t\t\tif (avatar)\n\t\t\t{\n\t\t\t\tresult.avatar = encodeURI(avatar);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.gender !== 'undefined')\n\t\t{\n\t\t\tresult.gender = fields.gender === 'F'? 'F': 'M';\n\t\t}\n\n\t\tif (typeof fields.birthday === \"string\")\n\t\t{\n\t\t\tresult.birthday = fields.birthday;\n\t\t}\n\n\t\tif (typeof fields.extranet === \"boolean\")\n\t\t{\n\t\t\tresult.extranet = fields.extranet;\n\t\t}\n\n\t\tif (typeof fields.network === \"boolean\")\n\t\t{\n\t\t\tresult.network = fields.network;\n\t\t}\n\n\t\tif (typeof fields.bot === \"boolean\")\n\t\t{\n\t\t\tresult.bot = fields.bot;\n\t\t}\n\n\t\tif (typeof fields.connector === \"boolean\")\n\t\t{\n\t\t\tresult.connector = fields.connector;\n\t\t}\n\n\t\tif (typeof fields.external_auth_id !== \"undefined\")\n\t\t{\n\t\t\tfields.externalAuthId = fields.external_auth_id;\n\t\t}\n\t\tif (typeof fields.externalAuthId === \"string\" && fields.externalAuthId)\n\t\t{\n\t\t\tresult.externalAuthId = fields.externalAuthId;\n\t\t}\n\n\t\tif (typeof fields.status === \"string\")\n\t\t{\n\t\t\tresult.status = fields.status;\n\t\t}\n\n\t\tif (typeof fields.idle !== \"undefined\")\n\t\t{\n\t\t\tresult.idle = Utils.date.cast(fields.idle, false);\n\t\t}\n\t\tif (typeof fields.last_activity_date !== \"undefined\")\n\t\t{\n\t\t\tfields.lastActivityDate = fields.last_activity_date;\n\t\t}\n\t\tif (typeof fields.lastActivityDate !== \"undefined\")\n\t\t{\n\t\t\tresult.lastActivityDate = Utils.date.cast(fields.lastActivityDate, false);\n\t\t}\n\t\tif (typeof fields.mobile_last_date !== \"undefined\")\n\t\t{\n\t\t\tfields.mobileLastDate = fields.mobile_last_date;\n\t\t}\n\t\tif (typeof fields.mobileLastDate !== \"undefined\")\n\t\t{\n\t\t\tresult.mobileLastDate = Utils.date.cast(fields.mobileLastDate, false);\n\t\t}\n\n\t\tif (typeof fields.absent !== \"undefined\")\n\t\t{\n\t\t\tresult.absent = Utils.date.cast(fields.absent, false);\n\t\t}\n\n\t\tif (typeof fields.departments !== 'undefined')\n\t\t{\n\t\t\tresult.departments = [];\n\n\t\t\tif (fields.departments instanceof Array)\n\t\t\t{\n\t\t\t\tfields.departments.forEach(departmentId =>\n\t\t\t\t{\n\t\t\t\t\tdepartmentId = parseInt(departmentId);\n\t\t\t\t\tif (departmentId > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.departments.push(departmentId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.phones === 'object' && fields.phones)\n\t\t{\n\t\t\tresult.phones = {};\n\n\t\t\tif (typeof fields.phones.work_phone !== \"undefined\")\n\t\t\t{\n\t\t\t\tfields.phones.workPhone = fields.phones.work_phone;\n\t\t\t}\n\t\t\tif (typeof fields.phones.workPhone === 'string' || typeof fields.phones.workPhone === 'number')\n\t\t\t{\n\t\t\t\tresult.phones.workPhone = fields.phones.workPhone.toString();\n\t\t\t}\n\n\t\t\tif (typeof fields.phones.personal_mobile !== \"undefined\")\n\t\t\t{\n\t\t\t\tfields.phones.personalMobile = fields.phones.personal_mobile;\n\t\t\t}\n\t\t\tif (typeof fields.phones.personalMobile === 'string' || typeof fields.phones.personalMobile === 'number')\n\t\t\t{\n\t\t\t\tresult.phones.personalMobile = fields.phones.personalMobile.toString();\n\t\t\t}\n\n\t\t\tif (typeof fields.phones.personal_phone !== \"undefined\")\n\t\t\t{\n\t\t\t\tfields.phones.personalPhone = fields.phones.personal_phone;\n\t\t\t}\n\t\t\tif (typeof fields.phones.personalPhone === 'string' || typeof fields.phones.personalPhone === 'number')\n\t\t\t{\n\t\t\t\tresult.phones.personalPhone = fields.phones.personalPhone.toString();\n\t\t\t}\n\n\t\t\tif (typeof fields.phones.inner_phone !== \"undefined\")\n\t\t\t{\n\t\t\t\tfields.phones.innerPhone = fields.phones.inner_phone;\n\t\t\t}\n\t\t\tif (typeof fields.phones.innerPhone === 'string' || typeof fields.phones.innerPhone === 'number')\n\t\t\t{\n\t\t\t\tresult.phones.innerPhone = fields.phones.innerPhone.toString();\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\taddToOnlineList(state, id)\n\t{\n\t\tif (!state.onlineList.includes(id))\n\t\t{\n\t\t\tstate.onlineList.push(id);\n\t\t}\n\t}\n\n\taddToMobileOnlineList(state, id)\n\t{\n\t\tif (!state.mobileOnlineList.includes(id))\n\t\t{\n\t\t\tstate.mobileOnlineList.push(id);\n\t\t}\n\t}\n\n\taddToAbsentList(state, id)\n\t{\n\t\tif (!state.absentList.includes(id))\n\t\t{\n\t\t\tstate.absentList.push(id);\n\t\t}\n\t}\n\n\tgetTimeToNextMidnight()\n\t{\n\t\tlet nextMidnight = new Date(new Date().setHours(24,0,0)).getTime();\n\t\treturn nextMidnight - new Date();\n\t}\n\n\tstartAbsentCheckInterval(state)\n\t{\n\t\tfor (let userId of state.absentList)\n\t\t{\n\t\t\tlet user = state.collection[userId];\n\n\t\t\tif (!user)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet currentTime = new Date().getTime();\n\t\t\tlet absentEnd = new Date(state.collection[userId].absent).getTime();\n\n\t\t\tif (absentEnd <= currentTime)\n\t\t\t{\n\t\t\t\tstate.absentList = state.absentList.filter(element => {\n\t\t\t\t\treturn element !== userId;\n\t\t\t\t});\n\t\t\t\tuser.isAbsent = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tstartOnlineCheckInterval()\n\t{\n\t\tconst intervalTime = 60000;\n\n\t\tsetInterval(() => {\n\t\t\tfor (let userId of this.store.state.users.onlineList)\n\t\t\t{\n\t\t\t\tlet user = this.store.state.users.collection[userId];\n\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet status = Utils.user.getOnlineStatus(user);\n\t\t\t\tif (status.isOnline)\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isOnline = false;\n\t\t\t\t\tthis.store.state.users.onlineList = this.store.state.users.onlineList.filter(element => {\n\t\t\t\t\t\treturn element !== userId\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (let userId of this.store.state.users.mobileOnlineList)\n\t\t\t{\n\t\t\t\tlet user = this.store.state.users.collection[userId];\n\n\t\t\t\tif (!user)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet mobileStatus = Utils.user.isMobileActive(user);\n\t\t\t\tif (mobileStatus)\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tuser.isMobileOnline = false;\n\t\t\t\t\tthis.store.state.users.mobileOnlineList = this.store.state.users.mobileOnlineList.filter(element => {\n\t\t\t\t\t\treturn element !== userId\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}, intervalTime);\n\t}\n}","/**\n * Bitrix Messenger\n * Files model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\n\nimport {Vue} from 'ui.vue';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {FileStatus, FileType, MutationType} from 'im.const';\nimport {Utils} from \"im.lib.utils\";\n\nexport class FilesModel extends VuexBuilderModel\n{\n\tstatic maxDiskFileSize = 5242880;\n\n\tgetName()\n\t{\n\t\treturn 'files';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcreated: 0,\n\t\t\thost: this.getVariable('host', location.protocol+'//'+location.host),\n\t\t\tcollection: {},\n\t\t\tindex: {},\n\t\t}\n\t}\n\n\tgetElementState(params = {})\n\t{\n\t\tlet {\n\t\t\tid = 0,\n\t\t\tchatId = 0,\n\t\t\tname = this.getVariable('default.name', ''),\n\t\t} = params;\n\n\t\treturn {\n\t\t\tid,\n\t\t\tchatId,\n\t\t\tname,\n\t\t\ttemplateId: id,\n\t\t\tdate: new Date(),\n\t\t\ttype: 'file',\n\t\t\textension: \"\",\n\t\t\ticon: \"empty\",\n\t\t\tsize: 0,\n\t\t\timage: false,\n\t\t\tstatus: FileStatus.done,\n\t\t\tprogress: 100,\n\t\t\tauthorId: 0,\n\t\t\tauthorName: \"\",\n\t\t\turlPreview: \"\",\n\t\t\turlShow: \"\",\n\t\t\turlDownload: \"\",\n\t\t\tinit: false,\n\t\t\tviewerAttrs: {}\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => (chatId, fileId, getTemporary = false) =>\n\t\t\t{\n\t\t\t\tif (!chatId || !fileId)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (!state.index[chatId] || !state.index[chatId][fileId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tif (!getTemporary && !state.index[chatId][fileId].init)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.index[chatId][fileId];\n\t\t\t},\n\t\t\tgetList: state => chatId =>\n\t\t\t{\n\t\t\t\tif (!state.index[chatId])\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn state.index[chatId];\n\t\t\t},\n\t\t\tgetBlank: state => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState(params);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tadd: (store, payload) =>\n\t\t\t{\n\t\t\t\tlet result = this.validate(Object.assign({}, payload), {host: store.state.host});\n\t\t\t\tif (payload.id)\n\t\t\t\t{\n\t\t\t\t\tresult.id = payload.id;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult.id = 'temporary' + (new Date).getTime() + store.state.created;\n\t\t\t\t}\n\t\t\t\tresult.templateId = result.id;\n\t\t\t\tresult.init = true;\n\n\t\t\t\tstore.commit('add', Object.assign({}, this.getElementState(), result));\n\n\t\t\t\treturn result.id;\n\t\t\t},\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(file => {\n\t\t\t\t\t\tlet result = this.validate(Object.assign({}, file), {host: store.state.host});\n\t\t\t\t\t\tresult.templateId = result.id;\n\t\t\t\t\t\treturn Object.assign({}, this.getElementState(), result, {init: true});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.validate(Object.assign({}, payload), {host: store.state.host});\n\t\t\t\t\tresult.templateId = result.id;\n\t\t\t\t\tpayload = [];\n\t\t\t\t\tpayload.push(\n\t\t\t\t\t\tObject.assign({}, this.getElementState(), result, {init: true})\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tinsertType : MutationType.setAfter,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetBefore: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload = payload.map(file => {\n\t\t\t\t\t\tlet result = this.validate(Object.assign({}, file), {host: store.state.host});\n\t\t\t\t\t\tresult.templateId = result.id;\n\t\t\t\t\t\treturn Object.assign({}, this.getElementState(), result, {init: true});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet result = this.validate(Object.assign({}, payload), {host: store.state.host});\n\t\t\t\t\tresult.templateId = result.id;\n\t\t\t\t\tpayload = [];\n\t\t\t\t\tpayload.push(\n\t\t\t\t\t\tObject.assign({}, this.getElementState(), result, {init: true})\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', {\n\t\t\t\t\tactionName: 'setBefore',\n\t\t\t\t\tinsertType : MutationType.setBefore,\n\t\t\t\t\tdata : payload\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tlet result = this.validate(Object.assign({}, payload.fields), {host: store.state.host});\n\n\t\t\t\tstore.commit('initCollection', {chatId: payload.chatId});\n\n\t\t\t\tlet index = store.state.collection[payload.chatId].findIndex(el => el.id === payload.id);\n\t\t\t\tif (index < 0)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tid : payload.id,\n\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\tindex : index,\n\t\t\t\t\tfields : result\n\t\t\t\t});\n\n\t\t\t\tif (payload.fields.blink)\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tid : payload.id ,\n\t\t\t\t\t\t\tchatId : payload.chatId,\n\t\t\t\t\t\t\tfields : {blink: false}\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 1000);\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tid : payload.id,\n\t\t\t\t\tchatId : payload.chatId\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tsaveState: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('saveState', {});\n\t\t\t\treturn true;\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tinitCollection: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\t\t\t},\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\n\t\t\t\tstate.collection[payload.chatId].push(payload);\n\t\t\t\tstate.index[payload.chatId][payload.id] = payload;\n\n\t\t\t\tstate.created += 1;\n\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tfor (let element of payload.data)\n\t\t\t\t{\n\t\t\t\t\tthis.initCollection(state, {chatId: element.chatId});\n\n\t\t\t\t\tlet index = state.collection[element.chatId].findIndex(el => el.id === element.id);\n\t\t\t\t\tif (index > -1)\n\t\t\t\t\t{\n\t\t\t\t\t\tdelete element.templateId;\n\t\t\t\t\t\tstate.collection[element.chatId][index] = Object.assign(state.collection[element.chatId][index], element);\n\t\t\t\t\t}\n\t\t\t\t\telse if (payload.insertType === MutationType.setBefore)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.chatId].unshift(element);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection[element.chatId].push(element);\n\t\t\t\t\t}\n\n\t\t\t\t\tstate.index[element.chatId][element.id] = element;\n\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\n\t\t\t\tlet index = -1;\n\t\t\t\tif (typeof payload.index !== 'undefined' && state.collection[payload.chatId][payload.index])\n\t\t\t\t{\n\t\t\t\t\tindex = payload.index;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tindex = state.collection[payload.chatId].findIndex(el => el.id === payload.id);\n\t\t\t\t}\n\n\t\t\t\tif (index >= 0)\n\t\t\t\t{\n\t\t\t\t\tdelete payload.fields.templateId;\n\t\t\t\t\tlet element = Object.assign(\n\t\t\t\t\t\tstate.collection[payload.chatId][index],\n\t\t\t\t\t\tpayload.fields\n\t\t\t\t\t);\n\t\t\t\t\tstate.collection[payload.chatId][index] = element;\n\t\t\t\t\tstate.index[payload.chatId][element.id] = element;\n\n\t\t\t\t\tthis.saveState(state);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.initCollection(state, payload);\n\n\t\t\t\tstate.collection[payload.chatId] = state.collection[payload.chatId].filter(element => element.id !== payload.id);\n\t\t\t\tdelete state.index[payload.chatId][payload.id];\n\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t\tsaveState: (state, payload) =>\n\t\t\t{\n\t\t\t\tthis.saveState(state);\n\t\t\t},\n\t\t}\n\t}\n\n\tinitCollection(state, payload)\n\t{\n\t\tif (typeof state.collection[payload.chatId] !== 'undefined')\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tVue.set(state.collection, payload.chatId, []);\n\t\tVue.set(state.index, payload.chatId, {});\n\n\t\treturn true;\n\t}\n\n\tgetLoadedState(state)\n\t{\n\t\tif (!state || typeof state !== 'object')\n\t\t{\n\t\t\treturn state;\n\t\t}\n\n\t\tif (typeof state.collection !== 'object')\n\t\t{\n\t\t\treturn state;\n\t\t}\n\n\t\tstate.index = {};\n\n\t\tfor (let chatId in state.collection)\n\t\t{\n\t\t\tif (!state.collection.hasOwnProperty(chatId))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tstate.index[chatId] = {};\n\n\t\t\tstate.collection[chatId]\n\t\t\t\t.filter(file => file != null)\n\t\t\t\t.forEach(file => {\n\t\t\t\t\tstate.index[chatId][file.id] = file;\n\t\t\t});\n\t\t}\n\n\t\treturn state;\n\t}\n\n\tgetSaveFileList()\n\t{\n\t\tif (!this.db)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tif (!this.store.getters['messages/getSaveFileList'])\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tlet list = this.store.getters['messages/getSaveFileList']();\n\t\tif (!list)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn list;\n\t}\n\n\tgetSaveTimeout()\n\t{\n\t\treturn 250;\n\t}\n\n\tsaveState(state)\n\t{\n\t\tif (!this.isSaveAvailable())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tsuper.saveState(() =>\n\t\t{\n\t\t\tlet list = this.getSaveFileList();\n\t\t\tif (!list)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tlet storedState = {\n\t\t\t\tcollection: {},\n\t\t\t};\n\n\t\t\tfor (let chatId in list)\n\t\t\t{\n\t\t\t\tif (!list.hasOwnProperty(chatId))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlist[chatId].forEach(fileId =>\n\t\t\t\t{\n\t\t\t\t\tif (!state.index[chatId])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!state.index[chatId][fileId])\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!storedState.collection[chatId])\n\t\t\t\t\t{\n\t\t\t\t\t\tstoredState.collection[chatId] = [];\n\t\t\t\t\t}\n\n\t\t\t\t\tstoredState.collection[chatId].push(\n\t\t\t\t\t\tstate.index[chatId][fileId]\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn storedState;\n\t\t});\n\t}\n\n\tvalidate(fields, options = {})\n\t{\n\t\tconst result = {};\n\n\t\toptions.host = options.host || this.getState().host;\n\n\t\tif (typeof fields.id === \"number\")\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\t\telse if (typeof fields.id === \"string\")\n\t\t{\n\t\t\tif (fields.id.startsWith('temporary'))\n\t\t\t{\n\t\t\t\tresult.id = fields.id;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.id = parseInt(fields.id);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.templateId === \"number\")\n\t\t{\n\t\t\tresult.templateId = fields.templateId;\n\t\t}\n\t\telse if (typeof fields.templateId === \"string\")\n\t\t{\n\t\t\tif (fields.templateId.startsWith('temporary'))\n\t\t\t{\n\t\t\t\tresult.templateId = fields.templateId;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.templateId = parseInt(fields.templateId);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.chatId === \"number\" || typeof fields.chatId === \"string\")\n\t\t{\n\t\t\tresult.chatId = parseInt(fields.chatId);\n\t\t}\n\n\t\tif (typeof fields.date !== \"undefined\")\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tif (typeof fields.type === \"string\")\n\t\t{\n\t\t\tresult.type = fields.type;\n\t\t}\n\n\t\tif (typeof fields.extension === \"string\")\n\t\t{\n\t\t\tresult.extension = fields.extension.toString();\n\n\t\t\tif (result.type === 'image')\n\t\t\t{\n\t\t\t\tresult.icon = 'img';\n\t\t\t}\n\t\t\telse if (result.type === 'video')\n\t\t\t{\n\t\t\t\tresult.icon = 'mov';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.icon = FilesModel.getIconType(result.extension);\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.name === \"string\" || typeof fields.name === \"number\")\n\t\t{\n\t\t\tresult.name = fields.name.toString();\n\t\t}\n\n\n\t\tif (typeof fields.size === \"number\" || typeof fields.size === \"string\")\n\t\t{\n\t\t\tresult.size = parseInt(fields.size);\n\t\t}\n\n\t\tif (typeof fields.image === 'boolean')\n\t\t{\n\t\t\tresult.image = false;\n\t\t}\n\t\telse if (typeof fields.image === 'object' && fields.image)\n\t\t{\n\t\t\tresult.image = {\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t};\n\n\t\t\tif (typeof fields.image.width === \"string\" || typeof fields.image.width === \"number\")\n\t\t\t{\n\t\t\t\tresult.image.width = parseInt(fields.image.width);\n\t\t\t}\n\t\t\tif (typeof fields.image.height === \"string\" || typeof fields.image.height === \"number\")\n\t\t\t{\n\t\t\t\tresult.image.height = parseInt(fields.image.height);\n\t\t\t}\n\n\t\t\tif (result.image.width <= 0 || result.image.height <= 0)\n\t\t\t{\n\t\t\t\tresult.image = false;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.status === \"string\" && typeof FileStatus[fields.status] !== 'undefined')\n\t\t{\n\t\t\tresult.status = fields.status;\n\t\t}\n\n\t\tif (typeof fields.progress === \"number\" || typeof fields.progress === \"string\")\n\t\t{\n\t\t\tresult.progress = parseInt(fields.progress);\n\t\t}\n\n\t\tif (typeof fields.authorId === \"number\" || typeof fields.authorId === \"string\")\n\t\t{\n\t\t\tresult.authorId = parseInt(fields.authorId);\n\t\t}\n\n\t\tif (typeof fields.authorName === \"string\" || typeof fields.authorName === \"number\")\n\t\t{\n\t\t\tresult.authorName = fields.authorName.toString();\n\t\t}\n\n\t\tif (typeof fields.urlPreview === 'string')\n\t\t{\n\t\t\tif (\n\t\t\t\t!fields.urlPreview\n\t\t\t\t|| fields.urlPreview.startsWith('http')\n\t\t\t\t|| fields.urlPreview.startsWith('bx')\n\t\t\t\t|| fields.urlPreview.startsWith('file')\n\t\t\t\t|| fields.urlPreview.startsWith('blob')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlPreview = fields.urlPreview;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlPreview = options.host+fields.urlPreview;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.urlDownload === 'string')\n\t\t{\n\t\t\tif (\n\t\t\t\t!fields.urlDownload\n\t\t\t\t|| fields.urlDownload.startsWith('http')\n\t\t\t\t|| fields.urlDownload.startsWith('bx')\n\t\t\t\t|| fields.urlPreview.startsWith('file')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlDownload = fields.urlDownload;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlDownload = options.host+fields.urlDownload;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.urlShow === 'string')\n\t\t{\n\t\t\tif (\n\t\t\t\t!fields.urlShow\n\t\t\t\t|| fields.urlShow.startsWith('http')\n\t\t\t\t|| fields.urlShow.startsWith('bx')\n\t\t\t\t|| fields.urlShow.startsWith('file')\n\t\t\t)\n\t\t\t{\n\t\t\t\tresult.urlShow = fields.urlShow;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.urlShow = options.host+fields.urlShow;\n\t\t\t}\n\t\t}\n\n\t\tif (typeof fields.viewerAttrs === 'object')\n\t\t{\n\t\t\tif (result.type === 'image' && !Utils.platform.isBitrixMobile())\n\t\t\t{\n\t\t\t\tresult.viewerAttrs = fields.viewerAttrs;\n\t\t\t}\n\n\t\t\tif (result.type === 'video' && !Utils.platform.isBitrixMobile() && result.size > FilesModel.maxDiskFileSize)\n\t\t\t{\n\t\t\t\tresult.viewerAttrs = fields.viewerAttrs;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tstatic getType(type)\n\t{\n\t\ttype = type.toString().toLowerCase().split('.').splice(-1)[0];\n\n\t\tswitch(type)\n\t\t{\n\t\t\tcase 'png':\n\t\t\tcase 'jpe':\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\t\t\tcase 'gif':\n\t\t\tcase 'heic':\n\t\t\tcase 'bmp':\n\t\t\tcase 'webp':\n\t\t\t\treturn FileType.image;\n\n\t\t\tcase 'mp4':\n\t\t\tcase 'mkv':\n\t\t\tcase 'webm':\n\t\t\tcase 'mpeg':\n\t\t\tcase 'hevc':\n\t\t\tcase 'avi':\n\t\t\tcase '3gp':\n\t\t\tcase 'flv':\n\t\t\tcase 'm4v':\n\t\t\tcase 'ogg':\n\t\t\tcase 'wmv':\n\t\t\tcase 'mov':\n\t\t\t\treturn FileType.video;\n\n\t\t\tcase 'mp3':\n\t\t\t\treturn FileType.audio;\n\t\t}\n\n\t\treturn FileType.file\n\t}\n\n\tstatic getIconType(extension)\n\t{\n\t\tlet icon = 'empty';\n\n\t\tswitch(extension.toString())\n\t\t{\n\t\t\tcase 'png':\n\t\t\tcase 'jpe':\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\t\t\tcase 'gif':\n\t\t\tcase 'heic':\n\t\t\tcase 'bmp':\n\t\t\tcase 'webp':\n\t\t\t\ticon = 'img';\n\t\t\t\tbreak;\n\n\t\t\tcase 'mp4':\n\t\t\tcase 'mkv':\n\t\t\tcase 'webm':\n\t\t\tcase 'mpeg':\n\t\t\tcase 'hevc':\n\t\t\tcase 'avi':\n\t\t\tcase '3gp':\n\t\t\tcase 'flv':\n\t\t\tcase 'm4v':\n\t\t\tcase 'ogg':\n\t\t\tcase 'wmv':\n\t\t\tcase 'mov':\n\t\t\t\ticon = 'mov';\n\t\t\t\tbreak;\n\n\t\t\tcase 'txt':\n\t\t\t\ticon = 'txt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'doc':\n\t\t\tcase 'docx':\n\t\t\t\ticon = 'doc';\n\t\t\t\tbreak;\n\n\t\t\tcase 'xls':\n\t\t\tcase 'xlsx':\n\t\t\t\ticon = 'xls';\n\t\t\t\tbreak;\n\n\t\t\tcase 'php':\n\t\t\t\ticon = 'php';\n\t\t\t\tbreak;\n\n\t\t\tcase 'pdf':\n\t\t\t\ticon = 'pdf';\n\t\t\t\tbreak;\n\n\t\t\tcase 'ppt':\n\t\t\tcase 'pptx':\n\t\t\t\ticon = 'ppt';\n\t\t\t\tbreak;\n\n\t\t\tcase 'rar':\n\t\t\t\ticon = 'rar';\n\t\t\t\tbreak;\n\n\t\t\tcase 'zip':\n\t\t\tcase '7z':\n\t\t\tcase 'tar':\n\t\t\tcase 'gz':\n\t\t\tcase 'gzip':\n\t\t\t\ticon = 'zip';\n\t\t\t\tbreak;\n\n\t\t\tcase 'set':\n\t\t\t\ticon = 'set';\n\t\t\t\tbreak;\n\n\t\t\tcase 'conf':\n\t\t\tcase 'ini':\n\t\t\tcase 'plist':\n\t\t\t\ticon = 'set';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn icon;\n\t}\n}","/**\n * Bitrix Messenger\n * Recent model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2020 Bitrix\n */\n\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {Type} from 'main.core';\nimport {ChatTypes, MessageStatus, RecentSection as Section, TemplateTypes} from \"im.const\";\nimport {Utils} from \"im.lib.utils\";\n\nexport class RecentModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'recent';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\thost: this.getVariable('host', location.protocol+'//'+location.host),\n\t\t\tcollection: []\n\t\t}\n\t}\n\n\tgetElementState(): RecentItem\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\ttemplateId: '',\n\t\t\ttemplate: TemplateTypes.item,\n\t\t\tchatType: ChatTypes.chat,\n\t\t\tsectionCode: Section.general,\n\t\t\tavatar: '',\n\t\t\tcolor: '#048bd0',\n\t\t\ttitle: '',\n\t\t\tlines: {id: 0, status: 0},\n\t\t\tmessage: {\n\t\t\t\tid: 0,\n\t\t\t\ttext: '',\n\t\t\t\tdate: new Date(),\n\t\t\t\tsenderId: 0,\n\t\t\t\tstatus: MessageStatus.received\n\t\t\t},\n\t\t\tcounter: 0,\n\t\t\tpinned: false,\n\t\t\tchatId: 0,\n\t\t\tuserId: 0\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => (dialogId: string): {index: number, element: RecentItem} | boolean =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(dialogId))\n\t\t\t\t{\n\t\t\t\t\tdialogId = dialogId.toString();\n\t\t\t\t}\n\n\t\t\t\tlet currentItem = this.findItem(dialogId);\n\t\t\t\tif (currentItem)\n\t\t\t\t{\n\t\t\t\t\treturn currentItem;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tlet result = [];\n\n\t\t\t\tif (payload instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tresult = payload.map(\n\t\t\t\t\t\trecentItem => this.prepareItem(recentItem, { host: store.state.host })\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (result.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tresult.forEach(element => {\n\t\t\t\t\tconst existingItem = this.findItem(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\t\t\tfields: element\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\t\tfields: element\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tstore.state.collection.sort(this.sortListByMessageDate);\n\t\t\t},\n\n\t\t\taddPlaceholders: (store, payload: []) =>\n\t\t\t{\n\t\t\t\tpayload.forEach(element => {\n\t\t\t\t\tstore.commit('addPlaceholder', {\n\t\t\t\t\t\tfields: element\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdatePlaceholders: (store, payload: {items: [], firstMessage: number}) =>\n\t\t\t{\n\t\t\t\tpayload.items = payload.items.map(element => this.prepareItem(element));\n\n\t\t\t\tpayload.items.forEach((element, index) => {\n\t\t\t\t\tconst placeholderId = 'placeholder' + (payload.firstMessage + index);\n\t\t\t\t\tconst existingPlaceholder = this.findItem(placeholderId, 'templateId');\n\n\t\t\t\t\tconst existingItem = this.findItem(element.id);\n\t\t\t\t\tif (existingItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\t\t\tfields: element\n\t\t\t\t\t\t});\n\t\t\t\t\t\tstore.commit('delete', {\n\t\t\t\t\t\t\tindex: existingPlaceholder.index,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tindex: existingPlaceholder.index,\n\t\t\t\t\t\t\tfields: element\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tupdate: (store, payload: {id: string | number, fields: Object}) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.id === 'string' && !payload.id.startsWith('chat') && payload.id !== 'notify')\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = this.findItem(payload.id);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tpayload.fields = this.validate(Object.assign({}, payload.fields));\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\tfields: payload.fields\n\t\t\t\t});\n\t\t\t\tstore.state.collection.sort(this.sortListByMessageDate);\n\t\t\t},\n\n\t\t\tpin: (store, payload: {id: string | number, action: boolean}) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.id === 'string' && !payload.id.startsWith('chat') && payload.id !== 'notify')\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\n\n\t\t\t\tlet existingItem = this.findItem(payload.id);\n\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('update', {\n\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\tfields: Object.assign({}, existingItem.element, {\n\t\t\t\t\t\tpinned: payload.action\n\t\t\t\t\t})\n\t\t\t\t});\n\n\t\t\t\tstore.state.collection.sort(this.sortListByMessageDate);\n\t\t\t},\n\n\t\t\tclearPlaceholders: (store) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearPlaceholders');\n\t\t\t},\n\n\t\t\tdelete: (store, payload: {id: string | number}) =>\n\t\t\t{\n\t\t\t\tif (typeof payload.id === 'string' && !payload.id.startsWith('chat') && payload.id !== 'notify')\n\t\t\t\t{\n\t\t\t\t\tpayload.id = parseInt(payload.id);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = this.findItem(payload.id);\n\t\t\t\tif (!existingItem)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('delete', {\n\t\t\t\t\tindex: existingItem.index\n\t\t\t\t});\n\t\t\t\tstore.state.collection.sort(this.sortListByMessageDate);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tadd: (state, payload: {fields: Object}) => {\n\t\t\t\tstate.collection.push(Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tthis.getElementState(),\n\t\t\t\t\tpayload.fields\n\t\t\t\t));\n\t\t\t},\n\n\t\t\tupdate: (state, payload: {index: number, fields: Object}) => {\n\t\t\t\tstate.collection.splice(payload.index, 1, Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tstate.collection[payload.index],\n\t\t\t\t\tpayload.fields\n\t\t\t\t));\n\t\t\t},\n\n\t\t\tdelete: (state, payload: {index: number}) => {\n\t\t\t\tstate.collection.splice(payload.index, 1);\n\t\t\t},\n\n\t\t\taddPlaceholder: (state, payload: {fields: Object}) => {\n\t\t\t\tstate.collection.push(Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tthis.getElementState(),\n\t\t\t\t\tpayload.fields\n\t\t\t\t));\n\t\t\t},\n\n\t\t\tclearPlaceholders: (state) => {\n\t\t\t\tstate.collection = state.collection.filter(element => {\n\t\t\t\t\treturn !element.id.toString().startsWith('placeholder');\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tvalidate(fields: rawRecentItem, options = {}): RecentItem\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id.toString();\n\t\t}\n\t\tif (Type.isStringFilled(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (Type.isString(fields.templateId))\n\t\t{\n\t\t\tresult.templateId = fields.templateId;\n\t\t}\n\n\t\tif (Type.isString(fields.template))\n\t\t{\n\t\t\tresult.template = fields.template;\n\t\t}\n\n\t\tif (Type.isString(fields.type))\n\t\t{\n\t\t\tif (fields.type === ChatTypes.chat)\n\t\t\t{\n\t\t\t\tif (fields.chat.type === ChatTypes.open)\n\t\t\t\t{\n\t\t\t\t\tresult.chatType = ChatTypes.open;\n\t\t\t\t}\n\t\t\t\telse if (fields.chat.type === ChatTypes.chat)\n\t\t\t\t{\n\t\t\t\t\tresult.chatType = ChatTypes.chat;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (fields.type === ChatTypes.user)\n\t\t\t{\n\t\t\t\tresult.chatType = ChatTypes.user;\n\t\t\t}\n\t\t\telse if (fields.type === ChatTypes.notification)\n\t\t\t{\n\t\t\t\tresult.chatType = ChatTypes.notification;\n\t\t\t\tfields.title = 'Notifications';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.chatType = ChatTypes.chat;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(fields.avatar))\n\t\t{\n\t\t\tlet avatar;\n\n\t\t\tif (!fields.avatar || fields.avatar.endsWith('/js/im/images/blank.gif'))\n\t\t\t{\n\t\t\t\tavatar = '';\n\t\t\t}\n\t\t\telse if (fields.avatar.startsWith('http'))\n\t\t\t{\n\t\t\t\tavatar = fields.avatar;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tavatar = options.host + fields.avatar;\n\t\t\t}\n\n\t\t\tif (avatar)\n\t\t\t{\n\t\t\t\tresult.avatar = encodeURI(avatar);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isString(fields.color))\n\t\t{\n\t\t\tresult.color = fields.color;\n\t\t}\n\n\t\tif (Type.isString(fields.title))\n\t\t{\n\t\t\tresult.title = fields.title;\n\t\t}\n\n\t\tif (Type.isPlainObject(fields.message))\n\t\t{\n\t\t\tconst message = {};\n\t\t\tif (Type.isNumber(fields.message.id))\n\t\t\t{\n\t\t\t\tmessage.id = fields.message.id;\n\t\t\t}\n\t\t\tif (Type.isString(fields.message.text))\n\t\t\t{\n\t\t\t\tconst options = {}\n\t\t\t\tif (fields.message.withAttach)\n\t\t\t\t{\n\t\t\t\t\toptions.WITH_ATTACH = true;\n\t\t\t\t}\n\t\t\t\telse if (fields.message.withFile)\n\t\t\t\t{\n\t\t\t\t\toptions.WITH_FILE = true;\n\t\t\t\t}\n\n\t\t\t\tmessage.text = Utils.text.purify(fields.message.text, options);\n\t\t\t}\n\t\t\tif (Type.isDate(fields.message.date) || Type.isString(fields.message.date))\n\t\t\t{\n\t\t\t\tmessage.date = fields.message.date;\n\t\t\t}\n\t\t\tif (Type.isNumber(fields.message.author_id))\n\t\t\t{\n\t\t\t\tmessage.senderId = fields.message.author_id;\n\t\t\t}\n\t\t\tif (Type.isNumber(fields.message.senderId))\n\t\t\t{\n\t\t\t\tmessage.senderId = fields.message.senderId;\n\t\t\t}\n\t\t\tif (Type.isStringFilled(fields.message.status))\n\t\t\t{\n\t\t\t\tmessage.status = fields.message.status;\n\t\t\t}\n\n\t\t\tresult.message = message;\n\t\t}\n\n\t\tif (Type.isNumber(fields.counter))\n\t\t{\n\t\t\tresult.counter = fields.counter;\n\t\t}\n\n\t\tif (Type.isBoolean(fields.pinned))\n\t\t{\n\t\t\tresult.pinned = fields.pinned;\n\t\t}\n\n\t\tif (Type.isNumber(fields.chatId))\n\t\t{\n\t\t\tresult.chatId = fields.chatId;\n\t\t}\n\n\t\tif (Type.isNumber(fields.userId))\n\t\t{\n\t\t\tresult.userId = fields.userId;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsortListByMessageDate(a: RecentItem, b: RecentItem)\n\t{\n\t\tif (a.message && b.message)\n\t\t{\n\t\t\tlet timestampA = new Date(a.message.date).getTime();\n\t\t\tlet timestampB = new Date(b.message.date).getTime();\n\n\t\t\treturn timestampB - timestampA;\n\t\t}\n\t}\n\n\tprepareItem(item, options = {})\n\t{\n\t\tlet result = this.validate(Object.assign({}, item));\n\n\t\treturn Object.assign({}, this.getElementState(), result, options);\n\t}\n\n\tfindItem(value, key = 'id'): {index: number, element: RecentItem} | boolean\n\t{\n\t\tlet result = {};\n\n\t\tif (key === 'id' && Type.isNumber(value))\n\t\t{\n\t\t\tvalue = value.toString();\n\t\t}\n\n\t\tlet elementIndex = this.store.state.recent.collection.findIndex((element, index) => {\n\t\t\treturn element[key] === value;\n\t\t});\n\n\t\tif (elementIndex !== -1)\n\t\t{\n\t\t\tresult.index = elementIndex;\n\t\t\tresult.element = this.store.state.recent.collection[elementIndex];\n\n\t\t\treturn result;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n\n//raw input object for validation\ntype rawRecentItem = {\n\tid?: number | string,\n\ttemplateId?: string,\n\ttemplate?: TemplateTypes.item | TemplateTypes.placeholder,\n\ttype?: ChatTypes.chat | ChatTypes.user | ChatTypes.notification,\n\tchat?: {\n\t\ttype?: string\n\t},\n\tavatar?: string,\n\tcolor?: string,\n\ttitle?: string,\n\tmessage?: RawRecentItemMessage,\n\tcounter?: number,\n\tpinned?: boolean,\n\tchatId?: number,\n\tuserId?: number\n}\n\ntype RawRecentItemMessage = {\n\tid?: number,\n\ttext?: string,\n\tdate?: Date,\n\tsenderId?: number,\n\tauthor_id?: number, //senderId alias\n\tstatus?: MessageStatus.received | MessageStatus.delivered\n}\n\n//item in collection\ntype RecentItem = {\n\tid?: number,\n\ttemplateId?: string,\n\ttemplate?: TemplateTypes.item | TemplateTypes.placeholder,\n\tchatType?: ChatTypes.chat | ChatTypes.open | ChatTypes.user | ChatTypes.notification,\n\tsectionCode?: Section.general | Section.pinned,\n\tavatar?: string,\n\tcolor?: string,\n\ttitle?: string,\n\tmessage?: RecentItemMessage,\n\tcounter?: number,\n\tpinned?: boolean,\n\tchatId?: number,\n\tuserId?: number\n}\n\ntype RecentItemMessage = {\n\tid?: number,\n\ttext?: string,\n\tdate?: Date | string,\n\tsenderId?: number,\n\tstatus?: MessageStatus.received | MessageStatus.delivered\n}","/**\n * Bitrix Messenger\n * Notifications model (Vuex Builder model)\n *\n * @package bitrix\n * @subpackage im\n * @copyright 2001-2021 Bitrix\n */\n\nimport {Vue} from 'ui.vue';\nimport {VuexBuilderModel} from 'ui.vue.vuex';\nimport {Utils} from 'im.lib.utils';\nimport {Text, Type, Reflection} from 'main.core';\nimport {NotificationTypesCodes} from 'im.const';\n\nclass NotificationsModel extends VuexBuilderModel\n{\n\tgetName()\n\t{\n\t\treturn 'notifications';\n\t}\n\n\tgetState()\n\t{\n\t\treturn {\n\t\t\tcollection: [],\n\t\t\tsearchCollection: [],\n\t\t\tchat_id: 0,\n\t\t\ttotal: 0,\n\t\t\thost: this.getVariable('host', location.protocol+'//'+location.host),\n\t\t\tunreadCounter: 0,\n\t\t\tschema: {}\n\t\t}\n\t}\n\n\tgetElementState()\n\t{\n\t\treturn {\n\t\t\tid: 0,\n\t\t\tauthorId: 0,\n\t\t\tdate: new Date(),\n\t\t\ttext: '',\n\t\t\tsectionCode: NotificationTypesCodes.simple,\n\t\t\ttextConverted: '',\n\t\t\ttitle: '',\n\t\t\tunread: false,\n\t\t\tdisplay: true,\n\t\t\tsettingName: 'im|default',\n\t\t};\n\t}\n\n\tgetGetters()\n\t{\n\t\treturn {\n\t\t\tget: state => () =>\n\t\t\t{\n\t\t\t\treturn state.collection;\n\t\t\t},\n\t\t\tgetById: state => (notificationId) =>\n\t\t\t{\n\t\t\t\tif (Type.isString(notificationId))\n\t\t\t\t{\n\t\t\t\t\tnotificationId = parseInt(notificationId);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = this.findItemInArr(state.collection, notificationId);\n\t\t\t\tif (!existingItem.element)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn existingItem.element;\n\t\t\t},\n\t\t\tgetSearchItemById: state => (notificationId) =>\n\t\t\t{\n\t\t\t\tif (Type.isString(notificationId))\n\t\t\t\t{\n\t\t\t\t\tnotificationId = parseInt(notificationId);\n\t\t\t\t}\n\n\t\t\t\tconst existingItem = this.findItemInArr(state.searchCollection, notificationId);\n\t\t\t\tif (!existingItem.element)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn existingItem.element;\n\t\t\t},\n\t\t\tgetBlank: state => params =>\n\t\t\t{\n\t\t\t\treturn this.getElementState();\n\t\t\t},\n\t\t}\n\t}\n\n\tgetActions()\n\t{\n\t\treturn {\n\t\t\tset: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst result = {\n\t\t\t\t\tnotification: [],\n\t\t\t\t};\n\n\t\t\t\tif (payload.notification instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tresult.notification = payload.notification.map(notification => this.prepareNotification(notification, { host: store.state.host }));\n\t\t\t\t}\n\n\t\t\t\tif (Type.isNumber(payload.total) || Type.isString(payload.total))\n\t\t\t\t{\n\t\t\t\t\tresult.total = parseInt(payload.total);\n\t\t\t\t}\n\n\t\t\t\tstore.commit('set', result);\n\t\t\t},\n\t\t\tsetSearchResults: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst result = {\n\t\t\t\t\tnotification: [],\n\t\t\t\t};\n\n\t\t\t\tif (!(payload.notification instanceof Array))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// we don't need validation for the local results\n\t\t\t\tif (payload.type === 'local')\n\t\t\t\t{\n\t\t\t\t\tresult.notification = payload.notification;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult.notification = payload.notification.map(notification => this.prepareNotification(notification, { host: store.state.host }));\n\t\t\t\t}\n\n\t\t\t\tstore.commit('setSearchResults', {\n\t\t\t\t\tdata: result\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeleteSearchResults: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('deleteSearchResults');\n\t\t\t},\n\t\t\tsetCounter: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(payload.unreadTotal) || Type.isString(payload.unreadTotal))\n\t\t\t\t{\n\t\t\t\t\tconst unreadCounter = parseInt(payload.unreadTotal);\n\t\t\t\t\tstore.commit('setCounter', unreadCounter);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetTotal: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (Type.isNumber(payload.total) || Type.isString(payload.total))\n\t\t\t\t{\n\t\t\t\t\tstore.commit('setTotal', payload.total);\n\t\t\t\t}\n\t\t\t},\n\t\t\tadd: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst addItem = this.prepareNotification(payload.data, { host: store.state.host });\n\t\t\t\taddItem.unread = true;\n\n\t\t\t\tconst existingItem = this.findItemInArr(store.state.collection, addItem.id);\n\t\t\t\tif (!existingItem.element)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('add', {\n\t\t\t\t\t\tdata: addItem,\n\t\t\t\t\t});\n\n\t\t\t\t\tstore.commit('setTotal', store.state.total + 1);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\t\tfields: Object.assign({}, payload.fields),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdatePlaceholders: (store, payload) =>\n\t\t\t{\n\t\t\t\tif (payload.items instanceof Array)\n\t\t\t\t{\n\t\t\t\t\tpayload.items = payload.items.map(notification => this.prepareNotification(notification));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tstore.commit('updatePlaceholders', payload);\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tclearPlaceholders: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('clearPlaceholders', payload);\n\t\t\t},\n\t\t\tupdate: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingItem = this.findItemInArr(store.state.collection, payload.id);\n\t\t\t\tif (existingItem.element)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\t\tfields: Object.assign({}, payload.fields),\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (payload.searchMode)\n\t\t\t\t{\n\t\t\t\t\tconst existingItemInSearchCollection = this.findItemInArr(store.state.searchCollection, payload.id);\n\t\t\t\t\tif (existingItemInSearchCollection.element)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('update', {\n\t\t\t\t\t\t\tsearchCollection: true,\n\t\t\t\t\t\t\tindex: existingItemInSearchCollection.index,\n\t\t\t\t\t\t\tfields: Object.assign({}, payload.fields),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tread: (store, payload) =>\n\t\t\t{\n\t\t\t\tfor (const notificationId of payload.ids)\n\t\t\t\t{\n\t\t\t\t\tconst existingItem = this.findItemInArr(store.state.collection, notificationId);\n\t\t\t\t\tif (!existingItem.element)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tstore.commit('read', {\n\t\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\t\taction: !payload.action,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\treadAll: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('readAll');\n\t\t\t},\n\t\t\tdelete: (store, payload) =>\n\t\t\t{\n\t\t\t\tconst existingItem = this.findItemInArr(store.state.collection, payload.id);\n\t\t\t\tif (existingItem.element)\n\t\t\t\t{\n\t\t\t\t\tstore.commit('delete', {\n\t\t\t\t\t\tsearchCollection: false,\n\t\t\t\t\t\tindex: existingItem.index,\n\t\t\t\t\t});\n\n\t\t\t\t\tstore.commit('setTotal', store.state.total - 1);\n\t\t\t\t}\n\n\t\t\t\tif (payload.searchMode)\n\t\t\t\t{\n\t\t\t\t\tconst existingItemInSearchCollection = this.findItemInArr(store.state.searchCollection, payload.id);\n\t\t\t\t\tif (existingItemInSearchCollection.element)\n\t\t\t\t\t{\n\t\t\t\t\t\tstore.commit('delete', {\n\t\t\t\t\t\t\tsearchCollection: true,\n\t\t\t\t\t\t\tindex: existingItemInSearchCollection.index,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeleteAll: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('deleteAll');\n\t\t\t},\n\t\t\tsetSchema: (store, payload) =>\n\t\t\t{\n\t\t\t\tstore.commit('setSchema', {\n\t\t\t\t\tdata: payload.data,\n\t\t\t\t});\n\t\t\t},\n\t\t}\n\t}\n\n\tgetMutations()\n\t{\n\t\treturn {\n\t\t\tset: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.total = payload.hasOwnProperty('total') ? payload.total : state.total;\n\n\t\t\t\tif (!payload.hasOwnProperty('notification') || !Type.isArray(payload.notification))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfor (const element of payload.notification)\n\t\t\t\t{\n\t\t\t\t\tconst existingItem = this.findItemInArr(state.collection, element.id);\n\n\t\t\t\t\tif (!existingItem.element)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection.push(element);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t// we trust unread status of existing item to prevent notifications blinking while init loading.\n\t\t\t\t\t\tif (element.unread !== state.collection[existingItem.index].unread)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\telement.unread = state.collection[existingItem.index].unread;\n\t\t\t\t\t\t\tstate.unreadCounter = (element.unread === true ? state.unreadCounter + 1 : state.unreadCounter - 1);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstate.collection[existingItem.index] = Object.assign(\n\t\t\t\t\t\t\tstate.collection[existingItem.index],\n\t\t\t\t\t\t\telement\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstate.collection.sort(this.sortByType);\n\t\t\t},\n\t\t\tsetSearchResults: (state, payload) =>\n\t\t\t{\n\t\t\t\tfor (const element of payload.data.notification)\n\t\t\t\t{\n\t\t\t\t\tconst existingItem = this.findItemInArr(state.searchCollection, element.id);\n\n\t\t\t\t\tif (!existingItem.element)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.searchCollection.push(element);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.searchCollection[existingItem.index] = Object.assign(\n\t\t\t\t\t\t\tstate.searchCollection[existingItem.index],\n\t\t\t\t\t\t\telement\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeleteAll: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection = [];\n\t\t\t},\n\t\t\tdeleteSearchResults: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.searchCollection = [];\n\t\t\t},\n\t\t\tadd: (state, payload) =>\n\t\t\t{\n\t\t\t\tlet firstNotificationIndex = null;\n\t\t\t\tif (payload.data.sectionCode === NotificationTypesCodes.confirm)\n\t\t\t\t{\n\t\t\t\t\t//new confirms should always add to the beginning of the collection\n\t\t\t\t\tstate.collection.unshift(payload.data);\n\t\t\t\t}\n\t\t\t\telse //if (payload.data.sectionCode === NotificationTypesCodes.simple)\n\t\t\t\t{\n\t\t\t\t\tfor (let index = 0; state.collection.length > index; index++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (state.collection[index].sectionCode === NotificationTypesCodes.simple)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfirstNotificationIndex = index;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t//if we didn't find any simple notification and its index, then add new one to the end.\n\t\t\t\t\tif (firstNotificationIndex === null)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection.push(payload.data);\n\t\t\t\t\t}\n\t\t\t\t\telse //otherwise, put it right before first simple notification.\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.collection.splice(firstNotificationIndex, 0, payload.data);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstate.collection.sort(this.sortByType);\n\t\t\t},\n\t\t\tupdate: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst collectionName = payload.searchCollection ? 'searchCollection' : 'collection';\n\n\t\t\t\tVue.set(state[collectionName], payload.index, Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tstate[collectionName][payload.index],\n\t\t\t\t\tpayload.fields\n\t\t\t\t));\n\n\t\t\t},\n\t\t\tdelete: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst collectionName = payload.searchCollection ? 'searchCollection' : 'collection';\n\t\t\t\tstate[collectionName].splice(payload.index, 1);\n\t\t\t},\n\t\t\tread: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection[payload.index].unread = payload.action;\n\t\t\t},\n\t\t\treadAll: (state, payload) =>\n\t\t\t{\n\t\t\t\tfor (let index = 0; state.collection.length > index; index++)\n\t\t\t\t{\n\t\t\t\t\tstate.collection[index].unread = false;\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdatePlaceholders: (state, payload) =>\n\t\t\t{\n\t\t\t\tconst collectionName = payload.searchCollection ? 'searchCollection' : 'collection';\n\n\t\t\t\tpayload.items.forEach((element, index) => {\n\t\t\t\t\tconst placeholderId = `placeholder${payload.firstItem + index}`;\n\t\t\t\t\tconst existingPlaceholderIndex = state[collectionName].findIndex(notification => {\n\t\t\t\t\t\treturn notification.id === placeholderId;\n\t\t\t\t\t});\n\n\t\t\t\t\tconst existingMessageIndex = state[collectionName].findIndex(notification => {\n\t\t\t\t\t\treturn notification.id === element.id;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (existingMessageIndex >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tstate[collectionName][existingMessageIndex] = Object.assign(\n\t\t\t\t\t\t\tstate[collectionName][existingMessageIndex],\n\t\t\t\t\t\t\telement\n\t\t\t\t\t\t);\n\t\t\t\t\t\tstate[collectionName].splice(existingPlaceholderIndex, 1);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tstate[collectionName].splice(\n\t\t\t\t\t\t\texistingPlaceholderIndex,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tObject.assign({}, element)\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tstate[collectionName].sort(this.sortByType);\n\t\t\t},\n\t\t\tclearPlaceholders: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.collection = state.collection.filter(element => {\n\t\t\t\t\treturn !element.id.toString().startsWith('placeholder');\n\t\t\t\t});\n\n\t\t\t\tstate.searchCollection = state.searchCollection.filter(element => {\n\t\t\t\t\treturn !element.id.toString().startsWith('placeholder');\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetCounter: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.unreadCounter = payload;\n\t\t\t},\n\t\t\tsetTotal: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.total = payload;\n\t\t\t},\n\t\t\tsetSchema: (state, payload) =>\n\t\t\t{\n\t\t\t\tstate.schema = payload.data;\n\t\t\t}\n\t\t}\n\t}\n\n\t/* region Validation */\n\tvalidate(fields, options)\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isString(fields.id) || Type.isNumber(fields.id))\n\t\t{\n\t\t\tresult.id = fields.id;\n\t\t}\n\n\t\tif (!Type.isNil(fields.date))\n\t\t{\n\t\t\tresult.date = Utils.date.cast(fields.date);\n\t\t}\n\n\t\tif (Type.isString(fields.text) || Type.isNumber(fields.text))\n\t\t{\n\t\t\tresult.text = fields.text.toString();\n\t\t\tresult.textConverted = NotificationsModel.decodeText(result.text);\n\t\t}\n\n\t\tif (Type.isNumber(fields.author_id))\n\t\t{\n\t\t\tif (fields.system === true || fields.system === 'Y')\n\t\t\t{\n\t\t\t\tresult.authorId = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.authorId = fields.author_id;\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isNumber(fields.userId))\n\t\t{\n\t\t\tresult.authorId = fields.userId;\n\t\t}\n\n\t\tif (Type.isObjectLike(fields.params))\n\t\t{\n\t\t\tconst params = this.validateParams(fields.params);\n\t\t\tif (params)\n\t\t\t{\n\t\t\t\tresult.params = params;\n\t\t\t}\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_buttons))\n\t\t{\n\t\t\tresult.notifyButtons = JSON.parse(fields.notify_buttons);\n\t\t}\n\n\t\t//p&p format\n\t\tif (!Type.isNil(fields.buttons))\n\t\t{\n\t\t\tresult.notifyButtons = fields.buttons.map((button) => {\n\t\t\t\treturn {\n\t\t\t\t\tCOMMAND: 'notifyConfirm',\n\t\t\t\t\tCOMMAND_PARAMS: `${result.id}|${button.VALUE}`,\n\t\t\t\t\tTEXT: `${button.TITLE}`,\n\t\t\t\t\tTYPE: 'BUTTON',\n\t\t\t\t\tDISPLAY: 'LINE',\n\t\t\t\t\tBG_COLOR: (button.VALUE === 'Y' ? '#8bc84b' : '#ef4b57'),\n\t\t\t\t\tTEXT_COLOR: '#fff',\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\t\tif (fields.notify_type === NotificationTypesCodes.confirm || fields.type === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.confirm;\n\t\t}\n\t\telse if (fields.type === NotificationTypesCodes.placeholder)\n\t\t{\n\t\t\tresult.sectionCode = NotificationTypesCodes.placeholder;\n\t\t}\n\n\t\tif (!Type.isNil(fields.notify_read))\n\t\t{\n\t\t\tresult.unread = fields.notify_read === 'N';\n\t\t}\n\n\t\t//p&p format\n\t\tif (!Type.isNil(fields.read))\n\t\t{\n\t\t\tresult.unread = fields.read === 'N'; //?\n\t\t}\n\n\t\tif (Type.isString(fields.setting_name))\n\t\t{\n\t\t\tresult.settingName = fields.setting_name;\n\t\t}\n\n\t\t// rest format\n\t\tif (Type.isString(fields.notify_title) && fields.notify_title.length > 0)\n\t\t{\n\t\t\tresult.title = fields.notify_title;\n\t\t}\n\n\t\t// p&p format\n\t\tif (Type.isString(fields.title) && fields.title.length > 0)\n\t\t{\n\t\t\tresult.title = fields.title;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tvalidateParams(params)\n\t{\n\t\tconst result = {};\n\t\ttry\n\t\t{\n\t\t\tfor (let field in params)\n\t\t\t{\n\t\t\t\tif (!params.hasOwnProperty(field))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (field === 'COMPONENT_ID')\n\t\t\t\t{\n\t\t\t\t\tif (Type.isString(params[field]) && BX.Vue.isComponent(params[field]))\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'LIKE')\n\t\t\t\t{\n\t\t\t\t\tif (params[field] instanceof Array)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult['REACTION'] = {like: params[field].map(element => parseInt(element))};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'CHAT_LAST_DATE')\n\t\t\t\t{\n\t\t\t\t\tresult[field] = Utils.date.cast(params[field]);\n\t\t\t\t}\n\t\t\t\telse if (field === 'AVATAR')\n\t\t\t\t{\n\t\t\t\t\tif (params[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field].startsWith('http') ? params[field] : options.host + params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (field === 'NAME')\n\t\t\t\t{\n\t\t\t\t\tif (params[field])\n\t\t\t\t\t{\n\t\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tresult[field] = params[field];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcatch (e) {}\n\n\t\tlet hasResultElements = false;\n\t\tfor (let field in result)\n\t\t{\n\t\t\tif (!result.hasOwnProperty(field))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\thasResultElements = true;\n\t\t\tbreak\n\t\t}\n\n\t\treturn hasResultElements? result: null;\n\t}\n\t/* endregion Validation */\n\n\t/* region Internal helpers */\n\tprepareNotification(notification, options = {})\n\t{\n\t\tlet result = this.validate(Object.assign({}, notification));\n\n\t\treturn Object.assign({}, this.getElementState(), result, options);\n\t}\n\n\tfindItemInArr(arr, value, key = 'id')\n\t{\n\t\tconst result = {};\n\n\t\tconst elementIndex = arr.findIndex((element, index) => {\n\t\t\treturn element[key] === value;\n\t\t});\n\n\t\tif (elementIndex !== -1)\n\t\t{\n\t\t\tresult.index = elementIndex;\n\t\t\tresult.element = arr[elementIndex];\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tsortByType(a, b)\n\t{\n\t\tif (a.sectionCode === NotificationTypesCodes.confirm && b.sectionCode !== NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn -1;\n\t\t}\n\t\telse if (a.sectionCode !== NotificationTypesCodes.confirm && b.sectionCode === NotificationTypesCodes.confirm)\n\t\t{\n\t\t\treturn 1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn b.id - a.id;\n\t\t}\n\t}\n\t/* endregion Internal helpers */\n\n\tstatic decodeText(text: string)\n\t{\n\t\ttext = Text.decode(text.toString());\n\t\ttext = Utils.text.decode(text, {skipImages: true});\n\n\t\tconst Parser = Reflection.getClass('BX.Messenger.v2.Lib.Parser');\n\t\tif (Parser)\n\t\t{\n\t\t\ttext = Parser.decodeSmileForLegacyCore(text, {enableBigSmile: false});\n\t\t}\n\n\t\tif (!Utils.platform.isBitrixDesktop())\n\t\t{\n\t\t\ttext = text.replace(/<a(.*?)>(.*?)<\\/a>/gi, (whole, anchor, innerText) => {\n\t\t\t\treturn `<a ${anchor.replace('target=\"_blank\"', 'target=\"_self\"')} class=\"bx-im-notifications-item-link\">${innerText}</a>`;\n\t\t\t});\n\t\t}\n\n\t\treturn text;\n\t}\n}\n\nexport {NotificationsModel};"],"names":["ApplicationModel","common","host","getVariable","location","protocol","siteId","userId","languageId","dialog","dialogId","chatId","diskFolderId","messageLimit","enableReadMessages","messageExtraCount","disk","enabled","maxFileSize","call","serverEnabled","maxParticipants","mobile","keyboardShow","device","type","DeviceType","desktop","orientation","DeviceOrientation","portrait","options","quoteEnable","quoteFromRight","autoplayVideo","darkBackground","showSmiles","error","active","code","description","Object","assign","set","store","payload","commit","validate","hideSmiles","state","hasChange","group","hasOwnProperty","field","isSaveNeeded","saveState","increaseDialogExtraCount","count","decreaseDialogExtraCount","newCounter","clearDialogExtraCount","fields","result","toString","startsWith","substr","parseInt","isNaN","VuexBuilderModel","IntersectionType","empty","equal","none","found","foundReverse","MessagesModel","created","collection","mutationType","saveMessageList","saveFileList","saveUserList","templateId","templateType","placeholderType","id","authorId","date","Date","text","textConverted","params","TYPE","COMPONENT_ID","push","unread","sending","retry","blink","getMutationType","initialType","MutationType","appliedType","getLastId","length","lastId","i","element","getMessage","messageId","index","get","getBlank","getElementState","getSaveFileList","getSaveUserList","add","countMessages","message","getTime","dispatch","actionStart","test","Vue","nextTick","actionError","actionFinish","Array","map","prepareMessage","insertType","data","addPlaceholders","placeholders","requestMode","setBefore","setAfter","reverse","clearPlaceholders","updatePlaceholders","update","findIndex","el","setTimeout","elements","clear","keepPlaceholders","applyMutationType","readMessages","readId","unreadMessages","unreadId","initCollection","sort","a","b","Logger","warn","filter","firstPlaceholderId","firstMessage","firstPlaceholderIndex","splice","amount","chats","chatsSave","isPush","getPayloadWithTempMessages","forEach","StorageLimit","messages","includes","intersection","manageCacheBeforeSet","foundElements","removeIntersectionCacheElements","localMessage","isTemporaryMessage","unshift","getters","Set","every","EventEmitter","emit","EventType","messagesSet","readVisibleMessages","isSaveState","clearMessages","applied","scrollStickToTop","scrollMessageId","saveNeeded","updateSubordinateStates","concat","cache","recursive","noneElements","reverseResult","isSaveAvailable","readCounter","slice","FILE_ID","updateSaveLists","storedState","Utils","types","isUuidV4","uuid","chat_id","cast","textLegacy","convertToHtml","isConverted","text_converted","senderId","author_id","system","validateParams","BX","isComponent","like","e","hasResultElements","quote","image","enableBigSmile","trim","replace","quoteSign","indexOf","textPrepare","split","join","decodeBbCode","whole","p1","p2","p3","p4","offset","changed","aInner","match","doubleSmileSize","start","width","middle","height","end","textOnly","item","isArray","arrayElement","decodeAttach","prop","htmlspecialcharsback","putReplacement","sendReplacement","codeReplacement","link","tag","document","createElement","href","target","allowList","outerHTML","open","inner","close","openlines","number","htmlspecialchars","historyId","textElementSize","url","attrs","size","title","attributes","name","value","command","html","parentNode","innerHTML","src","payloadData","platform","isBitrixMobile","payloadChatId","existsInPayload","doesTaskExist","find","payloadMessage","foundUploadTasks","fileId","window","imDialogUploadTasks","task","taskId","foundMessageTask","imDialogMessagesTasks","DialoguesModel","saveDialogList","saveChatList","writingList","quoteId","counter","userCounter","messageCount","lastMessageId","managerList","readedList","muteList","textareaMessage","editId","init","owner","extranet","avatar","color","entityType","entityId","entityData1","entityData2","entityData3","dateCreate","restrictions","extend","leave","leaveOwner","rename","send","userList","mute","getByChatId","getQuoteId","getEditId","canSaveChat","canSaveDialog","isPrivateDialog","updateWriting","action","userName","actionName","updateReaded","increaseCounter","increasedCounter","rootState","application","dialogMuted","previousCounter","decreaseCounter","decreasedCounter","increaseMessageCounter","currentCounter","saveDialog","dialogues","cloneState","getElementStateSaveException","getState","dialog_id","user_counter","message_count","unread_id","last_message_id","readed_list","record","user_id","user_name","message_id","writing_list","manager_list","mute_list","entries","entry","ownerId","endsWith","encodeURI","entity_type","entity_id","entity_data_1","entity_data_2","entity_data_3","date_create","dateLastOpen","leave_owner","user_list","UsersModel","startOnlineCheckInterval","onlineList","mobileOnlineList","absentList","firstName","lastName","workPosition","gender","birthday","isBirthday","network","bot","connector","externalAuthId","status","idle","lastActivityDate","mobileLastDate","isOnline","isMobileOnline","absent","isAbsent","departments","phones","workPhone","personalMobile","personalPhone","innerPhone","getTemporary","getList","user","getOnlineStatus","addToOnlineList","mobileStatus","isMobileActive","addToMobileOnlineList","today","format","timeToNextMidnight","getTimeToNextMidnight","addToAbsentList","timeToNextDay","setInterval","startAbsentCheckInterval","newActivityDate","db","list","exceptionList","first_name","last_name","work_position","external_auth_id","last_activity_date","mobile_last_date","departmentId","work_phone","personal_mobile","personal_phone","inner_phone","nextMidnight","setHours","currentTime","absentEnd","intervalTime","users","FilesModel","extension","icon","FileStatus","done","progress","authorName","urlPreview","urlShow","urlDownload","viewerAttrs","file","getIconType","maxDiskFileSize","toLowerCase","FileType","video","audio","RecentModel","template","TemplateTypes","chatType","ChatTypes","chat","sectionCode","Section","general","lines","MessageStatus","received","pinned","Type","isNumber","currentItem","findItem","recentItem","prepareItem","existingItem","sortListByMessageDate","items","placeholderId","existingPlaceholder","pin","addPlaceholder","isStringFilled","isString","notification","isPlainObject","withAttach","WITH_ATTACH","withFile","WITH_FILE","purify","isDate","isBoolean","timestampA","timestampB","key","elementIndex","recent","NotificationsModel","searchCollection","total","unreadCounter","schema","NotificationTypesCodes","simple","display","settingName","getById","notificationId","findItemInArr","getSearchItemById","prepareNotification","setSearchResults","deleteSearchResults","setCounter","unreadTotal","setTotal","addItem","searchMode","existingItemInSearchCollection","read","ids","readAll","deleteAll","setSchema","sortByType","firstNotificationIndex","confirm","collectionName","firstItem","existingPlaceholderIndex","existingMessageIndex","isNil","decodeText","isObjectLike","notify_buttons","notifyButtons","JSON","parse","buttons","button","COMMAND","COMMAND_PARAMS","VALUE","TEXT","TITLE","DISPLAY","BG_COLOR","TEXT_COLOR","notify_type","placeholder","notify_read","setting_name","notify_title","arr","Text","decode","skipImages","Parser","Reflection","getClass","decodeSmileForLegacyCore","isBitrixDesktop","anchor","innerText"],"mappings":"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"}