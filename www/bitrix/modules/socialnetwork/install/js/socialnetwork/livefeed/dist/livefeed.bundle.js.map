{"version":3,"file":"livefeed.bundle.js","sources":["../src/utils.js","../src/pinned.js","../src/v2/api.js","../src/v2/const.js","../src/v2/card-builder.js","../src/v2/event-handler.js","../src/v2/task-creator.js","../src/taskcreator.js","../src/post.js","../src/informer.js","../src/loader.js","../src/morebutton.js","../src/forum.js","../src/filter.js","../src/contentview.js","../src/page.js","../src/commentform.js","../src/feed.js"],"sourcesContent":["class Utils\n{\n\tstatic setStyle(node, styles)\n\t{\n\t\tObject.entries(styles).forEach(([key, value]) => {\n\t\t\tnode.style[key] = value;\n\t\t});\n\t}\n}\n\nexport {\n\tUtils\n};\n","import { ajax, Event, Type, Loc, Dom, Tag } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuManager } from 'main.popup';\nimport { Utils } from \"./utils\";\n\nclass PinnedPanel\n{\n\tconstructor()\n\t{\n\t\tthis.class = {\n\t\t\tpin: 'feed-post-pin',\n\n\t\t\tpost: 'feed-item-wrap',\n\t\t\tpostHide: 'feed-item-wrap-hide',\n\t\t\tpostComments: 'feed-comments-block',\n\n\t\t\tpostPinned: 'feed-post-block-pinned',\n\t\t\tpostPinnedHide: 'feed-post-block-pinned-hide',\n\t\t\tpostPinActive: 'feed-post-block-pin-active',\n\t\t\tpostUnfollowed: 'feed-post-block-unfollowed',\n\n\t\t\tpostExpanding: 'feed-post-block-expand',\n\n\t\t\tpanelCollapsed: 'feed-pinned-panel-collapsed',\n\t\t\tpanelNonEmpty: 'feed-pinned-panel-nonempty',\n\t\t\tpanelPosts: 'feed-pinned-panel-posts',\n\n\t\t\tcollapsedPanel: 'feed-post-collapsed-panel',\n\t\t\tcollapsedPanelExpand: 'feed-post-collapsed-panel-right',\n\t\t\tcollapsedPanelCounterPostsValue: 'feed-post-collapsed-panel-count-posts',\n\t\t\tcollapsedPanelCounterComments: 'feed-post-collapsed-panel-box-comments',\n\t\t\tcollapsedPanelCounterCommentsValue: 'feed-post-collapsed-panel-count-comments-value',\n\t\t\tcollapsedPanelCounterCommentsShown: 'feed-post-collapsed-panel-box-shown',\n\t\t\tcollapsedPanelCounterCommentsValueNew: 'feed-inform-comments-pinned-new',\n\t\t\tcollapsedPanelCounterCommentsValueNewValue: 'feed-inform-comments-pinned-new-value',\n\t\t\tcollapsedPanelCounterCommentsValueNewActive: 'feed-inform-comments-pinned-new-active',\n\t\t\tcollapsedPanelCounterCommentsValueOld: 'feed-inform-comments-pinned-old',\n\t\t\tcollapsedPanelCounterCommentsValueAll: 'feed-inform-comments-pinned-all',\n\t\t\tcollapsedPanelShow: 'feed-post-collapsed-panel--show',\n\t\t\tcollapsedPanelHide: 'feed-post-collapsed-panel--hide',\n\n\t\t\tcancelPanel: 'feed-post-cancel-pinned-panel',\n\t\t\tcancelPanelButton: 'feed-post-cancel-pinned-btn',\n\t\t\tcancelPanelLabel: 'feed-post-cancel-pinned-label'\n\t\t};\n\n\t\tthis.panelInitialized = false;\n\t\tthis.postsInitialized = false;\n\t\tthis.handlePostClick = this.handlePostClick.bind(this);\n\t\tthis.options = {};\n\n\t\tEvent.ready(() => {\n\t\t\t/* for detail page without pinned panel */\n\t\t\tthis.initPosts();\n\t\t});\n\t}\n\n\tresetFlags()\n\t{\n\t\tthis.panelInitialized = false;\n\t\tthis.postsInitialized = false;\n\t}\n\n\tinit()\n\t{\n\t\t/* for list page in composite mode */\n\t\tthis.initPanel();\n\n\t\tthis.initPosts();\n\t\tthis.initEvents();\n\t}\n\n\tsetOptions(options)\n\t{\n\t\tthis.options = { ...this.options, ...options };\n\t}\n\n\tgetOption(optionName)\n\t{\n\t\treturn this.options[optionName];\n\t}\n\n\tinitPanel()\n\t{\n\t\tif (this.panelInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.panelInitialized = true;\n\n\t\tthis.adjustCollapsedPostsPanel();\n\n\t\tEvent.bind(this.getCollapsedPanelNode(), 'click', () => {\n\t\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\t\tif (!pinnedPanelNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst collapsedHeight = pinnedPanelNode.offsetHeight;\n\n\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\theight: collapsedHeight + 'px',\n\t\t\t\ttransition: 'height .5s'\n\t\t\t});\n\t\t\tsetTimeout(() => {\n\t\t\t\tpinnedPanelNode.style = '';\n\t\t\t}, 550);\n\t\t\tthis.hideCollapsedPanel();\n\t\t});\n\n\t\tEvent.bind(pinnedPanelNode, 'click', (event) => {\n\t\t\tconst likeClicked = event.target.classList.contains('feed-inform-ilike') || event.target.closest('.feed-inform-ilike') !== null;\n\t\t\tconst followClicked = event.target.classList.contains('feed-inform-follow') || event.target.closest('.feed-inform-follow') !== null;\n\t\t\tconst menuClicked = (\n\t\t\t\tevent.target.classList.contains('feed-post-more-link')\n\t\t\t\t|| event.target.closest('.feed-post-more-link') !== null\n\t\t\t\t|| event.target.classList.contains('feed-post-right-top-menu')\n\t\t\t);\n\t\t\tconst contentViewClicked = event.target.classList.contains('feed-inform-contentview') || event.target.closest('.feed-inform-contentview') !== null;\n\t\t\tconst pinClicked = event.target.classList.contains(`${this.class.pin}`) || event.target.closest(`.${this.class.pin}`) !== null;\n\t\t\tconst collapseClicked = event.target.classList.contains('feed-post-pinned-link-collapse');\n\t\t\tconst commentsClicked = event.target.classList.contains('feed-inform-comments-pinned') || event.target.closest('.feed-inform-comments-pinned') !== null;\n\n\t\t\tlet postNode = null;\n\n\t\t\tif (event.target.classList.contains('feed-post-block'))\n\t\t\t{\n\t\t\t\tpostNode = event.target;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tpostNode = event.target.closest('.feed-post-block');\n\t\t\t}\n\n\t\t\tif (!postNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (postNode.classList.contains(`${this.class.postPinned}`))\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\t!likeClicked\n\t\t\t\t\t&& !followClicked\n\t\t\t\t\t&& !menuClicked\n\t\t\t\t\t&& !contentViewClicked\n\t\t\t\t\t&& !pinClicked\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tpostNode.classList.remove(`${this.class.postPinned}`);\n\n\t\t\t\t\tconst menuId = postNode.getAttribute('data-menu-id');\n\n\t\t\t\t\tif (menuId)\n\t\t\t\t\t{\n\t\t\t\t\t\tMenuManager.destroy(menuId);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst event = new BaseEvent({\n\t\t\t\t\t\tcompatData: [{\n\t\t\t\t\t\t\trootNode: postNode\n\t\t\t\t\t\t}],\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\trootNode: postNode\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tEventEmitter.emit('BX.Livefeed:recalculateComments', event);\n\t\t\t\t}\n\n\t\t\t\tif (commentsClicked)\n\t\t\t\t{\n\t\t\t\t\tconst anchorNode = postNode.querySelector(`.${this.class.postComments} a[name=comments]`);\n\n\t\t\t\t\tif (anchorNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst position = Dom.getPosition(anchorNode);\n\t\t\t\t\t\twindow.scrollTo(0, position.top - 200);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t\telse if (collapseClicked)\n\t\t\t{\n\t\t\t\tpostNode.classList.add(`${this.class.postPinned}`);\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t});\n\t}\n\n\tinitPosts()\n\t{\n\t\tif (this.postsInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst postList = document.querySelectorAll('[data-livefeed-post-pinned]');\n\t\tif (postList.length > 0)\n\t\t{\n\t\t\tthis.postsInitialized = true;\n\t\t}\n\n\t\tArray.from(postList).forEach((post) => {\n\t\t\tEvent.unbind(post, 'click', this.handlePostClick);\n\t\t\tEvent.bind(post, 'click', this.handlePostClick);\n\t\t});\n\t}\n\n\thandlePostClick(event)\n\t{\n\t\tif (!event.target.classList.contains(`${this.class.pin}`))\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tconst post = event.target.closest('[data-livefeed-id]');\n\n\t\tif (!post)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newState = (post.getAttribute('data-livefeed-post-pinned') === 'Y' ? 'N' : 'Y');\n\t\tconst logId = parseInt(post.getAttribute('data-livefeed-id'));\n\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.changePinned({\n\t\t\tlogId: logId,\n\t\t\tnewState: newState,\n\t\t\tevent: event\n\t\t\t\t}).then(() => {\n\t\t});\n\t}\n\n\tinitEvents()\n\t{\n\t\tEventEmitter.subscribe('OnUCCommentWasRead', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ xmlId, id, options ] = event.getData();\n\t\t\tconst { oldValue, newValue } = this.getCommentsData(xmlId);\n\n\t\t\tif (!!options.new)\n\t\t\t{\n\t\t\t\tthis.setCommentsData(xmlId, {\n\t\t\t\t\tnewValue: (Type.isInteger(newValue) ? (newValue - 1) : 0),\n\t\t\t\t\toldValue: (Type.isInteger(oldValue) ? (oldValue + 1) : 1)\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.incrementMaxListeners('OnUCCommentWasPulled');\n\t\tEventEmitter.subscribe('OnUCCommentWasPulled', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ id, data, params ] = event.getData();\n\t\t\tconst [ xmlId, commentId ] = id;\n\t\t\tconst { newValue, oldValue, allValue, follow } = this.getCommentsData(xmlId);\n\n\t\t\tconst commentsData = {\n\t\t\t\tallValue: (Type.isInteger(allValue) ? (allValue + 1) : 1)\n\t\t\t};\n\n\t\t\tif (parseInt(params.AUTHOR.ID) !== parseInt(BX.message('USER_ID')))\n\t\t\t{\n\t\t\t\tcommentsData.newValue = (Type.isInteger(newValue) ? (newValue + 1) : 1);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommentsData.oldValue = (Type.isInteger(oldValue) ? (oldValue + 1) : 1);\n\t\t\t}\n\n\t\t\tthis.setCommentsData(xmlId, commentsData);\n\t\t});\n\n\t\tEventEmitter.subscribe('OnUCommentWasDeleted', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ xmlId, id, data ] = event.getData();\n\t\t\tconst { oldValue, allValue } = this.getCommentsData(xmlId);\n\n\t\t\tthis.setCommentsData(xmlId, {\n\t\t\t\tallValue: (Type.isInteger(allValue) ? (allValue - 1) : 0),\n\t\t\t\toldValue: (Type.isInteger(oldValue) ? (oldValue - 1) : 0)\n\t\t\t});\n\t\t});\n\t}\n\n\tchangePinned(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst event = (params.event ? params.event : null);\n\n\t\tlet node = (params.node ? params.node : null);\n\t\tlet newState = (params.newState ? params.newState : null);\n\n\t\tconst panelNode = this.getPanelNode();\n\n\t\tif (\n\t\t\t!node\n\t\t\t&& !event\n\t\t\t&& logId > 0\n\t\t\t&& panelNode\n\t\t)\n\t\t{\n\t\t\tnode = panelNode.querySelector(`.${this.class.post} > [data-livefeed-id=\"${logId}\"]`);\n\t\t}\n\n\t\tif (\n\t\t\t!node\n\t\t\t&& event\n\t\t)\n\t\t{\n\t\t\tnode = event.target;\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (\n\t\t\t\t!!this.getOption('pinBlocked') ||\n\t\t\t\t!node\n\t\t\t\t|| !newState\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tthis.setPostState({\n\t\t\t\tnode: node,\n\t\t\t\tstate: newState\n\t\t\t});\n\n\t\t\tconst action = (\n\t\t\t\tnewState === 'Y'\n\t\t\t\t\t? 'socialnetwork.api.livefeed.logentry.pin'\n\t\t\t\t\t: 'socialnetwork.api.livefeed.logentry.unpin'\n\t\t\t);\n\n\t\t\tajax.runAction(action, {\n\t\t\t\tdata: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tlogId: logId\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tanalyticsLabel: {\n\t\t\t\t\tb24statAction: (newState === 'Y' ? 'pinLivefeedEntry' : 'unpinLivefeedEntry')\n\t\t\t\t}\n\t\t\t}).then(response => {\n\t\t\t\tif (!response.data.success)\n\t\t\t\t{\n\t\t\t\t\tthis.setPostState({\n\t\t\t\t\t\tnode: node,\n\t\t\t\t\t\tstate: (newState === 'Y' ? 'N' : 'Y')\n\t\t\t\t\t});\n\t\t\t\t\treturn resolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.movePost({\n\t\t\t\t\t\tnode: node,\n\t\t\t\t\t\tstate: newState\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\treturn resolve();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}, response => {\n\t\t\t\tthis.setPostState({\n\t\t\t\t\tnode: node,\n\t\t\t\t\tstate: (newState === 'Y' ? 'N' : 'Y')\n\t\t\t\t});\n\t\t\t\treturn resolve();\n\t\t\t});\n\t\t});\n\t}\n\n\tsetPostState(params)\n\t{\n\t\tconst state = (params.state ? params.state : null);\n\t\tconst node = (params.node ? params.node : null);\n\n\t\tif (\n\t\t\t!node\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst post = node.closest('[data-livefeed-post-pinned]');\n\t\tif (!post)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tpost.setAttribute('data-livefeed-post-pinned', state);\n\n\t\tif (state === 'Y')\n\t\t{\n\t\t\tpost.classList.add(`${this.class.postPinActive}`);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpost.classList.remove(`${this.class.postPinActive}`);\n\t\t}\n\n\t\tconst pin = post.querySelector(`.${this.class.pin}`);\n\t\tif (pin)\n\t\t{\n\t\t\tpin.setAttribute('title', Loc.getMessage(`SONET_EXT_LIVEFEED_PIN_TITLE_${state}`));\n\t\t}\n\t}\n\n\tgetPanelNode()\n\t{\n\t\treturn document.querySelector('[data-livefeed-pinned-panel]');\n\t}\n\n\tgetPinnedData(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction('socialnetwork.api.livefeed.logentry.getPinData', {\n\t\t\t\tdata: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tlogId: logId,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\theaders: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: Loc.getMessage('SONET_EXT_LIVEFEED_AJAX_ENTITY_HEADER_NAME'),\n\t\t\t\t\t\tvalue: params.entityValue || '',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: Loc.getMessage('SONET_EXT_LIVEFEED_AJAX_TOKEN_HEADER_NAME'),\n\t\t\t\t\t\tvalue: params.tokenValue || '',\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t}).then(response => {\n\t\t\t\treturn resolve(response.data);\n\t\t\t}, response => {\n\t\t\t\treturn reject();\n\t\t\t});\n\t\t})\n\t}\n\n\tmovePost(params)\n\t{\n\t\tconst state = (params.state ? params.state : null);\n\t\tconst node = (params.node ? params.node : null);\n\n\t\treturn new Promise((resolve, reject) => {\n\n\t\t\tif (\n\t\t\t\t!node\n\t\t\t\t|| !['Y', 'N'].includes(state)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst post = node.closest('[data-livefeed-post-pinned]');\n\t\t\tif (!post)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst logId = parseInt(post.getAttribute('data-livefeed-id'));\n\t\t\tif (!logId)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\t\tif (!pinnedPanelNode)\n\t\t\t{\n\t\t\t\treturn resolve();\n\t\t\t}\n\n\t\t\tconst postToMove = (post.parentNode.classList.contains(`${this.class.post}`) ? post.parentNode : post);\n\n\t\t\tconst entityValue = post.getAttribute('data-security-entity-pin');\n\t\t\tconst tokenValue = post.getAttribute('data-security-token-pin');\n\n\t\t\tif (state === 'Y')\n\t\t\t{\n\t\t\t\tconst originalPostHeight = postToMove.offsetHeight;\n\t\t\t\tpostToMove.setAttribute('bx-data-height', originalPostHeight);\n\n\t\t\t\tthis.getPinnedData({\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tentityValue: entityValue,\n\t\t\t\t\ttokenValue: tokenValue,\n\t\t\t\t}).then(data => {\n\t\t\t\t\tconst pinnedPanelTitleNode = post.querySelector('.feed-post-pinned-title');\n\t\t\t\t\tconst pinnedPanelDescriptionNode = post.querySelector('.feed-post-pinned-desc');\n\t\t\t\t\tconst pinnedPanelPinNode = post.querySelector(`.${this.class.pin}`);\n\n\t\t\t\t\tif (pinnedPanelTitleNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelTitleNode.innerHTML = data.TITLE;\n\t\t\t\t\t}\n\t\t\t\t\tif (pinnedPanelDescriptionNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelDescriptionNode.innerHTML = data.DESCRIPTION;\n\t\t\t\t\t}\n\t\t\t\t\tif (pinnedPanelPinNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpinnedPanelPinNode.title = Loc.getMessage('SONET_EXT_LIVEFEED_PIN_TITLE_Y');\n\t\t\t\t\t}\n\n\t\t\t\t\tpost.classList.add(`${this.class.postPinnedHide}`);\n\n\t\t\t\t\tconst cancelPinnedPanel = this.getCancelPinnedPanel({ logId });\n\t\t\t\t\tconst anchor = postToMove.nextSibling;\n\n\t\t\t\t\tanchor.parentNode.insertBefore(cancelPinnedPanel, anchor);\n\t\t\t\t\tthis.centerCancelPinnedPanelElements({ cancelPinnedPanel });\n\n\t\t\t\t\tcancelPinnedPanel.setAttribute('bx-data-height', originalPostHeight);\n\t\t\t\t\tconst cancelPanelHeight = cancelPinnedPanel.getAttribute('bx-data-height');\n\n\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\theight: cancelPanelHeight + 'px'\n\t\t\t\t\t});\n\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\theight: originalPostHeight + 'px',\n\t\t\t\t\t\tbackgroundColor: 'transparent',\n\t\t\t\t\t\topacity: 0\n\t\t\t\t\t});\n\n\t\t\t\t\tconst panelNode = this.getPanelNode();\n\t\t\t\t\tif (panelNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\tpanelHeight: panelNode.offsetHeight\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// list.post::hide.start, cancelPanel::show.start\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tpostToMove.classList.add(`${this.class.postHide}`);\n\t\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\t\theight: '53px'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\t\topacity: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\tpinBlocked: true\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 100);\n\n\t\t\t\t\t// list.post::hide.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\n\t\t\t\t\t\tconst panelPostsNode = pinnedPanelNode.querySelector(`.${this.class.panelPosts}`);\n\n\t\t\t\t\t\tpanelPostsNode.insertBefore(postToMove, panelPostsNode.firstChild);\n\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\n\t\t\t\t\t\tpostToMove.classList.remove(`${this.class.postHide}`);\n\t\t\t\t\t\tpost.classList.remove(`${this.class.postPinnedHide}`);\n\n\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t\tthis.showCollapsedPostsPanel();\n\n\t\t\t\t\t\t// pinnedPanel.post::show.start\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tpost.classList.add(`${this.class.postPinned}`);\n\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\tposition: '',\n\t\t\t\t\t\t\t\twidth: '',\n\t\t\t\t\t\t\t\theight: '80px',\n\t\t\t\t\t\t\t\tbackgroundColor: '',\n\t\t\t\t\t\t\t\topacity: 1\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.setOptions({\n\t\t\t\t\t\t\t\tpinBlocked: false\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tpostToMove.classList.remove(`${this.class.postHide}`);\n\t\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\t\tposition: '',\n\t\t\t\t\t\t\t\t\twidth: '',\n\t\t\t\t\t\t\t\t\theight: '',\n\t\t\t\t\t\t\t\t\tbackgroundColor: '',\n\t\t\t\t\t\t\t\t\topacity: ''\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}, 600); // 600 > transition 0.5\n\n\t\t\t\t\t\t}, 300);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn resolve();\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst height = postToMove.getAttribute('bx-data-height');\n\t\t\t\tconst pinnedHeight = postToMove.scrollHeight;\n\n\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\ttransition: '',\n\t\t\t\t});\n\n\t\t\t\tconst cancelPinnedPanel = document.querySelector(`.${this.class.cancelPanel}[bx-data-log-id=\"${logId}\"]`);\n\t\t\t\tif (Type.isDomNode(cancelPinnedPanel))\n\t\t\t\t{\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\theight: pinnedHeight + 'px'\n\t\t\t\t\t});\n\n\t\t\t\t\t// pinnedPanel.post::hide.start, cancelPanel::show.start\n\t\t\t\t\trequestAnimationFrame(() => {\n\n\t\t\t\t\t\tpostToMove.classList.add(`${this.class.postExpanding}`);\n\t\t\t\t\t\tcancelPinnedPanel.classList.add(`${this.class.postExpanding}`);\n\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\theight: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\t\theight: 0\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tconst collapsed = pinnedPanelNode.classList.contains(`${this.class.panelCollapsed}`);\n\n\t\t\t\t\tif (collapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\tcancelPinnedPanel.parentNode.insertBefore(postToMove, cancelPinnedPanel.nextSibling);\n\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t}\n\n\t\t\t\t\tconst showCollapsed = this.getCollapsedPanelNode().classList.contains(`${this.class.collapsedPanelShow}`);\n\t\t\t\t\tif (showCollapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideCollapsedPostsPanel();\n\n\t\t\t\t\t\t// cancelPanel::show.end\n\t\t\t\t\t\tEvent.unbindAll(cancelPinnedPanel, 'transitionend');\n\t\t\t\t\t\tEvent.bind(cancelPinnedPanel, 'transitionend', (event) => {\n\t\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\t\ttransform: '',\n\t\t\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.animateCancel({\n\t\t\t\t\t\t\t\tpost,\n\t\t\t\t\t\t\t\tpostToMove,\n\t\t\t\t\t\t\t\tcancelPinnedPanel,\n\t\t\t\t\t\t\t\theight\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// pinnedPanel.post::hide.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'opacity'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!collapsed)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcancelPinnedPanel.parentNode.insertBefore(postToMove, cancelPinnedPanel.nextSibling);\n\t\t\t\t\t\t\tthis.adjustCollapsedPostsPanel();\n\t\t\t\t\t\t\tthis.adjustPanel();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.animateCancel({\n\t\t\t\t\t\t\tpost,\n\t\t\t\t\t\t\tpostToMove,\n\t\t\t\t\t\t\tcancelPinnedPanel,\n\t\t\t\t\t\t\theight\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tpost.classList.remove(`${this.class.postPinned}`);\n\t\t\t\t\tpinnedPanelNode.parentNode.insertBefore(postToMove, pinnedPanelNode.nextSibling);\n\t\t\t\t\tthis.adjustPanel();\n\n\t\t\t\t\tconst originalPostHeight = postToMove.scrollHeight;\n\t\t\t\t\tpostToMove.setAttribute('bx-data-height', originalPostHeight);\n\n\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\theight: '80px'\n\t\t\t\t\t});\n\n\t\t\t\t\t// list.post::show.start\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\t\theight: originalPostHeight + 'px'\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 100);\n\n\t\t\t\t\t// list.post::show.end\n\t\t\t\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\t\t\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\t\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\t\t\t\theight:''\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\treturn resolve();\n\t\t\t}\n\t\t});\n\t}\n\n\tanimateCancel({\n\t\tpost,\n\t \tpostToMove,\n\t\tcancelPinnedPanel,\n\t\theight\n\t})\n\t{\n\t\tpost.classList.remove(`${this.class.postPinned}`);\n\n\t\t// post.list:show.start, cancelPanel::hide.start\n\t\tsetTimeout(() => {\n\n\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\topacity: 1,\n\t\t\t\theight: height + 'px'\n\t\t\t});\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\theight: 0\n\t\t\t});\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tcancelPinnedPanel.remove();\n\t\t\t}, 100)\n\t\t}, 100);\n\n\t\t// post.list:show.end\n\t\tEvent.unbindAll(postToMove, 'transitionend');\n\t\tEvent.bind(postToMove, 'transitionend', (event) => {\n\t\t\tif (!this.checkTransitionProperty(event, 'height'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tpost.classList.remove(`${this.class.postPinnedHide}`);\n\n\t\t\tUtils.setStyle(postToMove, {\n\t\t\t\tmarginBottom: '',\n\t\t\t\theight: ''\n\t\t\t});\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\tmarginBottom: '',\n\t\t\t\theight: ''\n\t\t\t});\n\n\t\t\tpostToMove.classList.remove(`${this.class.postExpanding}`);\n\t\t\tcancelPinnedPanel.classList.remove(`${this.class.postExpanding}`);\n\t\t});\n\t}\n\n\tgetCancelPinnedPanel(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (logId <= 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet cancelPinnedPanel = document.querySelector(`.${this.class.cancelPanel}[bx-data-log-id=\"${logId}\"]`);\n\n\t\tif (!Type.isDomNode(cancelPinnedPanel))\n\t\t{\n\t\t\tcancelPinnedPanel = Tag.render`\n\t\t\t\t<div class=\"${this.class.cancelPanel}\" bx-data-log-id=\"${logId}\">\n\t\t\t\t\t<div class=\"feed-post-cancel-pinned-panel-inner\">\n\t\t\t\t\t\t<div class=\"feed-post-cancel-pinned-content\">\n\t\t\t\t\t\t\t<span class=\"${this.class.cancelPanelLabel}\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_TITLE')}</span>\n\t\t\t\t\t\t\t<span class=\"feed-post-cancel-pinned-text\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_DESCRIPTION')}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-round ui-btn-sm ${this.class.cancelPanelButton}\">${Loc.getMessage('SONET_EXT_LIVEFEED_PINNED_CANCEL_BUTTON')}</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t\t`;\n\n\t\t\tEvent.bind(cancelPinnedPanel.querySelector(`.${this.class.cancelPanelButton}`), 'click', () => {\n\t\t\t\tthis.changePinned({\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tnewState: 'N'\n\t\t\t\t}).then(() => {\n\t\t\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\t\t\topacity: 0,\n\t\t\t\t\t\theight: 0\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\treturn cancelPinnedPanel;\n\t}\n\n\tcenterCancelPinnedPanelElements({ cancelPinnedPanel })\n\t{\n\t\tif (!Type.isDomNode(cancelPinnedPanel))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t// cancelPanel::show.start\n\t\tsetTimeout(() => {\n\t\t\tUtils.setStyle(cancelPinnedPanel, {\n\t\t\t\topacity: 1\n\t\t\t});\n\t\t}, 100);\n\n\t\tUtils.setStyle(cancelPinnedPanel.querySelector(`.${this.class.cancelPanelLabel}`), {\n\t\t\tmarginLeft: cancelPinnedPanel.querySelector(`.${this.class.cancelPanelButton}`).getBoundingClientRect().width + 'px'\n\t\t});\n\t}\n\n\tgetPostsCount()\n\t{\n\t\tconst panelNode = this.getPanelNode();\n\t\treturn (panelNode ? Array.from(panelNode.getElementsByClassName(`${this.class.post}`)).length : 0);\n\t}\n\n\thidePinnedItems()\n\t{\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\theight: parseInt(this.getOption('panelHeight')) + 'px'\n\t\t});\n\n\t\tArray.from(pinnedPanelNode.getElementsByClassName(`${this.class.post}`)).reduce((count, item) => {\n\n\t\t\tcount += item.offsetHeight;\n\n\t\t\tUtils.setStyle(item, {\n\t\t\t\ttransition: 'opacity .1s linear, transform .2s .1s linear, height .5s linear'\n\t\t\t});\n\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\ttransition: 'height .5s .1s linear'\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::hide.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\topacity: '0!important',\n\t\t\t\t\ttransform: `translateY(-${count}px)`\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: '58px'\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::hide.end\n\t\t\tEvent.unbindAll(item, 'transitionend');\n\t\t\tEvent.bind(item, 'transitionend', (event) => {\n\t\t\t\tif (!this.checkTransitionProperty(event, 'transform'))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\tdisplay: 'none',\n\t\t\t\t\topacity: '',\n\t\t\t\t\ttransform: '',\n\t\t\t\t\ttransition: ''\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\ttransition: ''\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn count;\n\t\t}, 0);\n\t}\n\n\tshowPinnedItems()\n\t{\n\t\tconst pinnedPanelNode = this.getPanelNode();\n\t\tif (!pinnedPanelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tArray.from(pinnedPanelNode.getElementsByClassName(`${this.class.post}`)).map((item, currentIndex, originalItemsList) => {\n\n\t\t\tUtils.setStyle(item, {\n\t\t\t\tdisplay: 'block',\n\t\t\t\topacity: 0\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::show.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: ((84 * (currentIndex + 1)) - 4) + 'px'\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\ttransform: `translateY(${0}px)`,\n\t\t\t\t\topacity: 1\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// pinnedPanel.post::show.end\n\t\t\tEvent.unbindAll(item, 'transitionend');\n\t\t\tEvent.bind(item, 'transitionend', (event) => {\n\t\t\t\tif (!this.checkTransitionProperty(event, 'transform'))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tUtils.setStyle(item, {\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\theight: '',\n\t\t\t\t\ttransform: ''\n\t\t\t\t});\n\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\theight: ''\n\t\t\t\t});\n\n\t\t\t\tif ((currentIndex + 1) === originalItemsList.length)\n\t\t\t\t{\n\t\t\t\t\tUtils.setStyle(pinnedPanelNode, {\n\t\t\t\t\t\ttransition: '',\n\t\t\t\t\t\theight: ''\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tanimateCollapsedPanel()\n\t{\n\t\t// collapsedPanel::hide.start\n\t\trequestAnimationFrame(() => {\n\t\t\tconst collapsedPanel = this.getCollapsedPanelNode();\n\n\t\t\tUtils.setStyle(collapsedPanel, {\n\t\t\t\tposition: 'absolute',\n\t\t\t\ttop: 0,\n\t\t\t\twidth: '100%',\n\t\t\t\topacity: 0\n\t\t\t});\n\n\t\t\tcollapsedPanel.classList.remove(`${this.class.collapsedPanelHide}`);\n\t\t\tcollapsedPanel.classList.add(`${this.class.collapsedPanelShow}`);\n\n\t\t\t// collapsedPanel::show.start\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tUtils.setStyle(collapsedPanel, {\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\topacity: 1\n\t\t\t\t});\n\t\t\t});\n\t\t})\n\t}\n\n\tadjustCollapsedPostsPanel()\n\t{\n\t\tconst postsCounter = this.getPostsCount();\n\t\tconst postsCounterNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterPostsValue}`);\n\t\tif (postsCounterNode)\n\t\t{\n\t\t\tpostsCounterNode.innerHTML = parseInt(postsCounter);\n\t\t}\n\n\t\tconst commentsCounterNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterComments}`);\n\t\tconst commentsCounterValueNode = this.getCollapsedPanelNode().querySelector(`.${this.class.collapsedPanelCounterCommentsValue}`);\n\t\tconst panelNode = this.getPanelNode();\n\n\t\tif (\n\t\t\tcommentsCounterNode\n\t\t\t&& commentsCounterValueNode\n\t\t\t&& panelNode\n\t\t)\n\t\t{\n\t\t\tconst newCommentCounter = Array.from(panelNode.querySelectorAll(`.${this.class.collapsedPanelCounterCommentsValueNewValue}`)).reduce((acc, node) => {\n\t\t\t\treturn acc + (node.closest(`.${this.class.postUnfollowed}`) ? 0 : parseInt(node.innerHTML));\n\t\t\t}, 0);\n\n\t\t\tcommentsCounterValueNode.innerHTML = newCommentCounter;\n\t\t\tif (newCommentCounter > 0)\n\t\t\t{\n\t\t\t\tcommentsCounterNode.classList.add(`${this.class.collapsedPanelCounterCommentsShown}`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcommentsCounterNode.classList.remove(`${this.class.collapsedPanelCounterCommentsShown}`);\n\t\t\t}\n\t\t}\n\t}\n\n\tadjustPanel()\n\t{\n\t\tconst panelNode = this.getPanelNode();\n\t\tif (!panelNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tif (this.getPostsCount() > 0)\n\t\t\t{\n\t\t\t\tpanelNode.classList.add(`${this.class.panelNonEmpty}`);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tpanelNode.classList.remove(`${this.class.panelNonEmpty}`);\n\t\t\t}\n\t\t}, 0);\n\t}\n\n\tshowCollapsedPostsPanel()\n\t{\n\t\tif (this.getPostsCount() >= Loc.getMessage('SONET_EXT_LIVEFEED_COLLAPSED_PINNED_PANEL_ITEMS_LIMIT'))\n\t\t{\n\t\t\tthis.showCollapsedPanel();\n\t\t\tthis.hidePinnedItems();\n\t\t}\n\t}\n\n\thideCollapsedPostsPanel()\n\t{\n\t\tif (this.getPostsCount() < Loc.getMessage('SONET_EXT_LIVEFEED_COLLAPSED_PINNED_PANEL_ITEMS_LIMIT'))\n\t\t{\n\t\t\tthis.getPanelNode().classList.remove(`${this.class.panelCollapsed}`);\n\t\t\tthis.removeCollapsedPanel();\n\t\t\tthis.showPinnedItems();\n\t\t}\n\t}\n\n\tshowCollapsedPanel()\n\t{\n\t\tthis.getPanelNode().classList.add(`${this.class.panelCollapsed}`);\n\t\tthis.animateCollapsedPanel();\n\t}\n\n\thideCollapsedPanel()\n\t{\n\t\tthis.getPanelNode().classList.remove(`${this.class.panelCollapsed}`);\n\t\tthis.showPinnedItems();\n\t\tthis.removeCollapsedPanel();\n\t}\n\n\tremoveCollapsedPanel()\n\t{\n\t\tconst collapsedPanel = this.getCollapsedPanelNode();\n\n\t\tUtils.setStyle(collapsedPanel, {\n\t\t\tposition: 'absolute',\n\t\t\ttop: 0,\n\t\t\twidth: '100%'\n\t\t});\n\n\t\tcollapsedPanel.classList.remove(`${this.class.collapsedPanelShow}`);\n\t\tcollapsedPanel.classList.add(`${this.class.collapsedPanelHide}`);\n\t}\n\n\tgetCommentsNodes(xmlId)\n\t{\n\t\tconst result = {\n\t\t\tfollow: true,\n\t\t\tnewNode: null,\n\t\t\tnewValueNode: null,\n\t\t\toldNode: null,\n\t\t\tallNode: null\n\t\t};\n\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst commentsNode = document.querySelector(`.${this.class.postComments}[data-bx-comments-entity-xml-id=\"${xmlId}\"]`);\n\t\tif (!commentsNode)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst postNode = commentsNode.closest(`.${this.class.postPinActive}`);\n\t\tif (!postNode)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst newPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueNew}`);\n\t\tconst newValuePinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueNewValue}`);\n\t\tconst oldPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueOld}`);\n\t\tconst allPinnedCommentsNode = postNode.querySelector(`.${this.class.collapsedPanelCounterCommentsValueAll}`);\n\n\t\tif (\n\t\t\t!newPinnedCommentsNode\n\t\t\t|| !newValuePinnedCommentsNode\n\t\t\t|| !oldPinnedCommentsNode\n\t\t\t|| !allPinnedCommentsNode\n\n\t\t)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tresult.newNode = newPinnedCommentsNode;\n\t\tresult.newValueNode = newValuePinnedCommentsNode;\n\t\tresult.oldNode = oldPinnedCommentsNode;\n\t\tresult.allNode = allPinnedCommentsNode;\n\t\tresult.follow = (commentsNode.getAttribute('data-bx-follow') !== 'N');\n\n\t\treturn result;\n\t}\n\n\tgetCommentsData(xmlId)\n\t{\n\t\tconst result = {\n\t\t\tnewValue: null,\n\t\t\toldValue: null,\n\t\t\tallValue: null\n\t\t};\n\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tconst { newValueNode, oldNode, allNode, follow } = this.getCommentsNodes(xmlId);\n\n\t\tresult.follow = follow;\n\n\t\tif (\n\t\t\t!Type.isDomNode(newValueNode)\n\t\t\t|| !Type.isDomNode(oldNode)\n\t\t)\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tlet newCommentsValue = 0;\n\t\tlet oldCommentsValue = 0;\n\t\tlet allCommentsValue = 0;\n\n\t\tlet matches = newValueNode.innerHTML.match(/(\\d+)/);\n\n\t\tif (matches)\n\t\t{\n\t\t\tnewCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tmatches = oldNode.innerHTML.match(/(\\d+)/);\n\t\tif (matches)\n\t\t{\n\t\t\toldCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tmatches = allNode.innerHTML.match(/(\\d+)/);\n\t\tif (matches)\n\t\t{\n\t\t\tallCommentsValue = parseInt(matches[1]);\n\t\t}\n\n\t\tresult.oldValue = oldCommentsValue;\n\t\tresult.newValue = newCommentsValue;\n\t\tresult.allValue = allCommentsValue;\n\n\t\treturn result;\n\t}\n\n\tsetCommentsData(xmlId, value)\n\t{\n\t\tif (!Type.isStringFilled(xmlId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst { newNode, newValueNode, oldNode, allNode } = this.getCommentsNodes(xmlId);\n\t\tif (\n\t\t\t!Type.isDomNode(newNode)\n\t\t\t|| !Type.isDomNode(newValueNode)\n\t\t\t|| !Type.isDomNode(oldNode)\n\t\t\t|| !Type.isDomNode(allNode)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isInteger(value.newValue))\n\t\t{\n\t\t\tnewValueNode.innerHTML = `${value.newValue}`;\n\t\t\tif (\n\t\t\t\tvalue.newValue > 0\n\t\t\t\t&& !newNode.classList.contains(`${this.class.collapsedPanelCounterCommentsValueNewActive}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tnewNode.classList.add(`${this.class.collapsedPanelCounterCommentsValueNewActive}`);\n\t\t\t}\n\t\t\telse if (\n\t\t\t\tvalue.newValue <= 0\n\t\t\t\t&& newNode.classList.contains(`${this.class.collapsedPanelCounterCommentsValueNewActive}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tnewNode.classList.remove(`${this.class.collapsedPanelCounterCommentsValueNewActive}`);\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isInteger(value.oldValue))\n\t\t{\n\t\t\toldNode.innerHTML = value.oldValue;\n\t\t}\n\n\t\tif (Type.isInteger(value.allValue))\n\t\t{\n\t\t\tallNode.innerHTML = value.allValue;\n\t\t}\n\n\t\tthis.adjustCollapsedPostsPanel();\n\t}\n\n\tgetCollapsedPanelNode()\n\t{\n\t\treturn this.getPanelNode().querySelector(`.${this.class.collapsedPanel}`);\n\t}\n\n\tcheckTransitionProperty(event, propertyName)\n\t{\n\t\treturn (event.propertyName === propertyName);\n\t}\n}\n\nexport {\n\tPinnedPanel\n};\n","import { ajax, Type } from 'main.core';\nimport { CreateParams } from './types';\nimport type { TaskLinkData } from './types';\n\nexport class Api\n{\n\tstatic async getTaskLinkData(createParams: CreateParams): Promise<TaskLinkData>\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst { data: taskLinkData } = await ajax.runAction('intranet.controlbutton.getTaskLink', {\n\t\t\t\tdata: {\n\t\t\t\t\tentityType: createParams.entityType,\n\t\t\t\t\tentityId: createParams.entityId,\n\t\t\t\t\tpostEntityType: createParams.postEntityType,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\treturn taskLinkData;\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('TaskCreator: getTaskLinkData error', error);\n\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tstatic async clearNewTaskFiles(signedFiles: string): Promise<void>\n\t{\n\t\ttry\n\t\t{\n\t\t\tawait ajax.runAction('intranet.controlbutton.clearNewTaskFiles', {\n\t\t\t\tdata: { signedFiles },\n\t\t\t});\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('TaskCreator: Failed to clear files:', error);\n\t\t}\n\t}\n\n\tstatic async createEntityComment(taskId: number, createParams: CreateParams): Promise<void>\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst postEntityType = createParams.postEntityType;\n\n\t\t\tawait ajax.runAction('socialnetwork.api.livefeed.createEntityComment', {\n\t\t\t\tdata: {\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tpostEntityType: Type.isStringFilled(postEntityType) ? postEntityType : createParams.entityType,\n\t\t\t\t\t\tsourceEntityType: createParams.entityType,\n\t\t\t\t\t\tsourceEntityId: createParams.entityId,\n\t\t\t\t\t\tentityType: 'TASK',\n\t\t\t\t\t\tentityId: taskId,\n\t\t\t\t\t\tlogId: createParams.logId,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('TaskCreator: createEntityComment error', error);\n\t\t}\n\t}\n}\n","export const EntityType = Object.freeze({\n\tCalendarEvent: 'CALENDAR_EVENT',\n\tBlogPost: 'BLOG_POST',\n\tBlogComment: 'BLOG_COMMENT',\n});\n\nconst Context = Object.freeze({\n\tFeed: 'feed',\n});\n\nconst Element = Object.freeze({\n\tPostContextMenu: 'post_context_menu',\n\tCommentContextMenu: 'comment_context_menu',\n});\n\nexport const Analytics = Object.freeze({\n\tContext,\n\tElement,\n});\n","import { Loc, Type, Text } from 'main.core';\nimport type { AnalyticsParams } from 'tasks.v2.application.task-card';\nimport type { Source } from 'tasks.v2.model.tasks';\n\nimport { EntityType, Analytics } from './const';\nimport type { CardParams, CreateParams, TaskLinkData } from './types';\n\nexport class CardBuilder\n{\n\tstatic buildCardParams(createParams: CreateParams, requestData: TaskLinkData): CardParams\n\t{\n\t\tconst isFromComment = createParams.entityType === EntityType.BlogComment;\n\n\t\treturn {\n\t\t\ttaskId: `${createParams.entityType}_${Date.now()}`,\n\t\t\tcreateParams,\n\t\t\trequestData,\n\t\t\tdescription: this.#formatTaskDescription(createParams.entityType, requestData),\n\t\t\tgroupId: Number(requestData.GROUP_ID) || null,\n\t\t\tparentId: Number(requestData.PARENT_ID) || null,\n\t\t\tauditorsIds: requestData.AUDITORS.split(',').filter((id) => id).map(Number),\n\t\t\tfileIds: requestData.UF_TASK_WEBDAV_FILES,\n\t\t\tsource: this.#buildSourceParams(createParams),\n\t\t\tanalytics: this.#buildAnalyticsParams(isFromComment),\n\t\t};\n\t}\n\n\tstatic #buildAnalyticsParams(isFromComment: boolean): AnalyticsParams\n\t{\n\t\treturn {\n\t\t\tcontext: Analytics.Context.Feed,\n\t\t\telement: isFromComment ? Analytics.Element.CommentContextMenu : Analytics.Element.PostContextMenu,\n\t\t};\n\t}\n\n\tstatic #buildSourceParams(createParams: CreateParams): Source\n\t{\n\t\treturn {\n\t\t\ttype: createParams.entityType,\n\t\t\tentityId: Number(createParams.entityId),\n\t\t\tsubEntityId: Number(createParams.logId) || null,\n\t\t};\n\t}\n\n\tstatic #formatTaskDescription(entityType: string, requestData: TaskLinkData): string\n\t{\n\t\tconst text = Text.decode(requestData.DESCRIPTION);\n\t\tconst title = requestData.TITLE;\n\n\t\tconst url = new URL(requestData.URL, location).toString();\n\t\tconst suffix = (Type.isStringFilled(requestData.SUFFIX) ? `_${requestData.SUFFIX}` : '');\n\t\tconst headerLoc = `SONET_EXT_COMMENTAUX_CREATE_TASK_${entityType}${suffix}`;\n\t\tconst headerText = Loc.getMessage(headerLoc)\n\t\t\t.replace('#A_BEGIN#', `[URL=${url}]`)\n\t\t\t.replace('#A_END#', '[/URL]')\n\t\t;\n\n\t\tif (entityType === EntityType.BlogPost && Type.isStringFilled(title))\n\t\t{\n\t\t\treturn `[QUOTE]${headerText}\\n\\n[B]${title}[/B]\\n\\n${text}[/QUOTE]`;\n\t\t}\n\n\t\treturn `[QUOTE]${headerText}\\n\\n${text}[/QUOTE]`;\n\t}\n}\n","import { EventEmitter, type BaseEvent } from 'main.core.events';\nimport type { TaskModel } from 'tasks.task-model';\n\nimport { Api } from './api';\nimport { CardParams } from './types';\n\nconst createdTasks = new Set();\n\nexport const eventHandler = new class\n{\n\t#inited: boolean = false;\n\n\tinit(): void\n\t{\n\t\tif (this.#inited)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tEventEmitter.subscribe('tasks:card:taskAdded', this.#handleTaskAdded);\n\t\tEventEmitter.subscribe('tasks:full-card:closed', this.#handleCardClosed);\n\t\tEventEmitter.subscribe('tasks:card:closed', this.#handleCardClosed);\n\n\t\tthis.#inited = true;\n\t}\n\n\t#handleTaskAdded = (event: BaseEvent): void => {\n\t\tconst { task, initialTask }: { task: TaskModel, initialTask: CardParams } = event.getData();\n\n\t\tcreatedTasks.add(initialTask.id);\n\n\t\tvoid Api.createEntityComment(task.id, initialTask.createParams);\n\t};\n\n\t#handleCardClosed = (event: BaseEvent): void => {\n\t\tconst cardParams: CardParams = event.getData();\n\t\tif (createdTasks.has(cardParams.taskId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvoid Api.clearNewTaskFiles(cardParams.requestData.UF_TASK_WEBDAV_FILES_SIGN);\n\t};\n}();\n","import { Type } from 'main.core';\n\nimport { Api } from './api';\nimport { CardBuilder } from './card-builder';\nimport { eventHandler } from './event-handler';\nimport type { CreateParams } from './types';\n\nexport const createFromContent = async (createParams: CreateParams): Promise<void> => {\n\teventHandler.init();\n\n\tconst taskLinkData = await Api.getTaskLinkData(createParams);\n\n\tconst cardParams = CardBuilder.buildCardParams(createParams, taskLinkData);\n\n\tconst { TaskCard } = await top.BX.Runtime.loadExtension('tasks.v2.application.task-card');\n\n\tconst isFromComment = Type.isStringFilled(createParams.postEntityType);\n\tif (isFromComment)\n\t{\n\t\tTaskCard.showCompactCard(cardParams);\n\t}\n\telse\n\t{\n\t\tTaskCard.showFullCard(cardParams);\n\t}\n};\n","import { ajax, Type, Loc, Dom, Tag } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport { createFromContent } from './v2/task-creator';\n\nexport class TaskCreator\n{\n\tstatic createTaskPopup = null;\n\tstatic cssClass = {\n\t\tpopupContent: 'feed-create-task-popup-content',\n\t\tpopupTitle: 'feed-create-task-popup-title',\n\t\tpopupDescription: 'feed-create-task-popup-description',\n\t};\n\n\tstatic signedFiles = null;\n\tstatic sliderUrl = '';\n\n\tconstructor()\n\t{\n\t\tthis.initEvents();\n\t}\n\n\tinitEvents()\n\t{\n\t\tif (\n\t\t\tLoc.getMessage('SONET_EXT_LIVEFEED_INTRANET_INSTALLED') === 'Y'\n\t\t\t&& Loc.getMessage('SONET_EXT_LIVEFEED_isV2Form') === 'Y'\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tEventEmitter.subscribe('tasksTaskEvent', (event: BaseEvent) => {\n\t\t\tconst [type, data] = event.getCompatData();\n\t\t\tif (\n\t\t\t\ttype !== 'ADD'\n\t\t\t\t|| !Type.isPlainObject(data.options)\n\t\t\t\t|| !Type.isBoolean(data.options.STAY_AT_PAGE)\n\t\t\t\t|| data.options.STAY_AT_PAGE\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tTaskCreator.signedFiles = null;\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onCloseComplete', (event: BaseEvent) => {\n\t\t\tconst sliderInstance = event.getTarget();\n\t\t\tif (!sliderInstance)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst sliderUrl = sliderInstance.getUrl();\n\t\t\tif (\n\t\t\t\t!Type.isStringFilled(sliderUrl)\n\t\t\t\t|| sliderUrl !== TaskCreator.sliderUrl\n\t\t\t\t|| !Type.isStringFilled(TaskCreator.signedFiles)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tajax.runAction('intranet.controlbutton.clearNewTaskFiles', {\n\t\t\t\tdata: {\n\t\t\t\t\tsignedFiles: TaskCreator.signedFiles,\n\t\t\t\t},\n\t\t\t}).then(() => {\n\t\t\t\tTaskCreator.signedFiles = null;\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic async create(params)\n\t{\n\t\tif (\n\t\t\tLoc.getMessage('SONET_EXT_LIVEFEED_INTRANET_INSTALLED') === 'Y'\n\t\t\t&& Loc.getMessage('SONET_EXT_LIVEFEED_isV2Form') === 'Y'\n\t\t)\n\t\t{\n\t\t\tvoid createFromContent(params);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (Loc.getMessage('SONET_EXT_LIVEFEED_INTRANET_INSTALLED') === 'Y')\n\t\t{\n\t\t\tajax.runAction('intranet.controlbutton.getTaskLink', {\n\t\t\t\tdata: {\n\t\t\t\t\tentityType: params.entityType,\n\t\t\t\t\tentityId: params.entityId,\n\t\t\t\t\tpostEntityType: (Type.isStringFilled(params.postEntityType) ? params.postEntityType : params.entityType),\n\t\t\t\t\tentityData: {},\n\t\t\t\t},\n\t\t\t}).then((response) => {\n\t\t\t\tif (!Type.isStringFilled(response.data.SUFFIX))\n\t\t\t\t{\n\t\t\t\t\tresponse.data.SUFFIX = '';\n\t\t\t\t}\n\n\t\t\t\tconst requestData = response.data;\n\n\t\t\t\trequestData.DESCRIPTION = this.formatTaskDescription(requestData.DESCRIPTION, requestData.URL, params.entityType, requestData.SUFFIX);\n\n\t\t\t\tif (parseInt(params.parentTaskId) > 0)\n\t\t\t\t{\n\t\t\t\t\trequestData.PARENT_ID = parseInt(params.parentTaskId);\n\t\t\t\t}\n\n\t\t\t\tif (Type.isStringFilled(requestData.UF_TASK_WEBDAV_FILES_SIGN))\n\t\t\t\t{\n\t\t\t\t\tthis.signedFiles = requestData.UF_TASK_WEBDAV_FILES_SIGN;\n\t\t\t\t}\n\n\t\t\t\tthis.sliderUrl = response.data.link;\n\n\t\t\t\tconst link = this.getLinkWithAnalytics(response.data.link, params);\n\t\t\t\tBX.SidePanel.Instance.open(link, {\n\t\t\t\t\trequestMethod: 'post',\n\t\t\t\t\trequestParams: requestData,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.createTaskPopup = new Popup('BXCTP', null, {\n\t\t\t\tautoHide: false,\n\t\t\t\tzIndex: 0,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\toffsetTop: 0,\n\t\t\t\toverlay: false,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcloseIcon: {\n\t\t\t\t\tright: '12px',\n\t\t\t\t\ttop: '10px',\n\t\t\t\t},\n\t\t\t\tdraggable: {\n\t\t\t\t\trestrict: true,\n\t\t\t\t},\n\t\t\t\tcloseByEsc: false,\n\t\t\t\tcontentColor: 'white',\n\t\t\t\tcontentNoPaddings: true,\n\t\t\t\tbuttons: [],\n\t\t\t\tcontent: Tag.render`<div id=\"BXCTP_content\" class=\"${this.cssClass.popupContent}\"></div>`,\n\t\t\t\tevents: {\n\t\t\t\t\tonAfterPopupShow: () => {\n\t\t\t\t\t\tthis.createTaskSetContent(Tag.render`<div class=\"${this.cssClass.popupTitle}\">${Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_WAIT')}</div>`);\n\n\t\t\t\t\t\tajax.runAction('socialnetwork.api.livefeed.getRawEntryData', {\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\tentityType: params.entityType,\n\t\t\t\t\t\t\t\t\tentityId: params.entityId,\n\t\t\t\t\t\t\t\t\tlogId: (Type.isNumber(params.logId) ? params.logId : null),\n\t\t\t\t\t\t\t\t\tadditionalParams: {\n\t\t\t\t\t\t\t\t\t\tgetSonetGroupAvailable: 'Y',\n\t\t\t\t\t\t\t\t\t\tgetLivefeedUrl: 'Y',\n\t\t\t\t\t\t\t\t\t\tcheckPermissions: {\n\t\t\t\t\t\t\t\t\t\t\tfeature: 'tasks',\n\t\t\t\t\t\t\t\t\t\t\toperation: 'create_tasks',\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\t\tconst entryTitle = (Type.isStringFilled(response.data.TITLE) ? response.data.TITLE : '');\n\t\t\t\t\t\t\tconst entryDescription = (Type.isStringFilled(response.data.DESCRIPTION) ? response.data.DESCRIPTION : '');\n\t\t\t\t\t\t\tconst entryDiskObjects = (Type.isPlainObject(response.data.DISK_OBJECTS) ? response.data.DISK_OBJECTS : []);\n\t\t\t\t\t\t\tconst entryUrl = (Type.isStringFilled(response.data.LIVEFEED_URL) ? response.data.LIVEFEED_URL : '');\n\t\t\t\t\t\t\tconst entrySuffix = (Type.isStringFilled(response.data.SUFFIX) ? response.data.SUFFIX : '');\n\t\t\t\t\t\t\tconst groupsAvailable = (Type.isPlainObject(response.data.GROUPS_AVAILABLE) ? response.data.GROUPS_AVAILABLE : []);\n\t\t\t\t\t\t\tconst logId = (Type.isUndefined(response.data.LOG_ID) ? 0 : parseInt(response.data.LOG_ID));\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t\tType.isStringFilled(entryTitle)\n\t\t\t\t\t\t\t\t\t|| Type.isStringFilled(entryDescription)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t&& Type.isStringFilled(entryUrl)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tconst taskDescription = this.formatTaskDescription(entryDescription, entryUrl, params.entityType, entrySuffix);\n\t\t\t\t\t\t\t\tconst taskData = {\n\t\t\t\t\t\t\t\t\tTITLE: entryTitle,\n\t\t\t\t\t\t\t\t\tDESCRIPTION: taskDescription,\n\t\t\t\t\t\t\t\t\tRESPONSIBLE_ID: Loc.getMessage('USER_ID'),\n\t\t\t\t\t\t\t\t\tCREATED_BY: Loc.getMessage('USER_ID'),\n\t\t\t\t\t\t\t\t\tUF_TASK_WEBDAV_FILES: entryDiskObjects,\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tconst sonetGroupIdList = [];\n\n\t\t\t\t\t\t\t\tfor (const [key, value] of Object.entries(groupsAvailable))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tsonetGroupIdList.push(value);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (sonetGroupIdList.length == 1)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttaskData.GROUP_ID = parseInt(sonetGroupIdList[0]);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (parseInt(params.entityType) > 0)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\ttaskData.PARENT_ID = parseInt(params.entityType);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tajax.runComponentAction('bitrix:tasks.task', 'legacyAdd', {\n\t\t\t\t\t\t\t\t\tmode: 'class',\n\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\tdata: taskData,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t}).then((response) => {\n\t\t\t\t\t\t\t\t\tconst resultData = response.data;\n\n\t\t\t\t\t\t\t\t\tthis.createTaskSetContentSuccess(resultData.DATA.ID);\n\n\t\t\t\t\t\t\t\t\tajax.runAction('socialnetwork.api.livefeed.createEntityComment', {\n\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\t\t\t\tpostEntityType: (Type.isStringFilled(params.postEntityType) ? params.postEntityType : params.entityType),\n\t\t\t\t\t\t\t\t\t\t\t\tsourceEntityType: params.entityType,\n\t\t\t\t\t\t\t\t\t\t\t\tsourceEntityId: params.entityId,\n\t\t\t\t\t\t\t\t\t\t\t\tentityType: 'TASK',\n\t\t\t\t\t\t\t\t\t\t\t\tentityId: resultData.DATA.ID,\n\t\t\t\t\t\t\t\t\t\t\t\tlogId: (\n\t\t\t\t\t\t\t\t\t\t\t\t\tType.isNumber(params.logId)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? params.logId\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: (logId > 0 ? logId : null)\n\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t}).then(() => {}, () => {});\n\t\t\t\t\t\t\t\t}, (response) => {\n\t\t\t\t\t\t\t\t\tif (response.errors && response.errors.length > 0)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tconst errors = [];\n\t\t\t\t\t\t\t\t\t\tresponse.errors.forEach((error) => {\n\t\t\t\t\t\t\t\t\t\t\terrors.push(error.message);\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\tthis.createTaskSetContentFailure(errors);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.createTaskSetContentFailure([\n\t\t\t\t\t\t\t\t\tLoc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_ERROR_GET_DATA'),\n\t\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\tthis.createTaskSetContentFailure([\n\t\t\t\t\t\t\t\tLoc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_ERROR_GET_DATA'),\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tthis.createTaskPopup.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.createTaskPopup.show();\n\t\t}\n\t}\n\n\tstatic getLinkWithAnalytics(link, params)\n\t{\n\t\tconst postEntityType = Type.isStringFilled(params.postEntityType) ? params.postEntityType : params.entityType;\n\n\t\tconst analyticsElement = Type.isNil(params.postEntityType) ? 'context_menu' : 'comment_context_menu';\n\t\tlet analyticsSection;\n\t\tswitch (postEntityType)\n\t\t{\n\t\t\tcase 'TASK':\n\t\t\t\tanalyticsSection = 'tasks';\n\t\t\t\tbreak;\n\t\t\tcase 'CALENDAR_EVENT':\n\t\t\t\tanalyticsSection = 'calendar';\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tanalyticsSection = 'feed';\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn BX.Uri.addParam(link, {\n\t\t\tta_sec: analyticsSection,\n\t\t\tta_el: analyticsElement,\n\t\t});\n\t}\n\n\tstatic createTaskSetContentSuccess(taskId) {\n\t\tconst taskLink = Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_PATH').replace('#user_id#', Loc.getMessage('USER_ID')).replace('#task_id#', taskId);\n\n\t\tthis.createTaskPopup.destroy();\n\n\t\twindow.top.BX.UI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_SUCCESS_TITLE'),\n\t\t\tactions: [{\n\t\t\t\ttitle: Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_VIEW'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: (event, balloon, action) => {\n\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\twindow.top.BX.SidePanel.Instance.open(taskLink);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t}],\n\n\t\t});\n\t}\n\n\tstatic createTaskSetContentFailure(errors)\n\t{\n\t\tthis.createTaskSetContent(Tag.render`\n\t\t\t<div>\n\t\t\t\t\t\t<div class=\"${this.cssClass.popupTitle}\">${Loc.getMessage('SONET_EXT_LIVEFEED_CREATE_TASK_FAILURE_TITLE')}</div>\n\t\t\t\t\t\t<div class=\"${this.cssClass.popupDescription}\">${errors.join('<br>')}</div>\n\t\t\t\t\t</div>\n\t\t`);\n\t}\n\n\tstatic createTaskSetContent(contentNode)\n\t{\n\t\tconst containerNode = document.getElementById('BXCTP_content');\n\t\tif (!containerNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(containerNode);\n\t\tcontainerNode.appendChild(contentNode);\n\t}\n\n\tstatic formatTaskDescription(taskDescription, livefeedUrl, entityType, suffix)\n\t{\n\t\tlet result = taskDescription;\n\n\t\tsuffix = (Type.isStringFilled(suffix) ? `_${suffix}` : '');\n\n\t\tif (\n\t\t\tBoolean(livefeedUrl)\n\t\t\t&& Boolean(entityType)\n\t\t\t&& livefeedUrl.length > 0\n\t\t)\n\t\t{\n\t\t\tresult += `\\n\\n${Loc.getMessage(`SONET_EXT_COMMENTAUX_CREATE_TASK_${entityType}${suffix}`).replace('#A_BEGIN#', `[URL=${livefeedUrl}]`).replace('#A_END#', '[/URL]')}`;\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import {Type, Loc, Tag, Dom} from 'main.core';\nimport {Popup} from 'main.popup';\nimport {Button} from 'ui.buttons';\nimport {MenuManager} from 'main.popup';\nimport { PostForm } from 'socialnetwork.post-form';\n\nimport {FeedInstance, PinnedPanelInstance} from './feed';\nimport {TaskCreator} from './taskcreator';\n\nclass Post\n{\n\tstatic showBackgroundWarning({\n\t\turlToEdit,\n\t\tmenuPopupWindow\n\t})\n\t{\n\t\tconst content = Tag.render`<div>${Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_DESCRIPTION')}</div>`;\n\n\t\tconst dialog = new Popup('backgroundWarning', null, {\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tdraggable: true,\n\t\t\tbindOnResize: false,\n\t\t\ttitleBar: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_TITLE'),\n\t\t\tcloseIcon: true,\n\t\t\tclassName: 'sonet-livefeed-popup-warning',\n\t\t\tcontent: content,\n\t\t\tevents: {},\n\t\t\tcacheable: false,\n\t\t\tbuttons: [\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_BUTTON_SUBMIT'),\n\t\t\t\t\tclassName: 'ui-btn ui-btn-primary',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\twindow.location = urlToEdit;\n\t\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\t\tif (menuPopupWindow)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tmenuPopupWindow.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew Button({\n\t\t\t\t\ttext: Loc.getMessage('SONET_EXT_LIVEFEED_POST_BACKGROUND_EDIT_WARNING_BUTTON_CANCEL'),\n\t\t\t\t\tclassName: 'ui-btn ui-btn-light',\n\t\t\t\t\tevents : {click : () => {\n\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t\tif (menuPopupWindow)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmenuPopupWindow.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tdialog.show();\n\n\t\treturn false;\n\t}\n\n\tstatic showMenu(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tconst menuElement = params.menuElement;\n\t\tconst ind = params.ind;\n\t\tconst menuId = this.getMenuId(ind);\n\n\t\tMenuManager.destroy(menuId);\n\n\t\tlet log_id = (!Type.isUndefined(params.log_id) ? parseInt(params.log_id) : 0);\n\n\t\tif (log_id <= 0)\n\t\t{\n\t\t\tlog_id = parseInt(menuElement.getAttribute('data-log-entry-log-id'));\n\t\t}\n\t\tif (log_id <= 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tlet bFavorites = params.bFavorites;\n\t\tif (Type.isUndefined(bFavorites))\n\t\t{\n\t\t\tbFavorites = (menuElement.getAttribute('data-log-entry-favorites') === 'Y');\n\t\t}\n\n\t\tlet arMenuItemsAdditional = params.arMenuItemsAdditional;\n\t\tif (Type.isUndefined(arMenuItemsAdditional))\n\t\t{\n\t\t\tarMenuItemsAdditional = menuElement.getAttribute('data-bx-items');\n\t\t\ttry\n\t\t\t{\n\t\t\t\tarMenuItemsAdditional = JSON.parse(arMenuItemsAdditional);\n\t\t\t\tif (!Type.isPlainObject(arMenuItemsAdditional))\n\t\t\t\t{\n\t\t\t\t\tarMenuItemsAdditional = {};\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\tarMenuItemsAdditional = {};\n\t\t\t}\n\t\t}\n\n\t\tconst bindElement = params.bindElement;\n\n\t\tlet itemPinned = null;\n\t\tconst pinnedPostNode = bindElement.closest('[data-livefeed-post-pinned]');\n\t\tif (pinnedPostNode)\n\t\t{\n\t\t\tconst pinnedState = (pinnedPostNode.getAttribute('data-livefeed-post-pinned') === 'Y');\n\n\t\t\titemPinned = {\n\t\t\t\ttext : (pinnedState ? Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_PINNED_Y') : Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_PINNED_N')),\n\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\tonclick: (e) => {\n\t\t\t\t\tPinnedPanelInstance.changePinned({\n\t\t\t\t\t\tlogId: log_id,\n\t\t\t\t\t\tnewState: (pinnedState ? 'N' : 'Y'),\n\t\t\t\t\t\tevent: e,\n\t\t\t\t\t\tnode: bindElement,\n\t\t\t\t\t});\n\n\t\t\t\t\tMenuManager.getMenuById(this.getMenuId(ind)).popupWindow.close();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tconst itemFavorites = (\n\t\t\tLoc.getMessage('sonetLbUseFavorites') !== 'N'\n\t\t\t\t? {\n\t\t\t\t\ttext: (bFavorites ? Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_Y') : Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_N')),\n\t\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\t\tonclick : (e) => {\n\t\t\t\t\t\t__logChangeFavorites(\n\t\t\t\t\t\t\tlog_id,\n\t\t\t\t\t\t\t`log_entry_favorites_${log_id}`,\n\t\t\t\t\t\t\t(bFavorites ? 'N' : 'Y'),\n\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\te\n\t\t\t\t\t\t);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t: null\n\t\t);\n\n\t\tlet arItems = [\n\t\t\titemPinned,\n\t\t\titemFavorites,\n\t\t\t(\n\t\t\t\tType.isStringFilled(menuElement.getAttribute('data-log-entry-url'))\n\t\t\t\t\t? {\n\t\t\t\t\t\thtml: `<span id=\"${menuId}-href-text\">${Loc.getMessage('sonetLMenuHref')}</span>`,\n\t\t\t\t\t\tclassName: 'menu-popup-no-icon feed-entry-popup-menu feed-entry-popup-menu-href',\n\t\t\t\t\t\thref: menuElement.getAttribute('data-log-entry-url'),\n\t\t\t\t\t}\n\t\t\t\t\t: null\n\t\t\t),\n\t\t\t(\n\t\t\t\tType.isStringFilled(menuElement.getAttribute('data-log-entry-url'))\n\t\t\t\t\t? {\n\t\t\t\t\t\thtml: `<span id=\"${menuId}-link-text\">${Loc.getMessage('sonetLMenuLink')}</span>` +\n\t\t\t\t\t\t\t`<span id=\"${menuId}-link-icon-animate\" class=\"post-menu-link-icon-wrap\">` +\n\t\t\t\t\t\t\t`<span class=\"post-menu-link-icon\" id=\"${menuId}-link-icon-done\" style=\"display: none;\">` +\n\n\t\t\t\t\t\t\t'</span>' +\n\t\t\t\t\t\t\t'</span>',\n\t\t\t\t\t\tclassName : 'menu-popup-no-icon feed-entry-popup-menu feed-entry-popup-menu-link',\n\t\t\t\t\t\tonclick: (e) => {\n\n\t\t\t\t\t\t\tconst menuItemText = document.getElementById(`${menuId}-link-text`);\n\t\t\t\t\t\t\tconst menuItemIconDone = document.getElementById(`${menuId}-link-icon-done`);\n\n\t\t\t\t\t\t\tif (BX.clipboard.isCopySupported())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (menuItemText && menuItemText.getAttribute('data-block-click') === 'Y')\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tBX.clipboard.copy(menuElement.getAttribute('data-log-entry-url'));\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tmenuItemText\n\t\t\t\t\t\t\t\t\t&& menuItemIconDone\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tmenuItemIconDone.style.display = 'inline-block';\n\t\t\t\t\t\t\t\t\tdocument.getElementById(`${menuId}-link-icon-animate`).classList.remove('post-menu-link-icon-animate');\n\n\t\t\t\t\t\t\t\t\tDom.adjust(document.getElementById(`${menuId}-link-text`), {\n\t\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\t\t'data-block-click': 'Y',\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\tdocument.getElementById(`${menuId}-link-icon-animate`).classList.add('post-menu-link-icon-animate');\n\t\t\t\t\t\t\t\t\t}, 1);\n\n\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\tDom.adjust(document.getElementById(`${menuId}-link-text`), {\n\t\t\t\t\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\t\t\t\t\t'data-block-click': 'N',\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}, 500);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst it = e.currentTarget;\n\t\t\t\t\t\t\tconst height = parseInt(!!it.getAttribute('bx-height') ? it.getAttribute('bx-height') : it.offsetHeight);\n\n\t\t\t\t\t\t\tif (it.getAttribute('bx-status') !== 'shown')\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tit.setAttribute('bx-status', 'shown');\n\n\t\t\t\t\t\t\t\tconst node = document.getElementById(`${menuId}-link-text`);\n\n\t\t\t\t\t\t\t\tif (!document.getElementById(`${menuId}-link`) && !!node)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tconst pos = BX.pos(node);\n\t\t\t\t\t\t\t\t\tconst pos2 = BX.pos(node.parentNode);\n\t\t\t\t\t\t\t\t\tconst pos3 = BX.pos(node.closest('.menu-popup-item'));\n\n\t\t\t\t\t\t\t\t\tpos.height = pos2.height - 1;\n\n\t\t\t\t\t\t\t\t\tDom.adjust(it, {\n\t\t\t\t\t\t\t\t\t\tattrs : {\n\t\t\t\t\t\t\t\t\t\t\t'bx-height': it.offsetHeight,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tstyle : {\n\t\t\t\t\t\t\t\t\t\t\toverflow: 'hidden',\n\t\t\t\t\t\t\t\t\t\t\tdisplay: 'block'\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tchildren : [\n\t\t\t\t\t\t\t\t\t\t\tDom.create('BR'),\n\t\t\t\t\t\t\t\t\t\t\tDom.create('DIV', {\n\t\t\t\t\t\t\t\t\t\t\t\tattrs : {\n\t\t\t\t\t\t\t\t\t\t\t\t\tid: `${menuId}-link`,\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\tchildren : [\n\t\t\t\t\t\t\t\t\t\t\t\t\tDom.create('SPAN', {attrs: {className: 'menu-popup-item-left'}}),\n\t\t\t\t\t\t\t\t\t\t\t\t\tDom.create('SPAN', {attrs: {className: 'menu-popup-item-icon'}}),\n\t\t\t\t\t\t\t\t\t\t\t\t\tDom.create('SPAN', {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs: {className: 'menu-popup-item-text'},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tchildren : [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDom.create('INPUT', {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tattrs : {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tid: `${menuId}-link-input`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'text',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue: menuElement.getAttribute('data-log-entry-url'),\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle : {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\theight: `${pos.height}px`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth: `${(pos3.width - 21)}px`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclick: (e) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.currentTarget.select();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\tDom.create('SPAN', {attrs: {className: 'menu-popup-item-right'}}),\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\tEvent.bind(document.getElementById(`${menuId}-link-input`), 'click', (e) => {\n\t\t\t\t\t\t\t\t\t\te.currentTarget.select();\n\t\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\t\te.stopPropagation()\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t(new BX.fx({\n\t\t\t\t\t\t\t\t\ttime: 0.2,\n\t\t\t\t\t\t\t\t\tstep: 0.05,\n\t\t\t\t\t\t\t\t\ttype: 'linear',\n\t\t\t\t\t\t\t\t\tstart: height,\n\t\t\t\t\t\t\t\t\tfinish: height * 2,\n\t\t\t\t\t\t\t\t\tcallback: function (height) {\n\t\t\t\t\t\t\t\t\t\tthis.style.height = `${height}px`;\n\t\t\t\t\t\t\t\t\t}.bind(it),\n\t\t\t\t\t\t\t\t})).start();\n\t\t\t\t\t\t\t\tBX.fx.show(document.getElementById(`${menuId}-link`), 0.2);\n\t\t\t\t\t\t\t\tdocument.getElementById(`${menuId}-link-input`).select();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tit.setAttribute('bx-status', 'hidden');\n\t\t\t\t\t\t\t\t(new BX.fx({\n\t\t\t\t\t\t\t\t\ttime: 0.2,\n\t\t\t\t\t\t\t\t\tstep: 0.05,\n\t\t\t\t\t\t\t\t\ttype: 'linear',\n\t\t\t\t\t\t\t\t\tstart: it.offsetHeight,\n\t\t\t\t\t\t\t\t\tfinish: height,\n\t\t\t\t\t\t\t\t\tcallback: function(height) {\n\t\t\t\t\t\t\t\t\t\tthis.style.height = `${height}px`;\n\t\t\t\t\t\t\t\t\t}.bind(it),\n\t\t\t\t\t\t\t\t})).start();\n\t\t\t\t\t\t\t\tBX.fx.hide(document.getElementById(`${menuId}-link`), 0.2);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t: null\n\t\t\t),\n\t\t\t(\n\t\t\t\tLoc.getMessage('sonetLCanDelete') === 'Y'\n\t\t\t\t\t? {\n\t\t\t\t\t\ttext: Loc.getMessage('sonetLMenuDelete'),\n\t\t\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\t\t\tonclick: (e) => {\n\t\t\t\t\t\t\tif (confirm(Loc.getMessage('sonetLMenuDeleteConfirm')))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tFeedInstance.delete({\n\t\t\t\t\t\t\t\t\tlogId: log_id,\n\t\t\t\t\t\t\t\t\tnodeId: `log-entry-${log_id}`,\n\t\t\t\t\t\t\t\t\tind: ind,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t} : null\n\t\t\t),\n\t\t\t(\n\t\t\t\tmenuElement.getAttribute('data-log-entry-createtask') === 'Y'\n\t\t\t\t\t? {\n\t\t\t\t\t\ttext: Loc.getMessage('sonetLMenuCreateTask'),\n\t\t\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\t\t\tonclick: (e) => {\n\t\t\t\t\t\t\tTaskCreator.create({\n\t\t\t\t\t\t\t\tentryEntityType: menuElement.getAttribute('data-log-entry-entity-type'),\n\t\t\t\t\t\t\t\tentityType: menuElement.getAttribute('data-log-entry-entity-type'),\n\t\t\t\t\t\t\t\tentityId: menuElement.getAttribute('data-log-entry-entity-id'),\n\t\t\t\t\t\t\t\tlogId: parseInt(menuElement.getAttribute('data-log-entry-log-id')),\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tMenuManager.getMenuById(this.getMenuId(ind)).popupWindow.close();\n\t\t\t\t\t\t\treturn e.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t: null\n\t\t\t),\n\t\t\t(\n\t\t\t\tmenuElement.getAttribute('data-log-entry-createtask') === 'Y'\n\t\t\t\t&& menuElement.getAttribute('data-log-entry-entity-type') === 'TASK'\n\t\t\t\t\t? {\n\t\t\t\t\t\ttext: Loc.getMessage('sonetLMenuCreateSubTask'),\n\t\t\t\t\t\tclassName: 'menu-popup-no-icon',\n\t\t\t\t\t\tonclick: (e) => {\n\t\t\t\t\t\t\tTaskCreator.create({\n\t\t\t\t\t\t\t\tentryEntityType: menuElement.getAttribute('data-log-entry-entity-type'),\n\t\t\t\t\t\t\t\tentityType: menuElement.getAttribute('data-log-entry-entity-type'),\n\t\t\t\t\t\t\t\tentityId: menuElement.getAttribute('data-log-entry-entity-id'),\n\t\t\t\t\t\t\t\tlogId: parseInt(menuElement.getAttribute('data-log-entry-log-id')),\n\t\t\t\t\t\t\t\tparentTaskId: parseInt(menuElement.getAttribute('data-log-entry-entity-id')),\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tMenuManager.getMenuById(this.getMenuId(ind)).popupWindow.close();\n\t\t\t\t\t\t\treturn e.preventDefault();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t: null\n\t\t\t),\n\t\t];\n\n\t\tif (\n\t\t\t!!arMenuItemsAdditional\n\t\t\t&& Type.isArray(arMenuItemsAdditional)\n\t\t)\n\t\t{\n\t\t\tarMenuItemsAdditional.forEach((item) => {\n\t\t\t\tif (Type.isUndefined(item.className))\n\t\t\t\t{\n\t\t\t\t\titem.className = 'menu-popup-no-icon';\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tarItems = arItems.concat(arMenuItemsAdditional);\n\t\t}\n\n\t\tconst arParams = {\n\t\t\toffsetLeft: -14,\n\t\t\toffsetTop: 4,\n\t\t\tlightShadow: false,\n\t\t\tangle: {\n\t\t\t\tposition: 'top',\n\t\t\t\toffset : 50,\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonPopupShow: (ob) => {\n\t\t\t\t\tif (document.getElementById(`log_entry_favorites_${log_id}`))\n\t\t\t\t\t{\n\t\t\t\t\t\tlet favoritesMenuItem = null;\n\n\t\t\t\t\t\tconst menuItems = ob.contentContainer.querySelectorAll('.menu-popup-item-text');\n\t\t\t\t\t\tmenuItems.forEach((menuItem) => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tmenuItem.innerHTML === Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_Y')\n\t\t\t\t\t\t\t\t|| menuItem.innerHTML === Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_N')\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfavoritesMenuItem = menuItem;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (Type.isDomNode(favoritesMenuItem))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfavoritesMenuItem.innerHTML = (\n\t\t\t\t\t\t\t\tdocument.getElementById(`log_entry_favorites_${log_id}`).classList.contains('feed-post-important-switch-active')\n\t\t\t\t\t\t\t\t\t? Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_Y')\n\t\t\t\t\t\t\t\t\t: Loc.getMessage('SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_N')\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (document.getElementById(`${menuId}-link`))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst linkMenuItem = ob.popupContainer.querySelector('.feed-entry-popup-menu-link');\n\t\t\t\t\t\tif (linkMenuItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst height = parseInt(!!linkMenuItem.getAttribute('bx-height') ? linkMenuItem.getAttribute('bx-height') : 0);\n\t\t\t\t\t\t\tif (height > 0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdocument.getElementById(`${menuId}-link`).style.display = 'none';\n\t\t\t\t\t\t\t\tlinkMenuItem.setAttribute('bx-status', 'hidden');\n\t\t\t\t\t\t\t\tlinkMenuItem.style.height = `${height}px`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tMenuManager.show(this.getMenuId(ind), bindElement, arItems, arParams);\n\t}\n\n\tstatic getMenuId(ind)\n\t{\n\t\treturn `post-menu-${ind}`;\n\t}\n\n\tstatic editSpacesPost(postId: number, groupId: number)\n\t{\n\t\tconst postForm = new PostForm({\n\t\t\tpostId,\n\t\t\tgroupId,\n\t\t});\n\n\t\tpostForm.show();\n\t}\n}\n\nexport {\n\tPost\n};","import { Loc, Type, Runtime } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nclass Informer\n{\n\tconstructor()\n\t{\n\t\tthis.container = null;\n\t\tthis.wrap = null;\n\t\tthis.plus = null;\n\t\tthis.value = null;\n\n\t\tthis.currentSiteId = null;\n\t\tthis.currentCounterType = null;\n\n\t\tthis.counterDecrementStack = 0;\n\t\tthis.counterValue = 0;\n\n\t\tthis.lockCounterAnimation = null;\n\n\t\tthis.isSpaceFeatureEnabled = null;\n\t\tthis.currentUserId = null;\n\t\tthis.currentSpaceId = null;\n\n\t\tthis.class = {\n\t\t\tinformerFixed: 'feed-new-message-informer-fixed',\n\t\t\tinformerAnimation: 'feed-new-message-informer-anim',\n\t\t\tinformerFixedAnimation: 'feed-new-message-informer-fix-anim',\n\t\t\tcounterText: 'feed-new-message-inf-text',\n\t\t\tcounterContainer: 'feed-new-message-inf-text-counter',\n\t\t\treloadContainer: 'feed-new-message-inf-text-reload',\n\t\t\ticon: 'feed-new-message-icon',\n\t\t\ticonRotating: 'new-message-balloon-icon-rotating',\n\t\t\tplusHidden: 'feed-new-message-informer-counter-plus-hidden',\n\t\t};\n\t}\n\n\tinit(props = {})\n\t{\n\t\tconst defaultValues = { isSpaceFeatureEnabled: false, userId: null, spaceId: null };\n\t\tconst { isSpaceFeatureEnabled, userId, spaceId } = props || defaultValues;\n\t\tthis.isSpaceFeatureEnabled = isSpaceFeatureEnabled;\n\t\tthis.currentUserId = userId;\n\t\tthis.currentSpaceId = spaceId;\n\t\tthis.initNodes();\n\t\tthis.initEvents();\n\t}\n\n\tinitNodes()\n\t{\n\t\tthis.currentCounterType = Loc.hasMessage('sonetLCounterType') ? Loc.getMessage('sonetLCounterType') : '**';\n\t\tthis.currentSiteId = Loc.getMessage('SITE_ID');\n\n\t\tthis.container = document.getElementById('sonet_log_counter_2_container');\n\t\tif (this.container)\n\t\t{\n\t\t\tthis.container.addEventListener('click', this.showReloadAnimation.bind(this));\n\t\t}\n\n\t\tthis.wrap = document.getElementById('sonet_log_counter_2_wrap');\n\t\tthis.plus = document.getElementById('sonet_log_counter_2_plus');\n\t\tthis.value = document.getElementById('sonet_log_counter_2');\n\t}\n\n\tinitEvents()\n\t{\n\t\tEventEmitter.subscribe('onGoUp', (event: BaseEvent) =>\n\t\t{\n\t\t\tthis.unfixWrap();\n\t\t});\n\n\t\t(this.isSpaceFeatureEnabled)\n\t\t\t? this.subscribeOnSpaceCounters()\n\t\t\t: this.subscribeOnLiveFeedCounters()\n\t\t;\n\n\t\tEventEmitter.subscribe('onImUpdateCounter', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [counterData] = event.getCompatData();\n\n\t\t\tif (\n\t\t\t\tthis.isSpaceFeatureEnabled\n\t\t\t\t|| !Type.isObjectLike(counterData)\n\t\t\t\t|| Type.isUndefined(counterData[this.currentCounterType])\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.changeCounter(counterData[this.currentCounterType]);\n\t\t});\n\n\t\tEventEmitter.subscribe('OnUCCommentWasRead', (event: BaseEvent) =>\n\t\t{\n\t\t\tif (this.isSpaceFeatureEnabled)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst [ xmlId, id, options ] = event.getData();\n\n\t\t\tif (\n\t\t\t\t!Type.isObjectLike(options)\n\t\t\t\t|| !options.live\n\t\t\t\t|| !options.new\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit('onCounterDecrement', new BaseEvent({\n\t\t\t\tcompatData: [1],\n\t\t\t}));\n\n\t\t\tthis.decrementCounter(1);\n\t\t});\n\t};\n\n\tsubscribeOnSpaceCounters()\n\t{\n\t\tEventEmitter.subscribe('onPullEvent-socialnetwork', (event: BaseEvent) => {\n\t\t\tconst [command, eventParams] = event.getData();\n\t\t\tconst userFromEvent = eventParams.userId ?? null;\n\t\t\tconst spaces = eventParams.spaces ?? [];\n\n\t\t\tif (\n\t\t\t\tcommand !== 'user_spaces_counter'\n\t\t\t\t|| parseInt(this.currentUserId) !== parseInt(userFromEvent)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst currentSpace = spaces.find((space) => space.id === parseInt(this.currentSpaceId));\n\t\t\tconst currentSpaceCounter = (currentSpace && currentSpace.metrics && currentSpace.metrics.countersLiveFeedTotal)\n\t\t\t\t? currentSpace.metrics.countersLiveFeedTotal\n\t\t\t\t: 0\n\t\t\t;\n\t\t\tthis.changeCounter(currentSpaceCounter);\n\t\t});\n\t};\n\n\tsubscribeOnLiveFeedCounters()\n\t{\n\t\tEventEmitter.subscribe('onPullEvent-main', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ command, eventParams ] = event.getData();\n\n\t\t\tif (\n\t\t\t\tcommand !== 'user_counter'\n\t\t\t\t|| !eventParams[this.currentSiteId]\n\t\t\t\t|| !eventParams[this.currentSiteId][this.currentCounterType]\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.changeCounter(Runtime.clone(eventParams[this.currentSiteId][this.currentCounterType]));\n\t\t});\n\t};\n\n\tchangeCounter(count)\n\t{\n\t\tthis.counterValue = parseInt(count);\n\n\t\tif (this.counterValue <= 0)\n\t\t{\n\t\t\tthis.counterDecrementStack = 0;\n\t\t}\n\n\t\tconst valueToShow = this.counterValue - this.counterDecrementStack;\n\n\t\tthis.changeAnimate({\n\t\t\tshow: (valueToShow > 0),\n\t\t\tcounter: valueToShow,\n\t\t\tzeroCounterFromDb: (valueToShow <= 0),\n\t\t});\n\t};\n\n\tchangeAnimate(params)\n\t{\n\t\tconst show = (!!params.show);\n\t\tconst counterValue = parseInt(params.counter);\n\t\tconst zeroCounterFromDb = !!params.zeroCounterFromDb;\n\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterTextNode = this.container.querySelector(`span.${this.class.counterText}`);\n\t\tconst reloadNode = this.container.querySelector(`span.${this.class.reloadContainer}`);\n\n\t\tif (this.lockCounterAnimation)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.changeAnimate({\n\t\t\t\t\tshow: show,\n\t\t\t\t\tcounter: counterValue,\n\t\t\t\t})\n\t\t\t}, 200);\n\n\t\t\treturn false;\n\t\t}\n\n\t\tif (show)\n\t\t{\n\t\t\tif (this.value)\n\t\t\t{\n\t\t\t\tthis.value.innerHTML = counterValue;\n\t\t\t}\n\n\t\t\tthis.showWrapAnimation();\n\n\t\t\tif (\n\t\t\t\tthis.plus\n\t\t\t\t&& reloadNode\n\t\t\t\t&& !reloadNode.classList.contains('--hidden')\n\t\t\t\t&& counterTextNode\n\t\t\t)\n\t\t\t{\n\t\t\t\treloadNode.classList.add('--hidden');\n\t\t\t\tcounterTextNode.classList.remove('--hidden');\n\t\t\t\tthis.plus.classList.remove(`${this.class.plusHidden}`);\n\t\t\t}\n\t\t}\n\t\telse if (this.wrap)\n\t\t{\n\t\t\tif (\n\t\t\t\tzeroCounterFromDb\n\t\t\t\t&& this.wrap.classList.contains(`${this.class.informerAnimation}`)\n\t\t\t)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tcounterTextNode\n\t\t\t\t\t&& reloadNode\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tcounterTextNode.classList.add('--hidden');\n\t\t\t\t\treloadNode.classList.remove('--hidden');\n\n\t\t\t\t\tthis.hideReloadAnimation();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.hideWrapAnimation();\n\t\t\t\t}, 400);\n\t\t\t}\n\t\t}\n\t};\n\n\tshowWrapAnimation()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.style.visibility = 'visible';\n\t\tthis.wrap.classList.add(`${this.class.informerAnimation}`);\n\t};\n\n\thideWrapAnimation()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.classList.remove(`${this.class.informerAnimation}`);\n\t\tthis.wrap.style.visibility = 'hidden';\n\t}\n\n\tshowReloadAnimation()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterWaiterNode = this.container.querySelector(`span.${this.class.icon}`);\n\t\tif (counterWaiterNode)\n\t\t{\n\t\t\tcounterWaiterNode.classList.add(this.class.iconRotating);\n\t\t}\n\t}\n\n\thideReloadAnimation()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterNodeWaiter = this.container.querySelector(`span.${this.class.icon}`);\n\t\tif (counterNodeWaiter)\n\t\t{\n\t\t\tcounterNodeWaiter.classList.remove(this.class.iconRotating);\n\t\t}\n\t}\n\n\tonFeedScroll()\n\t{\n\t\tif (\n\t\t\t!this.container\n\t\t\t|| !this.wrap\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst top = this.wrap.parentNode.getBoundingClientRect().top;\n//\t\tconst counterRect = this.container.getBoundingClientRect();\n\n\t\tif (top <= 53)\n\t\t{\n/*\n\t\t\tif (!this.wrap.classList.contains(`${this.class.informerFixed}`))\n\t\t\t{\n\t\t\t\tthis.container.style.left = `${(counterRect.left + (counterRect.width / 2))}px`;\n\t\t\t}\n*/\n\t\t\tthis.fixWrap();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.unfixWrap();\n//\t\t\tthis.container.style.left = 'auto';\n\t\t}\n\t};\n\n\tfixWrap()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.classList.add(`${this.class.informerFixed}`, `${this.class.informerFixedAnimation}`);\n\t}\n\n\tunfixWrap()\n\t{\n\t\tif (!this.wrap)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.wrap.classList.remove(`${this.class.informerFixed}`, `${this.class.informerFixedAnimation}`);\n\t};\n\n\trecover()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterContainerNode = this.container.querySelector(`span.${this.class.counterContainer}`);\n\n\t\tif (!counterContainerNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tcounterContainerNode.classList.remove('--hidden');\n\t\tthis.hideReloadNode();\n\n\t\tif (this.plus)\n\t\t{\n\t\t\tthis.plus.classList.add(`${this.class.plusHidden}`);\n\t\t}\n\t};\n\n\thideReloadNode()\n\t{\n\t\tif (!this.container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst reloadNode = this.container.querySelector(`span.${this.class.reloadContainer}`);\n\n\t\tif (!reloadNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\treloadNode.classList.add('--hidden');\n\t};\n\n\tdecrementCounter(value)\n\t{\n\t\tthis.counterDecrementStack += parseInt(value);\n\n\t\tif (!this.value)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst counterValue = this.counterValue - this.counterDecrementStack;\n\t\tif (counterValue > 0)\n\t\t{\n\t\t\tthis.value.innerHTML = counterValue;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.changeAnimate({\n\t\t\t\tshow: false,\n\t\t\t\tcounter: 0,\n\t\t\t});\n\t\t}\n\t}\n\n\tgetWrap()\n\t{\n\t\treturn this.wrap;\n\t}\n}\n\nexport {\n\tInformer\n};\n","export class Loader\n{\n\tstatic cssClass = {\n\t\tfeedMask: 'log-internal-mask',\n\t\tfeedNoMask: 'log-internal-nomask',\n\t\tshowLoader: 'livefeed-show-loader',\n\t\thideLoader: 'livefeed-hide-loader',\n\t};\n\n\tstatic onAnimationEnd = (event) => {\n\t\tif (\n\t\t\t'animationName' in event\n\t\t\t&& event.animationName\n\t\t\t&& event.animationName === 'hideLoader'\n\t\t)\n\t\t{\n\t\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\t\t\tif (!loaderContainer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tloaderContainer.classList.remove(this.cssClass.showLoader);\n\t\t\tloaderContainer.classList.remove(this.cssClass.hideLoader);\n\t\t\tloaderContainer.style.display = '';\n\t\t}\n\t}\n\n\tstatic showRefreshFade()\n\t{\n\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\tif (feedContainer)\n\t\t{\n\t\t\tfeedContainer.classList.add(this.cssClass.feedMask);\n\t\t\tfeedContainer.classList.remove(this.cssClass.feedNoMask);\n\t\t}\n\n\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\t\tif (loaderContainer)\n\t\t{\n\t\t\tloaderContainer.style.display = 'block';\n\t\t\tloaderContainer.classList.remove(this.cssClass.hideLoader);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tloaderContainer.classList.add(this.cssClass.showLoader);\n\t\t\t}, 0);\n\t\t}\n\t}\n\n\tstatic hideRefreshFade()\n\t{\n\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\tif (feedContainer)\n\t\t{\n\t\t\tfeedContainer.classList.remove(this.cssClass.feedMask);\n\t\t\tfeedContainer.classList.add(this.cssClass.feedNoMask);\n\t\t}\n\n\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\t\tif (loaderContainer)\n\t\t{\n\t\t\tloaderContainer.classList.remove(this.cssClass.showLoader);\n\t\t\tloaderContainer.classList.add(this.cssClass.hideLoader);\n\t\t}\n\t}\n}\n","import {Type, Event} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {FeedInstance} from './feed';\n\nexport class MoreButton\n{\n\tstatic cssClass = {\n\t\tpost: 'feed-post-block',\n\t\tpostShort: 'feed-post-block-short',\n\t\tpostSeparator: 'feed-post-block-separator',\n\t\tpostText: 'feed-post-text-block',\n\t\tpostTextInner: 'feed-post-text-block-inner',\n\t\tpostTextInnerInner: 'feed-post-text-block-inner-inner',\n\t\tmore: 'feed-post-text-more',\n\t\tcomment: 'feed-com-text',\n\t};\n\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Livefeed:recalculateComments',\n\t\t\tthis.onRecalculateLivefeedComments.bind(this)\n\t\t);\n\t}\n\n\tonRecalculateLivefeedComments(baseEvent: BaseEvent)\n\t{\n\t\tconst [ data ] = baseEvent.getCompatData();\n\t\tif (!Type.isDomNode(data.rootNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst informerBlock = data.rootNode;\n\n\t\tconst moreBlock = informerBlock.querySelector(`.${MoreButton.cssClass.more}`);\n\t\tif (moreBlock)\n\t\t{\n\t\t\tinformerBlock.classList.remove(MoreButton.cssClass.postSeparator);\n\t\t}\n\n\t\tMoreButton.recalcPost({\n\t\t\tarPos: { height: (data.rootNode.offsetHeight + data.rootNode.offsetTop) },\n\t\t\tinformerBlock\n\t\t});\n\t}\n\n\tstatic recalcPost(params)\n\t{\n\t\tif (!Type.isDomNode(params.informerBlock))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst blockHeight = (!Type.isUndefined(params.arPos) ? params.arPos.height : params.bodyBlock.offsetHeight);\n\n\t\tconst postBlock = params.informerBlock.closest(`.${this.cssClass.post}`);\n\t\tif (!postBlock)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (blockHeight <= 284)\n\t\t{\n\t\t\tpostBlock.classList.add(this.cssClass.postShort)\n\t\t\tpostBlock.classList.add(this.cssClass.postSeparator)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpostBlock.classList.remove(this.cssClass.postShort)\n\t\t}\n\t}\n\n\tstatic recalcPostsList()\n\t{\n\t\tconst buttonsList = FeedInstance.getMoreButtons();\n\t\tbuttonsList.forEach((buttonData, key) => {\n\n\t\t\tif (\n\t\t\t\t!Type.isPlainObject(buttonData)\n\t\t\t\t|| !Type.isStringFilled(buttonData.bodyBlockID)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst bodyNode = document.getElementById(buttonData.bodyBlockID)\n\t\t\tif (!bodyNode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(buttonData.outerBlockID))\n\t\t\t{\n\t\t\t\tconst outerNode = document.getElementById(buttonData.outerBlockID);\n\t\t\t\tif (outerNode)\n\t\t\t\t{\n\t\t\t\t\tif (outerNode.offsetWidth < bodyNode.offsetWidth)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst innerNode = outerNode.querySelector(`div.${this.cssClass.postTextInner}`);\n\t\t\t\t\t\tinnerNode.style.overflowX = 'scroll';\n\t\t\t\t\t}\n\n\t\t\t\t\tconst moreButton = outerNode.querySelector(`.${this.cssClass.more}`);\n\t\t\t\t\tif (moreButton)\n\t\t\t\t\t{\n\t\t\t\t\t\tEvent.unbindAll(moreButton, 'click');\n\t\t\t\t\t\tEvent.bind(moreButton, 'click', (e) => {\n\n\t\t\t\t\t\t\tBX.UI.Animations.expand({\n\t\t\t\t\t\t\t\tmoreButtonNode: e.currentTarget,\n\t\t\t\t\t\t\t\ttype: 'post',\n\t\t\t\t\t\t\t\tclassBlock: this.cssClass.postText,\n\t\t\t\t\t\t\t\tclassOuter: this.cssClass.postTextInner,\n\t\t\t\t\t\t\t\tclassInner: this.cssClass.postTextInnerInner,\n\t\t\t\t\t\t\t\theightLimit: 300,\n\t\t\t\t\t\t\t\tcallback: (textBlock) => {\n\t\t\t\t\t\t\t\t\tthis.expand(textBlock);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t\tmoreButton.hasClickListener = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.recalcPost({\n\t\t\t\tarPos: { height: (bodyNode.offsetHeight + bodyNode.offsetTop)},\n\t\t\t\tinformerBlock: (Type.isStringFilled(buttonData.informerBlockID) ? document.getElementById(buttonData.informerBlockID) : null)\n\t\t\t});\n\t\t\tbuttonsList.delete(key);\n\t\t});\n\n\t\tFeedInstance.setMoreButtons(buttonsList);\n\n\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\tif (!feedContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst onLoadImageList = feedContainer.querySelectorAll('[data-bx-onload=\"Y\"]');\n\t\tonLoadImageList.forEach((imageNode) => {\n\t\t\timageNode.addEventListener('load', (e) => {\n\n\t\t\t\tlet outerBlock = e.currentTarget.closest(`.${this.cssClass.comment}`);\n\t\t\t\tif (!outerBlock) // post\n\t\t\t\t{\n\t\t\t\t\touterBlock = e.currentTarget.closest(`.${this.cssClass.post}`);\n\t\t\t\t\tif (outerBlock)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst bodyBlock = outerBlock.querySelector(`.${this.cssClass.postTextInnerInner}`);\n\t\t\t\t\t\tif (bodyBlock)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.recalcPost({\n\t\t\t\t\t\t\t\tbodyBlock: bodyBlock,\n\t\t\t\t\t\t\t\tinformerBlock: outerBlock.querySelector(`.${this.cssClass.more}`),\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\te.currentTarget.setAttribute('data-bx-onload', 'N');\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic recalcCommentsList()\n\t{\n\t\tEventEmitter.emit('OnUCMoreButtonListRecalc', new BaseEvent({\n\t\t\tcompatData: [],\n\t\t}));\n\t}\n\n\tstatic clearCommentsList()\n\t{\n\t\tEventEmitter.emit('OnUCMoreButtonListClear', new BaseEvent({\n\t\t\tcompatData: [],\n\t\t}));\n\t}\n\n\tstatic expand(textBlock)\n\t{\n\t\tif (!Type.isDomNode(textBlock))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst postBlock = textBlock.closest(`.${this.cssClass.post}`);\n\t\tif (!postBlock)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tpostBlock.classList.add(this.cssClass.postShort);\n\t\tpostBlock.classList.add(this.cssClass.postSeparator);\n\t}\n\n\t/*\n\tis not used actually by disk uf\n\t*/\n\tstatic lazyLoadCheckVisibility(image)\n\t{\n\t\tif (\n\t\t\t!Type.isPlainObject(image)\n\t\t\t|| !Type.isDomNode(image.node)\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst imageNode = image.node;\n\n\t\tlet textType = 'comment';\n\n\t\tlet textBlock = imageNode.closest(`.${this.cssClass.comment}`);\n\t\tif (!textBlock)\n\t\t{\n\t\t\ttextType = 'post';\n\t\t\ttextBlock = imageNode.closest(`.${this.cssClass.postText}`);\n\t\t}\n\n\t\tif (!textBlock)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst moreBlock = textBlock.querySelector(`div.${this.cssClass.more}`);\n\t\tif (\n\t\t\t!moreBlock\n\t\t\t|| moreBlock.style.display === 'none'\n\t\t)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn imageNode.parentNode.parentNode.offsetTop < (textType === 'comment' ? 220 : 270);\n\t}\n}\n","import {Type} from 'main.core';\nimport {BaseEvent} from 'main.core.events';\n\nimport {MoreButton} from './morebutton';\n\nexport class Forum\n{\n\tstatic cssClass = {\n\t};\n\n\tstatic processSpoilerToggle(event: BaseEvent)\n\t{\n\t\tlet [ params ] = event.getCompatData();\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (!Type.isDomNode(params.node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst outerBlock = params.node.closest('.feed-post-block');\n\t\tif (!outerBlock)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst bodyBlock = outerBlock.querySelector('.feed-post-text-block-inner-inner');\n\t\tif (!bodyBlock)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst moreBlock = outerBlock.querySelector('.feed-post-text-more');\n\n\t\tMoreButton.recalcPost({\n\t\t\tbodyBlock: bodyBlock,\n\t\t\tinformerBlock: moreBlock,\n\t\t});\n\t}\n}\n","import {Type} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {Loader} from './loader';\nimport {PageInstance} from './feed';\n\nclass Filter\n{\n\tconstructor()\n\t{\n\t\tthis.filterId = '';\n\t\tthis.filterApi = null;\n\t}\n\n\tinit(params)\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (\n\t\t\tType.isStringFilled(params.filterId)\n\t\t\t&& !Type.isUndefined(BX.Main)\n\t\t\t&& !Type.isUndefined(BX.Main.filterManager)\n\t\t)\n\t\t{\n\t\t\tconst filterManager = BX.Main.filterManager.getById(params.filterId);\n\t\t\tthis.filterId = params.filterId;\n\n\t\t\tif(filterManager)\n\t\t\t{\n\t\t\t\tthis.filterApi = filterManager.getApi();\n\t\t\t}\n\t\t}\n\n\t\tthis.initEvents();\n\t}\n\n\tinitEvents()\n\t{\n\t\tEventEmitter.subscribe('BX.Livefeed.Filter:beforeApply', (event: BaseEvent) =>\n\t\t{\n\t\t\tLoader.showRefreshFade();\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Livefeed.Filter:apply', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ filterValues, filterPromise, filterParams ] = event.getCompatData();\n\n\t\t\tif (typeof filterParams != 'undefined')\n\t\t\t{\n\t\t\t\tfilterParams.autoResolve = false;\n\t\t\t}\n\t\t\tPageInstance.refresh({\n\t\t\t\tuseBXMainFilter: 'Y',\n\t\t\t}, filterPromise);\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Livefeed.Filter:searchInput', (event: BaseEvent) =>\n\t\t{\n\t\t\tconst [ searchString ] = event.getCompatData();\n\n\t\t\tif (Type.isStringFilled(searchString))\n\t\t\t{\n\t\t\t\tLoader.showRefreshFade();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tLoader.hideRefreshFade();\n\t\t\t}\n\t\t});\n\t}\n\n\tinitEventsCrm()\n\t{\n\t\tEventEmitter.subscribe('BX.Livefeed.Filter:searchInput', () => {\n\t\t\tPageInstance.refresh();\n\t\t});\n\t}\n\n\tclickTag(tagValue)\n\t{\n\t\tif (\n\t\t\t!Type.isStringFilled(tagValue)\n\t\t\t|| !this.filterApi\n\t\t)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.filterApi.setFields({\n\t\t\tTAG: tagValue\n\t\t});\n\t\tthis.filterApi.apply();\n\n\t\tif (\n\t\t\tType.isStringFilled(this.filterId)\n\t\t\t&& !Type.isUndefined(BX.Main)\n\t\t\t&& !Type.isUndefined(BX.Main.filterManager)\n\t\t)\n\t\t{\n\t\t\tconst filterContainer = document.getElementById(`${this.filterId}_filter_container`);\n\t\t\tif (\n\t\t\t\tfilterContainer\n\t\t\t\t&& BX.Main.filterManager.getById(this.filterId)\n\t\t\t\t&& (\n\t\t\t\t\tBX.Main.filterManager.getById(this.filterId).getSearch().getSquares().length > 0\n\t\t\t\t\t|| BX.Main.filterManager.getById(this.filterId).getSearch().getSearchString().length > 0\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst pagetitleContainer = filterContainer.closest('.pagetitle-wrap');\n\t\t\t\tif (pagetitleContainer)\n\t\t\t\t{\n\t\t\t\t\tpagetitleContainer.classList.add('pagetitle-wrap-filter-opened');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t(new BX.easing({\n\t\t\tduration: 500,\n\t\t\tstart: { scroll: window.pageYOffset },\n\t\t\tfinish: { scroll: 0 },\n\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\tstep: (state) => {\n\t\t\t\twindow.scrollTo(0, state.scroll);\n\t\t\t},\n\t\t\tcomplete: () => {}\n\t\t})).animate();\n\n\t\treturn true;\n\t}\n}\n\nexport {\n\tFilter,\n};","import { ajax, Type, Loc, Dom, Tag } from 'main.core';\nimport { Popup } from 'main.popup';\n\nexport class ContentView\n{\n\tstatic registerAreaList()\n\t{\n\t\tvar\n\t\t\tcontainer = BX('log_internal_container'),\n\t\t\tfullContentArea = null;\n\n\t\tif (container)\n\t\t{\n\t\t\tvar viewAreaList = BX.findChildren(container, {\n\t\t\t\ttag: 'div',\n\t\t\t\tclassName: 'feed-post-contentview'\n\t\t\t}, true);\n\t\t\tfor (var i = 0, length = viewAreaList.length; i < length; i++)\n\t\t\t{\n\t\t\t\tif (viewAreaList[i].id.length > 0)\n\t\t\t\t{\n\t\t\t\t\tfullContentArea = BX.findChild(viewAreaList[i], {\n\t\t\t\t\t\ttag: 'div',\n\t\t\t\t\t\tclassName: 'feed-post-text-block-inner-inner'\n\t\t\t\t\t});\n\t\t\t\t\tBX.UserContentView.registerViewArea(viewAreaList[i].id, (fullContentArea ? fullContentArea : null));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","import { Loc, Type, ajax, Dom, Runtime, Uri, Event, Tag } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport {FeedInstance, PinnedPanelInstance, InformerInstance} from './feed';\nimport {Loader} from './loader';\nimport {MoreButton} from './morebutton';\nimport {ContentView} from './contentview';\n\nclass Page\n{\n\tconstructor()\n\t{\n\t\tthis.loadStarted = null;\n\t\tthis.stopTrackNextPage = null;\n\t\tthis.requestMode = null;\n\t\tthis.nextPageFirst = null;\n\t\tthis.nextPageUrl = null;\n\t\tthis.scrollInitialized = null;\n\t\tthis.firstPageLastTS = 0;\n\t\tthis.firstPageLastId = 0;\n\t\tthis.useBXMainFilter = 'N';\n\t\tthis.commentFormUID = '';\n\t\tthis.blogCommentFormUID = '';\n\n\t\tthis.signedParameters = '';\n\t\tthis.componentName = '';\n\t\tthis.context = '';\n\n\t\tthis.class = {\n\t\t};\n\n\t\tEvent.ready(() => {\n\t\t\tthis.init();\n\t\t});\n\t}\n\n\tinit()\n\t{\n\t\tthis.loadStarted = false;\n\t\tthis.stopTrackNextPage = false;\n\t\tthis.requestMode = false;\n\t\tthis.nextPageFirst = true;\n\t\tthis.nextPageUrl = false;\n\t\tthis.scrollInitialized = false;\n\t}\n\n\trefresh(params, filterPromise)\n\t{\n\t\tif (this.loadStarted)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setRequestModeNew();\n\n\t\tparams = (\n\t\t\tType.isPlainObject(params)\n\t\t\t\t? params\n\t\t\t\t: {}\n\t\t);\n\n\t\tparams.siteTemplateId = Loc.getMessage('SONET_EXT_LIVEFEED_SITE_TEMPLATE_ID');\n\t\tparams.assetsCheckSum = Loc.getMessage('sonetLAssetsCheckSum');\n\t\tparams.context = Type.isStringFilled(params.context) ? params.context : this.context;\n\t\tthis.loadStarted = true;\n\n\t\tLoader.showRefreshFade();\n\n\t\tMoreButton.clearCommentsList();\n\t\tFeedInstance.clearMoreButtons();\n\n\t\tif (Type.isStringFilled(this.commentFormUID))\n\t\t{\n\t\t\tparams.commentFormUID = this.commentFormUID;\n\t\t}\n\n\t\tif (\n\t\t\t!Type.isStringFilled(params.useBXMainFilter)\n\t\t\t|| params.useBXMainFilter !== 'Y'\n\t\t)\n\t\t{\n\t\t\tEventEmitter.emit('BX.Livefeed:refresh', new BaseEvent({\n\t\t\t\tcompatData: [],\n\t\t\t}));\n\t\t}\n\n\t\tInformerInstance.hideReloadNode();\n\t\tInformerInstance.lockCounterAnimation = true;\n\n\t\tthis.loadStarted = false;\n\n\t\tajax.runAction('socialnetwork.api.livefeed.refresh', {\n\t\t\tsignedParameters: this.getSignedParameters(),\n\t\t\tdata: {\n\t\t\t\tc: this.getComponentName(),\n\t\t\t\tlogajax: 'Y', // compatibility\n\t\t\t\tRELOAD: 'Y', // compatibility\n\t\t\t\tparams: params,\n\t\t\t}\n\t\t}).then((response) => {\n\n\t\t\tconst responseData = (Type.isPlainObject(response.data) ? response.data : {});\n\n\t\t\tthis.loadStarted = false;\n\t\t\tLoader.hideRefreshFade();\n\n\t\t\tif (filterPromise)\n\t\t\t{\n\t\t\t\tfilterPromise.fulfill();\n\t\t\t}\n\n\t\t\tconst emptyLivefeed = (\n\t\t\t\tType.isPlainObject(responseData.componentResult)\n\t\t\t\t&& Type.isStringFilled(responseData.componentResult.EMPTY)\n\t\t\t\t\t? responseData.componentResult.EMPTY\n\t\t\t\t\t: 'N'\n\t\t\t);\n\t\t\tconst forcePageRefresh = (\n\t\t\t\tType.isPlainObject(responseData.componentResult)\n\t\t\t\t&& Type.isStringFilled(responseData.componentResult.FORCE_PAGE_REFRESH)\n\t\t\t\t\t? responseData.componentResult.FORCE_PAGE_REFRESH\n\t\t\t\t\t: 'N'\n\t\t\t);\n\n\t\t\tconst isFilterUsed = (\n\t\t\t\tType.isPlainObject(responseData.componentResult)\n\t\t\t\t&& Type.isStringFilled(responseData.componentResult.FILTER_USED)\n\t\t\t\t&& responseData.componentResult.FILTER_USED === 'Y'\n\t\t\t);\n\n\t\t\tif (forcePageRefresh === 'Y')\n\t\t\t{\n\t\t\t\ttop.window.location.reload();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\n\t\t\tInformerInstance.lockCounterAnimation = false;\n\n\t\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\t\tif (!feedContainer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.clean(feedContainer);\n\n\t\t\tconst emptyBlock = document.getElementById('feed-empty-wrap');\n\n\t\t\tif (emptyBlock)\n\t\t\t{\n\t\t\t\tif (emptyLivefeed === 'Y')\n\t\t\t\t{\n\t\t\t\t\temptyBlock.style.display = 'block';\n\n\t\t\t\t\tconst emptyTextNode = emptyBlock.querySelector('.feed-wrap-empty');\n\t\t\t\t\tif (emptyTextNode)\n\t\t\t\t\t{\n\t\t\t\t\t\temptyTextNode.innerHTML = (\n\t\t\t\t\t\t\tisFilterUsed\n\t\t\t\t\t\t\t\t? Loc.getMessage('SONET_C30_T_EMPTY_SEARCH')\n\t\t\t\t\t\t\t\t: Loc.getMessage('SONET_C30_T_EMPTY')\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\temptyBlock.style.display = 'none';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (loaderContainer)\n\t\t\t{\n\t\t\t\tfeedContainer.appendChild(loaderContainer);\n\t\t\t}\n\n\t\t\tif (responseData.html.length > 0)\n\t\t\t{\n\t\t\t\tthis.clearContainerExternal();\n\t\t\t\tBX.LazyLoad.clearImages();\n\n\t\t\t\tconst pageNode = Tag.render`<div id=\"content_block_${(Math.floor(Math.random() * 1000))}\" class=\"feed-wrap\" style=\"display: block;\"></div>`;\n\n\t\t\t\tfeedContainer.appendChild(pageNode);\n\n\t\t\t\tRuntime.html(pageNode, responseData.html).then(() => {\n\t\t\t\t\tMoreButton.recalcPostsList()\n\t\t\t\t\tMoreButton.recalcCommentsList();\n\n\t\t\t\t\tContentView.registerAreaList();\n\n\t\t\t\t\tPinnedPanelInstance.resetFlags();\n\t\t\t\t\tPinnedPanelInstance.initPanel();\n\t\t\t\t\tPinnedPanelInstance.initPosts();\n\t\t\t\t});\n\n\t\t\t\tthis.stopTrackNextPage = false;\n\n\t\t\t\tMoreButton.clearCommentsList();\n\n\t\t\t\tconst informerWrap = InformerInstance.getWrap();\n\n\t\t\t\tif (\n\t\t\t\t\tinformerWrap\n\t\t\t\t\t&& informerWrap.classList.contains(InformerInstance.class.informerFixed)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\t(new BX.easing({\n\t\t\t\t\t\tduration: 500,\n\t\t\t\t\t\tstart: { scroll: window.pageYOffset },\n\t\t\t\t\t\tfinish: { scroll: 0 },\n\t\t\t\t\t\ttransition: BX.easing.makeEaseOut(BX.easing.transitions.quart),\n\t\t\t\t\t\tstep: (state) => {\n\t\t\t\t\t\t\twindow.scrollTo(0, state.scroll);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\t\tEventEmitter.emit('onGoUp', []);\n\t\t\t\t\t\t}\n\t\t\t\t\t})).animate();\n\t\t\t\t}\n\t\t\t}\n\t\t}, () => {\n\n\t\t\tthis.loadStarted = false;\n\t\t\tif (filterPromise)\n\t\t\t{\n\t\t\t\tfilterPromise.reject();\n\t\t\t}\n\n\t\t\tLoader.hideRefreshFade();\n\t\t\tthis.showRefreshError();\n\t\t});\n\n\t\treturn false;\n\t}\n\n\tgetNextPage()\n\t{\n\t\tconst stubContainer = document.getElementById('feed-new-message-inf-wrap');\n\t\tconst stubFirstContainer = document.getElementById('feed-new-message-inf-wrap-first');\n\n\t\tif (this.loadStarted)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.setRequestModeMore();\n\n\t\tthis.loadStarted = true;\n\n\t\tInformerInstance.lockCounterAnimation = true;\n\t\tFeedInstance.clearMoreButtons();\n\n\t\tif (\n\t\t\t!this.nextPageFirst\n\t\t\t&& stubContainer\n\t\t)\n\t\t{\n\t\t\tstubContainer.style.display = 'block';\n\t\t}\n\t\telse if (\n\t\t\tthis.nextPageFirst\n\t\t\t&& stubFirstContainer\n\t\t)\n\t\t{\n\t\t\tstubFirstContainer.classList.add('feed-new-message-inf-wrap-first-visible');\n\t\t}\n\n\t\tconst nextUrlParamsList = (new Uri(this.getNextPageUrl())).getQueryParams();\n\t\tlet pageNumber = 1;\n\t\tlet prevPageLogId = '';\n\t\tlet ts = 0;\n\t\tlet noblog = 'N';\n\n\t\tObject.entries(nextUrlParamsList).forEach(([ key, value ]) => {\n\t\t\tif (key.match(/^PAGEN_(\\d+)$/i))\n\t\t\t{\n\t\t\t\tpageNumber = parseInt(value);\n\t\t\t}\n\t\t\telse if (key === 'pplogid')\n\t\t\t{\n\t\t\t\tprevPageLogId = decodeURI(value);\n\t\t\t}\n\t\t\telse if (key === 'ts')\n\t\t\t{\n\t\t\t\tts = value;\n\t\t\t}\n\t\t\telse if (key === 'noblog')\n\t\t\t{\n\t\t\t\tnoblog = value;\n\t\t\t}\n\t\t});\n\n\t\tconst queryParams = {\n\t\t\tPAGE_NUMBER: pageNumber,\n\t\t\tLAST_LOG_TIMESTAMP: ts,\n\t\t\tPREV_PAGE_LOG_ID: prevPageLogId,\n\t\t\tsiteTemplateId: Loc.getMessage('SONET_EXT_LIVEFEED_SITE_TEMPLATE_ID'),\n\t\t\tuseBXMainFilter: this.useBXMainFilter,\n\t\t\tpreset_filter_top_id: (Type.isStringFilled(nextUrlParamsList.preset_filter_top_id) && nextUrlParamsList.preset_filter_top_id !== '0' ? nextUrlParamsList.preset_filter_top_id : ''),\n\t\t\tpreset_filter_id: (Type.isStringFilled(nextUrlParamsList.preset_filter_id) && nextUrlParamsList.preset_filter_id !== '0' ? nextUrlParamsList.preset_filter_id : '')\n\t\t};\n\n\t\tif (Type.isStringFilled(this.commentFormUID))\n\t\t{\n\t\t\tqueryParams.commentFormUID = this.commentFormUID;\n\t\t}\n\n\t\tif (Type.isStringFilled(this.blogCommentFormUID))\n\t\t{\n\t\t\tqueryParams.blogCommentFormUID = this.blogCommentFormUID;\n\t\t}\n\n\t\tqueryParams.context = this.context;\n\n\t\tconst queryData = {\n\t\t\tc: this.getComponentName(),\n\t\t\tlogajax: 'Y', // compatibility with socialnetwork.blog.post.comment\n\t\t\tnoblog: noblog, // compatibility with socialnetwork.blog.post.comment\n\t\t\tparams: queryParams,\n\t\t};\n\n\t\tif (!Type.isUndefined(nextUrlParamsList.CREATED_BY_ID))\n\t\t{\n\t\t\tqueryData.flt_created_by_id = parseInt(nextUrlParamsList.CREATED_BY_ID);\n\t\t}\n\n\t\tif (!Type.isUndefined(nextUrlParamsList.flt_date_datesel))\n\t\t{\n\t\t\tqueryData.flt_date_datesel = nextUrlParamsList.flt_date_datesel;\n\t\t}\n\n\t\tif (!Type.isUndefined(nextUrlParamsList.flt_date_from))\n\t\t{\n\t\t\tqueryData.flt_date_from = decodeURIComponent(nextUrlParamsList.flt_date_from);\n\t\t}\n\n\t\tif (!Type.isUndefined(nextUrlParamsList.flt_date_to))\n\t\t{\n\t\t\tqueryData.flt_date_to = decodeURIComponent(nextUrlParamsList.flt_date_to);\n\t\t}\n\n\t\tajax.runAction('socialnetwork.api.livefeed.getNextPage', {\n\t\t\tsignedParameters: this.getSignedParameters(),\n\t\t\tdata: queryData,\n\t\t}).then((response) => {\n\t\t\tconst responseData = (Type.isPlainObject(response.data) ? response.data : {});\n\n\t\t\tthis.loadStarted = false;\n\n\t\t\tconst stubContainer = document.getElementById('feed-new-message-inf-wrap');\n\t\t\tif (stubContainer)\n\t\t\t{\n\t\t\t\tDom.clean(stubContainer);\n\t\t\t\tDom.remove(stubContainer)\n\t\t\t}\n\n\t\t\tInformerInstance.lockCounterAnimation = false;\n\n\t\t\tconst lastEntryTimestamp = (\n\t\t\t\tType.isPlainObject(responseData.componentResult)\n\t\t\t\t&& !Type.isUndefined(responseData.componentResult.LAST_TS)\n\t\t\t\t\t? parseInt(responseData.componentResult.LAST_TS)\n\t\t\t\t\t: 0\n\t\t\t);\n\t\t\tconst lastEntryId = (\n\t\t\t\tType.isPlainObject(responseData.componentResult)\n\t\t\t\t&& !Type.isUndefined(responseData.componentResult.LAST_ID)\n\t\t\t\t\t? parseInt(responseData.componentResult.LAST_ID)\n\t\t\t\t\t: null\n\t\t\t);\n\n\t\t\tif (\n\t\t\t\tresponseData.html.length > 0\n\t\t\t\t&& lastEntryTimestamp > 0\n\t\t\t\t&& (\n\t\t\t\t\tparseInt(this.firstPageLastTS) <= 0\n\t\t\t\t\t|| lastEntryTimestamp < parseInt(this.firstPageLastTS)\n\t\t\t\t\t|| (\n\t\t\t\t\t\tlastEntryTimestamp == parseInt(this.firstPageLastTS)\n\t\t\t\t\t\t&& !Type.isNull(lastEntryId)\n\t\t\t\t\t\t&& lastEntryId < parseInt(this.firstPageLastId)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tMoreButton.clearCommentsList();\n\n\t\t\t\tconst contentBlockId = `content_block_${(Math.floor(Math.random() * 1000))}`;\n\n\t\t\t\tconst pageNode = Tag.render`<div id=\"${contentBlockId}\" class=\"feed-wrap\" style=\"display:${(this.nextPageFirst ? 'none' : 'block')};\"></div>`;\n\n\t\t\t\tconst feedContainer = document.getElementById('log_internal_container');\n\t\t\t\tif (!feedContainer)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfeedContainer.appendChild(pageNode);\n\n\t\t\t\tRuntime.html(pageNode, responseData.html).then(() => {\n\t\t\t\t\tif (pageNumber > 2)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.stopTrackNextPage = false;\n\t\t\t\t\t\tMoreButton.recalcPostsList();\n\t\t\t\t\t\tContentView.registerAreaList();\n\t\t\t\t\t\tMoreButton.recalcCommentsList();\n\t\t\t\t\t\tPinnedPanelInstance.resetFlags();\n\t\t\t\t\t\tPinnedPanelInstance.initPosts();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.clearContainerExternal();\n\n\t\t\t\tif (pageNumber === 2)\n\t\t\t\t{\n\t\t\t\t\tdocument.getElementById('feed-new-message-inf-text-first').style.display = 'block';\n\t\t\t\t\tdocument.getElementById('feed-new-message-inf-loader-first').style.display = 'none';\n\t\t\t\t\tstubFirstContainer.classList.add('feed-new-message-inf-wrap-first-active');\n\n\t\t\t\t\tconst f = () => {\n\n\t\t\t\t\t\tthis.stopTrackNextPage = false;\n\t\t\t\t\t\tif (pageNode)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpageNode.style.display = 'block';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tEvent.unbind(document.getElementById('sonet_log_more_container_first'), 'click', f);\n\t\t\t\t\t\tstubFirstContainer.style.display = 'none';\n\t\t\t\t\t\tMoreButton.recalcPostsList()\n\t\t\t\t\t\tContentView.registerAreaList();\n\t\t\t\t\t\tMoreButton.recalcCommentsList();\n\n\t\t\t\t\t\tEventEmitter.emit('BX.Livefeed:recalculateComments', new BaseEvent({\n\t\t\t\t\t\t\tcompatData: [{\n\t\t\t\t\t\t\t\trootNode: pageNode,\n\t\t\t\t\t\t\t}],\n\t\t\t\t\t\t}));\n\n\n\t\t\t\t\t\tPinnedPanelInstance.resetFlags();\n\t\t\t\t\t\tPinnedPanelInstance.initPosts();\n\t\t\t\t\t};\n\t\t\t\t\tEvent.bind(document.getElementById('sonet_log_more_container_first'), 'click', f);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (pageNode)\n\t\t\t\t\t{\n\t\t\t\t\t\tpageNode.style.display = 'block';\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.nextPageFirst = false;\n\t\t\t}\n\n\t\t\telse if (document.getElementById('feed-new-message-inf-wrap-first'))\n\t\t\t{\n\t\t\t\tdocument.getElementById('feed-new-message-inf-wrap-first').style.display = 'none';\n\t\t\t}\n\t\t}, () => {\n\n\t\t\tthis.loadStarted = false;\n\t\t\tthis.stopTrackNextPage = false;\n\n\t\t\tconst stubContainer = document.getElementById('feed-new-message-inf-wrap');\n\t\t\tif (stubContainer)\n\t\t\t{\n\t\t\t\tstubContainer.style.display = 'none';\n\t\t\t}\n\n\t\t\tInformerInstance.lockCounterAnimation = false;\n\t\t\tthis.clearContainerExternal();\n\t\t});\n\n\t\treturn false;\n\t}\n\n\tclearContainerExternal()\n\t{\n\t\tif (this.requestMode === 'new')\n\t\t{\n\t\t\tInformerInstance.hideWrapAnimation();\n\t\t\tInformerInstance.recover();\n\t\t}\n\n\t\tInformerInstance.hideReloadAnimation();\n\n\t\tconst counterPreset = document.getElementById('sonet_log_counter_preset');\n\t\tif (\n\t\t\tcounterPreset\n\t\t\t&& this.requestMode === 'new'\n\t\t)\n\t\t{\n\t\t\tcounterPreset.style.display = 'none';\n\t\t}\n\t}\n\n\tsetRequestModeNew()\n\t{\n\t\tthis.requestMode = 'new';\n\t}\n\n\tsetRequestModeMore()\n\t{\n\t\tthis.requestMode = 'more';\n\t}\n\n\tshowRefreshError()\n\t{\n\t\tInformerInstance.lockCounterAnimation = false;\n\t\tthis.clearContainerExternal();\n\t}\n\tsetSignedParameters(value)\n\t{\n\t\tthis.signedParameters = value;\n\t}\n\n\tsetContext(context: string): void\n\t{\n\t\tthis.context = context;\n\t}\n\n\tgetSignedParameters()\n\t{\n\t\treturn this.signedParameters;\n\t}\n\n\tsetComponentName(value)\n\t{\n\t\tthis.componentName = value;\n\t}\n\tgetComponentName()\n\t{\n\t\treturn this.componentName;\n\t}\n\n\tsetNextPageUrl(value)\n\t{\n\t\tthis.nextPageUrl = value;\n\t}\n\tgetNextPageUrl()\n\t{\n\t\treturn this.nextPageUrl;\n\t}\n\n\tinitScroll()\n\t{\n\t\tif (this.scrollInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.scrollInitialized = true;\n\t\tdocument.addEventListener('scroll', this.onFeedScroll.bind(this), true);\n\t}\n\n\tonFeedScroll()\n\t{\n\t\tif (!this.stopTrackNextPage)\n\t\t{\n\t\t\tconst maxScroll = (document.documentElement.scrollHeight - window.innerHeight) - 500;\n\t\t\tif (\n\t\t\t\twindow.pageYOffset >= maxScroll\n\t\t\t\t&& this.getNextPageUrl()\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.stopTrackNextPage = true;\n\t\t\t\tthis.getNextPage();\n\t\t\t}\n\t\t}\n\n\t\tInformerInstance.onFeedScroll();\n\t}\n}\n\nexport {\n\tPage\n};","import { Type, Tag, Runtime } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { ResultManager } from 'tasks.result';\n\nexport class CommentForm\n{\n\tstatic resultFieldTaskIdList = [];\n\tstatic taskResultCommentsData = {};\n\n\tstatic appendResultFieldTaskIds(taskIdList)\n\t{\n\t\tif (!Type.isArray(taskIdList))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttaskIdList = taskIdList.map((value) => { return parseInt(value); })\n\t\tthis.resultFieldTaskIdList = [...this.resultFieldTaskIdList, ...taskIdList];\n\t}\n\n\tstatic appendTaskResultComments(data)\n\t{\n\t\tif (Type.isUndefined(ResultManager))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.taskResultCommentsData = Object.assign(this.taskResultCommentsData, data);\n\n\t\tObject.entries(this.taskResultCommentsData).forEach(([taskId, commentsIdList]) => {\n\t\t\tResultManager.getInstance().initResult({\n\t\t\t\tcontext: 'task',\n\t\t\t\ttaskId: parseInt(taskId),\n\t\t\t\tcomments: commentsIdList,\n\t\t\t});\n\t\t});\n\t}\n\n\tstatic onAfterShow(obj, text, data)\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\tdata = {};\n\t\t}\n\n\t\tEventEmitter.emit('OnBeforeSocialnetworkCommentShowedUp', new BaseEvent({\n\t\t\tcompatData: ['socialnetwork'],\n\t\t}));\n\n\t\tconst postData = {\n\t\t\tENTITY_XML_ID: obj.currentEntity.ENTITY_XML_ID,\n\t\t\tENTITY_TYPE: obj.currentEntity.ENTITY_XML_ID.split('_')[0],\n\t\t\tENTITY_ID: obj.currentEntity.ENTITY_XML_ID.split('_')[1],\n\t\t\tparentId: obj.id[1],\n\t\t\tcomment_post_id: obj.currentEntity.ENTITY_XML_ID.split('_')[1],\n\t\t\tedit_id: obj.id[1],\n\t\t\tact: (obj.id[1] > 0 ? 'edit' : 'add'),\n\t\t};\n\n\t\tObject.entries(postData).forEach(([key, value]) =>\n\t\t{\n\t\t\tif (!obj.form[key])\n\t\t\t{\n\t\t\t\tobj.form.appendChild(Tag.render`<input type=\"hidden\" name=\"${key}\">`);\n\t\t\t}\n\t\t\tobj.form[key].value = value;\n\t\t});\n\n\t\tthis.onLightEditorShow(text, data);\n\n\t\tif (!BX.Type.isUndefined(BX.Tasks))\n\t\t{\n\t\t\tconst matches = obj.currentEntity.ENTITY_XML_ID.match(/^TASK_(\\d+)$/i);\n\t\t\tif (\n\t\t\t\tmatches\n\t\t\t\t&& this.resultFieldTaskIdList.includes(parseInt(matches[1]))\n\t\t\t)\n\t\t\t{\n\t\t\t\tBX.Tasks.ResultManager.showField();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tBX.Tasks.ResultManager.hideField();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic onLightEditorShow(content, data)\n\t{\n\t\tif (!Type.isPlainObject(data))\n\t\t{\n\t\t\tdata = {};\n\t\t}\n\n\t\tlet result = {};\n\n\t\tif (Type.isPlainObject(data.UF))\n\t\t{\n\t\t\tresult = data.UF;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (data.arFiles)\n\t\t\t{\n\t\t\t\tconst value = {};\n\n\t\t\t\tdata.arFiles.forEach((fileId, index) => {\n\t\t\t\t\tconst container = document.getElementById(`wdif-doc-${fileId}`);\n\n\t\t\t\t\tconst name = container.querySelector('.feed-com-file-name');\n\t\t\t\t\tconst size = container.querySelector('.feed-con-file-size');\n\n\t\t\t\t\tvalue[`F${index}`] = {\n\t\t\t\t\t\tFILE_ID: fileId,\n\t\t\t\t\t\tFILE_NAME: (name ? name.innerHTML : 'noname'),\n\t\t\t\t\t\tFILE_SIZE: (size ? size.innerHTML : 'unknown'),\n\t\t\t\t\t\tCONTENT_TYPE: 'notimage/xyz'\n\t\t\t\t\t};\n\t\t\t\t})\n\n\t\t\t\tresult.UF_SONET_COM_DOC = {\n\t\t\t\t\tUSER_TYPE_ID: 'file',\n\t\t\t\t\tFIELD_NAME: 'UF_SONET_COM_FILE[]',\n\t\t\t\t\tVALUE: value,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (data.arDocs)\n\t\t\t{\n\t\t\t\tresult.UF_SONET_COM_FILE = {\n\t\t\t\t\tUSER_TYPE_ID: 'webdav_element',\n\t\t\t\t\tFIELD_NAME: 'UF_SONET_COM_DOC[]',\n\t\t\t\t\tVALUE: Runtime.clone(data.arDocs),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (data.arDFiles)\n\t\t\t{\n\t\t\t\tresult.UF_SONET_COM_FILE = {\n\t\t\t\t\tUSER_TYPE_ID: 'disk_file',\n\t\t\t\t\tFIELD_NAME: 'UF_SONET_COM_DOC[]',\n\t\t\t\t\tVALUE: Runtime.clone(data.arDFiles)\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tLHEPostForm.reinitData(window.SLEC.editorId, content, result);\n\t}\n}\n","import {Type, Loc, ajax, Event, Dom, Tag} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {MenuManager} from 'main.popup';\n\nimport {PinnedPanel} from './pinned';\nimport {Post} from './post';\nimport {Informer} from './informer';\nimport {TaskCreator} from './taskcreator';\nimport {Loader} from './loader';\nimport {Forum} from './forum';\nimport {MoreButton} from './morebutton';\nimport {Filter} from './filter';\nimport {Page} from './page';\nimport {ContentView} from './contentview';\nimport {CommentForm} from './commentform';\n\nimport './css/feed.css';\nimport './css/gratitude.css';\nimport './css/important.css';\nimport './css/warning.css';\nimport './css/taskcreator.css';\nimport './css/task.css';\nimport './css/timeman.css';\nimport './css/calendar.css';\n\nclass Feed\n{\n\tconstructor()\n\t{\n\t\tthis.entryData = {};\n\t\tthis.feedInitialized = false;\n\t\tthis.moreButtonDataList = new Map();\n\n\t\tthis.currentScrollPosition = 0;\n\t}\n\n\tinitOnce(params)\n\t{\n\t\tconst loaderContainer = document.getElementById('feed-loader-container');\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\n\t\tif (Type.isStringFilled(params.signedParameters))\n\t\t{\n\t\t\tPageInstance.setSignedParameters(params.signedParameters);\n\t\t}\n\n\t\tif (Type.isStringFilled(params.context))\n\t\t{\n\t\t\tPageInstance.setContext(params.context);\n\t\t}\n\n\t\tif (Type.isStringFilled(params.componentName))\n\t\t{\n\t\t\tPageInstance.setComponentName(params.componentName);\n\t\t}\n\n\t\tif (Type.isStringFilled(params.commentFormUID))\n\t\t{\n\t\t\tPageInstance.commentFormUID = params.commentFormUID;\n\t\t}\n\n\t\tif (loaderContainer)\n\t\t{\n\t\t\tEvent.bind(loaderContainer, 'animationend', Loader.onAnimationEnd)\n\t\t\tEvent.bind(loaderContainer, 'webkitAnimationEnd', Loader.onAnimationEnd)\n\t\t\tEvent.bind(loaderContainer, 'oanimationend', Loader.onAnimationEnd)\n\t\t\tEvent.bind(loaderContainer, 'MSAnimationEnd', Loader.onAnimationEnd)\n\t\t}\n\n\t\tEventEmitter.subscribe('BX.Forum.Spoiler:toggle', Forum.processSpoilerToggle);\n\n\t\tFilterInstance.init({\n\t\t\tfilterId: params.filterId,\n\t\t});\n\n\t\tInformerInstance.init({\n\t\t\tisSpaceFeatureEnabled: params.isSpaceEnabled,\n\t\t\tuserId: params.userId,\n\t\t\tspaceId: params.spaceId,\n\t\t});\n\n\t\tif (\n\t\t\tType.isStringFilled(params.crmEntityTypeName)\n\t\t\t&& !Type.isUndefined(params.crmEntityId)\n\t\t\t&& parseInt(params.crmEntityId) > 0\n\t\t)\n\t\t{\n\t\t\tFilterInstance.initEventsCrm();\n\t\t}\n\n\t\tBX.UserContentView.init();\n\n\t\tdocument.getElementById('log_internal_container').addEventListener('click', (e) => {\n\t\t\tconst tagValue = e.target.getAttribute('bx-tag-value');\n\t\t\tif (!Type.isStringFilled(tagValue))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (FilterInstance.clickTag(tagValue))\n\t\t\t{\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t}, true);\n\n\t\tconst noTasksNotificationCloseIcon = document.getElementById('feed-notification-notasks-close-btn');\n\t\tconst noTasksNotificationReadButton = document.getElementById('feed-notification-notasks-read-btn');\n\n\t\tif (noTasksNotificationCloseIcon)\n\t\t{\n\t\t\tEvent.bind(noTasksNotificationCloseIcon, 'click', this.setNoTasksNotificationRead.bind(this));\n\t\t}\n\t\tif (noTasksNotificationReadButton)\n\t\t{\n\t\t\tEvent.bind(noTasksNotificationReadButton, 'click', this.setNoTasksNotificationRead.bind(this));\n\t\t}\n\n\t\tEvent.bind(document, 'fullscreenchange', this.handleFullScreenChange.bind(this));\n\t\tEvent.bind(document, 'scroll', this.handleScrollChange.bind(this));\n\t}\n\n\thandleFullScreenChange()\n\t{\n\t\tif (!this.getFullScreenElement())\n\t\t{\n\t\t\twindow.scrollTo(0, this.currentScrollPosition);\n\t\t}\n\t}\n\n\thandleScrollChange()\n\t{\n\t\tif (!this.getFullScreenElement())\n\t\t{\n\t\t\tthis.currentScrollPosition = window.scrollY;\n\t\t}\n\t}\n\n\tgetFullScreenElement(): ?Element\n\t{\n\t\treturn (\n\t\t\tdocument.fullscreenElement\n\t\t\t|| document.webkitFullscreenElement\n\t\t\t|| document.mozFullScreenElement\n\t\t\t|| document.msFullscreenElement\n\t\t\t|| null\n\t\t);\n\t}\n\n\tinit()\n\t{\n\t\tif (this.feedInitialized)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tPinnedPanelInstance.init();\n\n\t\tthis.feedInitialized = true;\n\t}\n\n\tchangeFollow(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (!logId)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst followNode = document.getElementById('log_entry_follow_' + logId);\n\t\tconst valueOld = (followNode && followNode.getAttribute('data-follow') === 'Y' ? 'Y' : 'N');\n\t\tconst valueNew = (valueOld === 'Y' ? 'N' : 'Y');\n\n\t\tthis.renderFollow({\n\t\t\tlogId: logId,\n\t\t\tvalue: valueNew\n\t\t});\n\n\t\tajax.runAction('socialnetwork.api.livefeed.changeFollow', {\n\t\t\tdata: {\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: valueNew\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tb24statAction: (valueNew === 'Y' ? 'setFollow' : 'setUnfollow')\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tif (!response.data.success)\n\t\t\t{\n\t\t\t\tthis.renderFollow({\n\t\t\t\t\tlogId: logId,\n\t\t\t\t\tvalue: valueOld\n\t\t\t\t});\n\t\t\t}\n\t\t}, () => {\n\t\t\tthis.renderFollow({\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: valueOld\n\t\t\t});\n\t\t});\n\n\t\treturn false;\n\t}\n\n\trenderFollow(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tif (!logId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst followNode = document.getElementById('log_entry_follow_' + logId);\n\t\tconst value = (params.value && params.value === 'Y' ? 'Y' : 'N');\n\n\t\tif (followNode)\n\t\t{\n\t\t\tfollowNode.setAttribute('data-follow', value);\n\t\t}\n\n\t\tconst textNode = (followNode ? followNode.querySelector('a') : null);\n\t\tif (textNode)\n\t\t{\n\t\t\ttextNode.innerHTML = Loc.getMessage('SONET_EXT_LIVEFEED_FOLLOW_TITLE_' + value);\n\t\t}\n\n\t\tconst postNode = (followNode ? followNode.closest('.feed-post-block') : null);\n\t\tif (postNode)\n\t\t{\n\t\t\tif (value === 'N')\n\t\t\t{\n\t\t\t\tpostNode.classList.add('feed-post-block-unfollowed');\n\t\t\t}\n\t\t\telse if (value === 'Y')\n\t\t\t{\n\t\t\t\tpostNode.classList.remove('feed-post-block-unfollowed');\n\t\t\t}\n\t\t}\n\t}\n\n\tchangeFavorites(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst event = (params.event ? params.event : null);\n\n\t\tlet node = (params.node ? params.node : null);\n\t\tlet newState = (params.newState ? params.newState : null);\n\n\t\tif (Type.isStringFilled(node))\n\t\t{\n\t\t\tnode = document.getElementById(node);\n\t\t}\n\n\t\tif (!logId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet menuItem = null;\n\n\t\tif (event)\n\t\t{\n\t\t\tmenuItem = event.target;\n\t\t\tif (!menuItem.classList.contains('menu-popup-item-text'))\n\t\t\t{\n\t\t\t\tmenuItem = menuItem.querySelector('.menu-popup-item-text');\n\t\t\t}\n\t\t}\n\n\t\tlet nodeToAdjust = null;\n\n\t\tif (Type.isDomNode(node))\n\t\t{\n\t\t\tnodeToAdjust = (\n\t\t\t\tnode.classList.contains('feed-post-important-switch')\n\t\t\t\t\t? node\n\t\t\t\t\t: node.querySelector('.feed-post-important-switch')\n\t\t\t);\n\t\t}\n\n\t\tif (typeof this.entryData[logId] == 'undefined')\n\t\t{\n\t\t\tthis.entryData[logId] = {};\n\t\t}\n\n\t\tif (typeof this.entryData[logId].favorites != 'undefined')\n\t\t{\n\t\t\tnewState = (this.entryData[logId].favorites ? 'N' : 'Y');\n\t\t\tthis.entryData[logId].favorites = !this.entryData[logId].favorites;\n\t\t}\n\t\telse if (nodeToAdjust)\n\t\t{\n\t\t\tnewState = (\n\t\t\t\tnodeToAdjust.classList.contains('feed-post-important-switch-active')\n\t\t\t\t\t? 'N'\n\t\t\t\t\t: 'Y'\n\t\t\t);\n\t\t\tthis.entryData[logId].favorites = (newState == 'Y');\n\t\t}\n\n\t\tif (!newState)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.adjustFavoritesControlItem(nodeToAdjust, newState);\n\t\tthis.adjustFavoritesMenuItem(menuItem, newState);\n\n\t\tajax.runAction('socialnetwork.api.livefeed.changeFavorites', {\n\t\t\tdata: {\n\t\t\t\tlogId: logId,\n\t\t\t\tvalue: newState,\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tb24statAction: (newState == 'Y' ? 'addFavorites' : 'removeFavorites')\n\t\t\t}\n\t\t}).then(response =>\n\t\t{\n\t\t\tif (\n\t\t\t\tType.isStringFilled(response.data.newValue)\n\t\t\t\t&& ['Y', 'N'].includes(response.data.newValue)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.entryData[logId].favorites = (response.data.newValue == 'Y');\n\t\t\t}\n\n\t\t\tthis.adjustFavoritesControlItem(nodeToAdjust, response.data.newValue);\n\t\t\tthis.adjustFavoritesMenuItem(menuItem, response.data.newValue);\n\n\t\t}, () => {\n\t\t\tthis.entryData[logId].favorites = !this.entryData[logId].favorites;\n\t\t});\n\t}\n\n\tadjustFavoritesMenuItem(menuItemNode, state)\n\t{\n\t\tif (\n\t\t\t!Type.isDomNode(menuItemNode)\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tmenuItemNode.innerHTML = this.getMenuTitle(state === 'Y');\n\t}\n\n\tadjustFavoritesControlItem(node, state)\n\t{\n\t\tif (\n\t\t\t!Type.isDomNode(node)\n\t\t\t|| !['Y', 'N'].includes(state)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnode.title = this.getMenuTitle(state === 'Y');\n\t\tif (state == 'Y')\n\t\t{\n\t\t\tnode.classList.add('feed-post-important-switch-active');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.classList.remove('feed-post-important-switch-active');\n\t\t}\n\t}\n\n\tgetMenuTitle(state: boolean): string\n\t{\n\t\treturn Loc.getMessage(`SONET_EXT_LIVEFEED_MENU_TITLE_FAVORITES_${state ? 'Y' : 'N'}`);\n\t}\n\n\tdelete(params)\n\t{\n\t\tconst logId = (params.logId ? parseInt(params.logId) : 0);\n\t\tconst node = (Type.isStringFilled(params.nodeId) ? document.getElementById(params.nodeId) : null);\n\t\tconst ind = (params.ind ? params.ind : '');\n\n\t\tif (\n\t\t\tlogId <= 0\n\t\t\t|| !node\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tajax.runAction('socialnetwork.api.livefeed.deleteEntry', {\n\t\t\tdata: {\n\t\t\t\tlogId: logId,\n\t\t\t},\n\t\t\tanalyticsLabel: {\n\t\t\t\tb24statAction: 'deleteLogEntry',\n\t\t\t}\n\t\t}).then((response) => {\n\t\t\tif (response.data.success)\n\t\t\t{\n\t\t\t\tif (!Type.isUndefined(ind))\n\t\t\t\t{\n\t\t\t\t\tMenuManager.destroy(Post.getMenuId(ind));\n\t\t\t\t}\n\t\t\t\tthis.deleteSuccess(node);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.deleteFailure(node);\n\t\t\t}\n\t\t}, () => {\n\t\t\tthis.deleteFailure(node);\n\t\t});\n\t}\n\n\tdeleteSuccess(node)\n\t{\n\t\tif (!Type.isDomNode(node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t(new BX.fx({\n\t\t\ttime: 0.5,\n\t\t\tstep: 0.05,\n\t\t\ttype: 'linear',\n\t\t\tstart: node.offsetHeight,\n\t\t\tfinish: 56,\n\t\t\tcallback: (height) => {\n\t\t\t\tnode.style.height = `${height}px`;\n\t\t\t},\n\t\t\tcallback_start: () => {\n\t\t\t\tnode.style.overflow = 'hidden';\n\t\t\t\tnode.style.minHeight = 0;\n\t\t\t},\n\t\t\tcallback_complete: () => {\n\t\t\t\tnode.style.marginBottom = 0;\n\t\t\t\tDom.clean(node);\n\t\t\t\tnode.classList.add('feed-post-block-deleted');\n\t\t\t\tnode.appendChild(Tag.render`<div class=\"feed-add-successfully\"><span class=\"feed-add-info-text\"><span class=\"feed-add-info-icon\"></span><span>${Loc.getMessage('SONET_EXT_LIVEFEED_DELETE_SUCCESS')}</span></span></span></div>`);\n\t\t\t}\n\t\t})).start();\n\t}\n\n\tdeleteFailure(node)\n\t{\n\t\tif (!Type.isDomNode(node))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tnode.insertBefore(Tag.render`<div class=\"feed-add-error\" style=\"margin: 18px 37px 4px 84px;\"><span class=\"feed-add-info-text\"><span class=\"feed-add-info-icon\"></span><span>${Loc.getMessage('sonetLMenuDeleteFailure')}</span></span></div>`, node.firstChild);\n\t}\n\n\tsetMoreButtons(value)\n\t{\n\t\tthis.moreButtonDataList = value;\n\t}\n\n\tgetMoreButtons()\n\t{\n\t\treturn this.moreButtonDataList;\n\t}\n\n\tclearMoreButtons()\n\t{\n\t\tfor (const buttonData of this.moreButtonDataList)\n\t\t{\n\t\t\tconst moreButton = document.getElementById(buttonData.outerBlockID)?.querySelector(`.${MoreButton.cssClass.more}`);\n\t\t\tif (!moreButton?.hasClickListener)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.moreButtonDataList.clear();\n\t}\n\n\taddMoreButton(key, data)\n\t{\n\t\tthis.moreButtonDataList.set(key, data);\n\t}\n\n\tsetNoTasksNotificationRead(event)\n\t{\n\t\tconst notificationNode = event.currentTarget.closest('.feed-notification-container');\n\t\tif (!notificationNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tajax.runAction('socialnetwork.api.livefeed.readNoTasksNotification', {\n\t\t\tdata: {}\n\t\t}).then((response) => {\n\t\t\tif (!response.data.success)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnotificationNode.style.height = notificationNode.offsetHeight + 'px';\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tnotificationNode.classList.add('feed-notification-container-collapsed');\n\t\t\t}, 10);\n\t\t\tsetTimeout(() => {\n\t\t\t\tnotificationNode.parentNode.removeChild(notificationNode);\n\t\t\t}, 250);\n\n\t\t}, () => {});\n\t}\n\n}\n\nconst FeedInstance = new Feed();\nconst PinnedPanelInstance = new PinnedPanel();\nconst InformerInstance = new Informer();\nconst FilterInstance = new Filter();\nconst PageInstance = new Page();\nconst MoreButtonInstance = new MoreButton();\nnew TaskCreator();\n\nexport {\n\tFeedInstance,\n\tPinnedPanelInstance,\n\tInformerInstance,\n\tFilterInstance,\n\tPageInstance,\n\tMoreButtonInstance,\n\tPost,\n\tTaskCreator,\n\tLoader,\n\tMoreButton,\n\tContentView,\n\tCommentForm,\n};"],"names":["Utils","node","styles","Object","entries","forEach","key","value","style","PinnedPanel","pin","post","postHide","postComments","postPinned","postPinnedHide","postPinActive","postUnfollowed","postExpanding","panelCollapsed","panelNonEmpty","panelPosts","collapsedPanel","collapsedPanelExpand","collapsedPanelCounterPostsValue","collapsedPanelCounterComments","collapsedPanelCounterCommentsValue","collapsedPanelCounterCommentsShown","collapsedPanelCounterCommentsValueNew","collapsedPanelCounterCommentsValueNewValue","collapsedPanelCounterCommentsValueNewActive","collapsedPanelCounterCommentsValueOld","collapsedPanelCounterCommentsValueAll","collapsedPanelShow","collapsedPanelHide","cancelPanel","cancelPanelButton","cancelPanelLabel","panelInitialized","postsInitialized","handlePostClick","bind","options","Event","ready","initPosts","initPanel","initEvents","optionName","pinnedPanelNode","getPanelNode","adjustCollapsedPostsPanel","getCollapsedPanelNode","collapsedHeight","offsetHeight","setStyle","height","transition","setTimeout","hideCollapsedPanel","event","likeClicked","target","classList","contains","closest","followClicked","menuClicked","contentViewClicked","pinClicked","collapseClicked","commentsClicked","postNode","remove","menuId","getAttribute","MenuManager","destroy","BaseEvent","compatData","rootNode","data","EventEmitter","emit","anchorNode","querySelector","position","Dom","getPosition","window","scrollTo","top","stopPropagation","preventDefault","add","postList","document","querySelectorAll","length","Array","from","unbind","newState","logId","parseInt","changePinned","then","subscribe","getData","xmlId","id","getCommentsData","oldValue","newValue","setCommentsData","Type","isInteger","incrementMaxListeners","params","commentId","allValue","follow","commentsData","AUTHOR","ID","BX","message","panelNode","Promise","resolve","reject","getOption","setPostState","state","action","ajax","runAction","analyticsLabel","b24statAction","response","success","movePost","includes","setAttribute","Loc","getMessage","headers","name","entityValue","tokenValue","postToMove","parentNode","originalPostHeight","getPinnedData","pinnedPanelTitleNode","pinnedPanelDescriptionNode","pinnedPanelPinNode","innerHTML","TITLE","DESCRIPTION","title","cancelPinnedPanel","getCancelPinnedPanel","anchor","nextSibling","insertBefore","centerCancelPinnedPanelElements","cancelPanelHeight","width","backgroundColor","opacity","setOptions","panelHeight","pinBlocked","unbindAll","checkTransitionProperty","panelPostsNode","firstChild","adjustPanel","showCollapsedPostsPanel","pinnedHeight","scrollHeight","isDomNode","requestAnimationFrame","collapsed","showCollapsed","hideCollapsedPostsPanel","transform","display","animateCancel","marginBottom","Tag","render","marginLeft","getBoundingClientRect","getElementsByClassName","reduce","count","item","map","currentIndex","originalItemsList","postsCounter","getPostsCount","postsCounterNode","commentsCounterNode","commentsCounterValueNode","newCommentCounter","acc","showCollapsedPanel","hidePinnedItems","removeCollapsedPanel","showPinnedItems","animateCollapsedPanel","result","newNode","newValueNode","oldNode","allNode","isStringFilled","commentsNode","newPinnedCommentsNode","newValuePinnedCommentsNode","oldPinnedCommentsNode","allPinnedCommentsNode","getCommentsNodes","newCommentsValue","oldCommentsValue","allCommentsValue","matches","match","propertyName","Api","createParams","entityType","entityId","postEntityType","taskLinkData","console","error","signedFiles","taskId","sourceEntityType","sourceEntityId","EntityType","freeze","CalendarEvent","BlogPost","BlogComment","Context","Feed","Element","PostContextMenu","CommentContextMenu","Analytics","CardBuilder","requestData","isFromComment","Date","now","description","groupId","Number","GROUP_ID","parentId","PARENT_ID","auditorsIds","AUDITORS","split","filter","fileIds","UF_TASK_WEBDAV_FILES","source","analytics","context","element","type","subEntityId","text","Text","decode","url","URL","location","toString","suffix","SUFFIX","headerLoc","headerText","replace","createdTasks","Set","eventHandler","task","initialTask","createEntityComment","cardParams","has","clearNewTaskFiles","UF_TASK_WEBDAV_FILES_SIGN","createFromContent","init","getTaskLinkData","buildCardParams","Runtime","loadExtension","TaskCard","showCompactCard","showFullCard","TaskCreator","getCompatData","isPlainObject","isBoolean","STAY_AT_PAGE","sliderInstance","getTarget","sliderUrl","getUrl","entityData","formatTaskDescription","parentTaskId","link","getLinkWithAnalytics","SidePanel","Instance","open","requestMethod","requestParams","cacheable","createTaskPopup","Popup","autoHide","zIndex","offsetLeft","offsetTop","overlay","lightShadow","closeIcon","right","draggable","restrict","closeByEsc","contentColor","contentNoPaddings","buttons","content","cssClass","popupContent","events","onAfterPopupShow","createTaskSetContent","popupTitle","isNumber","additionalParams","getSonetGroupAvailable","getLivefeedUrl","checkPermissions","feature","operation","entryTitle","entryDescription","entryDiskObjects","DISK_OBJECTS","entryUrl","LIVEFEED_URL","entrySuffix","groupsAvailable","GROUPS_AVAILABLE","isUndefined","LOG_ID","taskDescription","taskData","RESPONSIBLE_ID","CREATED_BY","sonetGroupIdList","push","runComponentAction","mode","resultData","createTaskSetContentSuccess","DATA","errors","createTaskSetContentFailure","onPopupClose","show","analyticsElement","isNil","analyticsSection","Uri","addParam","ta_sec","ta_el","taskLink","UI","Notification","Center","notify","actions","click","balloon","close","popupDescription","join","contentNode","containerNode","getElementById","clean","appendChild","livefeedUrl","Boolean","Post","urlToEdit","menuPopupWindow","dialog","bindOnResize","titleBar","className","Button","menuElement","ind","getMenuId","log_id","bFavorites","arMenuItemsAdditional","JSON","parse","e","bindElement","itemPinned","pinnedPostNode","pinnedState","onclick","PinnedPanelInstance","getMenuById","popupWindow","itemFavorites","__logChangeFavorites","arItems","html","href","menuItemText","menuItemIconDone","clipboard","isCopySupported","copy","adjust","attrs","it","currentTarget","pos","pos2","pos3","overflow","children","create","select","fx","time","step","start","finish","callback","hide","confirm","FeedInstance","nodeId","entryEntityType","isArray","concat","arParams","angle","offset","onPopupShow","ob","favoritesMenuItem","menuItems","contentContainer","menuItem","linkMenuItem","popupContainer","postId","postForm","PostForm","Informer","container","wrap","plus","currentSiteId","currentCounterType","counterDecrementStack","counterValue","lockCounterAnimation","isSpaceFeatureEnabled","currentUserId","currentSpaceId","informerFixed","informerAnimation","informerFixedAnimation","counterText","counterContainer","reloadContainer","icon","iconRotating","plusHidden","props","defaultValues","userId","spaceId","initNodes","hasMessage","addEventListener","showReloadAnimation","unfixWrap","subscribeOnSpaceCounters","subscribeOnLiveFeedCounters","counterData","isObjectLike","changeCounter","live","decrementCounter","command","eventParams","userFromEvent","spaces","currentSpace","find","space","currentSpaceCounter","metrics","countersLiveFeedTotal","clone","valueToShow","changeAnimate","counter","zeroCounterFromDb","counterTextNode","reloadNode","showWrapAnimation","hideReloadAnimation","hideWrapAnimation","visibility","counterWaiterNode","counterNodeWaiter","fixWrap","counterContainerNode","hideReloadNode","Loader","feedContainer","feedMask","feedNoMask","loaderContainer","hideLoader","showLoader","animationName","MoreButton","onRecalculateLivefeedComments","baseEvent","informerBlock","moreBlock","more","postSeparator","recalcPost","arPos","blockHeight","bodyBlock","postBlock","postShort","buttonsList","getMoreButtons","buttonData","bodyBlockID","bodyNode","outerBlockID","outerNode","offsetWidth","innerNode","postTextInner","overflowX","moreButton","Animations","expand","moreButtonNode","classBlock","postText","classOuter","classInner","postTextInnerInner","heightLimit","textBlock","hasClickListener","informerBlockID","setMoreButtons","onLoadImageList","imageNode","outerBlock","comment","image","textType","Forum","Filter","filterId","filterApi","Main","filterManager","getById","getApi","showRefreshFade","filterValues","filterPromise","filterParams","autoResolve","PageInstance","refresh","useBXMainFilter","searchString","hideRefreshFade","tagValue","setFields","TAG","apply","filterContainer","getSearch","getSquares","getSearchString","pagetitleContainer","easing","duration","scroll","pageYOffset","makeEaseOut","transitions","quart","complete","animate","ContentView","fullContentArea","viewAreaList","findChildren","tag","i","findChild","UserContentView","registerViewArea","Page","loadStarted","stopTrackNextPage","requestMode","nextPageFirst","nextPageUrl","scrollInitialized","firstPageLastTS","firstPageLastId","commentFormUID","blogCommentFormUID","signedParameters","componentName","setRequestModeNew","siteTemplateId","assetsCheckSum","clearCommentsList","clearMoreButtons","InformerInstance","getSignedParameters","c","getComponentName","logajax","RELOAD","responseData","fulfill","emptyLivefeed","componentResult","EMPTY","forcePageRefresh","FORCE_PAGE_REFRESH","isFilterUsed","FILTER_USED","reload","emptyBlock","emptyTextNode","clearContainerExternal","LazyLoad","clearImages","pageNode","Math","floor","random","recalcPostsList","recalcCommentsList","registerAreaList","resetFlags","informerWrap","getWrap","showRefreshError","stubContainer","stubFirstContainer","setRequestModeMore","nextUrlParamsList","getNextPageUrl","getQueryParams","pageNumber","prevPageLogId","ts","noblog","decodeURI","queryParams","PAGE_NUMBER","LAST_LOG_TIMESTAMP","PREV_PAGE_LOG_ID","preset_filter_top_id","preset_filter_id","queryData","CREATED_BY_ID","flt_created_by_id","flt_date_datesel","flt_date_from","decodeURIComponent","flt_date_to","lastEntryTimestamp","LAST_TS","lastEntryId","LAST_ID","isNull","contentBlockId","f","recover","counterPreset","onFeedScroll","maxScroll","documentElement","innerHeight","getNextPage","CommentForm","taskIdList","resultFieldTaskIdList","ResultManager","taskResultCommentsData","assign","commentsIdList","getInstance","initResult","comments","obj","postData","ENTITY_XML_ID","currentEntity","ENTITY_TYPE","ENTITY_ID","comment_post_id","edit_id","act","form","onLightEditorShow","Tasks","showField","hideField","UF","arFiles","fileId","index","size","FILE_ID","FILE_NAME","FILE_SIZE","CONTENT_TYPE","UF_SONET_COM_DOC","USER_TYPE_ID","FIELD_NAME","VALUE","arDocs","UF_SONET_COM_FILE","arDFiles","LHEPostForm","reinitData","SLEC","editorId","entryData","feedInitialized","moreButtonDataList","Map","currentScrollPosition","setSignedParameters","setContext","setComponentName","onAnimationEnd","processSpoilerToggle","FilterInstance","isSpaceEnabled","crmEntityTypeName","crmEntityId","initEventsCrm","clickTag","noTasksNotificationCloseIcon","noTasksNotificationReadButton","setNoTasksNotificationRead","handleFullScreenChange","handleScrollChange","getFullScreenElement","scrollY","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","followNode","valueOld","valueNew","renderFollow","textNode","nodeToAdjust","favorites","adjustFavoritesControlItem","adjustFavoritesMenuItem","menuItemNode","getMenuTitle","deleteSuccess","deleteFailure","callback_start","minHeight","callback_complete","clear","set","notificationNode","removeChild","MoreButtonInstance"],"mappings":"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"}