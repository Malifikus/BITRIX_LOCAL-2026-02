{"version":3,"file":"massconnect-form.bundle.js","sources":["../src/utils/options/mail-integration-options/enum/period.js","../src/utils/options/crm-integration-options/enum/period.js","../src/utils/options/crm-integration-options/enum/create-action.js","../src/utils/options/crm-integration-options/enum/source.js","../src/store/const.js","../src/store/wizard.js","../src/components/wizard/wizard-progress-bar.js","../src/mixins/localization-mixin.js","../src/components/wizard/wizard-navigation.js","../src/components/wizard/steps/connection-data/connection-data.js","../src/api.js","../src/components/wizard/steps/select-employees/employee-list-table.js","../src/components/wizard/steps/select-employees/select-employees.js","../src/mixins/prepare-options-phrases-mixin.js","../src/mixins/prepared-indirect-phrase-mixin.js","../src/components/tools/bitrix-setting-selector.js","../src/utils/options/mail-integration-options/component-options.js","../src/components/integrations/mail-integration.js","../src/components/tools/user-selector.js","../src/utils/options/crm-integration-options/component-options.js","../src/components/integrations/crm-integration.js","../src/components/integrations/calendar-integration.js","../src/components/wizard/steps/mailbox-settings/mailbox-settings.js","../src/event.js","../src/components/wizard/connection-status/connection-status.js","../src/components/wizard/wizard-hint.js","../src/components/wizard/wizard-container.js","../src/massconnect-form.js"],"sourcesContent":["export const MailSyncPeriod = Object.freeze({\n\tDAY: '1',\n\tWEEK: '7',\n\tMONTH: '30',\n\tTWO_MONTHS: '60',\n\tTHREE_MONTHS: '90',\n});\n","export const CrmSyncPeriod = Object.freeze({\n\tWEEK: '7',\n\tMONTH: '30',\n\tALL_TIME: '-1',\n});\n","export const CrmCreateAction = Object.freeze({\n\tLEAD: 'LEAD',\n\tCONTACT: 'CONTACT',\n});\n","export const CrmSource = Object.freeze({\n\tCALL: 'CALL',\n\tEMAIL: 'EMAIL',\n\tWEB: 'WEB',\n\tADVERTISING: 'ADVERTISING',\n\tPARTNER: 'PARTNER',\n\tRECOMMENDATION: 'RECOMMENDATION',\n\tTRADE_SHOW: 'TRADE_SHOW',\n\tWEBFORM: 'WEBFORM',\n\tCALLBACK: 'CALLBACK',\n\tRC_GENERATOR: 'RC_GENERATOR',\n\tSTORE: 'STORE',\n\tOTHER: 'OTHER',\n\tBOOKING: 'BOOKING',\n\tREPEAT_SALE: 'REPEAT_SALE',\n});\n","export const YES_VALUE = 'Y';\nexport const NO_VALUE = 'N';\n\nexport const SERVICE_CONFIG = {\n\tserviceType: 'imap',\n\tname: 'other',\n};\n","import { defineStore } from 'ui.vue3.pinia';\nimport { MailSyncPeriod } from '../utils/options/mail-integration-options/enum/period';\nimport { CrmSyncPeriod } from '../utils/options/crm-integration-options/enum/period';\nimport { CrmCreateAction } from '../utils/options/crm-integration-options/enum/create-action';\nimport { CrmSource } from '../utils/options/crm-integration-options/enum/source';\nimport type {\n\tBackendPayload,\n\tCrmOptionsPayload,\n\tCrmSettingsState,\n\tCalendarSettingsState,\n\tMassConnectDataType,\n\tMassconnectPermissions,\n\tEmployee,\n\tMailSettingsState,\n} from './type';\nimport { YES_VALUE, NO_VALUE, SERVICE_CONFIG } from './const';\n\nexport const useWizardStore = defineStore('wizard', {\n\tstate: () => ({\n\t\tconnectionSettings: {\n\t\t\timapServer: '',\n\t\t\timapPort: null,\n\t\t\timapSsl: true,\n\t\t\tsmtpSettings: {\n\t\t\t\tenabled: false,\n\t\t\t\tserver: '',\n\t\t\t\tport: null,\n\t\t\t\tssl: true,\n\t\t\t},\n\t\t},\n\t\temployees: [],\n\t\taddedEmployees: [],\n\t\tmailSettings: {\n\t\t\tsync: {\n\t\t\t\tenabled: true,\n\t\t\t\tperiodValue: MailSyncPeriod.WEEK,\n\t\t\t},\n\t\t},\n\t\tcrmSettings: {\n\t\t\tenabled: false,\n\t\t\tsync: {\n\t\t\t\tenabled: true,\n\t\t\t\tperiodValue: CrmSyncPeriod.WEEK,\n\t\t\t},\n\t\t\tassignKnownClientEmails: true,\n\t\t\tincoming: {\n\t\t\t\tenabled: true,\n\t\t\t\tcreateAction: CrmCreateAction.LEAD,\n\t\t\t},\n\t\t\toutgoing: {\n\t\t\t\tenabled: true,\n\t\t\t\tcreateAction: CrmCreateAction.CONTACT,\n\t\t\t},\n\t\t\tsource: CrmSource.EMAIL,\n\t\t\tleadCreationAddresses: '',\n\t\t\tresponsibleQueue: [],\n\t\t},\n\t\tcalendarSettings: {\n\t\t\tenabled: true,\n\t\t\tautoAddEvents: true,\n\t\t},\n\t\terrorState: {\n\t\t\tenabled: false,\n\t\t\terrorCnt: 0,\n\t\t},\n\t\tisLoginColumnShown: false,\n\t\tanalyticsSource: '',\n\t\tpermissions: {\n\t\t\tallowedLevels: null,\n\t\t\tcanEditCrmIntegration: false,\n\t\t},\n\t}),\n\tactions: {\n\t\taddEmployee(employeeItem: Employee): void\n\t\t{\n\t\t\tif (this.employees.some((employee) => employee.id === employeeItem.id))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.employees.push(employeeItem);\n\t\t},\n\t\tremoveEmployeeById(employeeId: number): void\n\t\t{\n\t\t\tthis.employees = this.employees.filter((employee) => employee.id !== employeeId);\n\t\t},\n\t\tsetEmployees(employees: Employee[]): void\n\t\t{\n\t\t\tthis.employees = employees;\n\t\t},\n\t\tclearEmployees(): void\n\t\t{\n\t\t\tthis.employees = [];\n\t\t},\n\t\tsetAddedEmployees(employees: Employee[]): void\n\t\t{\n\t\t\tthis.addedEmployees = employees;\n\t\t},\n\t\tsetMailSettings(newSettings: MailSettingsState): void\n\t\t{\n\t\t\tthis.mailSettings = newSettings;\n\t\t},\n\t\tsetCrmSettings(newSettings: CrmSettingsState): void\n\t\t{\n\t\t\tthis.crmSettings = newSettings;\n\t\t},\n\t\tsetCalendarSettings(newSettings: CalendarSettingsState): void\n\t\t{\n\t\t\tthis.calendarSettings = newSettings;\n\t\t},\n\t\tprepareCrmOptions(): CrmOptionsPayload\n\t\t{\n\t\t\tif (!this.crmSettings.enabled)\n\t\t\t{\n\t\t\t\treturn { enabled: NO_VALUE };\n\t\t\t}\n\n\t\t\tconst crmOptions: CrmOptionsPayload = { enabled: YES_VALUE, config: {} };\n\n\t\t\tif (this.crmSettings.sync.enabled)\n\t\t\t{\n\t\t\t\tcrmOptions.config.crm_sync_days = parseInt(this.crmSettings.sync.periodValue, 10) || 0;\n\t\t\t}\n\n\t\t\tif (this.crmSettings.assignKnownClientEmails)\n\t\t\t{\n\t\t\t\tcrmOptions.config.crm_public = this.crmSettings.assignKnownClientEmails ? YES_VALUE : NO_VALUE;\n\t\t\t}\n\n\t\t\tif (this.crmSettings.incoming.enabled)\n\t\t\t{\n\t\t\t\tcrmOptions.config.crm_new_entity_in = this.crmSettings.incoming.createAction;\n\t\t\t}\n\n\t\t\tif (this.crmSettings.outgoing.enabled)\n\t\t\t{\n\t\t\t\tcrmOptions.config.crm_new_entity_out = this.crmSettings.outgoing.createAction;\n\t\t\t}\n\n\t\t\tcrmOptions.config.crm_lead_source = this.crmSettings.source;\n\n\t\t\tif (this.crmSettings.responsibleQueue.length > 0)\n\t\t\t{\n\t\t\t\tcrmOptions.config.crm_lead_resp = this.crmSettings.responsibleQueue.map((item) => item.id);\n\t\t\t}\n\n\t\t\tif (this.crmSettings.leadCreationAddresses.length > 0)\n\t\t\t{\n\t\t\t\tcrmOptions.config.crm_new_lead_for = this.crmSettings.leadCreationAddresses;\n\t\t\t}\n\n\t\t\treturn crmOptions;\n\t\t},\n\t\tprepareDataForBackend(): BackendPayload\n\t\t{\n\t\t\tconst crmOptions = this.prepareCrmOptions();\n\n\t\t\tconst mailboxes = this.employees.map((employee) => {\n\t\t\t\tconst smtpServer = this.connectionSettings.smtpSettings.server;\n\t\t\t\tconst smtpPort = this.connectionSettings.smtpSettings.port;\n\t\t\t\tconst isSmtpDataFilled = Boolean(smtpServer && smtpPort);\n\t\t\t\tconst useSmtp = this.connectionSettings.smtpSettings.enabled && isSmtpDataFilled\n\t\t\t\t\t? YES_VALUE\n\t\t\t\t\t: NO_VALUE;\n\n\t\t\t\tconst mailboxData = {\n\t\t\t\t\tuserIdToConnect: employee.id,\n\t\t\t\t\temail: employee.email,\n\t\t\t\t\tlogin: employee.login || employee.email,\n\t\t\t\t\tpassword: employee.password,\n\t\t\t\t\tloginSmtp: employee.login || employee.email,\n\t\t\t\t\tpasswordSMTP: employee.password,\n\t\t\t\t\tmailboxName: employee.email,\n\t\t\t\t\tsenderName: employee.name,\n\n\t\t\t\t\tserver: this.connectionSettings.imapServer,\n\t\t\t\t\tport: this.connectionSettings.imapPort,\n\t\t\t\t\tssl: this.connectionSettings.imapSsl ? YES_VALUE : NO_VALUE,\n\t\t\t\t\tuseSmtp,\n\t\t\t\t\tserverSmtp: this.connectionSettings.smtpSettings.server,\n\t\t\t\t\tportSmtp: this.connectionSettings.smtpSettings.port,\n\t\t\t\t\tsslSmtp: this.connectionSettings.smtpSettings.ssl ? YES_VALUE : NO_VALUE,\n\n\t\t\t\t\tiCalAccess: this.calendarSettings.enabled && this.calendarSettings.autoAddEvents\n\t\t\t\t\t\t? YES_VALUE\n\t\t\t\t\t\t: NO_VALUE,\n\n\t\t\t\t\tserviceConfig: SERVICE_CONFIG,\n\t\t\t\t\tsyncAfterConnection: NO_VALUE,\n\t\t\t\t\tmessageMaxAge: parseInt(this.mailSettings.sync.periodValue, 10),\n\t\t\t\t};\n\n\t\t\t\treturn { ...mailboxData, crmOptions: { ...crmOptions } };\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\tmailboxes,\n\t\t\t};\n\t\t},\n\t\tenableErrorState(errorCnt: number): void\n\t\t{\n\t\t\tthis.errorState = {\n\t\t\t\tenabled: true,\n\t\t\t\terrorCnt,\n\t\t\t};\n\t\t},\n\t\ttoggleLoginColumn(): void\n\t\t{\n\t\t\tthis.isLoginColumnShown = !this.isLoginColumnShown;\n\n\t\t\tif (!this.isLoginColumnShown)\n\t\t\t{\n\t\t\t\tthis.employees = this.employees.map((employee) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...employee,\n\t\t\t\t\t\tlogin: '',\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tsetAnalyticsSource(source: string): void\n\t\t{\n\t\t\tthis.analyticsSource = source;\n\t\t},\n\t\tsetSmtpStatus(isAvailable: boolean): void\n\t\t{\n\t\t\tthis.connectionSettings.smtpSettings.enabled = isAvailable;\n\t\t},\n\t\tprepareDataForHistory(): MassConnectDataType\n\t\t{\n\t\t\treturn {\n\t\t\t\tconnectionSettings: this.connectionSettings,\n\t\t\t\tmailSettings: this.mailSettings,\n\t\t\t\tcrmSettings: this.crmSettings,\n\t\t\t\tcalendarSettings: this.calendarSettings,\n\t\t\t\temployees: this.employees.map((employee) => {\n\t\t\t\t\treturn { ...employee, password: '' };\n\t\t\t\t}),\n\t\t\t};\n\t\t},\n\t\tsetPermissions(permissions: MassconnectPermissions): void\n\t\t{\n\t\t\tthis.permissions.allowedLevels = [permissions?.allowedLevels];\n\t\t\tthis.permissions.canEditCrmIntegration = permissions?.canEditCrmIntegration;\n\t\t},\n\t},\n});\n","// @vue/component\nexport const WizardProgressBar = {\n\tprops: {\n\t\ttotalSteps: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tcurrentStepIndex: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"mail_massconnect__wizard_progress-bar\">\n\t\t\t<div\n\t\t\t\tv-for=\"(step, index) in totalSteps\"\n\t\t\t\t:key=\"index\"\n\t\t\t\tclass=\"mail_massconnect__wizard_progress-bar__item\"\n\t\t\t\t:data-test-id=\"'mail_massconnect__wizard_progress-bar__item' + index\"\n\t\t\t\t:class=\"{ 'mail_massconnect__wizard_progress-bar__item--active': index <= currentStepIndex }\"\n\t\t\t>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export const LocalizationMixin = {\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n};\n","import { LocalizationMixin } from '../../mixins/localization-mixin';\nimport { Button as UiButton, AirButtonStyle } from 'ui.vue3.components.button';\n\n// @vue/component\nexport const WizardNavigation = {\n\tcomponents: {\n\t\tUiButton,\n\t},\n\n\tmixins: [LocalizationMixin],\n\n\tprops: {\n\t\tisFirstStep: Boolean,\n\t\tisLastStep: Boolean,\n\t\tisSubmitting: Boolean,\n\t\tprevDisabled: Boolean,\n\t\tdisabledContinueButton: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\temits: ['prev-step', 'next-step', 'submit'],\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t};\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"mail_massconnect__wizard_navigation\" data-test-id=\"mail_massconnect__wizard_navigation\">\n\t\t\t<UiButton\n\t\t\t\tv-if=\"isLastStep\"\n\t\t\t\tclass=\"mail_massconnect__wizard_navigation_submit-button\"\n\t\t\t\t:text=\"loc('MAIL_MASSCONNECT_FORM_NAVIGATION_PANEL_CONNECT_BUTTON_TITLE')\"\n\t\t\t\t:style=\"AirButtonStyle.FILLED\"\n\t\t\t\t:waiting=\"isSubmitting\"\n\t\t\t\t@click=\"$emit('submit')\"\n\t\t\t/>\n\t\t\t<UiButton\n\t\t\t\tv-else\n\t\t\t\tclass=\"mail_massconnect__wizard_navigation_next-button\"\n\t\t\t\t:text=\"loc('MAIL_MASSCONNECT_FORM_NAVIGATION_PANEL_CONTINUTE_BUTTON_TITLE')\"\n\t\t\t\t:style=\"AirButtonStyle.FILLED\"\n\t\t\t\t:disabled=\"disabledContinueButton\"\n\t\t\t\t@click=\"$emit('next-step')\"\n\t\t\t/>\n\t\t\t<UiButton\n\t\t\t\tv-if=\"!isFirstStep && !prevDisabled\"\n\t\t\t\tclass=\"mail_massconnect__wizard_navigation_prev-button\"\n\t\t\t\t:text=\"loc('MAIL_MASSCONNECT_FORM_NAVIGATION_PANEL_BACK_BUTTON_TITLE')\"\n\t\t\t\t:style=\"AirButtonStyle.PLAIN\"\n\t\t\t\t@click=\"$emit('prev-step')\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { sendData as analyticsSendData } from 'ui.analytics';\nimport { InputDesign, InputSize } from 'ui.system.input';\nimport { BInput } from 'ui.system.input.vue';\nimport { mapState } from 'ui.vue3.pinia';\nimport { LocalizationMixin } from '../../../../mixins/localization-mixin';\nimport { useWizardStore } from '../../../../store/wizard.js';\nimport './connection-data.css';\n\n// @vue/component\nexport const ConnectionData = {\n\tcomponents: {\n\t\tBInput,\n\t},\n\n\tmixins: [LocalizationMixin],\n\n\tprops: {\n\t\tvalidationAttempted: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\temits: ['update:validity'],\n\n\tdisableButtonOnInvalid: false,\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tInputSize,\n\t\t\tInputDesign,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\t...mapState(useWizardStore, ['connectionSettings', 'analyticsSource']),\n\t\tisValid(): boolean\n\t\t{\n\t\t\tconst imapValid = Boolean(this.connectionSettings.imapServer && this.connectionSettings.imapPort);\n\n\t\t\tif (!this.connectionSettings.smtpSettings.enabled)\n\t\t\t{\n\t\t\t\treturn imapValid;\n\t\t\t}\n\n\t\t\tconst smtpServer = this.connectionSettings.smtpSettings.server;\n\t\t\tconst smtpPort = this.connectionSettings.smtpSettings.port;\n\t\t\tconst smtpFilled = Boolean(smtpServer || smtpPort);\n\n\t\t\tif (!smtpFilled)\n\t\t\t{\n\t\t\t\treturn imapValid;\n\t\t\t}\n\n\t\t\tconst smtpValid = Boolean(smtpServer && smtpPort);\n\n\t\t\treturn imapValid && smtpValid;\n\t\t},\n\t\tshowErrors(): boolean\n\t\t{\n\t\t\treturn this.validationAttempted;\n\t\t},\n\t\timapServerError(): ?string\n\t\t{\n\t\t\treturn this.showErrors && !this.connectionSettings.imapServer\n\t\t\t\t? this.loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_IMAP_INPUT_ERROR')\n\t\t\t\t: null;\n\t\t},\n\t\timapPortError(): ?string\n\t\t{\n\t\t\treturn this.showErrors && !this.connectionSettings.imapPort\n\t\t\t\t? this.loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_IMAP_PORTS_INPUT_ERROR')\n\t\t\t\t: null;\n\t\t},\n\t\tsmtpServerError(): ?string\n\t\t{\n\t\t\tif (!this.showErrors || !this.connectionSettings.smtpSettings.enabled)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst smtpServer = this.connectionSettings.smtpSettings.server;\n\t\t\tconst smtpPort = this.connectionSettings.smtpSettings.port;\n\n\t\t\tif (smtpPort && !smtpServer)\n\t\t\t{\n\t\t\t\treturn this.loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_SMTP_INPUT_ERROR');\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tsmtpPortError(): ?string\n\t\t{\n\t\t\tif (!this.showErrors || !this.connectionSettings.smtpSettings.enabled)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst smtpServer = this.connectionSettings.smtpSettings.server;\n\t\t\tconst smtpPort = this.connectionSettings.smtpSettings.port;\n\n\t\t\tif (smtpServer && !smtpPort)\n\t\t\t{\n\t\t\t\treturn this.loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_SMTP_PORTS_INPUT_ERROR');\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t},\n\n\twatch: {\n\t\tisValid: {\n\t\t\thandler(isValid)\n\t\t\t{\n\t\t\t\tthis.$emit('update:validity', isValid);\n\t\t\t},\n\t\t\timmediate: true,\n\t\t},\n\t},\n\n\tmethods: {\n\t\tonStepComplete(): void\n\t\t{\n\t\t\tanalyticsSendData({\n\t\t\t\ttool: 'mail',\n\t\t\t\tevent: 'mailbox_mass_step1',\n\t\t\t\tcategory: 'mail_mass_ops',\n\t\t\t\tc_section: this.analyticsSource,\n\t\t\t});\n\t\t},\n\t\thandleImapPortInput(port: string): void\n\t\t{\n\t\t\tthis.connectionSettings.imapPort = this.getSanitizedValue(port);\n\t\t},\n\t\thandleSmtpPortInput(port: string): void\n\t\t{\n\t\t\tthis.connectionSettings.smtpSettings.port = this.getSanitizedValue(port);\n\t\t},\n\t\tgetSanitizedValue(value: ?string): string\n\t\t{\n\t\t\treturn String(value ?? '').replaceAll(/\\D/g, '');\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"mail_massconnect__connection-data_form\" data-test-id=\"mail_massconnect__connection-data_form\">\n\t\t\t<div class=\"mail_massconnect__section-title_container\">\n\t\t\t\t<span class=\"mail_massconnect__section-title\">\n\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_CARD_TITLE_MSGVER_1') }}\n\t\t\t\t</span>\n\t\t\t\t<span class=\"mail_massconnect__section-description\">\n\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_CARD_DESCRIPTION') }}\n\t\t\t\t</span>\n\t\t\t</div>\n\n\t\t\t<div v-if=\"false\" data-test-id=\"mail_massconnect__connection-data_domain-group\">\n\t\t\t\t<BInput\n\t\t\t\t\tclass=\"mail_massconnect__group\"\n\t\t\t\t\t:label=\"loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_DOMAIN_INPUT_LABEL')\"\n\t\t\t\t\t:placeholder=\"loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_DOMAIN_INPUT_PLACEHOLDER')\"\n\t\t\t\t\t:size=\"InputSize.Lg\"\n\t\t\t\t\t:design=\"InputDesign.Grey\"\n\t\t\t\t\tv-model=\"connectionSettings.email\"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<div class=\"mail_massconnect__connection-block\">\n\t\t\t\t<div class=\"mail_massconnect__input-group\" data-test-id=\"mail_massconnect__connection-data_imap-group\">\n\t\t\t\t\t<BInput\n\t\t\t\t\t\tclass=\"mail_massconnect__input-group_main\"\n\t\t\t\t\t\t:label=\"loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_IMAP_INPUT_LABEL')\"\n\t\t\t\t\t\t:placeholder=\"loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_IMAP_INPUT_PLACEHOLDER')\"\n\t\t\t\t\t\t:size=\"InputSize.Lg\"\n\t\t\t\t\t\t:design=\"InputDesign.DEFAULT\"\n\t\t\t\t\t\tv-model=\"connectionSettings.imapServer\"\n\t\t\t\t\t\t:error=\"imapServerError\"\n\t\t\t\t\t/>\n\t\t\t\t\t<BInput\n\t\t\t\t\t\tclass=\"mail_massconnect__input-group_port\"\n\t\t\t\t\t\t:label=\"loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_IMAP_PORTS_INPUT_LABEL')\"\n\t\t\t\t\t\t:placeholder=\"loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_IMAP_PORTS_INPUT_PLACEHOLDER')\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t:size=\"InputSize.Lg\"\n\t\t\t\t\t\t:design=\"InputDesign.DEFAULT\"\n\t\t\t\t\t\tv-model=\"connectionSettings.imapPort\"\n\t\t\t\t\t\t:error=\"imapPortError\"\n\t\t\t\t\t\t@input=\"handleImapPortInput(connectionSettings.imapPort)\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mail_massconnect__connection-data_checkbox-group\">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\tid=\"mail_massconnect__imap-ssl\"\n\t\t\t\t\t\tclass=\"mail_massconnect__checkbox\"\n\t\t\t\t\t\tv-model=\"connectionSettings.imapSsl\"\n\t\t\t\t\t\tdata-test-id=\"mail_massconnect__connection-data_imap-ssl-checkbox\"\n\t\t\t\t\t/>\n\t\t\t\t\t<label for=\"mail_massconnect__imap-ssl\">\n\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_IMAP_SSL_INPUT_LABEL') }}\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div \n\t\t\t\tv-if=\"connectionSettings.smtpSettings.enabled\"\n\t\t\t\tclass=\"mail_massconnect__connection-block\"\n\t\t\t>\n\t\t\t\t<div class=\"mail_massconnect__input-group\" data-test-id=\"mail_massconnect__connection-data_smtp-group\">\n\t\t\t\t\t<BInput\n\t\t\t\t\t\tclass=\"mail_massconnect__input-group_main\"\n\t\t\t\t\t\t:label=\"loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_SMTP_INPUT_LABEL')\"\n\t\t\t\t\t\t:placeholder=\"loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_SMTP_INPUT_PLACEHOLDER')\"\n\t\t\t\t\t\t:size=\"InputSize.Lg\"\n\t\t\t\t\t\t:design=\"InputDesign.DEFAULT\"\n\t\t\t\t\t\tv-model=\"connectionSettings.smtpSettings.server\"\n\t\t\t\t\t\t:error=\"smtpServerError\"\n\t\t\t\t\t/>\n\t\t\t\t\t<BInput\n\t\t\t\t\t\tclass=\"mail_massconnect__input-group_port\"\n\t\t\t\t\t\t:label=\"loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_SMTP_PORTS_INPUT_LABEL')\"\n\t\t\t\t\t\t:placeholder=\"loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_SMTP_PORTS_INPUT_PLACEHOLDER')\"\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t:size=\"InputSize.Lg\"\n\t\t\t\t\t\t:design=\"InputDesign.DEFAULT\"\n\t\t\t\t\t\tv-model=\"connectionSettings.smtpSettings.port\"\n\t\t\t\t\t\t:error=\"smtpPortError\"\n\t\t\t\t\t\t@input=\"handleSmtpPortInput(connectionSettings.smtpSettings.port)\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mail_massconnect__connection-data_checkbox-group\">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\tid=\"mail_massconnect__smtp-ssl\"\n\t\t\t\t\t\tclass=\"mail_massconnect__checkbox\"\n\t\t\t\t\t\tv-model=\"connectionSettings.smtpSettings.ssl\"\n\t\t\t\t\t\tdata-test-id=\"mail_massconnect__connection-data_smtp-ssl-checkbox\"\n\t\t\t\t\t/>\n\t\t\t\t\t<label for=\"mail_massconnect__smtp-ssl\">\n\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_SMTP_SSL_INPUT_LABEL') }}\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import type { MassConnectDataType } from './store/type';\nimport { DepartmentEmployee, MailboxPayload } from './store/type';\n\nexport const Api = {\n\tconnectMailbox: async (mailbox: MailboxPayload, massConnectId: number): Promise<void> => {\n\t\treturn BX.ajax.runAction('mail.mailboxconnecting.connectMailboxFromMassconnect', {\n\t\t\tdata: { mailbox, massConnectId },\n\t\t});\n\t},\n\tsaveMailboxConnectionData: async (\n\t\tmassConnectData: MassConnectDataType,\n\t): Promise<{ status: string, data: { id: number }, errors: Array }> => {\n\t\treturn BX.ajax.runAction('mail.mailboxconnecting.saveMassConnectData', {\n\t\t\tdata: { massConnectData },\n\t\t});\n\t},\n\tgetDepartmentsUsers: async (\n\t\tdepartmentIds: number[],\n\t): Promise<{ status: string, data: DepartmentEmployee[], errors: Array }> => {\n\t\treturn BX.ajax.runAction('mail.mailboxconnecting.getDepartmentUsers', {\n\t\t\tdata: { departmentIds },\n\t\t});\n\t},\n};\n","import { Button as UiButton, AirButtonStyle } from 'ui.vue3.components.button';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport { mapActions } from 'ui.vue3.pinia';\nimport { useWizardStore } from '../../../../store/wizard.js';\nimport { LocalizationMixin } from '../../../../mixins/localization-mixin';\n\n// @vue/component\nexport const EmployeeListTable = {\n\tcomponents: {\n\t\tUiButton,\n\t\tBIcon,\n\t},\n\n\tmixins: [LocalizationMixin],\n\n\tprops: {\n\t\tisLoginColumnShown: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\t/** @type {Employee[]} */\n\t\temployees: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\treadonlyMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tdata(): Object {\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\toutline(): Outline\n\t\t{\n\t\t\treturn Outline;\n\t\t},\n\t},\n\n\tmethods: {\n\t\t...mapActions(useWizardStore, ['removeEmployeeById']),\n\t},\n\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"mail_massconnect__employee-list_table\" \n\t\t\t:class=\"{ '--login-hidden': !isLoginColumnShown }\"\n\t\t\tdata-test-id=\"mail_massconnect__employee-list_table\"\n\t\t>\n\t\t\t<div class=\"mail_massconnect__employee-list_table_header\">\n\t\t\t\t<div class=\"mail_massconnect__employee-list_table_cell --name\">\n\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_TABLE_NAME_COLUMN_TITLE') }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mail_massconnect__employee-list_table_cell --email\">\n\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_TABLE_EMAIL_COLUMN_TITLE') }}\n\t\t\t\t</div>\n\t\t\t\t<div \n\t\t\t\t\tv-if=\"isLoginColumnShown\" \n\t\t\t\t\tclass=\"mail_massconnect__employee-list_table_cell --login\"\n\t\t\t\t\tdata-test-id=\"mail_massconnect__employee-list_table_login-header\"\n\t\t\t\t>\n\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_TABLE_LOGIN_COLUMN_TITLE') }}\n\t\t\t\t</div>\n\t\t\t\t<div \n\t\t\t\t\tv-if=\"!readonlyMode\" \n\t\t\t\t\tclass=\"mail_massconnect__employee-list_table_cell --password\"\n\t\t\t\t\tdata-test-id=\"mail_massconnect__employee-list_table_password-header\"\n\t\t\t\t>\n\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_TABLE_PASSWORD_COLUMN_TITLE') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-for=\"(employee, index) in employees\"\n\t\t\t\t:key=\"employee.id\"\n\t\t\t\tclass=\"mail_massconnect__employee-list_table_row\"\n\t\t\t\t:data-test-id=\"'mail_massconnect__employee-list_table_row-' + index\"\n\t\t\t>\n\t\t\t\t<div class=\"mail_massconnect__employee-list_table_cell --name\">\n\t\t\t\t\t<div class=\"mail_massconnect__employee-list_table_employee-info\">\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tclass=\"mail_massconnect__employee-list_table_employee-avatar\"\n\t\t\t\t\t\t\t:src=\"encodeURI(employee.avatar)\"\n\t\t\t\t\t\t\talt=\"\"\n\t\t\t\t\t\t\t:data-test-id=\"'mail_massconnect__employee-list_table_row-' + index + '_avatar'\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span \n\t\t\t\t\t\t\tclass=\"mail_massconnect__employee-list_table_employee-name\"\n\t\t\t\t\t\t\t:data-test-id=\"'mail_massconnect__employee-list_table_row-' + index + '_name'\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ employee.name }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tclass=\"mail_massconnect__employee-list_table_delete-btn-container\"\n\t\t\t\t\t\t\t:data-test-id=\"'mail_massconnect__employee-list_table_row-' + index + '_delete-btn-container'\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<UiButton\n\t\t\t\t\t\t\t\tv-if=\"!readonlyMode\"\n\t\t\t\t\t\t\t\t:style=\"AirButtonStyle.OUTLINE\"\n\t\t\t\t\t\t\t\t:leftIcon=\"outline.CROSS_M\"\n\t\t\t\t\t\t\t\tclass=\"mail_massconnect__employee-list_table_delete-employee\"\n\t\t\t\t\t\t\t\t@click=\"removeEmployeeById(employee.id)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mail_massconnect__employee-list_table_cell --email\">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t\tclass=\"mail_massconnect__employee-list_table_input\"\n\t\t\t\t\t\tv-model=\"employee.email\"\n\t\t\t\t\t\t:placeholder=\"loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_TABLE_EMAIL_COLUMN_PLACEHOLDER')\"\n\t\t\t\t\t\t:readonly=\"readonlyMode\"\n\t\t\t\t\t\t:data-test-id=\"'mail_massconnect__employee-list_table_row-' + index + '_email-input'\"\n\t\t\t\t\t\t:name=\"'mail_massconnect__employee-list_table_row-' + index + '_email-input'\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mail_massconnect__employee-list_table_cell --login\">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tclass=\"mail_massconnect__employee-list_table_input\"\n\t\t\t\t\t\tv-model=\"employee.login\"\n\t\t\t\t\t\t:placeholder=\"loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_TABLE_LOGIN_COLUMN_PLACEHOLDER')\"\n\t\t\t\t\t\t:readonly=\"readonlyMode\"\n\t\t\t\t\t\t:data-test-id=\"'mail_massconnect__employee-list_table_row-' + index + '_login-input'\"\n\t\t\t\t\t\t:name=\"'mail_massconnect__employee-list_table_row-' + index + '_password-input'\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"!readonlyMode\" class=\"mail_massconnect__employee-list_table_cell --password\">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\tclass=\"mail_massconnect__employee-list_table_input\"\n\t\t\t\t\t\tv-model=\"employee.password\"\n\t\t\t\t\t\t:placeholder=\"loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_TABLE_PASSWORD_COLUMN_PLACEHOLDER')\"\n\t\t\t\t\t\t:data-test-id=\"'mail_massconnect__employee-list_table_row-' + index + '_password-input'\"\n\t\t\t\t\t\t:name=\"'mail_massconnect__employee-list_table_row-' + index + '_password-input'\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { UI } from 'ui.notification';\nimport { mapState, mapActions } from 'ui.vue3.pinia';\nimport { Dialog, Item } from 'ui.entity-selector';\nimport { Set, Outline, BIcon } from 'ui.icon-set.api.vue';\nimport { Button as UiButton, AirButtonStyle } from 'ui.vue3.components.button';\nimport { BMenu, type MenuOptions } from 'ui.vue3.components.menu';\nimport { SaveButton, CancelButton } from 'ui.buttons';\nimport { Loc } from 'main.core';\nimport { Api } from '../../../../api';\nimport { useWizardStore } from '../../../../store/wizard.js';\nimport { LocalizationMixin } from '../../../../mixins/localization-mixin';\nimport { EmployeeListTable } from './employee-list-table';\nimport type { Employee } from '../../../../store/type';\nimport { sendData as analyticsSendData } from 'ui.analytics';\nimport './select-employees.css';\n\n// @vue/component\nexport const SelectEmployees = {\n\tcomponents: {\n\t\tUiButton,\n\t\tBIcon,\n\t\tBMenu,\n\t\tEmployeeListTable,\n\t},\n\n\tmixins: [LocalizationMixin],\n\n\temits: ['update:validity'],\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t\tactionsMenuActive: false,\n\t\t\tshowAddedEmployees: false,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\t...mapState(\n\t\t\tuseWizardStore,\n\t\t\t[\n\t\t\t\t'employees',\n\t\t\t\t'errorState',\n\t\t\t\t'addedEmployees',\n\t\t\t\t'isLoginColumnShown',\n\t\t\t\t'analyticsSource',\n\t\t\t\t'permissions',\n\t\t\t],\n\t\t),\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\toutline(): Outline\n\t\t{\n\t\t\treturn Outline;\n\t\t},\n\t\tisEmployeeListEmpty(): boolean\n\t\t{\n\t\t\treturn this.employees.length === 0;\n\t\t},\n\t\tisValid(): boolean\n\t\t{\n\t\t\treturn !this.isEmployeeListEmpty;\n\t\t},\n\t\tmenuOptions(): MenuOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tbindElement: this.$refs.actionsMenuActiveRef,\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.isLoginColumnShown\n\t\t\t\t\t\t\t? this.loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_CARD_ACTIONS_LOGIN_HIDE')\n\t\t\t\t\t\t\t: this.loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_CARD_ACTIONS_LOGIN_SHOW'),\n\t\t\t\t\t\ticon: this.isLoginColumnShown ? this.set.CROSSED_EYE_2 : this.set.OPENED_EYE,\n\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\tthis.toggleLoginColumn();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_CARD_ACTIONS_DELETE_ALL'),\n\t\t\t\t\t\ticon: Outline.TRASHCAN,\n\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\tthis.actionsMenuActive = false;\n\t\t\t\t\t\t\tthis.clearEmployees();\n\t\t\t\t\t\t\tthis.employeeDialog.deselectAll();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t};\n\t\t},\n\t\tisFixingErrorsHintText(): string\n\t\t{\n\t\t\treturn Loc.getMessagePlural(\n\t\t\t\t'MAIL_MASSCONNECT_FORM_UTILITY_BLOCK_IS_FIXING_ERRORS_HINT',\n\t\t\t\tthis.errorState.errorCnt,\n\t\t\t\t{ '#ERROR_CNT#': this.errorState.errorCnt },\n\t\t\t);\n\t\t},\n\t\thelpDescLink(): ?string\n\t\t{\n\t\t\t// ToDo: make a link when help article is ready\n\t\t\treturn null;\n\t\t},\n\t},\n\n\twatch: {\n\t\tisValid: {\n\t\t\thandler(isValid)\n\t\t\t{\n\t\t\t\tthis.$emit('update:validity', isValid);\n\t\t\t},\n\t\t\timmediate: true,\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.employeeDialog = this.getEmployeeDialog();\n\t},\n\n\tmethods: {\n\t\t...mapActions(\n\t\t\tuseWizardStore,\n\t\t\t[\n\t\t\t\t'setEmployees',\n\t\t\t\t'toggleLoginColumn',\n\t\t\t\t'addEmployee',\n\t\t\t\t'clearEmployees',\n\t\t\t],\n\t\t),\n\t\tonStepComplete(): void\n\t\t{\n\t\t\tanalyticsSendData({\n\t\t\t\ttool: 'mail',\n\t\t\t\tevent: 'mailbox_mass_step2',\n\t\t\t\tcategory: 'mail_mass_ops',\n\t\t\t\tc_section: this.analyticsSource,\n\t\t\t});\n\t\t},\n\t\tgetEmployeeDialog(): Dialog\n\t\t{\n\t\t\tconst applyButton = new SaveButton({\n\t\t\t\tuseAirDesign: true,\n\t\t\t\ttext: this.loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_CARD_DIALOG_ADD_BUTTON_TEXT'),\n\t\t\t\tonclick: async (button) => {\n\t\t\t\t\tbutton.setWaiting(true);\n\t\t\t\t\tawait this.handleSaveItems(this.employeeDialog.getSelectedItems());\n\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst cancelButton = new CancelButton({\n\t\t\t\tuseAirDesign: true,\n\t\t\t\tstyle: AirButtonStyle.OUTLINE,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.employeeDialog.hide();\n\t\t\t\t},\n\t\t\t});\n\n\t\t\treturn new Dialog({\n\t\t\t\twidth: 420,\n\t\t\t\theight: 400,\n\t\t\t\tmultiple: true,\n\t\t\t\tshowAvatars: true,\n\t\t\t\tenableSearch: true,\n\t\t\t\tcontext: 'MAIL_MASSCONNECT_EMPLOYEES',\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'structure-node',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselectMode: 'usersAndDepartments',\n\t\t\t\t\t\t\tforSearch: true,\n\t\t\t\t\t\t\tallowSelectRootDepartment: true,\n\t\t\t\t\t\t\trestricted: 'view',\n\t\t\t\t\t\t\tallowedPermissionLevels: this.permissions.allowedLevels,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\tonDestroy: () => {\n\t\t\t\t\t\tthis.employeeDialog = this.getEmployeeDialog();\n\t\t\t\t\t},\n\t\t\t\t},\n\n\t\t\t\tfooter: [applyButton.render(), cancelButton.render()],\n\t\t\t\tfooterOptions: {\n\t\t\t\t\tcontainerStyles: {\n\t\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t\t'justify-content': 'center',\n\t\t\t\t\t\tgap: '12px',\n\t\t\t\t\t\t'background-color': 'var(--ui-color-palette-white-base)',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\topenEmployeeSelector(): void\n\t\t{\n\t\t\tconst targetNode = this.$refs.addButton.button.getContainer();\n\t\t\tthis.employeeDialog.setTargetNode(targetNode);\n\n\t\t\tif (!this.employeeDialog.isOpen())\n\t\t\t{\n\t\t\t\tthis.employeeDialog.setPreselectedItems(\n\t\t\t\t\tthis.employees.map((employee) => ['user', employee.id]),\n\t\t\t\t);\n\n\t\t\t\tthis.employeeDialog.show();\n\t\t\t}\n\t\t},\n\t\tasync handleSaveItems(items: Item[])\n\t\t{\n\t\t\tconst selectedUsers = [];\n\t\t\tconst departmentsToCheck = [];\n\n\t\t\titems.forEach((item) => {\n\t\t\t\tif (item.entityId === 'user')\n\t\t\t\t{\n\t\t\t\t\tselectedUsers.push({\n\t\t\t\t\t\tid: item.getId(),\n\t\t\t\t\t\tentityId: 'user',\n\t\t\t\t\t\tname: item.getTitle(),\n\t\t\t\t\t\tavatar: item.getAvatar(),\n\t\t\t\t\t\temail: '',\n\t\t\t\t\t\tlogin: '',\n\t\t\t\t\t\tpassword: '',\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse if (item.entityId === 'structure-node')\n\t\t\t\t{\n\t\t\t\t\tdepartmentsToCheck.push(item.id);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tlet departmentUsers = [];\n\t\t\ttry\n\t\t\t{\n\t\t\t\tif (departmentsToCheck.length > 0)\n\t\t\t\t{\n\t\t\t\t\tconst rawDepartmentUsers = await Api.getDepartmentsUsers(departmentsToCheck);\n\t\t\t\t\tdepartmentUsers = rawDepartmentUsers.data?.map((user): Employee => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: user.id,\n\t\t\t\t\t\t\tentityId: 'user',\n\t\t\t\t\t\t\tname: user.name,\n\t\t\t\t\t\t\tavatar: (user.avatar === null || user.avatar === '')\n\t\t\t\t\t\t\t\t? this.employeeDialog.getEntity('user').getItemOption('avatar', 'user')\n\t\t\t\t\t\t\t\t: user.avatar,\n\t\t\t\t\t\t\temail: '',\n\t\t\t\t\t\t\tlogin: '',\n\t\t\t\t\t\t\tpassword: '',\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_CARD_SELECTOR_ADD_ERROR'),\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t[...selectedUsers, ...departmentUsers].forEach((employee) => this.addEmployee(employee));\n\t\t\tthis.employeeDialog.deselectAll();\n\t\t\tthis.employeeDialog.hide();\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"mail_massconnect__select-employees_form\">\n\t\t\t<div class=\"mail_massconnect__employee-list_header\">\n\t\t\t\t<div class=\"mail_massconnect__section-title_container\">\n\t\t\t\t\t<span class=\"mail_massconnect__section-title\">\n\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_CARD_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span v-if=\"!errorState.enabled\" class=\"mail_massconnect__section-description\">\n\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_CARD_DESCRIPTION') }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div \n\t\t\t\t\tv-show=\"!errorState.enabled\" \n\t\t\t\t\tclass=\"mail_massconnect__employee-list_header_buttons\"\n\t\t\t\t\tdata-test-id=\"mail_massconnect__employee-list_header_buttons\"\n\t\t\t\t>\n\t\t\t\t\t<UiButton\n\t\t\t\t\t\tref=\"addButton\"\n\t\t\t\t\t\t:text=\"loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_CARD_ADD_BUTTON_TITLE')\"\n\t\t\t\t\t\t:leftIcon=\"set.PLUS_IN_CIRCLE\"\n\t\t\t\t\t\t:style=\"AirButtonStyle.TINTED\"\n\t\t\t\t\t\t@click=\"openEmployeeSelector\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div v-show=\"!isEmployeeListEmpty\" class=\"mail_massconnect__employee-list_container\">\n\t\t\t\t<div \n\t\t\t\t\tv-if=\"errorState.enabled\" \n\t\t\t\t\tclass=\"mail_massconnect__fixing-errors-hint_container\"\n\t\t\t\t\tdata-test-id=\"mail_massconnect__fixing-errors-hint_container\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"mail_massconnect__fixing-errors-hint_image\"/>\n\t\t\t\t\t<div class=\"mail_massconnect__fixing-errors-hint_text\">\n\t\t\t\t\t\t{{ isFixingErrorsHintText }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"helpDescLink\" class=\"mail_massconnect__fixing-errors-hint_link\">\n\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_UTILITY_BLOCK_IS_FIXING_ERRORS_LINK') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div \n\t\t\t\t\tv-else \n\t\t\t\t\tclass=\"mail_massconnect__utility-block_container\"\n\t\t\t\t\tdata-test-id=\"mail_massconnect__utility-block_container\"\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"mail_massconnect__employee-list_info_actions\"\n\t\t\t\t\t\t@click=\"actionsMenuActive = true\"\n\t\t\t\t\t\tref=\"actionsMenuActiveRef\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_CARD_ACTIONS_TITLE') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mail_massconnect__employee-list_info_actions-icon\">\n\t\t\t\t\t\t<BIcon :name=\"outline.CHEVRON_DOWN_L\"\n\t\t\t\t\t\t\t@click=\"actionsMenuActive = true\"\n\t\t\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t\t\tcolor=\"var(--ui-color-palette-gray-50)\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</BIcon>\n\t\t\t\t\t</div>\n\t\t\t\t\t<BMenu v-if=\"actionsMenuActive\" :options=\"menuOptions\" @close=\"actionsMenuActive = false\"/>\n\t\t\t\t</div>\n\t\t\t\t<EmployeeListTable\n\t\t\t\t\t:isLoginColumnShown=\"isLoginColumnShown\"\n\t\t\t\t\t:employees=\"employees\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\tv-if=\"addedEmployees.length > 0\" \n\t\t\t\tclass=\"mail_massconnect__employee-list_added-employees_container\"\n\t\t\t\tdata-test-id=\"mail_massconnect__employee-list_added-employees_container\"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"mail_massconnect__employee-list_added-employees_show-button\"\n\t\t\t\t\tdata-test-id=\"mail_massconnect__employee-list_added-employees_show-button\"\n\t\t\t\t\t@click=\"showAddedEmployees = !showAddedEmployees\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"mail_massconnect__employee-list_added-employees_show-button-text\">\n\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_EMPLOYEE_CARD_SHOW_ADDED_TITLE') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mail_massconnect__employee-list_added-employees_show-button-icon\">\n\t\t\t\t\t\t<BIcon :name=\"outline.CHEVRON_DOWN_L\"\n\t\t\t\t\t\t\t@click=\"actionsMenuActive = true\"\n\t\t\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t\t\tcolor=\"var(--ui-color-palette-gray-50)\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</BIcon>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<EmployeeListTable\n\t\t\t\t\tv-if=\"showAddedEmployees\"\n\t\t\t\t\t:isLoginColumnShown=\"isLoginColumnShown\"\n\t\t\t\t\t:employees=\"addedEmployees\"\n\t\t\t\t\t:readonlyMode=\"true\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\n\nexport const PrepareOptionsPhrasesMixin = {\n\tmethods: {\n\t\tprepareOptionPhrases(options: Array<{labelKey: string, value: string}>): Array<{label: string, value: string}>\n\t\t{\n\t\t\treturn options.map((option) => {\n\t\t\t\treturn {\n\t\t\t\t\tlabel: Loc.getMessage(option.labelKey),\n\t\t\t\t\tvalue: option.value,\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t},\n};\n","export const PreparedIndirectPhraseMixin = {\n\tmethods: {\n\t\tpreparedIndirectPhrase(phraseCode: string, indirectCode: string): { beforeText: ?string, afterText: ?string }\n\t\t{\n\t\t\tconst phrase = this.$Bitrix.Loc.getMessage(phraseCode);\n\t\t\tconst parts = phrase.split(indirectCode);\n\n\t\t\treturn {\n\t\t\t\tbeforeText: parts[0] || null,\n\t\t\t\tafterText: parts[1] || null,\n\t\t\t};\n\t\t},\n\t},\n};\n","import { SettingSelector } from 'mail.setting-selector';\n\n// @vue/component\nexport const BitrixSettingSelector = {\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t\toptions: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tdialogOptions: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\temits: ['update:modelValue'],\n\n\tselectorInstance: null,\n\titemOnSelectHandler: null,\n\n\twatch: {\n\t\tmodelValue(newValue: string): void\n\t\t{\n\t\t\tif (this.selectorInstance && newValue !== this.selectorInstance.getSelected())\n\t\t\t{\n\t\t\t\tthis.selectorInstance.select(newValue);\n\t\t\t}\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tconst settingsMap = new Map();\n\t\tthis.options.forEach((option) => {\n\t\t\tsettingsMap.set(option.value, option.label);\n\t\t});\n\n\t\tconst settingSelectorOptions = {\n\t\t\tsettingsMap: Object.fromEntries(settingsMap),\n\t\t\tselectedOptionKey: this.modelValue,\n\t\t};\n\n\t\tif (this.dialogOptions)\n\t\t{\n\t\t\tsettingSelectorOptions.dialogOptions = this.dialogOptions;\n\t\t}\n\n\t\tthis.selectorInstance = new SettingSelector(settingSelectorOptions);\n\n\t\tthis.itemOnSelectHandler = (event) => {\n\t\t\tconst { item: selectedItem } = event.getData();\n\t\t\tthis.$emit('update:modelValue', selectedItem.getId());\n\t\t};\n\n\t\tif (this.selectorInstance.settingDialog)\n\t\t{\n\t\t\tthis.selectorInstance.settingDialog.subscribe('Item:onSelect', this.itemOnSelectHandler);\n\t\t}\n\n\t\tthis.selectorInstance.renderTo(this.$el);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tif (this.selectorInstance.settingDialog)\n\t\t{\n\t\t\tthis.selectorInstance.settingDialog.unsubscribe('Item:onSelect', this.itemOnSelectHandler);\n\t\t}\n\n\t\tif (this.selectorInstance && this.selectorInstance.settingDialog)\n\t\t{\n\t\t\tthis.selectorInstance.settingDialog.destroy();\n\t\t}\n\t},\n\ttemplate: '<div></div>',\n};\n","import { MailSyncPeriod } from './enum/period';\n\nexport const MailIntegrationOptions = {\n\tsyncPeriodOptions: [\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_MAIL_INTEGRATION_OPTION_SYNC_PERIOD_DAY',\n\t\t\tvalue: MailSyncPeriod.DAY,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_MAIL_INTEGRATION_OPTION_SYNC_PERIOD_WEEK',\n\t\t\tvalue: MailSyncPeriod.WEEK,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_MAIL_INTEGRATION_OPTION_SYNC_PERIOD_MONTH',\n\t\t\tvalue: MailSyncPeriod.MONTH,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_MAIL_INTEGRATION_OPTION_SYNC_PERIOD_TWO_MONTHS',\n\t\t\tvalue: MailSyncPeriod.TWO_MONTHS,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_MAIL_INTEGRATION_OPTION_SYNC_PERIOD_THREE_MONTHS',\n\t\t\tvalue: MailSyncPeriod.THREE_MONTHS,\n\t\t},\n\t],\n};\n","import { PrepareOptionsPhrasesMixin } from '../../mixins/prepare-options-phrases-mixin';\nimport { LocalizationMixin } from '../../mixins/localization-mixin';\nimport { PreparedIndirectPhraseMixin } from '../../mixins/prepared-indirect-phrase-mixin';\nimport { MailIntegrationSettingsType } from '../../utils/mail-integration-settings-type';\nimport { BitrixSettingSelector } from '../tools/bitrix-setting-selector';\nimport { MailIntegrationOptions } from '../../utils/options/mail-integration-options/component-options';\nimport './integrations.css';\n\n// @vue/component\nexport const MailIntegration = {\n\tname: 'mail-integration',\n\n\tcomponents: {\n\t\tBitrixSettingSelector,\n\t},\n\n\tmixins: [LocalizationMixin, PrepareOptionsPhrasesMixin, PreparedIndirectPhraseMixin],\n\n\tprops: {\n\t\t/** @type MailIntegrationSettingsType */\n\t\tmodelValue: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: [\n\t\t'update:modelValue',\n\t],\n\n\tcomputed: {\n\t\tlocalModelValue: {\n\t\t\tget(): MailIntegrationSettingsType\n\t\t\t{\n\t\t\t\treturn this.modelValue;\n\t\t\t},\n\t\t\tset(newValue): void\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', newValue);\n\t\t\t},\n\t\t},\n\t\tsyncLabel(): { beforeText: ?string, afterText: ?string }\n\t\t{\n\t\t\treturn this.preparedIndirectPhrase('MAIL_MASSCONNECT_FORM_SELECT_MAILBOX_SETTINGS_MAIL_SYNC_LABEL', '#PERIOD#');\n\t\t},\n\t\tsyncPeriodOptions(): Object\n\t\t{\n\t\t\treturn this.prepareOptionPhrases(MailIntegrationOptions.syncPeriodOptions);\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"mail_massconnect__integration-block\">\n\t\t\t<div class=\"mail_massconnect__integration-block_header\">\n\t\t\t\t<div class=\"mail_massconnect__integration-block_title_group\">\n\t\t\t\t\t<div class=\"mail_massconnect__integration-block_icon --mail\"></div>\n\t\t\t\t\t<span class=\"mail_massconnect__integration-block_title\">\n\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_INTEGRATION_MAIL_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"mail_massconnect__integration-block_content-wrapper\">\n\t\t\t\t<div class=\"mail_massconnect__integration-block_content\">\n\t\t\t\t\t<div class=\"mail_massconnect__checkbox-group\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\tid=\"mail_massconnect__mail-sync\"\n\t\t\t\t\t\t\tv-model=\"localModelValue.sync.enabled\"\n\t\t\t\t\t\t\tdata-test-id=\"mail_massconnect__mail-sync_checkbox\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tclass=\"mail_massconnect__indirect-label\" \n\t\t\t\t\t\t\tdata-test-id=\"mail_massconnect__mail-sync_label\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<label for=\"mail_massconnect__mail-sync\">\n\t\t\t\t\t\t\t\t<span class=\"mail_massconnect__label-text_before\">\n\t\t\t\t\t\t\t\t\t{{ syncLabel.beforeText }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<BitrixSettingSelector\n\t\t\t\t\t\t\t\tv-model=\"localModelValue.sync.periodValue\"\n\t\t\t\t\t\t\t\t:options=\"syncPeriodOptions\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<label for=\"mail_massconnect__mail-sync\">\n\t\t\t\t\t\t\t\t<span class=\"mail_massconnect__label-text_after\">\n\t\t\t\t\t\t\t\t\t{{ syncLabel.afterText }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { TagSelector } from 'ui.entity-selector';\n\n// @vue/component\nexport const UserSelector = {\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\t},\n\n\temits: ['update:modelValue'],\n\n\tselectorInstance: null,\n\ttargetNode: null,\n\n\twatch: {\n\t\tmodelValue(newValue: Array): void\n\t\t{\n\t\t\tif (!this.selectorInstance)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst newItemsSet = new Set(newValue.map((item) => `${item.entityId}:${item.id}`));\n\t\t\tconst currentTags = this.selectorInstance.getTags();\n\t\t\tconst currentTagsSet = new Set(currentTags.map((tag) => `${tag.getEntityId()}:${tag.getId()}`));\n\n\t\t\tcurrentTags.forEach((tag) => {\n\t\t\t\tconst tagId = `${tag.getEntityId()}:${tag.getId()}`;\n\t\t\t\tif (!newItemsSet.has(tagId))\n\t\t\t\t{\n\t\t\t\t\tthis.selectorInstance.removeTag(tag);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tnewValue.forEach((item) => {\n\t\t\t\tconst itemId = `${item.entityId}:${item.id}`;\n\t\t\t\tif (!currentTagsSet.has(itemId))\n\t\t\t\t{\n\t\t\t\t\tthis.selectorInstance.addTag({\n\t\t\t\t\t\tid: item.id,\n\t\t\t\t\t\tentityId: item.entityId,\n\t\t\t\t\t\ttitle: item.name,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.selectorInstance = new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\twidth: 425,\n\t\t\t\theight: 320,\n\t\t\t\tmultiple: true,\n\t\t\t\tcontext: 'MAIL_CRM_QUEUE',\n\t\t\t\tpreselectedItems: this.modelValue.map((item) => [item.entityId, item.id]),\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\t\t\temailUsers: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'department',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselectMode: 'departmentsOnly',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonAfterTagAdd: this.onUpdate,\n\t\t\t\tonAfterTagRemove: this.onUpdate,\n\t\t\t},\n\t\t});\n\n\t\tthis.selectorInstance.renderTo(this.$el);\n\t},\n\n\tbeforeUnmount(): void\n\t{\n\t\tconst dialog = this.selectorInstance.getDialog();\n\n\t\tif (dialog)\n\t\t{\n\t\t\tdialog.destroy();\n\t\t}\n\t},\n\n\tmethods: {\n\t\tonUpdate(): void\n\t\t{\n\t\t\tconst selectedItems = this.selectorInstance.getTags().map((tag) => ({\n\t\t\t\tid: tag.getId(),\n\t\t\t\tentityId: tag.getEntityId(),\n\t\t\t\tname: tag.getTitle(),\n\t\t\t}));\n\n\t\t\tthis.$emit('update:modelValue', selectedItems);\n\t\t},\n\t},\n\ttemplate: '<div></div>',\n};\n","import { CrmSyncPeriod } from './enum/period';\nimport { CrmCreateAction } from './enum/create-action';\nimport { CrmSource } from './enum/source';\n\nexport const CrmIntegrationOptions = {\n\tsyncPeriodOptions: [\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SYNC_PERIOD_WEEK',\n\t\t\tvalue: CrmSyncPeriod.WEEK,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SYNC_PERIOD_MONTH',\n\t\t\tvalue: CrmSyncPeriod.MONTH,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SYNC_PERIOD_ALL_TIME',\n\t\t\tvalue: CrmSyncPeriod.ALL_TIME,\n\t\t},\n\t],\n\n\tcreateActionOptions: [\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_CREATE_ACTION_LEAD',\n\t\t\tvalue: CrmCreateAction.LEAD,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_CREATE_ACTION_CONTACT',\n\t\t\tvalue: CrmCreateAction.CONTACT,\n\t\t},\n\t],\n\n\tsourceOptions: [\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SOURCE_CALL',\n\t\t\tvalue: CrmSource.CALL,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SOURCE_EMAIL',\n\t\t\tvalue: CrmSource.EMAIL,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SOURCE_WEB',\n\t\t\tvalue: CrmSource.WEB,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SOURCE_ADVERTISING',\n\t\t\tvalue: CrmSource.ADVERTISING,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SOURCE_PARTNER',\n\t\t\tvalue: CrmSource.PARTNER,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SOURCE_RECOMMENDATION',\n\t\t\tvalue: CrmSource.RECOMMENDATION,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SOURCE_TRADE_SHOW',\n\t\t\tvalue: CrmSource.TRADE_SHOW,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SOURCE_WEBFORM',\n\t\t\tvalue: CrmSource.WEBFORM,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SOURCE_CALLBACK',\n\t\t\tvalue: CrmSource.CALLBACK,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SOURCE_RC_GENERATOR',\n\t\t\tvalue: CrmSource.RC_GENERATOR,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SOURCE_STORE',\n\t\t\tvalue: CrmSource.STORE,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SOURCE_OTHER',\n\t\t\tvalue: CrmSource.OTHER,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SOURCE_BOOKING',\n\t\t\tvalue: CrmSource.BOOKING,\n\t\t},\n\t\t{\n\t\t\tlabelKey: 'MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CRM_INTEGRATION_OPTION_SOURCE_REPEAT_SALE',\n\t\t\tvalue: CrmSource.REPEAT_SALE,\n\t\t},\n\t],\n\n\tcrmLeadSourceDialogOptions: {\n\t\twidth: 300,\n\t\theight: 300,\n\t\tenableSearch: true,\n\t},\n};\n","import { Switcher } from 'ui.vue3.components.switcher';\nimport { SwitcherSize } from 'ui.switcher';\nimport { hint, type HintParams } from 'ui.vue3.directives.hint';\nimport { CrmIntegrationSettingsType } from '../../utils/crm-integration-settings-type';\nimport { BitrixSettingSelector } from '../tools/bitrix-setting-selector';\nimport { UserSelector } from '../tools/user-selector';\nimport { CrmIntegrationOptions } from '../../utils/options/crm-integration-options/component-options';\nimport { LocalizationMixin } from '../../mixins/localization-mixin';\nimport { PreparedIndirectPhraseMixin } from '../../mixins/prepared-indirect-phrase-mixin';\nimport { PrepareOptionsPhrasesMixin } from '../../mixins/prepare-options-phrases-mixin';\nimport './integrations.css';\n\n// @vue/component\nexport const CrmIntegration = {\n\tname: 'crm-integration',\n\n\tdirectives: { hint },\n\n\tcomponents: {\n\t\tSwitcher,\n\t\tBitrixSettingSelector,\n\t\tUserSelector,\n\t},\n\n\tmixins: [LocalizationMixin, PrepareOptionsPhrasesMixin, PreparedIndirectPhraseMixin],\n\n\tprops: {\n\t\t/** @type CrmIntegrationSettingsType */\n\t\tmodelValue: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcanEditCrmIntegration: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\temits: [\n\t\t'update:modelValue',\n\t],\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tshowAddressTextarea: false,\n\t\t\tcrmLeadSourceDialogOptions: CrmIntegrationOptions.crmLeadSourceDialogOptions,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tlocalModelValue: {\n\t\t\tget(): CrmIntegrationSettingsType\n\t\t\t{\n\t\t\t\treturn this.modelValue;\n\t\t\t},\n\t\t\tset(newValue): void\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', newValue);\n\t\t\t},\n\t\t},\n\t\tsyncLabel(): { beforeText: ?string, afterText: ?string }\n\t\t{\n\t\t\treturn this.preparedIndirectPhrase('MAIL_MASSCONNECT_FORM_SELECT_MAILBOX_SETTINGS_CRM_SYNC_LABEL', '#PERIOD#');\n\t\t},\n\t\tincomingLabel(): { beforeText: ?string, afterText: ?string }\n\t\t{\n\t\t\treturn this.preparedIndirectPhrase('MAIL_MASSCONNECT_FORM_SELECT_MAILBOX_SETTINGS_CRM_INCOMING_LABEL', '#INCOMING#');\n\t\t},\n\t\toutgoingLabel(): { beforeText: ?string, afterText: ?string }\n\t\t{\n\t\t\treturn this.preparedIndirectPhrase('MAIL_MASSCONNECT_FORM_SELECT_MAILBOX_SETTINGS_CRM_OUTGOING_LABEL', '#OUTGOING#');\n\t\t},\n\t\tleadSourceIncomingLabel(): { beforeText: ?string, afterText: ?string }\n\t\t{\n\t\t\treturn this.preparedIndirectPhrase('MAIL_MASSCONNECT_FORM_SELECT_MAILBOX_SETTINGS_CRM_SOURCE_INCOMING_CURRENT_LABEL', '#INCOMING_CURRENT#');\n\t\t},\n\t\tsyncPeriodOptions(): Object\n\t\t{\n\t\t\treturn this.prepareOptionPhrases(CrmIntegrationOptions.syncPeriodOptions);\n\t\t},\n\t\tcreateActionOptions(): Object\n\t\t{\n\t\t\treturn this.prepareOptionPhrases(CrmIntegrationOptions.createActionOptions);\n\t\t},\n\t\tsourceOptions(): Object\n\t\t{\n\t\t\treturn this.prepareOptionPhrases(CrmIntegrationOptions.sourceOptions);\n\t\t},\n\t\tswitcherOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tsize: SwitcherSize.large,\n\t\t\t\tshowStateTitle: false,\n\t\t\t\tuseAirDesign: true,\n\t\t\t};\n\t\t},\n\t\tnoAccessHintParams(): HintParams\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.loc('MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_INTEGRATION_CRM_NO_ACCESS_HINT'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tclassName: 'mail_massconnect-hint',\n\t\t\t\t\tdarkMode: false,\n\t\t\t\t\toffsetTop: 2,\n\t\t\t\t\tbackground: 'var(--ui-color-bg-content-inapp)',\n\t\t\t\t\tpadding: 6,\n\t\t\t\t\tangle: true,\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t\toffsetLeft: 20,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\n\tmethods: {\n\t\thandleSwitcherClick(): void\n\t\t{\n\t\t\tif (this.canEditCrmIntegration)\n\t\t\t{\n\t\t\t\tthis.localModelValue.enabled = !this.localModelValue.enabled;\n\t\t\t}\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"mail_massconnect__integration-block\" :class=\"{ '--disabled': !localModelValue.enabled }\">\n\t\t\t<div \n\t\t\t\tclass=\"mail_massconnect__integration-block_header\"\n\t\t\t\tdata-test-id=\"mail_massconnect__settings_crmr-integration_header\"\n\t\t\t>\n\t\t\t\t<div class=\"mail_massconnect__integration-block_title_group\">\n\t\t\t\t\t<div class=\"mail_massconnect__integration-block_icon --crm\"></div>\n\t\t\t\t\t<span class=\"mail_massconnect__integration-block_title\">\n\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_INTEGRATION_CRM_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mail_massconnect__integration-block_switcher-container\" >\n\t\t\t\t\t<Switcher\n\t\t\t\t\t\t:isChecked=\"localModelValue.enabled\"\n\t\t\t\t\t\t:isDisabled=\"!canEditCrmIntegration\"\n\t\t\t\t\t\t:options=\"switcherOptions\"\n\t\t\t\t\t\tv-hint=\"!canEditCrmIntegration ? noAccessHintParams : undefined\"\n\t\t\t\t\t\t@click=\"handleSwitcherClick\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<transition name=\"mail_massconnect__integration-block_slide-down\">\n\t\t\t\t<div v-if=\"localModelValue.enabled\" class=\"mail_massconnect__integration-block_content-wrapper\">\n\t\t\t\t\t<div class=\"mail_massconnect__integration-block_content\">\n\t\t\t\t\t\t<div class=\"mail_massconnect__checkbox-group\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\tid=\"mail_massconnect__crm-sync\"\n\t\t\t\t\t\t\t\tv-model=\"localModelValue.sync.enabled\"\n\t\t\t\t\t\t\t\tdata-test-id=\"mail_massconnect__settings_crm-integration_crm-sync_checkbox\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tclass=\"mail_massconnect__indirect-label\"\n\t\t\t\t\t\t\t\tdata-test-id=\"mail_massconnect__settings_crm-integration_crm-sync_label\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<label for=\"mail_massconnect__crm-sync\">\n\t\t\t\t\t\t\t\t\t<span class=\"mail_massconnect__label-text_before\">\n\t\t\t\t\t\t\t\t\t\t{{ syncLabel.beforeText }}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<BitrixSettingSelector\n\t\t\t\t\t\t\t\t\tv-model=\"localModelValue.sync.periodValue\"\n\t\t\t\t\t\t\t\t\t:options=\"syncPeriodOptions\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<label for=\"mail_massconnect__crm-sync\">\n\t\t\t\t\t\t\t\t\t<span class=\"mail_massconnect__label-text_after\">\n\t\t\t\t\t\t\t\t\t\t{{ syncLabel.afterText }}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"mail_massconnect__integration-hint\">\n\t\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_MAILBOX_SETTINGS_CRM_SYNC_HINT') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"mail_massconnect__checkbox-group\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\tid=\"mail_massconnect__assign-known\"\n\t\t\t\t\t\t\t\tv-model=\"localModelValue.assignKnownClientEmails\"\n\t\t\t\t\t\t\t\tdata-test-id=\"mail_massconnect__settings_crm-integration_assign-known_checkbox\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<label for=\"mail_massconnect__assign-known\">\n\t\t\t\t\t\t\t\t<span class=\"mail_massconnect__label-text\">\n\t\t\t\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_MAILBOX_SETTINGS_CRM_ASSIGN_KNOWN_LABEL') }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"mail_massconnect__checkbox-group\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\tid=\"mail_massconnect__incoming-new\"\n\t\t\t\t\t\t\t\tv-model=\"localModelValue.incoming.enabled\"\n\t\t\t\t\t\t\t\tdata-test-id=\"mail_massconnect__settings_crm-integration_incoming-new_checkbox\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tclass=\"mail_massconnect__indirect-label\"\n\t\t\t\t\t\t\t\tdata-test-id=\"mail_massconnect__settings_crm-integration_incoming-new_label\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<label for=\"mail_massconnect__incoming-new\">\n\t\t\t\t\t\t\t\t\t<span class=\"mail_massconnect__label-text_before\">\n\t\t\t\t\t\t\t\t\t\t{{ incomingLabel.beforeText }}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<BitrixSettingSelector\n\t\t\t\t\t\t\t\t\tv-model=\"localModelValue.incoming.createAction\"\n\t\t\t\t\t\t\t\t\t:options=\"createActionOptions\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<label for=\"mail_massconnect__incoming-new\">\n\t\t\t\t\t\t\t\t\t<span class=\"mail_massconnect__label-text_after\">\n\t\t\t\t\t\t\t\t\t\t{{ incomingLabel.afterText }}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"mail_massconnect__integration-hint\">\n\t\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_MAILBOX_SETTINGS_CRM_INCOMING_HINT') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"mail_massconnect__checkbox-group\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\tid=\"mail_massconnect__outgoing-new\"\n\t\t\t\t\t\t\t\tv-model=\"localModelValue.outgoing.enabled\"\n\t\t\t\t\t\t\t\tdata-test-id=\"mail_massconnect__settings_crm-integration_outgoing-new_checkbox\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tclass=\"mail_massconnect__indirect-label\"\n\t\t\t\t\t\t\t\tdata-test-id=\"mail_massconnect__settings_crm-integration_outgoing-new_label\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<label for=\"mail_massconnect__outgoing-new\">\n\t\t\t\t\t\t\t\t\t<span class=\"mail_massconnect__label-text_before\">\n\t\t\t\t\t\t\t\t\t\t{{ outgoingLabel.beforeText }}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<BitrixSettingSelector\n\t\t\t\t\t\t\t\t\tv-model=\"localModelValue.outgoing.createAction\"\n\t\t\t\t\t\t\t\t\t:options=\"createActionOptions\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<label for=\"mail_massconnect__outgoing-new\">\n\t\t\t\t\t\t\t\t\t<span class=\"mail_massconnect__label-text_after\">\n\t\t\t\t\t\t\t\t\t\t{{ outgoingLabel.afterText }}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"mail_massconnect__integration-hint\">\n\t\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_MAILBOX_SETTINGS_CRM_OUTGOING_HINT') }}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tclass=\"mail_massconnect__group-inline\"\n\t\t\t\t\t\t\tdata-test-id=\"mail_massconnect__settings_source_group\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span class=\"mail_massconnect__group-inline_label\">\n\t\t\t\t\t\t\t\t<span class=\"mail_massconnect__label-text\">\n\t\t\t\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_MAILBOX_SETTINGS_CRM_SOURCE_LABEL') }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<BitrixSettingSelector\n\t\t\t\t\t\t\t\tv-model=\"localModelValue.source\"\n\t\t\t\t\t\t\t\t:options=\"sourceOptions\"\n\t\t\t\t\t\t\t\t:dialog-options=\"crmLeadSourceDialogOptions\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<span class=\"mail_massconnect__group-inline_label\">\n\t\t\t\t\t\t\t<span class=\"mail_massconnect__label-text_before\">\n\t\t\t\t\t\t\t\t{{ leadSourceIncomingLabel.beforeText }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\thref=\"#\"\n\t\t\t\t\t\t\t\tclass=\"mail_massconnect__set-textarea-show\"\n\t\t\t\t\t\t\t\t@click.prevent=\"showAddressTextarea = !showAddressTextarea\"\n\t\t\t\t\t\t\t\tdata-test-id=\"mail_massconnect__settings_show-address-textarea_link\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span class=\"mail_massconnect__set-textarea-show_text\">\n\t\t\t\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_MAILBOX_SETTINGS_CRM_SOURCE_INCOMING_CURRENT_BUTTON_LABEL') }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass=\"ui-icon-set --chevron-down\"\n\t\t\t\t\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 16px; --ui-icon-set__icon-color: #6a737f;\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<span class=\"mail_massconnect__label-text_after\">\n\t\t\t\t\t\t\t\t{{ leadSourceIncomingLabel.afterText }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tv-if=\"showAddressTextarea\"\n\t\t\t\t\t\t\tv-model=\"localModelValue.leadCreationAddresses\"\n\t\t\t\t\t\t\tclass=\"mail_massconnect__control-textarea\"\n\t\t\t\t\t\t\t:placeholder=\"loc('MAIL_MASSCONNECT_FORM_SELECT_MAILBOX_SETTINGS_CRM_SOURCE_INCOMING_CURRENT_PLACEHOLDER')\"\n\t\t\t\t\t\t\tdata-test-id=\"mail_massconnect__settings_address-textarea\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</textarea>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mail_massconnect__integration-block_content\">\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tclass=\"mail_massconnect__user-selector-group\"\n\t\t\t\t\t\t\tdata-test-id=\"mail_massconnect__settings_crm-user-queue_group\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span class=\"mail_massconnect__group-inline_label\">\n\t\t\t\t\t\t\t\t<span class=\"mail_massconnect__label_user-selector_text\">\n\t\t\t\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_SELECT_MAILBOX_SETTINGS_CRM_QUEUE_LABEL') }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<UserSelector\n\t\t\t\t\t\t\t\tv-model=\"localModelValue.responsibleQueue\"\n\t\t\t\t\t\t\t\tclass=\"mail_massconnect__control-user-selector\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t</div>\n\t`,\n};\n","import { Switcher } from 'ui.vue3.components.switcher';\nimport { SwitcherSize } from 'ui.switcher';\nimport { LocalizationMixin } from '../../mixins/localization-mixin';\nimport './integrations.css';\nimport { CalendarIntegrationSettingsType } from '../../utils/calendar-integration-settings-type';\n\n// @vue/component\nexport const CalendarIntegration = {\n\tname: 'calendar-integration',\n\n\tcomponents: {\n\t\tSwitcher,\n\t},\n\n\tmixins: [LocalizationMixin],\n\n\tprops: {\n\t\t/** @type CalendarIntegrationSettingsType */\n\t\tmodelValue: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: [\n\t\t'update:modelValue',\n\t],\n\n\tcomputed: {\n\t\tlocalModelValue: {\n\t\t\tget(): CalendarIntegrationSettingsType\n\t\t\t{\n\t\t\t\treturn this.modelValue;\n\t\t\t},\n\t\t\tset(newValue): void\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', newValue);\n\t\t\t},\n\t\t},\n\t\tswitcherOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tsize: SwitcherSize.large,\n\t\t\t\tshowStateTitle: false,\n\t\t\t\tuseAirDesign: true,\n\t\t\t};\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"mail_massconnect__integration-block\" :class=\"{ '--disabled': !localModelValue.enabled }\">\n\t\t\t<div \n\t\t\t\tclass=\"mail_massconnect__integration-block_header\"\n\t\t\t\tdata-test-id=\"mail_massconnect__settings_calendar-integration_header\"\n\t\t\t>\n\t\t\t\t<div class=\"mail_massconnect__integration-block_title_group\">\n\t\t\t\t\t<div class=\"mail_massconnect__integration-block_icon --calendar\"></div>\n\t\t\t\t\t<span class=\"mail_massconnect__integration-block_title\">\n\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_INTEGRATION_CALENDAR_TITLE') }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<Switcher\n\t\t\t\t\t:isChecked=\"localModelValue.enabled\"\n\t\t\t\t\t:options=\"switcherOptions\"\n\t\t\t\t\t@click=\"localModelValue.enabled = !localModelValue.enabled\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<transition name=\"mail_massconnect__integration-block_slide-down\">\n\t\t\t\t<div v-if=\"localModelValue.enabled\" class=\"mail_massconnect__integration-block_content\">\n\t\t\t\t\t<div class=\"mail_massconnect__checkbox-group\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\tid=\"mail_massconnect__auto-add-events\"\n\t\t\t\t\t\t\tv-model=\"localModelValue.autoAddEvents\"\n\t\t\t\t\t\t\tdata-test-id=\"mail_massconnect__settings_calendar-integration_auto-add-events-checkbox\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<label for=\"mail_massconnect__auto-add-events\">\n\t\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CALENDAR_AUTO_ADD') }}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</transition>\n\t\t</div>\n\t`,\n};\n","import { useWizardStore } from '../../../../store/wizard';\nimport { mapState, mapActions } from 'ui.vue3.pinia';\nimport { MailIntegration } from '../../../integrations/mail-integration';\nimport { CrmIntegration } from '../../../integrations/crm-integration';\nimport { CalendarIntegration } from '../../../integrations/calendar-integration';\nimport { Switcher } from 'ui.vue3.components.switcher';\nimport { SwitcherSize } from 'ui.switcher';\nimport { LocalizationMixin } from '../../../../mixins/localization-mixin';\nimport { sendData as analyticsSendData } from 'ui.analytics';\nimport './mailbox-settings.css';\n\nexport const MailboxSettings = {\n\tcomponents: {\n\t\tMailIntegration,\n\t\tCrmIntegration,\n\t\tCalendarIntegration,\n\t\tSwitcher,\n\t},\n\n\tmixins: [LocalizationMixin],\n\n\tcomputed: {\n\t\t...mapState(\n\t\t\tuseWizardStore,\n\t\t\t[\n\t\t\t\t'mailSettings',\n\t\t\t\t'crmSettings',\n\t\t\t\t'calendarSettings',\n\t\t\t\t'analyticsSource',\n\t\t\t\t'permissions',\n\t\t\t],\n\t\t),\n\t\tswitcherOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tsize: SwitcherSize.large,\n\t\t\t\tshowStateTitle: false,\n\t\t\t\tuseAirDesign: true,\n\t\t\t};\n\t\t},\n\t},\n\n\tmethods: {\n\t\t...mapActions(useWizardStore, ['setMailSettings', 'setCrmSettings', 'setCalendarSettings']),\n\t\tonStepComplete(): void\n\t\t{\n\t\t\tconst calendarState = this.calendarSettings.enabled ? 'true' : 'false';\n\t\t\tconst crmState = this.crmSettings.enabled ? 'true' : 'false';\n\n\t\t\tanalyticsSendData({\n\t\t\t\ttool: 'mail',\n\t\t\t\tevent: 'mailbox_mass_step3',\n\t\t\t\tcategory: 'mail_mass_ops',\n\t\t\t\tc_section: this.analyticsSource,\n\t\t\t\tp1: `integrationCalendar_${calendarState}`,\n\t\t\t\tp2: `integrationCRM_${crmState}`,\n\t\t\t});\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"mail_massconnect__mailbox-settings_form\">\n\t\t\t<div class=\"mail_massconnect__section-title_container\">\n\t\t\t\t<span class=\"mail_massconnect__section-title\">\n\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CARD_TITLE') }}\n\t\t\t\t</span>\n\t\t\t\t<span class=\"mail_massconnect__section-description\">\n\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_MAILBOX_SETTINGS_CARD_DESCRIPTION') }}\n\t\t\t\t</span>\n\t\t\t</div>\n\n\t\t\t<MailIntegration\n\t\t\t\t:model-value=\"mailSettings\"\n\t\t\t\t@update:model-value=\"setMailSettings($event)\"\n\t\t\t/>\n\n\t\t\t<CrmIntegration\n\t\t\t\t:model-value=\"crmSettings\"\n\t\t\t\t:can-edit-crm-integration=\"permissions.canEditCrmIntegration\"\n\t\t\t\t@update:model-value=\"setCrmSettings($event)\"\n\t\t\t/>\n\n\t\t\t<CalendarIntegration\n\t\t\t\t:model-value=\"calendarSettings\"\n\t\t\t\t@update:model-value=\"setCalendarSettings($event)\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","export const EventName = {\n\tMAILBOX_APPEND_SUCCESS: 'mail-massconnect-mailboxes-append-success',\n};\n","import { Dom, Loc, Type } from 'main.core';\nimport { Button as UiButton, AirButtonStyle } from 'ui.vue3.components.button';\nimport { mapState } from 'ui.vue3.pinia';\nimport { LocalizationMixin } from '../../../mixins/localization-mixin';\nimport { Api } from '../../../api';\nimport { EventName } from '../../../event';\nimport { MailboxPayload } from '../../../store/type';\nimport { sendData as analyticsSendData } from 'ui.analytics';\nimport './connection-status.css';\nimport { useWizardStore } from '../../../store/wizard';\n\n// @vue/component\nexport const ConnectionStatus = {\n\tname: 'connection-status',\n\n\tcomponents: {\n\t\tUiButton,\n\t},\n\n\tmixins: [LocalizationMixin],\n\n\tprops: {\n\t\t/** @type MailboxPayload[] */\n\t\tmailboxes: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\t/** @type MassConnectDataType */\n\t\tmassConnectData: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: ['fix-errors'],\n\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t};\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\ttotalMailboxes: 0,\n\t\t\tprocessedCount: 0,\n\t\t\tsuccessfulCount: 0,\n\t\t\terrorCount: 0,\n\t\t\terrorDetails: [],\n\t\t\tisCancelled: false,\n\t\t\tisFinished: false,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\t...mapState(useWizardStore, ['analyticsSource', 'calendarSettings', 'crmSettings']),\n\t\thasErrors(): boolean\n\t\t{\n\t\t\treturn this.isFinished && this.errorCount > 0;\n\t\t},\n\t\tisSuccess(): boolean\n\t\t{\n\t\t\treturn this.isFinished && this.errorCount === 0;\n\t\t},\n\t\tstatusText(): string\n\t\t{\n\t\t\treturn this.loc('MAIL_MASSCONNECT_FORM_CONNECTION_STATUS', {\n\t\t\t\t'#SUCCESSFUL_CNT#': this.successfulCount,\n\t\t\t\t'#TOTAL_CNT#': this.totalMailboxes,\n\t\t\t\t'#ERROR_CNT#': this.errorCount,\n\t\t\t});\n\t\t},\n\t\terrorText(): string\n\t\t{\n\t\t\treturn Loc.getMessagePlural(\n\t\t\t\t'MAIL_MASSCONNECT_FORM_CONNECTION_FAILURE_TITLE',\n\t\t\t\tthis.errorCount,\n\t\t\t\t{ '#ERROR_CNT#': this.errorCount },\n\t\t\t);\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tDom.hide(document.querySelector('.ui-side-panel-toolbar'));\n\t\tthis.totalMailboxes = this.mailboxes.length;\n\t\tthis.startProcessing();\n\t},\n\n\tmethods: {\n\t\tasync startProcessing(): void\n\t\t{\n\t\t\tlet massConnectId = null;\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst result = await Api.saveMailboxConnectionData(this.massConnectData);\n\n\t\t\t\tmassConnectId = result?.data?.id;\n\n\t\t\t\tif (!massConnectId)\n\t\t\t\t{\n\t\t\t\t\tthrow new Error('Failed to save mailbox connection data');\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tlet message = '';\n\t\t\t\tif (Type.isArray(error.errors) && error.errors[0])\n\t\t\t\t{\n\t\t\t\t\tmessage = error.errors[0]?.message;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tmessage = error.message;\n\t\t\t\t}\n\n\t\t\t\tthis.errorDetails = this.mailboxes.map((mailbox) => ({\n\t\t\t\t\tcustomData: { userIdToConnect: mailbox.userIdToConnect },\n\t\t\t\t\tmessage,\n\t\t\t\t}));\n\t\t\t\tthis.errorCount = this.mailboxes.length;\n\t\t\t\tthis.isFinished = true;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.processMailboxes(this.mailboxes, massConnectId);\n\t\t},\n\n\t\tasync processMailboxes(mailboxes: MailboxPayload[], massConnectId: number): void\n\t\t{\n\t\t\tfor (const mailbox of this.mailboxes)\n\t\t\t{\n\t\t\t\tif (this.isCancelled)\n\t\t\t\t{\n\t\t\t\t\t// push cancellation error for each unprocessed mailbox to show in the error fixing step\n\t\t\t\t\tthis.errorDetails.push({\n\t\t\t\t\t\tcode: 0,\n\t\t\t\t\t\tcustomData: { userIdToConnect: mailbox.userIdToConnect },\n\t\t\t\t\t\tmessage: '', // ToDo: localize cancellation message\n\t\t\t\t\t});\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\t// eslint-disable-next-line no-await-in-loop\n\t\t\t\t\tawait Api.connectMailbox(mailbox, massConnectId);\n\n\t\t\t\t\tthis.successfulCount++;\n\t\t\t\t}\n\t\t\t\tcatch (error)\n\t\t\t\t{\n\t\t\t\t\tthis.errorCount++;\n\n\t\t\t\t\tif (error.errors[0])\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.errorDetails.push(error.errors[0]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfinally\n\t\t\t\t{\n\t\t\t\t\tthis.processedCount++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.isFinished = true;\n\n\t\t\tconst calendarState = this.calendarSettings.enabled ? 'true' : 'false';\n\t\t\tconst crmState = this.crmSettings.enabled ? 'true' : 'false';\n\n\t\t\tanalyticsSendData({\n\t\t\t\ttool: 'mail',\n\t\t\t\tevent: 'mailbox_mass_complete',\n\t\t\t\tcategory: 'mail_mass_ops',\n\t\t\t\tc_section: this.analyticsSource,\n\t\t\t\tp1: `integrationCalendar_${calendarState}`,\n\t\t\t\tp2: `integrationCRM_${crmState}`,\n\t\t\t});\n\n\t\t\tif (this.successfulCount > 0 && !this.isCancelled)\n\t\t\t{\n\t\t\t\tBX.SidePanel.Instance.postMessage(window, EventName.MAILBOX_APPEND_SUCCESS);\n\t\t\t}\n\t\t},\n\n\t\thandleCancel(): void\n\t\t{\n\t\t\tthis.isCancelled = true;\n\t\t\tthis.isFinished = true;\n\t\t},\n\n\t\thandleFixErrors(): void\n\t\t{\n\t\t\tDom.show(document.querySelector('.ui-side-panel-toolbar'));\n\t\t\tthis.$emit('fix-errors', this.errorDetails, this.successfulCount);\n\t\t},\n\n\t\tcloseWizard(): void\n\t\t{\n\t\t\tconst slider = BX.SidePanel.Instance.getTopSlider();\n\t\t\tif (slider)\n\t\t\t{\n\t\t\t\tslider.close();\n\t\t\t}\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"mail_massconnect__connection-status-view\">\n\t\t\t<div \n\t\t\t\tv-if=\"!isFinished\" \n\t\t\t\tclass=\"mail_massconnect__connection-status-view_content\"\n\t\t\t\tdata-test-id=\"mail_massconnect__connection-status-view_processing\"\n\t\t\t>\n\t\t\t\t<div class=\"mail_massconnect__connection-status-view_icon --processing\"></div>\n\t\t\t\t<span class=\"mail_massconnect__connection-status-view_text\">{{ statusText }}</span>\n\t\t\t\t<UiButton\n\t\t\t\t\t:text=\"loc('MAIL_MASSCONNECT_FORM_CONNECTION_CANCEL_BUTTON_TITLE')\"\n\t\t\t\t\t:style=\"AirButtonStyle.FILLED\"\n\t\t\t\t\t@click=\"handleCancel\"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<div \n\t\t\t\tv-if=\"isSuccess\" \n\t\t\t\tclass=\"mail_massconnect__connection-status-view_content\"\n\t\t\t\tdata-test-id=\"mail_massconnect__connection-status-view_success\"\n\t\t\t>\n\t\t\t\t<div class=\"mail_massconnect__connection-status-view_icon --success\"></div>\n\t\t\t\t<span class=\"mail_massconnect__connection-status-view_text\">\n\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_CONNECTION_SUCCESS_ALL_CONNECTED') }}\n\t\t\t\t</span>\n\t\t\t\t<UiButton\n\t\t\t\t\t:text=\"loc('MAIL_MASSCONNECT_FORM_CONNECTION_CLOSE_WIZARD_BUTTON_TITLE')\"\n\t\t\t\t\t:style=\"AirButtonStyle.FILLED\"\n\t\t\t\t\t@click=\"closeWizard\"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<div \n\t\t\t\tv-if=\"hasErrors\" \n\t\t\t\tclass=\"mail_massconnect__connection-status-view_content\"\n\t\t\t\tdata-test-id=\"mail_massconnect__connection-status-view_has-errors\"\n\t\t\t>\n\t\t\t\t<div class=\"mail_massconnect__connection-status-view_icon --failure\"></div>\n\t\t\t\t<div class=\"mail_massconnect__connection-status_failure-text-container\">\n\t\t\t\t\t<div class=\"mail_massconnect__connection-status_failure-text-title\">\n\t\t\t\t\t\t{{ errorText }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mail_massconnect__connection-status_failure-text-description\">\n\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_CONNECTION_FAILURE_DESCRIPTION') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"mail_massconnect__connection-status-view_buttons\"\n\t\t\t\t\tdata-test-id=\"mail_massconnect__connection-status-view_has-errors_buttons\"\n\t\t\t\t>\n\t\t\t\t\t<UiButton\n\t\t\t\t\t\t:text=\"loc('MAIL_MASSCONNECT_FORM_CONNECTION_FIX_BUTTON_TITLE')\"\n\t\t\t\t\t\t:style=\"AirButtonStyle.FILLED\"\n\t\t\t\t\t\t:rightCounterValue=\"errorCount\"\n\t\t\t\t\t\tsize=\"ui-btn-lg\"\n\t\t\t\t\t\tclass=\"mail_massconnect__connection-status-view_has-errors_buttons_fix-button\"\n\t\t\t\t\t\t@click=\"handleFixErrors\"\n\t\t\t\t\t/>\n\t\t\t\t\t<UiButton\n\t\t\t\t\t\t:text=\"loc('MAIL_MASSCONNECT_FORM_CONNECTION_CLOSE_WIZARD_BUTTON_TITLE')\"\n\t\t\t\t\t\t:style=\"AirButtonStyle.PLAIN\"\n\t\t\t\t\t\tclass=\"mail_massconnect__connection-status-view_has-errors_buttons_close-button\"\n\t\t\t\t\t\tsize=\"ui-btn-lg\"\n\t\t\t\t\t\t@click=\"closeWizard\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { LocalizationMixin } from '../../mixins/localization-mixin';\nimport { PreparedIndirectPhraseMixin } from '../../mixins/prepared-indirect-phrase-mixin';\n\n// @vue/component\nexport const WizardHint = {\n\tname: 'WizardHint',\n\n\tmixins: [LocalizationMixin, PreparedIndirectPhraseMixin],\n\n\tcomputed: {\n\t\thintDescriptionText(): { beforeText: ?string, afterText: ?string }\n\t\t{\n\t\t\treturn this.preparedIndirectPhrase(\n\t\t\t\t'MAIL_MASSCONNECT_FORM_CONNECTION_DATA_HINT_DESCRIPTION',\n\t\t\t\t'#HELP_LINK#',\n\t\t\t);\n\t\t},\n\t},\n\n\tmethods: {\n\t\tgoToBPHelp(event): void\n\t\t{\n\t\t\tif (top.BX && top.BX.Helper)\n\t\t\t{\n\t\t\t\tif (event)\n\t\t\t\t{\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\ttop.BX.Helper.show('redirect=detail&code=26953018');\n\t\t\t}\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"mail_massconnect__wizard_card\">\n\t\t\t<div class=\"mail_massconnect__wizard_card_hint\">\n\t\t\t\t<div class=\"mail_massconnect__section-title_container\">\n\t\t\t\t\t<span class=\"mail_massconnect__section-description\">\n\t\t\t\t\t\t<span>{{ hintDescriptionText.beforeText }}</span>\n\t\t\t\t\t\t<span class=\"mail_massconnect__section-description_hint-link\" @click=\"goToBPHelp\">\n\t\t\t\t\t\t\t{{ loc('MAIL_MASSCONNECT_FORM_CONNECTION_DATA_HINT_HELP_LINK') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span>{{ hintDescriptionText.afterText }}</span>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { markRaw } from 'ui.vue3';\nimport { mapState } from 'ui.vue3.pinia';\nimport { Type } from 'main.core';\nimport { WizardProgressBar } from './wizard-progress-bar';\nimport { WizardNavigation } from './wizard-navigation';\nimport { ConnectionData } from './steps/connection-data/connection-data';\nimport { SelectEmployees } from './steps/select-employees/select-employees';\nimport { MailboxSettings } from './steps/mailbox-settings/mailbox-settings';\nimport { useWizardStore } from '../../store/wizard';\nimport { LocalizationMixin } from '../../mixins/localization-mixin';\nimport { ConnectionStatus } from './connection-status/connection-status';\nimport { sendData as analyticsSendData } from 'ui.analytics';\nimport { WizardHint } from './wizard-hint';\nimport './wizard-style.css';\n\n/**\n * @typedef {import('vue').Component & {title: string}} WizardStepComponent\n */\n\n// @vue/component\nexport default {\n\tcomponents: {\n\t\tWizardProgressBar,\n\t\tWizardNavigation,\n\t\tConnectionStatus,\n\t\tWizardHint,\n\t},\n\n\tmixins: [LocalizationMixin],\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcurrentStepIndex: 0,\n\t\t\tsuccessfulCount: 0,\n\t\t\tisSubmitting: false,\n\t\t\tisCurrentStepValid: false,\n\t\t\tvalidationAttempted: false,\n\t\t\tmailboxesToConnect: [],\n\t\t\tmassConnectData: {},\n\t\t\tsteps: [\n\t\t\t\tmarkRaw(ConnectionData),\n\t\t\t\tmarkRaw(SelectEmployees),\n\t\t\t\tmarkRaw(MailboxSettings),\n\t\t\t],\n\t\t};\n\t},\n\n\tcomputed: {\n\t\t...mapState(useWizardStore, ['analyticsSource']),\n\t\tisContinueButtonDisabled(): boolean\n\t\t{\n\t\t\tconst shouldDisable = this.activeStepComponent.disableButtonOnInvalid ?? true;\n\n\t\t\treturn shouldDisable && !this.isCurrentStepValid;\n\t\t},\n\t\ttotalSteps(): number\n\t\t{\n\t\t\treturn this.steps.length;\n\t\t},\n\t\tactiveStepComponent(): WizardStepComponent\n\t\t{\n\t\t\treturn this.steps[this.currentStepIndex];\n\t\t},\n\t\tisFirstStep(): boolean\n\t\t{\n\t\t\treturn this.currentStepIndex === 0;\n\t\t},\n\t\tisLastStep(): boolean\n\t\t{\n\t\t\treturn this.currentStepIndex === this.totalSteps - 1;\n\t\t},\n\t\tisSecondStep(): boolean\n\t\t{\n\t\t\treturn this.currentStepIndex === 1;\n\t\t},\n\t},\n\n\twatch: {\n\t\tcurrentStepIndex()\n\t\t{\n\t\t\tthis.validationAttempted = false;\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tanalyticsSendData({\n\t\t\ttool: 'mail',\n\t\t\tevent: 'mailbox_mass_open',\n\t\t\tcategory: 'mail_mass_ops',\n\t\t\tc_section: this.analyticsSource,\n\t\t});\n\t},\n\n\tmethods: {\n\t\tnextStep(): void\n\t\t{\n\t\t\tthis.validationAttempted = true;\n\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tif (this.isCurrentStepValid && !this.isLastStep)\n\t\t\t\t{\n\t\t\t\t\tthis.handleStepCompletion();\n\n\t\t\t\t\tthis.currentStepIndex++;\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tprevStep(): void\n\t\t{\n\t\t\tif (!this.isFirstStep)\n\t\t\t{\n\t\t\t\tthis.currentStepIndex--;\n\t\t\t}\n\t\t},\n\t\tasync submitWizard(): void\n\t\t{\n\t\t\tthis.handleStepCompletion();\n\n\t\t\tconst wizardStore = useWizardStore();\n\t\t\tconst prepareData = wizardStore.prepareDataForBackend();\n\t\t\tthis.mailboxesToConnect = prepareData.mailboxes;\n\t\t\tthis.massConnectData = wizardStore.prepareDataForHistory();\n\n\t\t\tif (this.mailboxesToConnect.length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isSubmitting = true;\n\t\t},\n\t\thandleStepCompletion(): void\n\t\t{\n\t\t\tif (this.$refs.activeComponent && Type.isFunction(this.$refs.activeComponent.onStepComplete))\n\t\t\t{\n\t\t\t\tthis.$refs.activeComponent.onStepComplete();\n\t\t\t}\n\t\t},\n\t\thandleFixErrors(errorsFromBackend, successfulCount): void\n\t\t{\n\t\t\tthis.successfulCount = successfulCount;\n\n\t\t\tconst wizardStore = useWizardStore();\n\n\t\t\twizardStore.enableErrorState(errorsFromBackend.length);\n\n\t\t\tconst userIdsWithErrors = new Set(\n\t\t\t\terrorsFromBackend.map((error) => error.customData?.userIdToConnect),\n\t\t\t);\n\n\t\t\tconst employeesWithErrors = wizardStore.employees\n\t\t\t\t.filter((employee) => userIdsWithErrors.has(employee.id))\n\t\t\t\t.map((employee) => ({\n\t\t\t\t\t...employee,\n\t\t\t\t\tpassword: '',\n\t\t\t\t}))\n\t\t\t;\n\n\t\t\tconst addedEmployees = [...wizardStore.addedEmployees, ...wizardStore.employees\n\t\t\t\t.filter((employee) => !userIdsWithErrors.has(employee.id))\n\t\t\t\t.map((employee) => ({\n\t\t\t\t\t...employee,\n\t\t\t\t\tpassword: '',\n\t\t\t\t}))]\n\t\t\t;\n\n\t\t\twizardStore.setAddedEmployees(addedEmployees);\n\t\t\twizardStore.setEmployees(employeesWithErrors);\n\n\t\t\tthis.isSubmitting = false;\n\t\t\tthis.currentStepIndex = 1;\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"mail_massconnect__wizard_container\">\n\t\t\t<template v-if=\"!isSubmitting\">\n\t\t\t\t<WizardProgressBar\n\t\t\t\t\t:total-steps=\"totalSteps\"\n\t\t\t\t\t:current-step-index=\"currentStepIndex\"\n\t\t\t\t/>\n\n\t\t\t\t<WizardHint v-if=\"isFirstStep\"/>\n\n\t\t\t\t<div class=\"mail_massconnect__wizard_card\">\n\t\t\t\t\t<div class=\"mail_massconnect__wizard_card_content\">\n\t\t\t\t\t\t<component\n\t\t\t\t\t\t\tref=\"activeComponent\"\n\t\t\t\t\t\t\t:is=\"activeStepComponent\"\n\t\t\t\t\t\t\t:validationAttempted=\"validationAttempted\"\n\t\t\t\t\t\t\t@update:validity=\"isCurrentStepValid = $event\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<WizardNavigation\n\t\t\t\t\t:isFirstStep=\"isFirstStep\"\n\t\t\t\t\t:isLastStep=\"isLastStep\"\n\t\t\t\t\t:isSubmitting=\"isSubmitting\"\n\t\t\t\t\t:prevDisabled=\"isSecondStep && successfulCount > 0\"\n\t\t\t\t\t:disabledContinueButton=\"isContinueButtonDisabled\"\n\t\t\t\t\t@prev-step=\"prevStep\"\n\t\t\t\t\t@next-step=\"nextStep\"\n\t\t\t\t\t@submit=\"submitWizard\"\n\t\t\t\t/>\n\t\t\t</template>\n\n\t\t\t<template v-else>\n\t\t\t\t<div class=\"mail_massconnect__wizard_connection_status_container\">\n\t\t\t\t\t<div class=\"mail_massconnect__wizard_connection_status_content\">\n\t\t\t\t\t\t<ConnectionStatus\n\t\t\t\t\t\t\t:mailboxes=\"mailboxesToConnect\"\n\t\t\t\t\t\t\t:massConnectData=\"massConnectData\"\n\t\t\t\t\t\t\t@fixErrors=\"handleFixErrors\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { BitrixVue } from 'ui.vue3';\nimport { createPinia } from 'ui.vue3.pinia';\nimport { useWizardStore } from './store/wizard';\nimport type { MassconnectPermissions } from './store/type';\n\nimport WizardContainer from './components/wizard/wizard-container.js';\n\ntype MassconnectFormOptions = {\n\tappContainerId: string;\n\tsource: ?string;\n\tisSmtpAvailable: boolean;\n\tpermissions: MassconnectPermissions;\n}\n\nexport class MassconnectForm\n{\n\t#application;\n\trootNode: ?Element;\n\tsource: ?string = null;\n\tisSmtpAvailable: boolean = false;\n\tpermissions: MassconnectPermissions = {\n\t\tallowedLevels: null,\n\t\tcanEditCrmIntegration: null,\n\t};\n\n\tconstructor(options: MassconnectFormOptions = {})\n\t{\n\t\tthis.rootNode = document.querySelector(`#${options.appContainerId}`);\n\t\tthis.source = options?.source;\n\t\tthis.isSmtpAvailable = options.isSmtpAvailable ?? false;\n\n\t\tif (options?.permissions)\n\t\t{\n\t\t\tthis.permissions = options.permissions;\n\t\t}\n\t}\n\n\tstart(): void\n\t{\n\t\tconst pinia = createPinia();\n\n\t\tthis.#application = BitrixVue.createApp({\n\t\t\tcomponents: {\n\t\t\t\tWizardContainer,\n\t\t\t},\n\t\t\t// language=Vue\n\t\t\ttemplate: '<WizardContainer />',\n\t\t});\n\n\t\tthis.#application.use(pinia);\n\n\t\tconst wizardStore = useWizardStore();\n\t\twizardStore.setAnalyticsSource(this.source);\n\t\twizardStore.setSmtpStatus(this.isSmtpAvailable);\n\t\twizardStore.setPermissions(this.permissions);\n\n\t\tthis.#application.mount(this.rootNode);\n\t}\n}\n"],"names":["MailSyncPeriod","Object","freeze","DAY","WEEK","MONTH","TWO_MONTHS","THREE_MONTHS","CrmSyncPeriod","ALL_TIME","CrmCreateAction","LEAD","CONTACT","CrmSource","CALL","EMAIL","WEB","ADVERTISING","PARTNER","RECOMMENDATION","TRADE_SHOW","WEBFORM","CALLBACK","RC_GENERATOR","STORE","OTHER","BOOKING","REPEAT_SALE","YES_VALUE","NO_VALUE","SERVICE_CONFIG","serviceType","name","useWizardStore","defineStore","state","connectionSettings","imapServer","imapPort","imapSsl","smtpSettings","enabled","server","port","ssl","employees","addedEmployees","mailSettings","sync","periodValue","crmSettings","assignKnownClientEmails","incoming","createAction","outgoing","source","leadCreationAddresses","responsibleQueue","calendarSettings","autoAddEvents","errorState","errorCnt","isLoginColumnShown","analyticsSource","permissions","allowedLevels","canEditCrmIntegration","actions","addEmployee","employeeItem","some","employee","id","push","removeEmployeeById","employeeId","filter","setEmployees","clearEmployees","setAddedEmployees","setMailSettings","newSettings","setCrmSettings","setCalendarSettings","prepareCrmOptions","crmOptions","config","crm_sync_days","parseInt","crm_public","crm_new_entity_in","crm_new_entity_out","crm_lead_source","length","crm_lead_resp","map","item","crm_new_lead_for","prepareDataForBackend","mailboxes","smtpServer","smtpPort","isSmtpDataFilled","Boolean","useSmtp","mailboxData","userIdToConnect","email","login","password","loginSmtp","passwordSMTP","mailboxName","senderName","serverSmtp","portSmtp","sslSmtp","iCalAccess","serviceConfig","syncAfterConnection","messageMaxAge","enableErrorState","toggleLoginColumn","setAnalyticsSource","setSmtpStatus","isAvailable","prepareDataForHistory","setPermissions","WizardProgressBar","props","totalSteps","type","Number","required","currentStepIndex","template","LocalizationMixin","methods","loc","phraseCode","replacements","$Bitrix","Loc","getMessage","WizardNavigation","components","UiButton","mixins","isFirstStep","isLastStep","isSubmitting","prevDisabled","disabledContinueButton","emits","data","AirButtonStyle","ConnectionData","BInput","validationAttempted","disableButtonOnInvalid","InputSize","InputDesign","computed","mapState","isValid","imapValid","smtpFilled","smtpValid","showErrors","imapServerError","imapPortError","smtpServerError","smtpPortError","watch","handler","$emit","immediate","onStepComplete","analyticsSendData","tool","event","category","c_section","handleImapPortInput","getSanitizedValue","handleSmtpPortInput","value","String","replaceAll","Api","connectMailbox","mailbox","massConnectId","BX","ajax","runAction","saveMailboxConnectionData","massConnectData","getDepartmentsUsers","departmentIds","EmployeeListTable","BIcon","Array","readonlyMode","outline","Outline","mapActions","SelectEmployees","BMenu","actionsMenuActive","showAddedEmployees","set","Set","isEmployeeListEmpty","menuOptions","bindElement","$refs","actionsMenuActiveRef","items","title","icon","CROSSED_EYE_2","OPENED_EYE","onClick","TRASHCAN","employeeDialog","deselectAll","isFixingErrorsHintText","getMessagePlural","helpDescLink","created","getEmployeeDialog","applyButton","SaveButton","useAirDesign","text","onclick","button","setWaiting","handleSaveItems","getSelectedItems","cancelButton","CancelButton","style","OUTLINE","hide","Dialog","width","height","multiple","showAvatars","enableSearch","context","entities","options","selectMode","forSearch","allowSelectRootDepartment","restricted","allowedPermissionLevels","events","onDestroy","footer","render","footerOptions","containerStyles","display","gap","openEmployeeSelector","targetNode","addButton","getContainer","setTargetNode","isOpen","setPreselectedItems","show","selectedUsers","departmentsToCheck","forEach","entityId","getId","getTitle","avatar","getAvatar","departmentUsers","rawDepartmentUsers","user","getEntity","getItemOption","UI","Notification","Center","notify","content","PrepareOptionsPhrasesMixin","prepareOptionPhrases","option","label","labelKey","PreparedIndirectPhraseMixin","preparedIndirectPhrase","indirectCode","phrase","parts","split","beforeText","afterText","BitrixSettingSelector","modelValue","dialogOptions","selectorInstance","itemOnSelectHandler","newValue","getSelected","select","mounted","settingsMap","Map","settingSelectorOptions","fromEntries","selectedOptionKey","SettingSelector","getData","selectedItem","settingDialog","subscribe","renderTo","$el","beforeUnmount","unsubscribe","destroy","MailIntegrationOptions","syncPeriodOptions","MailIntegration","localModelValue","get","syncLabel","UserSelector","newItemsSet","currentTags","getTags","currentTagsSet","tag","getEntityId","tagId","has","removeTag","itemId","addTag","TagSelector","preselectedItems","intranetUsersOnly","emailUsers","inviteEmployeeLink","onAfterTagAdd","onUpdate","onAfterTagRemove","dialog","getDialog","selectedItems","CrmIntegrationOptions","createActionOptions","sourceOptions","crmLeadSourceDialogOptions","CrmIntegration","directives","hint","Switcher","showAddressTextarea","incomingLabel","outgoingLabel","leadSourceIncomingLabel","switcherOptions","size","SwitcherSize","large","showStateTitle","noAccessHintParams","popupOptions","className","darkMode","offsetTop","background","padding","angle","targetContainer","document","body","offsetLeft","handleSwitcherClick","CalendarIntegration","MailboxSettings","calendarState","crmState","p1","p2","EventName","MAILBOX_APPEND_SUCCESS","ConnectionStatus","setup","totalMailboxes","processedCount","successfulCount","errorCount","errorDetails","isCancelled","isFinished","hasErrors","isSuccess","statusText","errorText","Dom","querySelector","startProcessing","result","Error","message","Type","isArray","errors","customData","processMailboxes","code","SidePanel","Instance","postMessage","window","handleCancel","handleFixErrors","closeWizard","slider","getTopSlider","close","WizardHint","hintDescriptionText","goToBPHelp","top","Helper","preventDefault","isCurrentStepValid","mailboxesToConnect","steps","markRaw","isContinueButtonDisabled","shouldDisable","activeStepComponent","isSecondStep","nextStep","$nextTick","handleStepCompletion","prevStep","submitWizard","wizardStore","prepareData","activeComponent","isFunction","errorsFromBackend","userIdsWithErrors","error","employeesWithErrors","MassconnectForm","rootNode","appContainerId","isSmtpAvailable","pinia","createPinia","BitrixVue","createApp","WizardContainer","use","mount"],"mappings":"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"}