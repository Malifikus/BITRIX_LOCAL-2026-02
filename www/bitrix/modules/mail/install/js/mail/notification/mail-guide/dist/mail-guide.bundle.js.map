{"version":3,"file":"mail-guide.bundle.js","sources":["../src/mail-guide.js"],"sourcesContent":["import { Type, Dom, Event, Tag } from 'main.core';\nimport { BannerDispatcher } from 'ui.banner-dispatcher';\nimport { Popup, PopupManager } from 'main.popup';\nimport './style.css';\n\nexport type MailGuideOptions = {\n\tid: string,\n\ttitle: ?string,\n\tdescription: ?string,\n\tuserOptionName: ?string,\n\tbindElement: HTMLElement;\n\taddHighlighter: boolean;\n\thighlighterBorderRadius: number,\n}\n\nconst defaultHighlighterBorderRadius = 8;\n\nexport class MailGuide\n{\n\t#popup: Popup = null;\n\t#id: string;\n\t#userOptionName: ?string;\n\t#bindElement: ?HTMLElement = null;\n\t#title: ?string = null;\n\t#description: ?string = null;\n\t#addHighlighter: boolean = false;\n\t#highlighterBorderRadius: ?number = null;\n\t#highlighter: ?HTMLElement;\n\n\tconstructor(options: MailGuideOptions)\n\t{\n\t\tif (Type.isObject(options))\n\t\t{\n\t\t\tthis.#id = options.id;\n\t\t\tthis.#bindElement = options.bindElement;\n\t\t\tthis.#userOptionName = options.userOptionName;\n\t\t\tthis.#title = options.title;\n\t\t\tthis.#description = options.description;\n\t\t\tthis.#addHighlighter = options.addHighlighter;\n\t\t\tif (this.#addHighlighter)\n\t\t\t{\n\t\t\t\tthis.#highlighter = Tag.render`<span class=\"ui-highlighter\"></span>`;\n\t\t\t\tthis.#highlighterBorderRadius = `${options.highlighterBorderRadius ?? defaultHighlighterBorderRadius}px`;\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateGuidePopup(onDone: Function): Popup\n\t{\n\t\treturn PopupManager.create({\n\t\t\tid: this.#id,\n\t\t\tclassName: 'popup-window-dark',\n\t\t\tbackground: '#085DC1',\n\t\t\tcloseIcon: true,\n\t\t\tautoHide: false,\n\t\t\tcloseByEsc: true,\n\t\t\tpadding: 12,\n\t\t\tborderRadius: 20,\n\t\t\tcontentPadding: 0,\n\t\t\toffsetTop: 10,\n\t\t\toffsetLeft: -78,\n\t\t\tangle: {\n\t\t\t\toffset: 205,\n\t\t\t\tposition: 'top',\n\t\t\t},\n\t\t\tbindElement: this.#bindElement,\n\t\t\tbindOptions: {\n\t\t\t\tforceBindPosition: false,\n\t\t\t},\n\t\t\twidth: 372,\n\t\t\tcontent: this.getContent(),\n\t\t\tevents: {\n\t\t\t\tonShow: () => {\n\t\t\t\t\tif (this.#addHighlighter)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#prepareHighlighter();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonClose: () => {\n\t\t\t\t\tonDone();\n\t\t\t\t\tif (this.#addHighlighter)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#removeHighlighter();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\treturn Dom.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'mail-notification-container',\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'mail-notification-container__image-wrapper',\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tthis.#renderImage(),\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t\tDom.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'mail-notification-content',\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tthis.#getMessageContainer(this.#title, this.#description),\n\t\t\t\t\t],\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\t}\n\n\t#renderImage(): HTMLElement\n\t{\n\t\treturn Dom.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'mail-notification-container__image',\n\t\t\t},\n\t\t});\n\t}\n\n\t#getMessageContainer(title: ?string, description: ?string): HTMLElement\n\t{\n\t\tconst children = [];\n\n\t\tif (title)\n\t\t{\n\t\t\tchildren.push(Dom.create('h4', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'mail-notification-content__title',\n\t\t\t\t},\n\t\t\t\thtml: title,\n\t\t\t}));\n\t\t}\n\n\t\tif (description)\n\t\t{\n\t\t\tchildren.push(Dom.create('span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'mail-notification-content__description',\n\t\t\t\t},\n\t\t\t\thtml: description,\n\t\t\t}));\n\t\t}\n\n\t\treturn Dom.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'mail-notification-content-wrapper',\n\t\t\t},\n\t\t\tchildren,\n\t\t});\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.#bindElement)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBannerDispatcher.normal.toQueue((onDone) => {\n\t\t\tthis.#popup = this.createGuidePopup(onDone);\n\t\t\tthis.#popup.show();\n\t\t\tthis.#popup.zIndexComponent.setZIndex(400);\n\n\t\t\tif (this.#userOptionName)\n\t\t\t{\n\t\t\t\tBX.userOptions.save('mail.guide', this.#userOptionName, null, 'Y');\n\t\t\t}\n\n\t\t\tEvent.bind(this.#bindElement, 'click', () => {\n\t\t\t\tthis.#popup?.close();\n\t\t\t});\n\t\t});\n\t}\n\n\t#prepareHighlighter(): void\n\t{\n\t\tDom.append(this.#highlighter, this.#bindElement);\n\t\tDom.addClass(this.#bindElement, '--border-md');\n\t\tDom.addClass(this.#bindElement, '--glow-md');\n\t\tDom.style(this.#highlighter, '--ui-highlighter-radius', this.#highlighterBorderRadius);\n\t}\n\n\t#removeHighlighter(): void\n\t{\n\t\tDom.remove(this.#highlighter);\n\t}\n}\n"],"names":["MailGuide","options","babelHelpers","_classPrivateMethodInitSpec","_classPrivateFieldInitSpec","writable","value","Type","isObject","id","bindElement","userOptionName","title","description","addHighlighter","this","Tag","render","highlighterBorderRadius","key","onDone","PopupManager","create","className","background","closeIcon","autoHide","closeByEsc","padding","borderRadius","contentPadding","offsetTop","offsetLeft","angle","offset","position","bindOptions","forceBindPosition","width","content","getContent","events","onShow","_classPrivateMethodGet","onClose","Dom","props","children","BannerDispatcher","normal","toQueue","createGuidePopup","show","zIndexComponent","setZIndex","BX","userOptions","save","Event","bind","_babelHelpers$classPr","close","push","html","append","addClass","style","remove"],"mappings":"oWAeyC,8LAE5BA,aAYZ,WAAYC,GAWV,OAVFC,oCAAAC,UAAAA,UAAAA,UAAAA,UAAAC,UAAAC,YAAAC,MAXgB,OAAIF,UAAAC,YAAAC,eAAAF,UAAAC,YAAAC,eAAAF,UAAAC,YAAAC,MAGS,OAAIF,UAAAC,YAAAC,MACf,OAAIF,UAAAC,YAAAC,MACE,OAAIF,UAAAC,YAAAC,OACD,IAAKF,UAAAC,YAAAC,MACI,OAAIF,UAAAC,YAAAC,eAKnCC,OAAKC,SAASP,MAEjBC,yCAAWD,EAAQQ,IACnBP,yCAAoBD,EAAQS,aAC5BR,yCAAuBD,EAAQU,gBAC/BT,yCAAcD,EAAQW,OACtBV,yCAAoBD,EAAQY,aAC5BX,yCAAuBD,EAAQa,kDAC3BC,UAEHb,yCAAoBc,MAAIC,cAAO,0CAC/Bf,oDAAmCD,EAAQiB,uCA3BR,GA2BF,QAwInC,OArIAhB,6BAAAiB,uBAAAb,eAEgBc,GAEhB,OAAOC,eAAaC,OAAO,CAC1Bb,qCAAIM,QACJQ,UAAW,oBACXC,WAAY,UACZC,WAAW,EACXC,UAAU,EACVC,YAAY,EACZC,QAAS,GACTC,aAAc,GACdC,eAAgB,EAChBC,UAAW,GACXC,YAAa,GACbC,MAAO,CACNC,OAAQ,IACRC,SAAU,OAEXzB,8CAAaK,QACbqB,YAAa,CACZC,mBAAmB,GAEpBC,MAAO,IACPC,QAASxB,KAAKyB,aACdC,OAAQ,CACPC,OAAQ,uCACH3B,SAEH4B,iBAAA5B,OAGF6B,QAAS,KACRxB,sCACIL,SAEH4B,iBAAA5B,aAKJI,iBAAAb,iBAIA,OAAOuC,MAAIvB,OAAO,MAAO,CACxBwB,MAAO,CACNvB,UAAW,+BAEZwB,SAAU,CACTF,MAAIvB,OAAO,MAAO,CACjBwB,MAAO,CACNvB,UAAW,8CAEZwB,SAAU,GACThC,eAAAA,SAGF8B,MAAIvB,OAAO,MAAO,CACjBwB,MAAO,CACNvB,UAAW,6BAEZwB,SAAU,GACThC,eAAAA,uCAA0BA,0CAAaA,kBAK3CI,WAAAb,mDA6CKS,SAKLiC,mBAAiBC,OAAOC,QAAS9B,IAChClB,yCAAca,KAAKoC,iBAAiB/B,IACpClB,0CAAYkD,OACZlD,0CAAYmD,gBAAgBC,UAAU,uCAElCvC,SAEHwC,GAAGC,YAAYC,KAAK,+CAAc1C,QAAsB,KAAM,KAG/D2C,QAAMC,uCAAK5C,QAAmB,QAAS,KAAM,wEAC5C6C,EAAaC,qBAiBhB,aA1EC,OAAOhB,MAAIvB,OAAO,MAAO,CACxBwB,MAAO,CACNvB,UAAW,wCAGb,WAEoBX,EAAgBC,GAEpC,MAAMkC,EAAW,GAsBjB,OApBInC,GAEHmC,EAASe,KAAKjB,MAAIvB,OAAO,KAAM,CAC9BwB,MAAO,CACNvB,UAAW,oCAEZwC,KAAMnD,KAIJC,GAEHkC,EAASe,KAAKjB,MAAIvB,OAAO,OAAQ,CAChCwB,MAAO,CACNvB,UAAW,0CAEZwC,KAAMlD,KAIDgC,MAAIvB,OAAO,MAAO,CACxBwB,MAAO,CACNvB,UAAW,qCAEZwB,SAAAA,IAED,aA2BAF,MAAImB,yCAAOjD,0CAAmBA,SAC9B8B,MAAIoB,2CAASlD,QAAmB,eAChC8B,MAAIoB,2CAASlD,QAAmB,aAChC8B,MAAIqB,wCAAMnD,QAAmB,4DAA2BA,SACxD,aAIA8B,MAAIsB,yCAAOpD"}