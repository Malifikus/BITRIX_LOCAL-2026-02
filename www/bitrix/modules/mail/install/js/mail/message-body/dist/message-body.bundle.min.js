this.BX=this.BX||{};(function(t,e){"use strict";function n(t,e){i(t,e);e.add(t)}function a(t,e,n){i(t,e);e.set(t,n)}function i(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function s(t,e,n){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n}var l=new WeakMap;var r=new WeakMap;var o=new WeakMap;var c=new WeakMap;var d=new WeakMap;var u=new WeakSet;var h=new WeakSet;var b=new WeakSet;var v=new WeakSet;var p=function(){function t(e){babelHelpers.classCallCheck(this,t);n(this,v);n(this,b);n(this,h);n(this,u);a(this,l,{writable:true,value:void 0});a(this,r,{writable:true,value:void 0});a(this,o,{writable:true,value:void 0});a(this,c,{writable:true,value:null});a(this,d,{writable:true,value:null});babelHelpers.classPrivateFieldSet(this,l,e===null||e===void 0?void 0:e.container);babelHelpers.classPrivateFieldSet(this,r,e===null||e===void 0?void 0:e.messageId);if(!babelHelpers.classPrivateFieldGet(this,l)||!babelHelpers.classPrivateFieldGet(this,r)){return}babelHelpers.classPrivateFieldSet(this,o,e.prefix||"mail-msg")}babelHelpers.createClass(t,[{key:"getIframeId",value:function t(){return"".concat(babelHelpers.classPrivateFieldGet(this,o),"-iframe-").concat(babelHelpers.classPrivateFieldGet(this,r))}},{key:"getMessageType",value:function t(){return"".concat(babelHelpers.classPrivateFieldGet(this,o),"-resize-iframe")}},{key:"getStylesMessageType",value:function t(){return"".concat(babelHelpers.classPrivateFieldGet(this,o),"-set-styles")}},{key:"getBodyClass",value:function t(){return"".concat(babelHelpers.classPrivateFieldGet(this,o),"-view-body")}},{key:"getQuoteUnfoldedClass",value:function t(){return"".concat(babelHelpers.classPrivateFieldGet(this,o),"-quote-unfolded")}},{key:"getIframe",value:function t(){return babelHelpers.classPrivateFieldGet(this,d)}},{key:"renderTo",value:function t(n){var a=this.getIframeId();if(document.getElementById(a)){return}var i=s(this,h,y).call(this,n);var r=new Blob([i],{type:"text/html"});var c=URL.createObjectURL(r);var b=document.createElement("iframe");b.id=a;b.src=c;b.width="100%";b.sandbox="allow-popups allow-popups-to-escape-sandbox allow-scripts";b.referrerPolicy="no-referrer";e.Dom.addClass(b,"".concat(babelHelpers.classPrivateFieldGet(this,o),"-iframe"));e.Event.bind(b,"load",(function(){URL.revokeObjectURL(c)}));e.Dom.clean(babelHelpers.classPrivateFieldGet(this,l));e.Dom.append(b,babelHelpers.classPrivateFieldGet(this,l));babelHelpers.classPrivateFieldSet(this,d,b);s(this,u,f).call(this,b)}},{key:"destroy",value:function t(){if(babelHelpers.classPrivateFieldGet(this,c)){e.Event.unbind(window,"message",babelHelpers.classPrivateFieldGet(this,c));babelHelpers.classPrivateFieldSet(this,c,null)}if(babelHelpers.classPrivateFieldGet(this,d)){e.Dom.remove(babelHelpers.classPrivateFieldGet(this,d));babelHelpers.classPrivateFieldSet(this,d,null)}}}]);return t}();function f(t){var n=this;var a=function e(){if(!t||!t.contentWindow){return}var a=getComputedStyle(document.body);t.contentWindow.postMessage({type:n.getStylesMessageType(),styles:{"--ui-font-family-primary":a.getPropertyValue("--ui-font-family-primary"),"--ui-font-family-helvetica":a.getPropertyValue("--ui-font-family-helvetica"),"--ui-font-weight-bold":a.getPropertyValue("--ui-font-weight-bold"),"--ui-font-size-md":a.getPropertyValue("--ui-font-size-md")}},"*")};e.Event.bind(t,"load",a);a();if(!babelHelpers.classPrivateFieldGet(this,c)){babelHelpers.classPrivateFieldSet(this,c,(function(t){if(t.data&&t.data.type===n.getMessageType()){var a=document.getElementById(n.getIframeId());if(a&&t.data.id===babelHelpers.classPrivateFieldGet(n,r)){var i=t.data.height;e.Dom.style(a,"height","".concat(i,"px"))}}}));e.Event.bind(window,"message",babelHelpers.classPrivateFieldGet(this,c))}}function y(t){var e=s(this,b,m).call(this);var n=s(this,v,g).call(this);var a=this.getBodyClass();return'\n\t\t\t<!DOCTYPE html>\n\t\t\t<html>\n\t\t\t\t<head>\n\t\t\t\t\t<meta charset="UTF-8">\n\t\t\t\t\t<meta name="referrer" content="no-referrer">\n\t\t\t\t\t<base target="_blank">\n\t\t\t\t\t<style>'.concat(e,"</style>\n\t\t\t\t\t<script>").concat(n,'<\/script>\n\t\t\t\t</head>\n\t\t\t\t<body>\n\t\t\t\t\t<div class="').concat(a,'">').concat(t,"</div>\n\t\t\t\t</body>\n\t\t\t</html>\n\t\t")}function m(){var t=this.getBodyClass();var e=this.getQuoteUnfoldedClass();return"\n\t\t\tbody {\n\t\t\t\tmargin: 0;\n\t\t\t\tpadding: 0;\n\t\t\t\tfont-family: var(--ui-font-family-primary, var(--ui-font-family-helvetica)), sans-serif;\n\t\t\t\tfont-size: var(--ui-font-size-md, 14px);\n\t\t\t}\n\t\t\timg { max-width: 100%; height: auto; }\n\t\t\t.".concat(t," h1 {\n\t\t\t\tcolor: black;\n\t\t\t\tdisplay: block;\n\t\t\t\tfont-size: 2em;\n\t\t\t\tfont-weight: var(--ui-font-weight-bold);\n\t\t\t}\n\t\t\t.").concat(t," a:-webkit-any-link {\n\t\t\t\tcolor: -webkit-link;\n\t\t\t\ttext-decoration: underline;\n\t\t\t\tcursor: pointer;\n\t\t\t}\n\t\t\t.").concat(t," {\n\t\t\t\tposition: relative;\n\t\t\t\tpadding: 10px 20px 33px 20px;\n\t\t\t\tcolor: #535c69;\n\t\t\t\toverflow-x: auto;\n\t\t\t\tword-wrap: break-word;\n\t\t\t}\n\t\t\t.").concat(t," blockquote {\n\t\t\t\tmargin: 0 0 0 5px;\n\t\t\t\tpadding: 5px 5px 5px 8px;\n\t\t\t\tborder-left: 4px solid #e2e3e5;\n\t\t\t}\n\t\t\t.").concat(t," blockquote:not(.").concat(e,") {\n\t\t\t\tposition: relative;\n\t\t\t\toverflow: hidden;\n\t\t\t\tbox-sizing: border-box;\n\t\t\t\twidth: 32px;\n\t\t\t\theight: 12px;\n\t\t\t\tmargin: 0 0 0 10px;\n\t\t\t\tborder: none;\n\t\t\t\tcursor: pointer;\n\t\t\t}\n\t\t\t.").concat(t," blockquote:not(.").concat(e,'):after {\n\t\t\t\tcontent: "...";\n\t\t\t\tdisplay: block;\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 0;\n\t\t\t\tleft: 0;\n\t\t\t\tright: 0;\n\t\t\t\tbottom: 0;\n\t\t\t\tcolor: #535c69;\n\t\t\t\ttext-align: center;\n\t\t\t\tline-height: 12px;\n\t\t\t\tfont-size: 10px;\n\t\t\t\tbackground: #e2e3e5;\n\t\t\t}\n\t\t')}function g(){var t=this.getMessageType();var e=this.getStylesMessageType();var n=this.getQuoteUnfoldedClass();return"\n\t\t\tconst MESSAGE_ID = ".concat(babelHelpers.classPrivateFieldGet(this,r),';\n\t\t\tconst MESSAGE_TYPE = "').concat(t,'";\n\t\t\tconst STYLES_MESSAGE_TYPE = "').concat(e,'";\n\t\t\tconst QUOTE_UNFOLDED_CLASS = "').concat(n,'";\n\n\t\t\tfunction sendHeight()\n\t\t\t{\n\t\t\t\tconst body = document.body;\n\t\t\t\tconst html = document.documentElement;\n\t\t\t\tconst height = Math.max(\n\t\t\t\t\tbody.scrollHeight, body.offsetHeight,\n\t\t\t\t\thtml.clientHeight, html.scrollHeight, html.offsetHeight\n\t\t\t\t);\n\t\t\t\tparent.postMessage({ type: MESSAGE_TYPE, height: height, id: MESSAGE_ID }, \'*\');\n\t\t\t}\n\n\t\t\twindow.addEventListener("message", function(event) {\n\t\t\t\tif (event.data && event.data.type === STYLES_MESSAGE_TYPE)\n\t\t\t\t{\n\t\t\t\t\tconst styles = event.data.styles;\n\t\t\t\t\tconst root = document.documentElement;\n\t\t\t\t\tfor (let key in styles)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (styles.hasOwnProperty(key))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\troot.style.setProperty(key, styles[key]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\twindow.requestAnimationFrame(sendHeight);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\twindow.addEventListener("load", function() {\n\t\t\t\tconst quotes = document.querySelectorAll("blockquote");\n\t\t\t\tfor (let i = 0; i < quotes.length; i++)\n\t\t\t\t{\n\t\t\t\t\tquotes[i].addEventListener("click", function() {\n\t\t\t\t\t\tthis.classList.add(QUOTE_UNFOLDED_CLASS);\n\t\t\t\t\t\tsendHeight();\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tsendHeight();\n\t\t\t});\n\n\t\t\tconst resizeObserver = new ResizeObserver(() => {\n\t\t\t\tsendHeight();\n\t\t\t});\n\n\t\t\tif (document.body)\n\t\t\t{\n\t\t\t\tresizeObserver.observe(document.body);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twindow.addEventListener(\'DOMContentLoaded\', () => resizeObserver.observe(document.body));\n\t\t\t}\n\t\t')}t.MessageBody=p})(this.BX.Mail=this.BX.Mail||{},BX);
//# sourceMappingURL=message-body.bundle.map.js