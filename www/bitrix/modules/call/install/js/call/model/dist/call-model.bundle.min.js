this.BX=this.BX||{};this.BX.Call=this.BX.Call||{};(function(e,n,t,s,r){"use strict";
/**
	 * Bitrix Messenger
	 * Call Application model (Vuex Builder model)
	 *
	 * @package bitrix
	 * @subpackage im
	 * @copyright 2001-2020 Bitrix
	 */var o=function(e){babelHelpers.inherits(s,e);function s(){babelHelpers.classCallCheck(this,s);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(s).apply(this,arguments))}babelHelpers.createClass(s,[{key:"getName",value:function e(){return"call"}},{key:"getState",value:function e(){return{users:{}}}},{key:"getElementState",value:function e(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return{id:n.id?n.id:0,state:r.ConferenceUserState.Idle,talking:false,pinned:false,cameraState:false,microphoneState:false,screenState:false,floorRequestState:false}}},{key:"getGetters",value:function e(){var n=this;return{getUser:function e(t){return function(e){e=parseInt(e,10);if(!t.users[e]){return n.getElementState({id:e})}return t.users[e]}},getBlankUser:function e(t){return function(e){e=parseInt(e,10);return n.getElementState({id:e})}}}}},{key:"getActions",value:function e(){var n=this;return{updateUser:function e(t,s){s.id=parseInt(s.id,10);s.fields=Object.assign({},n.validate(s.fields));t.commit("updateUser",s)},unpinUser:function e(n,t){n.commit("unpinUser")}}}},{key:"getMutations",value:function e(){var t=this;return{updateUser:function e(s,r){if(!s.users[r.id]){n.Vue.set(s.users,r.id,Object.assign(t.getElementState(),r.fields,{id:r.id}))}else{s.users[r.id]=Object.assign(s.users[r.id],r.fields)}},unpinUser:function e(n,t){var s=Object.values(n.users).find((function(e){return e.pinned===true}));if(s){n.users[s.id].pinned=false}}}}},{key:"validate",value:function e(n){var s={};if(t.Type.isNumber(n.id)||t.Type.isString(n.id)){s.id=parseInt(n.id,10)}if(r.ConferenceUserState[n.state]){s.state=n.state}if(t.Type.isBoolean(n.talking)){s.talking=n.talking}if(t.Type.isBoolean(n.pinned)){s.pinned=n.pinned}if(t.Type.isBoolean(n.cameraState)){s.cameraState=n.cameraState}if(t.Type.isBoolean(n.microphoneState)){s.microphoneState=n.microphoneState}if(t.Type.isBoolean(n.screenState)){s.screenState=n.screenState}if(t.Type.isBoolean(n.floorRequestState)){s.floorRequestState=n.floorRequestState}return s}},{key:"getStateSaveException",value:function e(){return{users:false}}}]);return s}(s.VuexBuilderModel);
/**
	 * Bitrix Messenger
	 * Call Application model (Vuex Builder model)
	 *
	 * @package bitrix
	 * @subpackage im
	 * @copyright 2001-2020 Bitrix
	 */var a=function(e){babelHelpers.inherits(n,e);function n(){babelHelpers.classCallCheck(this,n);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(n).apply(this,arguments))}babelHelpers.createClass(n,[{key:"getName",value:function e(){return"conference"}},{key:"getState",value:function e(){return{common:{inited:false,passChecked:true,showChat:false,userCount:0,messageCount:0,userInCallCount:0,state:r.ConferenceStateType.preparation,callEnded:false,showSmiles:false,error:"",conferenceTitle:"",alias:"",permissionsRequested:false,conferenceStarted:null,conferenceStartDate:null,joinWithVideo:null,userReadyToJoin:false,isBroadcast:false,users:[],usersInCall:[],presenters:[],rightPanelMode:r.ConferenceRightPanelMode.hidden,hasErrorInCall:false},user:{id:-1,hash:""}}}},{key:"getActions",value:function e(){return{showChat:function e(n,t){if(typeof t.newState!=="boolean"){return false}n.commit("showChat",t)},changeRightPanelMode:function e(n,t){if(!r.ConferenceRightPanelMode[t.mode]){return false}n.commit("changeRightPanelMode",t)},setPermissionsRequested:function e(n,t){if(typeof t.status!=="boolean"){return false}n.commit("setPermissionsRequested",t)},setPresenters:function e(n,t){if(!Array.isArray(t.presenters)){t.presenters=[t.presenters]}n.commit("setPresenters",t)},setUsers:function e(n,t){if(!Array.isArray(t.users)){t.users=[t.users]}n.commit("setUsers",t)},removeUsers:function e(n,t){if(!Array.isArray(t.users)){t.users=[t.users]}n.commit("removeUsers",t)},setUsersInCall:function e(n,t){if(!Array.isArray(t.users)){t.users=[t.users]}n.commit("setUsersInCall",t)},removeUsersInCall:function e(n,t){if(!Array.isArray(t.users)){t.users=[t.users]}n.commit("removeUsersInCall",t)},setConferenceTitle:function e(n,t){if(typeof t.conferenceTitle!=="string"){return false}n.commit("setConferenceTitle",t)},setBroadcastMode:function e(n,t){if(typeof t.broadcastMode!=="boolean"){return false}n.commit("setBroadcastMode",t)}}}},{key:"getMutations",value:function e(){var n=this;return{common:function e(n,t){if(typeof t.inited==="boolean"){n.common.inited=t.inited}if(typeof t.passChecked==="boolean"){n.common.passChecked=t.passChecked}if(typeof t.userCount==="number"||typeof t.userCount==="string"){n.common.userCount=parseInt(t.userCount)}if(typeof t.messageCount==="number"||typeof t.messageCount==="string"){n.common.messageCount=parseInt(t.messageCount)}if(typeof t.userInCallCount==="number"||typeof t.userInCallCount==="string"){n.common.userInCallCount=parseInt(t.userInCallCount)}if(typeof t.componentError==="string"){n.common.componentError=t.componentError}if(typeof t.isBroadcast==="boolean"){n.common.isBroadcast=t.isBroadcast}if(Array.isArray(t.presenters)){n.common.presenters=t.presenters}if(typeof t.hasErrorInCall==="boolean"){n.common.hasErrorInCall=t.hasErrorInCall}},user:function e(t,s){if(typeof s.id==="number"){t.user.id=s.id}if(typeof s.hash==="string"&&s.hash!==t.user.hash){t.user.hash=s.hash}if(n.isSaveNeeded({user:s})){n.saveState(t)}},showChat:function e(n,t){var s=t.newState;n.common.showChat=s},changeRightPanelMode:function e(n,t){var s=t.mode;n.common.rightPanelMode=s},setPermissionsRequested:function e(n,t){n.common.permissionsRequested=t.status},startCall:function e(n,t){n.common.state=r.ConferenceStateType.call;n.common.callEnded=false},endCall:function e(n,t){n.common.state=r.ConferenceStateType.preparation;n.common.callEnded=true},returnToPreparation:function e(n,t){n.common.state=r.ConferenceStateType.preparation},toggleSmiles:function e(n,t){n.common.showSmiles=!n.common.showSmiles},setError:function e(n,t){if(typeof t.errorCode==="string"){n.common.error=t.errorCode}},setConferenceTitle:function e(n,t){n.common.conferenceTitle=t.conferenceTitle},setBroadcastMode:function e(n,t){n.common.isBroadcast=t.broadcastMode},setAlias:function e(n,t){if(typeof t.alias==="string"){n.common.alias=t.alias}},setJoinType:function e(n,t){if(typeof t.joinWithVideo==="boolean"){n.common.joinWithVideo=t.joinWithVideo}},setConferenceStatus:function e(n,t){if(typeof t.conferenceStarted==="boolean"){n.common.conferenceStarted=t.conferenceStarted}},setConferenceHasErrorInCall:function e(n,t){if(typeof t.hasErrorInCall==="boolean"){n.common.hasErrorInCall=t.hasErrorInCall}},setConferenceStartDate:function e(n,t){if(t.conferenceStartDate instanceof Date){n.common.conferenceStartDate=t.conferenceStartDate}},setUserReadyToJoin:function e(n,t){n.common.userReadyToJoin=true},setPresenters:function e(n,t){if(t.replace){n.common.presenters=t.presenters}else{t.presenters.forEach((function(e){e=parseInt(e);if(!n.common.presenters.includes(e)){n.common.presenters.push(e)}}))}},setUsers:function e(n,t){t.users.forEach((function(e){e=parseInt(e);if(!n.common.users.includes(e)){n.common.users.push(e)}}))},removeUsers:function e(n,t){n.common.users=n.common.users.filter((function(e){return!t.users.includes(parseInt(e))}))},setUsersInCall:function e(n,t){t.users.forEach((function(e){e=parseInt(e);if(!n.common.usersInCall.includes(e)){n.common.usersInCall.push(e)}}))},removeUsersInCall:function e(n,t){n.common.usersInCall=n.common.usersInCall.filter((function(e){return!t.users.includes(parseInt(e))}))}}}},{key:"getStateSaveException",value:function e(){return{common:{inited:null,state:null,showSmiles:null,userCount:null,messageCount:null,userInCallCount:null,error:null,conferenceTitle:null,alias:null,conferenceStarted:null,conferenceStartDate:null,joinWithVideo:null,userReadyToJoin:null,rightPanelMode:null,presenters:null,users:null,hasErrorInCall:null}}}}]);return n}(s.VuexBuilderModel);e.CallModel=o;e.ConferenceModel=a})(this.BX.Call.Model=this.BX.Call.Model||{},BX,BX,BX,BX.Call.Const);
//# sourceMappingURL=call-model.bundle.map.js