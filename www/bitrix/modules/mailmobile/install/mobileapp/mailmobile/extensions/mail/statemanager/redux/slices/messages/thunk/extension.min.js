jn.define("mail/statemanager/redux/slices/messages/thunk",((e,t,o)=>{const{createAsyncThunk:n}=e("statemanager/redux/toolkit");const{sliceName:s}=e("mail/statemanager/redux/slices/messages/meta");const{AjaxMethod:a}=e("mail/const");const{RunActionExecutor:i}=e("rest/run-action-executor");const{isOnline:c}=e("device/connection");const{selectUidIdsByIds:d,selectOriginalReadStatuses:r,selectById:l}=e("mail/statemanager/redux/slices/messages/selector");const{selectCurrentFolderPath:m}=e("mail/statemanager/redux/slices/folders/selector");const u=()=>c();const g=({action:e,options:t})=>new Promise((o=>{new i(e,t).setHandler(o).call(false)}));const h=n(`${s}/remove`,(({objectUidIds:e})=>g({action:a.mailDelete,options:{ids:e}})),{condition:u});const T=n(`${s}/changeReadStatus`,(async({objectUidIds:e,objectIds:t,isRead:o},{getState:n})=>{const s=n();const i=r(s)||{};const c=[];let l=0;t.forEach((e=>{const t=i[e];if(t!==undefined&&Boolean(t)!==Boolean(o)){l+=o?-1:1;c.push(e)}}));const m=d(s,c)??[];if(m.length===0){return{}}const u=await g({action:a.mailChangeReadStatus,options:{ids:m,isRead:o}});return{...u,isRead:o,readDelta:l}}),{condition:u});const p=n(`${s}/addToCrm`,(({objectIds:e})=>g({action:a.mailCreateCrm,options:{ids:e}}).then((e=>{if(e?.data){j()}}))),{condition:u});const C=n(`${s}/addToTask`,(async({objectId:e,title:t,description:o})=>{const{Entry:n}=await requireLazy("tasks:entry");n.openTaskCreation({initialTaskData:{title:t,description:o,mailMessageId:e}})}),{condition:u});const I=n(`${s}/addToChat`,(({objectId:e})=>g({action:a.mailCreateChat,options:{messageId:e}})),{condition:u});const f=n(`${s}/moveToFolder`,(async({objectUidIds:e,objectIds:t,folderPath:o},{getState:n})=>{const s=n();const i=m(s);const c=t.reduce(((e,t)=>{const o=l(s,t);return o?.isRead?e:e+1}),0);const d=await g({action:a.mailMoveToFolder,options:{ids:e,folderPath:o}});return{...d,movedCount:c,fromFolderPath:i,toFolderPath:o}}),{condition:u});function j(){BX.postComponentEvent("Mail.Binding::bindingSent",[])}o.exports={remove:h,moveToFolder:f,changeReadStatus:T,addToCrm:p,addToChat:I,sendBindingEvent:j,addToTask:C}}));
//# sourceMappingURL=extension.map.js