jn.define("mail/mailbox/connector/steps/login-password",((e,t,s)=>{const{Haptics:i}=e("haptics");const{WizardStep:n}=e("layout/ui/wizard/step");const{Loc:o}=e("loc");const{ProgressBarNumber:a}=e("crm/salescenter/progress-bar-number");const{useCallback:r}=e("utils/function");const{clone:l,isEmpty:c}=e("utils/object");const{stringify:d}=e("utils/string");const{NotifyManager:g}=e("notify-manager");const{getServiceInfo:u}=e("mail/mailbox/connector/steps/services-list");const p=e("apptheme");const{StringInput:f,InputDesign:h,InputMode:O,InputSize:m}=e("ui-system/form/inputs/string");const{EmailInput:L}=e("ui-system/form/inputs/email");const{PureComponent:_}=e("layout/pure-component");const{Color:w}=e("tokens");const{isValidEmail:I}=e("utils/email");const{ButtonSize:S,ButtonDesign:C,Button:R}=e("ui-system/form/buttons/button");class x extends _{constructor(e){super(e);this.fieldRefs={};this.constants={fields:{login:{ref:e=>this.fieldRefs.login=e},password:{ref:e=>this.fieldRefs.password=e}}};this.state={fields:this.getEmptyFieldsData()};this.nextStepAction=e.nextStepAction}getEmptyFieldsData(){return{login:{value:""},password:{value:""}}}onChangeField(e,t){const s=l(this.state.fields);s[e].value=d(t);this.setState({fields:s})}getInvalidField(){const{login:e,password:t}=this.state.fields;if(!I(e.value)){const e=this.fieldRefs.login;if(e){return e}}if(c(t.value)){const e=this.fieldRefs.password;if(e){return e}}return null}render(){return View({style:{flex:1}},L({label:o.getMessage("MAILBOX_CONNECTOR_LOGIN_PASSWORD_LOGIN_TITLE_1"),size:m.L,design:h.GREY,mode:O.STROKE,showTitle:false,validation:true,testId:"connecting-mailboxes-connecting-mailbox-login-password-email",ref:this.constants.fields.login.ref,showLeftIcon:false,showRequired:false,required:true,value:this.state.fields.login.value,onChange:r((e=>this.onChangeField("login",e)),["login"]),onValid:I,placeholder:o.getMessage("MAILBOX_CONNECTOR_LOGIN_PASSWORD_LOGIN_PLACEHOLDER_1")}),View({style:{height:20}}),f({size:m.L,design:h.GREY,mode:O.STROKE,testId:"connecting-mailboxes-connecting-mailbox-login-password-password",ref:this.constants.fields.password.ref,showRequired:false,required:true,showTitle:false,validation:true,value:this.state.fields.password.value,onChange:r((e=>this.onChangeField("password",e)),["password"]),label:o.getMessage("MAILBOX_CONNECTOR_LOGIN_PASSWORD_PASSWORD_TITLE_1"),placeholder:o.getMessage("MAILBOX_CONNECTOR_LOGIN_PASSWORD_PASSWORD_PLACEHOLDER_1"),onValid:c,isPassword:true}),View({style:{height:40}}),R({testId:"connecting-mailboxes-connecting-mailbox-button-confirm",text:o.getMessage("MAILBOX_CONNECTOR_LOGIN_PASSWORD_BUTTON"),size:S.XL,design:C.FILLED,disabled:false,stretched:true,onClick:this.nextStepAction}))}}class E extends n{getBackgroundColor(){return w.bgPrimary.toHex()}checkMailboxCanConnected(){let e=true;const t=this.fieldsLayout.getInvalidField();if(t){t?.focus();i.notifyWarning();e=false}return e}constructor(e){super();this.props=e}async onMoveToNextStep(){const e={finish:false,next:false};if(!this.checkMailboxCanConnected()){return e}const{login:t,password:s}=this.fieldsLayout.state.fields;if(t.value!==""&&s.value!==""){g.showLoadingIndicator();await this.props.parent.connectMailbox({login:t.value,password:s.value}).then((({data:e})=>{this.props.parent.onConnectMailbox(e.id,e.email)})).catch((({errors:e})=>{g.showErrors(e)}))}return e}getProgressBarSettings(){return{...super.getProgressBarSettings(),isEnabled:true,title:{text:o.getMessage("MAILBOX_CONNECTOR_LOGIN_PASSWORD_TITLE_3")},number:2,count:2}}getTitle(){return o.getMessage("MAILBOX_CONNECTOR_LOGIN_PASSWORD_HEADER_TITLE")}renderNumberBlock(){return new a({number:"2"})}titleBlock(){const e=this.props.parent.getMailServiceKey();if(!e){return null}return View({style:{marginBottom:20,flexDirection:"row"}},View({style:{marginRight:10,width:32,height:32}},Image({svg:{content:u(e).svgContent},style:{width:32,height:32}})),Text({style:{textAlign:"center",color:p.colors.base2,fontSize:18,fontWeight:"400"},text:o.getMessage("MAILBOX_CONNECTOR_LOGIN_PASSWORD_TITLE_4")}))}createLayout(e){this.fieldsLayout=new x({nextStepAction:this.props.parent.nextStep.bind(this.props.parent)});return View({style:{flex:1}},View({style:{flex:1,margin:16,paddingLeft:15,paddingRight:15,paddingBottom:37,paddingTop:27}},this.titleBlock(),View({style:{flex:1,paddingLeft:5}},this.fieldsLayout)))}}s.exports={LoginPassword:E}}));
//# sourceMappingURL=extension.map.js