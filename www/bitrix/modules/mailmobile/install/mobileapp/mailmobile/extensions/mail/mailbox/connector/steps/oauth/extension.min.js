jn.define("mail/mailbox/connector/steps/oauth",((e,t,r)=>{const{WizardStep:s}=e("layout/ui/wizard/step");const{ProgressBarNumber:n}=e("crm/salescenter/progress-bar-number");const{Loc:o}=e("loc");const{getParameterByName:a}=e("utils/url");class i extends s{constructor(e){super();this.props=e}isNextStepEnabled(){return false}getTitle(){return o.getMessage("MAILBOX_CONNECTOR_OAUTH_HEADER_TITLE")}renderNumberBlock(){return new n({number:"2"})}getProgressBarSettings(){return{...super.getProgressBarSettings(),isEnabled:true,title:{text:o.getMessage("MAILBOX_CONNECTOR_OAUTH_TITLE_1")},number:2,count:2}}startOAuth(){this.props.parent.getConnectionUrl().then((e=>{const{OAuthSession:t}=jn.require("native/oauth");const r=new t(e);r.start().then((async({url:e})=>{const t=a(e,"storedUid");const r=a(e,"email");if(t&&t!==""&&r&&r!==""){await this.props.parent.connectMailbox({useSmtp:0,storageOauthUid:t,login:r}).then((({data:e})=>{this.props.parent.onConnectMailbox(e.id,e.email)})).catch((({errors:e})=>{this.props.parent.onErrorEnter(e)}))}else{const t=a(e,"error");let r=[];if(t){r=[{message:t}]}this.props.parent.onErrorEnter(r)}})).catch((({errors:e})=>{this.props.parent.onErrorEnter(e,false)}))})).catch((()=>{this.props.parent.goToStartStep()}))}createLayout(e){this.startOAuth();return View({},ScrollView({style:{height:"100%"}},View({style:{paddingTop:200,alignItems:"center"}},View({justifyContent:"center",flexDirection:"row"},Loader({style:{width:50,height:50},tintColor:"#00aeff",animating:true,size:"large"})))))}}r.exports={OAuth:i}}));
//# sourceMappingURL=extension.map.js