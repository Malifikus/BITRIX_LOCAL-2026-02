{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { Builder, Dictionary } from 'crm.integration.analytics';\nimport { Dom, Event, Loc, Reflection, Runtime, Tag, Text } from 'main.core';\nimport { SidePanel } from 'main.sidepanel';\nimport { sendData } from 'ui.analytics';\nimport { AirButtonStyle, Button, ButtonSize } from 'ui.buttons';\nimport { Icon, Main } from 'ui.icon-set.api.core';\n\nconst namespace = Reflection.namespace('BX.Crm');\n\ntype Page = {\n\tid: string,\n\ttitle: string,\n\tsections: Section[],\n}\n\ntype Section = {\n\ttitle: string,\n\tdescription: string,\n\tcolor: string,\n\tchannels: Channel[],\n\ticonPath: string,\n}\n\ntype Channel = {\n\tid: string,\n\ttype: string,\n\tappearance: Appearance,\n\tisConnected: boolean,\n\tconnectionUrl: string,\n\tisPromo: boolean,\n\tisTemplatesBased: boolean,\n\tisLocked: boolean,\n\tsliderCode: string,\n}\n\ntype Appearance = {\n\ticon: ChannelIcon,\n\ttitle: string,\n\tsubtitle: string,\n\tdescription: string,\n}\n\ntype ChannelIcon = {\n\ttitle: string,\n\tcolor: string,\n\tbackground: string,\n}\n\nclass MessageSenderConnectionsComponent\n{\n\t#pages: Map<string, Page>;\n\t#currentPage: string;\n\t#targetNodeId: string;\n\t#container: HTMLElement;\n\t#contactCenterUrl: string;\n\t#analytics: Object;\n\n\tconstructor(params)\n\t{\n\t\tthis.#pages = new Map(params.slider.pages.map((item) => [item.id, item]));\n\t\tthis.#currentPage = params.currentPage;\n\t\tthis.#targetNodeId = params.targetNodeId;\n\t\tthis.#contactCenterUrl = params.contactCenterUrl;\n\t\tthis.#analytics = params.analytics ?? {};\n\t}\n\n\tinit()\n\t{\n\t\tthis.#container = document.getElementById(this.#targetNodeId);\n\n\t\tif (this.#container)\n\t\t{\n\t\t\tthis.#draw();\n\t\t}\n\t}\n\n\t#draw()\n\t{\n\t\tDom.append(this.#getContent(), this.#container);\n\t}\n\n\t#redraw()\n\t{\n\t\tDom.clean(this.#container);\n\t\tthis.#draw();\n\t}\n\n\t#getContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t${this.#getNavBar()}\n\t\t\t\t${this.#getPage(this.#getCurrentPage())}\n\t\t\t\t${this.#getFooter()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getCurrentPage(): Page\n\t{\n\t\treturn this.#pages.get(this.#currentPage);\n\t}\n\n\t#getNavBar(): HTMLElement\n\t{\n\t\tconst navBar = Tag.render`\n\t\t\t<div class=\"crm-message-sender-connections-tab-navigation\"></div>\n\t\t`;\n\n\t\tthis.#addNavBarButtons(navBar);\n\n\t\treturn navBar;\n\t}\n\n\t#addNavBarButtons(node: HTMLElement): HTMLElement\n\t{\n\t\tthis.#pages.forEach((page, id) => {\n\t\t\t(new Button({\n\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\tstyle: id === this.#currentPage ? AirButtonStyle.SELECTION : AirButtonStyle.PLAIN_NO_ACCENT,\n\t\t\t\tuseAirDesign: true,\n\t\t\t\ttext: page.title,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tif (id === this.#currentPage)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.#currentPage = page.id;\n\t\t\t\t\tthis.#redraw();\n\t\t\t\t},\n\t\t\t})).renderTo(node);\n\t\t});\n\n\t\t(new Button({\n\t\t\tsize: ButtonSize.SMALL,\n\t\t\tstyle: AirButtonStyle.PLAIN_NO_ACCENT,\n\t\t\tuseAirDesign: true,\n\t\t\ttext: Loc.getMessage('CRM_MESSAGESENDER_CONNECTIONS_TAB_NAV_ALL_CONNECTION'),\n\t\t\tonclick: () => {\n\t\t\t\tSidePanel.Instance.open(this.#contactCenterUrl);\n\t\t\t\tthis.#sendConnectEvent('contactCenter');\n\t\t\t},\n\t\t})).renderTo(node);\n\n\t\t(new Button({\n\t\t\tsize: ButtonSize.SMALL,\n\t\t\tstyle: AirButtonStyle.PLAIN_NO_ACCENT,\n\t\t\tuseAirDesign: true,\n\t\t\ttext: Loc.getMessage('CRM_MESSAGESENDER_CONNECTIONS_TAB_NAV_MARKET'),\n\t\t\tonclick: () => {\n\t\t\t\tSidePanel.Instance.open('/market/category/crm_robot_sms/');\n\t\t\t},\n\t\t})).renderTo(node);\n\t}\n\n\t#getPage(page: Page): HTMLElement\n\t{\n\t\tif (page.id === 'recommendations')\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"crm-message-sender-connections-page-recommendation\">\n\t\t\t\t\t${page.sections.map((section) => this.#getRecommendationSection(section))}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst pageHtml = Tag.render`\n\t\t\t<div class=\"crm-message-sender-connections-page\"></div>\n\t\t`;\n\n\t\tfor (let i = 0; i < page.sections.length; i++)\n\t\t{\n\t\t\tconst section = page.sections[i];\n\n\t\t\tfor (let j = 0; j < section.channels.length; j++)\n\t\t\t{\n\t\t\t\tconst channel = section.channels[j];\n\n\t\t\t\tDom.append(this.#getSection(section, channel), pageHtml);\n\t\t\t}\n\t\t}\n\n\t\treturn pageHtml;\n\t}\n\n\t#getSection(section: Section, channel: Channel): HTMLElement\n\t{\n\t\tconst sectionHtml = Tag.render`\n\t\t\t<div class=\"crm-message-sender-connections-section-default\" style=\"background: ${Text.encode(section.color)}\">\n\t\t\t\t${channel.isConnected ? this.#getChannelStatusConnected() : ''}\n\t\t\t\t<div class=\"crm-message-sender-connections-section-default-image\">\n\t\t\t\t\t<div><img alt=\"${Text.encode(section.title)}\" src=\"${Text.encode(section.iconPath)}\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-message-sender-connections-section-channel-default-title\" style=\"${channel.isConnected ? 'color: var(--ui-color-base-8)' : ''}\">\n\t\t\t\t\t${Text.encode(section.title)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\tEvent.bind(sectionHtml, 'click', () => this.#openConnectionSlider(channel));\n\n\t\treturn sectionHtml;\n\t}\n\n\t#getChannelStatusConnected(): HTMLElement\n\t{\n\t\tconst icon = (new Icon({\n\t\t\ticon: Main.CHECK,\n\t\t\tsize: 16,\n\t\t\tcolor: '#fff',\n\t\t})).render();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-message-sender-connections-section-channel-status-connected\">${icon}</div>\n\t\t`;\n\t}\n\n\t#getRecommendationSection(section: Section): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-message-sender-connections-section\" style=\"background: ${section.color}\">\n\t\t\t\t${this.#getSectionHeader(section)}\n\t\t\t\t<div class=\"crm-message-sender-connections-section-channel-container\">\n\t\t\t\t\t${section.channels.map((channel) => this.#getChanel(channel))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getSectionHeader(section: Section): HTMLElement\n\t{\n\t\tconst title = section.iconPath\n\t\t\t? Tag.render`<img src=\"${section.iconPath}\">`\n\t\t\t: section.title;\n\n\t\tif (!section.description)\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<header class=\"crm-message-sender-connections-section-header\">\n\t\t\t\t\t<div class=\"crm-message-sender-connections-section-icon\">${Text.encode(title)}</div>\n\t\t\t\t</header>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<header class=\"crm-message-sender-connections-section-header\">\n\t\t\t\t<div class=\"crm-message-sender-connections-section-title\">${Text.encode(title)}</div>\n\t\t\t\t<div class=\"crm-message-sender-connections-section-description\">${Text.encode(section.description)}</div>\n\t\t\t</header>\n\t\t`;\n\t}\n\n\t#getChanel(channel: Channel): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-message-sender-connections-channel\">\n\t\t\t\t<div class=\"crm-message-sender-connections-channel-header\">\n\t\t\t\t\t<div class=\"crm-message-sender-connections-channel-header-icon\" style=\"background: ${\n\t\t\t\t\t\tText.encode(channel.appearance.icon.background)\n\t\t\t\t\t}\">\n\t\t\t\t\t\t${this.#getChanelIcon(channel.appearance.icon)}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getConnectionButton(channel)}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-message-sender-connections-channel-content\">\n\t\t\t\t\t<div class=\"crm-message-sender-connections-channel-content-title\">\n\t\t\t\t\t\t<div class=\"crm-message-sender-connections-channel-content-title-text\" title=\"${\n\t\t\t\t\t\t\tText.encode(channel.appearance.title)\n\t\t\t\t\t\t}\">\n\t\t\t\t\t\t\t${Text.encode(channel.appearance.title)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.#getChannelStatus(channel)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-message-sender-connections-channel-content-description\">${Text.encode(channel.appearance.description)}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getChannelStatus(channel: Channel): ?HTMLElement\n\t{\n\t\tif (!channel.isConnected)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-message-sender-connections-channel-status\">\n\t\t\t\t${Loc.getMessage('CRM_MESSAGESENDER_CONNECTIONS_CHANNEL_STATUS')}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getChanelIcon(icon: ChannelIcon): HTMLElement\n\t{\n\t\treturn (new Icon({\n\t\t\ticon: icon.title,\n\t\t\tsize: 62,\n\t\t\tcolor: icon.color,\n\t\t})).render();\n\t}\n\n\t#getConnectionButton(channel: Channel): HTMLElement\n\t{\n\t\treturn (new Button({\n\t\t\tsize: ButtonSize.LARGE,\n\t\t\tstyle: channel.isConnected ? AirButtonStyle.OUTLINE : AirButtonStyle.FILLED,\n\t\t\tuseAirDesign: true,\n\t\t\ttext: channel.isConnected\n\t\t\t\t? Loc.getMessage('CRM_MESSAGESENDER_CONNECTIONS_CHANNEL_SETTING_BUTTON')\n\t\t\t\t: Loc.getMessage('CRM_MESSAGESENDER_CONNECTIONS_CHANNEL_CONNECTION_BUTTON'),\n\t\t\tonclick: () => {\n\t\t\t\tthis.#openConnectionSlider(channel);\n\t\t\t},\n\t\t})).getContainer();\n\t}\n\n\t#openConnectionSlider(channel): void\n\t{\n\t\tlet promise = null;\n\n\t\tif (channel.isLocked)\n\t\t{\n\t\t\tpromise = Runtime.loadExtension('ui.info-helper').then(({ FeaturePromotersRegistry }) => {\n\t\t\t\tFeaturePromotersRegistry.getPromoter({ code: channel.sliderCode }).show();\n\n\t\t\t\treturn { status: 'locked' };\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpromise = Runtime.loadExtension('crm.router').then(({ Router }) => {\n\t\t\t\treturn Router.openSlider(channel.connectionUrl).then().catch().finally(() => window.location.reload());\n\t\t\t}).then((slider: BX.SidePanel.Slider) => {\n\t\t\t\treturn {\n\t\t\t\t\tstatus: slider.getData().get('status'),\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\tif (!channel.isConnected)\n\t\t{\n\t\t\tvoid promise.then(({ status }) => {\n\t\t\t\tthis.#sendConnectEvent(channel.id, status);\n\t\t\t});\n\t\t}\n\t}\n\n\t#sendConnectEvent(channelId: string, connectStatus: string)\n\t{\n\t\tconst analyticsData = (new Builder.Communication.Channel.ConnectEvent())\n\t\t\t.setChannelId(channelId)\n\t\t\t.setConnectStatus(connectStatus)\n\t\t\t.setSubSection(Dictionary.SUB_SECTION_CONNECTION_SLIDER)\n\t\t\t.setSection(this.#analytics.c_section)\n\t\t\t.buildData();\n\n\t\tsendData(analyticsData);\n\t}\n\n\t#getFooter(): HTMLElement\n\t{\n\t\tconst button = (new Button({\n\t\t\tsize: ButtonSize.EXTRA_LARGE,\n\t\t\tstyle: AirButtonStyle.OUTLINE,\n\t\t\tuseAirDesign: true,\n\t\t\ttext: Loc.getMessage('CRM_MESSAGESENDER_CONNECTIONS_FOOTER_BUTTON_ALL_CONNECTION'),\n\t\t\tonclick: () => {\n\t\t\t\tSidePanel.Instance.open(this.#contactCenterUrl);\n\t\t\t\tthis.#sendConnectEvent('contactCenter');\n\t\t\t},\n\t\t})).getContainer();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"crm-message-sender-connections-footer\">${button}</div>\n\t\t`;\n\t}\n}\n\nnamespace.MessageSenderConnectionsComponent = MessageSenderConnectionsComponent;\n"],"names":["namespace","Reflection","MessageSenderConnectionsComponent","params","Map","slider","pages","map","item","id","currentPage","targetNodeId","contactCenterUrl","analytics","document","getElementById","Dom","append","clean","Tag","render","get","navBar","node","forEach","page","Button","size","ButtonSize","SMALL","style","AirButtonStyle","SELECTION","PLAIN_NO_ACCENT","useAirDesign","text","title","onclick","renderTo","Loc","getMessage","SidePanel","Instance","open","sections","section","pageHtml","i","length","j","channels","channel","sectionHtml","Text","encode","color","isConnected","iconPath","Event","bind","icon","Icon","Main","CHECK","description","appearance","background","LARGE","OUTLINE","FILLED","getContainer","promise","isLocked","Runtime","loadExtension","then","FeaturePromotersRegistry","getPromoter","code","sliderCode","show","status","Router","openSlider","connectionUrl","window","location","reload","getData","channelId","connectStatus","analyticsData","Builder","Communication","Channel","ConnectEvent","setChannelId","setConnectStatus","setSubSection","Dictionary","SUB_SECTION_CONNECTION_SLIDER","setSection","c_section","buildData","sendData","button","EXTRA_LARGE"],"mappings":"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"}