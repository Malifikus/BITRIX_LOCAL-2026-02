{"version":3,"file":"index.bundle.js","sources":["../src/stream-type.js","../src/components/layout/menu.js","../src/action.js","../src/components/layout/body/logo.js","../src/components/layout/body/calendar-icon.js","../src/components/layout/body/logo-calendar.js","../src/components/layout/body.js","../src/components/enums/button-scope.js","../src/components/enums/button-state.js","../src/components/enums/button-type.js","../src/components/layout/baseButton.js","../src/components/layout/button-menu.js","../src/components/layout/button.js","../src/components/layout/footer/add-button.js","../src/components/layout/footer/buttons.js","../src/components/layout/footer/menu.js","../src/components/layout/footer.js","../src/components/layout/header/change-stream-button.js","../src/components/layout/header/color-selector.js","../src/components/layout/header/format-date.js","../src/components/layout/header/hint.js","../src/components/enums/tag-type.js","../src/components/layout/header/tag.js","../src/components/layout/header/title.js","../src/components/layout/header/user.js","../src/components/layout/header.js","../src/components/enums/icon-background-color.js","../src/components/layout/icon.js","../src/components/layout/marketPanel.js","../src/components/layout/userPick.js","../src/components/item.js","../src/controller-manager.js","../src/controllers/base.js","../src/item.js","../src/layout.js","../src/configurable-item.js","../src/controllers/activity.js","../src/controllers/ai/call-scoring-result.js","../src/controllers/ai/call-transcript-result.js","../src/controllers/ai/entity-fields-filling-result.js","../src/controllers/ai/transcript-summary-result.js","../src/components/content-blocks/avatars-stack-steps.js","../src/controllers/bizproc/enums/task-user-status.js","../src/controllers/bizproc/bizproc.js","../src/controllers/booking/show-cycle-popup.js","../src/controllers/booking/booking.js","../src/controllers/booking/wait-list-item.js","../src/components/content-blocks/calendar/sharing-slots-list.js","../src/controllers/calendar/sharing.js","../src/controllers/ai/copilot-base.js","../src/controllers/call.js","../src/controllers/comment.js","../src/components/content-blocks/address.js","../src/components/enums/client-mark.js","../src/components/content-blocks/client-mark.js","../src/components/enums/editable-description-height.js","../src/components/enums/editable-description-background-color.js","../src/components/enums/editable-description-ai-status.js","../src/components/content-blocks/internal/copilot/loader.js","../src/components/content-blocks/internal/copilot/header-text.js","../src/components/content-blocks/editable-description.js","../src/components/content-blocks/comment-content.js","../src/components/enums/text-color.js","../src/components/enums/text-weight.js","../src/components/enums/text-size.js","../src/components/enums/text-decoration.js","../src/components/content-blocks/text.js","../src/components/content-blocks/date.js","../src/components/content-blocks/date-pill.js","../src/components/content-blocks/link.js","../src/components/content-blocks/editable-date.js","../src/components/content-blocks/editable-text.js","../src/components/enums/logo-type.js","../src/components/content-blocks/timeline-audio.js","../src/components/content-blocks/file.js","../src/components/content-blocks/file-list.js","../src/components/content-blocks/info-group.js","../src/components/content-blocks/item-selector.js","../src/components/content-blocks/line-of-text-blocks.js","../src/components/content-blocks/line-of-text-blocks-button.js","../src/components/content-blocks/money.js","../src/components/content-blocks/money-pill.js","../src/components/content-blocks/note.js","../src/components/content-blocks/player-alert.js","../src/components/content-blocks/rest-app-layout-blocks.js","../src/components/content-blocks/sms-message.js","../src/components/content-blocks/copilot/call-scoring-pill.js","../src/components/content-blocks/copilot/call-scoring.js","../src/components/enums/deadline-and-ping-selector-background.js","../src/components/content-blocks/todo/deadline-and-ping-selector.js","../src/components/content-blocks/todo/ping-selector.js","../src/components/content-blocks/with-title.js","../src/components/content-blocks/workflow-efficiency.js","../src/components/enums/error-type.js","../src/components/content-blocks/error-block.js","../src/controllers/common-content-blocks.js","../src/components/content-blocks/expandable-list/list-item-button.js","../src/components/content-blocks/expandable-list/list-item.js","../src/components/content-blocks/expandable-list/list.js","../src/controllers/deal-product-list.js","../src/controllers/delivery.js","../src/controllers/document.js","../src/components/content-blocks/mail/contact-list.js","../src/controllers/email.js","../src/components/content-blocks/ecommerce-documents-list.js","../src/controllers/finalsummary.js","../src/controllers/helpdesk.js","../src/components/content-blocks/value-change.js","../src/components/content-blocks/value-change-item.js","../src/controllers/modification.js","../src/controllers/notification.js","../src/components/content-blocks/chat-message.js","../src/controllers/openlines.js","../src/controllers/order-check.js","../src/controllers/payment.js","../src/controllers/repeat-sale.js","../src/controllers/rest-app.js","../src/controllers/salescenter-app.js","../src/controllers/sign-b2e-document.js","../src/controllers/sign-document.js","../src/controllers/message/resend.js","../src/controllers/sms.js","../src/controllers/task.js","../src/controllers/telegram.js","../src/controllers/todo.js","../src/controllers/visit.js","../src/controllers/whatsapp.js","../src/controllers/zoom.js","../src/controller-registry.js"],"sourcesContent":["export const StreamType = {\n\thistory: 0,\n\tscheduled: 1,\n\tpinned: 2,\n}","import { MenuManager } from 'main.popup';\n\nimport { Action } from '../../action';\n\nexport class Menu\n{\n\t#menuOptions = {};\n\t#vueComponent = {};\n\n\tconstructor(vueComponent: Object, menuItems: Array, menuOptions: ?Object)\n\t{\n\t\tthis.#vueComponent = vueComponent;\n\t\tthis.#menuOptions = menuOptions || {};\n\t\tthis.#menuOptions = {\n\t\t\tangle: false,\n\t\t\tcacheable: false,\n\t\t\t...this.#menuOptions,\n\t\t};\n\n\t\tthis.#menuOptions.items = [];\n\t\tfor (const item of menuItems)\n\t\t{\n\t\t\tthis.#menuOptions.items.push(this.createMenuItem(item));\n\t\t}\n\t}\n\n\tgetMenuItems(): Array\n\t{\n\t\treturn this.#menuOptions.items;\n\t}\n\n\tshow(): void\n\t{\n\t\tMenuManager.show(this.#menuOptions);\n\t}\n\n\tcreateMenuItem(item): Object\n\t{\n\t\tif (Object.prototype.hasOwnProperty.call(item, 'delimiter') && item.delimiter)\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: item.title || '',\n\t\t\t\tdelimiter: true,\n\t\t\t};\n\t\t}\n\n\t\tconst result = {\n\t\t\ttext: item.title,\n\t\t\tvalue: item.title,\n\t\t};\n\n\t\tif (item.icon)\n\t\t{\n\t\t\tresult.className = `menu-popup-item-${item.icon}`;\n\t\t}\n\n\t\tif (item.menu)\n\t\t{\n\t\t\tresult.items = [];\n\t\t\tfor (const subItem of Object.values(item.menu.items || {}))\n\t\t\t{\n\t\t\t\tresult.items.push(this.createMenuItem(subItem));\n\t\t\t}\n\t\t}\n\t\telse if (item.action)\n\t\t{\n\t\t\tif (item.action.type === 'redirect')\n\t\t\t{\n\t\t\t\tresult.href = item.action.value;\n\t\t\t}\n\t\t\telse if (item.action.type === 'jsCode')\n\t\t\t{\n\t\t\t\tresult.onclick = item.action.value;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.onclick = () => {\n\t\t\t\t\tvoid this.onMenuItemClick(item);\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tonMenuItemClick(item): void\n\t{\n\t\tconst menu = MenuManager.getCurrentMenu();\n\t\tif (menu)\n\t\t{\n\t\t\tmenu.close();\n\t\t}\n\n\t\tconst action = new Action(item.action);\n\n\t\tvoid action.execute(this.#vueComponent);\n\t}\n\n\tstatic showMenu(vueComponent: Object, menuItems: Array, menuOptions: ?Object): void\n\t{\n\t\tconst menu = new Menu(vueComponent, menuItems, menuOptions);\n\n\t\tmenu.show();\n\t}\n}\n","import { DatetimeConverter } from 'crm.timeline.tools';\nimport { ajax as Ajax, Dom, Type } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\nimport { rest as Rest } from 'rest.client';\nimport { UI } from 'ui.notification';\nimport { Menu } from './components/layout/menu';\nimport { sendData } from 'ui.analytics';\n\ndeclare type AnimationParams = {\n\ttarget: string,\n\ttype: string,\n\tforever: boolean,\n}\n\nconst AnimationTarget = {\n\tblock: 'block',\n\titem: 'item',\n};\n\nconst AnimationType = {\n\tdisable: 'disable',\n\tloader: 'loader',\n};\n\nconst ActionType = {\n\tJS_EVENT: 'jsEvent',\n\tAJAX_ACTION: {\n\t\tSTARTED: 'ajaxActionStarted',\n\t\tFINISHED: 'ajaxActionFinished',\n\t\tFAILED: 'ajaxActionFailed',\n\t},\n\n\tisJsEvent(type: string): boolean\n\t{\n\t\treturn (type === this.JS_EVENT);\n\t},\n\n\tisAjaxAction(type: string): boolean\n\t{\n\t\treturn (\n\t\t\ttype === this.AJAX_ACTION.STARTED\n\t\t\t|| type === this.AJAX_ACTION.FINISHED\n\t\t\t|| type === this.AJAX_ACTION.FAILED\n\t\t);\n\t}\n};\n\nObject.freeze(ActionType.AJAX_ACTION);\nObject.freeze(ActionType);\n\nexport { ActionType };\n\nexport class Action\n{\n\t#type: string = null;\n\t#value: string | Object  = null;\n\t#actionParams: ?Object = null;\n\t#animation: ?AnimationParams = null;\n\t#analytics: ?Object = null;\n\n\tconstructor(params)\n\t{\n\t\tthis.#type = params.type;\n\t\tthis.#value = params.value;\n\t\tthis.#actionParams = params.actionParams;\n\t\tthis.#animation = Type.isPlainObject(params.animation) ? params.animation : null;\n\t\tthis.#analytics = Type.isPlainObject(params.analytics) ? params.analytics : null;\n\t}\n\n\texecute(vueComponent): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (this.isJsEvent())\n\t\t\t{\n\t\t\t\tvueComponent.$Bitrix.eventEmitter.emit('crm:timeline:item:action', {\n\t\t\t\t\taction: this.#value,\n\t\t\t\t\tactionType: ActionType.JS_EVENT,\n\t\t\t\t\tactionData: this.#actionParams,\n\t\t\t\t\tanimationCallbacks: {\n\t\t\t\t\t\tonStart: this.#startAnimation.bind(this, vueComponent),\n\t\t\t\t\t\tonStop: this.#stopAnimation.bind(this, vueComponent),\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.#sendAnalytics();\n\n\t\t\t\tresolve(true);\n\t\t\t}\n\t\t\telse if (this.isJsCode())\n\t\t\t{\n\t\t\t\tthis.#startAnimation(vueComponent);\n\t\t\t\teval(this.#value);\n\t\t\t\tthis.#stopAnimation(vueComponent);\n\t\t\t\tthis.#sendAnalytics();\n\t\t\t\tresolve(true);\n\t\t\t}\n\t\t\telse if (this.isAjaxAction() || this.isAjaxJsonAction())\n\t\t\t{\n\t\t\t\tthis.#startAnimation(vueComponent);\n\t\t\t\tvueComponent.$Bitrix.eventEmitter.emit('crm:timeline:item:action', {\n\t\t\t\t\taction: this.#value,\n\t\t\t\t\tactionType: ActionType.AJAX_ACTION.STARTED,\n\t\t\t\t\tactionData: this.#actionParams,\n\t\t\t\t});\n\n\t\t\t\tconst ajaxConfig = {\n\t\t\t\t\t[this.isAjaxJsonAction() ? 'json' : 'data']: this.#prepareRunActionParams(this.#actionParams),\n\t\t\t\t};\n\t\t\t\tif (this.#analytics)\n\t\t\t\t{\n\t\t\t\t\tajaxConfig.analytics = this.#analytics;\n\t\t\t\t}\n\n\t\t\t\tAjax.runAction(\n\t\t\t\t\tthis.#value,\n\t\t\t\t\tajaxConfig,\n\t\t\t\t).then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tthis.#stopAnimation(vueComponent);\n\t\t\t\t\t\tvueComponent.$Bitrix.eventEmitter.emit('crm:timeline:item:action', {\n\t\t\t\t\t\t\taction: this.#value,\n\t\t\t\t\t\t\tactionType: ActionType.AJAX_ACTION.FINISHED,\n\t\t\t\t\t\t\tactionData: this.#actionParams,\n\t\t\t\t\t\t\tresponse,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tthis.#stopAnimation(vueComponent, true);\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tvueComponent.$Bitrix.eventEmitter.emit('crm:timeline:item:action', {\n\t\t\t\t\t\t\taction: this.#value,\n\t\t\t\t\t\t\tactionType: ActionType.AJAX_ACTION.FAILED,\n\t\t\t\t\t\t\tactionParams: this.#actionParams,\n\t\t\t\t\t\t\tresponse,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (this.isCallRestBatch())\n\t\t\t{\n\t\t\t\tthis.#startAnimation(vueComponent);\n\t\t\t\tvueComponent.$Bitrix.eventEmitter.emit('crm:timeline:item:action', {\n\t\t\t\t\taction: this.#value,\n\t\t\t\t\tactionType: 'ajaxActionStarted',\n\t\t\t\t\tactionData: this.#actionParams,\n\t\t\t\t});\n\t\t\t\tRest.callBatch(\n\t\t\t\t\tthis.#prepareCallBatchParams(this.#actionParams),\n\t\t\t\t\t(restResult) => {\n\t\t\t\t\t\tfor (const result in restResult)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst response = restResult[result].answer;\n\t\t\t\t\t\t\tif (response.error)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.#stopAnimation(vueComponent);\n\t\t\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\t\t\tcontent: response.error.error_description,\n\t\t\t\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tvueComponent.$Bitrix.eventEmitter.emit('crm:timeline:item:action', {\n\t\t\t\t\t\t\t\t\taction: this.#value,\n\t\t\t\t\t\t\t\t\tactionType: 'ajaxActionFailed',\n\t\t\t\t\t\t\t\t\tactionParams: this.#actionParams,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\treject(restResult);\n\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.#stopAnimation(vueComponent);\n\t\t\t\t\t\tvueComponent.$Bitrix.eventEmitter.emit('crm:timeline:item:action', {\n\t\t\t\t\t\t\taction: this.#value,\n\t\t\t\t\t\t\tactionType: 'ajaxActionFinished',\n\t\t\t\t\t\t\tactionData: this.#actionParams,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tresolve(restResult);\n\t\t\t\t\t},\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\t\t\telse if (this.isRedirect())\n\t\t\t{\n\t\t\t\tthis.#startAnimation(vueComponent);\n\n\t\t\t\tconst linkAttrs = {\n\t\t\t\t\thref: this.#value,\n\t\t\t\t};\n\t\t\t\tif (this.#actionParams && this.#actionParams.target)\n\t\t\t\t{\n\t\t\t\t\tlinkAttrs.target = this.#actionParams.target;\n\t\t\t\t}\n\t\t\t\t// this magic allows auto opening internal links in slider if possible:\n\t\t\t\tconst link = Dom.create('a', {\n\t\t\t\t\tattrs: linkAttrs,\n\t\t\t\t\ttext: '',\n\t\t\t\t\tstyle: {\n\t\t\t\t\t\tdisplay: 'none',\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tDom.append(link, document.body);\n\t\t\t\tlink.click();\n\t\t\t\tsetTimeout(() => Dom.remove(link), 10);\n\n\t\t\t\tthis.#sendAnalytics();\n\n\t\t\t\tresolve(this.#value);\n\t\t\t}\n\t\t\telse if (this.isShowMenu())\n\t\t\t{\n\t\t\t\tMenu.showMenu(\n\t\t\t\t\tvueComponent,\n\t\t\t\t\tthis.#prepareMenuItems(this.#value.items, vueComponent),\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'actionMenu',\n\t\t\t\t\t\tbindElement: vueComponent.$el,\n\t\t\t\t\t\tminWidth: vueComponent.$el.offsetWidth,\n\t\t\t\t\t}\n\t\t\t\t);\n\n\t\t\t\tthis.#sendAnalytics();\n\n\t\t\t\tresolve(true);\n\t\t\t}\n\t\t\telse if (this.isShowInfoHelper())\n\t\t\t{\n\t\t\t\tBX.UI.InfoHelper?.show(this.#value);\n\n\t\t\t\tthis.#sendAnalytics();\n\n\t\t\t\tresolve(true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\treject(false);\n\t\t\t}\n\t\t});\n\t}\n\n\tisJsEvent(): boolean\n\t{\n\t\treturn (this.#type === 'jsEvent');\n\t}\n\n\tisJsCode(): boolean\n\t{\n\t\treturn (this.#type === 'jsCode');\n\t}\n\n\tisAjaxAction(): boolean\n\t{\n\t\treturn (this.#type === 'runAjaxAction');\n\t}\n\n\tisAjaxJsonAction(): boolean\n\t{\n\t\treturn (this.#type === 'runAjaxJsonAction');\n\t}\n\n\tisCallRestBatch(): boolean\n\t{\n\t\treturn (this.#type === 'callRestBatch');\n\t}\n\n\tisRedirect(): boolean\n\t{\n\t\treturn (this.#type === 'redirect');\n\t}\n\n\tisShowInfoHelper(): boolean\n\t{\n\t\treturn (this.#type === 'showInfoHelper');\n\t}\n\n\tisShowMenu(): boolean\n\t{\n\t\treturn (this.#type === 'showMenu');\n\t}\n\n\tgetValue(): string | Object\n\t{\n\t\treturn this.#value;\n\t}\n\n\tgetActionParam(param: string)\n\t{\n\t\treturn this.#actionParams && this.#actionParams.hasOwnProperty(param)\n\t\t\t? this.#actionParams[param]\n\t\t\t: null\n\t\t;\n\t}\n\n\t#prepareRunActionParams(params): Object\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isUndefined(params))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\t\tfor (const paramName in params)\n\t\t{\n\t\t\tconst paramValue = params[paramName];\n\t\t\tif (Type.isDate(paramValue))\n\t\t\t{\n\t\t\t\tresult[paramName] = DateTimeFormat.format(DatetimeConverter.getSiteDateTimeFormat(), paramValue);\n\t\t\t}\n\t\t\telse if (Type.isPlainObject(paramValue))\n\t\t\t{\n\t\t\t\tresult[paramName] = this.#prepareRunActionParams(paramValue);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult[paramName] = paramValue;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#prepareCallBatchParams(params): Object\n\t{\n\t\tconst result = {};\n\n\t\tif (Type.isUndefined(params))\n\t\t{\n\t\t\treturn result;\n\t\t}\n\n\t\tfor (const paramName in params)\n\t\t{\n\t\t\tresult[paramName] = {\n\t\t\t\tmethod: params[paramName].method,\n\t\t\t\tparams: this.#prepareRunActionParams(params[paramName].params)\n\t\t\t};\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#prepareMenuItems(items: Object, vueComponent: Object): Array\n\t{\n\t\treturn Object.values(items)\n\t\t\t.filter((item) => (item.state !== 'hidden' && item.scope !== 'mobile' && (!vueComponent.isReadOnly || !item.hideIfReadonly)))\n\t\t\t.sort((a, b) => (a.sort - b.sort))\n\t\t;\n\t}\n\n\t#startAnimation(vueComponent)\n\t{\n\t\tif (!this.#isAnimationValid())\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.#animation.target === AnimationTarget.item)\n\t\t{\n\t\t\tif (this.#animation.type === AnimationType.disable)\n\t\t\t{\n\t\t\t\tvueComponent.$root.setFaded(true);\n\t\t\t}\n\t\t\tif (this.#animation.type === AnimationType.loader)\n\t\t\t{\n\t\t\t\tvueComponent.$root.showLoader(true);\n\t\t\t}\n\t\t}\n\t\tif (this.#animation.target === AnimationTarget.block)\n\t\t{\n\t\t\tif (this.#animation.type === AnimationType.disable)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(vueComponent.setDisabled))\n\t\t\t\t{\n\t\t\t\t\tvueComponent.setDisabled(true);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.#animation.type === AnimationType.loader)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(vueComponent.setLoading))\n\t\t\t\t{\n\t\t\t\t\tvueComponent.setLoading(true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t#stopAnimation(vueComponent, force = false)\n\t{\n\t\tif (!this.#isAnimationValid())\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (this.#animation.forever && !force)\n\t\t{\n\t\t\treturn; // should not be stopped\n\t\t}\n\n\t\tif (this.#animation.target === AnimationTarget.item)\n\t\t{\n\t\t\tif (this.#animation.type === AnimationType.disable)\n\t\t\t{\n\t\t\t\tvueComponent.$root.setFaded(false);\n\t\t\t}\n\t\t\tif (this.#animation.type === AnimationType.loader)\n\t\t\t{\n\t\t\t\tvueComponent.$root.showLoader(false);\n\t\t\t}\n\t\t}\n\t\tif (this.#animation.target === AnimationTarget.block)\n\t\t{\n\t\t\tif (this.#animation.type === AnimationType.disable)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(vueComponent.setDisabled))\n\t\t\t\t{\n\t\t\t\t\tvueComponent.setDisabled(false);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.#animation.type === AnimationType.loader)\n\t\t\t{\n\t\t\t\tif (Type.isFunction(vueComponent.setLoading))\n\t\t\t\t{\n\t\t\t\t\tvueComponent.setLoading(false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t#isAnimationValid(): boolean\n\t{\n\t\tif (!this.#animation)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!AnimationTarget.hasOwnProperty(this.#animation.target))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn AnimationType.hasOwnProperty(this.#animation.type);\n\t}\n\n\t#sendAnalytics()\n\t{\n\t\tif (this.#analytics && this.#analytics.hit)\n\t\t{\n\t\t\tconst clonedAnalytics = {...this.#analytics};\n\t\t\tdelete clonedAnalytics.hit;\n\n\t\t\tsendData(clonedAnalytics);\n\t\t}\n\t}\n}\n","import {Action} from \"../../../action\";\nimport {Text} from \"main.core\";\n\nexport const Logo = {\n\tprops: {\n\t\ttype: String,\n\t\taddIcon: String,\n\t\taddIconType: String,\n\t\ticon: String,\n\t\ticonType: String,\n\t\tbackgroundUrl: String,\n\t\tbackgroundSize: Number,\n\t\tinCircle: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\taction: Object,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tcurrentIcon: this.icon,\n\t\t}\n\t},\n\tcomputed: {\n\t\tclassName(): string\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-logo',\n\t\t\t\t`--${this.type}`, {\n\t\t\t\t'--clickable': this.action,\n\t\t\t\t}\n\t\t\t];\n\t\t},\n\n\t\ticonClassname()\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-logo_icon',\n\t\t\t\t`--${this.currentIcon}`,\n\t\t\t\t{\n\t\t\t\t\t'--in-circle': this.inCircle,\n\t\t\t\t\t[`--type-${this.iconType}`]: !!this.iconType && !this.backgroundUrl,\n\t\t\t\t\t'--custom-bg': !!this.backgroundUrl,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\n\t\taddIconClassname() {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-logo_add-icon',\n\t\t\t\t`--type-${this.addIconType}`,\n\t\t\t\t`--icon-${this.addIcon}`\n\t\t\t]\n\t\t},\n\n\t\ticonInteriorStyle()\n\t\t{\n\t\t\tconst result = {};\n\n\t\t\tif (this.backgroundUrl)\n\t\t\t{\n\t\t\t\tresult.backgroundImage = 'url(' + encodeURI(Text.encode(this.backgroundUrl)) + ')';\n\t\t\t}\n\n\t\t\tif (this.backgroundSize)\n\t\t\t{\n\t\t\t\tresult.backgroundSize = parseInt(this.backgroundSize) + 'px';\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\t},\n\twatch: {\n\t\ticon(newIcon): void\n\t\t{\n\t\t\tthis.currentIcon = newIcon;\n\t\t}\n\t},\n\tmethods: {\n\t\texecuteAction() {\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst action = new Action(this.action);\n\t\t\taction.execute(this);\n\t\t},\n\t\tsetIcon(icon: String) {\n\t\t\tthis.currentIcon = icon;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div :class=\"className\" @click=\"executeAction\">\n\t\t\t<div class=\"crm-timeline__card-logo_content\">\n\t\t\t\t<div :class=\"iconClassname\">\n\t\t\t\t\t<i :style=\"iconInteriorStyle\"></i>\n\t\t\t\t</div>\n\t\t\t\t<div :class=\"addIconClassname\" v-if=\"addIcon\">\n\t\t\t\t\t<i></i>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n","import { DatetimeConverter } from 'crm.timeline.tools';\nimport { DateTimeFormat } from 'main.date';\n\nexport const CalendarIcon = {\n\tprops: {\n\t\ttimestamp: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t\tdefault: 0,\n\t\t},\n\t\tcalendarEventId: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tdate(): string\n\t\t{\n\t\t\treturn this.formatUserTime('d');\n\t\t},\n\t\tmonth(): string\n\t\t{\n\t\t\treturn this.formatUserTime('F');\n\t\t},\n\t\tdayWeek(): string\n\t\t{\n\t\t\tconst dayShortName = this.formatUserTime('D');\n\t\t\tif (this.time.length > 5) // \"12:34\".length === 5, if +\" PM\" than > 5\n\t\t\t{\n\t\t\t\treturn dayShortName.slice(0, 2);\n\t\t\t}\n\n\t\t\treturn dayShortName;\n\t\t},\n\t\ttime(): string\n\t\t{\n\t\t\treturn this.getDateTimeConverter().toTimeString();\n\t\t},\n\t\tuserTime(): Date\n\t\t{\n\t\t\treturn this.getDateTimeConverter().getValue();\n\t\t},\n\t\thasCalendarEventId(): boolean\n\t\t{\n\t\t\treturn (this.calendarEventId > 0);\n\t\t},\n\t},\n\n\tmethods: {\n\t\tgetDateTimeConverter(): DatetimeConverter\n\t\t{\n\t\t\treturn DatetimeConverter.createFromServerTimestamp(this.timestamp).toUserTime();\n\t\t},\n\t\tformatUserTime(format: string): string\n\t\t{\n\t\t\treturn DateTimeFormat.format(format, this.userTime);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"crm-timeline__calendar-icon-container\">\n\t\t\t<div v-if=\"hasCalendarEventId\" class=\"crm-timeline__calendar-icon_event_icon\"></div>\n\t\t\t<div class=\"crm-timeline__calendar-icon\">\n\t\t\t\t<header class=\"crm-timeline__calendar-icon_top\">\n\t\t\t\t\t<div class=\"crm-timeline__calendar-icon_bullets\">\n\t\t\t\t\t\t<div class=\"crm-timeline__calendar-icon_bullet\"></div>\n\t\t\t\t\t\t<div class=\"crm-timeline__calendar-icon_bullet\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\t\t\t\t<main class=\"crm-timeline__calendar-icon_content\">\n\t\t\t\t\t<div class=\"crm-timeline__calendar-icon_day\">{{ date }}</div>\n\t\t\t\t\t<div class=\"crm-timeline__calendar-icon_month\">{{ month }}</div>\n\t\t\t\t\t<div class=\"crm-timeline__calendar-icon_date\">\n\t\t\t\t\t\t<span class=\"crm-timeline__calendar-icon_day-week\">{{ dayWeek }}</span>\n\t\t\t\t\t\t<span class=\"crm-timeline__calendar-icon_time\">{{ time }}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</main>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Text, Type } from 'main.core';\nimport { BitrixVue } from 'ui.vue3';\nimport { CalendarIcon } from './calendar-icon';\n\nimport { Logo } from './logo';\n\nexport const LogoCalendar = BitrixVue.cloneComponent(Logo, {\n\tcomponents: {\n\t\tCalendarIcon,\n\t},\n\n\tprops: {\n\t\ttimestamp: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: 0,\n\t\t},\n\t\taddIcon: String,\n\t\taddIconType: String,\n\t\tcalendarEventId: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tbackgroundColor: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tcomputed: {\n\t\taddIconClassname(): string[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-logo_add-icon',\n\t\t\t\t`--type-${this.addIconType}`,\n\t\t\t\t`--icon-${this.addIcon}`,\n\t\t\t];\n\t\t},\n\t\tlogoStyle(): Object\n\t\t{\n\t\t\tif (Type.isStringFilled(this.backgroundColor))\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\t'--crm-timeline__logo-background': Text.encode(this.backgroundColor),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {};\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div \n\t\t\t:class=\"className\"\n\t\t\t:style=\"logoStyle\"\n\t\t\t@click=\"executeAction\"\n\t\t>\n\t\t\t<div class=\"crm-timeline__card-logo_content\">\n\t\t\t\t<CalendarIcon :timestamp=\"timestamp\" :calendar-event-id=\"calendarEventId\" />\n\t\t\t\t<div :class=\"addIconClassname\" v-if=\"addIcon\">\n\t\t\t\t\t<i></i>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n});\n","import { Type } from 'main.core';\nimport { Logo } from './body/logo';\nimport { LogoCalendar } from './body/logo-calendar';\n\nexport const Body = {\n\tcomponents: {\n\t\tLogo,\n\t\tLogoCalendar,\n\t},\n\tprops: {\n\t\tlogo: Object,\n\t\tblocks: Object,\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tblockRefs: {},\n\t\t}\n\t},\n\tmounted() {\n\t\tconst blocks = this.$refs.blocks;\n\t\tif (!blocks || !this.visibleBlocks)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.visibleBlocks.forEach((block, index) => {\n\t\t\tif (Type.isDomNode(blocks[index].$el))\n\t\t\t{\n\t\t\t\tblocks[index].$el.setAttribute('data-id', block.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthrow new Error('Vue component \"' + block.rendererName + '\" was not found');\n\t\t\t}\n\t\t});\n\t},\n\tbeforeUpdate() {\n\t\tthis.blockRefs = {};\n\t},\n\tcomputed: {\n\t\tvisibleBlocks(): Array\n\t\t{\n\t\t\tif (!Type.isPlainObject(this.blocks))\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn Object.keys(this.blocks)\n\t\t\t\t.map((id) => ({id, ...this.blocks[id]}))\n\t\t\t\t.filter((item) => (item.scope !== 'mobile'))\n\t\t\t\t.sort((a, b) => {\n\t\t\t\t\tlet aSort = a.sort === undefined ? 0 : a.sort\n\t\t\t\t\tlet bSort = b.sort === undefined ? 0 : b.sort\n\n\t\t\t\t\tif (aSort < bSort) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t\tif (aSort > bSort) {\n\t\t\t\t\t\treturn  1;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn 0\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tcontentContainerClassname(): Array {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-container', {\n\t\t\t\t'--without-logo': !this.logo,\n\t\t\t\t}\n\t\t\t];\n\t\t}\n\t},\n\tmethods: {\n\t\tgetContentBlockById(blockId: string): ?Object\n\t\t{\n\t\t\treturn this.blockRefs[blockId] ?? null;\n\t\t},\n\t\tgetLogo(): ?Object\n\t\t{\n\t\t\treturn this.$refs.logo;\n\t\t},\n\t\tsaveRef(ref: Object, id: string): void\n\t\t{\n\t\t\tthis.blockRefs[id] = ref;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"crm-timeline__card-body\">\n\t\t\t<div v-if=\"logo\" class=\"crm-timeline__card-logo_container\">\n\t\t\t\t<LogoCalendar v-if=\"logo.icon === 'calendar'\" v-bind=\"logo\"></LogoCalendar>\n\t\t\t\t<Logo v-else v-bind=\"logo\" ref=\"logo\"></Logo>\n\t\t\t</div>\n\t\t\t<div :class=\"contentContainerClassname\">\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"block in visibleBlocks\"\n\t\t\t\t\t:key=\"block.id\"\n\t\t\t\t\tclass=\"crm-timeline__card-container_block\"\n\t\t\t\t>\n\t\t\t\t\t<component\n\t\t\t\t\t\t:is=\"block.rendererName\"\n\t\t\t\t\t\tv-bind=\"block.properties\"\n\t\t\t\t\t\t:ref=\"(el) => this.saveRef(el, block.id)\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n","export class ButtonScope {\n\tstatic MOBILE = 'mobile';\n}","export class ButtonState\n{\n\tstatic DEFAULT = '';\n\tstatic LOADING = 'loading';\n\tstatic DISABLED = 'disabled';\n\tstatic HIDDEN = 'hidden';\n\tstatic LOCKED = 'locked';\n\tstatic AI_LOADING = 'ai-loading';\n\tstatic AI_SUCCESS = 'ai-success';\n}\n","export class ButtonType {\n\tstatic ICON = 'icon';\n\tstatic PRIMARY = 'primary';\n\tstatic SECONDARY = 'secondary';\n\tstatic LIGHT = 'light';\n\tstatic AI = 'ai';\n}","import { Button as UIButton } from 'ui.buttons';\nimport { ButtonState } from '../enums/button-state';\nimport { Action } from '../../action';\n\nexport const BaseButton = {\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\ttooltip: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tstate: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: ButtonState.DEFAULT,\n\t\t},\n\t\tprops: Object,\n\t\taction: Object,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcurrentState: this.state,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\titemStateToButtonStateDict(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t[ButtonState.LOADING]: UIButton.State.WAITING,\n\t\t\t\t[ButtonState.DISABLED]: UIButton.State.DISABLED,\n\t\t\t\t[ButtonState.AI_LOADING]: UIButton.State.AI_WAITING,\n\t\t\t};\n\t\t},\n\t},\n\n\tmethods: {\n\t\tsetDisabled(disabled: boolean): void\n\t\t{\n\t\t\tif (disabled)\n\t\t\t{\n\t\t\t\tthis.setButtonState(ButtonState.DISABLED);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.setButtonState(ButtonState.DEFAULT);\n\t\t\t}\n\t\t},\n\n\t\tsetLoading(loading: boolean): void\n\t\t{\n\t\t\tif (loading)\n\t\t\t{\n\t\t\t\tthis.setButtonState(ButtonState.LOADING);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.setButtonState(ButtonState.DEFAULT);\n\t\t\t}\n\t\t},\n\n\t\tsetButtonState(state): void\n\t\t{\n\t\t\tif (this.currentState !== state)\n\t\t\t{\n\t\t\t\tthis.currentState = state;\n\t\t\t}\n\t\t},\n\n\t\tonLayoutUpdated(): void\n\t\t{\n\t\t\tthis.setButtonState(this.state);\n\t\t},\n\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.action && this.currentState !== ButtonState.DISABLED\n\t\t\t\t&& this.currentState !== ButtonState.LOADING\n\t\t\t\t&& this.currentState !== ButtonState.AI_LOADING\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst action = new Action(this.action);\n\n\t\t\t\taction.execute(this);\n\t\t\t}\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.$Bitrix.eventEmitter.subscribe('layout:updated', this.onLayoutUpdated);\n\t},\n\n\tbeforeUnmount(): void\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('layout:updated', this.onLayoutUpdated);\n\t},\n\n\ttemplate: `<button></button>`,\n};\n","import { Type } from 'main.core';\n\nimport { ButtonState } from '../enums/button-state';\nimport { Menu } from './menu';\n\nexport class ButtonMenu extends Menu\n{\n\tconstructor(vueComponent: Object, menuItems: Array, menuOptions: ?Object)\n\t{\n\t\tsuper(vueComponent, menuItems, menuOptions);\n\n\t\tthis.#applyMenuItems();\n\t}\n\n\t/**\n\t * @override\n\t */\n\tcreateMenuItem(item: Object): Object\n\t{\n\t\tconst result = {\n\t\t\ttext: item.title,\n\t\t\tvalue: item.title,\n\t\t};\n\n\t\tif (Type.isStringFilled(item.state))\n\t\t{\n\t\t\tswitch (item.state)\n\t\t\t{\n\t\t\t\tcase ButtonState.AI_LOADING:\n\t\t\t\t\tresult.className = 'menu-popup-item-ai-loading menu-popup-item-disabled';\n\t\t\t\t\tbreak;\n\t\t\t\tcase ButtonState.AI_SUCCESS:\n\t\t\t\t\tresult.className = 'menu-popup-item-accept menu-popup-item-disabled';\n\t\t\t\t\tbreak;\n\t\t\t\tcase ButtonState.DISABLED:\n\t\t\t\t\tresult.className = 'menu-popup-no-icon menu-popup-item-disabled';\n\t\t\t\t\tbreak;\n\t\t\t\tcase ButtonState.LOCKED:\n\t\t\t\t\tresult.className = 'menu-popup-item-locked';\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tresult.className = '';\n\t\t\t}\n\t\t}\n\n\t\tif (Type.isObject(item.action))\n\t\t{\n\t\t\tif (item.action.type === 'redirect')\n\t\t\t{\n\t\t\t\tresult.href = item.action.value;\n\t\t\t}\n\t\t\telse if (item.action.type === 'jsCode')\n\t\t\t{\n\t\t\t\tresult.onclick = item.action.value;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tresult.onclick = () => {\n\t\t\t\t\tvoid this.onMenuItemClick(item);\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#applyMenuItems(): void\n\t{\n\t\tconst items = this.getMenuItems();\n\t\tif (!items)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst emptyClassItems = items.filter((item: Object) => item.className === '');\n\t\tif (emptyClassItems.length === items.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\titems.forEach((item: Object) => {\n\t\t\tif (item.className === '')\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\titem.className = 'menu-popup-empty-icon';\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic showMenu(vueComponent: Object, menuItems: Array, menuOptions: ?Object): void\n\t{\n\t\tconst menu = new ButtonMenu(vueComponent, menuItems, menuOptions);\n\n\t\tmenu.show();\n\t}\n}\n","import { BitrixVue } from 'ui.vue3';\nimport { Text, Type } from 'main.core';\nimport {\n\tButton as UIButton,\n\tButtonOptions,\n\tButtonState as UIButtonState,\n\tSplitButton as UISplitButton,\n} from 'ui.buttons';\n\nimport { BaseButton } from './baseButton';\nimport { ButtonType } from '../enums/button-type';\nimport { ButtonState } from '../enums/button-state';\nimport { ButtonMenu } from './button-menu';\n\nimport 'ui.hint';\n\nexport const Button = BitrixVue.cloneComponent(BaseButton, {\n\tprops: {\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: ButtonType.SECONDARY,\n\t\t},\n\t\ticonName: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tsize: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: 'extra_small',\n\t\t},\n\t\tmenuItems: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tpopup: null,\n\t\t\tuiButton: Object.freeze(null),\n\t\t\ttimerSecondsRemaining: 0,\n\t\t\tcurrentState: this.state,\n\t\t\thintText: Type.isStringFilled(this.tooltip) ? this.tooltip : '',\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\titemTypeToButtonColorDict(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t[ButtonType.PRIMARY]: UIButton.Color.PRIMARY,\n\t\t\t\t[ButtonType.SECONDARY]: UIButton.Color.LIGHT_BORDER,\n\t\t\t\t[ButtonType.LIGHT]: UIButton.Color.LIGHT,\n\t\t\t\t[ButtonType.ICON]: UIButton.Color.LINK,\n\t\t\t\t[ButtonType.AI]: UIButton.Color.AI,\n\t\t\t};\n\t\t},\n\n\t\tbuttonContainerRef(): HTMLElement | undefined\n\t\t{\n\t\t\treturn this.$refs.buttonContainer;\n\t\t},\n\t},\n\n\tmethods:\n\t{\n\t\tgetButtonOptions(): ButtonOptions\n\t\t{\n\t\t\tconst upperCaseIconName = Type.isString(this.iconName) ? this.iconName.toUpperCase() : '';\n\t\t\tconst upperCaseButtonSize = Type.isString(this.size) ? this.size.toUpperCase() : 'extra_small';\n\t\t\tconst btnColor = this.itemTypeToButtonColorDict[this.type] || UIButton.Color.LIGHT_BORDER;\n\t\t\tconst titleText = this.type === ButtonType.ICON ? '' : this.title;\n\n\t\t\treturn {\n\t\t\t\tid: this.id,\n\t\t\t\tround: true,\n\t\t\t\tdependOnTheme: false,\n\t\t\t\tsize: UIButton.Size[upperCaseButtonSize],\n\t\t\t\ttext: titleText,\n\t\t\t\tcolor: btnColor,\n\t\t\t\tstate: this.itemStateToButtonStateDict[this.currentState],\n\t\t\t\ticon: UIButton.Icon[upperCaseIconName],\n\t\t\t\tprops: Type.isPlainObject(this.props) ? this.props : {},\n\t\t\t};\n\t\t},\n\n\t\tgetUiButton(): ?UIButton\n\t\t{\n\t\t\treturn this.uiButton;\n\t\t},\n\n\t\tdisableWithTimer(sec: number)\n\t\t{\n\t\t\tthis.setButtonState(ButtonState.DISABLED);\n\t\t\tconst btn = this.getUiButton();\n\t\t\tlet remainingSeconds = sec;\n\n\t\t\tbtn.setText(this.formatSeconds(remainingSeconds));\n\n\t\t\tconst timer = setInterval(() => {\n\t\t\t\tif (remainingSeconds < 1)\n\t\t\t\t{\n\t\t\t\t\tclearInterval(timer);\n\t\t\t\t\tbtn.setText(this.title);\n\n\t\t\t\t\tthis.setButtonState(ButtonState.DEFAULT);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tremainingSeconds--;\n\t\t\t\tbtn.setText(this.formatSeconds(remainingSeconds));\n\t\t\t}, 1000);\n\t\t},\n\n\t\tformatSeconds(sec: number): string\n\t\t{\n\t\t\tconst minutes = Math.floor(sec / 60);\n\t\t\tconst seconds = sec % 60;\n\n\t\t\tconst formatMinutes = this.formatNumber(minutes);\n\t\t\tconst formatSeconds = this.formatNumber(seconds);\n\n\t\t\treturn `${formatMinutes}:${formatSeconds}`;\n\t\t},\n\n\t\tformatNumber(num: number): string\n\t\t{\n\t\t\treturn num < 10 ? `0${num}` : num;\n\t\t},\n\n\t\tsetButtonState(state): void\n\t\t{\n\t\t\tthis.parentSetButtonState(state);\n\t\t\tthis.getUiButton()?.setState(this.itemStateToButtonStateDict[this.currentState] ?? null);\n\t\t},\n\n\t\tcreateSplitButton(): UISplitButton\n\t\t{\n\t\t\tconst menuItems = Object.keys(this.menuItems).map((key) => this.menuItems[key]);\n\t\t\tconst options = this.getButtonOptions();\n\t\t\tconst showMenu = () => {\n\t\t\t\tButtonMenu.showMenu(\n\t\t\t\t\tthis,\n\t\t\t\t\tmenuItems,\n\t\t\t\t\t{\n\t\t\t\t\t\tid: `split-button-menu-${this.id}`,\n\t\t\t\t\t\tclassName: 'crm-timeline__split-button-menu',\n\t\t\t\t\t\twidth: 250,\n\t\t\t\t\t\tangle: true,\n\t\t\t\t\t\tcacheable: false,\n\t\t\t\t\t\toffsetLeft: 13,\n\t\t\t\t\t\tbindElement: this.$el.querySelector('.ui-btn-menu'),\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t};\n\n\t\t\toptions.menuButton = {\n\t\t\t\tonclick: (element, event: PointerEvent) => {\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\tshowMenu();\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tif (options.state === UIButtonState.DISABLED)\n\t\t\t{\n\t\t\t\toptions.mainButton = {\n\t\t\t\t\tonclick: (element, event: PointerEvent) => {\n\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\tshowMenu();\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn new UISplitButton(options);\n\t\t},\n\n\t\trenderButton(): void\n\t\t{\n\t\t\tif (!this.buttonContainerRef)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.buttonContainerRef.innerHTML = '';\n\n\t\t\tconst button = this.menuItems\n\t\t\t\t? this.createSplitButton()\n\t\t\t\t: new UIButton(this.getButtonOptions())\n\t\t\t;\n\n\t\t\tbutton.renderTo(this.buttonContainerRef);\n\n\t\t\tthis.uiButton = button;\n\t\t},\n\n\t\tsetTooltip(tooltip: string): void\n\t\t{\n\t\t\tthis.hintText = tooltip;\n\t\t},\n\n\t\tshowTooltip(): void\n\t\t{\n\t\t\tif (this.hintText === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.UI.Hint.show(\n\t\t\t\tthis.$el,\n\t\t\t\tthis.hintText,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t},\n\n\t\thideTooltip(): void\n\t\t{\n\t\t\tif (this.hintText === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.UI.Hint.hide(this.$el);\n\t\t},\n\n\t\tisInViewport(): boolean\n\t\t{\n\t\t\tconst rect = this.$el.getBoundingClientRect();\n\n\t\t\treturn (\n\t\t\t\trect.top >= 0\n\t\t\t\t&& rect.left >= 0\n\t\t\t\t&& rect.bottom <= (window.innerHeight || document.documentElement.clientHeight)\n\t\t\t\t&& rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n\t\t\t);\n\t\t},\n\n\t\tisPropEqual(propName: string, value: any): boolean\n\t\t{\n\t\t\treturn this.getButtonOptions().props[propName] === value;\n\t\t},\n\t},\n\n\twatch: {\n\t\tstate(newValue): void\n\t\t{\n\t\t\tthis.setButtonState(newValue);\n\t\t},\n\n\t\ttooltip(newValue): void\n\t\t{\n\t\t\tthis.hintText = Type.isStringFilled(newValue)\n\t\t\t\t? Text.encode(newValue)\n\t\t\t\t: ''\n\t\t\t;\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.renderButton();\n\t},\n\n\tupdated(): void\n\t{\n\t\tthis.renderButton();\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\t:class=\"$attrs.class\"\n\t\t\tref=\"buttonContainer\"\n\t\t\t@click=\"executeAction\"\n\t\t\t@mouseover=\"showTooltip\"\n\t\t\t@mouseleave=\"hideTooltip\"\n\t\t>\n\t\t</div>\n\t`,\n});\n","import {ButtonState} from \"../../enums/button-state\";\nimport {BitrixVue} from 'ui.vue3';\nimport {BaseButton} from '../baseButton';\nimport {Loader} from 'main.loader';\n\nexport const AdditionalButtonIcon = Object.freeze({\n\tNOTE: 'note',\n\tSCRIPT: 'script',\n\tPRINT: 'print',\n\tDOTS: 'dots',\n});\n\nexport const AdditionalButtonColor = Object.freeze({\n\tDEFAULT: 'default',\n\tPRIMARY: 'primary',\n});\n\nexport const AdditionalButton = BitrixVue.cloneComponent(BaseButton, {\n\tprops: {\n\t\ticonName: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t\tvalidator(value: string): boolean {\n\t\t\t\treturn Object.values(AdditionalButtonIcon).indexOf(value) > -1;\n\t\t\t},\n\t\t},\n\t\tcolor: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: AdditionalButtonColor.DEFAULT,\n\t\t\tvalidator(value: string)\n\t\t\t{\n\t\t\t\treturn Object.values(AdditionalButtonColor).indexOf(value) > -1;\n\t\t\t},\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tclassName(): Array {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card_add-button', {\n\t\t\t\t\t[`--icon-${this.iconName}`]: this.iconName,\n\t\t\t\t\t[`--color-${this.color}`]: this.color,\n\t\t\t\t\t[`--state-${this.currentState}`]: this.currentState,\n\t\t\t\t},\n\t\t\t]\n\t\t},\n\n\t\tButtonState(): ButtonState {\n\t\t\treturn ButtonState;\n\t\t},\n\n\t\tloaderHtml(): string {\n\t\t\tconst loader = new Loader({\n\t\t\t\tmode: 'inline',\n\t\t\t\tsize: 20,\n\t\t\t});\n\n\t\t\tloader.show();\n\t\t\treturn loader.layout.outerHTML;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<transition name=\"crm-timeline__card_add-button-fade\" mode=\"out-in\">\n\t\t\t<div\n\t\t\t\tv-if=\"currentState === ButtonState.LOADING\"\n\t\t\t\tv-html=\"loaderHtml\"\n\t\t\t\tclass=\"crm-timeline__card_add-button\"\n\t\t\t></div>\n\t\t\t<div\n\t\t\t\tv-else\n\t\t\t\t:title=\"title\"\n\t\t\t\t@click=\"executeAction\"\n\t\t\t\t:class=\"className\">\n\t\t\t</div>\n\t\t</transition>\n\t`\n});","import {Button} from '../button';\n\nexport const Buttons = {\n\tcomponents: {\n\t\tButton,\n\t},\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => [],\n\t\t},\n\t},\n\tmethods: {\n\t\tgetButtonById(buttonId: string): ?Object\n\t\t{\n\t\t\tconst buttons = this.$refs.buttons;\n\n\t\t\treturn this.items.reduce((found, button, index) =>\n\t\t\t{\n\t\t\t\tif (found)\n\t\t\t\t{\n\t\t\t\t\treturn found;\n\t\t\t\t}\n\t\t\t\tif (button.id === buttonId)\n\t\t\t\t{\n\t\t\t\t\treturn buttons[index];\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\t\t\t}, null);\n\t\t},\n\t},\n\ttemplate:\n\t\t`\n\t\t\t<div class=\"crm-timeline__card-action_buttons\">\n\t\t\t\t<Button class=\"crm-timeline__card-action-btn\" v-for=\"item in items\" v-bind=\"item\" ref=\"buttons\" />\n\t\t\t</div>\n\t\t`\n};\n","import {MenuManager} from \"main.popup\";\nimport {Menu as LayoutMenu} from \"../../layout/menu\";\nconst MenuId = 'timeline-more-button-menu';\nimport {AdditionalButton, AdditionalButtonColor, AdditionalButtonIcon} from './add-button';\n\nexport const Menu = {\n\tcomponents: {\n\t\tAdditionalButton,\n\t},\n\tprops: {\n\t\tbuttons: Array, // buttons that didn't fit into footer\n\t\titems: Object, // real menu items\n\t},\n\tinject: [\n\t\t'isReadOnly',\n\t],\n\tcomputed: {\n\t\tisMenuFilled(): boolean\n\t\t{\n\t\t\tconst menuItems = this.menuItems;\n\n\t\t\treturn menuItems.length > 0;\n\t\t},\n\n\t\titemsArray(): Array\n\t\t{\n\t\t\tif (!this.items)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn Object.values(this.items)\n\t\t\t\t.filter((item) => (item.state !== 'hidden' && item.scope !== 'mobile' && (!this.isReadOnly || !item.hideIfReadonly)))\n\t\t\t\t.sort((a, b) => (a.sort - b.sort))\n\t\t\t;\n\t\t},\n\n\t\tmenuItems(): Array\n\t\t{\n\t\t\tlet result = this.buttons;\n\t\t\tif (this.buttons.length && this.itemsArray.length)\n\t\t\t{\n\t\t\t\tresult.push({delimiter: true});\n\t\t\t}\n\t\t\tresult = [...result, ...this.itemsArray];\n\n\t\t\treturn result;\n\t\t},\n\n\t\tbuttonProps()\n\t\t{\n\t\t\treturn {\n\t\t\t\tcolor: AdditionalButtonColor.DEFAULT,\n\t\t\t\ticon: AdditionalButtonIcon.DOTS,\n\t\t\t}\n\t\t},\n\t},\n\n\tbeforeUnmount(): void\n\t{\n\t\tconst menu = MenuManager.getMenuById(MenuId);\n\t\tif (menu)\n\t\t{\n\t\t\tmenu.destroy();\n\t\t}\n\t},\n\n\tmethods: {\n\t\tshowMenu(): void\n\t\t{\n\t\t\tLayoutMenu.showMenu(\n\t\t\t\tthis,\n\t\t\t\tthis.menuItems,\n\t\t\t\t{\n\t\t\t\t\tid: MenuId,\n\t\t\t\t\tclassName: 'crm-timeline__card_more-menu',\n\t\t\t\t\twidth: 230,\n\t\t\t\t\tangle: false,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tbindElement: this.$el,\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div v-if=\"isMenuFilled\" class=\"crm-timeline__card-action_menu-item\" @click=\"showMenu\">\n\t\t\t<AdditionalButton iconName=\"dots\" color=\"default\"></AdditionalButton>\n\t\t</div>\n\t`\n};\n","import { Type } from 'main.core';\nimport { ButtonScope } from '../enums/button-scope';\nimport { ButtonState } from '../enums/button-state';\nimport { ButtonType } from '../enums/button-type';\nimport { Button } from './button';\nimport { AdditionalButton } from './footer/add-button';\nimport { Buttons } from './footer/buttons';\nimport { Menu } from './footer/menu';\n\nexport const Footer = {\n\tcomponents: {\n\t\tButtons,\n\t\tMenu,\n\t\tButton,\n\t\tAdditionalButton,\n\t},\n\tprops: {\n\t\tbuttons: Object,\n\t\tmenu: Object,\n\t\tadditionalButtons: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t\tmaxBaseButtonsCount: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: 3,\n\t\t},\n\n\t},\n\tinject: [\n\t\t'isReadOnly',\n\t],\n\tcomputed: {\n\t\tcontainerClassname(): Array {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-action', {\n\t\t\t\t'--no-margin-top': this.baseButtons.length < 1,\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\tbaseButtons(): Array\n\t\t{\n\t\t\treturn this.visibleAndSortedButtons.slice(0, this.maxBaseButtonsCount);\n\t\t},\n\n\t\tmoreButtons(): Array\n\t\t{\n\t\t\treturn this.visibleAndSortedButtons.slice(this.maxBaseButtonsCount);\n\t\t},\n\n\n\t\tvisibleAndSortedButtons() {\n\t\t\treturn this.visibleButtons.sort(this.buttonsSorter);\n\t\t},\n\n\t\tvisibleAndSortedAdditionalButtons() {\n\t\t\treturn this.visibleAdditionalButtons.sort(this.buttonsSorter);\n\t\t},\n\n\t\tvisibleButtons(): Array\n\t\t{\n\t\t\tif (!Type.isPlainObject(this.buttons))\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn this.buttons\n\t\t\t\t?  Object.keys(this.buttons)\n\t\t\t\t\t.map((id) => ({id, ...this.buttons[id]}))\n\t\t\t\t\t.filter(this.visibleButtonsFilter)\n\t\t\t\t: [];\n\t\t},\n\n\t\tvisibleAdditionalButtons(): Array {\n\t\t\treturn this.additionalButtonsArray\n\t\t\t\t? Object.values(this.additionalButtonsArray).filter(this.visibleButtonsFilter)\n\t\t\t\t: [];\n\t\t},\n\n\t\tadditionalButtonsArray() {\n\t\t\treturn Object.entries(this.additionalButtons).map(([id, button]) => {\n\t\t\t\treturn {id, type: ButtonType.ICON, ...button};\n\t\t\t});\n\t\t},\n\n\t\thasMenu(): boolean\n\t\t{\n\t\t\treturn this.moreButtons.length || (Type.isPlainObject(this.menu) && Object.keys(this.menu).length);\n\t\t},\n\t},\n\tmethods: {\n\t\tvisibleButtonsFilter(buttonItem) {\n\t\t\treturn buttonItem.state !== ButtonState.HIDDEN\n\t\t\t\t&& buttonItem.scope !== ButtonScope.MOBILE\n\t\t\t\t&& (!this.isReadOnly || !buttonItem.hideIfReadonly);\n\t\t},\n\n\t\tbuttonsSorter(buttonA, buttonB) {\n\t\t\treturn buttonA?.sort - buttonB?.sort;\n\t\t},\n\n\t\tgetButtonById(buttonId: string): ?Object\n\t\t{\n\t\t\tif (this.$refs.buttons)\n\t\t\t{\n\t\t\t\tconst foundButton = this.$refs.buttons.getButtonById(buttonId);\n\t\t\t\tif (foundButton)\n\t\t\t\t{\n\t\t\t\t\treturn foundButton;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.$refs.additionalButtons)\n\t\t\t{\n\t\t\t\treturn this.visibleAndSortedAdditionalButtons.reduce((found, button, index) =>\n\t\t\t\t{\n\t\t\t\t\tif (found)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn found;\n\t\t\t\t\t}\n\t\t\t\t\tif (button.id === buttonId)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn buttons[index];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn null;\n\t\t\t\t}, null);\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tgetMenu(): ?Object\n\t\t{\n\t\t\tif (this.$refs.menu)\n\t\t\t{\n\t\t\t\treturn this.$refs.menu;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div :class=\"containerClassname\">\n\t\t\t<div class=\"crm-timeline__card-action_menu\">\n\t\t\t\t<div\n\t\t\t\t\tv-for=\"button in visibleAndSortedAdditionalButtons\"\n\t\t\t\t\t:key=\"button.id\"\n\t\t\t\t\tclass=\"crm-timeline__card-action_menu-item\"\n\t\t\t\t>\n\t\t\t\t\t<additional-button\n\t\t\t\t\t\tv-bind=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t</additional-button>\n\t\t\t\t</div>\n\t\t\t\t<Menu v-if=\"hasMenu\" :buttons=\"moreButtons\" v-bind=\"menu\" ref=\"menu\"/>\n\t\t\t</div>\n\t\t\t<Buttons ref=\"buttons\" :items=\"baseButtons\" />\n\t\t</div>\n\t`\n};\n","import { Action } from \"../../../action\";\n\nexport const ChangeStreamButton = {\n\tprops: {\n\t\tdisableIfReadonly: Boolean,\n\t\ttype: String,\n\t\ttitle: String,\n\t\taction: Object,\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisReadonlyMode: false,\n\t\t\tisComplete: false,\n\t\t}\n\t},\n\tinject: [\n\t\t'isReadOnly',\n\t],\n\tmounted()\n\t{\n\t\tthis.isReadonlyMode = this.isReadOnly;\n\t},\n\tcomputed: {\n\t\tisShowPinButton() {\n\t\t\treturn this.type === 'pin' && !this.isReadonlyMode;\n\t\t},\n\n\t\tisShowUnpinButton() {\n\t\t\treturn this.type==='unpin' && !this.isReadonlyMode;\n\t\t},\n\t},\n\tmethods: {\n\t\texecuteAction() {\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isComplete = true;\n\n\t\t\tconst action = new Action(this.action);\n\t\t\taction.execute(this)\n\t\t\t\t.then(() => {})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.isComplete = false;\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tonClick(): void\n\t\t{\n\t\t\tif (this.action)\n\t\t\t{\n\t\t\t\tconst action = new Action(this.action);\n\t\t\t\taction.execute(this);\n\t\t\t}\n\t\t},\n\t\tsetDisabled(disabled: boolean)\n\t\t{\n\t\t\tif (!this.isReadonly && !disabled)\n\t\t\t{\n\t\t\t\tthis.isReadonlyMode = false;\n\t\t\t}\n\t\t\tif (disabled)\n\t\t\t{\n\t\t\t\tthis.isReadonlyMode = true;\n\t\t\t}\n\t\t},\n\t\tmarkCheckboxUnchecked(): void\n\t\t{\n\t\t\tthis.isComplete = false;\n\t\t}\n\t},\n\n\ttemplate: `\n\t\t<div class=\"crm-timeline__card-top_controller\">\n\t\t\t<input\n\t\t\t\tv-if=\"type === 'complete'\"\n\t\t\t\t@click=\"executeAction\"\n\t\t\t\ttype=\"checkbox\"\n\t\t\t\t:disabled=\"isReadonlyMode\"\n\t\t\t\t:checked=\"isComplete\"\n\t\t\t\tclass=\"crm-timeline__card-top_checkbox\"\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tv-else-if=\"isShowPinButton\"\n\t\t\t\t:title=\"title\"\n\t\t\t\t@click=\"executeAction\"\n\t\t\t\tclass=\"crm-timeline__card-top_icon --pin\"\n\t\t\t></div>\n\t\t\t<div\n\t\t\t\tv-else-if=\"isShowUnpinButton\"\n\t\t\t\t:title=\"title\"\n\t\t\t\t@click=\"executeAction\"\n\t\t\t\tclass=\"crm-timeline__card-top_icon --unpin\"\n\t\t\t></div>\n\t\t</div>\n\t`,\n};\n","import { ColorSelector as ColorSelectorPopup, ColorSelectorEvents } from 'crm.field.color-selector';\nimport { EventEmitter } from 'main.core.events';\nimport { hint } from 'ui.vue3.directives.hint';\nimport { Action } from '../../../action';\n\nexport const ColorSelector = {\n\tdirectives: { hint },\n\n\tprops: {\n\t\tvaluesList: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tselectedValueId: {\n\t\t\ttype: String,\n\t\t\tdefault: 'default',\n\t\t},\n\t\treadOnlyMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcurrentValueId: this.selectedValueId,\n\t\t};\n\t},\n\n\tmethods: {\n\t\tgetValue(): Array\n\t\t{\n\t\t\treturn this.currentValueId;\n\t\t},\n\t\tsetValue(value: string): void\n\t\t{\n\t\t\tthis.currentValueId = value;\n\n\t\t\tif (this.itemSelector)\n\t\t\t{\n\t\t\t\tthis.itemSelector.setValue(value);\n\t\t\t}\n\t\t},\n\t\tonItemSelectorValueChange({ data }): void\n\t\t{\n\t\t\tconst valueId = data.value;\n\n\t\t\tif (this.currentValueId !== valueId)\n\t\t\t{\n\t\t\t\tthis.currentValueId = valueId;\n\n\t\t\t\tthis.emitEvent('ColorSelector:Change', { colorId: valueId });\n\t\t\t}\n\t\t},\n\n\t\temitEvent(eventName: string, actionParams: Object): void\n\t\t{\n\t\t\tconst action = new Action({\n\t\t\t\ttype: 'jsEvent',\n\t\t\t\tvalue: eventName,\n\t\t\t\tactionParams,\n\t\t\t});\n\n\t\t\taction.execute(this);\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tvoid this.$nextTick(() => {\n\t\t\tthis.itemSelector = new ColorSelectorPopup({\n\t\t\t\ttarget: this.$refs.itemSelectorRef,\n\t\t\t\tcolorList: this.valuesList,\n\t\t\t\tselectedColorId: this.currentValueId,\n\t\t\t\treadOnlyMode: this.readOnlyMode,\n\t\t\t});\n\n\t\t\tif (!this.readOnlyMode)\n\t\t\t{\n\t\t\t\tEventEmitter.subscribe(\n\t\t\t\t\tthis.itemSelector,\n\t\t\t\t\tColorSelectorEvents.EVENT_COLORSELECTOR_VALUE_CHANGE,\n\t\t\t\t\tthis.onItemSelectorValueChange,\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t},\n\n\tcomputed: {\n\t\thint(): ?Object\n\t\t{\n\t\t\tif (this.readOnlyMode)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('CRM_ACTIVITY_TODO_COLOR_SELECTOR_HINT'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tangle: {\n\t\t\t\t\t\toffset: 30,\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t\toffsetTop: 2,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"crm-activity__todo-editor-v2_color-selector\">\n\t\t\t<div ref=\"itemSelectorRef\" v-hint=\"hint\"></div>\n\t\t</div>\n\t`,\n};\n","import { DatetimeConverter } from 'crm.timeline.tools';\n\nexport const FormatDate = {\n\tname: 'FormatDate',\n\tprops: {\n\t\ttimestamp: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t\tdefault: 0,\n\t\t},\n\n\t\tdatePlaceholder: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\n\t\tuseShortTimeFormat: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\n\t\tclass: {\n\t\t\ttype: [Array, Object, String],\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t}\n\t},\n\tcomputed: {\n\t\tformattedDate() {\n\t\t\tif (!this.timestamp)\n\t\t\t{\n\t\t\t\treturn this.datePlaceholder;\n\t\t\t}\n\t\t\tconst converter = DatetimeConverter.createFromServerTimestamp(this.timestamp).toUserTime();\n\n\t\t\treturn this.useShortTimeFormat ? converter.toTimeString() : converter.toDatetimeString({delimiter: ', '});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div :class=\"$props.class\">{{ formattedDate }}</div>\n\t`\n}","import { Popup, PopupOptions } from 'main.popup';\nimport {Event, Runtime, Dom} from 'main.core';\nimport { Action } from '../../../action';\n\nexport const Hint = {\n\tdata(): Object {\n\t\treturn {\n\t\t\tisMouseOnHintArea: false,\n\t\t\thintPopup: null,\n\t\t}\n\t},\n\tprops: {\n\t\ticon: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\ttextBlocks: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\tcomputed: {\n\t\thintContentIcon(): ?HTMLElement {\n\t\t\tif (this.icon === '')\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst iconElement = Dom.create('i');\n\n\t\t\treturn Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassname: this.hintContentIconClassname,\n\t\t\t\t},\n\t\t\t\tchildren: [iconElement],\n\t\t\t});\n\t\t},\n\n\t\thintContentText(): HTMLElement {\n\t\t\treturn Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassname: 'crm-timeline__hint_popup-content-text',\n\t\t\t\t},\n\t\t\t\tchildren: this.hintContentTextBlocks,\n\t\t\t});\n\t\t},\n\n\t\thintContentTextBlocks(): HTMLElement[] {\n\t\t\treturn this.textBlocks.map(this.getContentBlockNode);\n\t\t},\n\n\t\thintContentIconClassname(): string {\n\t\t\tconst baseClassname = 'crm-timeline__hint_popup-content-icon';\n\t\t\treturn `${baseClassname} --${this.icon}`;\n\t\t},\n\n\t\thintIconClassname(): Array {\n\t\t\treturn [\n\t\t\t\t'ui-hint',\n\t\t\t\t'crm-timeline__header-hint', {\n\t\t\t\t'--active': this.hintPopup,\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\n\t\thasContent(): boolean {\n\t\t\treturn this.textBlocks.length > 0;\n\t\t},\n\t},\n\tmethods: {\n\t\tgetHintContent(): HTMLElement {\n\t\t\treturn Dom.create('div', {\n\t\t\t\tattrs: {\n\t\t\t\t\tclassname: 'crm-timeline__hint_popup-content'\n\t\t\t\t},\n\t\t\t\tstyle: {\n\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t},\n\t\t\t\tchildren: [this.hintContentIcon, this.hintContentText],\n\t\t\t});\n\t\t},\n\n\t\tgetPopupOptions(): PopupOptions {\n\t\t\treturn {\n\t\t\t\tdarkMode: true,\n\t\t\t\tautoHide: false,\n\t\t\t\tcontent: this.getHintContent(),\n\t\t\t\tmaxWidth: 400,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t}\n\t\t},\n\n\t\tgetPopupPosition(): {left: number, right: number} {\n\t\t\tconst hintElem = this.$refs.hint;\n\t\t\tconst defaultAngleLeftOffset = Popup.getOption('angleLeftOffset');\n\t\t\tconst { width: hintWidth, left: hintLeftOffset, top: hintTopOffset } = Dom.getPosition(hintElem);\n\t\t\tconst { width: popupWidth } = Dom.getPosition(this.hintPopup?.getPopupContainer());\n\t\t\treturn {\n\t\t\t\tleft: hintLeftOffset + defaultAngleLeftOffset - (popupWidth - hintWidth) / 2,\n\t\t\t\ttop: hintTopOffset + 15,\n\t\t\t}\n\t\t},\n\n\t\tgetPopupAngleOffset(popupContainer: HTMLElement): number {\n\t\t\tconst angleWidth = 33;\n\t\t\tconst { width: popupWidth } = Dom.getPosition(popupContainer);\n\t\t\treturn (popupWidth - angleWidth) / 2;\n\t\t},\n\n\t\tonMouseEnterToPopup(): void {\n\t\t\tthis.isMouseOnHintArea = true;\n\t\t},\n\n\t\tonHintAreaMouseLeave(): void {\n\t\t\tthis.isMouseOnHintArea = false;\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (!this.isMouseOnHintArea)\n\t\t\t\t{\n\t\t\t\t\tthis.hideHintPopup();\n\t\t\t\t}\n\t\t\t}, 400);\n\t\t},\n\n\t\tonMouseEnterToHint(): void {\n\t\t\tthis.isMouseOnHintArea = true;\n\t\t\tthis.showHintPopupWithDebounce();\n\t\t},\n\n\t\tshowHintPopup(): void {\n\t\t\tif (!this.isMouseOnHintArea || this.hintPopup && this.hintPopup.isShown())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.hintPopup = new Popup(this.getPopupOptions());\n\t\t\tconst popupContainer = this.hintPopup.getPopupContainer();\n\t\t\tEvent.bind(popupContainer, 'mouseenter', this.onMouseEnterToPopup);\n\t\t\tEvent.bind(popupContainer, 'mouseleave', this.onHintAreaMouseLeave);\n\t\t\tthis.hintPopup.show();\n\t\t\tthis.hintPopup.setBindElement(this.getPopupPosition());\n\t\t\tthis.hintPopup.setAngle(false);\n\t\t\tthis.hintPopup.setAngle({offset: this.getPopupAngleOffset(popupContainer, this.$refs.hint)});\n\t\t\tthis.hintPopup.adjustPosition();\n\t\t\tthis.hintPopup.show();\n\t\t},\n\n\t\tshowHintPopupWithDebounce() {\n\t\t\tRuntime.debounce(this.showHintPopup, 300, this)();\n\t\t},\n\n\t\thideHintPopup(): void {\n\t\t\tif (!this.hintPopup)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.hintPopup.close();\n\t\t\tconst popupContainer = this.hintPopup.getPopupContainer();\n\t\t\tEvent.unbind(popupContainer, 'mouseenter', this.onMouseEnterToPopup);\n\t\t\tEvent.unbind(popupContainer, 'mouseleave', this.onHintAreaMouseLeave);\n\t\t\tthis.hintPopup.destroy();\n\t\t\tthis.hintPopup = null;\n\t\t},\n\n\t\thideHintPopupWithDebounce(): void {\n\t\t\treturn Runtime.debounce(this.hideHintPopup, 300, this);\n\t\t},\n\n\t\tgetContentBlockNode(contentBlock): HTMLElement | null {\n\t\t\tif (contentBlock.type === 'text')\n\t\t\t{\n\t\t\t\treturn this.getTextNode(contentBlock.options);\n\t\t\t}\n\t\t\telse if (contentBlock.type === 'link')\n\t\t\t{\n\t\t\t\treturn this.getLinkNode(contentBlock.options);\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tgetTextNode(textOptions = {}): HTMLElement {\n\t\t\treturn Dom.create('span', {text: textOptions.text});\n\t\t},\n\n\t\tgetLinkNode(linkOptions = {}): HTMLElement {\n\t\t\tconst link = Dom.create('span', {text: linkOptions.text});\n\t\t\tDom.addClass(link, 'crm-timeline__hint_popup-content-link');\n\t\t\tlink.onclick = () => {\n\t\t\t\tthis.executeAction(linkOptions.action);\n\t\t\t}\n\n\t\t\treturn link;\n\t\t},\n\n\t\texecuteAction(actionObj): void {\n\t\t\tif (actionObj)\n\t\t\t{\n\t\t\t\tconst action = new Action(actionObj);\n\t\t\t\taction.execute(this);\n\t\t\t}\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<span\n\t\t\tref=\"hint\"\n\t\t\t@click.stop.prevent\n\t\t\t@mouseenter=\"onMouseEnterToHint\"\n\t\t\t@mouseleave=\"onHintAreaMouseLeave\"\n\t\t\tv-if=\"hasContent\"\n\t\t\t:class=\"hintIconClassname\"\n\t\t>\n\t\t\t<span class=\"ui-hint-icon\" />\n\t\t</span>\n\t`\n}\n","export class TagType\n{\n\tstatic PRIMARY = 'primary';\n\tstatic SECONDARY = 'secondary';\n\tstatic SUCCESS = 'success';\n\tstatic WARNING = 'warning';\n\tstatic FAILURE = 'failure';\n\tstatic LAVENDER = 'lavender';\n}\n","import { Dom, Runtime, Type } from 'main.core';\nimport { Label } from 'ui.label';\n\nimport { Action } from '../../../action';\nimport { TagType } from '../../enums/tag-type';\n\nimport 'ui.hint';\n\nexport const Tag = {\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\taction: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: TagType.SECONDARY,\n\t\t},\n\t\tstate: String,\n\t},\n\tcomputed:\n\t{\n\t\tclassName(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-timeline__card-status': true,\n\t\t\t\t'--clickable': Boolean(this.action),\n\t\t\t\t'--hint': Boolean(this.hint),\n\t\t\t};\n\t\t},\n\n\t\ttagTypeToLabelColorDict(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t[TagType.PRIMARY]: Label.Color.LIGHT_BLUE,\n\t\t\t\t[TagType.SECONDARY]: Label.Color.LIGHT,\n\t\t\t\t[TagType.LAVENDER]: Label.Color.LAVENDER,\n\t\t\t\t[TagType.SUCCESS]: Label.Color.LIGHT_GREEN,\n\t\t\t\t[TagType.WARNING]: Label.Color.LIGHT_YELLOW,\n\t\t\t\t[TagType.FAILURE]: Label.Color.LIGHT_RED,\n\t\t\t};\n\t\t},\n\n\t\ttagContainerRef(): HTMLDivElement\n\t\t{\n\t\t\treturn this.$refs.tag;\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tgetLabelColorFromTagType(tagType): String\n\t\t{\n\t\t\tconst lowerCaseTagType = tagType ? tagType.toLowerCase() : '';\n\t\t\tconst labelColor = this.tagTypeToLabelColorDict[lowerCaseTagType];\n\n\t\t\treturn labelColor || Label.Color.LIGHT;\n\t\t},\n\n\t\t// eslint-disable-next-line consistent-return\n\t\trenderTag(tagOptions): HTMLElement | null\n\t\t{\n\t\t\tif (!tagOptions || !this.tagContainerRef)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst { title, type } = tagOptions;\n\n\t\t\tconst uppercaseTitle = title && Type.isString(title) ? title.toUpperCase() : '';\n\t\t\tconst label = new Label({\n\t\t\t\ttext: uppercaseTitle,\n\t\t\t\tcolor: this.getLabelColorFromTagType(type),\n\t\t\t\tfill: true,\n\t\t\t});\n\n\t\t\tDom.clean(this.tagContainerRef);\n\t\t\tDom.append(label.render(), this.tagContainerRef);\n\t\t},\n\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst action = new Action(this.action);\n\t\t\taction.execute(this);\n\t\t},\n\n\t\tshowTooltip(): void\n\t\t{\n\t\t\tif (this.hint === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tRuntime.debounce(\n\t\t\t\t() => {\n\t\t\t\t\tBX.UI.Hint.show(\n\t\t\t\t\t\tthis.$el,\n\t\t\t\t\t\tthis.hint,\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\t50,\n\t\t\t\tthis,\n\t\t\t)();\n\t\t},\n\n\t\thideTooltip(): void\n\t\t{\n\t\t\tif (this.hint === '')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.UI.Hint.hide(this.$el);\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.renderTag({ title: this.title, type: this.type });\n\t},\n\n\tupdated(): void\n\t{\n\t\tthis.renderTag({ title: this.title, type: this.type });\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"tag\"\n\t\t\t:class=\"className\"\n\t\t\t@mouseover=\"showTooltip\"\n\t\t\t@mouseleave=\"hideTooltip\"\n\t\t\t@click=\"executeAction\"\n\t\t\tdata-hint-interactivity\n\t\t></div>\n\t`,\n};\n","import {Action} from \"../../../action\";\n\nexport const Title = {\n\tprops: {\n\t\ttitle: String,\n\t\taction: Object,\n\t},\n\tinject: ['isLogMessage'],\n\tcomputed: {\n\t\tclassName(): Array {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-title', {\n\t\t\t\t'--light': this.isLogMessage,\n\t\t\t\t'--action': !!this.action,\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\n\t\thref(): ?string {\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst action = new Action(this.action);\n\t\t\tif (action.isRedirect())\n\t\t\t{\n\t\t\t\treturn action.getValue();\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t},\n\tmethods: {\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst action = new Action(this.action);\n\t\t\taction.execute(this);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<a\n\t\t\tv-if=\"href\"\n\t\t\t:href=\"href\"\n\t\t\t:class=\"className\"\n\t\t\ttabindex=\"0\"\n\t\t\t:title=\"title\"\n\t\t>\n\t\t\t{{title}}\n\t\t</a>\n\t\t<span\n\t\t\tv-else\n\t\t\t@click=\"executeAction\"\n\t\t\t:class=\"className\"\n\t\t\ttabindex=\"0\"\n\t\t\t:title=\"title\"\n\t\t>\n\t\t\t{{title}}\n\t\t</span>`\n};\n","import {Text} from \"main.core\"\n\nexport const User = {\n\tprops: {\n\t\ttitle: String,\n\t\tdetailUrl: String,\n\t\timageUrl: String,\n\t},\n\tinject: ['isLogMessage'],\n\tcomputed: {\n\t\tstyles()\n\t\t{\n\t\t\tif (!this.imageUrl)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage: \"url('\" + encodeURI(Text.encode(this.imageUrl)) + \"')\",\n\t\t\t\tbackgroundSize: '21px'\n\t\t\t};\n\t\t},\n\n\t\tclassName() {\n\t\t\treturn [\n\t\t\t\t'ui-icon',\n\t\t\t\t'ui-icon-common-user',\n\t\t\t\t'crm-timeline__user-icon', {\n\t\t\t\t'--muted': this.isLogMessage,\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `<a :class=\"className\" :href=\"detailUrl\"\n\t\t\t\t  target=\"_blank\" :title=\"title\"><i :style=\"styles\"></i></a>`\n};\n","import { Runtime, Type } from 'main.core';\nimport { ChangeStreamButton } from './header/change-stream-button';\nimport { ColorSelector } from './header/color-selector';\nimport { FormatDate } from './header/format-date';\nimport { Hint } from './header/hint';\nimport { Tag } from './header/tag';\nimport { Title } from './header/title';\nimport { User } from './header/user';\n\nexport const Header = {\n\tcomponents: {\n\t\tColorSelector,\n\t\tChangeStreamButton,\n\t\tTitle,\n\t\tTag,\n\t\tUser,\n\t\tFormatDate,\n\t\tHint,\n\t},\n\tprops: {\n\t\ttitle: String,\n\t\ttitleAction: Object,\n\t\tdate: Number,\n\t\tdatePlaceholder: String,\n\t\tuseShortTimeFormat: Boolean,\n\t\tchangeStreamButton: Object | null,\n\t\ttags: Object,\n\t\tuser: Object,\n\t\tinfoHelper: Object,\n\t\tcolorSettings: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tinject: [\n\t\t'isReadOnly',\n\t\t'isLogMessage',\n\t],\n\tcomputed: {\n\t\tvisibleTags(): Array\n\t\t{\n\t\t\tif (!Type.isPlainObject(this.tags))\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn this.tags\n\t\t\t\t? Object.values(this.tags).filter((element) => this.isVisibleTagFilter(element))\n\t\t\t\t: []\n\t\t\t;\n\t\t},\n\n\t\tvisibleAndAscSortedTags(): Array\n\t\t{\n\t\t\tconst tagsCopy = Runtime.clone(this.visibleTags);\n\n\t\t\treturn tagsCopy.sort(this.tagsAscSorter);\n\t\t},\n\n\t\tisShowDate(): boolean\n\t\t{\n\t\t\treturn this.date || this.datePlaceholder;\n\t\t},\n\n\t\tclassName(): Object {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card-top',\n\t\t\t\t{\n\t\t\t\t\t'--log-message': this.isReadOnly || this.isLogMessage,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t},\n\tmethods: {\n\t\tisVisibleTagFilter(tag): Boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\ttag.state !== 'hidden'\n\t\t\t\t&& tag.scope !== 'mobile'\n\t\t\t\t&& (!this.isReadOnly || !tag.hideIfReadonly)\n\t\t\t);\n\t\t},\n\n\t\ttagsAscSorter(tagA, tagB): Number\n\t\t{\n\t\t\treturn tagA.sort - tagB.sort;\n\t\t},\n\n\t\tgetChangeStreamButton(): ?Object\n\t\t{\n\t\t\treturn this.$refs.changeStreamButton;\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.$watch(\n\t\t\t'colorSettings',\n\t\t\t(newColorSettings) => {\n\t\t\t\tthis.$refs.colorSelector.setValue(newColorSettings.selectedValueId);\n\t\t\t},\n\t\t\t{\n\t\t\t\tdeep: true,\n\t\t\t},\n\t\t);\n\t},\n\ttemplate: `\n\t\t<div :class=\"className\">\n\t\t\t<div class=\"crm-timeline__card-top_info\">\n\t\t\t\t<div class=\"crm-timeline__card-top_info_left\">\n\t\t\t\t\t<ChangeStreamButton \n\t\t\t\t\t\tv-if=\"changeStreamButton\" \n\t\t\t\t\t\tv-bind=\"changeStreamButton\" \n\t\t\t\t\t\tref=\"changeStreamButton\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Title :title=\"title\" :action=\"titleAction\"></Title>\n\t\t\t\t\t<Hint v-if=\"infoHelper\" v-bind=\"infoHelper\"></Hint>\n\t\t\t\t</div>\n\t\t\t\t<div ref=\"tags\" class=\"crm-timeline__card-top_info_right\">\n\t\t\t\t\t<Tag\n\t\t\t\t\t\tv-for=\"(tag, index) in visibleAndAscSortedTags\"\n\t\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t\tv-bind=\"tag\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormatDate\n\t\t\t\t\t\tv-if=\"isShowDate\"\n\t\t\t\t\t\t:timestamp=\"date\"\n\t\t\t\t\t\t:use-short-time-format=\"useShortTimeFormat\"\n\t\t\t\t\t\t:date-placeholder=\"datePlaceholder\"\n\t\t\t\t\t\tclass=\"crm-timeline__card-time\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"crm-timeline__card-top_components-container\">\n\t\t\t\t<ColorSelector\n\t\t\t\t\tv-if=\"colorSettings\"\n\t\t\t\t\tref=\"colorSelector\"\n\t\t\t\t\t:valuesList=\"colorSettings.valuesList\"\n\t\t\t\t\t:selectedValueId=\"colorSettings.selectedValueId\"\n\t\t\t\t\t:readOnlyMode=\"colorSettings.readOnlyMode\"\n\t\t\t\t/>\n\t\t\t\t<User v-bind=\"user\"></User>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export class IconBackgroundColor {\n\tstatic PRIMARY = 'primary';\n\tstatic PRIMARY_ALT = 'primary_alt';\n\tstatic FAILURE = 'failure';\n}","import { Dom, Text, Type } from 'main.core';\nimport { Counter } from 'ui.cnt';\nimport { IconBackgroundColor } from '../enums/icon-background-color';\n\nexport const Icon = {\n\tprops: {\n\t\tcode: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: 'none',\n\t\t},\n\t\tcounterType: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tbackgroundColorToken: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: IconBackgroundColor.PRIMARY,\n\t\t},\n\t\tbackgroundUri: String,\n\t\tbackgroundColor: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tinject: ['isLogMessage'],\n\tcomputed: {\n\t\tclassName(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-timeline__card_icon': true,\n\t\t\t\t[`--bg-${this.backgroundColorToken}`]: Boolean(this.backgroundColorToken),\n\t\t\t\t[`--code-${this.code}`]: Boolean(this.code) && !this.backgroundUri,\n\t\t\t\t'--custom-bg': Boolean(this.backgroundUri),\n\t\t\t\t'--muted': this.isLogMessage,\n\t\t\t};\n\t\t},\n\n\t\tcounterNodeContainer(): HTMLDivElement\n\t\t{\n\t\t\treturn this.$refs.counter;\n\t\t},\n\n\t\tstyles(): Object\n\t\t{\n\t\t\tif (!this.backgroundUri)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage: `url('${encodeURI(Text.encode(this.backgroundUri))}')`,\n\t\t\t};\n\t\t},\n\n\t\ticonStyle(): Object\n\t\t{\n\t\t\tif (Type.isStringFilled(this.backgroundColor))\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\t'--crm-timeline-card-icon-background': Text.encode(this.backgroundColor),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {};\n\t\t},\n\t},\n\n\tmethods: {\n\t\trenderCounter() {\n\t\t\tif (!this.counterType)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tDom.clean(this.counterNodeContainer);\n\t\t\tconst counter = new Counter({\n\t\t\t\tvalue: 1,\n\t\t\t\tborder: true,\n\t\t\t\tcolor: Counter.Color[this.counterType.toUpperCase()],\n\t\t\t});\n\t\t\tcounter.renderTo(this.counterNodeContainer);\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.renderCounter();\n\t},\n\twatch: {\n\t\tcounterType(newCounterType): void // update if counter state changed\n\t\t{\n\t\t\tvoid this.$nextTick(() => {\n\t\t\t\tthis.renderCounter();\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"className\" :style=\"iconStyle\">\n\t\t\t<i :style=\"styles\"></i>\n\t\t\t<div ref=\"counter\" v-show=\"!!counterType\" class=\"crm-timeline__card_icon_counter\"></div>\n\t\t</div>\n\t`\n};\n","import {Type} from \"main.core\";\nimport {Action} from \"../../action\";\n\nexport const MarketPanel = {\n\tprops: {\n\t\ttext: String,\n\t\tdetailsText: String,\n\t\tdetailsTextAction: Object,\n\n\t},\n\tcomputed: {\n\t\tneedShowDetailsText(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.detailsText);\n\t\t},\n\t\thref(): ?string\n\t\t{\n\t\t\tif (!this.detailsTextAction)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst action = new Action(this.detailsTextAction);\n\t\t\tif (action.isRedirect())\n\t\t\t{\n\t\t\t\treturn action.getValue();\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t},\n\tmethods: {\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (this.detailsTextAction)\n\t\t\t{\n\t\t\t\tconst action = new Action(this.detailsTextAction);\n\t\t\t\taction.execute(this);\n\t\t\t}\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"crm-timeline__card-bottom\">\n\t\t<div class=\"crm-timeline__card-market\">\n\t\t\t<div class=\"crm-timeline__card-market_container\">\n\t\t\t\t<span class=\"crm-timeline__card-market_logo\"></span>\n\t\t\t\t<span class=\"crm-timeline__card-market_text\">{{ text }}</span>\n\t\t\t\t<a\n\t\t\t\t\tv-if=\"href && needShowDetailsText\"\n\t\t\t\t\t:href=\"href\"\n\t\t\t\t\tclass=\"crm-timeline__card-market_more\"\n\t\t\t\t>\n\t\t\t\t\t{{detailsText}}\n\t\t\t\t</a>\n\t\t\t\t<span\n\t\t\t\t\tv-if=\"!href && needShowDetailsText\"\n\t\t\t\t\t@click=\"executeAction\"\n\t\t\t\t\tclass=\"crm-timeline__card-market_more\"\n\t\t\t\t>\n\t\t\t\t{{detailsText}}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<div class=\"crm-timeline__card-market_cross\"><i></i></div>\n\t\t</div>\n\t\t</div>\n\t`\n};\n","export const UserPick = {\n\ttemplate: `\n\t\t<div class=\"ui-icon ui-icon-common-user crm-timeline__card-top_user-icon\">\n\t\t\t<i></i>\n\t\t</div>\n\t`\n}","import { Dom, Runtime, Text, Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { Loader } from 'main.loader';\nimport { StreamType } from '../stream-type';\nimport { Body } from './layout/body';\nimport { Footer } from './layout/footer';\nimport { Header } from './layout/header';\nimport { Icon } from './layout/icon';\nimport { MarketPanel } from './layout/marketPanel';\nimport { UserPick } from './layout/userPick';\n\nexport const Item = {\n\tcomponents: {\n\t\tIcon,\n\t\tHeader,\n\t\tBody,\n\t\tFooter,\n\t\tMarketPanel,\n\t\tUserPick,\n\t},\n\tprops: {\n\t\tinitialLayout: Object,\n\t\tid: String,\n\t\tuseShortTimeFormat: Boolean,\n\t\tisLogMessage: Boolean,\n\t\tisReadOnly: Boolean,\n\t\tcurrentUser: Object | null,\n\t\tonAction: Function,\n\t\tinitialColor: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tstreamType: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: StreamType.history,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tlayout: this.initialLayout,\n\t\t\tcolor: this.initialColor,\n\t\t\tisFaded: false,\n\t\t\tloader: Object.freeze(null),\n\t\t};\n\t},\n\tprovide() {\n\t\treturn {\n\t\t\tisLogMessage: Boolean(this.initialLayout?.isLogMessage),\n\t\t\tisReadOnly: this.isReadOnly,\n\t\t\tcurrentUser: this.currentUser,\n\t\t};\n\t},\n\tcreated(): void\n\t{\n\t\tthis.$Bitrix.eventEmitter.subscribe('crm:timeline:item:action', this.onActionEvent);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('crm:timeline:item:action', this.onActionEvent);\n\t},\n\tmethods: {\n\t\tonActionEvent(event: BaseEvent): void\n\t\t{\n\t\t\tconst eventData = event.getData();\n\t\t\tthis.onAction(Runtime.clone(eventData));\n\t\t},\n\t\tsetLayout(newLayout: Object): void\n\t\t{\n\t\t\tthis.layout = newLayout;\n\t\t\tthis.isFaded = false;\n\t\t\tthis.$Bitrix.eventEmitter.emit('layout:updated');\n\t\t},\n\t\tsetColor(newColor: Object): void\n\t\t{\n\t\t\tthis.color = newColor;\n\t\t},\n\n\t\tsetFaded(faded: boolean)\n\t\t{\n\t\t\tthis.isFaded = faded;\n\t\t},\n\n\t\tshowLoader(showLoader: boolean)\n\t\t{\n\t\t\tif (showLoader)\n\t\t\t{\n\t\t\t\tthis.setFaded(true);\n\t\t\t\tif (!this.loader)\n\t\t\t\t{\n\t\t\t\t\tthis.loader = new Loader();\n\t\t\t\t}\n\t\t\t\tthis.loader.show(this.$el.parentNode);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.loader)\n\t\t\t\t{\n\t\t\t\t\tthis.loader.hide();\n\t\t\t\t}\n\t\t\t\tthis.setFaded(false);\n\t\t\t}\n\t\t},\n\n\t\tgetContentBlockById(blockId: string): ?Object\n\t\t{\n\t\t\tif (!this.$refs.body)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.$refs.body.getContentBlockById(blockId);\n\t\t},\n\n\t\tgetLogo(): ?Object\n\t\t{\n\t\t\tif (!this.$refs.body)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.$refs.body.getLogo();\n\t\t},\n\n\t\tgetHeaderChangeStreamButton(): ?Object\n\t\t{\n\t\t\tif (!this.$refs.header)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.$refs.header.getChangeStreamButton();\n\t\t},\n\n\t\tgetFooterButtonById(buttonId: string): ?Object\n\t\t{\n\t\t\tif (!this.$refs.footer)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.$refs.footer.getButtonById(buttonId);\n\t\t},\n\n\t\tgetFooterMenu(): ?Object\n\t\t{\n\t\t\tif (!this.$refs.footer)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.$refs.footer.getMenu();\n\t\t},\n\n\t\thighlightContentBlockById(blockId: string, isHighlighted: boolean): void\n\t\t{\n\t\t\tif (!isHighlighted)\n\t\t\t{\n\t\t\t\tthis.isFaded = false;\n\t\t\t}\n\n\t\t\tconst block = this.getContentBlockById(blockId);\n\t\t\tif (!block)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (isHighlighted)\n\t\t\t{\n\t\t\t\tthis.isFaded = true;\n\t\t\t\tDom.addClass(block.$el, '--highlighted');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.isFaded = false;\n\t\t\t\tDom.removeClass(block.$el, '--highlighted');\n\t\t\t}\n\t\t},\n\t},\n\tcomputed: {\n\t\ttimelineCardClassname(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-timeline__card': true,\n\t\t\t\t'crm-timeline__card-scope': true,\n\t\t\t\t'--stream-type-history': this.streamType === StreamType.history,\n\t\t\t\t'--stream-type-scheduled': this.streamType === StreamType.scheduled,\n\t\t\t\t'--stream-type-pinned': this.streamType === StreamType.pinned,\n\t\t\t\t'--log-message': this.isLogMessage,\n\t\t\t};\n\t\t},\n\t\ttimelineCardStyle(): Object\n\t\t{\n\t\t\tif (Type.isPlainObject(this.color) && this.streamType === StreamType.scheduled)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\t'--crm-timeline__card-color-background': Text.encode(this.color.itemBackground),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {};\n\t\t},\n\t},\n\ttemplate: `\n\t  \t<div class=\"crm-timeline__card-wrapper\">\n\t\t\t<div class=\"crm-timeline__card_icon_container\">\n\t\t\t\t<Icon v-bind=\"layout.icon\"></Icon>\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\t:data-id=\"id\" \n\t\t\t\tref=\"timelineCard\" \n\t\t\t\t:class=\"timelineCardClassname\"\n\t\t\t\t:style=\"timelineCardStyle\"\n\t\t\t>\n\t\t\t\t<div class=\"crm-timeline__card_fade\" v-if=\"isFaded\"></div>\n\t\t\t\t<Header \n\t\t\t\t\tv-if=\"layout.header\"\n\t\t\t\t\tv-bind=\"layout.header\"\n\t\t\t\t\t:use-short-time-format=\"useShortTimeFormat\"\n\t\t\t\t\tref=\"header\"\n\t\t\t\t/>\n\t\t\t\t<Body v-if=\"layout.body\" v-bind=\"layout.body\" ref=\"body\"></Body>\n\t\t\t\t<Footer v-if=\"layout.footer\" v-bind=\"layout.footer\" ref=\"footer\"></Footer>\n\t\t\t\t<MarketPanel v-if=\"layout.marketPanel\" v-bind=\"layout.marketPanel\"></MarketPanel>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import ConfigurableItem from \"./configurable-item\";\n\nexport default class ControllerManager\n{\n\t#id: ?string = null;\n\n\tconstructor(id)\n\t{\n\t\tthis.#id = id;\n\t}\n\n\tgetItemControllers(item: ConfigurableItem): Array\n\t{\n\t\tconst foundControllers = [];\n\t\tfor (const controller of ControllerManager.getRegisteredControllers())\n\t\t{\n\t\t\tif (controller.isItemSupported(item))\n\t\t\t{\n\t\t\t\tconst controllerInstance = new controller();\n\t\t\t\tcontrollerInstance.onInitialize(item);\n\t\t\t\tfoundControllers.push(controllerInstance);\n\t\t\t}\n\t\t}\n\n\t\treturn foundControllers;\n\t}\n\n\tstatic getInstance(timelineId): ControllerManager\n\t{\n\t\tif (!this.#instances.hasOwnProperty(timelineId))\n\t\t{\n\t\t\tthis.#instances[timelineId] = new ControllerManager(timelineId);\n\t\t}\n\n\t\treturn this.#instances[timelineId];\n\t}\n\n\tstatic registerController(controller): void\n\t{\n\t\tthis.#availableControllers.push(controller);\n\t}\n\n\tstatic getRegisteredControllers(): Array\n\t{\n\t\treturn this.#availableControllers;\n\t}\n\n\tstatic #instances = {};\n\tstatic #availableControllers = [];\n}\n","import { ajax as Ajax, Type } from 'main.core';\nimport { UI } from 'ui.notification';\n\nimport ConfigurableItem from '../configurable-item';\n\nexport type ActionParams =\n{\n\taction: String,\n\tactionType: String,\n\tactionData: ?Object,\n\tresponse: ?Object,\n\tanimationCallbacks: ?ActionAnimationCallbacks,\n\tconfirmationText: ?String,\n};\n\nexport type ActionAnimationCallbacks =\n{\n\tonStart: ?Function,\n\tonStop: ?Function,\n};\n\nexport class Base\n{\n\tgetDeleteActionMethod(): string\n\t{\n\t\treturn '';\n\t}\n\n\tgetDeleteActionCfg(recordId: Number, ownerTypeId: Number, ownerId: Number): Object\n\t{\n\t\treturn {\n\t\t\tdata: {\n\t\t\t\trecordId,\n\t\t\t\townerTypeId,\n\t\t\t\townerId,\n\t\t\t},\n\t\t};\n\t}\n\n\tonInitialize(item: ConfigurableItem): void\n\t{}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{}\n\n\tgetContentBlockComponents(item: ConfigurableItem): Object\n\t{\n\t\treturn {};\n\t}\n\n\tonAfterItemRefreshLayout(item: ConfigurableItem): void\n\t{}\n\n\tonAfterItemLayout(item: ConfigurableItem, options): void\n\t{}\n\n\t/**\n\t * Will be executed before item node deleted from DOM\n\t * @param item\n\t */\n\tonBeforeItemClearLayout(item: ConfigurableItem): void\n\t{}\n\n\t/**\n\t * Delete timeline record action\n\t *\n\t * @param recordId Timeline record ID\n\t * @param ownerTypeId Owner type ID\n\t * @param ownerId Owner type ID\n\t * @param animationCallbacks\n\t *\n\t * @returns {Promise}\n\t *\n\t * @protected\n\t */\n\trunDeleteAction(recordId: Number, ownerTypeId: Number, ownerId: Number, animationCallbacks: ?Object): Promise\n\t{\n\t\tif (animationCallbacks.onStart)\n\t\t{\n\t\t\tanimationCallbacks.onStart();\n\t\t}\n\n\t\treturn Ajax.runAction(\n\t\t\tthis.getDeleteActionMethod(),\n\t\t\tthis.getDeleteActionCfg(recordId, ownerTypeId, ownerId),\n\t\t).then(() => {\n\t\t\tif (animationCallbacks.onStop)\n\t\t\t{\n\t\t\t\tanimationCallbacks.onStop();\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}, (response) => {\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\tautoHideDelay: 5000,\n\t\t\t});\n\n\t\t\tif (animationCallbacks.onStop)\n\t\t\t{\n\t\t\t\tanimationCallbacks.onStop();\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\t/**\n\t * Schedule TODO activity action\n\t *\n\t * @param activityId Activity ID\n\t * @param scheduleDate Date to use in editor\n\t * @param description Default description to use in editor\n\t *\n\t * @protected\n\t */\n\trunScheduleAction(activityId: Number, scheduleDate: String, description: String = ''): void\n\t{\n\t\tconst menuBar = BX.Crm?.Timeline?.MenuBar?.getDefault();\n\t\tif (menuBar)\n\t\t{\n\t\t\tmenuBar.setActiveItemById('todo');\n\t\t\tmenuBar.scrollIntoView();\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst todoEditor = menuBar.getItemById('todo');\n\n\t\t\t\ttodoEditor.focus();\n\t\t\t\ttodoEditor.setParentActivityId(activityId);\n\t\t\t\ttodoEditor.setDeadLine(scheduleDate);\n\n\t\t\t\tif (Type.isStringFilled(description))\n\t\t\t\t{\n\t\t\t\t\ttodoEditor.setDescription(description);\n\t\t\t\t\ttodoEditor.focus();\n\t\t\t\t}\n\t\t\t}, 250);\n\t\t}\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn false;\n\t}\n}\n","import { Dom, Type } from 'main.core';\n\nexport default class Item\n{\n\tconstructor()\n\t{\n\t\tthis._id = '';\n\t\tthis._isTerminated = false;\n\t\tthis._wrapper = null;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this._id;\n\t}\n\n\t_setId(id): void\n\t{\n\t\tthis._id = BX.type.isNotEmptyString(id) ? id : BX.util.getRandomString(4);\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tsetData(data): void\n\t{\n\t\tthrow new Error('Item.setData() must be overridden');\n\t}\n\n\t/**\n\t * @abstract\n\t */\n\tlayout(options): void\n\t{\n\t\tthrow new Error('Item.layout() must be overridden');\n\t}\n\n\trefreshLayout()\n\t{\n\t\tconst anchor = this._wrapper.previousSibling;\n\t\tthis.clearLayout();\n\n\t\tthis.layout({ anchor: anchor });\n\t}\n\n\tclearLayout()\n\t{\n\t\tDom.remove(this._wrapper);\n\t\tthis._wrapper = undefined;\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.clearLayout();\n\t}\n\n\tgetWrapper(): ?HTMLElement\n\t{\n\t\treturn this._wrapper;\n\t}\n\n\tsetWrapper(wrapper: HTMLElement): void\n\t{\n\t\tthis._wrapper = wrapper;\n\t}\n\n\taddWrapperClass(className, timeout): void\n\t{\n\t\tif(!this._wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tDom.addClass(this._wrapper, className);\n\n\t\tif(Type.isNumber(timeout) && timeout >= 0)\n\t\t{\n\t\t\twindow.setTimeout(this.removeWrapperClass.bind(this, className), timeout);\n\t\t}\n\t}\n\n\tremoveWrapperClass(className, timeout): void\n\t{\n\t\tif(!this._wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.removeClass(this._wrapper, className);\n\t\tif(Type.isNumber(timeout) && timeout >= 0)\n\t\t{\n\t\t\twindow.setTimeout(this.addWrapperClass.bind(this, className), timeout);\n\t\t}\n\t}\n\n\tisTerminated(): boolean\n\t{\n\t\treturn this._isTerminated;\n\t}\n\n\tmarkAsTerminated(terminated): void\n\t{\n\t\tterminated = !!terminated;\n\n\t\tif (this._isTerminated === terminated)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._isTerminated = terminated;\n\t\tif (!this._wrapper)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (terminated)\n\t\t{\n\t\t\tDom.addClass(this._wrapper, 'crm-entity-stream-section-last');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this._wrapper, 'crm-entity-stream-section-last');\n\t\t}\n\t}\n\n\tgetAssociatedEntityTypeId(): ?Number\n\t{\n\t\treturn null;\n\t}\n\n\tgetAssociatedEntityId(): ?Number\n\t{\n\t\treturn null;\n\t}\n\n}\n","import {Runtime} from 'main.core';\n\nexport default class Layout {\n\t#layout: Object = null;\n\n\tconstructor (layout: Object) {\n\t\tthis.#layout = layout;\n\t}\n\n\tasPlainObject (): Object {\n\t\treturn Runtime.clone(this.#layout);\n\t}\n\n\tgetFooterMenuItemById (id: string): ?Object {\n\t\tconst items = this.#layout?.footer?.menu?.items ?? {};\n\n\t\treturn items.hasOwnProperty(id) ? items.id : null;\n\t}\n\n\taddFooterMenuItem (menuItem: Object): void {\n\t\tthis.#layout.footer = this.#layout.footer || {};\n\t\tthis.#layout.footer.menu = this.#layout.footer.menu || {};\n\t\tthis.#layout.footer.menu.items = this.#layout.footer.menu.items || {};\n\t\tthis.#layout.footer.menu.items[menuItem.id] = menuItem;\n\t}\n}\n","import { StreamType } from 'crm.timeline.item';\nimport { DatetimeConverter } from 'crm.timeline.tools';\nimport { ajax, Dom, Text, Type } from 'main.core';\nimport { BitrixVue } from 'ui.vue3';\nimport { Item } from './components/item';\nimport ControllerManager from './controller-manager';\nimport { Base } from './controllers/base';\nimport TimelineItem from './item';\nimport Layout from './layout';\n\ndeclare type ConfigurableItemParams = {\n\ttimelineId: string,\n\tcontainer: HTMLElement,\n\titemClassName: string,\n\tuseShortTimeFormat: boolean,\n\tisReadOnly: boolean,\n\tcurrentUser: ?Object,\n\townerTypeId: number,\n\townerId: number,\n\tdata: ConfigurableItemData,\n\tstreamType: number;\n};\n\ndeclare type ConfigurableItemData = {\n\ttype: string,\n\ttimestamp: ?Number,\n\tsort: ?Array,\n\tlayout: ?Object,\n\tpayload: ?Object,\n\tcolor: ?Object,\n}\n\nexport default class ConfigurableItem extends TimelineItem\n{\n\t#container: HTMLElement = null;\n\t#itemClassName: string = null;\n\t#type: string = null;\n\t#dataPayload: ?Object = null;\n\t#timelineId: string = null;\n\t#timestamp: number = null;\n\t#sort: Array = null;\n\t#useShortTimeFormat: boolean = false;\n\t#isReadOnly: boolean = false;\n\t#currentUser: ?Object = null;\n\t#ownerTypeId: number = null;\n\t#ownerId: number = null;\n\t#controllers: Base[] = null;\n\t#layoutComponent: ?Object = null;\n\t#layoutApp: ?Object = null;\n\t#layout: ?Layout = null;\n\t#streamType: number = null;\n\t#color: ?Object = null;\n\n\tinitialize(id, settings: ConfigurableItemParams): void\n\t{\n\t\tthis._setId(id);\n\t\tsettings = settings || {};\n\t\tthis.#timelineId = settings.timelineId || '';\n\t\tthis.setContainer(settings.container || null);\n\t\tthis.#itemClassName = settings.itemClassName || '';\n\n\t\tif (Type.isPlainObject(settings.data))\n\t\t{\n\t\t\tthis.setData(settings.data);\n\n\t\t\tthis.#useShortTimeFormat = settings.useShortTimeFormat || false;\n\t\t\tthis.#isReadOnly = settings.isReadOnly || false;\n\t\t\tthis.#currentUser = settings.currentUser || null;\n\t\t\tthis.#ownerTypeId = settings.ownerTypeId;\n\t\t\tthis.#ownerId = settings.ownerId;\n\t\t\tthis.#streamType = settings.streamType || StreamType.history;\n\t\t}\n\n\t\tthis.#controllers = ControllerManager.getInstance(this.#timelineId).getItemControllers(this);\n\t}\n\n\tsetData(data: ConfigurableItemData): void\n\t{\n\t\tthis.#type = data.type || null;\n\t\tthis.#timestamp = data.timestamp || null;\n\t\tthis.#sort = data.sort || [];\n\t\tthis.#layout = new Layout(data.layout || {});\n\t\tthis.#dataPayload = data.payload || {};\n\t\tthis.#color = data.color ?? null;\n\t}\n\n\tgetColor(): ?Object\n\t{\n\t\treturn this.#color;\n\t}\n\n\tgetLayout(): Layout\n\t{\n\t\treturn this.#layout;\n\t}\n\n\tgetType(): string\n\t{\n\t\treturn this.#type;\n\t}\n\n\tgetDataPayload(): ?Object\n\t{\n\t\treturn this.#dataPayload;\n\t}\n\n\tlayout(options): void\n\t{\n\t\tthis.setWrapper(Dom.create({tag: 'div', attrs: {className: this.#itemClassName}}));\n\t\tthis.initLayoutApp(options);\n\t}\n\n\tinitWrapper(): HTMLElement\n\t{\n\t\tthis.setWrapper(Dom.create({tag: 'div', attrs: {className: this.#itemClassName}}));\n\n\t\treturn this._wrapper;\n\t}\n\n\tinitLayoutApp(options): void\n\t{\n\t\tthis.#initLayoutApp();\n\n\t\tif (this.needBindToContainer(options))\n\t\t{\n\t\t\tconst bindTo = this.getBindToNode(options);\n\t\t\tif (bindTo && !this.#useAnchorNextSibling(options))\n\t\t\t{\n\t\t\t\tDom.insertBefore(this.getWrapper(), bindTo);\n\t\t\t}\n\t\t\telse if (bindTo && bindTo.nextSibling)\n\t\t\t{\n\t\t\t\tDom.insertBefore(this.getWrapper(), bindTo.nextSibling);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.append(this.getWrapper(), this.#container);\n\t\t\t}\n\t\t}\n\n\t\tfor (const controller of this.#controllers)\n\t\t{\n\t\t\tcontroller.onAfterItemLayout(this, options);\n\t\t}\n\t}\n\n\tneedBindToContainer(options): Boolean\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\treturn BX.prop.getBoolean(options, 'add', true);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetBindToNode(options): ?HTMLElement\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\treturn Type.isElementNode(options['anchor']) ? options['anchor'] : null;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#useAnchorNextSibling(options): ?HTMLElement\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\treturn Type.isBoolean(options['useAnchorNextSibling']) ? options['useAnchorNextSibling'] : true;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\trefreshLayout(): void\n\t{\n\t\t// try to refresh layout via vue reactivity, if possible:\n\t\tif (this.#layoutComponent)\n\t\t{\n\t\t\tthis.#layoutComponent.setColor(this.getColor());\n\t\t\tthis.#layoutComponent.setLayout(this.getLayout().asPlainObject());\n\n\t\t\tfor (const controller of this.#controllers)\n\t\t\t{\n\t\t\t\tcontroller.onAfterItemRefreshLayout(this);\n\t\t\t}\n\t\t\tthis.#layoutComponent.showLoader(false);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsuper.refreshLayout();\n\t\t}\n\t}\n\n\tgetLayoutComponent(): ?Object\n\t{\n\t\treturn this.#layoutComponent;\n\t}\n\n\tforceRefreshLayout(): void\n\t{\n\t\tconst bindTo = this.getWrapper()?.nextSibling;\n\t\tthis.clearLayout();\n\t\tthis.layout({anchor: bindTo, useAnchorNextSibling: false});\n\t}\n\n\tgetLayoutContentBlockById(id: string): ?Object\n\t{\n\t\treturn this.#layoutComponent?.getContentBlockById(id);\n\t}\n\n\tgetLogo(): ?Object\n\t{\n\t\treturn this.#layoutComponent?.getLogo();\n\t}\n\n\tgetLayoutFooterButtonById(id: string): ?Object\n\t{\n\t\treturn this.#layoutComponent?.getFooterButtonById(id);\n\t}\n\n\tgetLayoutFooterMenu(): ?Object\n\t{\n\t\treturn this.#layoutComponent?.getFooterMenu();\n\t}\n\n\tgetLayoutHeaderChangeStreamButton(): ?Object\n\t{\n\t\treturn this.#layoutComponent?.getHeaderChangeStreamButton();\n\t}\n\n\thighlightContentBlockById(blockId: string, isHighlighted: boolean): void\n\t{\n\t\tthis.#layoutComponent?.highlightContentBlockById(blockId, isHighlighted);\n\t}\n\n\tclearLayout(): void\n\t{\n\t\tfor (const controller of this.#controllers)\n\t\t{\n\t\t\tcontroller.onBeforeItemClearLayout(this);\n\t\t}\n\t\tthis.#layoutApp.unmount();\n\t\tthis.#layoutApp = null;\n\t\tthis.#layoutComponent = null;\n\t\tsuper.clearLayout();\n\t}\n\n\tgetCreatedDate(): Date\n\t{\n\t\tconst timestamp = this.#timestamp ? this.#timestamp : Date.now() / 1000;\n\n\t\treturn BX.prop.extractDate(DatetimeConverter.createFromServerTimestamp(timestamp).toUserTime().getValue());\n\t}\n\n\tgetSourceId(): number\n\t{\n\t\tlet id = this.getId();\n\t\tif (!Type.isInteger(id))\n\t\t{\n\t\t\t// id is like ACTIVITY_12\n\t\t\tid = Text.toInteger(id.replace(/^\\D+/g, ''));\n\t\t}\n\n\t\treturn id;\n\t}\n\n\t#initLayoutApp(): void\n\t{\n\t\tif (!this.#layoutApp)\n\t\t{\n\t\t\tthis.#layoutApp = BitrixVue.createApp(Item, this.#getLayoutAppProps());\n\n\t\t\tconst contentBlockComponents = this.#getContentBlockComponents();\n\t\t\tfor (const componentName in contentBlockComponents)\n\t\t\t{\n\t\t\t\tthis.#layoutApp.component(componentName, contentBlockComponents[componentName]);\n\t\t\t}\n\n\t\t\tthis.#layoutComponent = this.#layoutApp.mount(this.getWrapper());\n\t\t}\n\t}\n\n\t#getLayoutAppProps(): Object\n\t{\n\t\treturn {\n\t\t\tinitialLayout: this.getLayout().asPlainObject(),\n\t\t\tinitialColor: this.#streamType === StreamType.scheduled ? this.#color : null,\n\t\t\tid: String(this.getId()),\n\t\t\tuseShortTimeFormat: this.#useShortTimeFormat,\n\t\t\tisReadOnly: this.isReadOnly(),\n\t\t\tcurrentUser: this.getCurrentUser(),\n\t\t\tstreamType: this.#streamType,\n\t\t\tonAction: this.#onLayoutAppAction.bind(this),\n\t\t};\n\t}\n\n\t#onLayoutAppAction(eventData: ?Object)\n\t{\n\t\tfor (const controller of this.#controllers)\n\t\t{\n\t\t\tcontroller.onItemAction(this, eventData);\n\t\t}\n\t}\n\n\t#getContentBlockComponents(): Object\n\t{\n\t\tlet components = {};\n\t\tfor (const controller of this.#controllers)\n\t\t{\n\t\t\tcomponents = Object.assign(components, controller.getContentBlockComponents(this));\n\t\t}\n\n\t\treturn components;\n\t}\n\n\tsetContainer(container): void\n\t{\n\t\tthis.#container = container;\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.#container;\n\t}\n\n\tgetDeadline(): ?Date\n\t{\n\t\tif (!this.#timestamp)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn DatetimeConverter.createFromServerTimestamp(this.#timestamp).toUserTime().getValue();\n\t}\n\n\tgetSort(): Array\n\t{\n\t\treturn this.#sort;\n\t}\n\n\tisReadOnly(): boolean\n\t{\n\t\treturn this.#isReadOnly;\n\t}\n\n\tgetCurrentUser(): ?Object\n\t{\n\t\treturn this.#currentUser;\n\t}\n\n\tclone(): ConfigurableItem\n\t{\n\t\treturn ConfigurableItem.create(this.getId(), {\n\t\t\ttimelineId: this.#timelineId,\n\t\t\tcontainer: this.getContainer(),\n\t\t\titemClassName: this.#itemClassName,\n\t\t\tuseShortTimeFormat: this.#useShortTimeFormat,\n\t\t\tisReadOnly: this.#isReadOnly,\n\t\t\tcurrentUser: this.#currentUser,\n\t\t\tstreamType: this.#streamType,\n\t\t\tdata: {\n\t\t\t\ttype: this.#type,\n\t\t\t\ttimestamp: this.#timestamp,\n\t\t\t\tsort: this.#sort,\n\t\t\t\tlayout: this.getLayout().asPlainObject(),\n\t\t\t},\n\t\t});\n\t}\n\n\treloadFromServer(forceRefreshLayout: boolean = false): Promise\n\t{\n\t\tconst data = {\n\t\t\townerTypeId: this.#ownerTypeId,\n\t\t\townerId: this.#ownerId,\n\t\t};\n\t\tif (this.#streamType === StreamType.history || this.#streamType === StreamType.pinned)\n\t\t{\n\t\t\tdata.historyIds = [ this.getId() ];\n\t\t}\n\t\telse if (this.#streamType === StreamType.scheduled)\n\t\t{\n\t\t\tdata.activityIds = [ this.getId() ];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow new Error('Wrong stream type');\n\t\t}\n\n\t\treturn ajax.runAction('crm.timeline.item.load', {data})\n\t\t\t.then(response => {\n\t\t\t\tObject.values(response.data).forEach(item => {\n\t\t\t\t\tif (item.id === this.getId())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setData(item);\n\t\t\t\t\t\tif (forceRefreshLayout)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.forceRefreshLayout();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.refreshLayout();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t})\n\t\t\t.catch(err => {\n\t\t\t\tconsole.error(err);\n\t\t\t\treturn true;\n\t\t\t});\n\t}\n\n\tstatic create(id, settings): ConfigurableItem\n\t{\n\t\tconst self = new ConfigurableItem();\n\t\tself.initialize(id, settings);\n\t\treturn self;\n\t}\n}\n","import { ajax as Ajax, Loc, Text, Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { Router } from 'crm.router';\nimport {\n\tApplyButton,\n\tButtonSize,\n\tCancelButton,\n\tCreateButton,\n\tAirButtonStyle,\n} from 'ui.buttons';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport { Dialog, Item } from 'ui.entity-selector';\nimport { UI } from 'ui.notification';\nimport { ActionParams, Base } from './base';\nimport ConfigurableItem from '../configurable-item';\n\nconst ALLOWED_MOVE_TO_ITEM_TYPES = [\n\t'Activity:Call',\n\t'Activity:Email',\n\t'Activity:OpenLine',\n];\n\ndeclare type ActionData = {\n\tactivityId: number,\n\townerTypeId: number,\n\townerId: number,\n\tcategoryId: ?number,\n\tcanAddItems: boolean,\n};\n\nexport class Activity extends Base\n{\n\t#moveToSelectorDialog: ?Dialog = null;\n\n\tgetDeleteActionMethod(): string\n\t{\n\t\treturn 'crm.timeline.activity.delete';\n\t}\n\n\tgetMoveActionMethod(): string\n\t{\n\t\treturn 'crm.activity.binding.move';\n\t}\n\n\tgetDeleteTagActionMethod(): string\n\t{\n\t\treturn 'crm.timeline.activity.deleteTag';\n\t}\n\n\tgetDeleteActionCfg(recordId: Number, ownerTypeId: Number, ownerId: Number): Object\n\t{\n\t\treturn {\n\t\t\tdata: {\n\t\t\t\tactivityId: recordId,\n\t\t\t\townerTypeId,\n\t\t\t\townerId,\n\t\t\t},\n\t\t};\n\t}\n\n\trunDeleteTagAction(recordId: Number, ownerTypeId: Number, ownerId: Number): Promise\n\t{\n\t\tconst deleteTagActionCfg = {\n\t\t\tdata: {\n\t\t\t\tactivityId: recordId,\n\t\t\t\townerTypeId,\n\t\t\t\townerId,\n\t\t\t},\n\t\t};\n\n\t\treturn Ajax.runAction(\n\t\t\tthis.getDeleteTagActionMethod(),\n\t\t\tdeleteTagActionCfg,\n\t\t).then(() => {\n\t\t\treturn true;\n\t\t}, (response) => {\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\tautoHideDelay: 5000,\n\t\t\t});\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData, animationCallbacks } = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Activity:Edit' && actionData && actionData.activityId)\n\t\t{\n\t\t\tthis.#editActivity(actionData.activityId);\n\t\t}\n\n\t\tif (action === 'Activity:MoveTo' && Type.isPlainObject(actionData))\n\t\t{\n\t\t\tthis.#showMoveToSelectorDialog(item, actionData);\n\t\t}\n\n\t\tif (action === 'Activity:View' && actionData && actionData.activityId)\n\t\t{\n\t\t\tthis.#viewActivity(actionData.activityId);\n\t\t}\n\n\t\tif (action === 'Activity:Delete' && actionData && actionData.activityId)\n\t\t{\n\t\t\tconst confirmationText = actionData.confirmationText ?? '';\n\t\t\tif (confirmationText)\n\t\t\t{\n\t\t\t\tMessageBox.show({\n\t\t\t\t\tmessage: Text.encode(confirmationText),\n\t\t\t\t\tmodal: true,\n\t\t\t\t\tbuttons: MessageBoxButtons.YES_NO,\n\t\t\t\t\tonYes: () => {\n\t\t\t\t\t\treturn this.runDeleteAction(\n\t\t\t\t\t\t\tactionData.activityId,\n\t\t\t\t\t\t\tactionData.ownerTypeId,\n\t\t\t\t\t\t\tactionData.ownerId,\n\t\t\t\t\t\t\tanimationCallbacks,\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t\tonNo: (messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.runDeleteAction(\n\t\t\t\t\tactionData.activityId,\n\t\t\t\t\tactionData.ownerTypeId,\n\t\t\t\t\tactionData.ownerId,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (action === 'Activity:DeleteTag' && actionData && actionData.activityId)\n\t\t{\n\t\t\tconst confirmationText = actionData.confirmationText ?? '';\n\t\t\tif (confirmationText)\n\t\t\t{\n\t\t\t\tMessageBox.show({\n\t\t\t\t\tmessage: Text.encode(confirmationText),\n\t\t\t\t\tmodal: true,\n\t\t\t\t\tbuttons: MessageBoxButtons.YES_CANCEL,\n\t\t\t\t\tyesCaption: Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_TODO_DELETE_TAG_CONFIRM_YES_CAPTION'),\n\t\t\t\t\tonYes: () => {\n\t\t\t\t\t\treturn this.runDeleteTagAction(\n\t\t\t\t\t\t\tactionData.activityId,\n\t\t\t\t\t\t\tactionData.ownerTypeId,\n\t\t\t\t\t\t\tactionData.ownerId,\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t\tonCancel: (messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.runDeleteTagAction(\n\t\t\t\t\tactionData.activityId,\n\t\t\t\t\tactionData.ownerTypeId,\n\t\t\t\t\tactionData.ownerId,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (action === 'Activity:FilterRelated' && Type.isPlainObject(actionData))\n\t\t{\n\t\t\tthis.#filterRelated(actionData);\n\t\t}\n\t}\n\n\t#viewActivity(id): void\n\t{\n\t\tconst editor = this.#getActivityEditor();\n\t\tif (editor && id)\n\t\t{\n\t\t\teditor.viewActivity(id);\n\t\t}\n\t}\n\n\t#editActivity(id): void\n\t{\n\t\tconst editor = this.#getActivityEditor();\n\t\tif (editor && id)\n\t\t{\n\t\t\teditor.editActivity(id);\n\t\t}\n\t}\n\n\t#showMoveToSelectorDialog(\n\t\titemElement: ConfigurableItem,\n\t\tactionData: ActionData,\n\t): void\n\t{\n\t\tif (!ALLOWED_MOVE_TO_ITEM_TYPES.includes(itemElement.getType()))\n\t\t{\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn('Move to action provided only for following item types:', ALLOWED_MOVE_TO_ITEM_TYPES);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst isValidParams = Type.isNumber(actionData.activityId)\n\t\t\t&& Type.isNumber(actionData.ownerId)\n\t\t\t&& Type.isNumber(actionData.ownerTypeId)\n\t\t;\n\t\tif (!isValidParams)\n\t\t{\n\t\t\tthrow new TypeError('Invalid actionData parameters');\n\t\t}\n\n\t\tconst element = itemElement.getLayoutFooterMenu().$el;\n\t\tif (!Type.isDomNode(element))\n\t\t{\n\t\t\tthrow new ReferenceError('Selector dialog target element must be a DOM node');\n\t\t}\n\n\t\tif (!this.#moveToSelectorDialog)\n\t\t{\n\t\t\tthis.#createSelectorDialog(element, actionData);\n\t\t}\n\n\t\tthis.#moveToSelectorDialog.show();\n\t}\n\n\tonBeforeItemClearLayout(item: ConfigurableItem): void\n\t{\n\t\tthis.#moveToSelectorDialog?.hide();\n\t}\n\n\t#getActivityEditor(): BX.CrmActivityEditor\n\t{\n\t\treturn BX.CrmActivityEditor.getDefault();\n\t}\n\n\t#createSelectorDialog(\n\t\tdialogTargetElement: HTMLElement,\n\t\tactionData: ActionData,\n\t): void\n\t{\n\t\tlet dialogEntityId = BX.CrmEntityType.resolveName(actionData.ownerTypeId);\n\t\tif (BX.CrmEntityType.isDynamicTypeByTypeId(actionData.ownerTypeId))\n\t\t{\n\t\t\tdialogEntityId = BX.CrmEntityType.names.dynamic;\n\t\t}\n\n\t\tconst applyButton = new ApplyButton({\n\t\t\tuseAirDesign: true,\n\t\t\tstyle: AirButtonStyle.FILLED,\n\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\tcolor: null,\n\t\t\tround: true,\n\t\t\tonclick: () => {\n\t\t\t\tthis.#runMoveAction(actionData.activityId, actionData.ownerTypeId, actionData.ownerId, targetItem);\n\t\t\t\tthis.#moveToSelectorDialog.hide();\n\t\t\t},\n\t\t});\n\n\t\tconst cancelButton = new CancelButton({\n\t\t\tuseAirDesign: true,\n\t\t\tstyle: AirButtonStyle.OUTLINE,\n\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\tround: true,\n\t\t\tcolor: null,\n\t\t\tonclick: (): void => {\n\t\t\t\ttargetItem = null;\n\t\t\t\tthis.#moveToSelectorDialog.deselectAll();\n\t\t\t\tthis.#moveToSelectorDialog.hide();\n\t\t\t},\n\t\t});\n\n\t\tconst createAndApplyButton: Button | null = actionData.canAddItems\n\t\t\t? this.#getCreateAndApplyButton(actionData, dialogEntityId)\n\t\t\t: null\n\t\t;\n\n\t\tlet targetItem: Item = null;\n\n\t\tthis.#moveToSelectorDialog = new Dialog({\n\t\t\ttargetNode: dialogTargetElement,\n\t\t\tenableSearch: true,\n\t\t\tcontext: `CRM-TIMELINE-MOVE-ACTIVITY-ENTITY-SELECTOR-${actionData.ownerTypeId}`,\n\t\t\ttagSelectorOptions: {\n\t\t\t\ttextBoxWidth: '50%',\n\t\t\t},\n\t\t\tentities: [{\n\t\t\t\tid: dialogEntityId,\n\t\t\t\tdynamicLoad: true,\n\t\t\t\tdynamicSearch: true,\n\t\t\t\toptions: {\n\t\t\t\t\townerId: actionData.ownerId,\n\t\t\t\t\tcategoryId: actionData.categoryId,\n\t\t\t\t\tshowEntityTypeNameInHeader: true,\n\t\t\t\t\thideClosedItems: true,\n\t\t\t\t\texcludeMyCompany: true,\n\t\t\t\t\tentityTypeId: actionData.ownerTypeId, // for 'dynamic' types\n\t\t\t\t},\n\t\t\t}],\n\t\t\tevents: {\n\t\t\t\t'Item:onBeforeSelect': (event: BaseEvent): void => {\n\t\t\t\t\tconst { item } = event.getData();\n\t\t\t\t\tif (item)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (item.getId() === actionData.ownerId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tevent.preventDefault();\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttargetItem = item;\n\t\t\t\t\t\tthis.#moveToSelectorDialog.getSelectedItems().forEach((row: Item) => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\trow.getEntityId() === targetItem.getEntityId()\n\t\t\t\t\t\t\t\t&& Text.toInteger(row.getId()) !== Text.toInteger(targetItem.getId())\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\trow.deselect();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tapplyButton.setDisabled(false);\n\t\t\t\t\t\tcreateAndApplyButton?.setDisabled(true);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (): void => {\n\t\t\t\t\tapplyButton.setDisabled(true);\n\t\t\t\t\tcreateAndApplyButton?.setDisabled(false);\n\t\t\t\t},\n\t\t\t},\n\t\t\tfooter: [\n\t\t\t\tapplyButton.setDisabled(true).render(),\n\t\t\t\tcancelButton.render(),\n\t\t\t\tcreateAndApplyButton?.render(),\n\t\t\t],\n\t\t\tfooterOptions: {\n\t\t\t\tcontainerStyles: {\n\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t'justify-content': 'center',\n\t\t\t\t\tgap: '12px',\n\t\t\t\t\tbackground: 'white',\n\t\t\t\t\theight: 'auto',\n\t\t\t\t\tpadding: '18px 0',\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#getCreateAndApplyButton(\n\t\tactionData: ActionData,\n\t\tdialogEntityId: string,\n\t): Button\n\t{\n\t\tconst newItemUrl = Router.Instance.getItemDetailUrl(actionData.ownerTypeId, 0, actionData.categoryId);\n\n\t\treturn new CreateButton({\n\t\t\tstyle: AirButtonStyle.PLAIN,\n\t\t\tuseAirDesign: true,\n\t\t\tsize: ButtonSize.MEDIUM,\n\t\t\tround: true,\n\t\t\tdisabled: newItemUrl === null,\n\t\t\tcolor: null,\n\t\t\tonclick: (): void => {\n\t\t\t\tif (newItemUrl === null)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.#openItemCreateSlider(String(newItemUrl), actionData, dialogEntityId);\n\t\t\t},\n\t\t});\n\t}\n\n\t#openItemCreateSlider(newItemUrl: Uri, actionData: ActionData, dialogEntityId: string): void\n\t{\n\t\tlet runMoveActionForNewItem = null;\n\n\t\tBX.Crm.Page.openSlider(String(newItemUrl), {\n\t\t\tevents: {\n\t\t\t\tonOpen: ({ slider }): void => {\n\t\t\t\t\trunMoveActionForNewItem = this.#getRunMoveActionForNewItemCallback(slider, actionData, dialogEntityId);\n\n\t\t\t\t\tBX.Crm.EntityEvent.subscribe(runMoveActionForNewItem);\n\t\t\t\t},\n\t\t\t\tonClose: (): void => {\n\t\t\t\t\tBX.Crm.EntityEvent.unsubscribe(runMoveActionForNewItem);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#getRunMoveActionForNewItemCallback(\n\t\tslider,\n\t\tactionData: ActionData,\n\t\tdialogEntityId: string,\n\t): Function\n\t{\n\t\tconst runMoveActionForNewItem = (eventName, eventData) => {\n\t\t\tif (eventName !== 'onCrmEntityCreate' || eventData.entityTypeId !== actionData.ownerTypeId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst newItemEntityEditor = slider.getWindow().BX?.Crm?.EntityEditor?.getDefault();\n\t\t\tif (Type.isNil(newItemEntityEditor))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst isItemCreatedInCurrentSlider = newItemEntityEditor.getEntityId() === eventData.entityId;\n\t\t\tif (!isItemCreatedInCurrentSlider)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst item = new Item({\n\t\t\t\tid: eventData.entityId,\n\t\t\t\tentityId: dialogEntityId,\n\t\t\t});\n\n\t\t\tthis.#runMoveAction(actionData.activityId, actionData.ownerTypeId, actionData.ownerId, item);\n\t\t\tthis.#moveToSelectorDialog.hide();\n\n\t\t\tBX.Crm.EntityEvent.unsubscribe(runMoveActionForNewItem);\n\t\t};\n\n\t\treturn runMoveActionForNewItem;\n\t}\n\n\t#runMoveAction(activityId: Number, sourceEntityTypeId: Number, sourceEntityId: Number, targetItem: ?Item): void\n\t{\n\t\tif (!targetItem)\n\t\t{\n\t\t\tthrow new ReferenceError('Target item is not defined');\n\t\t}\n\n\t\tconst targetEntityTypeId = BX.CrmEntityType.resolveId(targetItem.getEntityId());\n\t\tconst targetEntityId = targetItem.getId();\n\t\tif (targetEntityTypeId <= 0 || targetEntityId <= 0)\n\t\t{\n\t\t\tthrow new Error('Target entity in not valid');\n\t\t}\n\n\t\tif (Text.toInteger(targetEntityTypeId) !== Text.toInteger(sourceEntityTypeId))\n\t\t{\n\t\t\tthrow new Error('Source and target entity types are not equal');\n\t\t}\n\n\t\tconst data = {\n\t\t\tactivityId,\n\t\t\tsourceEntityTypeId,\n\t\t\tsourceEntityId,\n\t\t\ttargetEntityTypeId,\n\t\t\ttargetEntityId,\n\t\t};\n\n\t\tAjax\n\t\t\t.runAction(this.getMoveActionMethod(), { data })\n\t\t\t.catch((response) => {\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t});\n\n\t\t\t\tthrow response;\n\t\t\t});\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\tconst itemType = item.getType();\n\n\t\treturn (\n\t\t\titemType.indexOf('Activity:') === 0 // for items with type started from `Activity:`\n\t\t\t|| itemType === 'TodoCreated' \t\t// TodoCreated can contain link to activity\n\t\t);\n\t}\n\n\t#filterRelated(actionData: { activityId: Number, activityLabel: String, filterId: String }): void\n\t{\n\t\tif (!(Type.isNumber(actionData.activityId)\n\t\t\t&& Type.isStringFilled(actionData.activityLabel)\n\t\t\t&& Type.isStringFilled(actionData.filterId)\n\t\t))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst filterManager = BX.Main.filterManager.getById(actionData.filterId);\n\t\tif (!filterManager)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst filterApi = filterManager.getApi();\n\n\t\tconst fields = {\n\t\t\tACTIVITY: actionData.activityId,\n\t\t\tACTIVITY_label: actionData.activityLabel,\n\t\t};\n\n\t\tfilterApi.extendFilter(fields, true);\n\n\t\tBX.CrmTimelineManager.getDefault().getHistory().showFilter();\n\t}\n}\n","import { Router } from 'crm.router';\nimport { Type } from 'main.core';\nimport ConfigurableItem from '../../configurable-item';\n\nimport { ActionParams, Base } from '../base';\n\nimport 'ui.hint';\n\nexport class CallScoringResult extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'CallScoringResult:Open' && actionData)\n\t\t{\n\t\t\tthis.#open(actionData);\n\t\t}\n\n\t\tif (action === 'CallScoringResult:EditPrompt')\n\t\t{\n\t\t\tthis.#editPrompt(item, actionData);\n\t\t}\n\t}\n\n\tasync #open(actionData: Object): void\n\t{\n\t\tif (\n\t\t\t!Type.isInteger(actionData.activityId)\n\t\t\t|| !Type.isInteger(actionData.ownerTypeId)\n\t\t\t|| !Type.isInteger(actionData.ownerId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tawait top.BX.Runtime.loadExtension('crm.ai.call');\n\n\t\tconst callQualityDlg = new top.BX.Crm.AI.Call.CallQuality({\n\t\t\tactivityId: actionData.activityId,\n\t\t\tactivityCreated: actionData.activityCreated ?? null,\n\t\t\townerTypeId: actionData.ownerTypeId,\n\t\t\townerId: actionData.ownerId,\n\t\t\tclientDetailUrl: actionData.clientDetailUrl ?? null,\n\t\t\tclientFullName: actionData.clientFullName ?? null,\n\t\t\tuserPhotoUrl: actionData.userPhotoUrl ?? null,\n\t\t\tjobId: actionData.jobId ?? null,\n\t\t});\n\n\t\tcallQualityDlg.open();\n\t}\n\n\t#editPrompt(item: ConfigurableItem, actionData: Object): void\n\t{\n\t\tif (!Type.isInteger(actionData.assessmentSettingId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tRouter.openSlider(\n\t\t\t`/crm/copilot-call-assessment/details/${actionData.assessmentSettingId}/`,\n\t\t\t{\n\t\t\t\twidth: 700,\n\t\t\t\tcacheable: false,\n\t\t\t},\n\t\t);\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (item.getType() === 'AI:CallScoringResult');\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { ActionParams, Base } from '../base';\nimport ConfigurableItem from '../../configurable-item';\n\nexport class CallTranscriptResult extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'CallTranscriptResult:Open' && actionData)\n\t\t{\n\t\t\tthis.#open(actionData);\n\t\t}\n\t}\n\n\tasync #open(actionData): void\n\t{\n\t\tif (\n\t\t\t!Type.isInteger(actionData.activityId)\n\t\t\t|| !Type.isInteger(actionData.ownerTypeId)\n\t\t\t|| !Type.isInteger(actionData.ownerId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tawait top.BX.Runtime.loadExtension('crm.ai.call');\n\n\t\tconst transcription = new top.BX.Crm.AI.Call.Transcription({\n\t\t\tactivityId: actionData.activityId,\n\t\t\townerTypeId: actionData.ownerTypeId,\n\t\t\townerId: actionData.ownerId,\n\t\t\tlanguageTitle: actionData.languageTitle,\n\t\t});\n\n\t\ttranscription.open();\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (item.getType() === 'AI:CallTranscriptResult');\n\t}\n}\n","import { ajax, Runtime, Text, Type } from 'main.core';\nimport ConfigurableItem from '../../configurable-item';\n\nimport { ActionAnimationCallbacks, ActionParams, Base } from '../base';\n\nexport class EntityFieldsFillingResult extends Base\n{\n\tasync onItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData, animationCallbacks } = actionParams;\n\n\t\tif (actionType !== 'jsEvent' || !actionData)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (action)\n\t\t{\n\t\t\tcase 'EntityFieldsFillingResult:OpenAiFormFill':\n\t\t\t\tthis.#openAiFormFillAction(actionData);\n\t\t\t\tbreak;\n\t\t\tcase 'EntityFieldsFillingResult:OpenSendFeedbackPopup':\n\t\t\t\tthis.#openSendFeedbackPopup(actionData, animationCallbacks);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\t}\n\n\tasync #openAiFormFillAction(actionData: Object): void\n\t{\n\t\tconst operationStatus = await this.#fetchOperationStatus(actionData.mergeUuid);\n\t\tswitch (operationStatus)\n\t\t{\n\t\t\tcase 'APPLIED':\n\t\t\t\tthis.#openAiDoneSlider();\n\t\t\t\tbreak;\n\t\t\tcase 'CONFLICT':\n\t\t\t\tthis.#openAiFormFill(actionData);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new Error(`Invalid operation status: ${operationStatus}`);\n\t\t}\n\t}\n\n\t#openAiFormFill(actionData: Object): void\n\t{\n\t\tconst mergeUuid = parseInt(actionData.mergeUuid, 10);\n\t\tif (!Type.isInteger(mergeUuid) || mergeUuid <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttop.BX.Runtime.loadExtension('crm.ai.form-fill')\n\t\t\t.then((exports) => {\n\t\t\t\tconst { createAiFormFillApplicationInsideSlider } = exports;\n\n\t\t\t\tcreateAiFormFillApplicationInsideSlider({ ...actionData, mergeUuid });\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tthrow new Error('Cant load createAiFormFillApplicationInsideSlider extension');\n\t\t\t});\n\t}\n\n\t#openAiDoneSlider(): void\n\t{\n\t\ttop.BX.Runtime.loadExtension('crm.ai.done')\n\t\t\t.then((exports) => {\n\t\t\t\tconst { Done } = exports;\n\t\t\t\t(new Done()).start();\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tthrow new Error('Cant load crm.ai.done extension');\n\t\t\t});\n\t}\n\n\tasync #fetchOperationStatus(mergeId: number): Promise<void>\n\t{\n\t\tconst response = await ajax.runAction('crm.timeline.ai.fieldsFillingStatus', {\n\t\t\tdata: { mergeId },\n\t\t});\n\n\t\tif (response.status !== 'success')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn response?.data?.operationStatus;\n\t}\n\n\t#openSendFeedbackPopup(actionData, animationCallbacks: ?ActionAnimationCallbacks): void\n\t{\n\t\tconst mergeUuid: number = parseInt(actionData.mergeUuid, 10);\n\t\tif (!Type.isInteger(mergeUuid) || mergeUuid <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst activityId: number = Text.toInteger(actionData.activityId) > 0 ? Text.toInteger(actionData.activityId) : 0;\n\n\t\tanimationCallbacks?.onStart?.();\n\n\t\tRuntime.loadExtension('crm.ai.feedback')\n\t\t\t.then((exports) => {\n\t\t\t\tconst { showSendFeedbackPopup } = exports;\n\n\t\t\t\t/** @see BX.Crm.AI.Feedback.showSendFeedbackPopup */\n\t\t\t\tshowSendFeedbackPopup(mergeUuid, actionData.ownerTypeId, activityId, actionData.activityDirection);\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tconsole.error('Cant load showSendFeedbackPopup extension');\n\t\t\t}).finally(() => animationCallbacks?.onStop?.());\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (item.getType() === 'AI:EntityFieldsFillingResult');\n\t}\n}\n","import { Type } from 'main.core';\n\nimport { ActionParams, Base } from '../base';\nimport ConfigurableItem from '../../configurable-item';\n\nexport class TranscriptSummaryResult extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'TranscriptSummaryResult:Open' && actionData)\n\t\t{\n\t\t\tthis.#open(actionData);\n\t\t}\n\t}\n\n\tasync #open(actionData): void\n\t{\n\t\tif (\n\t\t\t!Type.isInteger(actionData.activityId)\n\t\t\t|| !Type.isInteger(actionData.ownerTypeId)\n\t\t\t|| !Type.isInteger(actionData.ownerId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tawait top.BX.Runtime.loadExtension('crm.ai.call');\n\n\t\tconst summary = new top.BX.Crm.AI.Call.Summary({\n\t\t\tactivityId: actionData.activityId,\n\t\t\townerTypeId: actionData.ownerTypeId,\n\t\t\townerId: actionData.ownerId,\n\t\t\tlanguageTitle: actionData.languageTitle,\n\t\t\tactivityProvider: actionData.activityProvider,\n\t\t\tjobId: actionData.jobId,\n\t\t});\n\n\t\tsummary.open();\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (item.getType() === 'AI:TranscriptSummaryResult');\n\t}\n}\n","import { Type, Text } from 'main.core';\nimport { ImageStackSteps, imageTypeEnum } from 'ui.image-stack-steps';\nimport 'ui.icon-set.main';\n\nimport 'ui.design-tokens';\nimport '../../css/content-blocks/avatars-stack-steps.css';\n\nconst ICON_COLORS = Object.freeze({\n\tlightGrey: 'var(--crm-timeline-avatars-stack-steps-icon-color-light-gray)',\n\tblue: 'var(--crm-timeline-avatars-stack-steps-icon-color-blue)',\n\tlightGreen: 'var(--crm-timeline-avatars-stack-steps-icon-color-light-green)',\n});\n\nexport default {\n\tprops: {\n\t\tsteps: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t\tvalidator: (value) => {\n\t\t\t\treturn Type.isArrayFilled(value);\n\t\t\t},\n\t\t},\n\t\tstyles: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tdata(): {}\n\t{\n\t\treturn {\n\t\t\tstack: null,\n\t\t};\n\t},\n\tmounted()\n\t{\n\t\tif (this.$refs.controlWrapper)\n\t\t{\n\t\t\tthis.stack = new ImageStackSteps({\n\t\t\t\tsteps: this.convertIconColors(this.steps),\n\t\t\t});\n\t\t\tthis.stack.renderTo(this.$refs.controlWrapper);\n\t\t}\n\t},\n\tupdated()\n\t{\n\t\tif (this.stack)\n\t\t{\n\t\t\tthis.convertIconColors(this.steps).forEach((step) => {\n\t\t\t\tthis.stack.updateStep(step, step.id);\n\t\t\t});\n\t\t}\n\t},\n\tunmounted()\n\t{\n\t\tif (this.stack)\n\t\t{\n\t\t\tthis.stack.destroy();\n\t\t}\n\t},\n\tcomputed: {\n\t\tgetStyles(): {}\n\t\t{\n\t\t\tconst styles = {};\n\n\t\t\tif (this.styles?.minWidth)\n\t\t\t{\n\t\t\t\tstyles['min-width'] = `${Text.toInteger(this.styles.minWidth)}px`;\n\t\t\t}\n\n\t\t\treturn styles;\n\t\t},\n\t},\n\tmethods: {\n\t\tconvertIconColors(steps: []): []\n\t\t{\n\t\t\tconst colors = Object.keys(ICON_COLORS);\n\n\t\t\tsteps.forEach((step) => {\n\t\t\t\tconst images = step.stack.images;\n\t\t\t\tif (Type.isArrayFilled(images))\n\t\t\t\t{\n\t\t\t\t\timages.forEach((image) => {\n\t\t\t\t\t\tif (image.type === imageTypeEnum.ICON)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst color = image.data?.color;\n\t\t\t\t\t\t\tif (colors.includes(color))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\t\t\t\t\timage.data.color = ICON_COLORS[color];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn steps;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"crm-timeline__avatars-stack-steps\" ref=\"controlWrapper\" :style=\"getStyles\"></div>\n\t`,\n};\n","export const TaskUserStatus = Object.freeze({\n\tWAITING: 0,\n\tYES: 1,\n\tNO: 2,\n\tOK: 3,\n\tCANCEL: 4,\n});\n","import { ajax, Runtime, Text, Type, Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { UI } from 'ui.notification';\nimport AvatarsStackSteps from '../../components/content-blocks/avatars-stack-steps';\nimport { ActionParams, Base } from '../base';\nimport ConfigurableItem from '../../configurable-item';\nimport { ButtonState } from '../../components/enums/button-state';\nimport { TaskUserStatus } from './enums/task-user-status';\n\nexport class Bizproc extends Base\n{\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\tconst supportedItemTypes = [\n\t\t\t'BizprocWorkflowStarted',\n\t\t\t'BizprocWorkflowCompleted',\n\t\t\t'BizprocWorkflowTerminated',\n\t\t\t'BizprocTaskCreation',\n\t\t\t'BizprocTaskCompleted',\n\t\t\t'BizprocCommentAdded',\n\t\t\t'BizprocCommentRead',\n\t\t\t'BizprocTaskDelegated',\n\t\t\t'Activity:BizprocWorkflowCompleted',\n\t\t\t'Activity:BizprocCommentAdded',\n\t\t\t'Activity:BizprocTask',\n\t\t];\n\n\t\treturn supportedItemTypes.includes(item.getType());\n\t}\n\n\tgetContentBlockComponents(item: ConfigurableItem): Object\n\t{\n\t\treturn {\n\t\t\tAvatarsStackSteps,\n\t\t};\n\t}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst actionHandlers = {\n\t\t\t'Bizproc:Task:Open': () => this.#openWorkflowTaskSlider(actionData),\n\t\t\t'Bizproc:Task:Do': () => this.#handleTaskAction(actionData, item),\n\t\t\t'Bizproc:Workflow:Timeline:Open': () => this.#openTimeline(actionData),\n\t\t\t'Bizproc:Workflow:Open': () => this.#openWorkflowSlider(actionData),\n\t\t\t'Bizproc:Workflow:Terminate': () => this.#terminateWorkflow(actionData),\n\t\t\t'Bizproc:Workflow:Log': () => this.#openWorkflowLogSlider(actionData),\n\t\t};\n\n\t\tconst handler = actionHandlers[action];\n\n\t\tif (handler)\n\t\t{\n\t\t\thandler();\n\t\t}\n\t}\n\n\t#handleTaskAction(actionData: Object, item: ConfigurableItem): void\n\t{\n\t\tconst responsibleId = Text.toInteger(actionData?.responsibleId);\n\t\tif (responsibleId > 0 && Text.toInteger(item.getCurrentUser()?.userId) === responsibleId)\n\t\t{\n\t\t\tthis.#doTask(actionData, item);\n\n\t\t\treturn;\n\t\t}\n\n\t\tUI.Notification.Center.notify({\n\t\t\tcontent: Text.encode(Loc.getMessage('CRM_TIMELINE_ITEM_BIZPROC_TASK_DO_ACTION_ACCESS_DENIED')),\n\t\t\tautoHideDelay: 5000,\n\t\t});\n\t}\n\n\t#openWorkflowLogSlider(actionData)\n\t{\n\t\tthis.#openSlider(actionData, (Router, { workflowId }) => {\n\t\t\tif (Router && workflowId)\n\t\t\t{\n\t\t\t\tRouter.openWorkflowLog(workflowId);\n\t\t\t}\n\t\t});\n\t}\n\n\t#openWorkflowSlider(actionData)\n\t{\n\t\tthis.#openSlider(actionData, (Router, { workflowId }) => {\n\t\t\tif (Router && workflowId)\n\t\t\t{\n\t\t\t\tRouter.openWorkflow(workflowId);\n\t\t\t}\n\t\t});\n\t}\n\n\t#openWorkflowTaskSlider(actionData) {\n\t\tthis.#openSlider(actionData, (Router, { taskId, userId }) => {\n\t\t\tif (Router && taskId)\n\t\t\t{\n\t\t\t\tRouter.openWorkflowTask(Text.toInteger(taskId), Text.toInteger(userId));\n\t\t\t}\n\t\t});\n\t}\n\n\tasync #openSlider(actionData, callback)\n\t{\n\t\tif (!actionData)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tconst { Router } = await Runtime.loadExtension('bizproc.router');\n\t\t\tcallback(Router, actionData);\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tconsole.error(e);\n\t\t}\n\t}\n\n\t#openTimeline(actionData: Object): void\n\t{\n\t\tconst workflowId = actionData?.workflowId;\n\t\tif (!workflowId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tRuntime\n\t\t\t.loadExtension('bizproc.workflow.timeline')\n\t\t\t.then(() => {\n\t\t\t\tBX.Bizproc.Workflow.Timeline.open({ workflowId });\n\t\t\t})\n\t\t\t.catch((response) => console.error(response.errors));\n\t}\n\n\t#terminateWorkflow(actionData: Object): void\n\t{\n\t\tconst workflowId = actionData?.workflowId;\n\t\tif (!workflowId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tajax.runAction('bizproc.workflow.terminate', { data: { workflowId } })\n\t\t\t.catch((response) => {\n\t\t\t\tresponse.errors.forEach((error) => {\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: error.message,\n\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\t#doTask(actionData: Object, item: ConfigurableItem)\n\t{\n\t\tconst taskId = actionData?.taskId;\n\t\tif (!taskId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst value = actionData?.value;\n\t\tconst name = actionData?.name;\n\n\t\tif (Type.isStringFilled(name) && Type.isStringFilled(value))\n\t\t{\n\t\t\tconst buttons = (\n\t\t\t\tObject.values(TaskUserStatus)\n\t\t\t\t\t.map((status) => {\n\t\t\t\t\t\treturn item.getLayoutFooterButtonById(`status_${status}`);\n\t\t\t\t\t})\n\t\t\t\t\t.filter((button) => button)\n\t\t\t);\n\n\t\t\tbuttons.forEach((button) => {\n\t\t\t\tbutton.setButtonState(ButtonState.DISABLED);\n\t\t\t});\n\n\t\t\tconst data = { taskId, taskRequest: { [name]: value } };\n\t\t\tajax.runAction('bizproc.task.do', { data })\n\t\t\t\t.then(() => {}) // waiting push\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tresponse.errors.forEach((error) => {\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: Text.encode(error.message),\n\t\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tbuttons.forEach((button) => {\n\t\t\t\t\t\tbutton.setButtonState(ButtonState.DEFAULT);\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t}\n\n\tonAfterItemLayout(item: ConfigurableItem, options): void\n\t{\n\t\tEventEmitter.emit(\n\t\t\t'BX.Crm.Timeline.Items.Bizproc:onAfterItemLayout',\n\t\t\t{\n\t\t\t\ttarget: item.getWrapper(),\n\t\t\t\tid: item.getId(),\n\t\t\t\ttype: item.getType(),\n\t\t\t\toptions,\n\t\t\t},\n\t\t);\n\t}\n}\n","import { Runtime } from 'main.core';\nimport type { CyclePopupOpener, CardId } from 'booking.component.cycle-popup';\n\nexport function showCyclePopup(status: string): void\n{\n\tvoid Runtime.loadExtension('booking.component.cycle-popup')\n\t\t.then((CyclePopup: { CardId: CardId, cyclePopupOpener: CyclePopupOpener }): void => {\n\t\t\tconst scrollToCard = {\n\t\t\t\tnot_confirmed: CyclePopup.CardId.Unconfirmed,\n\t\t\t\tconfirmed: CyclePopup.CardId.Confirmed,\n\t\t\t\tsuccess: CyclePopup.CardId.Confirmed,\n\t\t\t\tlate: CyclePopup.CardId.Late,\n\t\t\t\tfailed: CyclePopup.CardId.Late,\n\t\t\t\twaitlist: CyclePopup.CardId.Waitlist,\n\t\t\t\toverbooking: CyclePopup.CardId.Overbooking,\n\t\t\t}[status];\n\n\t\t\tCyclePopup.cyclePopupOpener.show({ context: 'crm', scrollToCard });\n\t\t})\n\t;\n}\n","import { ActionParams, Base } from '../base';\nimport ConfigurableItem from 'crm.timeline.item';\nimport { showCyclePopup } from './show-cycle-popup';\n\nexport class Booking extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === `${item.getType()}:ShowBooking`)\n\t\t{\n\t\t\tconst url = `/booking/?editingBookingId=${actionData.id}`;\n\t\t\tBX.SidePanel.Instance.open(url, {\n\t\t\t\tcustomLeftBoundary: 0,\n\t\t\t});\n\t\t}\n\n\t\tif (action === `${item.getType()}:ShowSku`)\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(actionData.url);\n\t\t}\n\n\t\tif (action === `${item.getType()}:ShowCyclePopup`)\n\t\t{\n\t\t\tshowCyclePopup(actionData.status);\n\t\t}\n\n\t\tif (action === `${item.getType()}:ShowInfoHelper`)\n\t\t{\n\t\t\tBX.UI?.InfoHelper?.show(actionData.code);\n\t\t}\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn item.getType() === 'Activity:Booking';\n\t}\n}\n","import { ActionParams, Base } from '../base';\nimport ConfigurableItem from 'crm.timeline.item';\nimport { showCyclePopup } from './show-cycle-popup';\n\nexport class WaitListItem extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === `${item.getType()}:ShowWaitListItem`)\n\t\t{\n\t\t\tconst url = `/booking/?editingWaitListItemId=${actionData.id}`;\n\t\t\tBX.SidePanel.Instance.open(url, {\n\t\t\t\tcustomLeftBoundary: 0,\n\t\t\t});\n\t\t}\n\n\t\tif (action === `${item.getType()}:ShowCyclePopup`)\n\t\t{\n\t\t\tshowCyclePopup(actionData.status);\n\t\t}\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn item.getType() === 'Activity:WaitListItem';\n\t}\n}\n","import { Dom, Loc, Tag, Event, Text } from 'main.core';\nimport { Util } from 'calendar.util';\nimport { Popup, PopupOptions } from 'main.popup';\n\ntype RuleData = {\n\trule: {\n\t\tfrom: number,\n\t\tto: number,\n\t\tslotSize: number,\n\t\tweekdays: string[],\n\t\tweekdaysTitle: string,\n\t},\n\tdurationFormatted: string,\n\tweekdaysFormatted: string,\n};\n\nexport default {\n\tdata(): Object {\n\t\treturn {\n\t\t\tpopup: null,\n\t\t\tmoreLinkRef: null,\n\t\t};\n\t},\n\tprops: {\n\t\tlistItems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tconst moreLink = this.$el.querySelector('[data-anchor=\"more-link\"]');\n\t\tif (!moreLink)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.moreLinkRef = moreLink;\n\n\t\tEvent.bind(this.moreLinkRef, 'click', () => this.openPopup());\n\t\tDom.append(Tag.render`<i/>`, this.moreLinkRef);\n\t},\n\tcomputed: {\n\t\titems(): RuleData[]\n\t\t{\n\t\t\treturn this.listItems.map((item) => item.properties);\n\t\t},\n\t\tformattedRules(): string[]\n\t\t{\n\t\t\treturn this.items.map((item) => this.createItemText(item));\n\t\t},\n\t\tfirstFormattedRule(): string\n\t\t{\n\t\t\tif (this.doShowMoreLink)\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('CRM_TIMELINE_ITEM_CALENDAR_SHARING_SLOTS_RANGE_WITH_MORE', {\n\t\t\t\t\t'#RANGE#': this.formattedRules[0],\n\t\t\t\t\t'#MORE_LINK_CLASS#': 'crm-timeline-calendar-sharing-slots-more',\n\t\t\t\t\t'#AMOUNT#': this.items.length - 1,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn this.formattedRules[0] ?? '';\n\t\t},\n\t\tformattedDuration(): string\n\t\t{\n\t\t\treturn Loc.getMessage(\n\t\t\t\t'CRM_TIMELINE_ITEM_CALENDAR_SHARING_SLOTS_DURATION',\n\t\t\t\t{ '#DURATION#': this.items[0].durationFormatted },\n\t\t\t);\n\t\t},\n\t\tdoShowMoreLink(): boolean\n\t\t{\n\t\t\treturn this.items.length > 1;\n\t\t},\n\t},\n\tmethods: {\n\t\tcreateItemText(item: RuleData): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_TIMELINE_ITEM_CALENDAR_SHARING_SLOTS_RANGE_V3', {\n\t\t\t\t'#WEEKDAYS#': Text.encode(item.weekdaysFormatted),\n\t\t\t\t'#FROM_TIME#': this.formatMinutes(item.rule.from),\n\t\t\t\t'#TO_TIME#': this.formatMinutes(item.rule.to),\n\t\t\t});\n\t\t},\n\t\tformatMinutes(minutes): string\n\t\t{\n\t\t\tconst date = new Date(Util.parseDate('01.01.2000').getTime() + minutes * 60 * 1000);\n\n\t\t\treturn Util.formatTime(date);\n\t\t},\n\t\topenPopup()\n\t\t{\n\t\t\tif (!this.moreLinkRef || this.popup?.isShown())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.popup = new Popup(this.getPopupOptions());\n\t\t\tthis.popup.show();\n\t\t},\n\t\tgetPopupOptions(): PopupOptions {\n\t\t\treturn {\n\t\t\t\tcontent: this.getPopupContent(),\n\t\t\t\tautoHide: true,\n\t\t\t\tcacheable: false,\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tbindElement: this.moreLinkRef,\n\t\t\t\tcloseByEsc: true,\n\t\t\t};\n\t\t},\n\t\tgetPopupContent(): HTMLElement {\n\t\t\tconst root = Tag.render`<div></div>`;\n\t\t\tthis.formattedRules.forEach((item) => {\n\t\t\t\tDom.append(Tag.render`<div class=\"crm-timeline-calendar-sharing-slots-more-popup-item\">${item}</div>`, root);\n\t\t\t});\n\n\t\t\treturn root;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"crm-timeline-calendar-sharing-slots\">\n\t\t\t<div class=\"crm-timeline-calendar-sharing-slots-block\" v-html=\"firstFormattedRule\"/>\n\t\t\t<div class=\"crm-timeline-calendar-sharing-slots-block\">\n\t\t\t\t{{formattedDuration}}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { ajax as Ajax, Dom, Loc, Tag, Text, Type } from 'main.core';\nimport { MenuManager, PopupManager, Menu } from 'main.popup';\nimport { ActionParams, Base } from '../base';\nimport ConfigurableItem from 'crm.timeline.item';\nimport SharingSlotsList from '../../components/content-blocks/calendar/sharing-slots-list';\nimport { Router } from 'crm.router';\nimport { DialogQr } from 'calendar.sharing.interface';\nimport { UI } from 'ui.notification';\n\nexport class Sharing extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'CalendarSharingInvitationSent:ShowMembers' || action === 'Activity:CalendarSharing:ShowMembers')\n\t\t{\n\t\t\tthis.#openMembersPopup(item, Object.values(actionData.members));\n\t\t}\n\n\t\tif (action === 'Activity:CalendarSharing:OpenCalendarEvent')\n\t\t{\n\t\t\tthis.#openCalendarEvent(item, actionData);\n\t\t}\n\n\t\tif (action === 'Activity:CalendarSharing:StartVideoconference')\n\t\t{\n\t\t\tthis.#startVideoconference(item, actionData);\n\t\t}\n\n\t\tif (action === 'CalendarSharingLinkCopied:OpenPublicPageInNewTab')\n\t\t{\n\t\t\twindow.open(actionData.url);\n\t\t}\n\n\t\tif (action === 'CalendarSharingInvitationSent:ShowQr')\n\t\t{\n\t\t\tconst dialogQr = new DialogQr({\n\t\t\t\tsharingUrl: actionData.url,\n\t\t\t\tcontext: 'crm',\n\t\t\t});\n\t\t\tdialogQr.show();\n\t\t}\n\n\t\tif (action === 'Activity:CalendarSharing:CopyLink')\n\t\t{\n\t\t\tconst isSuccess = BX.clipboard.copy(actionData.url);\n\t\t\tif (isSuccess)\n\t\t\t{\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('CRM_TIMELINE_ITEM_LINK_IS_COPIED_SHORT'),\n\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t#openCalendarEvent(item, actionData): void\n\t{\n\t\treturn Router.Instance.openCalendarEventSlider(actionData.eventId, actionData.isSharing);\n\t}\n\n\tasync #startVideoconference(item, actionData): Promise<void>\n\t{\n\t\tlet response = null;\n\n\t\ttry\n\t\t{\n\t\t\tresponse = await Ajax.runAction('crm.timeline.calendar.sharing.getConferenceChatId', {\n\t\t\t\tdata: {\n\t\t\t\t\teventId: actionData.eventId,\n\t\t\t\t\townerId: actionData.ownerId,\n\t\t\t\t\townerTypeId: actionData.ownerTypeId,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\tcatch (responseWithError)\n\t\t{\n\t\t\tconsole.error(responseWithError);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst chatId = response.data.chatId;\n\t\tif (top.window.BXIM && chatId)\n\t\t{\n\t\t\ttop.window.BXIM.openMessenger(`chat${parseInt(chatId, 10)}`);\n\t\t}\n\t}\n\n\tgetContentBlockComponents(Item: ConfigurableItem): Object\n\t{\n\t\treturn {\n\t\t\tSharingSlotsList,\n\t\t};\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn item.getType() === 'CalendarSharingInvitationSent'\n\t\t\t|| item.getType() === 'CalendarSharing'\n\t\t\t|| item.getType() === 'Activity:CalendarSharing'\n\t\t\t|| item.getType() === 'CalendarSharingLinkCopied'\n\t\t;\n\t}\n\n\t#openMembersPopup(item: ConfigurableItem, members: Array): void\n\t{\n\t\tconst moreButton = item.getContainer().querySelector('[data-id=\"sharing_member_more_button\"]');\n\t\tif (!moreButton)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst existingPopup = PopupManager.getPopupById(`sharing_members_popup_${item.getId()}`);\n\t\tif (existingPopup)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menu: Menu = MenuManager.create({\n\t\t\tid: `sharing_members_popup_${item.getId()}`,\n\t\t\tbindElement: moreButton,\n\t\t\tcacheable: false,\n\t\t\tclassName: 'crm-timeline-sharing-members-popup',\n\t\t\tmaxHeight: 500,\n\t\t\tmaxWidth: 300,\n\t\t\tanimation: 'fading-slide',\n\t\t\tcloseByEsc: true,\n\t\t\titems: members.map((member) => ({\n\t\t\t\thtml: this.#renderMemberMenuItem(member),\n\t\t\t\tonclick: () => menu.close(),\n\t\t\t})),\n\t\t});\n\n\t\tmenu.show();\n\t}\n\n\t#renderMemberMenuItem(member)\n\t{\n\t\tconst { root, icon } = Tag.render`\n\t\t\t<a class=\"crm-timeline-sharing-members-popup-item\" href=\"${member.SHOW_URL}\" target=\"_blank\">\n\t\t\t\t<div class=\"ui-icon ui-icon-common-user crm-timeline-sharing-members-popup-item-image\">\n\t\t\t\t\t<i ref=\"icon\"></i>\n\t\t\t\t</div>\n\t\t\t\t<span class=\"crm-timeline-sharing-members-popup-item-title\">\n\t\t\t\t\t${Text.encode(member.FORMATTED_NAME)}\n\t\t\t\t</span>\n\t\t\t</a>\n\t\t`;\n\n\t\tif (Type.isStringFilled(member.PHOTO_URL))\n\t\t{\n\t\t\tDom.style(icon, 'background-image', `url('${encodeURI(Text.encode(member.PHOTO_URL))}')`);\n\t\t}\n\n\t\treturn root;\n\t}\n}\n","import { Router } from 'crm.router';\nimport { ajax as Ajax, Loc, Runtime, Text, Type } from 'main.core';\nimport { Button as ButtonUI, ButtonState } from 'ui.buttons';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\nimport { UI } from 'ui.notification';\n\nimport { Button } from '../../components/layout/button';\nimport ConfigurableItem from '../../configurable-item';\nimport { Base } from '../base';\n\nconst COPILOT_BUTTON_DISABLE_DELAY = 5000;\nconst COPILOT_HELPDESK_CODE = 18_799_442;\n\ndeclare type CoPilotAdditionalInfoData =\n{\n\tsliderCode: ?string,\n\tisAiMarketplaceAppsExist: ?boolean,\n\tisCopilotBannerNeedShow: ?boolean,\n\tcode: ?string,\n\tmsgPlainText: ?string,\n\tmsgHtml: ?string,\n\tmsgBBCode: ?string,\n}\n\nexport type CopilotConfig =\n{\n\tactionEndpoint: string,\n\tvalidEntityTypes: Array<number>,\n\tagreementContext: string,\n\tonPreLaunch?: (item: ConfigurableItem, actionData: Object) => void,\n\tonPostLaunch?: (item: ConfigurableItem, actionData: Object, response: Object) => void,\n\tonError?: (item: ConfigurableItem, actionData: Object, error: Object) => void,\n}\n\nexport class CopilotBase extends Base\n{\n\t#copilotConfig: CopilotConfig;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.#copilotConfig = this.getCopilotConfig();\n\t}\n\n\t// region Methods to override\n\tgetCopilotConfig(): CopilotConfig\n\t{\n\t\tconsole.error('Method \"getCopilotConfig\" must be overridden');\n\t}\n\n\tshowCopilotBanner(item: ConfigurableItem, actionData: Object): void\n\t{}\n\n\tgetAdditionalRequestData(actionData: Object): Object\n\t{\n\t\treturn {};\n\t}\n\n\tuseInfoHelper(): boolean\n\t{\n\t\treturn false;\n\t}\n\n\tsupportsCopilotBanner(): boolean\n\t{\n\t\treturn false;\n\t}\n\t// endregion\n\n\tasync handleCopilotLaunch(item: ConfigurableItem, actionData: Object): Promise<void>\n\t{\n\t\tconst isCopilotAgreementNeedShow = actionData.isCopilotAgreementNeedShow || false;\n\t\tif (isCopilotAgreementNeedShow)\n\t\t{\n\t\t\tawait this.#showCopilotAgreement(item, actionData);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#launchCopilot(item, actionData);\n\t\t}\n\t}\n\n\tshowMarketMessageBox(): void\n\t{\n\t\tMessageBox.show({\n\t\t\ttitle: Loc.getMessage('CRM_TIMELINE_ITEM_AI_PROVIDER_POPUP_TITLE'),\n\t\t\tmessage: Loc.getMessage('CRM_TIMELINE_ITEM_AI_PROVIDER_POPUP_TEXT', {\n\t\t\t\t'[helpdesklink]': `<br><br><a href=\"##\" onclick=\"top.BX.Helper.show('redirect=detail&code=${COPILOT_HELPDESK_CODE}');\">`,\n\t\t\t\t'[/helpdesklink]': '</a>',\n\t\t\t}),\n\t\t\tmodal: true,\n\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\tokCaption: Loc.getMessage('CRM_TIMELINE_ITEM_AI_PROVIDER_POPUP_OK_TEXT'),\n\t\t\tonOk: () => Router.openSlider(Loc.getMessage('AI_APP_COLLECTION_MARKET_LINK')),\n\t\t\tonCancel: (messageBox) => messageBox.close(),\n\t\t});\n\t}\n\n\tasync #showCopilotAgreement(item: ConfigurableItem, actionData: Object): Promise<void>\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst { CopilotAgreement } = await Runtime.loadExtension('ai.copilot-agreement');\n\n\t\t\tconst copilotAgreementPopup = new CopilotAgreement({\n\t\t\t\tmoduleId: 'crm',\n\t\t\t\tcontextId: this.#copilotConfig.agreementContext,\n\t\t\t\tevents: {\n\t\t\t\t\tonAccept: () => this.#launchCopilot(item, actionData),\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst isAgreementAccepted = await copilotAgreementPopup.checkAgreement();\n\t\t\tif (isAgreementAccepted)\n\t\t\t{\n\t\t\t\tthis.#launchCopilot(item, actionData);\n\t\t\t}\n\t\t}\n\t\tcatch\n\t\t{\n\t\t\tawait console.error('Cant load \"ai.copilot-agreement\" extension');\n\t\t}\n\t}\n\n\t#launchCopilot(item: ConfigurableItem, actionData: Object): void\n\t{\n\t\tif (!this.#validateCopilotParams(actionData))\n\t\t{\n\t\t\tthrow new Error('Invalid \"actionData\" parameters');\n\t\t}\n\n\t\tconst aiCopilotBtn = this.#getCopilotButton(item);\n\t\tconst aiCopilotBtnUI = aiCopilotBtn.getUiButton();\n\t\tconst prevState = aiCopilotBtnUI.getState();\n\n\t\tif (aiCopilotBtnUI.getState() === ButtonState.AI_WAITING)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#copilotConfig.onPreLaunch?.(item, actionData);\n\n\t\taiCopilotBtnUI.setState(ButtonState.AI_WAITING);\n\n\t\tthis.#executeCopilotRequest(actionData)\n\t\t\t.then((response) => {\n\t\t\t\tthis.#copilotConfig.onPostLaunch?.(item, actionData, response);\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.#handleCopilotError(item, actionData, response, aiCopilotBtnUI, prevState);\n\t\t\t});\n\t}\n\n\t#validateCopilotParams(actionData: Object): boolean\n\t{\n\t\treturn Type.isNumber(actionData.activityId)\n\t\t\t&& Type.isNumber(actionData.ownerId)\n\t\t\t&& Type.isNumber(actionData.ownerTypeId)\n\t\t\t&& this.#copilotConfig.validEntityTypes.includes(parseInt(actionData.ownerTypeId, 10))\n\t\t;\n\t}\n\n\t#getCopilotButton(item: ConfigurableItem): Button\n\t{\n\t\tconst aiCopilotBtn = item.getLayoutFooterButtonById('aiButton');\n\t\tif (!aiCopilotBtn)\n\t\t{\n\t\t\tthrow new Error('\"CoPilot\" button is not found in layout');\n\t\t}\n\n\t\treturn aiCopilotBtn;\n\t}\n\n\t#executeCopilotRequest(actionData: Object): Promise\n\t{\n\t\treturn Ajax.runAction(this.#copilotConfig.actionEndpoint, {\n\t\t\tdata: {\n\t\t\t\tactivityId: actionData.activityId,\n\t\t\t\townerTypeId: actionData.ownerTypeId,\n\t\t\t\townerId: actionData.ownerId,\n\t\t\t\t...this.getAdditionalRequestData(actionData),\n\t\t\t},\n\t\t});\n\t}\n\n\t#handleCopilotError(\n\t\titem: ConfigurableItem,\n\t\tactionData: Object,\n\t\tresponse: Object,\n\t\tbtnUI: ButtonUI,\n\t\tprevState: string,\n\t): void\n\t{\n\t\tconst customData: ?CoPilotAdditionalInfoData = response.errors[0].customData;\n\t\tif (customData)\n\t\t{\n\t\t\tthis.#showAdditionalInfo(customData, item, actionData);\n\n\t\t\tbtnUI.setState(prevState || ButtonState.ACTIVE);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#showGenericError(response, btnUI);\n\t\t}\n\n\t\tthis.#copilotConfig.onError?.(item, actionData, response);\n\n\t\tthrow response;\n\t}\n\n\t#showGenericError(response: Object, btnUI: ButtonUI): void\n\t{\n\t\tbtnUI.setState(ButtonState.DISABLED);\n\n\t\tUI.Notification.Center.notify({\n\t\t\tcontent: Text.encode(response.errors[0].message),\n\t\t\tautoHideDelay: COPILOT_BUTTON_DISABLE_DELAY,\n\t\t});\n\n\t\tsetTimeout(() => {\n\t\t\tbtnUI.setState(ButtonState.ACTIVE);\n\t\t}, COPILOT_BUTTON_DISABLE_DELAY);\n\t}\n\n\t#showAdditionalInfo(data: CoPilotAdditionalInfoData, item: ConfigurableItem, actionData: Object): void\n\t{\n\t\tif (this.#isSliderCodeExist(data))\n\t\t{\n\t\t\tthis.#handleSliderCode(data, item);\n\t\t}\n\t\telse if (this.#isAiMarketplaceAppsExist(data))\n\t\t{\n\t\t\tif (this.#shouldShowCopilotBanner(data))\n\t\t\t{\n\t\t\t\tthis.showCopilotBanner(item, actionData);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showMarketMessageBox();\n\t\t\t}\n\t\t}\n\t\telse if (data.code === 'blocked_provider')\n\t\t{\n\t\t\tif (Type.isStringFilled(data.sliderCode))\n\t\t\t{\n\t\t\t\tthis.#showInfoSlider(data.sliderCode);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet msg = '';\n\t\t\tif (Type.isStringFilled(data.msgPlainText))\n\t\t\t{\n\t\t\t\tmsg = data.msgPlainText;\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(data.msgHtml))\n\t\t\t{\n\t\t\t\tmsg = data.msgHtml;\n\t\t\t}\n\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: msg,\n\t\t\t\tautoHideDelay: COPILOT_BUTTON_DISABLE_DELAY,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#showFeedbackMessageBox();\n\t\t}\n\t}\n\n\t#shouldShowCopilotBanner(data: CoPilotAdditionalInfoData): boolean\n\t{\n\t\treturn data.isCopilotBannerNeedShow && this.supportsCopilotBanner();\n\t}\n\n\t#handleSliderCode(data: CoPilotAdditionalInfoData, item: ConfigurableItem): void\n\t{\n\t\tif (data.sliderCode === 'limit_boost_copilot')\n\t\t{\n\t\t\tvoid this.#showBoostLimitSlider(item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#showInfoSlider(data.sliderCode);\n\t\t}\n\t}\n\n\tasync #showBoostLimitSlider(item: ConfigurableItem): Promise<void>\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst { ServiceWidget, Analytics } = await Runtime.loadExtension('baas.store');\n\t\t\tif (!ServiceWidget)\n\t\t\t{\n\t\t\t\tthis.#showFallbackBoostLimit();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst serviceWidget = ServiceWidget?.getInstanceByCode('ai_copilot_token');\n\t\t\tconst bindElement = item.getLayoutFooterButtonById('aiButton')?.getUiButton()?.getContainer();\n\n\t\t\tserviceWidget.bind(bindElement, Analytics.CONTEXT_CRM);\n\t\t\tserviceWidget.show(bindElement);\n\t\t\tserviceWidget.getPopup().adjustPosition({ forceTop: true });\n\t\t}\n\t\tcatch\n\t\t{\n\t\t\tthis.#showFallbackBoostLimit();\n\n\t\t\tawait console.error('Cant load \"baas.store\" extension');\n\t\t}\n\t}\n\n\t#showFallbackBoostLimit(): void\n\t{\n\t\tif (this.useInfoHelper())\n\t\t{\n\t\t\tBX?.UI?.InfoHelper.show('limit_boost_copilot');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvoid FeaturePromotersRegistry.getPromoter({ code: 'limit_boost_copilot' }).show();\n\t\t}\n\t}\n\n\t#showInfoSlider(sliderCode: string): void\n\t{\n\t\tif (sliderCode?.includes('redirect=detail&code'))\n\t\t{\n\t\t\ttop.BX.Helper.show(sliderCode);\n\t\t}\n\t\telse if (this.useInfoHelper())\n\t\t{\n\t\t\tBX?.UI?.InfoHelper.show(sliderCode);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tFeaturePromotersRegistry.getPromoter({ code: sliderCode }).show();\n\t\t}\n\t}\n\n\t#showFeedbackMessageBox(): void\n\t{\n\t\tMessageBox.show({\n\t\t\ttitle: Loc.getMessage('CRM_TIMELINE_ITEM_NO_AI_PROVIDER_POPUP_TITLE'),\n\t\t\tmessage: Loc.getMessage('CRM_TIMELINE_ITEM_NO_AI_PROVIDER_POPUP_TEXT'),\n\t\t\tmodal: true,\n\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\tokCaption: Loc.getMessage('CRM_TIMELINE_ITEM_NO_AI_PROVIDER_POPUP_OK_TEXT'),\n\t\t\tonOk: (messageBox) => {\n\t\t\t\tmessageBox.close();\n\t\t\t\tthis.#openFeedbackForm();\n\t\t\t},\n\t\t\tonCancel: (messageBox) => messageBox.close(),\n\t\t});\n\t}\n\n\t#openFeedbackForm(): void\n\t{\n\t\tBX.UI.Feedback.Form.open({\n\t\t\tid: 'b24_ai_provider_partner_crm_feedback',\n\t\t\tforms: [{\n\t\t\t\tzones: ['cn'],\n\t\t\t\tid: 678,\n\t\t\t\tlang: 'cn',\n\t\t\t\tsec: 'wyufoe',\n\t\t\t}, {\n\t\t\t\tzones: ['vn'],\n\t\t\t\tid: 680,\n\t\t\t\tlang: 'vn',\n\t\t\t\tsec: '2v97xr',\n\t\t\t}, {\n\t\t\t\tzones: ['en'],\n\t\t\t\tid: 682,\n\t\t\t\tlang: 'en',\n\t\t\t\tsec: '3sd3le',\n\t\t\t}],\n\t\t});\n\t}\n\n\t#isSliderCodeExist(data: CoPilotAdditionalInfoData): boolean\n\t{\n\t\treturn Object.hasOwn(data, 'sliderCode') && Type.isStringFilled(data.sliderCode);\n\t}\n\n\t#isAiMarketplaceAppsExist(data: CoPilotAdditionalInfoData): boolean\n\t{\n\t\treturn Object.hasOwn(data, 'isAiMarketplaceAppsExist')\n\t\t\t&& Type.isBoolean(data.isAiMarketplaceAppsExist)\n\t\t\t&& data.isAiMarketplaceAppsExist\n\t\t;\n\t}\n}\n","import { Engine } from 'ai.engine';\nimport { Event, Loc, Runtime, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Button as ButtonUI, ButtonState } from 'ui.buttons';\n\nimport 'ui.feedback.form';\n\nimport { Button } from '../components/layout/button';\nimport ConfigurableItem from '../configurable-item';\nimport type { CopilotConfig } from './ai/copilot-base';\nimport { CopilotBase } from './ai/copilot-base';\nimport type { ActionParams } from './base';\n\nconst COPILOT_BUTTON_NUMBER_OF_MANUAL_STARTS_WITHOUT_BOOST_LIMIT = 2;\nconst COPILOT_BUTTON_NUMBER_OF_MANUAL_STARTS_WITH_BOOST_LIMIT = 5;\n\nconst FULL_SCENARIO = 'full';\nconst FILL_FIELDS_SCENARIO = 'fill_fields';\nconst CALL_SCORING_SCENARIO = 'call_scoring';\n\nexport class Call extends CopilotBase\n{\n\t#isCopilotWelcomeTourShown: boolean = false;\n\t#isCopilotBannerShown: boolean = false;\n\n\t// region Base overridden methods\n\tonInitialize(item: ConfigurableItem): void\n\t{\n\t\tthis.#showCopilotWelcomeTour(item);\n\t\tthis.#bindAdditionalCopilotActions(item);\n\t}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Call:MakeCall' && actionData)\n\t\t{\n\t\t\tthis.#makeCall(actionData);\n\t\t}\n\n\t\tif (action === 'Call:Schedule' && actionData)\n\t\t{\n\t\t\tthis.runScheduleAction(actionData.activityId, actionData.scheduleDate);\n\t\t}\n\n\t\tif (action === 'Call:OpenTranscript' && actionData && actionData.callId)\n\t\t{\n\t\t\tthis.#openTranscript(actionData.callId);\n\t\t}\n\n\t\tif (action === 'Call:ChangePlayerState' && actionData && actionData.recordId)\n\t\t{\n\t\t\tthis.#changePlayerState(item, actionData.recordId);\n\t\t}\n\n\t\tif (action === 'Call:DownloadRecord' && actionData && actionData.url)\n\t\t{\n\t\t\tthis.#downloadRecord(actionData.url);\n\t\t}\n\n\t\tif (action === 'Call:LaunchCopilot' && actionData)\n\t\t{\n\t\t\tvoid this.handleCopilotLaunch(item, actionData);\n\t\t}\n\n\t\tif (action === 'Call:OpenCallScoringResult' && actionData)\n\t\t{\n\t\t\tthis.#openCallScoringResult(actionData);\n\t\t}\n\t}\n\t// endregion\n\n\t// region CopilotBase overridden methods\n\tgetCopilotConfig(): CopilotConfig\n\t{\n\t\treturn {\n\t\t\tactionEndpoint: 'crm.timeline.ai.launchCopilot',\n\t\t\tvalidEntityTypes: [BX.CrmEntityType.enumeration.lead, BX.CrmEntityType.enumeration.deal],\n\t\t\tagreementContext: 'audio',\n\t\t\tonPostLaunch: this.handlePostLaunch.bind(this),\n\t\t};\n\t}\n\n\thandlePostLaunch(item: ConfigurableItem, actionData: Object, response: Object): void\n\t{\n\t\tif (response?.status !== 'success')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst numberOfManualStarts = response?.data?.numberOfManualStarts;\n\t\tconst aiCopilotBtnUI = item.getLayoutFooterButtonById('aiButton')?.getUiButton();\n\n\t\tif (numberOfManualStarts >= COPILOT_BUTTON_NUMBER_OF_MANUAL_STARTS_WITH_BOOST_LIMIT)\n\t\t{\n\t\t\tthis.#emitTimelineCopilotTourEvent(\n\t\t\t\taiCopilotBtnUI.getContainer(),\n\t\t\t\t'BX.Crm.Timeline.Call:onShowTourWhenManualStartTooMuch',\n\t\t\t\t'copilot-in-call-automatically',\n\t\t\t\t500,\n\t\t\t);\n\t\t}\n\t\telse if (numberOfManualStarts >= COPILOT_BUTTON_NUMBER_OF_MANUAL_STARTS_WITHOUT_BOOST_LIMIT)\n\t\t{\n\t\t\tthis.#emitTimelineCopilotTourEvent(\n\t\t\t\taiCopilotBtnUI.getContainer(),\n\t\t\t\t'BX.Crm.Timeline.Call:onShowTourWhenNeedBuyBoost',\n\t\t\t\t'copilot-in-call-buying-boost',\n\t\t\t\t500,\n\t\t\t);\n\t\t}\n\t}\n\n\tgetAdditionalRequestData(actionData: Object): Object\n\t{\n\t\tconst isValidScenario = Type.isStringFilled(actionData.scenario)\n\t\t\t&& [FULL_SCENARIO, FILL_FIELDS_SCENARIO, CALL_SCORING_SCENARIO].includes(actionData.scenario)\n\t\t;\n\n\t\treturn {\n\t\t\tscenario: isValidScenario ? actionData.scenario : null,\n\t\t};\n\t}\n\n\tsupportsCopilotBanner(): boolean\n\t{\n\t\treturn this.#isCopilotBannerShown;\n\t}\n\n\tuseInfoHelper(): boolean\n\t{\n\t\treturn true;\n\t}\n\n\tasync showCopilotBanner(item: ConfigurableItem, actionData: Object): void\n\t{\n\t\tconst {\n\t\t\tAppsInstallerBanner,\n\t\t\tAppsInstallerBannerEvents,\n\t\t} = await Runtime.loadExtension('ai.copilot-banner');\n\t\tconst portalZone = Loc.getMessage('PORTAL_ZONE');\n\t\tconst copilotBannerOptions = {\n\t\t\tisWestZone: portalZone !== 'ru' && portalZone !== 'by' && portalZone !== 'kz',\n\t\t};\n\n\t\tconst copilotBanner = new AppsInstallerBanner(copilotBannerOptions);\n\t\tcopilotBanner.show();\n\t\tcopilotBanner.subscribe(AppsInstallerBannerEvents.actionStart, () => {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.info('Install app started');\n\t\t});\n\t\tcopilotBanner.subscribe(AppsInstallerBannerEvents.actionFinishSuccess, () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\t(new Engine()).setBannerLaunched();\n\n\t\t\t\tthis.#isCopilotBannerShown = true;\n\t\t\t}, 500);\n\t\t});\n\n\t\tcopilotBanner.subscribe(AppsInstallerBannerEvents.actionFinishFailed, () => {\n\t\t\tconsole.error('Install app failed. Try installing the application manually.');\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.showMarketMessageBox();\n\t\t\t}, 500);\n\t\t});\n\t}\n\t// endregion\n\n\t// region jsEvent action handlers\n\t#makeCall(actionData): void\n\t{\n\t\tif (!Type.isStringFilled(actionData.phone))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst params = {\n\t\t\tENTITY_TYPE_NAME: BX.CrmEntityType.resolveName(actionData.entityTypeId),\n\t\t\tENTITY_ID: actionData.entityId,\n\t\t\tAUTO_FOLD: true,\n\t\t};\n\n\t\tif (actionData.ownerTypeId !== actionData.entityTypeId || actionData.ownerId !== actionData.entityId)\n\t\t{\n\t\t\tparams.BINDINGS = {\n\t\t\t\tOWNER_TYPE_NAME: BX.CrmEntityType.resolveName(actionData.ownerTypeId),\n\t\t\t\tOWNER_ID: actionData.ownerId,\n\t\t\t};\n\t\t}\n\n\t\tif (actionData.activityId > 0)\n\t\t{\n\t\t\tparams.SRC_ACTIVITY_ID = actionData.activityId;\n\t\t}\n\n\t\twindow.top.BXIM?.phoneTo(actionData.phone, params);\n\t}\n\n\t#openTranscript(callId): void\n\t{\n\t\tif (BX.Voximplant && BX.Voximplant.Transcript)\n\t\t{\n\t\t\tBX.Voximplant.Transcript.create({ callId }).show();\n\t\t}\n\t}\n\n\t#changePlayerState(item: ConfigurableItem, recordId: Number): void\n\t{\n\t\tconst player = item.getLayoutContentBlockById('audio');\n\t\tif (!player)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (recordId !== player.id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (player.state === 'play')\n\t\t{\n\t\t\tplayer.pause();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tplayer.play();\n\t\t}\n\t}\n\n\t#downloadRecord(url: String): void\n\t{\n\t\tlocation.href = url;\n\t}\n\n\tasync #openCallScoringResult(actionData: Object): void\n\t{\n\t\tif (\n\t\t\t!Type.isInteger(actionData.activityId)\n\t\t\t|| !Type.isInteger(actionData.ownerTypeId)\n\t\t\t|| !Type.isInteger(actionData.ownerId)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tawait top.BX.Runtime.loadExtension('crm.ai.call');\n\n\t\tconst callScoring = new top.BX.Crm.AI.Call.CallQuality({\n\t\t\tactivityId: actionData.activityId,\n\t\t\townerTypeId: actionData.ownerTypeId,\n\t\t\townerId: actionData.ownerId,\n\t\t\tactivityCreated: actionData.activityCreated ?? null,\n\t\t\tclientDetailUrl: actionData.clientDetailUrl ?? null,\n\t\t\tclientFullName: actionData.clientFullName ?? null,\n\t\t\tuserPhotoUrl: actionData.userPhotoUrl ?? null,\n\t\t\tjobId: actionData.jobId ?? null,\n\t\t\tassessmentSettingsId: actionData.assessmentSettingsId ?? null,\n\t\t});\n\n\t\tcallScoring.open();\n\t}\n\t// endregion\n\n\t// eslint-disable-next-line sonarjs/cognitive-complexity\n\t#showCopilotWelcomeTour(item: ConfigurableItem): void\n\t{\n\t\tif (!item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#isCopilotWelcomeTourShown)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst payload: ?Object = Type.isPlainObject(item.getDataPayload())\n\t\t\t? item.getDataPayload()\n\t\t\t: {}\n\t\t;\n\n\t\tsetTimeout(() => {\n\t\t\tconst aiCopilotBtn: Button = item.getLayoutFooterButtonById('aiButton');\n\t\t\tconst aiCopilotUIBtn: ButtonUI = aiCopilotBtn?.getUiButton();\n\t\t\tif (\n\t\t\t\t!aiCopilotUIBtn\n\t\t\t\t|| aiCopilotUIBtn.getState() === ButtonState.DISABLED\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (aiCopilotBtn?.isInViewport())\n\t\t\t{\n\t\t\t\tthis.#emitTimelineCopilotTourEvents(\n\t\t\t\t\taiCopilotUIBtn.getContainer(),\n\t\t\t\t\t1500,\n\t\t\t\t\tpayload,\n\t\t\t\t);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst showCopilotTourOnScroll = () => {\n\t\t\t\tif (aiCopilotBtn?.isInViewport())\n\t\t\t\t{\n\t\t\t\t\tthis.#emitTimelineCopilotTourEvents(\n\t\t\t\t\t\taiCopilotUIBtn.getContainer(),\n\t\t\t\t\t\t1500,\n\t\t\t\t\t\tpayload,\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.#isCopilotWelcomeTourShown = true;\n\n\t\t\t\t\tEvent.unbind(window, 'scroll', showCopilotTourOnScroll);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tEvent.bind(window, 'scroll', showCopilotTourOnScroll);\n\t\t}, 50);\n\t}\n\n\t#bindAdditionalCopilotActions(item: ConfigurableItem): void\n\t{\n\t\tif (!item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tconst player = item?.getLayoutContentBlockById('audio');\n\t\t\tif (!player)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.subscribe('ui:audioplayer:pause', (event: BaseEvent): void => {\n\t\t\t\tconst { initiator } = event.getData();\n\t\t\t\tconst aiCopilotBtn: Button = item.getLayoutFooterButtonById('aiButton');\n\t\t\t\tconst aiCopilotUIBtn: ButtonUI = aiCopilotBtn?.getUiButton();\n\n\t\t\t\tif (\n\t\t\t\t\t!aiCopilotUIBtn\n\t\t\t\t\t|| aiCopilotUIBtn.getState() === ButtonState.DISABLED\n\t\t\t\t\t|| !aiCopilotBtn?.isPropEqual('data-activity-id', initiator)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.#emitTimelineCopilotTourEvents(aiCopilotUIBtn.getContainer(), 500);\n\t\t\t});\n\t\t}, 75);\n\t}\n\n\t#emitTimelineCopilotTourEvents(target: HTMLElement, delay: number = 1500, payload: ?Object = null): void\n\t{\n\t\tconst isWelcomeTourEnabled = payload?.isWelcomeTourEnabled ?? true;\n\t\tconst isWelcomeTourAutomaticallyEnabled = payload?.isWelcomeTourAutomaticallyEnabled ?? true;\n\t\tconst isWelcomeTourManuallyEnabled = payload?.isWelcomeTourManuallyEnabled ?? true;\n\n\t\tif (isWelcomeTourEnabled)\n\t\t{\n\t\t\tthis.#emitTimelineCopilotTourEvent(\n\t\t\t\ttarget,\n\t\t\t\t'BX.Crm.Timeline.Call:onShowCopilotTour',\n\t\t\t\t'copilot-button-in-call',\n\t\t\t\tdelay,\n\t\t\t);\n\t\t}\n\n\t\tif (isWelcomeTourAutomaticallyEnabled)\n\t\t{\n\t\t\tthis.#emitTimelineCopilotTourEvent(\n\t\t\t\ttarget,\n\t\t\t\t'BX.Crm.Timeline.Call:onShowTourWhenCopilotAutomaticallyStart',\n\t\t\t\t'copilot-button-in-call-automatically',\n\t\t\t\tdelay,\n\t\t\t);\n\t\t}\n\n\t\tif (isWelcomeTourManuallyEnabled)\n\t\t{\n\t\t\tthis.#emitTimelineCopilotTourEvent(\n\t\t\t\ttarget,\n\t\t\t\t'BX.Crm.Timeline.Call:onShowTourWhenCopilotManuallyStart',\n\t\t\t\t'copilot-button-in-call-manually',\n\t\t\t\tdelay,\n\t\t\t);\n\t\t}\n\t}\n\n\t#emitTimelineCopilotTourEvent(target: Element, eventName: string, stepId: string, delay: Number = 1500): void\n\t{\n\t\tEventEmitter.emit(this, eventName, { target, stepId, delay });\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn item.getType() === 'Activity:Call';\n\t}\n}\n","import { Type } from 'main.core';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport { Base } from './base';\nimport ConfigurableItem from '../configurable-item';\n\nexport class Comment extends Base\n{\n\tgetDeleteActionMethod(): string\n\t{\n\t\treturn 'crm.timeline.comment.delete';\n\t}\n\n\tgetDeleteActionCfg(recordId: Number, ownerTypeId: Number, ownerId: Number): Object\n\t{\n\t\treturn {\n\t\t\tdata: {\n\t\t\t\tid: recordId,\n\t\t\t\townerTypeId: ownerTypeId,\n\t\t\t\townerId: ownerId,\n\t\t\t}\n\t\t};\n\t}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData, animationCallbacks } = actionParams;\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Comment:Edit' || action === 'Comment:AddFile')\n\t\t{\n\t\t\tthis.#showEditor(item);\n\t\t}\n\n\t\tif (action === 'Comment:Delete' && actionData)\n\t\t{\n\t\t\tthis.#onCommentDelete(actionData, animationCallbacks);\n\t\t}\n\n\t\tif (action === 'Comment:StartEdit')\n\t\t{\n\t\t\titem.highlightContentBlockById('commentContentWeb', true);\n\t\t}\n\n\t\tif (action === 'Comment:FinishEdit')\n\t\t{\n\t\t\titem.highlightContentBlockById('commentContentWeb', false);\n\t\t}\n\t}\n\n\t#showEditor(item: ConfigurableItem): void\n\t{\n\t\tconst commentBlock = item.getLayoutContentBlockById('commentContentWeb');\n\t\tif (commentBlock)\n\t\t{\n\t\t\tcommentBlock.startEditing();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow new Error('Vue component \"CommentContent\" was not found');\n\t\t}\n\t}\n\n\t#onCommentDelete(actionData: Object, animationCallbacks: ?Object): void\n\t{\n\t\tif (!this.#isValidParams(actionData))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst confirmationText = Type.isStringFilled(actionData.confirmationText) ? actionData.confirmationText : '';\n\t\tif (confirmationText)\n\t\t{\n\t\t\tMessageBox.show({\n\t\t\t\tmessage: confirmationText,\n\t\t\t\tmodal: true,\n\t\t\t\tbuttons: MessageBoxButtons.YES_NO,\n\t\t\t\tonYes: () => {\n\t\t\t\t\treturn this.runDeleteAction(actionData.commentId, actionData.ownerTypeId, actionData.ownerId, animationCallbacks);\n\t\t\t\t},\n\t\t\t\tonNo: (messageBox) => {\n\t\t\t\t\tmessageBox.close();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.runDeleteAction(actionData.commentId, actionData.ownerTypeId, actionData.ownerId);\n\t\t}\n\t}\n\n\t#isValidParams(params: Object): boolean\n\t{\n\t\treturn Type.isNumber(params.commentId)\n\t\t\t&& Type.isNumber(params.ownerId)\n\t\t\t&& Type.isNumber(params.ownerTypeId);\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (item.getType() === 'Comment');\n\t}\n}\n","import { Address, ControlMode, Format } from 'location.core';\nimport { Extension, Loc } from 'main.core';\n\nexport default {\n\tprops: {\n\t\taddressFormatted: String,\n\t},\n\tmounted()\n\t{\n\t\tvoid this.$nextTick(() => {\n\t\t\tthis.renderAddressWidget();\n\t\t});\n\t},\n\tmethods: {\n\t\trenderAddressWidget(): void\n\t\t{\n\t\t\tconst settings = Extension.getSettings('crm.timeline.item');\n\n\t\t\tif (!settings.hasLocationModule)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst widgetFactory = new BX.Location.Widget.Factory();\n\n\t\t\tconst format = new Format(JSON.parse(Loc.getMessage('CRM_ACTIVITY_TODO_ADDRESS_FORMAT')));\n\t\t\tconst address = new Address({\n\t\t\t\tlanguageId: format.languageId,\n\t\t\t});\n\n\t\t\taddress.setFieldValue(format.fieldForUnRecognized, this.addressFormatted);\n\n\t\t\tconst addressWidget = widgetFactory.createAddressWidget({\n\t\t\t\taddress,\n\t\t\t\tmode: ControlMode.view,\n\t\t\t});\n\n\t\t\tconst addressWidgetParams = {\n\t\t\t\tmode: ControlMode.view,\n\t\t\t\tmapBindElement: this.$refs.mapBindElement,\n\t\t\t\tcontrolWrapper: this.$refs.controlWrapper,\n\t\t\t};\n\n\t\t\taddressWidget.render(addressWidgetParams);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"crm-timeline__text-block crm-timeline__address-block\">\n\t\t\t<div ref=\"mapBindElement\">\n\t\t\t\t<div ref=\"controlWrapper\" class=\"crm-timeline__address-block-address-wrapper\">\n\t\t\t\t\t<span \n\t\t\t\t\t\t:title=\"addressFormatted\"\n\t\t\t\t\t\tclass=\"ui-link ui-link-dark ui-link-dotted\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{addressFormatted}}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export class ClientMark\n{\n\tstatic POSITIVE = 'positive';\n\tstatic NEUTRAL = 'neutral';\n\tstatic NEGATIVE = 'negative';\n}\n","import {ClientMark as ClientMarkType} from '../enums/client-mark';\n\nexport const ClientMark = {\n\tprops: {\n\t\tmark: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: ClientMarkType.POSITIVE,\n\t\t},\n\n\t\ttext: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\n\t},\n\tcomputed: {\n\t\tclassName(): Object {\n\t\t\treturn {\n\t\t\t\t'crm-timeline__client-mark': true,\n\t\t\t\t'--positive-mark': this.mark === ClientMarkType.POSITIVE,\n\t\t\t\t'--neutral-mark': this.mark === ClientMarkType.NEUTRAL,\n\t\t\t\t'--negative-mark': this.mark === ClientMarkType.NEGATIVE,\n\t\t\t}\n\t\t},\n\n\t\ticonClassname() {\n\t\t\treturn {\n\t\t\t\t'crm-timeline__client-mark_icon': true,\n\t\t\t\t'--flipped': this.mark === ClientMarkType.NEGATIVE,\n\t\t\t}\n\t\t},\n\n\n\t},\n\ttemplate: `\n\t\t<div :class=\"className\">\n\t\t\t<i class=\"crm-timeline__client-mark_icon-wrapper\">\n\t\t\t\t<svg :class=\"iconClassname\" width=\"11.35\" height=\"11.36\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M14.8367 6.7166L11.2351 6.71731C11.1314 6.71731 11.0313 6.65735 10.9925 6.56213C10.8303 6.15654 10.8366 5.69947 11.0144 5.29671C11.3127 4.42841 11.3466 3.49029 11.1124 2.60224C10.8676 1.9914 10.8028 0.875521 9.67347 0.82403C9.32009 0.876226 9.01184 1.08854 8.8341 1.39819C8.80235 1.45321 8.78895 1.5181 8.78895 1.58088C8.78895 1.58088 8.84085 2.6644 8.78895 3.41764C8.73706 4.17087 7.29571 6.08954 6.37945 7.30769C6.32161 7.38528 6.24049 7.43607 6.14456 7.45088C5.80104 7.50232 5.14581 7.58943 4.90962 7.62062C4.85434 7.62792 4.82201 7.69735 4.82201 7.72994C4.82201 9.2527 4.82201 11.5306 4.82201 14.5636C4.82201 14.5887 4.85234 14.6435 4.90623 14.6524C5.09126 14.6829 5.55408 14.7676 6.02112 14.9178C6.60798 15.1061 7.0968 15.5519 8.07513 15.882C8.12662 15.8997 8.18375 15.9088 8.23807 15.9088H12.8321C13.4253 15.803 13.8668 15.2959 13.8972 14.6872C13.9056 14.3479 13.8379 14.0121 13.699 13.7039C13.6792 13.6594 13.7053 13.6129 13.7533 13.6037C14.3422 13.4965 15.0786 12.3785 14.1715 11.4778C14.1476 11.4545 14.1518 11.4228 14.1842 11.4143C14.6843 11.2866 15.0674 10.8874 15.1844 10.3894C15.2296 10.199 15.2134 10.0022 15.1569 9.81524C15.0906 9.59235 14.9848 9.38356 14.8445 9.19735C14.8092 9.15079 14.8289 9.09013 14.8854 9.07179C15.3834 8.90321 15.7262 8.4271 15.7226 7.88538C15.7798 7.35424 15.353 6.71731 14.8367 6.7166ZM3.412 7.00439H0.808518C0.673089 7.00439 0.570107 7.1243 0.593384 7.25479L2.10567 15.7508C2.12895 15.8813 2.24392 15.9766 2.37865 15.9766H3.34146C3.49029 15.9766 3.61091 15.8588 3.61091 15.7135L3.63207 7.22023C3.63207 7.10102 3.53403 7.00439 3.412 7.00439Z\"/>\n\t\t\t\t</svg>\n\t\t\t</i>\n\t\t\t<span class=\"crm-timeline__client-mark_text\">{{ text }}</span>\n\t\t</div>\n\t`\n}\n","export class EditableDescriptionHeight {\n\tstatic SHORT = 'short';\n\tstatic LONG = 'long';\n}","export class EditableDescriptionBackgroundColor {\n\tstatic YELLOW = 'yellow';\n\tstatic WHITE = 'white';\n}\n","export class EditableDescriptionAiStatus {\n\tstatic NONE = '';\n\tstatic SUCCESS = 'success';\n\tstatic IN_PROGRESS = 'in_progress';\n}\n","import { Lottie } from 'ui.lottie';\n\nexport const Loader = {\n\tmounted()\n\t{\n\t\tthis.renderLottieAnimation();\n\t},\n\n\tmethods: {\n\t\trenderLottieAnimation(): HTMLElement\n\t\t{\n\t\t\tconst mainAnimation = Lottie.loadAnimation({\n\t\t\t\tpath: this.getAnimationPath(),\n\t\t\t\tcontainer: this.$refs.lottie,\n\t\t\t\trenderer: 'svg',\n\t\t\t\tloop: true,\n\t\t\t\tautoplay: true,\n\t\t\t});\n\n\t\t\tmainAnimation.setSpeed(0.75);\n\n\t\t\treturn this.$refs.lottie.root;\n\t\t},\n\n\t\tgetAnimationPath(): string\n\t\t{\n\t\t\treturn '/bitrix/js/crm/timeline/item/src/components/content-blocks/internal/copilot/lottie/loader.json';\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div ref=\"lottie\" class=\"crm-timeline-block-internal-copilot-loader__lottie\"></div>\n\t`,\n};\n","import { Loader } from './loader';\nimport { EditableDescriptionAiStatus } from '../../../../components/enums/editable-description-ai-status'\n\nimport '../../../../css/content-blocks/internal/copilot/header-text.css';\n\nexport default {\n\tcomponents: {\n\t\tLoader,\n\t},\n\tprops: {\n\t\tstatus: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t\tvalidator: (value: string) => {\n\t\t\t\treturn [\n\t\t\t\t\tEditableDescriptionAiStatus.NONE,\n\t\t\t\t\tEditableDescriptionAiStatus.SUCCESS,\n\t\t\t\t\tEditableDescriptionAiStatus.IN_PROGRESS,\n\t\t\t\t].includes(value);\n\t\t\t},\n\t\t},\n\t},\n\n\tcomputed: {\n\t\ttext(): string\n\t\t{\n\t\t\tif (this.status === EditableDescriptionAiStatus.IN_PROGRESS)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('CRM_TIMELINE_ITEM_EDITABLE_DESCRIPTION_COPILOT_HEADER_PENDING');\n\t\t\t}\n\n\t\t\tif (this.status === EditableDescriptionAiStatus.SUCCESS)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('CRM_TIMELINE_ITEM_EDITABLE_DESCRIPTION_COPILOT_HEADER');\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\n\t\tisAnimated(): boolean\n\t\t{\n\t\t\treturn this.status === EditableDescriptionAiStatus.IN_PROGRESS;\n\t\t},\n\n\t\tclassName(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline-block-internal-copilot-header',\n\t\t\t\t{\n\t\t\t\t\t'--animated': this.status === EditableDescriptionAiStatus.IN_PROGRESS,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div :class=\"className\">\n\t\t\t<div class=\"crm-timeline-block-internal-copilot-header-icon\">\n\t\t\t\t<Loader v-if=\"isAnimated\"></Loader>\n\t\t\t</div>\n\t\t\t<div class=\"crm-timeline-block-internal-copilot-header_text\">{{ text }}</div>\n\t\t\t<div\n\t\t\t\tv-if=\"isAnimated\"\n\t\t\t\tclass=\"crm-timeline-block-internal-copilot-header_stage\"\n\t\t\t>\n\t\t\t\t<div class=\"crm-timeline-block-internal-copilot-header_dot-flashing\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom, Runtime, Text, Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { BasicEditor, TextEditorComponent } from 'ui.text-editor';\nimport { HtmlFormatterComponent } from 'ui.bbcode.formatter.html-formatter';\n\nimport { Action } from '../../action';\nimport { Button } from '../layout/button';\nimport { ButtonState } from '../enums/button-state';\nimport { ButtonType } from '../enums/button-type';\nimport { EditableDescriptionHeight } from '../enums/editable-description-height';\nimport { EditableDescriptionBackgroundColor } from '../enums/editable-description-background-color';\nimport { EditableDescriptionAiStatus } from '../enums/editable-description-ai-status';\n\nimport CopilotHeader from '../content-blocks/internal/copilot/header-text';\n\nexport const EditableDescription = {\n\tcomponents: {\n\t\tButton,\n\t\tCopilotHeader,\n\t\tTextEditorComponent,\n\t\tHtmlFormatterComponent,\n\t},\n\tprops: {\n\t\theaderText: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\ttext: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tsaveAction: {\n\t\t\ttype: Object,\n\t\t\tdefault: null,\n\t\t},\n\t\teditable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tcopied: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\theight: {\n\t\t\ttype: String,\n\t\t\tdefault: EditableDescriptionHeight.SHORT,\n\t\t},\n\t\tbackgroundColor: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tcopilotStatus: {\n\t\t\ttype: String,\n\t\t\tdefault: EditableDescriptionAiStatus.NONE,\n\t\t},\n\t\tcopilotSettings: {\n\t\t\ttype: Object,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\n\tbeforeCreate()\n\t{\n\t\tthis.textEditor = null;\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisEdit: false,\n\t\t\tisSaving: false,\n\t\t\tisLongText: false,\n\t\t\tisCollapsed: false,\n\t\t\tbbcode: this.text,\n\t\t\tisContentEmpty: Type.isString(this.text) && this.text.trim() === '',\n\t\t\tcurrentCopilotStatus: this.copilotStatus,\n\t\t\tcurrentHeaderText: this.headerText,\n\t\t};\n\t},\n\n\tinject: [\n\t\t'isReadOnly',\n\t\t'isLogMessage',\n\t],\n\n\tcomputed: {\n\t\tclassName(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__editable-text',\n\t\t\t\t[String(this.heightClassnameModifier), String(this.bgColorClassnameModifier)],\n\t\t\t\t{\n\t\t\t\t\t'--is-read-only': this.isLogMessage,\n\t\t\t\t\t'--is-edit': this.isEdit,\n\t\t\t\t\t'--is-long': this.isLongText,\n\t\t\t\t\t'--is-expanded': this.isCollapsed || !this.isLongText,\n\t\t\t\t\t'--copiloted': !this.isEdit && this.currentCopilotStatus !== EditableDescriptionAiStatus.NONE,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\n\t\ttextClassName(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__editable-text_text',\n\t\t\t\t{\n\t\t\t\t\t'--hidden': this.currentCopilotStatus === EditableDescriptionAiStatus.IN_PROGRESS,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\n\t\theightClassnameModifier(): string\n\t\t{\n\t\t\tswitch (this.height)\n\t\t\t{\n\t\t\t\tcase EditableDescriptionHeight.LONG: return '--height-long';\n\t\t\t\tcase EditableDescriptionHeight.SHORT: return '--height-short';\n\t\t\t\tdefault: return '--height-short';\n\t\t\t}\n\t\t},\n\n\t\tbgColorClassnameModifier(): string\n\t\t{\n\t\t\tswitch (this.backgroundColor)\n\t\t\t{\n\t\t\t\tcase EditableDescriptionBackgroundColor.YELLOW: return '--bg-color-yellow';\n\t\t\t\tcase EditableDescriptionBackgroundColor.WHITE: return '--bg-color-white';\n\t\t\t\tdefault: return '';\n\t\t\t}\n\t\t},\n\n\t\tisEditable(): boolean\n\t\t{\n\t\t\treturn this.editable && this.saveAction && !this.isReadOnly;\n\t\t},\n\n\t\tisCopied(): boolean\n\t\t{\n\t\t\treturn !this.isEdit && this.copied;\n\t\t},\n\n\t\tsaveTextButtonProps(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tstate: this.saveTextButtonState,\n\t\t\t\ttype: ButtonType.PRIMARY,\n\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('CRM_TIMELINE_ITEM_EDITABLE_DESCRIPTION_SAVE'),\n\t\t\t};\n\t\t},\n\n\t\tcancelEditingButtonProps(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\ttype: ButtonType.LIGHT,\n\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('CRM_TIMELINE_ITEM_EDITABLE_DESCRIPTION_CANCEL'),\n\t\t\t\tstate: this.isSaving ? ButtonState.DISABLED : ButtonState.DEFAULT,\n\t\t\t};\n\t\t},\n\n\t\tsaveTextButtonState(): string\n\t\t{\n\t\t\tif (this.isContentEmpty)\n\t\t\t{\n\t\t\t\treturn ButtonState.DISABLED;\n\t\t\t}\n\n\t\t\tif (this.isSaving)\n\t\t\t{\n\t\t\t\treturn ButtonState.DISABLED;\n\t\t\t}\n\n\t\t\treturn ButtonState.DEFAULT;\n\t\t},\n\n\t\texpandButtonText(): string\n\t\t{\n\t\t\treturn this.isCollapsed\n\t\t\t\t? this.$Bitrix.Loc.getMessage('CRM_TIMELINE_ITEM_EDITABLE_DESCRIPTION_HIDE_MSGVER_1')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('CRM_TIMELINE_ITEM_EDITABLE_DESCRIPTION_SHOW_MSGVER_1')\n\t\t\t;\n\t\t},\n\n\t\tisEditButtonVisible(): boolean\n\t\t{\n\t\t\treturn !(this.isReadOnly || this.isEdit);\n\t\t},\n\t},\n\n\tmethods: {\n\t\tstartEditing(): void\n\t\t{\n\t\t\tthis.isEdit = true;\n\t\t\tthis.isCollapsed = true;\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.getTextEditor().focus(null, { defaultSelection: 'rootEnd' });\n\t\t\t});\n\n\t\t\tthis.emitEvent('EditableDescription:StartEdit');\n\t\t},\n\n\t\temitEvent(eventName: string): void\n\t\t{\n\t\t\tconst action = new Action({\n\t\t\t\ttype: 'jsEvent',\n\t\t\t\tvalue: eventName,\n\t\t\t});\n\n\t\t\tvoid action.execute(this);\n\t\t},\n\n\t\tadjustHeight(elem: HTMLElement): void\n\t\t{\n\t\t\tDom.style(elem, 'height', 0);\n\t\t\tDom.style(elem, 'height', `${elem.scrollHeight}px`);\n\t\t},\n\n\t\tsaveText(): void\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.saveTextButtonState === ButtonState.DISABLED\n\t\t\t\t|| this.saveTextButtonState === ButtonState.LOADING\n\t\t\t\t|| !this.isEdit\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst encodedTrimText = this.getTextEditor().getText().trim();\n\t\t\tif (encodedTrimText === this.bbcode)\n\t\t\t{\n\t\t\t\tthis.isEdit = false;\n\t\t\t\tthis.emitEvent('EditableDescription:FinishEdit');\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isSaving = true;\n\n\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\tthis.executeSaveAction(encodedTrimText).then(() => {\n\t\t\t\tthis.isEdit = false;\n\t\t\t\tthis.bbcode = encodedTrimText;\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.isLongText = this.checkIsLongText();\n\t\t\t\t});\n\t\t\t\tthis.emitEvent('EditableDescription:FinishEdit');\n\t\t\t}).finally(() => {\n\t\t\t\tthis.isSaving = false;\n\t\t\t});\n\t\t},\n\n\t\texecuteSaveAction(text: string): ?Promise\n\t\t{\n\t\t\tif (!this.saveAction)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// to avoid unintended props mutation\n\t\t\tconst actionDescription = Runtime.clone(this.saveAction);\n\n\t\t\tactionDescription.actionParams ??= {};\n\t\t\tactionDescription.actionParams.value = text;\n\n\t\t\tconst action = new Action(actionDescription);\n\n\t\t\t// eslint-disable-next-line consistent-return\n\t\t\treturn action.execute(this);\n\t\t},\n\n\t\tcancelEditing(): void\n\t\t{\n\t\t\tif (!this.isEdit || this.isSaving)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isEdit = false;\n\t\t\tthis.emitEvent('EditableDescription:FinishEdit');\n\t\t},\n\n\t\tclearText(): void\n\t\t{\n\t\t\tif (this.isSaving)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.getTextEditor().clear();\n\t\t\tthis.getTextEditor().focus(null, { defaultSelection: 'rootEnd' });\n\t\t},\n\n\t\tcopyText(): void\n\t\t{\n\t\t\tconst selection = window.getSelection();\n\t\t\tselection.removeAllRanges();\n\n\t\t\tconst range = document.createRange();\n\t\t\tconst referenceNode = this.$refs.text;\n\t\t\trange.selectNodeContents(referenceNode);\n\t\t\tselection.addRange(range);\n\n\t\t\tlet isSuccess = false;\n\t\t\ttry\n\t\t\t{\n\t\t\t\tisSuccess = document.execCommand('copy');\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\t// just in case\n\t\t\t}\n\n\t\t\tselection.removeAllRanges();\n\n\t\t\tif (isSuccess)\n\t\t\t{\n\t\t\t\tnew Popup({\n\t\t\t\t\tid: `copyTextHint_${Text.getRandom(8)}`,\n\t\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('CRM_TIMELINE_ITEM_TEXT_IS_COPIED'),\n\t\t\t\t\tbindElement: this.$refs.copyTextBtn,\n\t\t\t\t\tdarkMode: true,\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonAfterPopupShow() {\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t}, 2000);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}).show();\n\t\t\t}\n\t\t},\n\n\t\ttoggleIsCollapsed(): void\n\t\t{\n\t\t\tthis.isCollapsed = !this.isCollapsed;\n\t\t},\n\n\t\tcheckIsLongText(): boolean\n\t\t{\n\t\t\tconst textBlock = this.$refs.text;\n\t\t\tif (!textBlock)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst textBlockMaxHeightStyle = window.getComputedStyle(textBlock).getPropertyValue('--crm-timeline__editable-text_max-height');\n\t\t\tconst textBlockMaxHeight = parseFloat(textBlockMaxHeightStyle.slice(0, -2));\n\t\t\tconst parentComputedStyles = this.$refs.rootElement ? window.getComputedStyle(this.$refs.rootElement) : {};\n\n\t\t\t// eslint-disable-next-line no-unsafe-optional-chaining\n\t\t\tconst parentHeight = this.$refs.rootElement?.offsetHeight\n\t\t\t\t- parseFloat(parentComputedStyles.paddingTop)\n\t\t\t\t- parseFloat(parentComputedStyles.paddingBottom)\n\t\t\t;\n\n\t\t\treturn parentHeight > textBlockMaxHeight;\n\t\t},\n\n\t\tisInViewport(): boolean\n\t\t{\n\t\t\tconst rect = this.$el.getBoundingClientRect();\n\n\t\t\treturn (\n\t\t\t\trect.top >= 0\n\t\t\t\t&& rect.left >= 0\n\t\t\t\t&& rect.bottom <= (window.innerHeight || document.documentElement.clientHeight)\n\t\t\t\t&& rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n\t\t\t);\n\t\t},\n\n\t\tgetTextEditor(): BasicEditor\n\t\t{\n\t\t\tif (this.textEditor !== null)\n\t\t\t{\n\t\t\t\treturn this.textEditor;\n\t\t\t}\n\n\t\t\tthis.textEditor = new BasicEditor({\n\t\t\t\tremovePlugins: ['BlockToolbar'],\n\t\t\t\tmaxHeight: 600,\n\t\t\t\tcontent: this.bbcode,\n\t\t\t\tparagraphPlaceholder: this.$Bitrix.Loc.getMessage(\n\t\t\t\t\tType.isPlainObject(this.copilotSettings)\n\t\t\t\t\t\t? 'CRM_TIMELINE_ITEM_EDITABLE_DESCRIPTION_PLACEHOLDER_WITH_COPILOT'\n\t\t\t\t\t\t: null,\n\t\t\t\t),\n\t\t\t\ttoolbar: [],\n\t\t\t\tfloatingToolbar: [\n\t\t\t\t\t'bold', 'italic', 'underline', 'strikethrough',\n\t\t\t\t\t'|',\n\t\t\t\t\t'link', 'copilot',\n\t\t\t\t],\n\t\t\t\tvisualOptions: {\n\t\t\t\t\tcolorBackground: 'transparent',\n\t\t\t\t\tborderWidth: '0px',\n\t\t\t\t\tblockSpaceInline: '0px',\n\t\t\t\t\tblockSpaceStack: '0px',\n\t\t\t\t},\n\t\t\t\tcopilot: {\n\t\t\t\t\tcopilotOptions: Type.isPlainObject(this.copilotSettings) ? this.copilotSettings : null,\n\t\t\t\t\ttriggerBySpace: true,\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonMetaEnter: () => {\n\t\t\t\t\t\tthis.saveText();\n\t\t\t\t\t},\n\t\t\t\t\tonEscape: () => {\n\t\t\t\t\t\tthis.cancelEditing();\n\t\t\t\t\t},\n\t\t\t\t\tonEmptyContentToggle: (event: BaseEvent) => {\n\t\t\t\t\t\tthis.isContentEmpty = event.getData().isEmpty;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\treturn this.textEditor;\n\t\t},\n\n\t\tgetHeaderText(): string\n\t\t{\n\t\t\treturn this.currentHeaderText;\n\t\t},\n\n\t\tsetHeaderText(headerText: string): void\n\t\t{\n\t\t\tthis.currentHeaderText = headerText;\n\n\t\t\tvoid this.$nextTick(() => {\n\t\t\t\tthis.isLongText = this.checkIsLongText();\n\t\t\t});\n\t\t},\n\n\t\tsetCopilotStatus(status: string): void\n\t\t{\n\t\t\tthis.currentCopilotStatus = status;\n\n\t\t\tvoid this.$nextTick(() => {\n\t\t\t\tthis.isLongText = this.checkIsLongText();\n\t\t\t});\n\t\t},\n\t},\n\n\twatch: {\n\t\ttext(newTextValue: string): void\n\t\t{\n\t\t\tthis.bbcode = newTextValue;\n\n\t\t\tvoid this.$nextTick(() => {\n\t\t\t\tthis.isLongText = this.checkIsLongText();\n\t\t\t});\n\t\t},\n\n\t\tcopilotStatus(newStatus: string): void\n\t\t{\n\t\t\tthis.currentCopilotStatus = newStatus;\n\t\t},\n\n\t\theaderText(newHeaderText: string): void\n\t\t{\n\t\t\tthis.currentHeaderText = newHeaderText;\n\t\t},\n\n\t\tisCollapsed(isCollapsed: boolean): void\n\t\t{\n\t\t\tif (isCollapsed === false && this.isInViewport() === false)\n\t\t\t{\n\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\tthis.$el.scrollIntoView({\n\t\t\t\t\t\tbehavior: 'smooth',\n\t\t\t\t\t\tblock: 'center',\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tisSaving(value: boolean): void\n\t\t{\n\t\t\tif (this.textEditor !== null) // CommentContent uses this method as well\n\t\t\t{\n\t\t\t\tthis.getTextEditor().setEditable(!value);\n\t\t\t}\n\t\t},\n\n\t\tisEdit(value: boolean): void\n\t\t{\n\t\t\tif (value === false && this.textEditor !== null)\n\t\t\t{\n\t\t\t\tthis.textEditor.destroy();\n\t\t\t\tthis.textEditor = null;\n\t\t\t}\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tvoid this.$nextTick(() => {\n\t\t\tthis.isLongText = this.checkIsLongText();\n\t\t});\n\t},\n\n\ttemplate: `\n\t\t<div class=\"crm-timeline__editable-text_wrapper\">\n\t\t\t<div ref=\"rootElement\" :class=\"className\">\n\t\t\t\t<button\n\t\t\t\t\tv-if=\"this.isCopied\"\n\t\t\t\t\tref=\"copyTextBtn\"\n\t\t\t\t\t@click=\"copyText\"\n\t\t\t\t\tclass=\"crm-timeline__text_copy-btn\"\n\t\t\t\t>\n\t\t\t\t\t<i class=\"crm-timeline__editable-text_fixed-icon --copy\"></i>\n\t\t\t\t</button>\n\t\t\t\t<button\n\t\t\t\t\tv-if=\"isEdit && isEditable\"\n\t\t\t\t\t:disabled=\"isSaving\"\n\t\t\t\t\t@click=\"clearText\"\n\t\t\t\t\tclass=\"crm-timeline__editable-text_clear-btn\"\n\t\t\t\t>\n\t\t\t\t\t<i class=\"crm-timeline__editable-text_fixed-icon --clear\"></i>\n\t\t\t\t</button>\n\t\t\t\t<button\n\t\t\t\t\tv-if=\"!isEdit && isEditable && isEditButtonVisible\"\n\t\t\t\t\t:disabled=\"isSaving\"\n\t\t\t\t\t@click=\"startEditing\"\n\t\t\t\t\tclass=\"crm-timeline__editable-text_edit-btn\"\n\t\t\t\t>\n\t\t\t\t\t<i class=\"crm-timeline__editable-text_edit-icon\"></i>\n\t\t\t\t</button>\n\t\t\t\t<div class=\"crm-timeline__editable-text_inner\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"!isEditable && currentHeaderText !== ''\"\n\t\t\t\t\t\tv-html=\"currentHeaderText\"\n\t\t\t\t\t\tclass=\"crm-timeline__editable-text_header-text\"\n\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t\t<CopilotHeader \n\t\t\t\t\t\tref=\"copilotHeader\"\n\t\t\t\t\t\tv-if=\"currentCopilotStatus !== ''\"\n\t\t\t\t\t\t:status=\"currentCopilotStatus\"\n\t\t\t\t\t\tclass=\"crm-timeline__editable-text-copilot-header\"\n\t\t\t\t\t></CopilotHeader>\n\t\t\t\t\t<div class=\"crm-timeline__editable-text_content\">\n\t\t\t\t\t\t<TextEditorComponent\n\t\t\t\t\t\t\tv-if=\"isEdit\"\n\t\t\t\t\t\t\t:editor-instance=\"this.getTextEditor()\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-else\n\t\t\t\t\t\t\tref=\"text\"\n\t\t\t\t\t\t\t:class=\"textClassName\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<HtmlFormatterComponent :bbcode=\"bbcode\" />\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"isEdit\"\n\t\t\t\t\t\tclass=\"crm-timeline__editable-text_actions\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"crm-timeline__editable-text_action\">\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tv-bind=\"saveTextButtonProps\"\n\t\t\t\t\t\t\t\t@click=\"saveText\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"crm-timeline__editable-text_action\">\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tv-bind=\"cancelEditingButtonProps\"\n\t\t\t\t\t\t\t\t@click=\"cancelEditing\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\tv-if=\"isLongText && !isEdit\"\n\t\t\t\t\t@click=\"toggleIsCollapsed\"\n\t\t\t\t\tclass=\"crm-timeline__editable-text_collapse-btn\"\n\t\t\t\t>\n\t\t\t\t\t{{ expandButtonText }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Runtime, Type } from 'main.core';\nimport { Loader } from 'main.loader';\nimport { BitrixVue } from 'ui.vue3';\nimport { CommentEditor } from 'crm.timeline.editors.comment-editor';\n\nimport { Action } from '../../action';\nimport { EditableDescription } from './editable-description';\nimport { ButtonState } from '../enums/button-state';\n\nconst TYPE_LOAD_FILES_BLOCK = 1;\nconst TYPE_LOAD_TEXT_CONTENT = 2;\n\n/**\n * @extends EditableDescription\n */\nexport default BitrixVue.cloneComponent(EditableDescription, {\n\tprops: {\n\t\tfilesCount: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: 0,\n\t\t},\n\t\thasInlineFiles: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tloadAction: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t},\n\n\tdata(): Object {\n\t\treturn {\n\t\t\t...this.parentData(),\n\t\t\tvalue: this.text,\n\t\t\toldValue: this.text,\n\t\t\tisTextLoaded: false,\n\t\t\tisTextChanged: false,\n\t\t\tisMoving: false,\n\t\t\tisFilesBlockDisplayed: this.filesCount > 0,\n\t\t\tfilesHtmlBlock: null,\n\t\t\tloader: Object.freeze(null),\n\t\t\teditor: Object.freeze(null),\n\t\t};\n\t},\n\n\tcomputed: {\n\t\ttextWrapperClassName(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__editable-text_content',\n\t\t\t\t{\n\t\t\t\t\t'--is-editor-loaded': this.isEdit,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t},\n\n\tmethods: {\n\t\tstartEditing(): void\n\t\t{\n\t\t\tthis.isEdit = true;\n\t\t\tthis.isCollapsed = true;\n\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.editor.show(this.$refs.editor);\n\t\t\t});\n\n\t\t\tthis.emitEvent('Comment:StartEdit');\n\t\t},\n\n\t\tcancelEditing(): void\n\t\t{\n\t\t\tif (!this.isEdit || this.isSaving)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.value = this.oldValue;\n\t\t\tthis.isEdit = false;\n\n\t\t\tif (this.filesHtmlBlock)\n\t\t\t{\n\t\t\t\tvoid Runtime.html(this.$refs.files, this.filesHtmlBlock).then(() => {\n\t\t\t\t\tthis.registerImages(this.$refs.files);\n\t\t\t\t\tBX.LazyLoad.showImages();\n\n\t\t\t\t\tthis.emitEvent('Comment:FinishEdit');\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.emitEvent('Comment:FinishEdit');\n\t\t\t}\n\t\t},\n\n\t\ttoggleIsCollapsed(): void\n\t\t{\n\t\t\tthis.parentToggleIsCollapsed();\n\n\t\t\tif (!this.isTextLoaded)\n\t\t\t{\n\t\t\t\tthis.executeLoadAction(TYPE_LOAD_TEXT_CONTENT, this.$refs.text);\n\t\t\t}\n\t\t},\n\n\t\tcheckIsLongText(): boolean\n\t\t{\n\t\t\tconst textBlock = this.$refs.text;\n\t\t\tif (!textBlock)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst textBlockMaxHeightStyle = window.getComputedStyle(textBlock)\n\t\t\t\t.getPropertyValue('--crm-timeline__editable-text_max-height')\n\t\t\t;\n\t\t\tconst textBlockMaxHeight = parseFloat(textBlockMaxHeightStyle.slice(0, -2));\n\n\t\t\tconst root = this.filesCount > 0\n\t\t\t\t? this.$refs.rootElement\n\t\t\t\t: this.$refs.rootWrapperElement;\n\n\t\t\tconst parentComputedStyles = window.getComputedStyle(root);\n\t\t\tconst parentHeight = root.offsetHeight\n\t\t\t\t- parseFloat(parentComputedStyles.paddingTop)\n\t\t\t\t- parseFloat(parentComputedStyles.paddingBottom)\n\t\t\t;\n\n\t\t\tconst isLongText = parentHeight > textBlockMaxHeight;\n\n\t\t\treturn isLongText || this.hasInlineFiles;\n\t\t},\n\n\t\tsaveContent(): void\n\t\t{\n\t\t\tconst isSaveDisabled = this.saveTextButtonState === ButtonState.LOADING\n\t\t\t\t|| !this.isEdit\n\t\t\t\t|| !this.saveAction\n\t\t\t;\n\n\t\t\tif (isSaveDisabled)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst content = this.editor.getContent();\n\t\t\tif (!Type.isStringFilled(content))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst htmlContent = this.editor.getHtmlContent();\n\t\t\tconst attachmentList = this.editor.getAttachments();\n\t\t\tconst attachmentAllowEditOptions = this.editor.getAttachmentsAllowEditOptions(attachmentList);\n\t\t\tthis.isSaving = true;\n\n\t\t\tvoid this.executeSaveAction(content, attachmentList, attachmentAllowEditOptions).then(() => {\n\t\t\t\tthis.isEdit = false;\n\n\t\t\t\tif (!this.isTextChanged)\n\t\t\t\t{\n\t\t\t\t\tthis.oldValue = htmlContent;\n\t\t\t\t\tthis.value = htmlContent;\n\t\t\t\t}\n\n\t\t\t\tthis.$nextTick((): void => {\n\t\t\t\t\tthis.isLongText = this.checkIsLongText();\n\t\t\t\t\tthis.executeLoadAction(TYPE_LOAD_FILES_BLOCK, this.$refs.files);\n\t\t\t\t});\n\n\t\t\t\tthis.emitEvent('Comment:FinishEdit');\n\t\t\t}).finally(() => {\n\t\t\t\tthis.isSaving = false;\n\t\t\t});\n\t\t},\n\n\t\texecuteSaveAction(content: String, attachmentList: Array, attachmentAllowEditOptions: Object): Promise\n\t\t{\n\t\t\t// to avoid unintended props mutation\n\t\t\tconst actionDescription = Runtime.clone(this.saveAction);\n\n\t\t\tactionDescription.actionParams ??= {};\n\t\t\tactionDescription.actionParams.id = actionDescription.actionParams.commentId;\n\t\t\tactionDescription.actionParams.fields = {\n\t\t\t\tCOMMENT: content,\n\t\t\t\tATTACHMENTS: attachmentList,\n\t\t\t};\n\n\t\t\tif (Object.keys(attachmentAllowEditOptions).length > 0)\n\t\t\t{\n\t\t\t\tactionDescription.actionParams.CRM_TIMELINE_DISK_ATTACHED_OBJECT_ALLOW_EDIT = attachmentAllowEditOptions;\n\t\t\t}\n\n\t\t\tconst action = new Action(actionDescription);\n\n\t\t\treturn action.execute(this);\n\t\t},\n\n\t\texecuteLoadAction(type: Number, node: HTMLElement): void\n\t\t{\n\t\t\tif (this.filesCount === 0)\n\t\t\t{\n\t\t\t\tthis.filesHtmlBlock = null;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!Type.isDomNode(node) || !this.loadAction)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst actionDescription = Runtime.clone(this.loadAction);\n\t\t\tactionDescription.actionParams ??= {};\n\t\t\tactionDescription.actionParams.options = type;\n\n\t\t\tconst action = new Action(actionDescription);\n\n\t\t\tthis.showLoader(true);\n\n\t\t\taction.execute(this).then((response) => {\n\t\t\t\tif (type === TYPE_LOAD_FILES_BLOCK)\n\t\t\t\t{\n\t\t\t\t\tthis.filesHtmlBlock = response.data.html;\n\t\t\t\t}\n\t\t\t\telse if (type === TYPE_LOAD_TEXT_CONTENT)\n\t\t\t\t{\n\t\t\t\t\tthis.isTextLoaded = true;\n\t\t\t\t}\n\n\t\t\t\tvoid Runtime.html(node, response.data.html).then(() => {\n\t\t\t\t\tthis.registerImages(node);\n\t\t\t\t\tBX.LazyLoad.showImages();\n\n\t\t\t\t\tthis.showLoader(false);\n\t\t\t\t});\n\t\t\t}).catch(() => {\n\t\t\t\tif (type === TYPE_LOAD_FILES_BLOCK)\n\t\t\t\t{\n\t\t\t\t\tthis.filesHtmlBlock = null;\n\t\t\t\t}\n\t\t\t\telse if (type === TYPE_LOAD_TEXT_CONTENT)\n\t\t\t\t{\n\t\t\t\t\tthis.isTextLoaded = false;\n\t\t\t\t}\n\n\t\t\t\tthis.showLoader(false);\n\t\t\t});\n\t\t},\n\n\t\tregisterImages(node: HTMLElement): void\n\t\t{\n\t\t\tif (!Type.isDomNode(node))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst idsList = [];\n\t\t\tconst commentImages = node.querySelectorAll('[data-viewer-type=\"image\"]');\n\t\t\tconst commentImagesLength = commentImages.length;\n\t\t\tif (commentImagesLength > 0)\n\t\t\t{\n\t\t\t\tfor (let i = 0; i < commentImagesLength; ++i)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isDomNode(commentImages[i]))\n\t\t\t\t\t{\n\t\t\t\t\t\tcommentImages[i].id += BX.util.getRandomString(4);\n\t\t\t\t\t\tidsList.push(commentImages[i].id);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (idsList.length > 0)\n\t\t\t\t{\n\t\t\t\t\tBX.LazyLoad.registerImages(idsList, null, { dataSrcName: 'thumbSrc' });\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tBX.LazyLoad.registerImages(idsList, null, { dataSrcName: 'thumbSrc' });\n\t\t},\n\n\t\tshowLoader(showLoader: boolean): void\n\t\t{\n\t\t\tif (showLoader)\n\t\t\t{\n\t\t\t\tif (!this.loader)\n\t\t\t\t{\n\t\t\t\t\tthis.loader = new Loader({\n\t\t\t\t\t\tsize: 20,\n\t\t\t\t\t\tmode: 'inline',\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.loader.show(this.$refs.files);\n\t\t\t}\n\t\t\telse if (this.loader)\n\t\t\t{\n\t\t\t\tthis.loader.hide();\n\t\t\t}\n\t\t},\n\n\t\tcreateEditor(): void\n\t\t{\n\t\t\tthis.editor = new CommentEditor(this.loadAction.actionParams.commentId);\n\t\t},\n\n\t\tsetIsMoving(flag: boolean = true): void\n\t\t{\n\t\t\tthis.isMoving = flag;\n\t\t},\n\n\t\tsetIsFilesBlockDisplayed(flag: boolean = true): void\n\t\t{\n\t\t\tthis.isFilesBlockDisplayed = flag;\n\n\t\t\tif (this.filesHtmlBlock)\n\t\t\t{\n\t\t\t\tvoid Runtime.html(this.$refs.files, this.filesHtmlBlock).then(() => {\n\t\t\t\t\tthis.registerImages(this.$refs.files);\n\t\t\t\t\tBX.LazyLoad.showImages();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n\n\twatch: {\n\t\ttext(newValue: String): void\n\t\t{\n\t\t\tthis.value = newValue;\n\t\t\tthis.oldValue = newValue;\n\t\t\tthis.isTextChanged = true;\n\n\t\t\tthis.$nextTick((): void => {\n\t\t\t\tthis.isLongText = this.checkIsLongText();\n\t\t\t\tthis.executeLoadAction(TYPE_LOAD_FILES_BLOCK, this.$refs.files);\n\t\t\t});\n\t\t},\n\n\t\tvalue(newValue: String): void\n\t\t{\n\t\t\tif (!this.isEdit)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.value = newValue;\n\t\t\tthis.oldValue = newValue;\n\t\t},\n\n\t\tfilesCount(newValue: Number): void\n\t\t{\n\t\t\tif (this.isMoving)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isFilesBlockDisplayed = newValue > 0;\n\n\t\t\tthis.$nextTick((): void => {\n\t\t\t\tthis.executeLoadAction(TYPE_LOAD_FILES_BLOCK, this.$refs.files);\n\t\t\t});\n\t\t},\n\t},\n\n\tmounted() {\n\t\tthis.createEditor();\n\n\t\tthis.$nextTick((): void => {\n\t\t\tthis.isLongText = this.checkIsLongText();\n\t\t\tthis.executeLoadAction(TYPE_LOAD_FILES_BLOCK, this.$refs.files);\n\t\t});\n\t},\n\n\tupdated() {\n\t\tthis.createEditor();\n\t},\n\n\ttemplate: `\n\t\t<div ref=\"rootWrapperElement\" class=\"crm-timeline__editable-text_wrapper --comment\">\n\t\t\t<div ref=\"rootElement\" :class=\"className\">\n\t\t\t\t<button\n\t\t\t\t\tv-if=\"isLongText && !isEdit && isEditable && isEditButtonVisible\"\n\t\t\t\t\t:disabled=\"isSaving\"\n\t\t\t\t\t@click=\"startEditing\"\n\t\t\t\t\tclass=\"crm-timeline__editable-text_edit-btn\"\n\t\t\t\t>\n\t\t\t\t\t<i class=\"crm-timeline__editable-text_edit-icon\"></i>\n\t\t\t\t</button>\n\t\t\t\t<div class=\"crm-timeline__editable-text_inner\">\n\t\t\t\t\t<div :class=\"textWrapperClassName\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"isEdit\"\n\t\t\t\t\t\t\tref=\"editor\"\n\t\t\t\t\t\t\t:disabled=\"!isEdit || isSaving\"\n\t\t\t\t\t\t\tclass=\"crm-timeline__editable-text_editor\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t\t<span \n\t\t\t\t\t\t\tv-else\n\t\t\t\t\t\t\tref=\"text\"\n\t\t\t\t\t\t\tclass=\"crm-timeline__editable-text_text\"\n\t\t\t\t\t\t\tv-html=\"value\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-if=\"!isEdit && !isLongText && isEditable && isEditButtonVisible\"\n\t\t\t\t\t\t\t@click=\"startEditing\"\n\t\t\t\t\t\t\tclass=\"crm-timeline__editable-text_text-edit-icon\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span class=\"crm-timeline__editable-text_edit-icon\"></span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"isEdit\"\n\t\t\t\t\t\tclass=\"crm-timeline__editable-text_actions\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"crm-timeline__editable-text_action\">\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tv-bind=\"saveTextButtonProps\"\n\t\t\t\t\t\t\t\t@click=\"saveContent\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"crm-timeline__editable-text_action\">\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tv-bind=\"cancelEditingButtonProps\"\n\t\t\t\t\t\t\t\t@click=\"cancelEditing\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<button\n\t\t\t\t\tv-if=\"isLongText && !isEdit\"\n\t\t\t\t\t@click=\"toggleIsCollapsed\"\n\t\t\t\t\tclass=\"crm-timeline__editable-text_collapse-btn\"\n\t\t\t\t>\n\t\t\t\t\t{{ expandButtonText }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"!isEdit && isFilesBlockDisplayed\"\n\t\t\t\tref=\"files\"\n\t\t\t\tclass=\"crm-timeline__comment_files_wrapper\"\n\t\t\t\t:class=\"{'--long-comment': isLongText}\"\n\t\t\t\tv-html=\"filesHtmlBlock\"\n\t\t\t>\n\t\t\t</div>\n\t\t</div>\n\t`,\n});\n","export class TextColor\n{\n\tstatic GREEN = 'green';\n\tstatic PURPLE = 'purple';\n\tstatic BASE_50 = 'base-50';\n\tstatic BASE_60 = 'base-60';\n\tstatic BASE_70 = 'base-70';\n\tstatic BASE_90 = 'base-90';\n}\n","export class TextWeight {\n\tstatic NORMAL = 'normal';\n\tstatic MEDIUM = 'medium';\n\tstatic BOLD = 'bold';\n}","export class TextSize {\n\tstatic XS = 'xs';\n\tstatic SM = 'sm';\n\tstatic MD = 'md';\n}","export class TextDecoration\n{\n\tstatic NONE = 'none';\n\tstatic UNDERLINE = 'underline';\n\tstatic DOTTED = 'dotted';\n\tstatic DASHED = 'dashed';\n}\n","import { Text } from 'main.core';\n\nimport { TextColor } from '../enums/text-color';\nimport { TextWeight } from '../enums/text-weight';\nimport { TextSize } from '../enums/text-size';\nimport { TextDecoration } from '../enums/text-decoration';\n\nexport default {\n\tprops: {\n\t\tvalue: String | Number,\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tcolor: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tweight: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: 'normal',\n\t\t},\n\t\tsize: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: 'md',\n\t\t},\n\t\tmultiline: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tdecoration: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed: {\n\t\tclassName(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__text-block',\n\t\t\t\tthis.colorClassname,\n\t\t\t\tthis.weightClassname,\n\t\t\t\tthis.sizeClassname,\n\t\t\t\tthis.decorationClassname,\n\t\t\t];\n\t\t},\n\n\t\tcolorClassname(): string\n\t\t{\n\t\t\tconst upperCaseColorProp = this.color ? this.color.toUpperCase() : '';\n\t\t\tconst color = TextColor[upperCaseColorProp] ?? '';\n\n\t\t\treturn `--color-${color}`;\n\t\t},\n\n\t\tweightClassname(): string\n\t\t{\n\t\t\tconst upperCaseWeightProp = this.weight ? this.weight.toUpperCase() : '';\n\t\t\tconst weight = TextWeight[upperCaseWeightProp] ?? TextWeight.NORMAL;\n\n\t\t\treturn `--weight-${weight}`;\n\t\t},\n\n\t\tsizeClassname(): string\n\t\t{\n\t\t\tconst upperCaseSizeProp = this.size ? this.size.toUpperCase() : '';\n\t\t\tconst size = TextSize[upperCaseSizeProp] ?? TextSize.SM;\n\n\t\t\treturn `--size-${size}`;\n\t\t},\n\n\t\tdecorationClassname(): string\n\t\t{\n\t\t\tconst upperCaseDecorationProp = this.decoration ? this.decoration.toUpperCase() : '';\n\t\t\tif (!upperCaseDecorationProp)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst decoration = TextDecoration[upperCaseDecorationProp] ?? TextDecoration.NONE;\n\n\t\t\treturn `--decoration-${decoration}`;\n\t\t},\n\n\t\tencodedText(): string\n\t\t{\n\t\t\tlet text = Text.encode(this.value);\n\t\t\tif (this.multiline)\n\t\t\t{\n\t\t\t\ttext = text.replace(/\\n/g, '<br />');\n\t\t\t}\n\n\t\t\treturn text;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<span\n\t\t\t:title=\"title\"\n\t\t\t:class=\"className\"\n\t\t\tv-html=\"encodedText\"\n\t\t></span>\n\t`,\n};\n","import { DatetimeConverter } from 'crm.timeline.tools';\nimport { Text as CoreTextHelper, Type } from 'main.core';\nimport Text from './text';\n\nexport default {\n\tprops: {\n\t\twithTime: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tformat: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tduration: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\textends: Text,\n\tmethods: {\n\t\tgetFormattedDate(): string\n\t\t{\n\t\t\tconst datetimeConverter = this.getDatetimeConverter();\n\n\t\t\tif (this.format)\n\t\t\t{\n\t\t\t\treturn datetimeConverter.toFormatString(this.format);\n\t\t\t}\n\n\t\t\tconst options = {\n\t\t\t\tdelimiter: ', ',\n\t\t\t\twithDayOfWeek: true,\n\t\t\t\twithFullMonth: true,\n\t\t\t};\n\n\t\t\treturn this.withTime\n\t\t\t\t? datetimeConverter.toDatetimeString(options)\n\t\t\t\t: datetimeConverter.toDateString()\n\t\t\t;\n\t\t},\n\t\tgetDatetimeConverter(): DatetimeConverter\n\t\t{\n\t\t\treturn (DatetimeConverter.createFromServerTimestamp(this.value)).toUserTime();\n\t\t},\n\t\tgetDatetimeConverterWithDuration(): DatetimeConverter\n\t\t{\n\t\t\treturn (DatetimeConverter.createFromServerTimestamp(this.value + this.duration)).toUserTime();\n\t\t},\n\t},\n\tcomputed: {\n\t\tencodedText(): string\n\t\t{\n\t\t\tconst formattedDate = this.getFormattedDate();\n\n\t\t\tif (!Type.isNumber(this.duration))\n\t\t\t{\n\t\t\t\treturn CoreTextHelper.encode(formattedDate);\n\t\t\t}\n\n\t\t\tconst converterWithDuration = this.getDatetimeConverterWithDuration();\n\n\t\t\treturn CoreTextHelper.encode(`${formattedDate}-${converterWithDuration.toTimeString()}`);\n\t\t},\n\t},\n\ttemplate: Text.template,\n};\n","import { DatetimeConverter } from 'crm.timeline.tools';\nimport { Runtime, Type } from 'main.core';\nimport { DateTimeFormat, Timezone } from 'main.date';\nimport { Action } from '../../action';\n\nexport const DatePillColor = Object.freeze({\n\tDEFAULT: 'default',\n\tWARNING: 'warning',\n\tNONE: 'none',\n});\n\nexport const PillStyle = Object.freeze({\n\tDEFAULT: 'pill',\n\tINLINE_GROUP: 'pill-inline-group',\n});\n\nexport default {\n\tprops: {\n\t\tvalue: Number,\n\t\twithTime: Boolean,\n\t\tduration: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tbackgroundColor: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: DatePillColor.DEFAULT,\n\t\t\tvalidator(value: string) {\n\t\t\t\treturn Object.values(DatePillColor).includes(value);\n\t\t\t},\n\t\t},\n\t\taction: Object | null,\n\t\tstyleValue: String,\n\t},\n\tinject: ['isReadOnly'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcurrentTimestamp: this.value,\n\t\t\tinitialTimestamp: this.value,\n\t\t};\n\t},\n\tcomputed: {\n\t\tclassName(): []\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__date-pill',\n\t\t\t\t`--color-${this.backgroundColor}`,\n\t\t\t\t{\n\t\t\t\t\t'--readonly': this.isPillReadonly,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t'--inline-group': this.styleValue === PillStyle.INLINE_GROUP,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tformattedDate(): string {\n\t\t\tif (!this.currentTimestamp)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst converter = this.getDatetimeConverter();\n\n\t\t\tlet result = converter.toDatetimeString({\n\t\t\t\twithDayOfWeek: true,\n\t\t\t\twithFullMonth: true,\n\t\t\t\tdelimiter: ', ',\n\t\t\t});\n\t\t\tif (Type.isNumber(this.duration))\n\t\t\t{\n\t\t\t\tconst converterWithDuration = this.getDatetimeConverterWithDuration();\n\t\t\t\tresult = `${result}-${converterWithDuration.toTimeString()}`;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tcurrentDateInSiteFormat(): ?string\n\t\t{\n\t\t\treturn DateTimeFormat.format(\n\t\t\t\tthis.withTime\n\t\t\t\t\t? DatetimeConverter.getSiteDateTimeFormat()\n\t\t\t\t\t: DatetimeConverter.getSiteDateFormat(),\n\t\t\t\tthis.getDatetimeConverter().getValue()\n\t\t\t);\n\t\t},\n\n\t\tcalendarParams(): Object {\n\t\t\treturn {\n\t\t\t\tvalue: this.currentDateInSiteFormat,\n\t\t\t\tbTime: this.withTime,\n\t\t\t\tbHideTime: !this.withTime,\n\t\t\t\tbSetFocus: false,\n\t\t\t}\n\t\t},\n\n\t\tisPillReadonly(): boolean {\n\t\t\treturn this.isReadOnly || !this.action;\n\t\t},\n\t},\n\twatch: {\n\t\tvalue(newDate): void // update date from push\n\t\t{\n\t\t\tthis.initialTimestamp = newDate;\n\t\t\tthis.currentTimestamp = newDate;\n\t\t}\n\t},\n\tmethods: {\n\t\topenCalendar(event: PointerEvent): void\n\t\t{\n\t\t\tif (this.isPillReadonly)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// eslint-disable-next-line @bitrix24/bitrix24-rules/no-bx\n\t\t\tBX.calendar({\n\t\t\t\tnode: event.target,\n\t\t\t\tcallback_after: (newDate: Date) => {\n\t\t\t\t\t// we assume that user selected time in his timezone\n\t\t\t\t\tthis.currentTimestamp = Timezone.UserTime.toUTCTimestamp(newDate);\n\n\t\t\t\t\tthis.executeAction();\n\t\t\t\t},\n\t\t\t\t...this.calendarParams,\n\t\t\t});\n\t\t},\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.currentTimestamp === this.initialTimestamp)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// to avoid unintended props mutation\n\t\t\tconst actionDescription = Runtime.clone(this.action);\n\n\t\t\tactionDescription.actionParams ??= {};\n\t\t\tactionDescription.actionParams.value = this.currentDateInSiteFormat;\n\t\t\tactionDescription.actionParams.valueTs = this.currentTimestamp;\n\n\t\t\tconst action = new Action(actionDescription);\n\t\t\taction.execute(this);\n\n\t\t\tthis.initialTimestamp = this.currentTimestamp;\n\n\t\t\tthis.$emit('onChange', this.initialTimestamp);\n\t\t},\n\t\tgetDatetimeConverter(): DatetimeConverter\n\t\t{\n\t\t\treturn (DatetimeConverter.createFromServerTimestamp(this.currentTimestamp)).toUserTime();\n\t\t},\n\t\tgetDatetimeConverterWithDuration(): DatetimeConverter\n\t\t{\n\t\t\treturn (DatetimeConverter.createFromServerTimestamp(this.currentTimestamp + this.duration)).toUserTime();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<span\n\t\t\t:class=\"className\"\n\t\t\t@click=\"openCalendar\"\n\t\t>\n\t\t\t<span>\n\t\t\t\t{{ formattedDate }}\n\t\t\t</span>\n\t\t\t<span class=\"crm-timeline__date-pill_caret\"></span>\n\t\t</span>`\n};\n","import { Action } from '../../action';\nimport { TextColor } from '../enums/text-color';\nimport { TextDecoration } from '../enums/text-decoration';\nimport { TextSize } from '../enums/text-size';\n\nexport default {\n\tprops: {\n\t\ttext: String,\n\t\taction: Object,\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tcolor: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tbold: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tsize: {\n\t\t\ttype: String,\n\t\t\tdefault: 'md',\n\t\t},\n\t\tdecoration: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\ticon: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\trowLimit: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\n\tcomputed: {\n\t\thref(): ?String\n\t\t{\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst action = new Action(this.action);\n\t\t\tif (action.isRedirect())\n\t\t\t{\n\t\t\t\treturn action.getValue();\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tlinkAttrs(): Object\n\t\t{\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tconst action = new Action(this.action);\n\n\t\t\tif (!action.isRedirect())\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tconst attrs = {\n\t\t\t\thref: action.getValue(),\n\t\t\t};\n\t\t\tconst target = action.getActionParam('target');\n\n\t\t\tif (target)\n\t\t\t{\n\t\t\t\tattrs.target = target;\n\t\t\t}\n\n\t\t\treturn attrs;\n\t\t},\n\n\t\tclassName(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card_link',\n\t\t\t\tthis.colorClassName,\n\t\t\t\tthis.boldClassName,\n\t\t\t\tthis.sizeClassname,\n\t\t\t\tthis.decorationClassName,\n\t\t\t\tthis.rowLimitClassName,\n\t\t\t];\n\t\t},\n\n\t\tcolorClassName(): string\n\t\t{\n\t\t\tconst upperCaseColorProp = this.color ? this.color.toUpperCase() : '';\n\t\t\tconst color = TextColor[upperCaseColorProp] ?? '';\n\n\t\t\treturn `--color-${color}`;\n\t\t},\n\n\t\tboldClassName(): string\n\t\t{\n\t\t\treturn this.bold ? '--bold' : '';\n\t\t},\n\n\t\tsizeClassname(): string\n\t\t{\n\t\t\tconst upperCaseSizeProp = this.size ? this.size.toUpperCase() : '';\n\t\t\tconst size = TextSize[upperCaseSizeProp] ?? TextSize.SM;\n\n\t\t\treturn `--size-${size}`;\n\t\t},\n\n\t\tdecorationClassName(): string\n\t\t{\n\t\t\tconst upperCaseDecorationProp = this.decoration ? this.decoration.toUpperCase() : '';\n\t\t\tif (!upperCaseDecorationProp)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst decoration = TextDecoration[upperCaseDecorationProp] ?? TextDecoration.NONE;\n\n\t\t\treturn `--decoration-${decoration}`;\n\t\t},\n\n\t\ticonClassName(): Array\n\t\t{\n\t\t\tif (!this.icon)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn [\n\t\t\t\t'crm-timeline__card_link_icon',\n\t\t\t\t`--code-${this.icon}`,\n\t\t\t];\n\t\t},\n\n\t\trowLimitClassName(): string\n\t\t{\n\t\t\treturn this.rowLimit ? '--limit' : '';\n\t\t},\n\n\t\trowLimitStyle(): Object\n\t\t{\n\t\t\tif (this.rowLimit && this.rowLimit > 0)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\t'-webkit-line-clamp': this.rowLimit,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {};\n\t\t},\n\t},\n\n\tmethods: {\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (this.action)\n\t\t\t{\n\t\t\t\tconst action = new Action(this.action);\n\t\t\t\taction.execute(this);\n\t\t\t}\n\t\t},\n\t},\n\n\ttemplate:\n\t\t`<a\n\t\t\tv-if=\"href\"\n\t\t\tv-bind=\"linkAttrs\"\n\t\t\t:class=\"className\"\n\t\t\t:title=\"title\"\n\t\t\t:style=\"rowLimitStyle\"\n\t\t>{{text}}<span v-if=\"icon\" :class=\"iconClassName\"></span>\n\t\t</a>\n\t\t<span\n\t\t\tv-else\n\t\t\t@click=\"executeAction\"\n\t\t\t:class=\"className\"\n\t\t\t:title=\"title\"\n\t\t\t:style=\"rowLimitStyle\"\n\t\t>{{text}}<span v-if=\"icon\" :class=\"iconClassName\"></span>\n\t\t</span>`,\n};\n","import { DatetimeConverter } from 'crm.timeline.tools';\nimport { Runtime } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\nimport { Action } from '../../action';\nimport Link from './link';\n\nexport default {\n\tcomponents: {\n\t\tLink,\n\t},\n\tprops: {\n\t\tvalue: Number,\n\t\twithTime: Boolean,\n\t\taction: Object,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcurrentDate: this.value,\n\t\t\tinitialDate: this.value,\n\t\t\tactionTimeoutId: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tcurrentDateObject(): ?Date\n\t\t{\n\t\t\treturn this.currentDate ? new Date(this.currentDate * 1000) : null;\n\t\t},\n\t\tcurrentDateInSiteFormat(): ?string\n\t\t{\n\t\t\tif (!this.currentDateObject)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn DateTimeFormat.format(DatetimeConverter.getSiteDateFormat(), this.currentDateObject);\n\t\t},\n\t\ttextProps(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.currentDateInSiteFormat,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\topenCalendar(event: PointerEvent): void\n\t\t{\n\t\t\tthis.cancelScheduledActionExecution();\n\n\t\t\t// eslint-disable-next-line bitrix-rules/no-bx\n\t\t\tBX.calendar({\n\t\t\t\tnode: event.target,\n\t\t\t\tvalue: this.currentDateInSiteFormat,\n\t\t\t\tbTime: this.withTime,\n\t\t\t\tbHideTime: !this.withTime,\n\t\t\t\tbSetFocus: false,\n\t\t\t\tcallback_after: (newDate: Date) => {\n\t\t\t\t\tthis.currentDate = Math.round(newDate.getTime() / 1000);\n\n\t\t\t\t\tthis.scheduleActionExecution();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tscheduleActionExecution(): void\n\t\t{\n\t\t\tthis.cancelScheduledActionExecution();\n\n\t\t\tthis.actionTimeoutId = setTimeout(this.executeAction.bind(this), 3 * 1000);\n\t\t},\n\t\tcancelScheduledActionExecution(): void\n\t\t{\n\t\t\tif (this.actionTimeoutId)\n\t\t\t{\n\t\t\t\tclearTimeout(this.actionTimeoutId);\n\t\t\t\tthis.actionTimeoutId = null;\n\t\t\t}\n\t\t},\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.currentDate === this.initialDate)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// to avoid unintended props mutation\n\t\t\tconst actionDescription = Runtime.clone(this.action);\n\n\t\t\tactionDescription.actionParams ??= {};\n\t\t\tactionDescription.actionParams.value = this.currentDateObject;\n\n\t\t\tconst action = new Action(actionDescription);\n\t\t\taction.execute(this);\n\n\t\t\tthis.initialDate = this.currentDate;\n\t\t},\n\t},\n\ttemplate: `<Link @click=\"openCalendar\" v-bind=\"textProps\"></Link>`,\n};\n","import Text from './text';\nimport { Action } from \"../../action\";\nimport {Runtime} from \"main.core\";\nimport {BitrixVue} from 'ui.vue3';\n\nexport default BitrixVue.cloneComponent(Text, {\n\tcomponents: {\n\t\tText,\n\t},\n\tprops: {\n\t\taction: Object,\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tisEdit: false,\n\t\t\tcurrentValue: this.value,\n\t\t\tinitialValue: this.value,\n\t\t\tactionTimeoutId: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttextProps(): Object {\n\t\t\treturn {\n\t\t\t\t...this.$props,\n\t\t\t\tvalue: this.currentValue,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tenableEdit(): void\n\t\t{\n\t\t\tthis.cancelScheduledActionExecution();\n\n\t\t\tthis.isEdit = true;\n\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.$refs.input.focus();\n\t\t\t});\n\t\t},\n\t\tdisableEdit(): void\n\t\t{\n\t\t\tthis.isEdit = false;\n\n\t\t\tthis.scheduleActionExecution();\n\t\t},\n\n\t\tscheduleActionExecution(): void\n\t\t{\n\t\t\tthis.cancelScheduledActionExecution();\n\n\t\t\tthis.actionTimeoutId = setTimeout(this.executeAction.bind(this), 3 * 1000);\n\t\t},\n\t\tcancelScheduledActionExecution(): void\n\t\t{\n\t\t\tif (this.actionTimeoutId)\n\t\t\t{\n\t\t\t\tclearTimeout(this.actionTimeoutId);\n\t\t\t\tthis.actionTimeoutId = null;\n\t\t\t}\n\t\t},\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (!this.action || this.currentValue === this.initialValue)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// to avoid unintended props mutation\n\t\t\tconst actionDescription = Runtime.clone(this.action);\n\n\t\t\tactionDescription.actionParams ??= {};\n\t\t\tactionDescription.actionParams.value = this.currentValue;\n\n\t\t\tconst action = new Action(actionDescription);\n\t\t\taction.execute(this);\n\n\t\t\tthis.initialValue = this.currentValue;\n\t\t},\n\t},\n\ttemplate: `\n\t\t\t<input\n\t\t\t\tv-if=\"isEdit\"\n\t\t\t\tref=\"input\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tv-model.trim=\"currentValue\"\n\t\t\t\t@focusout=\"disableEdit\"\n\t\t\t>\n\t\t\t<Text\n\t\t\t\tv-else\n\t\t\t\tv-bind=\"textProps\"\n\t\t\t\t@click=\"enableEdit\"\n\t\t\t/>\n\t\t`\n});\n\n","export class LogoType {\n\tstatic CALL_AUDIO_PLAY = 'call-play-record';\n\tstatic CALL_AUDIO_PAUSE = 'call-pause-record';\n}\n","import { AudioPlayer } from 'crm.audio-player';\nimport { LogoType } from '../enums/logo-type';\n\nexport const TimelineAudio = AudioPlayer.getComponent({\n\tmethods: {\n\t\tchangeLogoIcon(icon: String)\n\t\t{\n\t\t\tif (!this.$parent || !this.$parent.getLogo)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst logo = this.$parent.getLogo();\n\t\t\tif (!logo)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlogo.setIcon(icon);\n\t\t},\n\n\t\taudioEventRouterWrapper(eventName: String, event)\n\t\t{\n\t\t\tthis.audioEventRouter(eventName, event);\n\n\t\t\tif (eventName === 'play')\n\t\t\t{\n\t\t\t\tthis.changeLogoIcon(LogoType.CALL_AUDIO_PAUSE);\n\t\t\t}\n\n\t\t\tif (eventName === 'pause')\n\t\t\t{\n\t\t\t\tthis.changeLogoIcon(LogoType.CALL_AUDIO_PLAY);\n\t\t\t}\n\t\t},\n\t},\n});\n","import { FileIcon } from 'ui.icons.generator';\nimport {TimelineAudio} from \"./timeline-audio\";\n\nexport default {\n\tcomponents: {\n\t\tTimelineAudio,\n\t},\n\tprops: {\n\t\tid: Number,\n\t\ttext: String,\n\t\thref: String,\n\t\tsize: Number,\n\t\tattributes: Object,\n\t\thasAudioPlayer: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tfileExtension() {\n\t\t\treturn this.text.split('.').slice(-1)[0] || '';\n\t\t},\n\n\t\ttitleFirstPart(): string {\n\t\t\treturn this.text.slice(0, -this.titleLastPartSize);\n\t\t},\n\n\t\ttitleLastPart(): string {\n\t\t\treturn this.text.slice(-this.titleLastPartSize);\n\t\t},\n\n\t\ttitleLastPartSize(): number {\n\t\t\treturn 10;\n\t\t},\n\t},\n\n\tmounted() {\n\t\tconst fileIcon = new FileIcon({\n\t\t\tname: this.fileExtension,\n\t\t});\n\n\t\tfileIcon.renderTo(this.$refs.icon);\n\t},\n\n\ttemplate:\n\t\t`\n\t\t<div class=\"crm-timeline__file\">\n\t\t\t<div ref=\"icon\" class=\"crm-timeline__file_icon\"></div>\n\t\t\t<a\n\t\t\t\ttarget=\"_blank\"\n\t\t\t\tclass=\"crm-timeline__file_title crm-timeline__card_link\"\n\t\t\t\tv-if=\"href\"\n\t\t\t\t:title=\"text\"\n\t\t\t\t:href=\"href\"\n\t\t\t\tv-bind=\"attributes\"\n\t\t\t\tref=\"title\"\n\t\t\t>\n\t\t\t\t<span>{{ titleFirstPart }}</span>\n\t\t\t\t<span>{{ titleLastPart }}</span>\n\t\t\t</a>\n\t\t\t<div class=\"crm-timeline__file_audio-player\" v-if=\"this.hasAudioPlayer\">\n\t\t\t\t<TimelineAudio :id=\"id\" :mini=\"true\" :src=\"href\"></TimelineAudio>\n\t\t\t</div>\n\t\t</div>\n\t\t`\n};\n","import { FileUploaderPopup } from 'crm.activity.file-uploader-popup';\nimport File from './file';\nimport {BIcon, Set} from \"ui.icon-set.api.vue\";\nimport 'ui.icon-set.main';\nimport 'ui.icon-set.actions';\n\nexport const FileList = {\n\tcomponents: {\n\t\tFile,\n\t\tBIcon,\n\t},\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tnumberOfFiles: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: 0,\n\t\t},\n\t\tfiles: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t\tdefault: [],\n\t\t},\n\t\tupdateParams: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\tvisibleFilesNumber: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: 5,\n\t\t},\n\t},\n\n\tinject: ['isReadOnly'],\n\n\tdata() {\n\t\treturn {\n\t\t\tvisibleFilesAmount: this.visibleFilesNumber,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tisEditable(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.updateParams).length > 0 && !this.isReadOnly;\n\t\t},\n\n\t\tvisibleFiles(): Array {\n\t\t\treturn this.files.slice(0, this.visibleFilesAmount);\n\t\t},\n\n\t\teditFilesBtnClassname(): Array {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__file-list-btn', {\n\t\t\t\t'--disabled': !this.isEditable,\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\n\t\texpandFileListBtnTitle() {\n\t\t\treturn this.isAllFilesVisible\n\t\t\t\t?\n\t\t\t\tthis.$Bitrix.Loc.getMessage('CRM_TIMELINE_ITEM_FILE_LIST_COLLAPSE')\n\t\t\t\t:\n\t\t\t\tthis.$Bitrix.Loc.getMessage('CRM_TIMELINE_ITEM_FILE_LIST_EXPAND')\n\t\t\t;\n\t\t},\n\n\t\teditFilesBtnIcon(): string {\n\t\t\treturn Set.PENCIL_40;\n\t\t},\n\n\t\taddVisibleFilesBtnIcon(): string {\n\t\t\treturn Set.CHEVRON_DOWN;\n\t\t},\n\n\t\tisAllFilesVisible(): boolean {\n\t\t\treturn this.visibleFilesAmount === this.numberOfFiles\n\t\t},\n\n\t\tisShowExpandFileListBtn(): boolean {\n\t\t\treturn this.numberOfFiles > this.visibleFilesNumber;\n\t\t},\n\n\t\texpandBtnIconClassname(): string {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__file-list-btn-icon', {\n\t\t\t\t'--upended': this.isAllFilesVisible,\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t},\n\n\tmethods: {\n\t\tfileProps(file: Object): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: file.id,\n\t\t\t\ttext: file.name,\n\t\t\t\thref: file.viewUrl,\n\t\t\t\tsize: file.size,\n\t\t\t\tattributes: file.attributes,\n\t\t\t\thasAudioPlayer: file.hasAudioPlayer,\n\t\t\t};\n\t\t},\n\n\t\tshowFileUploaderPopup(): void\n\t\t{\n\t\t\tif (!this.isEditable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst popup = new FileUploaderPopup(this.updateParams);\n\t\t\tpopup.show();\n\t\t},\n\n\t\thandleShowFilesBtnClick() {\n\t\t\tif (this.isAllFilesVisible)\n\t\t\t{\n\t\t\t\tthis.collapseFileList();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.expandFileList();\n\t\t\t}\n\t\t},\n\n\t\texpandFileList(): void\n\t\t{\n\t\t\tthis.visibleFilesAmount = this.numberOfFiles;\n\t\t},\n\n\t\tcollapseFileList(): void {\n\t\t\tthis.visibleFilesAmount = this.visibleFilesNumber;\n\t\t}\n\t},\n\n\ttemplate:\n\t\t`\n\t\t\t<div class=\"crm-timeline__file-list-wrapper\">\n\t\t\t\t<div class=\"crm-timeline__file-list-container\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"crm-timeline__file-container\"\n\t\t\t\t\t\tv-for=\"file in visibleFiles\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<File :key=\"file.id\" v-bind=\"fileProps(file)\"></File>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<footer class=\"crm-timeline__file-list-footer\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"isShowExpandFileListBtn\"\n\t\t\t\t\t\tclass=\"crm-timeline__file-list-btn-container\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"crm-timeline__file-list-btn\"\n\t\t\t\t\t\t\t@click=\"handleShowFilesBtnClick\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span class=\"crm-timeline__file-list-btn-text\">{{expandFileListBtnTitle}}</span>\n\t\t\t\t\t\t\t<i :class=\"expandBtnIconClassname\">\n\t\t\t\t\t\t\t\t<BIcon :name=\"addVisibleFilesBtnIcon\" :size=\"18\"></BIcon>\n\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"isEditable\"\n\t\t\t\t\t\tclass=\"crm-timeline__file-list-btn-container\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tv-if=\"title !== '' || numberOfFiles > 0\"\n\t\t\t\t\t\t\t@click=\"showFileUploaderPopup\"\n\t\t\t\t\t\t\t:class=\"editFilesBtnClassname\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span class=\"crm-timeline__file-list-btn-text\">{{ title }}</span>\n\t\t\t\t\t\t\t<i class=\"crm-timeline__file-list-btn-icon\">\n\t\t\t\t\t\t\t\t<BIcon :name=\"editFilesBtnIcon\" :size=\"18\"></BIcon>\n\t\t\t\t\t\t\t</i>\n\t\t\t\t\t\t\t<i ref=\"edit-icon\" class=\"crm-timeline__file-list-btn-icon\"></i>\n\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</footer>\n\t\t\t</div>\n\t\t`\n};\n","\nexport const InfoGroup = {\n\tprops: {\n\t\tblocks: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: () => ({}),\n\t\t}\n\t},\n\n\ttemplate: `\n\t\t<table class=\"crm-timeline__info-group\">\n\t\t\t<tbody>\n\t\t\t\t<tr\n\t\t\t\t\tv-for=\"({title, block}, id) in blocks\"\n\t\t\t\t\t:key=\"id\"\n\t\t\t\t\tclass=\"crm-timeline__info-group_block\"\n\t\t\t\t>\n\t\t\t\t\t<td\n\t\t\t\t\t\t:title=\"title\"\n\t\t\t\t\t\tclass=\"crm-timeline__info-group_block-title\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{title}}\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"crm-timeline__info-group_block-content\">\n\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t:is=\"block.rendererName\"\n\t\t\t\t\t\t\tv-bind=\"block.properties\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>\n\t`\n}","import { Events, ItemSelector } from 'crm.field.item-selector';\nimport { Runtime, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport { Action } from '../../action';\n\nconst SAVE_OFFSETS_REQUEST_DELAY = 1000;\n\nexport default {\n\tprops: {\n\t\tvaluesList: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t\tdefault: [],\n\t\t},\n\t\tvalue: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\tsaveAction: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcompactMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\ticon: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t\trequired: false,\n\t\t},\n\t},\n\n\tmethods: {\n\t\tonItemSelectorValueChange(event: BaseEvent): void\n\t\t{\n\t\t\tRuntime.debounce(\n\t\t\t\t() => {\n\t\t\t\t\tconst data = event.getData();\n\t\t\t\t\tif (data)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.executeSaveAction(data.value);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tSAVE_OFFSETS_REQUEST_DELAY,\n\t\t\t\tthis,\n\t\t\t)();\n\t\t},\n\n\t\texecuteSaveAction(items: Array): void\n\t\t{\n\t\t\tif (!this.saveAction)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.value.sort().toString() === items.sort().toString())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// to avoid unintended props mutation\n\t\t\tconst actionDescription = Runtime.clone(this.saveAction);\n\n\t\t\tactionDescription.actionParams ??= {};\n\t\t\tactionDescription.actionParams.value = items;\n\n\t\t\tconst action = new Action(actionDescription);\n\n\t\t\tvoid action.execute(this);\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.itemSelector = new ItemSelector({\n\t\t\ttarget: this.$el,\n\t\t\tvaluesList: this.valuesList,\n\t\t\tselectedValues: this.value,\n\t\t\tcompactMode: this.compactMode ?? false,\n\t\t\ticon: Type.isStringFilled(this.icon) ? this.icon : null,\n\t\t});\n\n\t\tEventEmitter.subscribe(\n\t\t\tthis.itemSelector,\n\t\t\tEvents.EVENT_ITEMSELECTOR_VALUE_CHANGE,\n\t\t\tthis.onItemSelectorValueChange,\n\t\t);\n\t},\n\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe(\n\t\t\tthis.itemSelector,\n\t\t\tEvents.EVENT_ITEMSELECTOR_VALUE_CHANGE,\n\t\t\tthis.onItemSelectorValueChange,\n\t\t);\n\t},\n\n\tcomputed: {\n\t\tstyles(): Object\n\t\t{\n\t\t\tif (this.compactMode)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\twidth: '100%',\n\t\t\t};\n\t\t},\n\t},\n\n\ttemplate: '<div :style=\"styles\"></div>',\n};\n","import { Text, Type } from 'main.core';\n\nexport default {\n\tprops: {\n\t\tblocks: Object,\n\t\tdelimiter: String,\n\t\tbutton: Object,\n\t},\n\n\tmounted(): void\n\t{\n\t\tconst blocks = this.$refs.blocks;\n\n\t\tthis.visibleBlocks.forEach((block, index) => {\n\t\t\tif (Type.isDomNode(blocks[index].$el))\n\t\t\t{\n\t\t\t\tblocks[index].$el.setAttribute('data-id', block.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthrow new Error(`Vue component \"${block.rendererName}\" was not found`);\n\t\t\t}\n\t\t});\n\t},\n\n\tmethods: {\n\t\tisShowDelimiter(index: number, length: number): boolean\n\t\t{\n\t\t\treturn (Type.isString(this.delimiter) && !this.isLastElement(index, length));\n\t\t},\n\n\t\tisLastElement(index: number, length: number): boolean\n\t\t{\n\t\t\treturn index === length - 1;\n\t\t},\n\n\t\tgetLastElement(): Object | null\n\t\t{\n\t\t\tconst lastKey = Object.keys(this.blocks)[Object.keys(this.blocks).length - 1];\n\n\t\t\treturn this.blocks[lastKey] ?? null;\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tvisibleBlocks(): Array\n\t\t{\n\t\t\tif (!Type.isObject(this.blocks))\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst blocks = Object.keys(this.blocks)\n\t\t\t\t.map((id) => ({ id, ...this.blocks[id] }))\n\t\t\t\t.filter((item) => (item.scope !== 'mobile'));\n\n\t\t\tif (Type.isObject(this.button))\n\t\t\t{\n\t\t\t\tblocks.push({ id: 'button', ...this.button });\n\t\t\t}\n\n\t\t\treturn blocks;\n\t\t},\n\n\t\tformattedDelimiter(): string\n\t\t{\n\t\t\treturn Text.encode(this.delimiter).replace(' ', '&nbsp;');\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<span class=\"crm-timeline-block-line-of-texts\">\n\t\t\t<span\n\t\t\t\tv-for=\"(block, index) in visibleBlocks\"\n\t\t\t\t:key=\"block.id\"\n\t\t\t>\n\t\t\t\t<component \n\t\t\t\t\t:is=\"block.rendererName\"\n\t\t\t\t\tv-bind=\"block.properties\"\n\t\t\t\t\tref=\"blocks\"\n\t\t\t\t/>\n\t\t\t\t<span v-if=\"isShowDelimiter(index, visibleBlocks.length)\" v-html=\"formattedDelimiter\"></span>\n\t\t\t\t<span v-else-if=\"!isLastElement(index, visibleBlocks.length)\">&nbsp;</span>\n\t\t\t</span>\n\t\t</span>\n\t`,\n};\n","import { Action } from '../../action';\n\nexport default {\n\tprops: {\n\t\taction: Object,\n\t\ticon: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\ttitle: String,\n\t},\n\n\tcomputed: {\n\t\thref(): ?String\n\t\t{\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst action = new Action(this.action);\n\t\t\tif (action.isRedirect())\n\t\t\t{\n\t\t\t\treturn action.getValue();\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tlinkAttrs(): Object\n\t\t{\n\t\t\tif (!this.action)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tconst action = new Action(this.action);\n\t\t\tif (!action.isRedirect())\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tconst attrs = {\n\t\t\t\thref: action.getValue(),\n\t\t\t};\n\t\t\tconst target = action.getActionParam('target');\n\t\t\tif (target)\n\t\t\t{\n\t\t\t\tattrs.target = target;\n\t\t\t}\n\n\t\t\treturn attrs;\n\t\t},\n\n\t\tclassName(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__line_of_text_blocks_button',\n\t\t\t];\n\t\t},\n\n\t\ticonClassName(): Array\n\t\t{\n\t\t\tif (!this.icon)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn [\n\t\t\t\t'crm-timeline__line_of_text_blocks_button_icon',\n\t\t\t\t`--code-${this.icon}`,\n\t\t\t];\n\t\t},\n\t},\n\n\tmethods: {\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (this.action)\n\t\t\t{\n\t\t\t\tconst action = new Action(this.action);\n\t\t\t\taction.execute(this);\n\t\t\t}\n\t\t},\n\t\taddAlignRightClass(): void\n\t\t{\n\t\t\tthis.$el.parentElement.classList.add('right-fixed-button');\n\t\t},\n\t},\n\n\tmounted()\n\t{\n\t\tthis.addAlignRightClass();\n\t},\n\n\ttemplate:\n\t\t`\n\t\t\t<a\n\t\t\t\tv-if=\"href\"\n\t\t\t\tv-bind=\"linkAttrs\"\n\t\t\t\t:class=\"className\"\n\t\t\t\t:title=\"title\"\n\t\t\t>{{text}}<span v-if=\"icon\" :class=\"iconClassName\"></span>\n\t\t\t</a>\n\t\t\t<span\n\t\t\t\tv-else\n\t\t\t\t@click=\"executeAction\"\n\t\t\t\t:class=\"className\"\n\t\t\t\t:title=\"title\"\n\t\t\t>{{text}}<span v-if=\"icon\" :class=\"iconClassName\"></span>\n\t\t\t</span>\n\t\t`,\n};\n","import Text from './text';\nimport { CurrencyCore } from 'currency.currency-core';\nimport { Type } from 'main.core';\n\nexport default {\n\tprops: {\n\t\topportunity: Number,\n\t\tcurrencyId: String,\n\t},\n\tcomputed: {\n\t\tencodedText(): ?string\n\t\t{\n\t\t\tif (!Type.isNumber(this.opportunity) || !Type.isStringFilled(this.currencyId))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn CurrencyCore.currencyFormat(this.opportunity, this.currencyId, true);\n\t\t}\n\t},\n\textends: Text,\n\ttemplate: `\n\t\t<span\n\t\t\tv-if=\"encodedText\"\n\t\t\t:class=\"className\"\n\t\t\tv-html=\"encodedText\"\n\t\t></span>`\n};\n","import { CurrencyCore } from 'currency.currency-core';\nimport { Type } from 'main.core';\n\nexport const MoneyPill = {\n\tprops: {\n\t\topportunity: Number,\n\t\tcurrencyId: String,\n\t},\n\tcomputed: {\n\t\tmoneyHtml(): ?string\n\t\t{\n\t\t\tif (!Type.isNumber(this.opportunity) || !Type.isStringFilled(this.currencyId))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn CurrencyCore.currencyFormat(this.opportunity, this.currencyId, true);\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div class=\"crm-timeline-card__money-pill\">\n\t\t\t<span class=\"crm-timeline-card__money-pill_amount\">\n\t\t\t\t<span v-if=\"moneyHtml\" v-html=\"moneyHtml\"></span>\n\t\t\t</span>\n\t\t</div>\n\t`\n}\n","import { User } from '../layout/header/user';\nimport { Action } from '../../action';\nimport { Button } from '../layout/button';\nimport { ButtonState } from '../enums/button-state';\nimport { ButtonType } from '../enums/button-type';\nimport { Browser, Event, Runtime } from 'main.core';\nimport { MessageBox, MessageBoxButtons } from \"ui.dialogs.messagebox\";\n\nexport const Note = {\n\tcomponents: {\n\t\tUser,\n\t\tButton,\n\t},\n\tprops: {\n\t\tid: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t},\n\t\ttext: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdeleteConfirmationText: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tsaveNoteAction: {\n\t\t\ttype: Object,\n\t\t},\n\t\tdeleteNoteAction: {\n\t\t\ttype: Object,\n\t\t},\n\t\tupdatedBy: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tnote: this.text,\n\t\t\toldNote: this.text,\n\t\t\tisEdit: false,\n\t\t\tisExist: !!this.id,\n\t\t\tisSaving: false,\n\t\t\tisDeleting: false,\n\t\t\tisCollapsed: true,\n\t\t\tshortNoteLength: 113,\n\t\t}\n\t},\n\tinject: ['isReadOnly', 'currentUser'],\n\tcomputed: {\n\t\tnoteText() {\n\t\t\tif (this.isCollapsed)\n\t\t\t{\n\t\t\t\treturn this.shortNote;\n\t\t\t}\n\n\t\t\treturn this.note;\n\t\t},\n\n\t\tshortNote() {\n\t\t\tif (this.note.length > this.shortNoteLength)\n\t\t\t{\n\t\t\t\treturn `${this.note.slice(0, this.shortNoteLength)}...`;\n\t\t\t}\n\t\t\telse if (this.getNoteLineBreaksCount() > 2) {\n\t\t\t\tlet currentLineBreakerCount = 0;\n\t\t\t\tfor (let letterIndex = 0; letterIndex < this.note.length; letterIndex++)\n\t\t\t\t{\n\t\t\t\t\tconst letter = this.note[letterIndex];\n\t\t\t\t\tif (letter !== '\\n')\n\t\t\t\t\t{\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tcurrentLineBreakerCount++;\n\n\t\t\t\t\tif (currentLineBreakerCount === this.maxLineBreakerCount)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn `${this.note.slice(0, letterIndex)}...`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this.note;\n\t\t},\n\n\t\tmaxLineBreakerCount()\n\t\t{\n\t\t\treturn 3;\n\t\t},\n\n\t\texpandNoteBtnText() {\n\t\t\tif (this.isCollapsed)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('CRM_TIMELINE_ITEM_NOTE_SHOW');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('CRM_TIMELINE_ITEM_NOTE_HIDE');\n\t\t\t}\n\t\t},\n\t\tButtonType()\n\t\t{\n\t\t\treturn ButtonType;\n\t\t},\n\n\t\tisDeleteButtonVisible()\n\t\t{\n\t\t\treturn !(this.isReadOnly);\n\t\t},\n\n\t\tisEditButtonVisible()\n\t\t{\n\t\t\treturn !(this.isReadOnly || this.isEdit);\n\t\t},\n\n\t\tsaveButtonState()\n\t\t{\n\t\t\tif (this.isSaving)\n\t\t\t{\n\t\t\t\treturn ButtonState.DISABLED;\n\t\t\t}\n\n\t\t\tif (this.note.trim().length > 0)\n\t\t\t{\n\t\t\t\treturn ButtonState.DEFAULT;\n\t\t\t}\n\n\t\t\treturn ButtonState.DISABLED;\n\t\t},\n\n\t\tcancelButtonState()\n\t\t{\n\t\t\tif (this.isSaving)\n\t\t\t{\n\t\t\t\treturn ButtonState.DISABLED;\n\t\t\t}\n\n\t\t\treturn ButtonState.DEFAULT;\n\t\t},\n\n\t\tisNoteVisible()\n\t\t{\n\t\t\treturn this.isExist || this.isEdit;\n\t\t},\n\n\t\tuser() {\n\t\t\tif (this.updatedBy)\n\t\t\t{\n\t\t\t\treturn this.updatedBy;\n\t\t\t}\n\t\t\tif (this.currentUser)\n\t\t\t{\n\t\t\t\treturn this.currentUser;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\ttitle: '',\n\t\t\t\tdetailUrl: '',\n\t\t\t\timageUrl: '',\n\t\t\t};\n\t\t},\n\n\t\tisShowExpandBtn() {\n\t\t\treturn !this.isEdit && (this.note.length >  this.shortNoteLength || this.getNoteLineBreaksCount() > 2);\n\t\t}\n\t},\n\tmethods: {\n\t\ttoggleNoteLength() {\n\t\t\tthis.isCollapsed = !this.isCollapsed;\n\t\t},\n\n\t\tstartEditing()\n\t\t{\n\t\t\tthis.isEdit = true;\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.isCollapsed = false;\n\t\t\t\tconst textarea = this.$refs.noteText;\n\t\t\t\tthis.adjustHeight(textarea);\n\t\t\t\ttextarea.focus();\n\t\t\t});\n\n\t\t\tthis.executeAction({type: 'jsEvent', value: 'Note:StartEdit'});\n\t\t},\n\n\t\tadjustHeight(elem) {\n\t\t\telem.style.height = 0;\n\t\t\telem.style.height = (elem.scrollHeight)+\"px\";\n\t\t},\n\n\t\tsetEditMode(editMode: boolean)\n\t\t{\n\t\t\tconst isEdit = editMode ? !this.isReadOnly : false;\n\t\t\tif (isEdit !== this.isEdit)\n\t\t\t{\n\t\t\t\tif(isEdit)\n\t\t\t\t{\n\t\t\t\t\tthis.startEditing();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.isEdit = false;\n\t\t\t\t\tthis.executeAction({type: 'jsEvent', value: 'Note:FinishEdit'})\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tonEnterHandle(event)\n\t\t{\n\t\t\tif (\n\t\t\t\tevent.ctrlKey === true ||\n\t\t\t\t( Browser.isMac() && (event.metaKey === true || event.altKey === true) )\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.saveNote();\n\t\t\t}\n\t\t},\n\n\t\tcancelEditing()\n\t\t{\n\t\t\tthis.note = this.oldNote;\n\t\t\tthis.isEdit = false;\n\t\t\tthis.executeAction({type: 'jsEvent', value: 'Note:FinishEdit'});\n\t\t},\n\n\t\tdeleteNote()\n\t\t{\n\t\t\tif (this.isSaving)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.isExist)\n\t\t\t{\n\t\t\t\tthis.cancelEditing();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.deleteConfirmationText && this.deleteConfirmationText.length)\n\t\t\t{\n\t\t\t\tMessageBox.show({\n\t\t\t\t\tmessage: this.deleteConfirmationText,\n\t\t\t\t\tmodal: true,\n\t\t\t\t\tbuttons: MessageBoxButtons.YES_NO,\n\t\t\t\t\tonYes: (messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t\tthis.executeDeleteAction();\n\t\t\t\t\t},\n\t\t\t\t\tonNo: (messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.executeDeleteAction();\n\t\t\t}\n\t\t},\n\n\t\tsaveNote()\n\t\t{\n\t\t\tif (this.saveButtonState === ButtonState.DISABLED || this.isSaving || this.isDeleting)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this.note === this.text)\n\t\t\t{\n\t\t\t\tthis.cancelEditing();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isSaving = true;\n\t\t\tconst action = Runtime.clone(this.saveNoteAction);\n\t\t\taction.actionParams.text = this.note;\n\n\t\t\tthis.executeAction(action).then(({status}) =>\n\t\t\t{\n\t\t\t\tif (status === 'success')\n\t\t\t\t{\n\t\t\t\t\tthis.oldNote = this.$refs.noteText.value.trim();\n\t\t\t\t\tthis.isExist = true;\n\t\t\t\t\tthis.cancelEditing();\n\t\t\t\t}\n\t\t\t}).finally(() =>\n\t\t\t{\n\t\t\t\tthis.isSaving = false;\n\t\t\t});\n\t\t},\n\n\t\texecuteDeleteAction()\n\t\t{\n\t\t\tif (this.isSaving)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isDeleting = true;\n\n\t\t\tthis.executeAction(this.deleteNoteAction).then(({status}) =>\n\t\t\t{\n\t\t\t\tif (status === 'success')\n\t\t\t\t{\n\t\t\t\t\tthis.oldNote = '';\n\t\t\t\t\tthis.isExist = false;\n\t\t\t\t\tthis.cancelEditing();\n\t\t\t\t}\n\t\t\t}).finally(() =>\n\t\t\t{\n\t\t\t\tthis.isDeleting = false;\n\t\t\t});\n\t\t},\n\n\t\texecuteAction(actionObject): Promise\n\t\t{\n\t\t\tif (!actionObject)\n\t\t\t{\n\t\t\t\tconsole.error('No action object to execute');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst action = new Action(actionObject);\n\t\t\treturn action.execute(this);\n\t\t},\n\n\t\thandleWindowResize() {\n\t\t\tconst windowWidth = window.innerWidth;\n\n\t\t\tif (windowWidth > 1400)\n\t\t\t{\n\t\t\t\tthis.shortNoteLength = 250;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.shortNoteLength = 113;\n\t\t\t}\n\t\t},\n\n\t\tgetNoteLineBreaksCount() {\n\t\t\treturn this.note.split('').reduce((counter, elem) => {\n\t\t\t\treturn counter + (elem === '\\n' ? 1 : 0);\n\t\t\t}, 0);\n\t\t}\n\t},\n\twatch: {\n\t\tid(id)\n\t\t{\n\t\t\tthis.isExist = !!id;\n\t\t},\n\n\t\ttext(text)\n\t\t{\n\t\t\tthis.note = text;\n\t\t\tthis.oldNote = text;\n\t\t},\n\n\t\tnote() {\n\t\t\tif (!this.isEdit)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.adjustHeight(this.$refs.noteText);\n\t\t\t});\n\t\t},\n\n\t\tisEdit(value)\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tthis.$nextTick(() => this.$refs.noteText.focus());\n\t\t\t}\n\t\t}\n\t},\n\n\tcreated() {\n\t\tthis.handleWindowResize();\n\t\tEvent.bind(window, 'resize', this.handleWindowResize);\n\t},\n\n\tdestroyed() {\n\t\tEvent.unbind(window, 'resize', this.handleWindowResize);\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tv-show=\"isNoteVisible\"\n\t\t\tclass=\"crm-timeline__card-note\"\n\t\t>\n\t\t\t<div class=\"crm-timeline__card-note_user\">\n\t\t\t\t<User v-bind=\"user\"></User>\n\t\t\t</div>\n\t\t\t<div class=\"crm-timeline__card-note_area\">\n\t\t\t\t<div class=\"crm-timeline__card-note_value\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tv-if=\"isEdit\"\n\t\t\t\t\t\t\tv-model=\"note\"\n\t\t\t\t\t\t\t@keydown.esc.stop=\"cancelEditing\"\n\t\t\t\t\t\t\t@keydown.enter=\"onEnterHandle\"\n\t\t\t\t\t\t\t:disabled=\"!isEdit || isSaving\"\n\t\t\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('CRM_TIMELINE_USER_NOTE_PLACEHOLDER')\"\n\t\t\t\t\t\t\tref=\"noteText\"\n\t\t\t\t\t\t\tclass=\"crm-timeline__card-note_text\"\n\t\t\t\t\t\t></textarea>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tv-else\n\t\t\t\t\t\t\tref=\"noteText\"\n\t\t\t\t\t\t\tclass=\"crm-timeline__card-note_text\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{noteText}}\n\t\t\t\t\t\t</span>\n\t\n\t\t\t\t\t<span\n\t\t\t\t\t\tv-if=\"isEditButtonVisible\"\n\t\t\t\t\t\tclass=\"crm-timeline__card-note_edit\"\n\t\t\t\t\t\t@click.prevent.stop=\"startEditing\"\n\t\t\t\t\t>\n\t\t\t\t\t\t\t<i></i>\n\t\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"isEdit\" class=\"crm-timeline__card-note__controls\">\n\t\t\t\t\t<div class=\"crm-timeline__card-note__control --save\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t@click=\"saveNote\"\n\t\t\t\t\t\t\t:state=\"saveButtonState\" :type=\"ButtonType.PRIMARY\"\n\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_TIMELINE_USER_NOTE_SAVE')\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crm-timeline__card-note__control --cancel\">\n\t\t\t\t\t\t<Button @click=\"cancelEditing\"\n\t\t\t\t\t\t\t\t:type=\"ButtonType.LIGHT\"\n\t\t\t\t\t\t\t\t:state=\"cancelButtonState\"\n\t\t\t\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('CRM_TIMELINE_USER_NOTE_CANCEL')\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"isDeleteButtonVisible\" class=\"crm-timeline__card-note_cross\" @click=\"deleteNote\">\n\t\t\t\t<i></i>\n\t\t\t</div>\n\t\t\t<div v-if=\"isDeleting\" class=\"crm-timeline__card-note_dimmer\"></div>\n\t\t\t<div\n\t\t\t\tv-show=\"isShowExpandBtn\"\n\t\t\t\t@click=\"toggleNoteLength\"\n\t\t\t\tclass=\"crm-timeline__card-note_expand-note-btn\"\n\t\t\t>\n\t\t\t\t{{ expandNoteBtnText }}\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n","import LineOfTextBlocks from './line-of-text-blocks';\nimport { AlertColor, AlertIcon } from 'ui.alerts';\n\nexport const PlayerAlert = {\n\tcomponents: {\n\t\tLineOfTextBlocks,\n\t},\n\tprops: {\n\t\tblocks: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t\tcolor: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: AlertColor.DEFAULT,\n\t\t},\n\t\ticon: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: AlertIcon.NONE,\n\t\t},\n\t},\n\tcomputed: {\n\t\tcontainerClassname() {\n\t\t\treturn [\n\t\t\t\t'crm-timeline__player-alert',\n\t\t\t\t'ui-alert',\n\t\t\t\t'ui-alert-xs',\n\t\t\t\t'ui-alert-text-center',\n\t\t\t\tthis.color,\n\t\t\t\tthis.icon,\n\t\t\t]\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"containerClassname\">\n\t\t\t<div class=\"ui-alert-message\">\n\t\t\t\t<LineOfTextBlocks :blocks=\"blocks\"></LineOfTextBlocks>\n\t\t\t</div>\n\t\t</div>\n\t`\n}","import { Text } from 'main.core';\n\nexport const RestAppLayoutBlocks = {\n\tprops: {\n\t\titemTypeId: {\n\t\t\ttype: Number,\n\t\t},\n\t\titemId: {\n\t\t\ttype: Number,\n\t\t},\n\t\trestAppInfo: {\n\t\t\ttitle: String,\n\t\t\tclientId: String,\n\t\t},\n\t\tcontentBlocks: {\n\t\t\ttype: Object,\n\t\t},\n\t},\n\tcomputed: {\n\t\trestAppTitle(): string\n\t\t{\n\t\t\treturn Text.encode(this.restAppInfo.title);\n\t\t},\n\t\tclientId(): string\n\t\t{\n\t\t\treturn Text.encode(this.restAppInfo.clientId);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"crm_timeline__rest_app_layout_blocks\" :data-app-name=\"restAppTitle\" :data-rest-client-id=\"clientId\">\n\t\t\t<div class=\"crm-timeline__card-container_block\" v-for=\"contentBlock in contentBlocks\">\n\t\t\t\t<component :is=\"contentBlock.rendererName\" v-bind=\"contentBlock.properties\" ref=\"contentBlocks\" />\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export const SmsMessage = {\n\tprops: {\n\t\ttext: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed: {\n\t\tmessageHtml(): string\n\t\t{\n\t\t\treturn BX.util.htmlspecialchars(this.text).replace(/\\r\\n|\\r|\\n/g, '<br/>');\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"crm-timeline__item_sms-message\">\n\t\t\t<span v-if=\"messageHtml\" v-html=\"messageHtml\"></span>\n\t\t</div>\n\t`\n}\n","import { Text } from 'main.core';\n\nimport { Action } from '../../../action';\n\nconst STATE_LOADING = 'loading';\nconst STATE_PROCESSED = 'processed';\nconst STATE_UNPROCESSED = 'unprocessed';\n\nexport const CallScoringPill = {\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tvalue: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tstate: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: STATE_UNPROCESSED,\n\t\t},\n\t\taction: Object | null,\n\t},\n\n\tinject: ['isReadOnly'],\n\n\tcomputed: {\n\t\tclassName(): []\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__call-scoring-pill',\n\t\t\t\t{\n\t\t\t\t\t'--readonly': this.isPillReadonly,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\n\t\trenderValue(): String\n\t\t{\n\t\t\tswitch (this.state)\n\t\t\t{\n\t\t\t\tcase STATE_LOADING:\n\t\t\t\t\treturn '<span class=\"loader\"></span>';\n\t\t\t\tcase STATE_PROCESSED:\n\t\t\t\t\treturn Text.encode(this.value);\n\t\t\t\tcase STATE_UNPROCESSED:\n\t\t\t\tdefault:\n\t\t\t\t\treturn '<span class=\"arrow\">&nbsp;</span>';\n\t\t\t}\n\t\t},\n\n\t\tisPillReadonly(): boolean\n\t\t{\n\t\t\treturn this.isReadOnly || !this.action;\n\t\t},\n\t},\n\n\tmethods: {\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (this.isPillReadonly)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst action = new Action(this.action);\n\n\t\t\tvoid action.execute(this);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\t:class='className'\n\t\t\t@click='executeAction'\n\t\t>\n\t\t\t<div class='crm-timeline__call-scoring-pill-left'>{{ this.title }}</div>\n\t\t\t<div class='crm-timeline__call-scoring-pill-separator'></div>\n\t\t\t<div class='crm-timeline__call-scoring-pill-right' v-html='renderValue'></div>\n\t\t</div>\n\t`,\n};\n","import { Text } from 'main.core';\nimport { AvatarRoundGuest } from 'ui.avatar';\n\nimport { Action } from '../../../action';\n\nexport const CallScoring = {\n\tprops: {\n\t\tuserName: String,\n\t\tuserAvatarUrl: String,\n\t\tscoringData: Object | null,\n\t\taction: Object | null,\n\t},\n\n\tinject: ['isReadOnly'],\n\n\tcomputed: {\n\t\tclassName(): Object\n\t\t{\n\t\t\tconst assessment = Text.toInteger(this.scoringData?.ASSESSMENT);\n\t\t\tconst highBorder = Text.toInteger(this.scoringData?.HIGH_BORDER);\n\t\t\tconst lowBorder = Text.toInteger(this.scoringData?.LOW_BORDER);\n\n\t\t\treturn {\n\t\t\t\t'crm-timeline__call-scoring': true,\n\t\t\t\t'--success': assessment >= highBorder,\n\t\t\t\t'--failed': assessment <= lowBorder,\n\t\t\t};\n\t\t},\n\n\t\tassessmentScriptClassName(): []\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__call-scoring-assessment-script',\n\t\t\t\t{\n\t\t\t\t\t'--readonly': this.isContentReadonly,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\n\t\tassessmentPillClassName(): []\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__call-scoring-assessment-pill',\n\t\t\t\t{\n\t\t\t\t\t'--readonly': this.isContentReadonly,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\n\t\tisContentReadonly(): boolean\n\t\t{\n\t\t\treturn this.isReadOnly || !this.action;\n\t\t},\n\n\t\trenderUserAvatarElement(): string\n\t\t{\n\t\t\treturn new AvatarRoundGuest({\n\t\t\t\tsize: 26,\n\t\t\t\tuserName: this.userName,\n\t\t\t\tuserpicPath: this.userAvatarUrl,\n\t\t\t\tbaseColor: '#7fdefc',\n\t\t\t\tborderColor: '#9dcf00',\n\t\t\t}).getContainer().outerHTML;\n\t\t},\n\t},\n\n\tmethods: {\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (this.isContentReadonly)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst action = new Action(this.action);\n\n\t\t\tvoid action.execute(this);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div :class='className'>\n\t\t\t<div class='crm-timeline__call-scoring-wrapper'>\n\t\t\t\t<div class='crm-timeline__call-scoring-responsible'>\n\t\t\t\t\t<div class='crm-timeline__call-scoring-title'>\n\t\t\t\t\t\t{{ this.$Bitrix.Loc.getMessage('CRM_TIMELINE_ITEM_CALL_SCORING_RESPONSIBLE_TITLE') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class='crm-timeline__call-scoring-responsible-content'>\n\t\t\t\t\t\t<div class='responsible-user-avatar' v-html=\"renderUserAvatarElement\"></div>\n\t\t\t\t\t\t<div class='responsible-user-name'>{{ this.userName }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class='crm-timeline__line-div'></div>\n\t\t\t\t<div class='crm-timeline__call-scoring-assessment'>\n\t\t\t\t\t<div class='crm-timeline__call-scoring-assessment-wrapper'>\n\t\t\t\t\t\t<!--\n\t\t\t\t\t\t<img \n\t\t\t\t\t\t\tclass='copilot-avatar' \n\t\t\t\t\t\t\tsrc='/bitrix/js/crm/timeline/item/src/images/crm-timelime__copilot-avatar.svg' \n\t\t\t\t\t\t\talt='copilot-avatar'\n\t\t\t\t\t\t>\n\t\t\t\t\t\t-->\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t:class='assessmentPillClassName'\n\t\t\t\t\t\t\t@click='executeAction'\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span class=\"value\">{{ this.scoringData?.ASSESSMENT }}</span>\n\t\t\t\t\t\t\t<div class=\"percent\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class='script-layout'>\n\t\t\t\t\t\t\t<div class='crm-timeline__call-scoring-title'>\n\t\t\t\t\t\t\t\t{{ this.$Bitrix.Loc.getMessage('CRM_TIMELINE_ITEM_CALL_SCORING_SCRIPT_TITLE') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\t:class='assessmentScriptClassName'\n\t\t\t\t\t\t\t\t@click='executeAction'\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{ this.scoringData?.TITLE }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export class DeadlineAndPingSelectorBackgroundColor\n{\n\tstatic ORANGE = 'orange';\n\tstatic GRAY = 'gray';\n}\n","import { Text, Type } from 'main.core';\nimport { DeadlineAndPingSelectorBackgroundColor } from '../../enums/deadline-and-ping-selector-background';\n\nexport default {\n\tprops: {\n\t\tisScheduled: Boolean,\n\t\tdeadlineBlock: Object,\n\t\tpingSelectorBlock: Object,\n\t\tdeadlineBlockTitle: String,\n\t\tbackgroundToken: String,\n\t\tbackgroundColor: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tdeadlineBlockData: this.deadlineBlock,\n\t\t\tpingSelectorBlockData: this.pingSelectorBlock,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tclassName(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-timeline__card-container_info': true,\n\t\t\t\t'--inline': true,\n\t\t\t\t'crm-timeline-block-deadline-and-ping-selector-deadline-wrapper': true,\n\t\t\t\t'--orange': this.backgroundToken === DeadlineAndPingSelectorBackgroundColor.ORANGE,\n\t\t\t\t'--gray': this.backgroundToken === DeadlineAndPingSelectorBackgroundColor.GRAY,\n\t\t\t};\n\t\t},\n\t\tdeadlineBlockStyle(): Object\n\t\t{\n\t\t\tif (this.isScheduled && Type.isStringFilled(this.backgroundColor))\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\t'--crm-timeline-block-deadline-and-ping-selector-deadline_bg-color': Text.encode(this.backgroundColor),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {};\n\t\t},\n\t},\n\n\tmethods: {\n\t\tonDeadlineChange(deadline: number)\n\t\t{\n\t\t\tthis.deadlineBlockData.properties.value = deadline;\n\t\t\tthis.pingSelectorBlockData.properties.deadline = deadline;\n\n\t\t\tthis.$refs.pingSelectorBlock.setDeadline(deadline);\n\t\t},\n\t},\n\n\tcreated()\n\t{\n\t\tthis.$watch(\n\t\t\t'deadlineBlock',\n\t\t\t(deadlineBlock) => {\n\t\t\t\tthis.deadlineBlockData = deadlineBlock;\n\t\t\t},\n\t\t\t{\n\t\t\t\tdeep: true,\n\t\t\t},\n\t\t);\n\n\t\tthis.$watch(\n\t\t\t'pingSelectorBlock',\n\t\t\t(pingSelectorBlock) => {\n\t\t\t\tthis.pingSelectorBlockData = pingSelectorBlock;\n\t\t\t},\n\t\t\t{\n\t\t\t\tdeep: true,\n\t\t\t},\n\t\t);\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<span class=\"crm-timeline-block-deadline-and-ping-selector\">\n\t\t\t<div \n\t\t\t\t:class=\"className\" \n\t\t\t\tref=\"deadlineBlock\" \n\t\t\t\tv-if=\"deadlineBlock\"\n\t\t\t\t:style=\"deadlineBlockStyle\"\n\t\t\t>\n\t\t\t\t<div class=\"crm-timeline__card-container_info-title\" v-if=\"deadlineBlockTitle\">\n\t\t\t\t\t{{deadlineBlockTitle}}&nbsp;\n\t\t\t\t</div>\n\t\t\t\t<component\n\t\t\t\t\t:is=\"deadlineBlock.rendererName\"\n\t\t\t\t\tv-bind=\"deadlineBlockData.properties\"\n\t\t\t\t\t@onChange=\"onDeadlineChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\n\t\t\t<component\n\t\t\t\tv-if=\"pingSelectorBlock\"\n\t\t\t\t:is=\"pingSelectorBlock.rendererName\"\n\t\t\t\tv-bind=\"pingSelectorBlockData.properties\"\n\t\t\t\tref=\"pingSelectorBlock\"\n\t\t\t/>\n\t\t</span>\t\n\t`,\n};\n","import { PingSelector, PingSelectorEvents } from 'crm.field.ping-selector';\nimport { DatetimeConverter } from 'crm.timeline.tools';\nimport { Runtime, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Timezone } from 'main.date';\n\nimport { Action } from '../../../action';\n\nconst SAVE_OFFSETS_REQUEST_DELAY = 1000;\n\nexport default {\n\tprops: {\n\t\tvaluesList: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t\tdefault: [],\n\t\t},\n\t\tvalue: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\tdeadline: {\n\t\t\ttype: Number,\n\t\t},\n\t\tsaveAction: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\ticon: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t\trequired: false,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tdeadlineData: this.deadline,\n\t\t};\n\t},\n\n\twatch: {\n\t\tdeadline(deadline: number): void\n\t\t{\n\t\t\tthis.deadlineData = deadline;\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.initPingSelector();\n\t},\n\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe(\n\t\t\tthis.pingSelector,\n\t\t\tPingSelectorEvents.EVENT_PINGSELECTOR_VALUE_CHANGE,\n\t\t\tthis.onItemSelectorValueChange,\n\t\t);\n\t},\n\n\tmethods: {\n\t\tonItemSelectorValueChange(event: BaseEvent): void\n\t\t{\n\t\t\tRuntime.debounce(\n\t\t\t\t() => {\n\t\t\t\t\tconst data = event.getData();\n\t\t\t\t\tif (data)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.executeSaveAction(data.value);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tSAVE_OFFSETS_REQUEST_DELAY,\n\t\t\t\tthis,\n\t\t\t)();\n\t\t},\n\n\t\texecuteSaveAction(items: Array): void\n\t\t{\n\t\t\tif (!this.saveAction)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.value.sort().toString() === items.sort().toString())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// to avoid unintended props mutation\n\t\t\tconst actionDescription = Runtime.clone(this.saveAction);\n\n\t\t\tactionDescription.actionParams ??= {};\n\t\t\tactionDescription.actionParams.value = items;\n\n\t\t\tconst action = new Action(actionDescription);\n\n\t\t\tvoid action.execute(this);\n\t\t},\n\n\t\tinitPingSelector(): void\n\t\t{\n\t\t\tconst deadlineDate = this.createDateFromDeadline();\n\t\t\tconst deadlineTime: null | number = deadlineDate?.getTime();\n\t\t\tconst currentTime = Date.now();\n\n\t\t\tconst deadline = deadlineTime > currentTime\n\t\t\t\t? deadlineDate\n\t\t\t\t: new Date()\n\t\t\t;\n\n\t\t\tthis.pingSelector = new PingSelector({\n\t\t\t\ttarget: this.$el,\n\t\t\t\tvaluesList: this.valuesList,\n\t\t\t\tselectedValues: this.value,\n\t\t\t\ticon: Type.isStringFilled(this.icon) ? this.icon : null,\n\t\t\t\tdeadline,\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe(\n\t\t\t\tthis.pingSelector,\n\t\t\t\tPingSelectorEvents.EVENT_PINGSELECTOR_VALUE_CHANGE,\n\t\t\t\tthis.onItemSelectorValueChange,\n\t\t\t);\n\t\t},\n\n\t\tcreateDateFromDeadline(): null | Date\n\t\t{\n\t\t\tif (!Type.isNumber(this.deadlineData))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn DatetimeConverter.createFromServerTimestamp(this.deadlineData).getValue();\n\t\t},\n\n\t\tsetDeadline(deadline: number): void\n\t\t{\n\t\t\tconst date = Timezone.UserTime.getDate(deadline);\n\n\t\t\tthis.deadlineData = date.getTime() / 1000;\n\t\t\tthis.pingSelector.setDeadline(date);\n\t\t},\n\t},\n\n\ttemplate: '<div></div>',\n};\n","import { Dom } from 'main.core';\n\nexport default {\n\tprops: {\n\t\ttitle: String,\n\t\tinline: Boolean,\n\t\twordWrap: Boolean,\n\t\tfixedWidth: Boolean,\n\t\ttitleBottomPadding: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: 0,\n\t\t},\n\t\tcontentBlock: Object,\n\t},\n\tcomputed: {\n\t\tclassName(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-timeline__card-container_info': true,\n\t\t\t\t'--inline': this.inline,\n\t\t\t\t'--word-wrap': this.wordWrap,\n\t\t\t\t'--fixed-width': this.fixedWidth,\n\t\t\t};\n\t\t},\n\t\tvalueClassName(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-timeline__card-container_info-value': true,\n\t\t\t};\n\t\t},\n\t},\n\n\tmethods: {\n\t\tisTitleCropped(): boolean\n\t\t{\n\t\t\tconst titleElem: Element = this.$refs.title;\n\n\t\t\treturn titleElem.scrollWidth > titleElem.clientWidth;\n\t\t},\n\t},\n\n\tmounted()\n\t{\n\t\tvoid this.$nextTick(() => {\n\t\t\tif (!this.$refs.title)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isTitleCropped())\n\t\t\t{\n\t\t\t\tDom.attr(this.$refs.title, 'title', this.title);\n\t\t\t}\n\n\t\t\tif (this.titleBottomPadding > 0)\n\t\t\t{\n\t\t\t\tDom.style(this.$refs.title, 'padding-bottom', `${this.titleBottomPadding}px`);\n\t\t\t}\n\t\t});\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\t:class=\"className\"\n\t\t>\n\t\t\t<div\n\t\t\t\tref=\"title\" \n\t\t\t\tclass=\"crm-timeline__card-container_info-title\"\n\t\t\t>\n\t\t\t\t{{ title }}\n\t\t\t</div>\n\t\t\t<div \n\t\t\t\t:class=\"valueClassName\"\n\t\t\t>\n\t\t\t\t<component \n\t\t\t\t\t:is=\"contentBlock.rendererName\"\n\t\t\t\t\tv-bind=\"contentBlock.properties\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom, Loc, Runtime, Tag } from 'main.core';\nimport { WorkflowResultStatus } from 'bizproc.types';\n\nimport 'ui.hint';\n\nexport default {\n\tdata(): Object {\n\t\treturn {\n\t\t\tformattedAverageDuration: '',\n\t\t\tformattedExecutionTime: '',\n\t\t};\n\t},\n\tprops: {\n\t\taverageDuration: Number,\n\t\tefficiency: String,\n\t\texecutionTime: Number,\n\t\tprocessTimeText: String,\n\t\tworkflowResult: Object,\n\t\tauthor: Object,\n\t},\n\tcomputed: {\n\t\titemClassName(): string\n\t\t{\n\t\t\treturn `bizproc-workflow-timeline-eff-icon --${this.efficiency}`;\n\t\t},\n\t\tefficiencyCaption(): string\n\t\t{\n\t\t\tlet notice = this.efficiency === 'fast' ? 'QUICKLY' : 'SLOWLY';\n\t\t\tif (this.efficiency === 'stopped')\n\t\t\t{\n\t\t\t\tnotice = 'NO_PROGRESS';\n\t\t\t}\n\n\t\t\treturn Loc.getMessage(`BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED_${notice}`);\n\t\t},\n\t\thasResult(): boolean\n\t\t{\n\t\t\treturn this.workflowResult !== undefined;\n\t\t},\n\t\tworkflowResultHtml(): HTMLElement | string | null\n\t\t{\n\t\t\tif (this.workflowResult && this.workflowResult.status === WorkflowResultStatus.NO_RIGHTS_RESULT)\n\t\t\t{\n\t\t\t\tthis.workflowResult.text = Loc.getMessage('CRM_TIMELINE_WORKFLOW_RESULT_NO_RIGHTS_VIEW');\n\t\t\t}\n\n\t\t\treturn this.workflowResult?.text ?? null;\n\t\t},\n\t\taverageDurationText(): string\n\t\t{\n\t\t\treturn Loc.getMessage('CRM_TIMELINE_WORKFLOW_EFFICIENCY_AVERAGE_PROCESS_TIME');\n\t\t},\n\t\tresultCaption(): string\n\t\t{\n\t\t\tif (!this.userResult)\n\t\t\t{\n\t\t\t\treturn Loc.getMessage('CRM_TIMELINE_WORKFLOW_RESULT_TITLE');\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\tuserResult(): ?string\n\t\t{\n\t\t\tif (!this.hasResult)\n\t\t\t{\n\t\t\t\tconst userLink = Tag.render`<a href=\"${this.href}\"></a>`;\n\t\t\t\tuserLink.textContent = this.author?.fullName;\n\n\t\t\t\treturn Loc.getMessage(\n\t\t\t\t\t'CRM_TIMELINE_WORKFLOW_NO_RESULT',\n\t\t\t\t\t{ '#USER#': userLink.outerHTML },\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (this.workflowResult && this.workflowResult.status === WorkflowResultStatus.USER_RESULT)\n\t\t\t{\n\t\t\t\tif (this.author)\n\t\t\t\t{\n\t\t\t\t\treturn Loc.getMessage(\n\t\t\t\t\t\t'CRM_TIMELINE_WORKFLOW_NO_RESULT',\n\t\t\t\t\t\t{ '#USER#': this.workflowResult.text ?? '' },\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn this.workflowResult.text ?? '';\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t},\n\tmounted(): void {\n\t\tif (this.workflowResult && this.workflowResult.status === WorkflowResultStatus.NO_RIGHTS_RESULT)\n\t\t{\n\t\t\tthis.showHint();\n\t\t}\n\n\t\tRuntime.loadExtension('bizproc.workflow.timeline')\n\t\t\t.then(({ DurationFormatter }) => {\n\t\t\t\tthis.formattedAverageDuration = DurationFormatter.formatTimeInterval(this.averageDuration);\n\t\t\t\tthis.formattedExecutionTime = DurationFormatter.formatTimeInterval(this.executionTime);\n\t\t\t})\n\t\t\t.catch((e) => {\n\t\t\t\tconsole.error('Error loading DurationFormatter:', e);\n\t\t\t});\n\t},\n\tmethods: {\n\t\tshowHint(): void {\n\t\t\tconst resultBlock = this.$refs.resultBlock;\n\t\t\tif (resultBlock)\n\t\t\t{\n\t\t\t\tconst hintAnchor = Tag.render`<span data-hint=\"${Loc.getMessage('CRM_TIMELINE_WORKFLOW_RESULT_NO_RIGHTS_TOOLTIP')}\"></span>`;\n\t\t\t\tDom.append(hintAnchor, resultBlock);\n\n\t\t\t\tBX.UI.Hint.init(resultBlock);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"crm-timeline__text-block crm-timeline__workflow-efficiency-block\">\n\t\t\t<div class=\"bizproc-workflow-timeline-item --result\">\n\t\t\t\t<div class=\"\">\n\t\t\t\t\t<div class=\"bizproc-workflow-timeline-content\">\n\t\t\t\t\t\t<div v-if=\"!userResult\" class=\"bp-result\">\n\t\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-caption\">{{ resultCaption }}</div>\n\t\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-result\" ref=\"resultBlock\" v-html=\"workflowResultHtml\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"userResult\" class=\"bp-result\" v-html=\"userResult\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"bizproc-workflow-timeline-item --efficiency\">\n\t\t\t\t<div class=\"bizproc-workflow-timeline-item-wrapper\">\n\t\t\t\t\t<div class=\"bizproc-workflow-timeline-content\">\n\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-content-inner\">\n\t\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-caption\">{{ efficiencyCaption }}</div>\n\t\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-notice\">\n\t\t\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-subject\">{{ processTimeText }}</div>\n\t\t\t\t\t\t\t\t<span class=\"bizproc-workflow-timeline-text\">{{ formattedExecutionTime }}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-notice\">\n\t\t\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-subject\">{{ averageDurationText }}</div>\n\t\t\t\t\t\t\t\t<span class=\"bizproc-workflow-timeline-text\">{{ formattedAverageDuration }}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div :class=\"itemClassName\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export class ErrorType {\n\tstatic AI = 'ai';\n}\n","import { Dom, Text, Type } from 'main.core';\n\nimport { ErrorType } from '../enums/error-type';\n\n\nexport const ErrorBlock = {\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t\tdefault: '',\n\t\t},\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t\tdefault: '',\n\t\t},\n\t\tclosable: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t\tdefault: false,\n\t\t},\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisClosable: this.closable,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\ticonClassname(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'crm-timeline__error-block__header-icon': true,\n\t\t\t\t'--ai': this.type === ErrorType.AI,\n\t\t\t}\n\t\t},\n\n\t\tencodedTitle(): string\n\t\t{\n\t\t\treturn Text.encode(this.title);\n\t\t},\n\n\t\tencodedDescription(): string\n\t\t{\n\t\t\treturn Text.encode(this.description);\n\t\t},\n\t},\n\n\tmethods: {\n\t\tcloseBlock(): void\n\t\t{\n\t\t\tconst blockEl = this.$refs.rootElement;\n\t\t\tif (Type.isDomNode(blockEl))\n\t\t\t{\n\t\t\t\tDom.addClass(blockEl, '--hidden');\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tDom.remove(blockEl);\n\t\t\t\t}, 700);\n\t\t\t}\n\t\t}\n\t},\n\n\ttemplate: `\n\t\t<div ref=\"rootElement\" class=\"crm-timeline__error-block_wrapper\">\n\t\t\t<div class=\"crm-timeline__error-block\">\n\t\t\t\t<div class=\"crm-timeline__error-block__header\">\n\t\t\t\t\t<div :class=\"iconClassname\"></div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"crm-timeline__error-block__header-title\"\n\t\t\t\t\t\tv-html=\"encodedTitle\"\n\t\t\t\t\t></div>\n\t\t\t\t\t<button\n\t\t\t\t\t\tv-if=\"isClosable\"\n\t\t\t\t\t\t@click=\"closeBlock\"\n\t\t\t\t\t\tclass=\"crm-timeline__error-block_close-btn\"\n\t\t\t\t\t></button>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"crm-timeline__error-block__description\"\n\t\t\t\t\tv-html=\"encodedDescription\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n}\n","import { Type } from 'main.core';\nimport AddressBlock from '../components/content-blocks/address';\nimport { ClientMark } from '../components/content-blocks/client-mark';\nimport CommentContent from '../components/content-blocks/comment-content';\nimport DateBlock from '../components/content-blocks/date';\nimport DatePill from '../components/content-blocks/date-pill';\nimport EditableDate from '../components/content-blocks/editable-date';\nimport { EditableDescription } from '../components/content-blocks/editable-description';\nimport EditableText from '../components/content-blocks/editable-text';\nimport { FileList } from '../components/content-blocks/file-list';\nimport { InfoGroup } from '../components/content-blocks/info-group';\nimport ItemSelector from '../components/content-blocks/item-selector';\nimport LineOfTextBlocks from '../components/content-blocks/line-of-text-blocks';\nimport LinkBlock from '../components/content-blocks/link';\nimport LineOfTextBlocksButton from '../components/content-blocks/line-of-text-blocks-button';\nimport Money from '../components/content-blocks/money';\nimport { MoneyPill } from '../components/content-blocks/money-pill';\nimport { Note } from '../components/content-blocks/note';\nimport { PlayerAlert } from '../components/content-blocks/player-alert';\nimport { RestAppLayoutBlocks } from '../components/content-blocks/rest-app-layout-blocks';\nimport { SmsMessage } from '../components/content-blocks/sms-message';\nimport TextBlock from '../components/content-blocks/text';\nimport { TimelineAudio } from '../components/content-blocks/timeline-audio';\nimport { CallScoringPill } from '../components/content-blocks/copilot/call-scoring-pill';\nimport { CallScoring } from '../components/content-blocks/copilot/call-scoring.js';\nimport DeadlineAndPingSelector from '../components/content-blocks/todo/deadline-and-ping-selector';\nimport PingSelector from '../components/content-blocks/todo/ping-selector';\nimport WithTitle from '../components/content-blocks/with-title';\nimport WorkflowEfficiency from '../components/content-blocks/workflow-efficiency';\nimport { ErrorBlock } from '../components/content-blocks/error-block';\nimport ConfigurableItem from '../configurable-item';\nimport { Base } from './base';\n\nexport class CommonContentBlocks extends Base\n{\n\tgetContentBlockComponents(Item: ConfigurableItem): Object\n\t{\n\t\treturn {\n\t\t\tAddressBlock,\n\t\t\tTextBlock,\n\t\t\tLinkBlock,\n\t\t\tLineOfTextBlocksButton,\n\t\t\tDateBlock,\n\t\t\tWithTitle,\n\t\t\tLineOfTextBlocks,\n\t\t\tTimelineAudio,\n\t\t\tClientMark,\n\t\t\tMoney,\n\t\t\tEditableText,\n\t\t\tEditableDescription,\n\t\t\tEditableDate,\n\t\t\tPlayerAlert,\n\t\t\tRestAppLayoutBlocks,\n\t\t\tDatePill,\n\t\t\tNote,\n\t\t\tFileList,\n\t\t\tInfoGroup,\n\t\t\tMoneyPill,\n\t\t\tSmsMessage,\n\t\t\tCommentContent,\n\t\t\tItemSelector,\n\t\t\tPingSelector,\n\t\t\tDeadlineAndPingSelector,\n\t\t\tWorkflowEfficiency,\n\t\t\tCallScoringPill,\n\t\t\tCallScoring,\n\t\t\tErrorBlock,\n\t\t};\n\t}\n\n\t/**\n\t * Process common events that aren't bound to specific item type\n\t */\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Item:OpenEntityDetailTab' && Type.isStringFilled(actionData?.tabId))\n\t\t{\n\t\t\tthis.#openEntityDetailTab(actionData.tabId);\n\t\t}\n\n\t\tif (action === 'Note:StartEdit')\n\t\t{\n\t\t\tthis.#editNote(item);\n\t\t}\n\n\t\tif (action === 'Note:FinishEdit')\n\t\t{\n\t\t\tthis.#cancelEditNote(item);\n\t\t}\n\t}\n\n\t#openEntityDetailTab(tabId: string): void\n\t{\n\t\t// the event is handled by compatible code, it's a pain to use EventEmitter in this case\n\t\t// eslint-disable-next-line bitrix-rules/no-bx\n\t\tBX.onCustomEvent(window, 'OpenEntityDetailTab', [tabId]);\n\t}\n\n\t#editNote(item: ConfigurableItem) {\n\t\titem.getLayoutContentBlockById('note')?.setEditMode(true);\n\t\titem.highlightContentBlockById('note', true);\n\t}\n\n\t#cancelEditNote(item: ConfigurableItem) {\n\t\titem.getLayoutContentBlockById('note')?.setEditMode(false);\n\t\titem.highlightContentBlockById('note', false);\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn true; // common blocks can be used anywhere\n\t}\n}\n","import 'ui.design-tokens';\nimport {Action} from '../../../action';\n\nexport default {\n\tprops: {\n\t\ttext: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\taction: Object,\n\t},\n\tmethods: {\n\t\texecuteAction(): void\n\t\t{\n\t\t\tif (this.action)\n\t\t\t{\n\t\t\t\tconst action = new Action(this.action);\n\t\t\t\taction.execute(this);\n\t\t\t}\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-entity-stream-advice-list-btn-box\">\n\t\t\t<button\n\t\t\t\t@click=\"executeAction\"\n\t\t\t\tclass=\"crm-entity-stream-advice-list-btn\"\n\t\t\t>\n\t\t\t\t{{text}}\n\t\t\t</button>\n\t\t</div>\n\t`\n}\n","import 'ui.design-tokens';\nimport Link from '../link';\nimport Text from '../text';\nimport ListItemButton from './list-item-button';\n\nexport default {\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttitleAction: Object,\n\t\tisSelected: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\timage: String,\n\t\tshowDummyImage: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tbottomBlock: Object,\n\t\tbutton: Object,\n\t},\n\tcomponents: {\n\t\tText,\n\t\tLink,\n\t\tListItemButton,\n\t},\n\tcomputed: {\n\t\timageStyle()\n\t\t{\n\t\t\tif (!this.image)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundImage: 'url(' + this.image + ')'\n\t\t\t};\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<li\n\t\t\t:class=\"{'crm-entity-stream-advice-list-item--active': isSelected}\"\n\t\t\tclass=\"crm-entity-stream-advice-list-item\"\n\t\t>\n\t\t\t<div class=\"crm-entity-stream-advice-list-content\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"image || showDummyImage\"\n\t\t\t\t\t:style=\"imageStyle\"\n\t\t\t\t\tclass=\"crm-entity-stream-advice-list-icon\"\n\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-entity-stream-advice-list-inner\">\n\t\t\t\t\t<Link v-if=\"titleAction\" :action=\"titleAction\" :text=\"title\"></Link>\n\t\t\t\t\t<Text v-else :value=\"title\"></Text>\n\t\t\t\t\t<div v-if=\"bottomBlock\" class=\"crm-entity-stream-advice-list-desc-box\">\n\t\t\t\t\t\t<LineOfTextBlocks v-bind=\"bottomBlock.properties\"></LineOfTextBlocks>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<ListItemButton v-if=\"button\" v-bind=\"button.properties\"></ListItemButton>\n\t\t</li>\n\t`\n}\n","import ListItem from './list-item';\n\nexport default {\n\tprops: {\n\t\tlistItems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t\tdefault: [],\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tshowMoreEnabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tshowMoreCnt: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t},\n\t\tshowMoreText: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t},\n\n\tdata()\n\t{\n\t\treturn {\n\t\t\tisShortList: this.showMoreEnabled,\n\t\t\tshortListItemsCnt: this.showMoreCnt,\n\t\t};\n\t},\n\tcomponents: {\n\t\tListItem,\n\t},\n\tmethods: {\n\t\tshowMore()\n\t\t{\n\t\t\tthis.isShortList = false;\n\t\t},\n\t\tisItemVisible(index)\n\t\t{\n\t\t\treturn !this.isShortList || index < this.showMoreCnt;\n\t\t},\n\t},\n\tcomputed: {\n\t\tisShowMoreVisible()\n\t\t{\n\t\t\treturn this.isShortList && this.listItems.length > this.shortListItemsCnt;\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div v-if=\"title\" class=\"crm-entity-stream-advice-title\">\n\t\t\t\t{{title}}\n\t\t\t</div>\n\t\t\t<transition-group class=\"crm-entity-stream-advice-list\" name=\"list\" tag=\"ul\">\n\t\t\t\t<ListItem\n\t\t\t\t\tv-for=\"(item, index) in listItems\"\n\t\t\t\t\tv-show=\"isItemVisible(index)\"\n\t\t\t\t\t:key=\"item.id\"\n\t\t\t\t\tv-bind=\"item.properties\"\n\t\t\t\t></ListItem>\n\t\t\t</transition-group>\n\t\t\t<a\n\t\t\t\tv-if=\"isShowMoreVisible\"\n\t\t\t\t@click.prevent=\"showMore\"\n\t\t\t\tclass=\"crm-entity-stream-advice-link\"\n\t\t\t\thref=\"#\"\n\t\t\t>\n\t\t\t\t{{showMoreText}}\n\t\t\t</a>\n\t\t</div>\n\t`\n}\n","import ConfigurableItem from '../configurable-item';\nimport type {ActionParams} from './base';\nimport {EventEmitter} from 'main.core.events';\nimport {UI} from 'ui.notification';\nimport {Loc} from 'main.core';\nimport {ActionAnimationCallbacks, Base} from './base';\nimport ExpandableList from '../components/content-blocks/expandable-list/list';\n\nexport class DealProductList extends Base\n{\n\t#item: ConfigurableItem = null;\n\t#productsGrid: Object = null;\n\n\tgetContentBlockComponents(Item: ConfigurableItem): Object\n\t{\n\t\treturn {\n\t\t\tExpandableList,\n\t\t};\n\t}\n\n\tonInitialize(item: ConfigurableItem): void\n\t{\n\t\tthis.#item = item;\n\n\t\tEventEmitter.subscribe('onCrmEntityUpdate', () => {\n\t\t\tthis.#item.reloadFromServer();\n\t\t});\n\n\t\t/**\n\t\t * For cases when timeline block controller initialization runs after product grid initialization\n\t\t */\n\t\tBX.Crm.EntityEditor.getDefault().tapController('PRODUCT_LIST', (controller) => {\n\t\t\tthis.#productsGrid = controller.getProductList();\n\t\t});\n\n\t\t/**\n\t\t * For cases when timeline block controller initialization runs before product grid initialization\n\t\t */\n\t\tEventEmitter.subscribe('EntityProductListController', (event) => {\n\t\t\tthis.#productsGrid = event.getData()[0];\n\t\t});\n\t}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst {action, actionType, actionData, animationCallbacks} = actionParams;\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'ProductList:AddToDeal')\n\t\t{\n\t\t\tthis.#addProductToDeal(actionData, animationCallbacks);\n\t\t}\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (\n\t\t\titem.getType() === 'ProductCompilation:SentToClient'\n\t\t\t|| item.getType() === 'Order:EncourageBuyProducts'\n\t\t);\n\t}\n\n\t#addProductToDeal(actionData: ?Object, animationCallbacks: ?ActionAnimationCallbacks): void\n\t{\n\t\tif (!(actionData && actionData.productId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (animationCallbacks.onStart)\n\t\t{\n\t\t\tanimationCallbacks.onStart();\n\t\t}\n\n\t\tBX.onCustomEvent('onAddViewedProductToDeal', [actionData.productId]);\n\n\t\tsetTimeout(() => {\n\t\t\tBX.onCustomEvent('OpenEntityDetailTab', ['tab_products']);\n\t\t}, 500);\n\n\t\tUI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage('CRM_TIMELINE_ENCOURAGE_BUY_PRODUCTS_PRODUCTS_ADDED_TO_DEAL'),\n\t\t\tautoHideDelay: 5000,\n\t\t});\n\n\t\tif (animationCallbacks.onStop)\n\t\t{\n\t\t\tanimationCallbacks.onStop();\n\t\t}\n\t}\n}","import {Base} from './base';\nimport ConfigurableItem from '../configurable-item';\nimport {PULL} from 'pull.client';\nimport {ajax, Type} from 'main.core';\n\nexport class Delivery extends Base\n{\n\t#needCheckRequestStatus: boolean = null;\n\t#checkRequestStatusTimeout: number = null;\n\t#isPullSubscribed: boolean = false;\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn item.getType() === 'Activity:Delivery';\n\t}\n\n\tonInitialize(item: ConfigurableItem): void\n\t{\n\t\tthis.#updateCheckRequestStatus(item);\n\t\tthis.#subscribePullEvents(item);\n\t}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst {action, actionType, actionData, animationCallbacks} = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Delivery:MakeCall' && actionData)\n\t\t{\n\t\t\tthis.#makeCall(actionData);\n\t\t}\n\t}\n\n\tonAfterItemRefreshLayout(item: ConfigurableItem): void\n\t{\n\t\tthis.#updateCheckRequestStatus(item);\n\t}\n\n\t#makeCall(actionData): void\n\t{\n\t\tif (\n\t\t\t!Type.isStringFilled(actionData.phoneNumber)\n\t\t\t|| !Type.isBoolean(actionData.canUserPerformCalls)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\t!Type.isUndefined(window.top['BXIM'])\n\t\t\t&& actionData.canUserPerformCalls !== false\n\t\t)\n\t\t{\n\t\t\twindow.top['BXIM'].phoneTo(actionData.phoneNumber);\n\t\t}\n\t\telse\n\t\t{\n\t\t\twindow.open('tel:' + actionData.phoneNumber, '_self');\n\t\t}\n\t}\n\n\t#subscribePullEvents(item: ConfigurableItem): void\n\t{\n\t\tif (this.#isPullSubscribed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#subscribeShipmentEvents(item);\n\t\tthis.#subscribeDeliveryServiceEvents(item);\n\t\tthis.#subscribeDeliveryRequestEvents(item);\n\n\t\tthis.#isPullSubscribed = true;\n\t}\n\n\t#subscribeShipmentEvents(item: ConfigurableItem): void\n\t{\n\t\tconst shipmentIds = this.#getShipmentIds(item);\n\n\t\tPULL.subscribe({\n\t\t\tmoduleId: 'crm',\n\t\t\tcommand: 'onOrderShipmentSave',\n\t\t\tcallback: (params) => {\n\t\t\t\tif (shipmentIds.some(id => id == params.FIELDS.ID))\n\t\t\t\t{\n\t\t\t\t\titem.reloadFromServer();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tPULL.extendWatch('CRM_ENTITY_ORDER_SHIPMENT');\n\t}\n\n\t#subscribeDeliveryServiceEvents(item: ConfigurableItem): void\n\t{\n\t\tconst deliveryServiceIds = this.#getDeliveryServiceIds(item);\n\n\t\tPULL.subscribe({\n\t\t\tmoduleId: 'sale',\n\t\t\tcommand: 'onDeliveryServiceSave',\n\t\t\tcallback: (params) => {\n\t\t\t\tif (deliveryServiceIds.some(id => id == params.ID))\n\t\t\t\t{\n\t\t\t\t\titem.reloadFromServer();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tPULL.extendWatch('SALE_DELIVERY_SERVICE');\n\t}\n\n\t#subscribeDeliveryRequestEvents(item: ConfigurableItem): void\n\t{\n\t\tconst deliveryRequest = this.#getDeliveryRequest(item);\n\n\t\tPULL.subscribe({\n\t\t\tmoduleId: 'sale',\n\t\t\tcommand: 'onDeliveryRequestUpdate',\n\t\t\tcallback: (params) => {\n\t\t\t\tif (deliveryRequest && deliveryRequest.id == params.ID)\n\t\t\t\t{\n\t\t\t\t\titem.reloadFromServer();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tPULL.subscribe({\n\t\t\tmoduleId: 'sale',\n\t\t\tcommand: 'onDeliveryRequestDelete',\n\t\t\tcallback: (params) => {\n\t\t\t\tif (deliveryRequest && deliveryRequest.id == params.ID)\n\t\t\t\t{\n\t\t\t\t\titem.reloadFromServer();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tPULL.extendWatch('SALE_DELIVERY_REQUEST');\n\t}\n\n\t#checkRequestStatus(): void\n\t{\n\t\tajax.runAction('crm.timeline.deliveryactivity.checkrequeststatus');\n\t}\n\n\t#updateCheckRequestStatus(item: ConfigurableItem): void\n\t{\n\t\tconst deliveryRequest = this.#getDeliveryRequest(item);\n\t\tconst needCheckRequestStatus = (\n\t\t\tdeliveryRequest\n\t\t\t&& deliveryRequest.isProcessed === false\n\t\t);\n\t\tif (needCheckRequestStatus && !this.#needCheckRequestStatus)\n\t\t{\n\t\t\tclearTimeout(this.#checkRequestStatusTimeout);\n\t\t\tthis.#checkRequestStatusTimeout = setInterval(\n\t\t\t\t() => this.#checkRequestStatus(),\n\t\t\t\t30 * 1000\n\t\t\t);\n\t\t}\n\t\telse if (!needCheckRequestStatus && this.#needCheckRequestStatus)\n\t\t{\n\t\t\tclearTimeout(this.#checkRequestStatusTimeout);\n\t\t}\n\n\t\tthis.#needCheckRequestStatus = needCheckRequestStatus;\n\t}\n\n\t#getDeliveryRequest(item: ConfigurableItem): ?Object\n\t{\n\t\tconst dataPayload = item.getDataPayload();\n\n\t\tif (!Type.isObject(dataPayload.deliveryRequest))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn dataPayload.deliveryRequest;\n\t}\n\n\t#getDeliveryServiceIds(item: ConfigurableItem): Array\n\t{\n\t\tconst dataPayload = item.getDataPayload();\n\n\t\tif (!Type.isArray(dataPayload.deliveryServiceIds))\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn dataPayload.deliveryServiceIds;\n\t}\n\n\t#getShipmentIds(item: ConfigurableItem): Array\n\t{\n\t\tconst dataPayload = item.getDataPayload();\n\n\t\tif (!Type.isArray(dataPayload.shipmentIds))\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\treturn dataPayload.shipmentIds;\n\t}\n}\n","import {ajax as Ajax, Loc, Tag, Text, Type, Uri} from 'main.core';\nimport { DateTimeFormat } from \"main.date\";\nimport { type ActionAnimationCallbacks, type ActionParams, Base } from './base';\nimport ConfigurableItem from '../configurable-item';\nimport { ActionType } from \"../action\";\nimport { Router } from \"crm.router\";\nimport {MessageBox, MessageBoxButtons} from \"ui.dialogs.messagebox\";\nimport { DatetimeConverter } from \"crm.timeline.tools\";\nimport { UI } from 'ui.notification';\n\nimport 'ui.info-helper';\n\nconst ACTION_NAMESPACE = 'Document:';\n\nexport class Document extends Base\n{\n\tstatic #toPrintAfterRefresh: ConfigurableItem[] = [];\n\t#popupConfirm: BX.PopupWindow;\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (\n\t\t\titem.getType() === 'Document'\n\t\t\t|| item.getType() === 'DocumentViewed'\n\t\t\t|| item.getType() === 'Activity:Document'\n\t\t);\n\t}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst {action, actionType, actionData, response, animationCallbacks} = actionParams;\n\n\t\tif (ActionType.isJsEvent(actionType))\n\t\t{\n\t\t\tthis.#onJsEvent(action, actionData, animationCallbacks, item);\n\t\t}\n\t\telse if (ActionType.isAjaxAction(actionType))\n\t\t{\n\t\t\tthis.#onAjaxAction(action, actionType, actionData, response);\n\t\t}\n\t}\n\n\t#onJsEvent(\n\t\taction: string,\n\t\tactionData: Object,\n\t\tanimationCallbacks: ?ActionAnimationCallbacks,\n\t\titem: ConfigurableItem,\n\t): void\n\t{\n\t\tconst documentId = Text.toInteger(actionData?.documentId);\n\t\t// if (documentId <= 0)\n\t\t// {\n\t\t// \treturn;\n\t\t// }\n\t\tif (action === (ACTION_NAMESPACE + 'Open'))\n\t\t{\n\t\t\tthis.#openDocument(documentId);\n\t\t}\n\t\telse if (action === (ACTION_NAMESPACE + 'CopyPublicLink'))\n\t\t{\n\t\t\t// todo block button while loading\n\t\t\tthis.#copyPublicLink(documentId, actionData?.publicUrl);\n\t\t}\n\t\telse if (action === (ACTION_NAMESPACE + 'Print'))\n\t\t{\n\t\t\tthis.#printDocument(actionData?.printUrl, animationCallbacks, item);\n\t\t}\n\t\telse if (action === (ACTION_NAMESPACE + 'DownloadPdf'))\n\t\t{\n\t\t\tthis.#downloadPdf(actionData?.pdfUrl);\n\t\t}\n\t\telse if (action === (ACTION_NAMESPACE + 'DownloadDocx'))\n\t\t{\n\t\t\tthis.#downloadDocx(actionData?.docxUrl);\n\t\t}\n\t\telse if (action === (ACTION_NAMESPACE + 'UpdateTitle'))\n\t\t{\n\t\t\tthis.#updateTitle(documentId, actionData?.value);\n\t\t}\n\t\telse if (action === (ACTION_NAMESPACE + 'UpdateCreateDate'))\n\t\t{\n\t\t\tthis.#updateCreateDate(documentId, actionData?.value);\n\t\t}\n\t\telse if (action === (ACTION_NAMESPACE + 'ConvertDeal'))\n\t\t{\n\t\t\tthis.#convertDeal(documentId, animationCallbacks);\n\t\t}\n\t\telse if (action === (ACTION_NAMESPACE + 'ShowInfoHelperSlider'))\n\t\t{\n\t\t\tthis.#showInfoHelperSlider(actionData?.infoHelperCode);\n\t\t}\n\t\telse if (action === (ACTION_NAMESPACE + 'Delete'))\n\t\t{\n\t\t\tconst confirmationText = actionData.confirmationText ?? '';\n\t\t\tif (confirmationText)\n\t\t\t{\n\t\t\t\tMessageBox.show({\n\t\t\t\t\tmessage: confirmationText,\n\t\t\t\t\tmodal: true,\n\t\t\t\t\tbuttons: MessageBoxButtons.YES_NO,\n\t\t\t\t\tonYes: () => {\n\t\t\t\t\t\treturn this.#deleteDocument(actionData.id, actionData.ownerTypeId, actionData.ownerId, animationCallbacks);\n\t\t\t\t\t},\n\t\t\t\t\tonNo: (messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#deleteDocument(actionData.id, actionData.ownerTypeId, actionData.ownerId, animationCallbacks);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.info(`Unknown action ${action} in ${item.getType()}`);\n\t\t}\n\t}\n\n\t#openDocument(documentId: number): void\n\t{\n\t\tRouter.Instance.openDocumentSlider(documentId);\n\t}\n\n\tasync #copyPublicLink(documentId: number, publicUrl: ?string): Promise<void>\n\t{\n\t\tif (!Type.isStringFilled(publicUrl))\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tpublicUrl = await this.#createPublicUrl(documentId);\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tMessageBox.alert(error.message);\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst isSuccess = BX.clipboard.copy(publicUrl);\n\t\tif (isSuccess)\n\t\t{\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: Loc.getMessage('CRM_TIMELINE_ITEM_LINK_IS_COPIED'),\n\t\t\t\tautoHideDelay: 5000,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tMessageBox.alert(Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_DOCUMENT_COPY_PUBLIC_LINK_ERROR'));\n\t\t}\n\t}\n\n\tasync #createPublicUrl(documentId: number): Promise<string, Error>\n\t{\n\t\tlet response: {data: {publicUrl: string}};\n\t\ttry\n\t\t{\n\t\t\tresponse = await Ajax.runAction(\n\t\t\t\t'crm.documentgenerator.document.enablePublicUrl',\n\t\t\t\t{\n\t\t\t\t\tanalyticsLabel: 'enablePublicUrl',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tstatus: 1,\n\t\t\t\t\t\tid: documentId,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tcatch (responseWithError)\n\t\t{\n\t\t\tconsole.error(responseWithError);\n\n\t\t\tthrow new Error(Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_DOCUMENT_CREATE_PUBLIC_LINK_ERROR'));\n\t\t}\n\n\t\tconst publicUrl = response.data.publicUrl;\n\t\tif (!Type.isStringFilled(publicUrl))\n\t\t{\n\t\t\tthrow new Error(Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_DOCUMENT_CREATE_PUBLIC_LINK_ERROR'));\n\t\t}\n\n\t\treturn publicUrl;\n\t}\n\n\t#printDocument(printUrl: ?string, animationCallbacks: ?ActionAnimationCallbacks, item: ConfigurableItem): void\n\t{\n\t\tif (Type.isStringFilled(printUrl))\n\t\t{\n\t\t\twindow.open(printUrl, '_blank');\n\t\t\treturn;\n\t\t}\n\n\t\t// there is no pdf yet. wait till document is transformed and update push comes in\n\t\tDocument.#toPrintAfterRefresh.push(item);\n\t\tconst onStart = animationCallbacks?.onStart;\n\t\tif (Type.isFunction(onStart))\n\t\t{\n\t\t\tonStart();\n\t\t}\n\t}\n\n\t#downloadPdf(pdfUrl: ?string): void\n\t{\n\t\tif (Type.isStringFilled(pdfUrl))\n\t\t{\n\t\t\twindow.open(pdfUrl, '_blank');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tMessageBox.alert(Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_DOCUMENT_PDF_NOT_READY'));\n\t\t}\n\t}\n\n\t#downloadDocx(docxUrl: ?string): void\n\t{\n\t\tif (Type.isStringFilled(docxUrl))\n\t\t{\n\t\t\twindow.open(docxUrl, '_blank');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error('Docx download url is not found. This should be an impossible case, something went wrong');\n\t\t}\n\t}\n\n\tasync #updateTitle(documentId: number, value: ?string): Promise<void>\n\t{\n\t\tlet response: {data: {document?: {values?: {DocumentTitle?: string}}}};\n\t\ttry\n\t\t{\n\t\t\tresponse = await Ajax.runAction('crm.documentgenerator.document.update', {\n\t\t\t\tdata: {\n\t\t\t\t\tid: documentId,\n\t\t\t\t\tvalues: {\n\t\t\t\t\t\tDocumentTitle: value,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\tcatch (responseWithError)\n\t\t{\n\t\t\tconsole.error(responseWithError);\n\n\t\t\tMessageBox.alert(Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_DOCUMENT_UPDATE_DOCUMENT_ERROR'));\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst newTitle = response.data.document?.values?.DocumentTitle;\n\t\tif (newTitle !== value)\n\t\t{\n\t\t\tconsole.error(\"Updated document title without errors, but for some reason title from the backend doesn't match sent value\");\n\t\t}\n\t}\n\n\tasync #updateCreateDate(documentId: number, value: ?Date): Promise<void>\n\t{\n\t\tconst valueInSiteFormat = DateTimeFormat.format(DatetimeConverter.getSiteDateFormat(), value);\n\n\t\tlet response: {data: {document?: {values?: {DocumentCreateTime?: string}}}};\n\t\ttry\n\t\t{\n\t\t\tresponse = await Ajax.runAction('crm.documentgenerator.document.update', {\n\t\t\t\tdata: {\n\t\t\t\t\tid: documentId,\n\t\t\t\t\tvalues: {\n\t\t\t\t\t\tDocumentCreateTime: valueInSiteFormat,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\tcatch (responseWithError)\n\t\t{\n\t\t\tconsole.error(responseWithError);\n\n\t\t\tMessageBox.alert(Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_DOCUMENT_UPDATE_DOCUMENT_ERROR'));\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst newCreateDate = response.data.document?.values?.DocumentCreateTime;\n\t\tif (valueInSiteFormat !== newCreateDate)\n\t\t{\n\t\t\tconsole.error(\"Updated document create date without errors, but for some reason date from the backend doesn't match sent value\");\n\t\t}\n\t}\n\n\t#deleteDocument(id: number, ownerTypeId: number, ownerId: number, animationCallbacks: Object): boolean\n\t{\n\t\tif (animationCallbacks.onStart)\n\t\t{\n\t\t\tanimationCallbacks.onStart();\n\t\t}\n\t\treturn Ajax.runAction(\n\t\t\t'crm.timeline.document.delete',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tid,\n\t\t\t\t\townerTypeId,\n\t\t\t\t\townerId,\n\t\t\t\t}\n\t\t\t}\n\t\t).then(() => {\n\t\t\tif (animationCallbacks.onStop)\n\t\t\t{\n\t\t\t\tanimationCallbacks.onStop();\n\t\t\t}\n\t\t\treturn true;\n\t\t}, (response) =>\n\t\t{\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\tautoHideDelay: 5000,\n\t\t\t});\n\t\t\tif (animationCallbacks.onStop)\n\t\t\t{\n\t\t\t\tanimationCallbacks.onStop();\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\t#onAjaxAction(action: string, actionType: string, actionData: Object, response: Object): void\n\t{\n\t\tif (action === 'crm.api.integration.sign.convertDeal')\n\t\t{\n\t\t\tif (actionType === ActionType.AJAX_ACTION.FINISHED && !Type.isNil(response?.data?.SMART_DOCUMENT))\n\t\t\t{\n\t\t\t\t//todo extract it to router?\n\t\t\t\tconst wizardUri = new Uri('/sign/doc/0/');\n\t\t\t\twizardUri.setQueryParams({\n\t\t\t\t\tdocId: response.data.SMART_DOCUMENT,\n\t\t\t\t\tstepId: 'changePartner',\n\t\t\t\t\tnoRedirect: 'Y'\n\t\t\t\t});\n\t\t\t\tBX.SidePanel.Instance.open(wizardUri.toString());\n\t\t\t}\n\t\t}\n\t}\n\n\tonAfterItemRefreshLayout(item: ConfigurableItem)\n\t{\n\t\tconst itemsToPrint = Document.#toPrintAfterRefresh.filter(candidate => candidate.getId() === item.getId());\n\t\tif (itemsToPrint.length <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst action = item.getLayout().asPlainObject().footer?.additionalButtons?.extra?.action;\n\t\tconst isPrintEvent = (\n\t\t\tType.isPlainObject(action)\n\t\t\t&& ActionType.isJsEvent(action.type)\n\t\t\t&& action.value === (ACTION_NAMESPACE + 'Print')\n\t\t);\n\t\tif (!isPrintEvent)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst printUrl = action.actionParams?.printUrl;\n\t\tif (!Type.isStringFilled(printUrl))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#printDocument(printUrl, null, item);\n\n\t\tDocument.#toPrintAfterRefresh =\n\t\t\tDocument.#toPrintAfterRefresh.filter(remainingItem => !itemsToPrint.includes(remainingItem))\n\t\t;\n\t}\n\n\t#convertDeal(id: number, animationCallbacks: ?ActionAnimationCallbacks)\n\t{\n\t\tif (animationCallbacks.onStart)\n\t\t{\n\t\t\tanimationCallbacks.onStart();\n\t\t}\n\n\t\tconst convertDealAndStartSign = (\n\t\t\t(usePrevious) =>\n\t\t\t{\n\t\t\t\tAjax.runAction('crm.api.integration.sign.convertDeal', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tdocumentId: id,\n\t\t\t\t\t\tusePrevious: !usePrevious ? 0 : 1,\n\t\t\t\t\t}\n\t\t\t\t}).then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tif (response?.data?.SMART_DOCUMENT)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst wizardUri = new Uri('/sign/doc/0/');\n\t\t\t\t\t\t\twizardUri.setQueryParams({\n\t\t\t\t\t\t\t\tdocId: response.data.SMART_DOCUMENT,\n\t\t\t\t\t\t\t\tstepId: 'changePartner',\n\t\t\t\t\t\t\t\tnoRedirect: 'Y'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tBX.SidePanel.Instance.open(wizardUri.toString());\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (animationCallbacks.onStop)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tanimationCallbacks.onStop();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tif (response.errors[0].message)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\t\t\t\t\tautoHideDelay: 5000\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (animationCallbacks.onStop)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tanimationCallbacks.onStop();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t).catch((response) =>\n\t\t\t\t{\n\t\t\t\t\tif (response.errors[0].message)\n\t\t\t\t\t{\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (animationCallbacks.onStop)\n\t\t\t\t\t{\n\t\t\t\t\t\tanimationCallbacks.onStop();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\n\t\tAjax.runAction('crm.api.integration.sign.getLinkedBlank', {\n\t\t\tdata: {\n\t\t\t\tdocumentId: id\n\t\t\t}\n\t\t}).then(\n\t\t\t(response) =>\n\t\t\t{\n\t\t\t\tif (response?.data?.ID > 0) {\n\t\t\t\t\tthis.#showMessage(\n\t\t\t\t\t\tLoc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_DO_USE_PREVIOUS_MSGVER_3',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'%TITLE%': '<b>' + BX.util.htmlspecialchars(response.data.TITLE || '') + '</b>',\n\t\t\t\t\t\t\t\t'%INITIATOR%': '<b>' + BX.util.htmlspecialchars(response.data.INITIATOR || '') + '</b>',\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\t\t\ttext: BX.message('CRM_TIMELINE_ITEM_ACTIVITY_OLD_BUTTON_MSGVER_2'),\n\t\t\t\t\t\t\t\tclassName: \"ui-btn ui-btn-md ui-btn-primary\",\n\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\tclick: () =>\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tconvertDealAndStartSign(true);\n\t\t\t\t\t\t\t\t\t\tthis.#popupConfirm.destroy();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\t\t\t\ttext: Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_NEW_BUTTON_MSGVER_3'),\n\t\t\t\t\t\t\t\tclassName: \"ui-btn ui-btn-md ui-btn-info\",\n\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\tclick: () =>\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tconvertDealAndStartSign(false);\n\t\t\t\t\t\t\t\t\t\tthis.#popupConfirm.destroy();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t],\n\t\t\t\t\t\tLoc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_POPUP_TITLE_MSGVER_2')\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tconvertDealAndStartSign(false);\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\t#showInfoHelperSlider(code: string)\n\t{\n\t\tBX.UI.InfoHelper.show(code);\n\t}\n\n\t#showMessage(content: string, buttons: [], title: string)\n\t{\n\t\tthis.#popupConfirm = new BX.PopupWindow(\n\t\t\t'bx-popup-document-activity-popup',\n\t\t\tnull,\n\t\t\t{\n\t\t\t\t\t\tzIndex: 200,\n\t\t\t\t\t\tautoHide: true,\n\t\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\t\tbuttons: buttons,\n\t\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\t\toverlay : true,\n\t\t\t\t\t\tevents : {\n\t\t\t\t\t\t\tonPopupClose : () =>\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.#popupConfirm.destroy();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcontent: Tag.render`<div class=\"bx-popup-document-activity-popup-content-text\">${content}</div>`,\n\t\t\t\t\t\ttitleBar: title,\n\t\t\t\t\t\tclassName : 'bx-popup-document-activity-popup',\n\t\t\t\t\t\tmaxWidth: 510\n\t\t\t\t\t}\n\t\t);\n\t\tthis.#popupConfirm.show();\n\t};\n}\n","export default {\r\n\tprops: {\r\n\t\tcontactBlocks: Array,\r\n\t},\r\n\ttemplate: `\r\n\t  \t<div class=\"crm-timeline-block-mail-contacts-wrapper\">\r\n\t\t\t<div class=\"crm-timeline-block-mail-contact\" v-for=\"(block, index) in contactBlocks\">\r\n\t\t\t  <component :is=\"block.rendererName\" v-bind=\"block.properties\"></component>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t`\r\n}","import { Base } from './base';\nimport type { ActionParams } from './base';\nimport { Type } from 'main.core';\nimport ConfigurableItem from '../configurable-item';\nimport ContactList from '../components/content-blocks/mail/contact-list';\n\nexport class Email extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Email::OpenMessage' && actionData)\n\t\t{\n\t\t\tthis.#openMessage(actionData);\n\t\t}\n\n\t\tif (action === 'Email::Schedule' && actionData)\n\t\t{\n\t\t\tthis.runScheduleAction(actionData.activityId, actionData.scheduleDate);\n\t\t}\n\t}\n\n\t#viewActivity(id): void\n\t{\n\t\tconst editor = this.#getActivityEditor();\n\t\tif (editor && id)\n\t\t{\n\t\t\tconst emailActivity = BX.CrmActivityEmail.create(\n\t\t\t\t{\n\t\t\t\t\tID: id,\n\t\t\t\t},\n\t\t\t\teditor,\n\t\t\t\t{},\n\t\t\t);\n\n\t\t\temailActivity.openDialog(BX.CrmDialogMode.view);\n\t\t}\n\t}\n\n\t#getActivityEditor(): BX.CrmActivityEditor\n\t{\n\t\treturn BX.CrmActivityEditor.getDefault();\n\t}\n\n\t#openMessage(actionData): void\n\t{\n\t\tif (!Type.isNumber(actionData.threadId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.#viewActivity(actionData.threadId);\n\t}\n\n\tgetContentBlockComponents(Item: ConfigurableItem): Object\n\t{\n\t\treturn {\n\t\t\tContactList,\n\t\t};\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\tconst supportedItemTypes = [\n\t\t\t'ContactList',\n\t\t\t'Activity:Email',\n\t\t\t'EmailActivitySuccessfullyDelivered',\n\t\t\t'EmailActivityNonDelivered',\n\t\t\t'EmailLogIncomingMessage',\n\t\t];\n\n\t\treturn supportedItemTypes.includes(item.getType());\n\t}\n}\n","import {TimelineSummaryDocuments} from 'crm.entity-editor.field.payment-documents';\n\nexport const EcommerceDocumentsList = {\n\tprops: {\n\t\townerId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\townerTypeId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tisWithOrdersMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tsummaryOptions: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t}\n\t},\n\tmounted()\n\t{\n\t\tconst timelineSummaryDocuments = new TimelineSummaryDocuments({\n\t\t\t'OWNER_ID': this.ownerId,\n\t\t\t'OWNER_TYPE_ID': this.ownerTypeId,\n\t\t\t'PARENT_CONTEXT': this,\n\t\t\t'CONTEXT': BX.CrmEntityType.resolveName(this.ownerTypeId).toLowerCase(),\n\t\t\t'IS_WITH_ORDERS_MODE': this.isWithOrdersMode,\n\t\t});\n\t\ttimelineSummaryDocuments.setOptions(this.summaryOptions);\n\n\t\tthis.$el.appendChild(\n\t\t\ttimelineSummaryDocuments.render()\n\t\t);\n\t},\n\tmethods:\n\t{\n\t\tstartSalescenterApplication(orderId, options)\n\t\t{\n\t\t\tif (options === undefined)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.loadExt('salescenter.manager').then(() => {\n\t\t\t\tBX.Salescenter.Manager.openApplication(options);\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `<div></div>`\n}\n","import {Base} from './base';\nimport ConfigurableItem from '../configurable-item';\nimport {EventEmitter} from 'main.core.events';\nimport {EcommerceDocumentsList} from '../components/content-blocks/ecommerce-documents-list';\n\nexport class FinalSummary extends Base\n{\n\tonAfterItemLayout(item: ConfigurableItem, options): void\n\t{\n\t\tif (item.needBindToContainer())\n\t\t{\n\t\t\tEventEmitter.emit(\n\t\t\t\t'BX.Crm.Timeline.Items.FinalSummaryDocuments:onHistoryNodeAdded',\n\t\t\t\t[item.getWrapper()]\n\t\t\t);\n\t\t}\n\t}\n\n\tgetContentBlockComponents(Item: ConfigurableItem): Object\n\t{\n\t\treturn {\n\t\t\tEcommerceDocumentsList,\n\t\t};\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn item.getType() === 'FinalSummary';\n\t}\n}\n","import {Base} from './base';\nimport ConfigurableItem from '../configurable-item';\n\nexport class Helpdesk extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: Object): void\n\t{\n\t\tconst { action, actionData } = actionParams;\n\n\t\tif (action === 'Helpdesk:Open' && actionData && actionData.articleCode)\n\t\t{\n\t\t\tthis.#openHelpdesk(actionData.articleCode);\n\t\t}\n\t}\n\n\t#openHelpdesk(articleCode): void\n\t{\n\t\tif (top.BX && top.BX.Helper)\n\t\t{\n\t\t\ttop.BX.Helper.show(`redirect=detail&code=${articleCode}`);\n\t\t}\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn true;\n\t}\n}","export default {\n\tprops: {\n\t\tfrom: Object,\n\t\tto: Object,\n\t},\n\t// language=Vue\n\ttemplate: `<div class=\"crm-entity-stream-content-detail-info\">\n\t<component :is=\"from.rendererName\" v-if=\"from\" v-bind=\"from.properties\"></component>\n\t<span class=\"crm-entity-stream-content-detail-info-separator-icon\" v-if=\"from\"></span>\n\t<component :is=\"to.rendererName\" v-if=\"to\" v-bind=\"to.properties\"></component>\n\t</div>`\n};\n","export default {\n\tprops: {\n\t\ticonCode: String,\n\t\ttext: String,\n\t\tpillText: String,\n\t},\n\tcomputed: {\n\t\ticonClassName(): Object\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-timeline__value-change-item_icon', {\n\t\t\t\t[`--${this.iconCode}`]: true,\n\t\t\t\t}\n\t\t\t];\n\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-timeline__value-change-item\">\n\t\t\t<span v-if=\"iconCode\" :class=\"iconClassName\"></span>\n\t\t\t<span class=\"crm-timeline__value-change-item_text\" v-if=\"text\">{{ text }}</span>\n\t\t\t<span class=\"crm-entity-stream-content-detain-info-status\" v-if=\"pillText\">{{ pillText }}</span>\n\t\t</div>\n\t`\n};","import {Base} from './base';\nimport ConfigurableItem from '../configurable-item';\nimport ValueChange from '../components/content-blocks/value-change';\nimport ValueChangeItem from '../components/content-blocks/value-change-item';\n\nexport class Modification extends Base\n{\n\tgetContentBlockComponents(Item: ConfigurableItem): Object\n\t{\n\t\treturn {\n\t\t\tValueChange,\n\t\t\tValueChangeItem,\n\t\t};\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (item.getType() === 'Modification')\n\t\t\t|| (item.getType() === 'TasksTaskModification')\n\t\t\t|| (item.getType() === 'RestartAutomation')\n\t\t\t;\n\t}\n}\n","import { Event, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport ConfigurableItem from '../configurable-item';\nimport { Base } from './base';\n\nexport class Notification extends Base\n{\n\tonInitialize(item: ConfigurableItem): void\n\t{\n\t\tif (item)\n\t\t{\n\t\t\tthis.#showTour(item);\n\t\t}\n\t}\n\n\t#showTour(item: ConfigurableItem): void\n\t{\n\t\tsetTimeout(() => {\n\t\t\tconst layout = item.getLayout()?.asPlainObject();\n\n\t\t\tconst isSms = Type.isStringFilled(layout?.header?.title) && layout.header.title.includes('SMS');\n\n\t\t\tif (!isSms)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.#isInViewport(item.getLayoutComponent().$el))\n\t\t\t{\n\t\t\t\tEventEmitter.emit(\n\t\t\t\t\tthis,\n\t\t\t\t\t'BX.Crm.Timeline.Notification:onShowForcedSmsTour',\n\t\t\t\t\t{\n\t\t\t\t\t\ttarget: item.getLayoutComponent().$el,\n\t\t\t\t\t\tstepId: 'notifications-forced-sms',\n\t\t\t\t\t\tdelay: 1500,\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst showTourOnScroll = () => {\n\t\t\t\tif (this.#isInViewport(item.getLayoutComponent().$el))\n\t\t\t\t{\n\t\t\t\t\tEventEmitter.emit(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t'BX.Crm.Timeline.Notification:onShowForcedSmsTour',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttarget: item.getLayoutComponent().$el,\n\t\t\t\t\t\t\tstepId: 'notifications-forced-sms',\n\t\t\t\t\t\t\tdelay: 1000,\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\n\t\t\t\t\tEvent.unbind(window, 'scroll', showTourOnScroll);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tEvent.bind(window, 'scroll', showTourOnScroll);\n\t\t}, 50);\n\t}\n\n\t#isInViewport(element: HTMLElement): boolean\n\t{\n\t\tif (!Type.isDomNode(element))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst rect = element.getBoundingClientRect();\n\n\t\treturn (\n\t\t\trect.top >= 0\n\t\t\t&& rect.left >= 0\n\t\t\t&& rect.bottom <= (window.innerHeight || document.documentElement.clientHeight)\n\t\t\t&& rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n\t\t);\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn item.getType() === 'Activity:Notification';\n\t}\n}\n","export default {\n\tprops: {\n\t\tmessageHtml: String,\n\t\tisIncoming: Boolean,\n\t},\n\tcomputed: {\n\t\tclassName(): string\n\t\t{\n\t\t\treturn 'crm-entity-stream-content-detail-IM-message-' + (this.isIncoming ? 'incoming' : 'outgoing');\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `<div class=\"crm-entity-stream-content-detail-IM\"><div :class=\"[className]\" v-html=\"messageHtml\"></div></div>`\n};\n","import { ActivityProvider } from 'crm.ai.call';\nimport { DatetimeConverter } from 'crm.timeline.tools';\nimport { ajax as Ajax, Event, Loc, Text } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Menu, MenuManager } from 'main.popup';\nimport { Button as ButtonUI, ButtonState } from 'ui.buttons';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport { UI } from 'ui.notification';\n\nimport ChatMessage from '../components/content-blocks/chat-message';\nimport { Button } from '../components/layout/button';\nimport ConfigurableItem from '../configurable-item';\n\nimport type { CopilotConfig } from './ai/copilot-base';\nimport { CopilotBase } from './ai/copilot-base';\nimport { ActionParams } from './base';\n\nexport class OpenLines extends CopilotBase\n{\n\t#copilotSummaryMenu: Menu = null;\n\n\t// region Base overridden methods\n\tonInitialize(item: ConfigurableItem): void\n\t{\n\t\tif (item)\n\t\t{\n\t\t\tthis.#showCopilotWelcomeTour(item);\n\t\t}\n\t}\n\n\tgetContentBlockComponents(Item: ConfigurableItem): Object\n\t{\n\t\treturn {\n\t\t\tChatMessage,\n\t\t};\n\t}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData, animationCallbacks } = actionParams;\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Openline:OpenChat' && actionData && actionData.dialogId)\n\t\t{\n\t\t\tthis.#openChat(actionData.dialogId);\n\t\t}\n\n\t\tif (action === 'Openline:Complete' && actionData && actionData.activityId)\n\t\t{\n\t\t\tthis.#onComplete(item, actionData, animationCallbacks);\n\t\t}\n\n\t\tif (action === 'Openline:ShowCopilotSummary' && actionData)\n\t\t{\n\t\t\tvoid this.#showCopilotSummary(item, actionData);\n\t\t}\n\n\t\tif (action === 'Openline:LaunchCopilot' && actionData)\n\t\t{\n\t\t\tvoid this.handleCopilotLaunch(item, actionData);\n\t\t}\n\t}\n\t// endregion\n\n\t// region CopilotBase overridden methods\n\tgetCopilotConfig(): CopilotConfig\n\t{\n\t\treturn {\n\t\t\tactionEndpoint: 'crm.timeline.ai.launchCopilot',\n\t\t\tvalidEntityTypes: [BX.CrmEntityType.enumeration.lead, BX.CrmEntityType.enumeration.deal],\n\t\t\tagreementContext: 'audio', // @todo!\n\t\t};\n\t}\n\n\tgetAdditionalRequestData(actionData: Object): Object\n\t{\n\t\treturn {\n\t\t\tscenario: 'fill_fields',\n\t\t};\n\t}\n\t// endregion\n\n\t// region jsEvent action handlers\n\t#openChat(dialogId): void\n\t{\n\t\twindow.top.BXIM?.openMessengerSlider(dialogId, { RECENT: 'N', MENU: 'N' });\n\t}\n\n\t#onComplete(item: ConfigurableItem, actionData: Object, animationCallbacks: ?Object): void\n\t{\n\t\tMessageBox.show({\n\t\t\ttitle: Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_OPENLINE_COMPLETE_CONF_TITLE'),\n\t\t\tmessage: Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_OPENLINE_COMPLETE_CONF'),\n\t\t\tmodal: true,\n\t\t\tokCaption: Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_OPENLINE_COMPLETE_CONF_OK_TEXT'),\n\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\tonOk: () => {\n\t\t\t\treturn this.#runCompleteAction(actionData.activityId, actionData.ownerTypeId, actionData.ownerId, animationCallbacks);\n\t\t\t},\n\t\t\tonCancel: (messageBox) => {\n\t\t\t\tconst changeStreamButton = item.getLayoutHeaderChangeStreamButton();\n\t\t\t\tif (changeStreamButton)\n\t\t\t\t{\n\t\t\t\t\tchangeStreamButton.markCheckboxUnchecked();\n\t\t\t\t}\n\n\t\t\t\tmessageBox.close();\n\t\t\t},\n\t\t});\n\t}\n\n\t#showCopilotSummary(item: ConfigurableItem, actionData: Object, animationCallbacks: ?Object): void\n\t{\n\t\tconst activityId = actionData.activityId;\n\t\tconst items = actionData.summarizeTranscriptionList;\n\t\tif (activityId <= 0 || !items)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Object.keys(items).length === 1)\n\t\t{\n\t\t\tconst jobId = Object.keys(items)[0];\n\n\t\t\tvoid this.#openCopilotSummaryPopup(jobId, actionData);\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#copilotSummaryMenu === null)\n\t\t{\n\t\t\tconst dataId = `[data-id=\"copilotSummaryBlockLink_${item.getId()}\"]`;\n\t\t\tconst menuTarget = item.getContainer().querySelector(dataId);\n\t\t\tconst menuItems = Object.entries(items).reverse().map(([jobId, timestamp]) => {\n\t\t\t\tconst converter = DatetimeConverter.createFromServerTimestamp(timestamp).toUserTime();\n\n\t\t\t\treturn {\n\t\t\t\t\ttext: Loc.getMessage(\n\t\t\t\t\t\t'CRM_TIMELINE_ITEM_ACTIVITY_OPENLINE_SUMMARIZE_TRANSCRIPTION_MENU',\n\t\t\t\t\t\t{ '#DATE#': converter.toDatetimeString({ delimiter: ', ' }) },\n\t\t\t\t\t),\n\t\t\t\t\tonclick: () => void this.#openCopilotSummaryPopup(jobId, actionData),\n\t\t\t\t};\n\t\t\t});\n\n\t\t\tthis.#copilotSummaryMenu = MenuManager.create({\n\t\t\t\tid: `crm-timeline-activity-openline-copilot-summary-${activityId}-${Text.getRandom()}`,\n\t\t\t\tbindElement: menuTarget,\n\t\t\t\tanimation: 'fading-slide',\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetTop: 10,\n\t\t\t\tcloseByEsc: false,\n\t\t\t\titems: menuItems,\n\t\t\t});\n\t\t}\n\n\t\tthis.#copilotSummaryMenu.show();\n\t}\n\n\t#runCompleteAction(activityId: Number, ownerTypeId: Number, ownerId: Number, animationCallbacks: ?Object): Promise\n\t{\n\t\tif (animationCallbacks.onStart)\n\t\t{\n\t\t\tanimationCallbacks.onStart();\n\t\t}\n\n\t\treturn Ajax.runAction(\n\t\t\t'crm.timeline.activity.complete',\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tactivityId,\n\t\t\t\t\townerTypeId,\n\t\t\t\t\townerId,\n\t\t\t\t},\n\t\t\t},\n\t\t).then(() => {\n\t\t\tif (animationCallbacks.onStop)\n\t\t\t{\n\t\t\t\tanimationCallbacks.onStop();\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\t(response) => {\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\tautoHideDelay: 5000,\n\t\t\t});\n\n\t\t\tif (animationCallbacks.onStop)\n\t\t\t{\n\t\t\t\tanimationCallbacks.onStop();\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\t}\n\n\t#showCopilotWelcomeTour(item: ConfigurableItem): void\n\t{\n\t\tsetTimeout(() => {\n\t\t\tconst aiCopilotBtn: Button = item.getLayoutFooterButtonById('aiButton');\n\t\t\tconst aiCopilotUIBtn: ButtonUI = aiCopilotBtn?.getUiButton();\n\t\t\tif (!aiCopilotUIBtn || aiCopilotUIBtn.getState() === ButtonState.DISABLED)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (aiCopilotBtn?.isInViewport())\n\t\t\t{\n\t\t\t\tEventEmitter.emit(\n\t\t\t\t\tthis,\n\t\t\t\t\t'BX.Crm.Timeline.Openline:onShowCopilotTour',\n\t\t\t\t\t{\n\t\t\t\t\t\ttarget: aiCopilotUIBtn.getContainer(),\n\t\t\t\t\t\tstepId: 'copilot-in-open-line',\n\t\t\t\t\t\tdelay: 1500,\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst showCopilotTourOnScroll = () => {\n\t\t\t\tif (aiCopilotBtn?.isInViewport())\n\t\t\t\t{\n\t\t\t\t\tEventEmitter.emit(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t'BX.Crm.Timeline.Openline:onShowCopilotTour',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttarget: aiCopilotUIBtn.getContainer(),\n\t\t\t\t\t\t\tstepId: 'copilot-in-open-line',\n\t\t\t\t\t\t\tdelay: 1000,\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\n\t\t\t\t\tEvent.unbind(window, 'scroll', showCopilotTourOnScroll);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tEvent.bind(window, 'scroll', showCopilotTourOnScroll);\n\t\t}, 50);\n\t}\n\t// endregion\n\n\tasync #openCopilotSummaryPopup(jobId: number, actionData: Object): void\n\t{\n\t\tawait top.BX.Runtime.loadExtension('crm.ai.call');\n\n\t\tif (this.#copilotSummaryMenu)\n\t\t{\n\t\t\tthis.#copilotSummaryMenu.close();\n\t\t}\n\n\t\tconst summary = new top.BX.Crm.AI.Call.Summary({\n\t\t\tactivityId: actionData.activityId,\n\t\t\townerTypeId: actionData.ownerTypeId,\n\t\t\townerId: actionData.ownerId,\n\t\t\tlanguageTitle: actionData.languageTitle,\n\t\t\tactivityProvider: ActivityProvider.openLine,\n\t\t\tjobId,\n\t\t});\n\n\t\tsummary.open();\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn item.getType() === 'Activity:OpenLine';\n\t}\n}\n","import { ajax, Loc } from 'main.core';\nimport { UI } from 'ui.notification';\nimport ConfigurableItem from '../configurable-item';\nimport { type ActionParams, Base } from './base';\nimport { Router } from 'crm.router';\n\nexport class OrderCheck extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'OrderCheck:OpenCheck' && actionData && actionData.checkUrl)\n\t\t{\n\t\t\tRouter.openSlider(\n\t\t\t\tactionData.checkUrl,\n\t\t\t\t{\n\t\t\t\t\twidth: 500,\n\t\t\t\t\tcacheable: false,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t\telse if (action === 'OrderCheck:ReprintCheck' && actionData && actionData.checkId)\n\t\t{\n\t\t\tajax.runAction('crm.ordercheck.reprint', {\n\t\t\t\tdata: {\n\t\t\t\t\tcheckId: actionData.checkId,\n\t\t\t\t},\n\t\t\t}).catch((response) => {\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (\n\t\t\titem.getType() === 'OrderCheckPrinted'\n\t\t\t|| item.getType() === 'OrderCheckNotPrinted'\n\t\t\t|| item.getType() === 'OrderCheckSent'\n\t\t\t|| item.getType() === 'OrderCheckPrinting'\n\t\t);\n\t}\n}\n","import {Base} from './base';\nimport ConfigurableItem from '../configurable-item';\n\nexport class Payment extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst {action, actionType, actionData, animationCallbacks} = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Payment:OpenRealization' && actionData?.paymentId)\n\t\t{\n\t\t\tthis.#openRealization(actionData.paymentId);\n\t\t}\n\t}\n\n\t#openRealization(paymentId: number): void\n\t{\n\t\tconst control = BX.Crm.EntityEditor.getDefault().getControlByIdRecursive('OPPORTUNITY_WITH_CURRENCY');\n\t\tif (!control)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst paymentDocumentsControl = control.getPaymentDocumentsControl();\n\t\tif (!paymentDocumentsControl)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tpaymentDocumentsControl._createRealizationSlider({paymentId});\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (\n\t\t\titem.getType() === 'Payment'\n\t\t\t|| item.getType() === 'Activity:Payment'\n\t\t);\n\t}\n}\n","import { Router } from 'crm.router';\nimport { Type } from 'main.core';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\n\nimport { CopilotBase } from './ai/copilot-base';\nimport type { CopilotConfig } from './ai/copilot-base';\nimport ConfigurableItem from '../configurable-item';\nimport { ActionParams } from './base';\nimport { EditableDescriptionAiStatus } from '../components/enums/editable-description-ai-status';\n\nexport class RepeatSale extends CopilotBase\n{\n\t#prevHeaderText: string;\n\n\t// region Base overridden methods\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Activity:RepeatSale:ShowRestrictionSlider')\n\t\t{\n\t\t\tthis.#showRestrictionSlider();\n\t\t}\n\n\t\tif (!Type.isObject(actionData))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Activity:RepeatSale:Schedule')\n\t\t{\n\t\t\tthis.runScheduleAction(actionData.activityId, actionData.scheduleDate, actionData.description);\n\t\t}\n\n\t\tif (action === 'Activity:RepeatSale:LaunchCopilot')\n\t\t{\n\t\t\tvoid this.handleCopilotLaunch(item, actionData);\n\t\t}\n\n\t\tif (action === 'Activity:RepeatSale:OpenSegment')\n\t\t{\n\t\t\tthis.#openSegment(actionData.activityId, actionData.segmentId);\n\t\t}\n\t}\n\t// endregion\n\n\t// region CopilotBase overridden methods\n\tgetCopilotConfig(): CopilotConfig\n\t{\n\t\treturn {\n\t\t\tactionEndpoint: 'crm.timeline.repeatsale.launchCopilot',\n\t\t\tvalidEntityTypes: [BX.CrmEntityType.enumeration.deal],\n\t\t\tagreementContext: 'audio', // @todo!\n\t\t\tonPreLaunch: this.handlePreLaunch.bind(this),\n\t\t\tonError: this.handleError.bind(this),\n\t\t};\n\t}\n\n\thandlePreLaunch(item: ConfigurableItem, actionData: Object): void\n\t{\n\t\tconst descriptionBlock = item.getLayoutContentBlockById('description');\n\t\tconst errorBlock = item.getLayoutContentBlockById('error');\n\n\t\tthis.#prevHeaderText = descriptionBlock?.getHeaderText();\n\n\t\tdescriptionBlock?.setHeaderText('');\n\t\tdescriptionBlock?.setCopilotStatus(EditableDescriptionAiStatus.IN_PROGRESS);\n\t\terrorBlock?.closeBlock();\n\t}\n\n\thandleError(item: ConfigurableItem, actionData: Object, response: Object): void\n\t{\n\t\tconst descriptionBlock = item.getLayoutContentBlockById('description');\n\n\t\tdescriptionBlock?.setHeaderText(this.#prevHeaderText);\n\t\tdescriptionBlock?.setCopilotStatus(EditableDescriptionAiStatus.NONE);\n\t}\n\t// endregion\n\n\t// region jsEvent action handlers\n\t#showRestrictionSlider(): void\n\t{\n\t\tFeaturePromotersRegistry.getPromoter({ featureId: 'limit_v2_crm_repeat_sale' }).show();\n\t}\n\n\t#openSegment(item: ConfigurableItem, segmentId: number): void\n\t{\n\t\tif (!Type.isInteger(segmentId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvoid Router.Instance.openRepeatSaleSegmentSlider(segmentId, true, {\n\t\t\tsection: 'deal_section',\n\t\t});\n\t}\n\t// endregion\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn item.getType() === 'Activity:RepeatSale'\n\t\t\t|| item.getType() === 'RepeatSaleCreated'\n\t\t\t|| item.getType() === 'LaunchError'\n\t\t;\n\t}\n}\n","import { Type } from 'main.core';\nimport { Base } from './base';\nimport ConfigurableItem from '../configurable-item';\nimport { ActionType } from '../action';\n\nexport class RestApp extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\t\tif (!ActionType.isJsEvent(actionType))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Activity:ConfigurableRestApp:OpenApp')\n\t\t{\n\t\t\tthis.#openRestAppSlider(actionData);\n\t\t}\n\t}\n\n\t#openRestAppSlider(params: Object): void\n\t{\n\t\tconst openAppParams = { ...params };\n\t\tconst appId = openAppParams.restAppId;\n\t\tdelete openAppParams.restAppId;\n\n\t\tif (BX.rest && BX.rest.AppLayout)\n\t\t{\n\t\t\tif (Type.isStringFilled(openAppParams.bx24_label))\n\t\t\t{\n\t\t\t\topenAppParams.bx24_label = JSON.parse(openAppParams.bx24_label);\n\t\t\t}\n\t\t\tBX.rest.AppLayout.openApplication(appId, openAppParams);\n\t\t}\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (item.getType() === 'Activity:ConfigurableRestApp');\n\t}\n}\n","import {Base} from './base';\nimport ConfigurableItem from '../configurable-item';\nimport {Type} from 'main.core';\n\nexport class SalescenterApp extends Base\n{\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\tconst supportedItemTypes = [\n\t\t\t'Activity:Sms',\n\t\t\t'Activity:Notification',\n\t\t\t'Activity:Payment',\n\t\t\t'PaymentViewed',\n\t\t\t'PaymentNotViewed',\n\t\t\t'PaymentSent',\n\t\t\t'PaymentPaid',\n\t\t\t'PaymentNotPaid',\n\t\t\t'PaymentError',\n\t\t\t'PaymentSentToTerminal',\n\t\t\t'Activity:Delivery',\n\t\t\t'CustomerSelectedPaymentMethod',\n\t\t];\n\n\t\treturn supportedItemTypes.includes(item.getType());\n\t}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst {action, actionType, actionData, animationCallbacks} = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'SalescenterApp:Start' && actionData)\n\t\t{\n\t\t\tthis.#startSalescenterApp(actionData);\n\t\t}\n\t}\n\n\t#startSalescenterApp(actionData): void\n\t{\n\t\tif (\n\t\t\t! (\n\t\t\t\tType.isInteger(actionData.ownerTypeId)\n\t\t\t\t&& Type.isInteger(actionData.ownerId)\n\t\t\t\t&& Type.isInteger(actionData.orderId)\n\t\t\t\t&& Type.isStringFilled(actionData.mode)\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.loadExt('salescenter.manager').then(() => {\n\t\t\tconst params = {\n\t\t\t\townerTypeId: actionData.ownerTypeId,\n\t\t\t\townerId: actionData.ownerId,\n\t\t\t\torderId: actionData.orderId,\n\t\t\t\tmode: actionData.mode,\n\t\t\t\tdisableSendButton: '',\n\t\t\t\tcontext: 'deal',\n\t\t\t\ttemplateMode: 'view',\n\t\t\t};\n\n\t\t\tif (Type.isInteger(actionData.paymentId))\n\t\t\t{\n\t\t\t\tparams.paymentId = actionData.paymentId;\n\t\t\t}\n\n\t\t\tif (Type.isInteger(actionData.shipmentId))\n\t\t\t{\n\t\t\t\tparams.shipmentId = actionData.shipmentId;\n\t\t\t}\n\n\t\t\tif (Type.isStringFilled(actionData.analyticsLabel))\n\t\t\t{\n\t\t\t\tparams.analyticsLabel = actionData.analyticsLabel;\n\t\t\t}\n\n\t\t\tBX.Salescenter.Manager.openApplication(params);\n\t\t});\n\t}\n}\n","import { Router } from 'crm.router';\nimport { Messenger } from 'im.public';\nimport { ajax, Dom, Loc, Text, Runtime } from 'main.core';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport { UI } from 'ui.notification';\nimport ConfigurableItem from '../configurable-item';\nimport { Base } from './base';\nimport type { Api } from 'sign.v2.api';\nimport type { FeatureResolver } from 'sign.feature-resolver';\n\nlet featureResolver: FeatureResolver | null = null;\nlet api: Api | null = null;\nRuntime.loadExtension(['sign.v2.api', 'sign.feature-resolver']).then(async (exports) => {\n\tif (exports?.Api && exports?.FeatureResolver)\n\t{\n\t\tfeatureResolver = exports?.FeatureResolver.instance();\n\t\tapi = new exports.Api();\n\t}\n}).catch((errors) => {\n\tUI.Notification.Center.notify({\n\t\tcontent: errors[0].message,\n\t\tautoHideDelay: 5000,\n\t});\n});\n\nexport class SignB2eDocument extends Base\n{\n\t#isCancellationInProgress: boolean = false;\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (\n\t\t\titem.getType() === 'SignB2eDocument'\n\t\t\t|| item.getType() === 'Activity:SignB2eDocument'\n\t\t);\n\t}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData, animationCallbacks } = actionParams;\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst documentId = Text.toInteger(actionData?.documentId);\n\t\tconst processUri = actionData?.processUri;\n\t\tconst documentHash = actionData?.documentHash || '';\n\n\t\tif (action === 'Activity:SignB2eDocument:ShowSigningCancel')\n\t\t{\n\t\t\tthis.#cancelWithConfirm(actionData?.documentUid);\n\t\t}\n\t\telse if ((action === 'SignB2eDocument:ShowSigningProcess'\n\t\t\t|| action === 'Activity:SignB2eDocument:ShowSigningProcess') && processUri.length > 0)\n\t\t{\n\t\t\tthis.#showSigningProcess(processUri);\n\t\t}\n\t\telse if ((action === 'SignB2eDocument:Preview' || action === 'Activity:SignB2eDocument:Preview') && documentId > 0)\n\t\t{\n\t\t\tthis.#previewDocument(actionData);\n\t\t}\n\t\telse if ((action === 'SignB2eDocument:CreateDocumentChat' || action === 'Activity:SignB2eDocument:CreateDocumentChat') && documentId > 0)\n\t\t{\n\t\t\tif (featureResolver && featureResolver.released('createDocumentChat'))\n\t\t\t{\n\t\t\t\tthis.#createDocumentChat(actionData);\n\t\t\t}\n\t\t}\n\t\telse if ((action === 'SignB2eDocument:Modify' || action === 'Activity:SignB2eDocument:Modify') && documentId > 0)\n\t\t{\n\t\t\tthis.#modifyDocument(actionData);\n\t\t}\n\t\telse if (action === 'SignB2eDocument:Resend' && documentId > 0 && actionData?.recipientHash)\n\t\t{\n\t\t\t// eslint-disable-next-line promise/catch-or-return\n\t\t\tthis.#resendDocument(actionData, animationCallbacks).then(() => {\n\t\t\t\tif (actionData.buttonId)\n\t\t\t\t{\n\t\t\t\t\tconst btn = item.getLayoutFooterButtonById(actionData.buttonId);\n\t\t\t\t\tbtn.disableWithTimer(60);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (action === 'SignB2eDocument:TouchSigner' && documentId > 0)\n\t\t{\n\t\t\tthis.#touchSigner(actionData);\n\t\t}\n\t\telse if (action === 'SignB2eDocument:Download' && documentHash)\n\t\t{\n\t\t\tthis.#download(actionData, animationCallbacks);\n\t\t}\n\t\telse if (action === 'SignB2eDocumentEntry:Delete' && actionData?.entryId)\n\t\t{\n\t\t\tMessageBox.show({\n\t\t\t\tmessage: actionData?.confirmationText || '',\n\t\t\t\tmodal: true,\n\t\t\t\tbuttons: MessageBoxButtons.YES_NO,\n\t\t\t\tonYes: () => {\n\t\t\t\t\treturn this.#deleteEntry(actionData.entryId);\n\t\t\t\t},\n\t\t\t\tonNo: (messageBox) => {\n\t\t\t\t\tmessageBox.close();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\telse if (action === 'SignB2eDocument:ModifyDateSignUntil')\n\t\t{\n\t\t\tthis.#modifyDateSignUntil(item, actionData, animationCallbacks);\n\t\t}\n\t}\n\n\t#cancelWithConfirm(documentUid: string): void\n\t{\n\t\tif (this.#isCancellationInProgress)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst signingCancelationDialog = new MessageBox({\n\t\t\ttitle: Loc.getMessage('CRM_TIMELINE_ITEM_SIGNING_CANCEL_DIALOG_TITLE'),\n\t\t\tmessage: Loc.getMessage('CRM_TIMELINE_ITEM_SIGNING_CANCEL_DIALOG_TEXT'),\n\t\t\tmodal: true,\n\t\t});\n\n\t\tsigningCancelationDialog.setButtons([new BX.UI.Button({\n\t\t\ttext: Loc.getMessage('CRM_TIMELINE_ITEM_SIGNING_CANCEL_DIALOG_YES_BUTTON_TEXT'),\n\t\t\tcolor: BX.UI.Button.Color.DANGER,\n\t\t\tonclick: () => {\n\t\t\t\tthis.#isCancellationInProgress = true;\n\t\t\t\tsigningCancelationDialog.close();\n\t\t\t\tthis.#cancelSigningProcess(documentUid).finally(() => {\n\t\t\t\t\tthis.#isCancellationInProgress = false;\n\t\t\t\t});\n\t\t\t},\n\t\t}), new BX.UI.Button({\n\t\t\ttext: Loc.getMessage('CRM_TIMELINE_ITEM_SIGNING_CANCEL_DIALOG_NO_BUTTON_TEXT'),\n\t\t\tcolor: BX.UI.Button.Color.LIGHT_BORDER,\n\t\t\tonclick: () => {\n\t\t\t\tsigningCancelationDialog.close();\n\t\t\t},\n\t\t})]);\n\n\t\tsigningCancelationDialog.show();\n\t}\n\n\t#cancelSigningProcess(documentUid): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'sign.api_v1.document.signing.stop',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tuid: documentUid,\n\t\t\t\t\t},\n\t\t\t\t\tpreparePost: false,\n\t\t\t\t\theaders: [{\n\t\t\t\t\t\tname: 'Content-Type',\n\t\t\t\t\t\tvalue: 'application/json',\n\t\t\t\t\t}],\n\t\t\t\t},\n\t\t\t).then((response) => {\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('CRM_TIMELINE_ITEM_SIGNING_CANCEL_SUCCESS'),\n\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t});\n\t\t\t\tresolve(response);\n\t\t\t}, (response) => {\n\t\t\t\tresponse.errors.forEach((error) => {\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: error.message,\n\t\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\treject(response.errors);\n\t\t\t}).catch(() => {\n\t\t\t\treject();\n\t\t\t});\n\t\t});\n\t}\n\n\t#deleteEntry(entryId): Promise\n\t{\n\t\tconsole.log(`delete entry${entryId}`);\n\t}\n\n\t#showSigningProcess(processUri): Promise\n\t{\n\t\treturn Router.openSlider(processUri);\n\t}\n\n\t#modifyDocument({ documentId }): Promise\n\t{\n\t\treturn Router.openSlider(\n\t\t\t`/sign/b2e/doc/0/?docId=${documentId}&stepId=changePartner&noRedirect=Y`,\n\t\t\t{\n\t\t\t\twidth: 1250,\n\t\t\t},\n\t\t);\n\t}\n\n\t#previewDocument({ documentId }): Promise\n\t{\n\t\treturn Router.openSlider(`/sign/b2e/preview/0/?docId=${documentId}&noRedirect=Y`);\n\t}\n\n\tasync #createDocumentChat({ chatType, documentId }: { chatType: number, documentId: number }): void\n\t{\n\t\tif (api && featureResolver && featureResolver.released('createDocumentChat'))\n\t\t{\n\t\t\tconst chatId = (await api.createDocumentChat(chatType, documentId, false)).chatId;\n\t\t\tMessenger.openChat(`chat${chatId}`);\n\t\t}\n\t}\n\n\t#resendDocument({ documentId, recipientHash }, animationCallbacks): Promise\n\t{\n\t\tif (animationCallbacks.onStart)\n\t\t{\n\t\t\tanimationCallbacks.onStart();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'sign.internal.document.resendFile',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tmemberHash: recipientHash,\n\t\t\t\t\t\tdocumentId,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t).then(() => {\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('CRM_TIMELINE_ITEM_SIGN_DOCUMENT_RESEND_SUCCESS'),\n\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t});\n\t\t\t\tif (animationCallbacks.onStop)\n\t\t\t\t{\n\t\t\t\t\tanimationCallbacks.onStop();\n\t\t\t\t}\n\t\t\t\tresolve();\n\t\t\t}, (response) => {\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t});\n\t\t\t\tif (animationCallbacks.onStop)\n\t\t\t\t{\n\t\t\t\t\tanimationCallbacks.onStop();\n\t\t\t\t}\n\t\t\t\treject();\n\t\t\t});\n\n\t\t\tconsole.log(`resend document ${documentId} for ${recipientHash}`);\n\t\t});\n\t}\n\n\t#touchSigner({ documentId }): void\n\t{\n\t\tconsole.log(`touch signer document ${documentId}`);\n\t}\n\n\t#download({ filename, downloadLink }, animationCallbacks): void\n\t{\n\t\tif (animationCallbacks.onStart)\n\t\t{\n\t\t\tanimationCallbacks.onStart();\n\t\t}\n\n\t\tconst link = document.createElement('a');\n\t\tlink.href = downloadLink;\n\t\tlink.setAttribute('download', filename || '');\n\n\t\tDom.document.body.appendChild(link);\n\t\tlink.click();\n\t\tdocument.body.removeChild(link);\n\n\t\tif (animationCallbacks.onStop)\n\t\t{\n\t\t\tanimationCallbacks.onStop();\n\t\t}\n\t}\n\n\tasync #modifyDateSignUntil(item: ConfigurableItem, actionData, animationCallbacks): void\n\t{\n\t\tif (!actionData.uid || !actionData.valueTs)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (animationCallbacks.onStart)\n\t\t{\n\t\t\tanimationCallbacks.onStart();\n\t\t}\n\n\t\tconst { uid, valueTs } = actionData;\n\n\t\ttry\n\t\t{\n\t\t\tawait api.modifyDateSignUntil(uid, valueTs);\n\t\t}\n\t\tcatch\n\t\t{\n\t\t\titem.forceRefreshLayout();\n\t\t}\n\n\t\tif (animationCallbacks.onStop)\n\t\t{\n\t\t\tanimationCallbacks.onStop();\n\t\t}\n\t}\n}\n","import { ajax as Ajax, Text, Loc } from 'main.core';\nimport { Router } from 'crm.router';\nimport { Base } from './base';\nimport { ajax } from 'main.core';\nimport { DateTimeFormat } from \"main.date\";\nimport { DatetimeConverter } from \"crm.timeline.tools\";\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\n\nimport ConfigurableItem from '../configurable-item';\nimport {UI} from \"ui.notification\";\n\ndeclare type Signer = {\n\ttitle: string,\n}\n\nexport class SignDocument extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst {action, actionType, actionData, animationCallbacks} = actionParams;\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst documentId = Text.toInteger(actionData?.documentId);\n\t\tconst documentHash = actionData?.documentHash || '';\n\t\tconst activityId = Text.toInteger(actionData?.activityId);\n\t\tif ((action === 'SignDocument:Open' || action === 'Activity:SignDocument:Open') && documentId > 0)\n\t\t{\n\t\t\tthis.#openDocument(actionData);\n\t\t}\n\t\telse if ((action === 'SignDocument:Modify' || action === 'Activity:SignDocument:Modify') && documentId > 0)\n\t\t{\n\t\t\tthis.#modifyDocument(actionData);\n\t\t}\n\t\telse if ((action === 'SignDocument:UpdateActivityDeadline' || action === 'Activity:SignDocument:UpdateActivityDeadline') && activityId > 0)\n\t\t{\n\t\t\tthis.#updateActivityDeadline(activityId, actionData?.value);\n\t\t}\n\t\telse if (action === 'SignDocument:Resend' && documentId > 0 && actionData?.recipientHash)\n\t\t{\n\t\t\tthis.#resendDocument(actionData, animationCallbacks).then(() => {\n\t\t\t\tif (actionData.buttonId)\n\t\t\t\t{\n\t\t\t\t\tconst btn = item.getLayoutFooterButtonById(actionData.buttonId);\n\t\t\t\t\tbtn.disableWithTimer(60);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\telse if (action === 'SignDocument:TouchSigner' && documentId > 0)\n\t\t{\n\t\t\tthis.#touchSigner(actionData);\n\t\t}\n\t\telse if (action === 'SignDocument:Download' && documentHash)\n\t\t{\n\t\t\tthis.#download(actionData, animationCallbacks);\n\t\t}\n\t\telse if (action === 'SignDocumentEntry:Delete' && actionData?.entryId)\n\t\t{\n\t\t\tMessageBox.show({\n\t\t\t\tmessage: actionData?.confirmationText || '',\n\t\t\t\tmodal: true,\n\t\t\t\tbuttons: MessageBoxButtons.YES_NO,\n\t\t\t\tonYes: () =>\n\t\t\t\t{\n\t\t\t\t\treturn this.#deleteEntry(actionData.entryId);\n\t\t\t\t},\n\t\t\t\tonNo: (messageBox) =>\n\t\t\t\t{\n\t\t\t\t\tmessageBox.close();\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t}\n\n\t#deleteEntry(entryId): Promise\n\t{\n\t\tconsole.log('delete entry' + entryId);\n\t}\n\n\t#openDocument({\n\t\tdocumentId,\n\t\tmemberHash\n\t}): Promise\n\t{\n\t\treturn Router.Instance.openSignDocumentSlider(documentId, memberHash);\n\t}\n\n\t#modifyDocument({ documentId }): Promise\n\t{\n\t\treturn Router.Instance.openSignDocumentModifySlider(documentId);\n\t}\n\n\tasync #updateActivityDeadline(activityId: number, value: ?Date): Promise<void>\n\t{\n\t\tconst valueInSiteFormat = DateTimeFormat.format(DatetimeConverter.getSiteDateFormat(), value);\n\n\t\tlet response: {data: {document?: {activityDeadline?: string}, success?: boolean, code?: number}};\n\t\ttry\n\t\t{\n\t\t\tresponse = await Ajax.runAction('crm.timeline.signdocument.updateActivityDeadline', {\n\t\t\t\tdata: {\n\t\t\t\t\tactivityId: activityId,\n\t\t\t\t\tactivityDeadline: valueInSiteFormat,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t\tcatch (responseWithError)\n\t\t{\n\t\t\tconsole.error(responseWithError);\n\t\t\treturn;\n\t\t}\n\n\t\tconst newCreateDate = response.data.document?.activityDeadline;\n\n\t\tif (valueInSiteFormat !== newCreateDate)\n\t\t{\n\t\t\tconsole.error(\"Updated document create date without errors, but for some reason date from the backend doesn't match sent value\");\n\t\t}\n\t}\n\n\t#resendDocument({documentId, recipientHash}, animationCallbacks): Promise\n\t{\n\t\tif (animationCallbacks.onStart)\n\t\t{\n\t\t\tanimationCallbacks.onStart();\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runAction(\n\t\t\t\t'sign.internal.document.resendFile',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tmemberHash: recipientHash,\n\t\t\t\t\t\tdocumentId: documentId\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t).then(() =>\n\t\t\t{\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('CRM_TIMELINE_ITEM_SIGN_DOCUMENT_RESEND_SUCCESS'),\n\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t});\n\t\t\t\tif (animationCallbacks.onStop)\n\t\t\t\t{\n\t\t\t\t\tanimationCallbacks.onStop();\n\n\t\t\t\t}\n\t\t\t\tresolve();\n\t\t\t}, (response) =>\n\t\t\t{\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t});\n\t\t\t\tif (animationCallbacks.onStop)\n\t\t\t\t{\n\t\t\t\t\tanimationCallbacks.onStop();\n\t\t\t\t}\n\t\t\t\treject();\n\t\t\t});\n\n\t\t\tconsole.log('resend document ' + documentId + ' for ' + recipientHash);\n\t\t})\n\t}\n\n\t#touchSigner({documentId}): void\n\t{\n\t\tconsole.log('touch signer document ' + documentId);\n\t}\n\n\t#download({filename, downloadLink}, animationCallbacks): void\n\t{\n\t\tif (animationCallbacks.onStart)\n\t\t{\n\t\t\tanimationCallbacks.onStart();\n\t\t}\n\n\t\tconst link = document.createElement('a');\n\t\t/*link.href = '/bitrix/services/main/ajax.php?action=sign.document.getFileForSrc' +\n\t\t\t'&memberHash=' + memberHash +\n\t\t\t'&documentHash=' + documentHash;*/\n\t\tlink.href = downloadLink;\n\t\tlink.setAttribute('download', filename || '');\n\n\t\tdocument.body.appendChild(link);\n\t\tlink.click();\n\t\tdocument.body.removeChild(link);\n\n\t\tif (animationCallbacks.onStop)\n\t\t{\n\t\t\tanimationCallbacks.onStop();\n\t\t}\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (\n\t\t\titem.getType() === 'SignDocument'\n\t\t\t|| item.getType() === 'Activity:SignDocument'\n\t\t);\n\t}\n}\n","import { Loc } from 'main.core';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\n\nexport async function tryToResendWithMessage(params): Promise<boolean>\n{\n\tconst menuBar = BX.Crm?.Timeline?.MenuBar?.getDefault();\n\tif (!menuBar)\n\t{\n\t\treturn false;\n\t}\n\n\tconst messageItem = menuBar.getItemById('message');\n\tif (!messageItem)\n\t{\n\t\treturn false;\n\t}\n\n\tif (messageItem.shouldConfirmStateChange(params))\n\t{\n\t\tconst { isCancelled } = await confirmStateChange();\n\t\tif (isCancelled)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tmenuBar.scrollIntoView();\n\tmenuBar.setActiveItemById('message');\n\tvoid messageItem.tryToResend(params);\n\n\treturn true;\n}\n\nfunction confirmStateChange(): Promise<{ isCancelled: boolean }>\n{\n\treturn new Promise((resolve) => {\n\t\tMessageBox.show({\n\t\t\tmodal: true,\n\t\t\ttitle: Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_MESSAGE_RESEND_CONFIRM_DIALOG_TITLE'),\n\t\t\tmessage: Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_MESSAGE_RESEND_CONFIRM_DIALOG_MESSAGE'),\n\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\tokCaption: Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_SMS_RESEND_CONFIRM_DIALOG_OK_BTN'),\n\t\t\tonOk: (messageBox) => {\n\t\t\t\tmessageBox.close();\n\t\t\t\tresolve({ isCancelled: false });\n\t\t\t},\n\t\t\tonCancel: (messageBox) => {\n\t\t\t\tmessageBox.close();\n\t\t\t\tresolve({ isCancelled: true });\n\t\t\t},\n\t\t});\n\t});\n}\n","import { Loc, Type } from 'main.core';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport ConfigurableItem from '../configurable-item';\n\nimport { ActionParams, Base } from './base';\nimport { tryToResendWithMessage } from './message/resend';\n\ndeclare type SmsParams = {\n\ttext: string,\n\tsenderCode: string,\n\tsenderId: string,\n\tfrom: string,\n\tclient: Object,\n}\n\nexport class Sms extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Activity:Sms:Resend' && Type.isPlainObject(actionData.params))\n\t\t{\n\t\t\tvoid this.#resendSms(actionData.params);\n\t\t}\n\t}\n\n\tasync #resendSms(params: SmsParams): Promise<void>\n\t{\n\t\tconst messageParams = {\n\t\t\tbackend: {\n\t\t\t\tsenderCode: params.senderCode,\n\t\t\t\tid: params.senderId,\n\t\t\t},\n\t\t\tfromId: params.from,\n\t\t\tclient: params.client,\n\t\t\ttext: params.text,\n\t\t};\n\n\t\tif (await tryToResendWithMessage(messageParams))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuBar = BX.Crm?.Timeline?.MenuBar?.getDefault();\n\t\tif (!menuBar)\n\t\t{\n\t\t\tthrow new Error('\"BX.Crm?.Timeline.MenuBar\" component not found');\n\t\t}\n\n\t\tconst smsItem = menuBar.getItemById('sms');\n\t\tif (!smsItem)\n\t\t{\n\t\t\tthrow new Error('\"BX.Crm.Timeline.MenuBar.Sms\" component not found');\n\t\t}\n\n\t\tconst goToEditor = (): void => {\n\t\t\tmenuBar.scrollIntoView();\n\t\t\tmenuBar.setActiveItemById('sms');\n\t\t\tsmsItem.tryToResend(params.senderId, params.from, params.client, params.text);\n\t\t};\n\t\tconst { text, templateId } = smsItem.getSendData();\n\t\tif (Type.isStringFilled(text) || templateId !== null)\n\t\t{\n\t\t\tMessageBox.show({\n\t\t\t\tmodal: true,\n\t\t\t\ttitle: Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_SMS_RESEND_CONFIRM_DIALOG_TITLE'),\n\t\t\t\tmessage: Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_SMS_RESEND_CONFIRM_DIALOG_MESSAGE'),\n\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\tokCaption: Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_SMS_RESEND_CONFIRM_DIALOG_OK_BTN'),\n\t\t\t\tonOk: (messageBox) => {\n\t\t\t\t\tmessageBox.close();\n\t\t\t\t\tgoToEditor();\n\t\t\t\t},\n\t\t\t\tonCancel: (messageBox) => messageBox.close(),\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tgoToEditor();\n\t\t}\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (item.getType() === 'Activity:Sms');\n\t}\n}\n","import { Base } from './base';\nimport ConfigurableItem from '../configurable-item';\nimport type { ActionParams } from './base';\nimport { ajax, Loc } from 'main.core';\nimport { UI } from 'ui.notification';\nimport { MessageBox } from 'ui.dialogs.messagebox';\n\nexport class Task extends Base\n{\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (\n\t\t\titem.getType() === 'Activity:TasksTask'\n\t\t\t|| item.getType() === 'TasksTaskCreation'\n\t\t\t|| item.getType() === 'TasksTaskModification'\n\t\t\t|| item.getType() === 'Activity:TasksTaskComment'\n\t\t);\n\t}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData, animationCallbacks } = actionParams;\n\t\tif (!actionData)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst taskId = actionData.taskId ?? null;\n\t\tif (!taskId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (action)\n\t\t{\n\t\t\tcase 'Task:Ping':\n\t\t\t\tthis.ping(actionData);\n\t\t\t\tbreak;\n\n\t\t\tcase 'Task:ChangeDeadline':\n\t\t\t\tthis.changeDeadline(item, actionData);\n\t\t\t\tbreak;\n\n\t\t\tcase 'Task:View':\n\t\t\t\tthis.view(actionData);\n\t\t\t\tbreak;\n\n\t\t\tcase 'Task:Edit':\n\t\t\t\tthis.edit(actionData);\n\t\t\t\tbreak\n\n\t\t\tcase 'Task:Delete':\n\t\t\t\tthis.delete(actionData);\n\t\t\t\tbreak;\n\n\t\t\tcase 'Task:ResultView':\n\t\t\t\tthis.viewResult(actionData);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tping(actionData): void\n\t{\n\t\tif (!actionData.taskId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tajax.runAction('tasks.task.ping', {\n\t\t\t\tdata: {\n\t\t\t\t\ttaskId: actionData.taskId,\n\t\t\t\t},\n\t\t\t},\n\t\t).then((response) => {\n\t\t\tif (response.status === 'success')\n\t\t\t{\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('CRM_TIMELINE_ITEM_TASK_PING_SENT'),\n\t\t\t\t\tautoHideDelay: 3000,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tchangeDeadline(item: ConfigurableItem, actionData): void\n\t{\n\t\tif (!actionData.taskId || !actionData.value)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tajax.runAction('tasks.task.update', {\n\t\t\t\tdata: {\n\t\t\t\t\ttaskId: actionData.taskId,\n\t\t\t\t\tfields: {\n\t\t\t\t\t\tDEADLINE: (new Date(actionData.valueTs * 1000)).toISOString(),\n\t\t\t\t\t},\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tskipTimeZoneOffset: 'DEADLINE',\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t).catch(response => {\n\t\t\tconst errors = response.errors ??  null;\n\t\t\tif (errors.length > 0)\n\t\t\t{\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: errors[0].message,\n\t\t\t\t\tautoHideDelay: 3000,\n\t\t\t\t});\n\t\t\t\titem.forceRefreshLayout();\n\t\t\t}\n\t\t});\n\t}\n\n\tview(actionData): void\n\t{\n\t\tif (!actionData.path)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.SidePanel.Instance.open(actionData.path, {\n\t\t\tcacheable: false,\n\t\t})\n\t}\n\n\tedit(actionData): void\n\t{\n\t\tif (!actionData.path)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.SidePanel.Instance.open(actionData.path, {\n\t\t\tcacheable: false,\n\t\t})\n\t}\n\n\tdelete(actionData): void\n\t{\n\t\tif (!actionData.taskId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst messageBox = new MessageBox(\n\t\t\t{\n\t\t\t\tmessage: Loc.getMessage('CRM_TIMELINE_ITEM_TASK_CONFIRM_DELETE'),\n\t\t\t\tbuttons: BX.UI.Dialogs.MessageBoxButtons.YES_NO,\n\t\t\t\tonYes: () => {\n\t\t\t\t\tajax.runAction('tasks.task.delete', {\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\ttaskId: actionData.taskId,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t)\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t})\n\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: error.errors[0].message ?? 'Error',\n\t\t\t\t\t\t\tautoHideDelay: 3000,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tonNo: () => {\n\t\t\t\t\tmessageBox.close();\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tmessageBox.show();\n\t}\n\n\tviewResult(actionData): void\n\t{\n\t\tif (!actionData.taskId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!actionData.path)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tajax.runAction('tasks.task.result.getLast', {\n\t\t\t\tdata: {\n\t\t\t\t\ttaskId: actionData.taskId,\n\t\t\t\t},\n\t\t\t},\n\t\t).then((response) => {\n\t\t\tif (response.status === 'success')\n\t\t\t{\n\t\t\t\tconst resultId = response.data.result;\n\t\t\t\tBX.SidePanel.Instance.open(actionData.path + '?RID=' + resultId, {\n\t\t\t\t\tcacheable: false,\n\t\t\t\t})\n\t\t\t}\n\t\t});\n\t}\n}","import { Type } from 'main.core';\nimport ConfigurableItem from '../configurable-item';\n\nimport { ActionParams, Base } from './base';\nimport { tryToResendWithMessage } from './message/resend';\n\ndeclare type TelegramParams = {\n\ttext: string,\n\tsenderCode: string,\n\tsenderId: string,\n\tfrom: string,\n\tclient: Object,\n}\n\nexport class Telegram extends Base\n{\n\tgetDeleteActionMethod(): string\n\t{\n\t\treturn 'crm.timeline.activity.delete';\n\t}\n\n\tgetDeleteActionCfg(recordId: Number, ownerTypeId: Number, ownerId: Number): Object\n\t{\n\t\treturn {\n\t\t\tdata: {\n\t\t\t\tactivityId: recordId,\n\t\t\t\townerTypeId,\n\t\t\t\townerId,\n\t\t\t},\n\t\t};\n\t}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Activity:Telegram:Resend' && Type.isPlainObject(actionData.params))\n\t\t{\n\t\t\tvoid this.#resendTelegram(actionData.params);\n\t\t}\n\t}\n\n\tasync #resendTelegram(params: TelegramParams): Promise<void>\n\t{\n\t\tconst messageParams = {\n\t\t\tbackend: {\n\t\t\t\tsenderCode: params.senderCode,\n\t\t\t\tid: params.senderId,\n\t\t\t},\n\t\t\tfromId: params.from,\n\t\t\tclient: params.client,\n\t\t\ttext: params.text,\n\t\t};\n\n\t\tconst wasResendAvailable = await tryToResendWithMessage(messageParams);\n\t\tif (!wasResendAvailable)\n\t\t{\n\t\t\tconsole.error('BX.Crm.Timeline.Item.Controllers.Telegram: could not resend message via message menubar item');\n\t\t}\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (item.getType() === 'Activity:Telegram');\n\t}\n}\n","import { FileUploaderPopup } from 'crm.activity.file-uploader-popup';\nimport { ajax as Ajax, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Dialog } from 'ui.entity-selector';\nimport { UI } from 'ui.notification';\nimport { SidePanel } from 'ui.sidepanel';\nimport ConfigurableItem from '../configurable-item';\nimport type { ActionParams } from './base';\nimport { Base } from './base';\n\nexport class ToDo extends Base\n{\n\t#responsibleUserSelectorDialog: ?Dialog = null;\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst {action, actionType, actionData} = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'ColorSelector:Change' && actionData)\n\t\t{\n\t\t\tthis.#runUpdateColorAction(item, actionData);\n\t\t}\n\n\t\tif (action === 'EditableDescription:StartEdit')\n\t\t{\n\t\t\titem.highlightContentBlockById('description', true);\n\t\t}\n\n\t\tif (action === 'EditableDescription:FinishEdit')\n\t\t{\n\t\t\titem.highlightContentBlockById('description', false);\n\t\t}\n\n\t\tif (action === 'Activity:ToDo:AddFile' && actionData)\n\t\t{\n\t\t\tthis.#showFileUploaderPopup(item, actionData);\n\t\t}\n\n\t\tif (action === 'Activity:ToDo:ChangeResponsible' && actionData)\n\t\t{\n\t\t\tthis.#showResponsibleUserSelector(item, actionData);\n\t\t}\n\n\t\tif (action === 'Activity:ToDo:Repeat' && actionData)\n\t\t{\n\t\t\tthis.#emitRepeatTodo(item, actionData);\n\t\t}\n\n\t\tif (action === 'Activity:ToDo:Update' && actionData)\n\t\t{\n\t\t\tthis.#emitUpdateTodo(item, actionData);\n\t\t}\n\n\t\tif (action === 'Activity:ToDo:ShowCalendar' && actionData)\n\t\t{\n\t\t\tthis.#showCalendar(item, actionData);\n\t\t}\n\n\t\tif (action === 'Activity:ToDo:Client:Click' && actionData)\n\t\t{\n\t\t\tthis.#openClient(actionData.entityId, actionData.entityTypeId);\n\t\t}\n\n\t\tif (action === 'Activity:ToDo:User:Click' && actionData)\n\t\t{\n\t\t\tthis.#openUser(actionData.userId);\n\t\t}\n\t}\n\n\t#showFileUploaderPopup(item, actionData): void\n\t{\n\t\tconst isValidParams = Type.isNumber(actionData.entityId)\n\t\t\t&& Type.isNumber(actionData.entityTypeId)\n\t\t\t&& Type.isNumber(actionData.ownerId)\n\t\t\t&& Type.isNumber(actionData.ownerTypeId);\n\n\t\tif (!isValidParams)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tactionData.files = actionData.files.split(',').filter(id => Type.isNumber(id));\n\n\t\tconst fileList = item.getLayoutContentBlockById('fileList');\n\t\tif (fileList)\n\t\t{\n\t\t\tfileList.showFileUploaderPopup(actionData);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst popup = new FileUploaderPopup(actionData);\n\t\t\tpopup.show();\n\t\t}\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (item.getType() === 'Activity:ToDo');\n\t}\n\n\t#showResponsibleUserSelector(item, actionData): void\n\t{\n\t\tconst isValidParams = Type.isNumber(actionData.id)\n\t\t\t&& Type.isNumber(actionData.ownerId)\n\t\t\t&& Type.isNumber(actionData.ownerTypeId)\n\t\t\t&& Type.isNumber(actionData.responsibleId)\n\t\t;\n\n\t\tif (!isValidParams)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#responsibleUserSelectorDialog = new Dialog({\n\t\t\tid: 'responsible-user-selector-dialog-' + actionData.id,\n\t\t\ttargetNode: item.getLayoutFooterMenu().$el,\n\t\t\tcontext: 'CRM_ACTIVITY_TODO_RESPONSIBLE_USER',\n\t\t\tmultiple: false,\n\t\t\tdropdownMode: true,\n\t\t\tshowAvatars: true,\n\t\t\tenableSearch: true,\n\t\t\twidth: 450,\n\t\t\tentities: [{\n\t\t\t\tid: 'user',\n\t\t\t}],\n\t\t\tpreselectedItems: [\n\t\t\t\t['user', actionData.responsibleId],\n\t\t\t],\n\t\t\tundeselectedItems: [\n\t\t\t\t['user', actionData.responsibleId],\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': (event: BaseEvent): void => {\n\t\t\t\t\tconst selectedItem = event.getData().item.getDialog().getSelectedItems()[0];\n\t\t\t\t\tif (selectedItem)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#runResponsibleUserAction(actionData.id, actionData.ownerId, actionData.ownerTypeId, selectedItem.getId());\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'Item:onDeselect': (event: BaseEvent): void => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tconst selectedItems = this.#responsibleUserSelectorDialog.getSelectedItems();\n\t\t\t\t\t\tif (selectedItems.length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.#responsibleUserSelectorDialog.hide();\n\t\t\t\t\t\t\tthis.#runResponsibleUserAction(actionData.id, actionData.ownerId, actionData.ownerTypeId, actionData.responsibleId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 100);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tthis.#responsibleUserSelectorDialog.show();\n\t}\n\n\t#emitRepeatTodo(item: Object, actionData: Object): void\n\t{\n\t\tEventEmitter.emit('crm:timeline:todo:repeat', actionData);\n\t}\n\n\t#emitUpdateTodo(item: Object, actionData: Object): void\n\t{\n\t\tEventEmitter.emit('crm:timeline:todo:update', actionData);\n\t}\n\n\t#runUpdateColorAction(item, actionData): void\n\t{\n\t\tconst { id, ownerTypeId, ownerId } = item.getDataPayload();\n\t\tconst { colorId } = actionData;\n\n\t\tconst isValidParams = (\n\t\t\tType.isNumber(id)\n\t\t\t&& Type.isNumber(ownerId)\n\t\t\t&& Type.isNumber(ownerTypeId)\n\t\t\t&& Type.isStringFilled(colorId)\n\t\t);\n\n\t\tif (!isValidParams)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = {\n\t\t\townerTypeId,\n\t\t\townerId,\n\t\t\tid,\n\t\t\tcolorId,\n\t\t};\n\n\t\tAjax\n\t\t\t.runAction('crm.activity.todo.updateColor', { data })\n\t\t\t.catch((response) => {\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t});\n\n\t\t\t\tthrow response;\n\t\t\t});\n\t}\n\n\t#showCalendar(item: Object, actionData: Object): void\n\t{\n\t\tconst { calendarEventId, entryDateFrom, timezoneOffset } = actionData;\n\n\t\tif (!window.top.BX.Calendar)\n\t\t{\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn('BX.Calendar not found');\n\n\t\t\treturn;\n\t\t}\n\n\t\tnew window.top.BX.Calendar.SliderLoader(\n\t\t\tcalendarEventId,\n\t\t\t{\n\t\t\t\tentryDateFrom,\n\t\t\t\ttimezoneOffset,\n\t\t\t\tcalendarContext: null,\n\t\t\t},\n\t\t).show();\n\t}\n\n\t#runResponsibleUserAction(id: Number, ownerId: Number, ownerTypeId: Number, responsibleId: Number): void\n\t{\n\t\tconst data = {\n\t\t\townerTypeId,\n\t\t\townerId,\n\t\t\tid,\n\t\t\tresponsibleId\n\t\t};\n\n\t\tAjax\n\t\t\t.runAction('crm.activity.todo.updateResponsibleUser', { data })\n\t\t\t.catch(response => {\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: response.errors[0].message,\n\t\t\t\t\tautoHideDelay: 5000,\n\t\t\t\t});\n\n\t\t\t\tthrow response;\n\t\t\t});\n\t}\n\n\t#openClient(entityId: Number, entityTypeId: Number): void\n\t{\n\t\tif (SidePanel.Instance)\n\t\t{\n\t\t\tconst entityTypeName = BX.CrmEntityType.resolveName(entityTypeId).toLowerCase();\n\t\t\tconst path = `/crm/${entityTypeName}/details/${entityId}/`;\n\n\t\t\tSidePanel.Instance.open(path);\n\t\t}\n\t}\n\n\t#openUser(userId: Number): void\n\t{\n\t\tif (SidePanel.Instance)\n\t\t{\n\t\t\tconst path = `/company/personal/user/${userId}/`;\n\n\t\t\tSidePanel.Instance.open(path);\n\t\t}\n\t}\n}\n","import { ActionParams, Base } from './base';\nimport ConfigurableItem from '../configurable-item';\n\nexport class Visit extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Activity:Visit:ChangePlayerState' && actionData && actionData.recordId)\n\t\t{\n\t\t\tthis.#changePlayerState(item, actionData.recordId);\n\t\t}\n\n\t\tif (action === 'Activity:Visit:Schedule' && actionData)\n\t\t{\n\t\t\tthis.runScheduleAction(actionData.activityId, actionData.scheduleDate);\n\t\t}\n\t}\n\n\t#changePlayerState(item: ConfigurableItem, recordId: Number): void\n\t{\n\t\tconst player = item.getLayoutContentBlockById('audio');\n\t\tif (!player)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (recordId !== player.id)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (player.state === 'play')\n\t\t{\n\t\t\tplayer.pause();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tplayer.play();\n\t\t}\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (item.getType() === 'Activity:Visit');\n\t}\n}\n","import { Builder, Dictionary } from 'crm.integration.analytics';\nimport type { WhatsAppDeleteEvent as WhatsAppDeleteEventStructure } from 'crm.integration.types';\nimport { Loc, Type } from 'main.core';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport ConfigurableItem from '../configurable-item';\n\nimport { ActionParams, Base } from './base';\nimport { tryToResendWithMessage } from './message/resend';\n\ndeclare type WhatsAppParams = {\n\tsenderCode: string,\n\tsenderId: string,\n\ttemplate: Object,\n\tfrom: string,\n\tclient: Object,\n}\n\nexport class WhatsApp extends Base\n{\n\tgetDeleteActionMethod(): string\n\t{\n\t\treturn 'crm.timeline.activity.delete';\n\t}\n\n\tgetDeleteActionCfg(recordId: Number, ownerTypeId: Number, ownerId: Number): Object\n\t{\n\t\treturn {\n\t\t\tdata: {\n\t\t\t\tactivityId: recordId,\n\t\t\t\townerTypeId,\n\t\t\t\townerId,\n\t\t\t\tanalytics: this.#buildAnalyticsData(),\n\t\t\t},\n\t\t};\n\t}\n\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\n\t\tif (actionType !== 'jsEvent')\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Activity:Whatsapp:Resend' && Type.isPlainObject(actionData.params))\n\t\t{\n\t\t\tvoid this.#resendWhatsApp(actionData.params);\n\t\t}\n\t}\n\n\tasync #resendWhatsApp(params: WhatsAppParams): Promise<void>\n\t{\n\t\tconst messageParams = {\n\t\t\tbackend: {\n\t\t\t\tsenderCode: params.senderCode,\n\t\t\t\tid: params.senderId,\n\t\t\t},\n\t\t\tfromId: params.from,\n\t\t\tclient: params.client,\n\t\t\ttemplate: params.template,\n\t\t};\n\n\t\tif (await tryToResendWithMessage(messageParams))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuBar = BX.Crm?.Timeline?.MenuBar?.getDefault();\n\t\tif (!menuBar)\n\t\t{\n\t\t\tthrow new Error('\"BX.Crm?.Timeline.MenuBar\" component not found');\n\t\t}\n\n\t\tconst whatsAppItem = menuBar.getItemById('whatsapp');\n\t\tif (!whatsAppItem)\n\t\t{\n\t\t\tthrow new Error('\"BX.Crm.Timeline.MenuBar.WhatsApp\" component not found');\n\t\t}\n\n\t\tconst goToEditor = (): void => {\n\t\t\tmenuBar.scrollIntoView();\n\t\t\tmenuBar.setActiveItemById('whatsapp');\n\t\t\twhatsAppItem.tryToResend(params.template, params.from, params.client);\n\t\t};\n\n\t\tconst templateId = params.template?.ORIGINAL_ID;\n\t\tconst filledPlaceholders = params.template?.FILLED_PLACEHOLDERS ?? [];\n\n\t\tconst currentTemplateId = whatsAppItem.getTemplate()?.ORIGINAL_ID;\n\t\tconst currentFilledPlaceholders = whatsAppItem.getTemplate()?.FILLED_PLACEHOLDERS ?? [];\n\n\t\tif (\n\t\t\tType.isNumber(templateId) && templateId > 0\n\t\t\t&& Type.isNumber(currentTemplateId) && currentTemplateId > 0\n\t\t\t&& (\n\t\t\t\ttemplateId !== currentTemplateId\n\t\t\t\t|| JSON.stringify(filledPlaceholders) !== JSON.stringify(currentFilledPlaceholders)\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tMessageBox.show({\n\t\t\t\tmodal: true,\n\t\t\t\ttitle: Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_WHATSAPP_RESEND_CONFIRM_DIALOG_TITLE'),\n\t\t\t\tmessage: Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_WHATSAPP_RESEND_CONFIRM_DIALOG_MESSAGE'),\n\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\tokCaption: Loc.getMessage('CRM_TIMELINE_ITEM_ACTIVITY_SMS_RESEND_CONFIRM_DIALOG_OK_BTN'),\n\t\t\t\tonOk: (messageBox) => {\n\t\t\t\t\tmessageBox.close();\n\t\t\t\t\tgoToEditor();\n\t\t\t\t},\n\t\t\t\tonCancel: (messageBox) => messageBox.close(),\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tgoToEditor();\n\t\t}\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (item.getType() === 'Activity:Whatsapp');\n\t}\n\n\t#buildAnalyticsData(ownerTypeId: number): ?WhatsAppDeleteEventStructure\n\t{\n\t\treturn Builder.Communication.DeleteEvent.createDefault(ownerTypeId)\n\t\t\t.setElement(Dictionary.ELEMENT_WA_MESSAGE_DELETE)\n\t\t\t.buildData();\n\t}\n}\n","import { Loc, Text, Type } from 'main.core';\nimport { UI } from 'ui.notification';\n\nimport { ActionParams, Base } from './base';\nimport ConfigurableItem from '../configurable-item';\n\nconst DOWNLOAD_DELAY = 300;\n\nexport class Zoom extends Base\n{\n\tonItemAction(item: ConfigurableItem, actionParams: ActionParams): void\n\t{\n\t\tconst { action, actionType, actionData } = actionParams;\n\n\t\tif (actionType !== 'jsEvent' || !actionData)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'Activity:Zoom:CopyInviteUrl')\n\t\t{\n\t\t\tthis.#copyToClipboard(actionData.url);\n\t\t}\n\n\t\tif (action === 'Activity:Zoom:Schedule')\n\t\t{\n\t\t\tthis.runScheduleAction(actionData.activityId, actionData.scheduleDate);\n\t\t}\n\n\t\tif (action === 'Activity:Zoom:CopyPassword')\n\t\t{\n\t\t\tthis.#copyToClipboard(actionData.password);\n\t\t}\n\n\t\tif (action === 'Activity:Zoom:DownloadAllRecords' && Type.isArray(actionData.urlList))\n\t\t{\n\t\t\tthis.#downloadAllRecords(actionData.urlList);\n\t\t}\n\t}\n\n\t#copyToClipboard(input: String): void\n\t{\n\t\tif (Type.isStringFilled(input))\n\t\t{\n\t\t\tconst isSuccess = BX.clipboard.copy(input);\n\t\t\tif (isSuccess)\n\t\t\t{\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('CRM_COMMON_ACTION_COPY_TO_CLIPBOARD_SUCCESS'),\n\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t#downloadAllRecords(urlList: Array): void\n\t{\n\t\tconst download = (urls: Array) => {\n\t\t\tconst url = urls.pop();\n\t\t\tconst a = document.createElement('a');\n\t\t\ta.setAttribute('href', url);\n\t\t\tif ('download' in a)\n\t\t\t{\n\t\t\t\ta.setAttribute('download', `zoom_record_file_${Text.getRandom(5)}.m4a`);\n\t\t\t}\n\t\t\ta.setAttribute('target', '_blank');\n\t\t\ta.click();\n\n\t\t\tif (urls.length === 0)\n\t\t\t{\n\t\t\t\tclearInterval(interval);\n\t\t\t}\n\t\t};\n\t\tconst interval = setInterval(download, DOWNLOAD_DELAY, urlList);\n\t}\n\n\tstatic isItemSupported(item: ConfigurableItem): boolean\n\t{\n\t\treturn (item.getType() === 'Activity:Zoom');\n\t}\n}\n","import ControllerManager from './controller-manager';\n\nimport { Activity } from './controllers/activity';\nimport { CallScoringResult } from './controllers/ai/call-scoring-result';\nimport { CallTranscriptResult } from './controllers/ai/call-transcript-result';\nimport { EntityFieldsFillingResult } from './controllers/ai/entity-fields-filling-result';\nimport { TranscriptSummaryResult } from './controllers/ai/transcript-summary-result';\nimport { Bizproc } from './controllers/bizproc/bizproc';\nimport { Booking } from './controllers/booking/booking';\nimport { WaitListItem } from './controllers/booking/wait-list-item';\nimport { Sharing } from './controllers/calendar/sharing';\nimport { Call } from './controllers/call';\nimport { Comment } from './controllers/comment';\nimport { CommonContentBlocks } from './controllers/common-content-blocks';\nimport { DealProductList } from './controllers/deal-product-list';\nimport { Delivery } from './controllers/delivery';\nimport { Document } from './controllers/document';\nimport { Email } from './controllers/email';\nimport { FinalSummary } from './controllers/finalsummary';\nimport { Helpdesk } from './controllers/helpdesk';\nimport { Modification } from './controllers/modification';\nimport { Notification } from './controllers/notification';\nimport { OpenLines } from './controllers/openlines';\nimport { OrderCheck } from './controllers/order-check';\nimport { Payment } from './controllers/payment';\nimport { RepeatSale } from './controllers/repeat-sale';\nimport { RestApp } from './controllers/rest-app';\nimport { SalescenterApp } from './controllers/salescenter-app';\nimport { SignB2eDocument } from './controllers/sign-b2e-document';\nimport { SignDocument } from './controllers/sign-document';\nimport { Sms } from './controllers/sms';\nimport { Task } from './controllers/task';\nimport { Telegram } from './controllers/telegram';\nimport { ToDo } from './controllers/todo';\nimport { Visit } from './controllers/visit';\nimport { WhatsApp } from './controllers/whatsapp';\nimport { Zoom } from './controllers/zoom';\n\nControllerManager.registerController(Activity);\nControllerManager.registerController(CommonContentBlocks);\nControllerManager.registerController(OpenLines);\nControllerManager.registerController(Modification);\nControllerManager.registerController(SignDocument);\nControllerManager.registerController(Document);\nControllerManager.registerController(Call);\nControllerManager.registerController(ToDo);\nControllerManager.registerController(Helpdesk);\nControllerManager.registerController(Payment);\nControllerManager.registerController(DealProductList);\nControllerManager.registerController(Email);\nControllerManager.registerController(OrderCheck);\nControllerManager.registerController(FinalSummary);\nControllerManager.registerController(SalescenterApp);\nControllerManager.registerController(Delivery);\nControllerManager.registerController(RestApp);\nControllerManager.registerController(Comment);\nControllerManager.registerController(Sharing);\nControllerManager.registerController(Task);\nControllerManager.registerController(CallTranscriptResult);\nControllerManager.registerController(TranscriptSummaryResult);\nControllerManager.registerController(EntityFieldsFillingResult);\nControllerManager.registerController(CallScoringResult);\nControllerManager.registerController(SignB2eDocument);\nControllerManager.registerController(Visit);\nControllerManager.registerController(Zoom);\nControllerManager.registerController(Sms);\nControllerManager.registerController(WhatsApp);\nControllerManager.registerController(Telegram);\nControllerManager.registerController(Notification);\nControllerManager.registerController(Bizproc);\nControllerManager.registerController(Booking);\nControllerManager.registerController(WaitListItem);\nControllerManager.registerController(RepeatSale);\n"],"names":["StreamType","history","scheduled","pinned","Menu","vueComponent","menuItems","menuOptions","angle","cacheable","items","item","push","createMenuItem","MenuManager","show","Object","prototype","hasOwnProperty","call","delimiter","text","title","result","value","icon","className","menu","subItem","values","action","type","href","onclick","onMenuItemClick","getCurrentMenu","close","Action","execute","AnimationTarget","block","AnimationType","disable","loader","ActionType","JS_EVENT","AJAX_ACTION","STARTED","FINISHED","FAILED","isJsEvent","isAjaxAction","freeze","params","_classPrivateFieldInitSpec","actionParams","Type","isPlainObject","animation","analytics","Promise","resolve","reject","$Bitrix","eventEmitter","emit","actionType","actionData","animationCallbacks","onStart","bind","onStop","isJsCode","eval","isAjaxJsonAction","ajaxConfig","Ajax","runAction","then","response","UI","Notification","Center","notify","content","errors","message","autoHideDelay","isCallRestBatch","Rest","callBatch","restResult","answer","error","error_description","isRedirect","linkAttrs","target","link","Dom","create","attrs","style","display","append","document","body","click","setTimeout","remove","isShowMenu","showMenu","id","bindElement","$el","minWidth","offsetWidth","isShowInfoHelper","BX","InfoHelper","param","isUndefined","paramName","paramValue","isDate","DateTimeFormat","format","DatetimeConverter","getSiteDateTimeFormat","method","filter","state","scope","isReadOnly","hideIfReadonly","sort","a","b","$root","setFaded","showLoader","isFunction","setDisabled","setLoading","force","forever","hit","clonedAnalytics","sendData","Logo","props","String","addIcon","addIconType","iconType","backgroundUrl","backgroundSize","Number","inCircle","Boolean","required","default","data","currentIcon","computed","iconClassname","addIconClassname","iconInteriorStyle","backgroundImage","encodeURI","Text","encode","parseInt","watch","newIcon","methods","executeAction","setIcon","template","CalendarIcon","timestamp","calendarEventId","date","formatUserTime","month","dayWeek","dayShortName","time","length","slice","getDateTimeConverter","toTimeString","userTime","getValue","hasCalendarEventId","createFromServerTimestamp","toUserTime","LogoCalendar","BitrixVue","cloneComponent","components","backgroundColor","logoStyle","isStringFilled","Body","logo","blocks","blockRefs","mounted","$refs","visibleBlocks","forEach","index","isDomNode","setAttribute","Error","rendererName","beforeUpdate","keys","map","aSort","undefined","bSort","contentContainerClassname","getContentBlockById","blockId","getLogo","saveRef","ref","ButtonScope","ButtonState","ButtonType","BaseButton","tooltip","DEFAULT","currentState","itemStateToButtonStateDict","LOADING","UIButton","State","WAITING","DISABLED","AI_LOADING","AI_WAITING","disabled","setButtonState","loading","onLayoutUpdated","created","subscribe","beforeUnmount","unsubscribe","ButtonMenu","_classPrivateMethodInitSpec","_classPrivateMethodGet","AI_SUCCESS","LOCKED","isObject","getMenuItems","emptyClassItems","Button","SECONDARY","iconName","size","popup","uiButton","timerSecondsRemaining","hintText","itemTypeToButtonColorDict","PRIMARY","Color","LIGHT_BORDER","LIGHT","ICON","LINK","AI","buttonContainerRef","buttonContainer","getButtonOptions","upperCaseIconName","isString","toUpperCase","upperCaseButtonSize","btnColor","titleText","round","dependOnTheme","Size","color","Icon","getUiButton","disableWithTimer","sec","btn","remainingSeconds","setText","formatSeconds","timer","setInterval","clearInterval","minutes","Math","floor","seconds","formatMinutes","formatNumber","num","parentSetButtonState","setState","createSplitButton","key","options","width","offsetLeft","querySelector","menuButton","element","event","stopPropagation","UIButtonState","mainButton","UISplitButton","renderButton","innerHTML","button","renderTo","setTooltip","showTooltip","Hint","hideTooltip","hide","isInViewport","rect","getBoundingClientRect","top","left","bottom","window","innerHeight","documentElement","clientHeight","right","innerWidth","clientWidth","isPropEqual","propName","newValue","updated","AdditionalButtonIcon","NOTE","SCRIPT","PRINT","DOTS","AdditionalButtonColor","AdditionalButton","validator","indexOf","loaderHtml","Loader","mode","layout","outerHTML","Buttons","Array","getButtonById","buttonId","buttons","reduce","found","MenuId","inject","isMenuFilled","itemsArray","buttonProps","getMenuById","destroy","LayoutMenu","Footer","additionalButtons","maxBaseButtonsCount","containerClassname","baseButtons","visibleAndSortedButtons","moreButtons","visibleButtons","buttonsSorter","visibleAndSortedAdditionalButtons","visibleAdditionalButtons","visibleButtonsFilter","additionalButtonsArray","entries","hasMenu","buttonItem","HIDDEN","MOBILE","buttonA","buttonB","foundButton","getMenu","ChangeStreamButton","disableIfReadonly","isReadonlyMode","isComplete","isShowPinButton","isShowUnpinButton","catch","onClick","isReadonly","markCheckboxUnchecked","ColorSelector","directives","hint","valuesList","selectedValueId","readOnlyMode","currentValueId","setValue","itemSelector","onItemSelectorValueChange","valueId","emitEvent","colorId","eventName","$nextTick","ColorSelectorPopup","itemSelectorRef","colorList","selectedColorId","EventEmitter","ColorSelectorEvents","EVENT_COLORSELECTOR_VALUE_CHANGE","Loc","getMessage","popupOptions","offset","position","offsetTop","FormatDate","name","datePlaceholder","useShortTimeFormat","class","formattedDate","converter","toDatetimeString","isMouseOnHintArea","hintPopup","textBlocks","hintContentIcon","iconElement","classname","hintContentIconClassname","children","hintContentText","hintContentTextBlocks","getContentBlockNode","baseClassname","hintIconClassname","hasContent","getHintContent","getPopupOptions","darkMode","autoHide","maxWidth","bindOptions","getPopupPosition","hintElem","defaultAngleLeftOffset","Popup","getOption","hintWidth","hintLeftOffset","hintTopOffset","getPosition","popupWidth","getPopupContainer","getPopupAngleOffset","popupContainer","angleWidth","onMouseEnterToPopup","onHintAreaMouseLeave","hideHintPopup","onMouseEnterToHint","showHintPopupWithDebounce","showHintPopup","isShown","Event","setBindElement","setAngle","adjustPosition","Runtime","debounce","unbind","hideHintPopupWithDebounce","contentBlock","getTextNode","getLinkNode","textOptions","linkOptions","addClass","actionObj","TagType","Tag","tagTypeToLabelColorDict","Label","LIGHT_BLUE","LAVENDER","SUCCESS","LIGHT_GREEN","WARNING","LIGHT_YELLOW","FAILURE","LIGHT_RED","tagContainerRef","tag","getLabelColorFromTagType","tagType","lowerCaseTagType","toLowerCase","labelColor","renderTag","tagOptions","uppercaseTitle","label","fill","clean","render","Title","isLogMessage","User","detailUrl","imageUrl","styles","Header","titleAction","changeStreamButton","tags","user","infoHelper","colorSettings","visibleTags","isVisibleTagFilter","visibleAndAscSortedTags","tagsCopy","clone","tagsAscSorter","isShowDate","tagA","tagB","getChangeStreamButton","$watch","newColorSettings","colorSelector","deep","IconBackgroundColor","code","counterType","backgroundColorToken","backgroundUri","counterNodeContainer","counter","iconStyle","renderCounter","Counter","border","newCounterType","MarketPanel","detailsText","detailsTextAction","needShowDetailsText","UserPick","Item","initialLayout","currentUser","onAction","Function","initialColor","streamType","isFaded","provide","onActionEvent","eventData","getData","setLayout","newLayout","setColor","newColor","faded","parentNode","getHeaderChangeStreamButton","header","getFooterButtonById","footer","getFooterMenu","highlightContentBlockById","isHighlighted","removeClass","timelineCardClassname","timelineCardStyle","itemBackground","ControllerManager","foundControllers","controller","getRegisteredControllers","isItemSupported","controllerInstance","onInitialize","timelineId","Base","recordId","ownerTypeId","ownerId","getDeleteActionMethod","getDeleteActionCfg","activityId","scheduleDate","description","menuBar","Crm","Timeline","MenuBar","getDefault","setActiveItemById","scrollIntoView","todoEditor","getItemById","focus","setParentActivityId","setDeadLine","setDescription","_id","_isTerminated","_wrapper","isNotEmptyString","util","getRandomString","anchor","previousSibling","clearLayout","wrapper","timeout","isNumber","removeWrapperClass","addWrapperClass","terminated","Layout","menuItem","ConfigurableItem","settings","_setId","setContainer","container","itemClassName","setData","getInstance","getItemControllers","payload","setWrapper","initLayoutApp","needBindToContainer","bindTo","getBindToNode","insertBefore","getWrapper","nextSibling","onAfterItemLayout","prop","getBoolean","isElementNode","getColor","getLayout","asPlainObject","onAfterItemRefreshLayout","useAnchorNextSibling","onBeforeItemClearLayout","unmount","Date","now","extractDate","getId","isInteger","toInteger","replace","getContainer","forceRefreshLayout","historyIds","activityIds","ajax","refreshLayout","err","console","self","initialize","TimelineItem","isBoolean","createApp","contentBlockComponents","componentName","component","mount","getCurrentUser","onItemAction","assign","getContentBlockComponents","ALLOWED_MOVE_TO_ITEM_TYPES","Activity","deleteTagActionCfg","getDeleteTagActionMethod","confirmationText","MessageBox","modal","MessageBoxButtons","YES_NO","onYes","runDeleteAction","onNo","messageBox","YES_CANCEL","yesCaption","runDeleteTagAction","onCancel","itemType","getType","editor","viewActivity","editActivity","itemElement","includes","warn","isValidParams","TypeError","getLayoutFooterMenu","ReferenceError","CrmActivityEditor","dialogTargetElement","dialogEntityId","CrmEntityType","resolveName","isDynamicTypeByTypeId","names","dynamic","applyButton","ApplyButton","useAirDesign","AirButtonStyle","FILLED","ButtonSize","MEDIUM","targetItem","cancelButton","CancelButton","OUTLINE","deselectAll","createAndApplyButton","canAddItems","Dialog","targetNode","enableSearch","context","tagSelectorOptions","textBoxWidth","entities","dynamicLoad","dynamicSearch","categoryId","showEntityTypeNameInHeader","hideClosedItems","excludeMyCompany","entityTypeId","events","preventDefault","getSelectedItems","row","getEntityId","deselect","footerOptions","containerStyles","gap","background","height","padding","newItemUrl","Router","Instance","getItemDetailUrl","CreateButton","PLAIN","runMoveActionForNewItem","Page","openSlider","onOpen","slider","EntityEvent","onClose","newItemEntityEditor","getWindow","EntityEditor","isNil","isItemCreatedInCurrentSlider","entityId","sourceEntityTypeId","sourceEntityId","targetEntityTypeId","resolveId","targetEntityId","getMoveActionMethod","activityLabel","filterId","filterManager","Main","getById","filterApi","getApi","fields","ACTIVITY","ACTIVITY_label","extendFilter","CrmTimelineManager","getHistory","showFilter","CallScoringResult","loadExtension","callQualityDlg","Call","CallQuality","activityCreated","clientDetailUrl","clientFullName","userPhotoUrl","jobId","open","assessmentSettingId","CallTranscriptResult","transcription","Transcription","languageTitle","EntityFieldsFillingResult","operationStatus","mergeUuid","exports","createAiFormFillApplicationInsideSlider","Done","start","mergeId","status","showSendFeedbackPopup","activityDirection","finally","TranscriptSummaryResult","summary","Summary","activityProvider","ICON_COLORS","lightGrey","blue","lightGreen","steps","isArrayFilled","stack","controlWrapper","ImageStackSteps","convertIconColors","step","updateStep","unmounted","getStyles","colors","images","image","imageTypeEnum","TaskUserStatus","YES","NO","OK","CANCEL","Bizproc","AvatarsStackSteps","actionHandlers","handler","supportedItemTypes","responsibleId","userId","workflowId","openWorkflowLog","openWorkflow","taskId","openWorkflowTask","callback","e","Workflow","getLayoutFooterButtonById","taskRequest","showCyclePopup","CyclePopup","scrollToCard","not_confirmed","CardId","Unconfirmed","confirmed","Confirmed","success","late","Late","failed","waitlist","Waitlist","overbooking","Overbooking","cyclePopupOpener","Booking","url","SidePanel","customLeftBoundary","WaitListItem","moreLinkRef","listItems","moreLink","openPopup","properties","formattedRules","createItemText","firstFormattedRule","doShowMoreLink","formattedDuration","durationFormatted","weekdaysFormatted","rule","from","to","Util","parseDate","getTime","formatTime","getPopupContent","closeByEsc","root","Sharing","members","dialogQr","DialogQr","sharingUrl","isSuccess","clipboard","copy","SharingSlotsList","openCalendarEventSlider","eventId","isSharing","responseWithError","chatId","BXIM","openMessenger","moreButton","existingPopup","PopupManager","getPopupById","maxHeight","member","html","SHOW_URL","FORMATTED_NAME","PHOTO_URL","COPILOT_BUTTON_DISABLE_DELAY","COPILOT_HELPDESK_CODE","CopilotBase","getCopilotConfig","isCopilotAgreementNeedShow","OK_CANCEL","okCaption","onOk","CopilotAgreement","copilotAgreementPopup","moduleId","contextId","agreementContext","onAccept","isAgreementAccepted","checkAgreement","aiCopilotBtn","aiCopilotBtnUI","prevState","getState","onPreLaunch","onPostLaunch","validEntityTypes","actionEndpoint","getAdditionalRequestData","btnUI","customData","ACTIVE","onError","showCopilotBanner","showMarketMessageBox","sliderCode","msg","msgPlainText","msgHtml","isCopilotBannerNeedShow","supportsCopilotBanner","ServiceWidget","Analytics","serviceWidget","getInstanceByCode","CONTEXT_CRM","getPopup","forceTop","useInfoHelper","FeaturePromotersRegistry","getPromoter","Helper","Feedback","Form","forms","zones","lang","hasOwn","isAiMarketplaceAppsExist","COPILOT_BUTTON_NUMBER_OF_MANUAL_STARTS_WITHOUT_BOOST_LIMIT","COPILOT_BUTTON_NUMBER_OF_MANUAL_STARTS_WITH_BOOST_LIMIT","FULL_SCENARIO","FILL_FIELDS_SCENARIO","CALL_SCORING_SCENARIO","runScheduleAction","callId","handleCopilotLaunch","enumeration","lead","deal","handlePostLaunch","numberOfManualStarts","isValidScenario","scenario","AppsInstallerBanner","AppsInstallerBannerEvents","portalZone","copilotBannerOptions","isWestZone","copilotBanner","actionStart","info","actionFinishSuccess","Engine","setBannerLaunched","actionFinishFailed","phone","ENTITY_TYPE_NAME","ENTITY_ID","AUTO_FOLD","BINDINGS","OWNER_TYPE_NAME","OWNER_ID","SRC_ACTIVITY_ID","phoneTo","Voximplant","Transcript","player","getLayoutContentBlockById","pause","play","location","callScoring","assessmentSettingsId","getDataPayload","aiCopilotUIBtn","showCopilotTourOnScroll","initiator","delay","isWelcomeTourEnabled","isWelcomeTourAutomaticallyEnabled","isWelcomeTourManuallyEnabled","stepId","Comment","commentBlock","startEditing","commentId","addressFormatted","renderAddressWidget","Extension","getSettings","hasLocationModule","widgetFactory","Location","Widget","Factory","Format","JSON","parse","address","Address","languageId","setFieldValue","fieldForUnRecognized","addressWidget","createAddressWidget","ControlMode","view","addressWidgetParams","mapBindElement","ClientMark","mark","ClientMarkType","POSITIVE","NEUTRAL","NEGATIVE","EditableDescriptionHeight","EditableDescriptionBackgroundColor","EditableDescriptionAiStatus","renderLottieAnimation","mainAnimation","Lottie","loadAnimation","path","getAnimationPath","lottie","renderer","loop","autoplay","setSpeed","NONE","IN_PROGRESS","isAnimated","EditableDescription","CopilotHeader","TextEditorComponent","HtmlFormatterComponent","headerText","saveAction","editable","copied","SHORT","copilotStatus","copilotSettings","beforeCreate","textEditor","isEdit","isSaving","isLongText","isCollapsed","bbcode","isContentEmpty","trim","currentCopilotStatus","currentHeaderText","heightClassnameModifier","bgColorClassnameModifier","textClassName","LONG","YELLOW","WHITE","isEditable","isCopied","saveTextButtonProps","saveTextButtonState","cancelEditingButtonProps","expandButtonText","isEditButtonVisible","getTextEditor","defaultSelection","adjustHeight","elem","scrollHeight","saveText","encodedTrimText","getText","executeSaveAction","checkIsLongText","actionDescription","cancelEditing","clearText","clear","copyText","selection","getSelection","removeAllRanges","range","createRange","referenceNode","selectNodeContents","addRange","execCommand","getRandom","copyTextBtn","onAfterPopupShow","toggleIsCollapsed","textBlock","textBlockMaxHeightStyle","getComputedStyle","getPropertyValue","textBlockMaxHeight","parseFloat","parentComputedStyles","rootElement","parentHeight","offsetHeight","paddingTop","paddingBottom","BasicEditor","removePlugins","paragraphPlaceholder","toolbar","floatingToolbar","visualOptions","colorBackground","borderWidth","blockSpaceInline","blockSpaceStack","copilot","copilotOptions","triggerBySpace","onMetaEnter","onEscape","onEmptyContentToggle","isEmpty","getHeaderText","setHeaderText","setCopilotStatus","newTextValue","newStatus","newHeaderText","requestAnimationFrame","behavior","setEditable","TYPE_LOAD_FILES_BLOCK","TYPE_LOAD_TEXT_CONTENT","filesCount","hasInlineFiles","loadAction","parentData","oldValue","isTextLoaded","isTextChanged","isMoving","isFilesBlockDisplayed","filesHtmlBlock","textWrapperClassName","files","registerImages","LazyLoad","showImages","parentToggleIsCollapsed","executeLoadAction","rootWrapperElement","saveContent","isSaveDisabled","getContent","htmlContent","getHtmlContent","attachmentList","getAttachments","attachmentAllowEditOptions","getAttachmentsAllowEditOptions","COMMENT","ATTACHMENTS","CRM_TIMELINE_DISK_ATTACHED_OBJECT_ALLOW_EDIT","node","idsList","commentImages","querySelectorAll","commentImagesLength","i","dataSrcName","createEditor","CommentEditor","setIsMoving","flag","setIsFilesBlockDisplayed","TextColor","TextWeight","TextSize","TextDecoration","weight","multiline","decoration","colorClassname","weightClassname","sizeClassname","decorationClassname","upperCaseColorProp","upperCaseWeightProp","NORMAL","upperCaseSizeProp","SM","upperCaseDecorationProp","encodedText","withTime","duration","extends","getFormattedDate","datetimeConverter","getDatetimeConverter","toFormatString","withDayOfWeek","withFullMonth","toDateString","getDatetimeConverterWithDuration","CoreTextHelper","converterWithDuration","DatePillColor","PillStyle","INLINE_GROUP","styleValue","currentTimestamp","initialTimestamp","isPillReadonly","currentDateInSiteFormat","getSiteDateFormat","calendarParams","bTime","bHideTime","bSetFocus","newDate","openCalendar","calendar","callback_after","Timezone","UserTime","toUTCTimestamp","valueTs","$emit","bold","rowLimit","getActionParam","colorClassName","boldClassName","decorationClassName","rowLimitClassName","iconClassName","rowLimitStyle","Link","currentDate","initialDate","actionTimeoutId","currentDateObject","textProps","cancelScheduledActionExecution","scheduleActionExecution","clearTimeout","currentValue","initialValue","$props","enableEdit","input","disableEdit","LogoType","TimelineAudio","AudioPlayer","getComponent","changeLogoIcon","$parent","audioEventRouterWrapper","audioEventRouter","CALL_AUDIO_PAUSE","CALL_AUDIO_PLAY","attributes","hasAudioPlayer","fileExtension","split","titleFirstPart","titleLastPartSize","titleLastPart","fileIcon","FileIcon","FileList","File","BIcon","numberOfFiles","updateParams","visibleFilesNumber","visibleFilesAmount","visibleFiles","editFilesBtnClassname","expandFileListBtnTitle","isAllFilesVisible","editFilesBtnIcon","Set","PENCIL_40","addVisibleFilesBtnIcon","CHEVRON_DOWN","isShowExpandFileListBtn","expandBtnIconClassname","fileProps","file","viewUrl","showFileUploaderPopup","FileUploaderPopup","handleShowFilesBtnClick","collapseFileList","expandFileList","InfoGroup","SAVE_OFFSETS_REQUEST_DELAY","compactMode","toString","ItemSelector","selectedValues","Events","EVENT_ITEMSELECTOR_VALUE_CHANGE","isShowDelimiter","isLastElement","getLastElement","lastKey","formattedDelimiter","addAlignRightClass","parentElement","classList","add","opportunity","currencyId","CurrencyCore","currencyFormat","MoneyPill","moneyHtml","Note","deleteConfirmationText","saveNoteAction","deleteNoteAction","updatedBy","note","oldNote","isExist","isDeleting","shortNoteLength","noteText","shortNote","getNoteLineBreaksCount","currentLineBreakerCount","letterIndex","letter","maxLineBreakerCount","expandNoteBtnText","isDeleteButtonVisible","saveButtonState","cancelButtonState","isNoteVisible","isShowExpandBtn","toggleNoteLength","textarea","setEditMode","editMode","onEnterHandle","ctrlKey","Browser","isMac","metaKey","altKey","saveNote","deleteNote","executeDeleteAction","actionObject","handleWindowResize","windowWidth","destroyed","PlayerAlert","LineOfTextBlocks","AlertColor","AlertIcon","RestAppLayoutBlocks","itemTypeId","itemId","restAppInfo","clientId","contentBlocks","restAppTitle","SmsMessage","messageHtml","htmlspecialchars","STATE_LOADING","STATE_PROCESSED","STATE_UNPROCESSED","CallScoringPill","renderValue","CallScoring","userName","userAvatarUrl","scoringData","assessment","ASSESSMENT","highBorder","HIGH_BORDER","lowBorder","LOW_BORDER","assessmentScriptClassName","isContentReadonly","assessmentPillClassName","renderUserAvatarElement","AvatarRoundGuest","userpicPath","baseColor","borderColor","DeadlineAndPingSelectorBackgroundColor","isScheduled","deadlineBlock","pingSelectorBlock","deadlineBlockTitle","backgroundToken","deadlineBlockData","pingSelectorBlockData","ORANGE","GRAY","deadlineBlockStyle","onDeadlineChange","deadline","setDeadline","deadlineData","initPingSelector","pingSelector","PingSelectorEvents","EVENT_PINGSELECTOR_VALUE_CHANGE","deadlineDate","createDateFromDeadline","deadlineTime","currentTime","PingSelector","getDate","inline","wordWrap","fixedWidth","titleBottomPadding","valueClassName","isTitleCropped","titleElem","scrollWidth","attr","formattedAverageDuration","formattedExecutionTime","averageDuration","efficiency","executionTime","processTimeText","workflowResult","author","efficiencyCaption","notice","hasResult","workflowResultHtml","WorkflowResultStatus","NO_RIGHTS_RESULT","averageDurationText","resultCaption","userResult","userLink","textContent","fullName","USER_RESULT","showHint","DurationFormatter","formatTimeInterval","resultBlock","hintAnchor","init","ErrorType","ErrorBlock","closable","isClosable","encodedTitle","encodedDescription","closeBlock","blockEl","CommonContentBlocks","AddressBlock","TextBlock","LinkBlock","LineOfTextBlocksButton","DateBlock","WithTitle","Money","EditableText","EditableDate","DatePill","CommentContent","DeadlineAndPingSelector","WorkflowEfficiency","tabId","onCustomEvent","isSelected","showDummyImage","bottomBlock","ListItemButton","imageStyle","showMoreEnabled","showMoreCnt","showMoreText","isShortList","shortListItemsCnt","ListItem","showMore","isItemVisible","isShowMoreVisible","DealProductList","ExpandableList","reloadFromServer","tapController","getProductList","productId","Delivery","phoneNumber","canUserPerformCalls","shipmentIds","PULL","command","some","FIELDS","ID","extendWatch","deliveryServiceIds","deliveryRequest","needCheckRequestStatus","isProcessed","dataPayload","isArray","ACTION_NAMESPACE","Document","itemsToPrint","_classStaticPrivateFieldSpecGet","candidate","extra","isPrintEvent","printUrl","remainingItem","documentId","publicUrl","pdfUrl","docxUrl","infoHelperCode","openDocumentSlider","alert","analyticsLabel","DocumentTitle","newTitle","valueInSiteFormat","DocumentCreateTime","newCreateDate","SMART_DOCUMENT","wizardUri","Uri","setQueryParams","docId","noRedirect","convertDealAndStartSign","usePrevious","TITLE","INITIATOR","PopupWindow","zIndex","closeIcon","overlay","onPopupClose","titleBar","contactBlocks","Email","ContactList","emailActivity","CrmActivityEmail","openDialog","CrmDialogMode","threadId","EcommerceDocumentsList","isWithOrdersMode","summaryOptions","timelineSummaryDocuments","TimelineSummaryDocuments","setOptions","appendChild","startSalescenterApplication","orderId","loadExt","Salescenter","Manager","openApplication","FinalSummary","Helpdesk","articleCode","iconCode","pillText","Modification","ValueChange","ValueChangeItem","isSms","getLayoutComponent","showTourOnScroll","isIncoming","OpenLines","ChatMessage","dialogId","openMessengerSlider","RECENT","MENU","getLayoutHeaderChangeStreamButton","summarizeTranscriptionList","dataId","menuTarget","reverse","ActivityProvider","openLine","OrderCheck","checkUrl","checkId","Payment","paymentId","control","getControlByIdRecursive","paymentDocumentsControl","getPaymentDocumentsControl","_createRealizationSlider","RepeatSale","segmentId","handlePreLaunch","handleError","descriptionBlock","errorBlock","featureId","openRepeatSaleSegmentSlider","section","RestApp","openAppParams","appId","restAppId","rest","AppLayout","bx24_label","SalescenterApp","disableSendButton","templateMode","shipmentId","featureResolver","api","Api","FeatureResolver","instance","SignB2eDocument","processUri","documentHash","documentUid","released","recipientHash","entryId","signingCancelationDialog","setButtons","DANGER","uid","preparePost","headers","log","chatType","createDocumentChat","Messenger","openChat","memberHash","filename","downloadLink","createElement","removeChild","modifyDateSignUntil","SignDocument","openSignDocumentSlider","openSignDocumentModifySlider","activityDeadline","tryToResendWithMessage","messageItem","shouldConfirmStateChange","isCancelled","confirmStateChange","tryToResend","Sms","messageParams","backend","senderCode","senderId","fromId","client","smsItem","goToEditor","templateId","getSendData","Task","ping","changeDeadline","edit","delete","viewResult","DEADLINE","toISOString","skipTimeZoneOffset","Dialogs","resultId","Telegram","wasResendAvailable","ToDo","fileList","multiple","dropdownMode","showAvatars","preselectedItems","undeselectedItems","selectedItem","getDialog","selectedItems","entryDateFrom","timezoneOffset","Calendar","SliderLoader","calendarContext","entityTypeName","Visit","WhatsApp","whatsAppItem","ORIGINAL_ID","filledPlaceholders","FILLED_PLACEHOLDERS","currentTemplateId","getTemplate","currentFilledPlaceholders","stringify","Builder","Communication","DeleteEvent","createDefault","setElement","Dictionary","ELEMENT_WA_MESSAGE_DELETE","buildData","DOWNLOAD_DELAY","Zoom","password","urlList","download","urls","pop","interval","registerController"],"mappings":"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"}