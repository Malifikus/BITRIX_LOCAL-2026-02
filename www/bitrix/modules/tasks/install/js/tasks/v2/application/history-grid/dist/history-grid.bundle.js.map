{"version":3,"file":"history-grid.bundle.js","sources":["../src/component/fields/changeset-time/changeset-time.js","../src/component/fields/authors/authors.js","../src/component/fields/changeset-locations/localization-map.js","../src/component/fields/changeset-locations/changeset-locations.js","../src/component/fields/changeset-values/history-change.js","../src/component/fields/changeset-values/format/offset-date-time-format.js","../src/component/fields/changeset-values/format/elapsed-precise-time-format.js","../src/component/fields/changeset-values/format/default-format.js","../src/component/fields/changeset-values/format/format-map.js","../src/component/fields/changeset-values/format/elapsed-time-format.js","../src/component/fields/changeset-values/format/tags-format.js","../src/component/fields/changeset-values/format/duration-plan-format.js","../src/component/fields/changeset-values/component/user-component/user-element-list.js","../src/component/fields/changeset-values/component/user-component/user-element.js","../src/component/fields/changeset-values/component/related-task-component/related-task-element-list.js","../src/component/fields/changeset-values/component/related-task-component/related-task-element.js","../src/component/fields/changeset-values/component/group-component/group-element.js","../src/component/fields/changeset-values/component/flow-component/flow-element.js","../src/component/fields/changeset-values/component/crm-component/crm-element-list.js","../src/component/fields/changeset-values/component/crm-component/crm-element.js","../src/component/fields/changeset-values/component/check-list-component/check-list-element.js","../src/component/fields/changeset-values/component/component-map.js","../src/component/fields/changeset-values/changeset-values.js","../src/component/grid-loader/grid-loader.js","../src/component/app.js","../src/history-grid.js"],"sourcesContent":["import { timezone } from 'tasks.v2.lib.timezone';\nimport { DateTimeFormat } from 'main.date';\n\n// @vue/component\nexport const ChangesetTime = {\n\tprops: {\n\t\tgetGrid: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tchangesetTimeRef: [],\n\t\t\tchangesetTime: [],\n\t\t};\n\t},\n\tmethods: {\n\t\tasync update(): Promise<void>\n\t\t{\n\t\t\tconst time = this.getGrid().querySelectorAll('[data-time]');\n\n\t\t\tthis.changesetTime = [...time].map((changesetTimeNode: HTMLElement) => this.getChangesetTime(changesetTimeNode));\n\n\t\t\tawait this.$nextTick();\n\n\t\t\ttime.forEach((changesetTimeNode: HTMLElement) => {\n\t\t\t\tconst changesetTime = this.getChangesetTime(changesetTimeNode);\n\t\t\t\tchangesetTimeNode.append(this.changesetTimeRef[changesetTime.rowId]);\n\t\t\t});\n\t\t},\n\t\tgetChangesetTime(changesetTimeNode: HTMLElement): Object\n\t\t{\n\t\t\tconst rowId = Number(changesetTimeNode.closest('[data-id]').dataset.id);\n\t\t\tconst offsetTimestamp = this.getOffsetTimestamp(changesetTimeNode.dataset.time);\n\n\t\t\treturn {\n\t\t\t\trowId,\n\t\t\t\toffsetTimestamp,\n\t\t\t};\n\t\t},\n\t\tgetOffsetTimestamp(timestampString: string): number\n\t\t{\n\t\t\tconst timestamp = Number(timestampString) * 1000;\n\t\t\tconst offset = timezone.getOffset(timestamp);\n\t\t\tconst offsetTimestamp = (timestamp + offset) / 1000;\n\n\t\t\treturn DateTimeFormat.format(DateTimeFormat.getFormat('FORMAT_DATETIME'), offsetTimestamp);\n\t\t},\n\t\tsetRef(element: HTMLElement, rowId: number): void\n\t\t{\n\t\t\tthis.changesetTimeRef ??= {};\n\t\t\tthis.changesetTimeRef[rowId] = element;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<template v-for=\"(time, id) in changesetTime\" :key=\"id\">\n\t\t\t<div :ref=\"(el) => setRef(el, time.rowId)\">{{ time.offsetTimestamp }}</div>\n\t\t</template>\n\t`,\n};\n","import { userService } from 'tasks.v2.provider.service.user-service';\n\nimport './authors.css';\n\n// @vue/component\nexport const Authors = {\n\tprops: {\n\t\tgetGrid: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tauthorsRefs: [],\n\t\t\tauthors: [],\n\t\t};\n\t},\n\tmethods: {\n\t\tasync update(): Promise<void>\n\t\t{\n\t\t\tconst authors = this.getGrid().querySelectorAll('[data-author][data-author-id]');\n\n\t\t\tthis.authors = [...authors].map((authorNode: HTMLElement) => this.getAuthor(authorNode));\n\n\t\t\tawait this.$nextTick();\n\n\t\t\tauthors.forEach((authorNode: HTMLElement) => {\n\t\t\t\tconst author = this.getAuthor(authorNode);\n\t\t\t\tauthorNode.append(this.authorsRefs[author.rowId]);\n\t\t\t});\n\t\t},\n\t\tgetAuthor(authorNode: HTMLElement): Object\n\t\t{\n\t\t\tconst rowId = Number(authorNode.closest('[data-id]').dataset.id);\n\t\t\tconst author = JSON.parse(authorNode.dataset.author);\n\t\t\tconst authorId = Number(authorNode.dataset.authorId);\n\t\t\tconst type = JSON.parse(authorNode.dataset.authorType);\n\n\t\t\treturn {\n\t\t\t\trowId,\n\t\t\t\tauthor,\n\t\t\t\tauthorId,\n\t\t\t\ttype,\n\t\t\t};\n\t\t},\n\t\tsetRef(element: HTMLElement, rowId: number): void\n\t\t{\n\t\t\tthis.authorsRefs ??= {};\n\t\t\tthis.authorsRefs[rowId] = element;\n\t\t},\n\t\tgetUserUrl(userId: number): string\n\t\t{\n\t\t\treturn userService.getUrl(userId);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<template v-for=\"(author, id) in authors\" :key=\"id\">\n\t\t\t<a\n\t\t\t\t:ref=\"(el) => setRef(el, author.rowId)\"\n\t\t\t\t:href=\"getUserUrl(author.authorId)\"\n\t\t\t\tclass=\"tasks-history-grid-author-column-element\"\n\t\t\t\t:class=\"{ '--collaber' : author.type === 'collaber'}\"\n\t\t\t>\n\t\t\t\t{{ author.author }}\n\t\t\t</a>\n\t\t</template>\n\t`,\n};\n","export const localizationMap = {\n\tNEW: 'TASKS_V2_HISTORY_LOG_NEW',\n\tTITLE: 'TASKS_V2_HISTORY_LOG_TITLE',\n\tDESCRIPTION: 'TASKS_V2_HISTORY_LOG_DESCRIPTION',\n\tCREATED_BY: 'TASKS_V2_HISTORY_LOG_CREATED_BY',\n\tRESPONSIBLE_ID: 'TASKS_V2_HISTORY_LOG_RESPONSIBLE_ID',\n\tFLOW_ID: 'TASKS_V2_HISTORY_LOG_FLOW_ID',\n\tDEADLINE: 'TASKS_V2_HISTORY_LOG_DEADLINE',\n\tACCOMPLICES: 'TASKS_V2_HISTORY_LOG_ACCOMPLICES',\n\tAUDITORS: 'TASKS_V2_HISTORY_LOG_AUDITORS',\n\tUF_TASK_WEBDAV_FILES: 'TASKS_V2_HISTORY_LOG_UF_TASK_WEBDAV_FILES',\n\tTAGS: 'TASKS_V2_HISTORY_LOG_TAGS',\n\tPRIORITY: 'TASKS_V2_HISTORY_LOG_PRIORITY',\n\tGROUP_ID: 'TASKS_V2_HISTORY_LOG_GROUP_ID',\n\tSTAGE: 'TASKS_V2_HISTORY_LOG_STAGE',\n\tPARENT_ID: 'TASKS_V2_HISTORY_LOG_PARENT_ID',\n\tDEPENDS_ON: 'TASKS_V2_HISTORY_LOG_DEPENDS_ON',\n\tSTATUS: 'TASKS_V2_HISTORY_LOG_STATUS',\n\tMARK: 'TASKS_V2_HISTORY_LOG_MARK',\n\tADD_IN_REPORT: 'TASKS_V2_HISTORY_LOG_ADD_IN_REPORT',\n\tDELETE: 'TASKS_V2_HISTORY_LOG_DELETE',\n\tRENEW: 'TASKS_V2_HISTORY_LOG_RENEW',\n\tMOVE_TO_SPRINT: 'TASKS_V2_HISTORY_LOG_MOVE_TO_SPRINT',\n\tMOVE_TO_BACKLOG: 'TASKS_V2_HISTORY_LOG_MOVE_TO_BACKLOG',\n\tDELETED_FILES: 'TASKS_V2_HISTORY_LOG_DELETED_FILES',\n\tNEW_FILES: 'TASKS_V2_HISTORY_LOG_NEW_FILES',\n\tCOMMENT: 'TASKS_V2_HISTORY_LOG_COMMENT',\n\tCOMMENT_EDIT: 'TASKS_V2_HISTORY_LOG_COMMENT_EDIT',\n\tCOMMENT_DEL: 'TASKS_V2_HISTORY_LOG_COMMENT_DEL',\n\tRESULT_REMOVE: 'TASKS_V2_HISTORY_LOG_RESULT_REMOVE',\n\tRESULT_EDIT: 'TASKS_V2_HISTORY_LOG_RESULT_EDIT',\n\tRESULT: 'TASKS_V2_HISTORY_LOG_RESULT',\n\tSTART_DATE_PLAN: 'TASKS_V2_HISTORY_LOG_START_DATE_PLAN',\n\tEND_DATE_PLAN: 'TASKS_V2_HISTORY_LOG_END_DATE_PLAN',\n\tDURATION_PLAN: 'TASKS_V2_HISTORY_LOG_DURATION_PLAN',\n\tDURATION_PLAN_SECONDS: 'TASKS_V2_HISTORY_LOG_DURATION_PLAN_SECONDS',\n\tDURATION_FACT: 'TASKS_V2_HISTORY_LOG_DURATION_FACT',\n\tTIME_ESTIMATE: 'TASKS_V2_HISTORY_LOG_TIME_ESTIMATE',\n\tTIME_SPENT_IN_LOGS: 'TASKS_V2_HISTORY_LOG_TIME_SPENT_IN_LOGS',\n\tCHECKLIST_ITEM_CREATE: 'TASKS_V2_HISTORY_LOG_CHECKLIST_ITEM_CREATE',\n\tCHECKLIST_ITEM_REMOVE: 'TASKS_V2_HISTORY_LOG_CHECKLIST_ITEM_REMOVE',\n\tCHECKLIST_ITEM_RENAME: 'TASKS_V2_HISTORY_LOG_CHECKLIST_ITEM_RENAME',\n\tCHECKLIST_ITEM_UNCHECK: 'TASKS_V2_HISTORY_LOG_CHECKLIST_ITEM_UNCHECK',\n\tCHECKLIST_ITEM_CHECK: 'TASKS_V2_HISTORY_LOG_CHECKLIST_ITEM_CHECK',\n\tCHECKLIST_ITEM_MAKE_IMPORTANT: 'TASKS_V2_HISTORY_LOG_CHECKLIST_ITEM_MAKE_IMPORTANT',\n\tCHECKLIST_ITEM_MAKE_UNIMPORTANT: 'TASKS_V2_HISTORY_LOG_CHECKLIST_ITEM_MAKE_UNIMPORTANT',\n\tUF_CRM_TASK_ADDED: 'TASKS_V2_HISTORY_LOG_UF_CRM_TASK_ADDED',\n\tUF_CRM_TASK_DELETED: 'TASKS_V2_HISTORY_LOG_UF_CRM_TASK_DELETED',\n};\n","import { localizationMap } from './localization-map';\nimport './changeset-locations.css';\n\n// @vue/component\nexport const ChangesetLocations = {\n\tprops: {\n\t\tgetGrid: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tlocalizationMap,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tchangeTypesRef: [],\n\t\t\tchangeTypes: [],\n\t\t};\n\t},\n\tmethods: {\n\t\tasync update(): Promise<void>\n\t\t{\n\t\t\tconst changes = this.getGrid().querySelectorAll('[data-changeset-location]');\n\n\t\t\tthis.changeTypes = [...changes].map((changeNode: HTMLElement) => {\n\t\t\t\treturn this.getChange(changeNode);\n\t\t\t});\n\n\t\t\tawait this.$nextTick();\n\n\t\t\tchanges.forEach((changeNode: HTMLElement) => {\n\t\t\t\tconst change = this.getChange(changeNode);\n\t\t\t\tchangeNode.append(this.changeTypesRef[change.rowId]);\n\t\t\t});\n\t\t},\n\t\tgetChange(changeTypeNode: HTMLElement): Object\n\t\t{\n\t\t\tconst rowId = Number(changeTypeNode.closest('[data-id]').dataset.id);\n\t\t\tconst changeType = changeTypeNode.dataset.changesetLocation;\n\t\t\tconst isComment = ['COMMENT', 'COMMENT_EDIT', 'COMMENT_DEL'].includes(changeType);\n\n\t\t\treturn {\n\t\t\t\trowId,\n\t\t\t\tchangeType: this.loc(this.localizationMap[changeType]),\n\t\t\t\tisComment,\n\t\t\t};\n\t\t},\n\t\tsetRef(element: HTMLElement, rowId: number): void\n\t\t{\n\t\t\tthis.changeTypesRef ??= {};\n\t\t\tthis.changeTypesRef[rowId] = element;\n\t\t},\n\t\thandleClick(): void\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(`/task/comments/${this.taskId}`, {\n\t\t\t\twidth: 1000,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<template v-for=\"(changeType, id) in changeTypes\" :key=\"id\">\n\t\t\t<div\n\t\t\t\t:ref=\"(el) => setRef(el, changeType.rowId)\"\n\t\t\t\t@click=\"() => changeType.isComment && handleClick()\"\n\t\t\t\t:class=\"{ 'tasks-history-grid-comment-link': changeType.isComment }\"\n\t\t\t>\n\t\t\t\t{{ changeType.changeType }}\n\t\t\t</div>\n\t\t</template>\n\t`,\n};\n","import { RichLoc } from 'ui.vue3.components.rich-loc';\n\nexport type HistoryChangeset = {\n\tfromValue: string,\n\ttoValue: string,\n};\n\n// @vue/component\nexport const HistoryChange = {\n\tcomponents: {\n\t\tRichLoc,\n\t},\n\tprops: {\n\t\tchangeset: {\n\t\t\t/** @type HistoryChangeset */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcomponent: {\n\t\t\ttype: Object,\n\t\t\tdefault: null,\n\t\t},\n\t\tformat: {\n\t\t\ttype: Function,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<RichLoc\n\t\t\tv-if=\"component || format\"\n\t\t\t:text=\"loc('TASKS_V2_HISTORY_LOG_CHANGE')\"\n\t\t\t:placeholder=\"['[from/]', '[to/]']\"\n\t\t>\n\t\t\t<template #from>\n\t\t\t\t<component v-if=\"component\" :is=\"component\" :value=\"changeset.fromValue\"/>\n\t\t\t\t<template v-else>{{ format(changeset.fromValue) }}</template>\n\t\t\t</template>\n\t\t\t<template #to>\n\t\t\t\t<component v-if=\"component\" :is=\"component\" :value=\"changeset.toValue\"/>\n\t\t\t\t<template v-else>{{ format(changeset.toValue) }}</template>\n\t\t\t</template>\n\t\t</RichLoc>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { timezone } from 'tasks.v2.lib.timezone';\n\nexport const offsetDateTimeFormat = (value: string): string => {\n\tconst timestamp = Number(JSON.parse(value)) * 1000;\n\n\tif (timestamp <= 0)\n\t{\n\t\treturn '';\n\t}\n\n\tconst offset = timezone.getOffset(timestamp);\n\tconst timestampOffset = (timestamp + offset) / 1000;\n\n\tconst date = DateTimeFormat.format(DateTimeFormat.getFormat('SHORT_DATE_FORMAT'), timestampOffset);\n\tconst time = DateTimeFormat.format(DateTimeFormat.getFormat('SHORT_TIME_FORMAT'), timestampOffset);\n\n\treturn `${date} ${time}`;\n};\n","import { DurationFormat } from 'main.date';\n\nexport const elapsedPreciseTimeFormat = (value: string): string => {\n\tconst durationInSeconds = Number(JSON.parse(value));\n\tconst durationFormat = new DurationFormat(durationInSeconds * 1000);\n\n\tif (durationInSeconds <= 0)\n\t{\n\t\treturn durationFormat.format({\n\t\t\tformat: 'i',\n\t\t});\n\t}\n\n\tconst hours = Math.floor(durationInSeconds / 3600);\n\n\tif (hours > 0)\n\t{\n\t\treturn durationFormat.format({\n\t\t\tformat: 'H i',\n\t\t});\n\t}\n\n\treturn durationFormat.format({\n\t\tformat: 'i s',\n\t});\n};\n","export const defaultFormat = (value: string) => JSON.parse(value);\n","import { offsetDateTimeFormat } from './offset-date-time-format';\nimport { elapsedPreciseTimeFormat } from './elapsed-precise-time-format';\nimport { elapsedTimeFormat } from './elapsed-time-format';\nimport { tagsFormat } from './tags-format';\nimport { durationPlanFormat } from './duration-plan-format';\nimport { defaultFormat } from './default-format';\n\nexport const formatMap = {\n\tDEADLINE: offsetDateTimeFormat,\n\tTIME_SPENT_IN_LOGS: elapsedPreciseTimeFormat,\n\tTIME_ESTIMATE: elapsedPreciseTimeFormat,\n\tDURATION_FACT: elapsedTimeFormat,\n\tTAGS: tagsFormat,\n\tSTART_DATE_PLAN: offsetDateTimeFormat,\n\tEND_DATE_PLAN: offsetDateTimeFormat,\n\tDURATION_PLAN_SECONDS: durationPlanFormat,\n\tSTATUS: defaultFormat,\n\tMARK: defaultFormat,\n\tPRIORITY: defaultFormat,\n\tADD_IN_REPORT: defaultFormat,\n\tSTAGE: defaultFormat,\n\tTITLE: defaultFormat,\n\tCHECKLIST_ITEM_RENAME: defaultFormat,\n\tCHECKLIST_ITEM_CREATE: defaultFormat,\n\tCHECKLIST_ITEM_REMOVE: defaultFormat,\n\tCHECKLIST_ITEM_MAKE_UNIMPORTANT: defaultFormat,\n\tCHECKLIST_ITEM_MAKE_IMPORTANT: defaultFormat,\n};\n","import { DurationFormat } from 'main.date';\n\nexport const elapsedTimeFormat = (value: string): string => {\n\tconst durationInMinutes = Number(JSON.parse(value));\n\tconst durationInMilliseconds = durationInMinutes * 60 * 1000;\n\n\treturn new DurationFormat(durationInMilliseconds).format({\n\t\tformat: 'H i',\n\t});\n};\n","export const tagsFormat = (value: string): string => {\n\treturn JSON.parse(value).replace(',', ', ');\n};\n","import { DurationFormat } from 'main.date';\n\nexport const durationPlanFormat = (value: string): string => {\n\tconst durationInSeconds = Number(JSON.parse(value)) * 1000;\n\n\tif (durationInSeconds <= 0)\n\t{\n\t\treturn '';\n\t}\n\n\treturn new DurationFormat(durationInSeconds).format({\n\t\tformat: 'd H',\n\t});\n};\n","import { UserElement } from './user-element';\nimport type { UserChangeset } from './user-element';\n\n// @vue/component\nexport const UserElementList = {\n\tcomponents: {\n\t\tUserElement,\n\t},\n\tprops: {\n\t\tvalue: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed: {\n\t\tusers(): UserChangeset[]\n\t\t{\n\t\t\treturn JSON.parse(this.value);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<template v-for=\"(user, index) of users\" :key=\"index\">\n\t\t\t<UserElement :user/>{{ index < users.length - 1 ? ', ': '' }}\n\t\t</template>\n\t`,\n};\n","import './user-element.css';\n\nexport type UserChangeset = {\n\tname: ?string,\n\tlink: ?string,\n\ttype: ?string,\n};\n\n// @vue/component\nexport const UserElement = {\n\tprops: {\n\t\t/** @type UserChangeset */\n\t\tuser: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tisCollaber(): boolean\n\t\t{\n\t\t\treturn this.user?.type === 'collaber';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<a\n\t\t\t:href=\"user?.link\"\n\t\t\tclass=\"tasks-history-grid-user-element\"\n\t\t\t:class=\"{ '--collaber': isCollaber }\"\n\t\t>\n\t\t\t{{ user?.name }}\n\t\t</a>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { RelatedTaskElement } from './related-task-element';\nimport type { RelatedTaskChangeset } from './related-task-element';\n\n// @vue/component\nexport const RelatedTaskElementList = {\n\tcomponents: {\n\t\tRelatedTaskElement,\n\t},\n\tprops: {\n\t\tvalue: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed: {\n\t\trelatedTaskItems(): RelatedTaskChangeset[] | null\n\t\t{\n\t\t\treturn JSON.parse(this.value);\n\t\t},\n\t\tisNotFilled(): boolean\n\t\t{\n\t\t\treturn Type.isNull(this.relatedTaskItems);\n\t\t},\n\t\tisHidden(): boolean\n\t\t{\n\t\t\treturn this.relatedTaskItems?.length === 0;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<span v-if=\"isNotFilled\"/>\n\t\t<span v-else-if=\"isHidden\">{{ loc('TASKS_V2_HISTORY_LOG_HIDDEN_VALUE') }}</span>\n\t\t<template v-else v-for=\"(relatedTaskItem, index) of relatedTaskItems\" :key=\"index\">\n\t\t\t<RelatedTaskElement :relatedTaskItem/>{{ index < relatedTaskItems.length - 1 ? ', ': '' }}\n\t\t</template>\n\t`,\n};\n","import { Type } from 'main.core';\n\nexport type RelatedTaskChangeset = {\n\ttitle: ?string,\n\tlink: ?string,\n};\n\n// @vue/component\nexport const RelatedTaskElement = {\n\tprops: {\n\t\t/** @type RelatedTaskChangeset */\n\t\trelatedTaskItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tisLinkFilled(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.relatedTaskItem?.link);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<a v-if=\"isLinkFilled\" :href=\"relatedTaskItem?.link\">{{ relatedTaskItem?.title }}</a>\n\t\t<span v-else>{{ relatedTaskItem?.title }}</span>\n\t`,\n};\n","import { Type } from 'main.core';\n\nexport type GroupChangeset = {\n\tname: ?string,\n\tlink: ?string,\n};\n\n// @vue/component\nexport const GroupElement = {\n\tprops: {\n\t\tvalue: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed: {\n\t\tgroup(): GroupChangeset\n\t\t{\n\t\t\treturn JSON.parse(this.value);\n\t\t},\n\t\tisNotFilled(): boolean\n\t\t{\n\t\t\treturn Type.isNull(this.group);\n\t\t},\n\t\tisHidden(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.group).length === 0;\n\t\t},\n\t\tisLinkFilled(): boolean\n\t\t{\n\t\t\treturn Type.isStringFilled(this.group?.link);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<span v-if=\"isNotFilled\"/>\n\t\t<span v-else-if=\"isHidden\">{{ loc('TASKS_V2_HISTORY_LOG_HIDDEN_VALUE') }}</span>\n\t\t<a v-else-if=\"isLinkFilled\" :href=\"group?.link\" target=\"_top\">{{ group?.name }}</a>\n\t\t<span v-else>{{ group?.name }}</span>\n\t`,\n};\n","import { Runtime, Type } from 'main.core';\n\nexport type FlowChangeset = {\n\tid: ?number,\n\tname: ?string,\n};\n\n// @vue/component\nexport const FlowElement = {\n\tprops: {\n\t\tvalue: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tviewFormExtension: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tflow(): FlowChangeset\n\t\t{\n\t\t\treturn JSON.parse(this.value);\n\t\t},\n\t\tisNotFilled(): boolean\n\t\t{\n\t\t\treturn Type.isNull(this.flow);\n\t\t},\n\t\tisHidden(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.flow).length === 0;\n\t\t},\n\t\tflowName(): string\n\t\t{\n\t\t\treturn this.flow?.name || '';\n\t\t},\n\t},\n\tasync beforeMount(): Promise<void>\n\t{\n\t\tconst extension = await Runtime.loadExtension('tasks.flow.view-form');\n\t\tthis.viewFormExtension = extension.ViewForm;\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tthis.viewFormExtension?.showInstance({\n\t\t\t\tflowId: this.flow?.id,\n\t\t\t\tbindElement: this.$refs.flowLink,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<span v-if=\"isNotFilled\"/>\n\t\t<span v-else-if=\"isHidden\">{{ loc('TASKS_V2_HISTORY_LOG_HIDDEN_VALUE') }}</span>\n\t\t<a v-else @click=\"handleClick\" ref=\"flowLink\">{{ flowName }}</a>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { CrmElement } from './crm-element';\nimport type { CrmChangeset } from './crm-element';\n\n// @vue/component\nexport const CrmElementList = {\n\tcomponents: {\n\t\tCrmElement,\n\t},\n\tprops: {\n\t\tvalue: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed: {\n\t\tcrmItems(): CrmChangeset[] | null\n\t\t{\n\t\t\treturn JSON.parse(this.value);\n\t\t},\n\t\tisNotFilled(): boolean\n\t\t{\n\t\t\treturn Type.isNull(this.crmItems);\n\t\t},\n\t\tisHidden(): boolean\n\t\t{\n\t\t\treturn this.crmItems?.length === 0;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<span v-if=\"isNotFilled\"/>\n\t\t<span v-else-if=\"isHidden\">{{ loc('TASKS_V2_HISTORY_LOG_HIDDEN_VALUE') }}</span>\n\t\t<template v-else v-for=\"(crmItem, index) of crmItems\" :key=\"index\">\n\t\t\t<CrmElement :crmItem/>{{ index < crmItems.length - 1 ? ', ': '' }}\n\t\t</template>\n\t`,\n};\n","export type CrmChangeset = {\n\ttitle: ?string,\n\tlink: ?string,\n};\n\n// @vue/component\nexport const CrmElement = {\n\tprops: {\n\t\t/** @type CrmChangeset */\n\t\tcrmItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<a :href=\"crmItem?.link\">{{ crmItem?.title }}</a>\n\t`,\n};\n","import './check-list-element.css';\n\nexport type CheckListChangeset = {\n\ttitle: ?string,\n\tisChecked: ?boolean,\n};\n\n// @vue/component\nexport const CheckListElement = {\n\tprops: {\n\t\tvalue: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed: {\n\t\tcheckListItem(): CheckListChangeset\n\t\t{\n\t\t\treturn JSON.parse(this.value);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<span\n\t\t\tclass=\"tasks-history-grid-checklist-element\"\n\t\t\t:class=\"{ '--checked' : checkListItem?.isChecked }\"\n\t\t>\n\t\t\t{{ checkListItem?.title }}\n\t\t</span>\n\t`,\n};\n","import { UserElementList } from './user-component/user-element-list';\nimport { RelatedTaskElementList } from './related-task-component/related-task-element-list';\nimport { GroupElement } from './group-component/group-element';\nimport { FlowElement } from './flow-component/flow-element';\nimport { CrmElementList } from './crm-component/crm-element-list';\nimport { CheckListElement } from './check-list-component/check-list-element';\n\nexport const componentMap = {\n\tRESPONSIBLE_ID: UserElementList,\n\tAUDITORS: UserElementList,\n\tCREATED_BY: UserElementList,\n\tACCOMPLICES: UserElementList,\n\tPARENT_ID: RelatedTaskElementList,\n\tDEPENDS_ON: RelatedTaskElementList,\n\tGROUP_ID: GroupElement,\n\tFLOW_ID: FlowElement,\n\tUF_CRM_TASK_DELETED: CrmElementList,\n\tUF_CRM_TASK_ADDED: CrmElementList,\n\tCHECKLIST_ITEM_CHECK: CheckListElement,\n\tCHECKLIST_ITEM_UNCHECK: CheckListElement,\n};\n","import { HistoryChange } from './history-change';\nimport { formatMap } from './format/format-map';\nimport { componentMap } from './component/component-map';\n\n// @vue/component\nexport const ChangesetValues = {\n\tcomponents: {\n\t\tHistoryChange,\n\t},\n\tprops: {\n\t\tgetGrid: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tformatMap,\n\t\t\tcomponentMap,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tchangesetRef: [],\n\t\t\tchangesetLocations: [],\n\t\t};\n\t},\n\tmethods: {\n\t\tasync update(): Promise<void>\n\t\t{\n\t\t\tconst changesetValues = this.getGrid().querySelectorAll('[data-changeset-from-value][data-changeset-to-value]');\n\n\t\t\tthis.changesetLocations = [...changesetValues].map((changesetValueNode: HTMLElement) => {\n\t\t\t\treturn this.getChangesetInfo(changesetValueNode);\n\t\t\t});\n\n\t\t\tawait this.$nextTick();\n\n\t\t\tchangesetValues.forEach((changesetValueNode: HTMLElement) => {\n\t\t\t\tconst changeset = this.getChangesetInfo(changesetValueNode);\n\t\t\t\tchangesetValueNode.append(this.changesetRef[changeset.rowId]);\n\t\t\t});\n\t\t},\n\t\tgetChangesetInfo(changesetValueNode: HTMLElement): Object\n\t\t{\n\t\t\tconst rowId = Number(changesetValueNode.closest('[data-id]').dataset.id);\n\t\t\tconst location = this.getGrid().querySelector(`[data-id=\"${rowId}\"] [data-changeset-location]`).dataset.changesetLocation;\n\n\t\t\treturn {\n\t\t\t\tlocation,\n\t\t\t\trowId,\n\t\t\t\tchangesetValue: {\n\t\t\t\t\tfromValue: changesetValueNode.dataset.changesetFromValue,\n\t\t\t\t\ttoValue: changesetValueNode.dataset.changesetToValue,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tsetRef(element: HTMLElement, rowId: number): void\n\t\t{\n\t\t\tthis.changesetRef ??= {};\n\t\t\tthis.changesetRef[rowId] = element;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<template v-for=\"(changesetLocation, id) in changesetLocations\" :key=\"id\">\n\t\t\t<HistoryChange\n\t\t\t\t:changeset=\"changesetLocation.changesetValue\"\n\t\t\t\t:component=\"componentMap[changesetLocation.location]\"\n\t\t\t\t:format=\"formatMap[changesetLocation.location]\"\n\t\t\t\t:ref=\"(el) => setRef(el?.$el, changesetLocation.rowId)\"\n\t\t\t/>\n\t\t</template>\n\t`,\n};\n","import './grid-loader.css';\n\n// @vue/component\nexport const GridLoader = {\n\ttemplate: `\n\t\t<div class=\"tasks-history-grid-loader-spinner\"/>\n\t`,\n};\n","import { Runtime, Uri } from 'main.core';\nimport { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { PopupManager } from 'main.popup';\n\nimport { HeadlineXl } from 'ui.system.typography.vue';\n\nimport { apiClient } from 'tasks.v2.lib.api-client';\n\nimport { ChangesetTime } from './fields/changeset-time/changeset-time';\nimport { Authors } from './fields/authors/authors';\nimport { ChangesetLocations } from './fields/changeset-locations/changeset-locations';\nimport { ChangesetValues } from './fields/changeset-values/changeset-values';\nimport { GridLoader } from './grid-loader/grid-loader';\n\nimport './app.css';\n\nconst gridId = 'tasks-history-grid';\n\n// @vue/component\nexport const App = {\n\tname: 'HistoryGrid',\n\tcomponents: {\n\t\tHeadlineXl,\n\t\tGridLoader,\n\t\tChangesetTime,\n\t\tAuthors,\n\t\tChangesetLocations,\n\t\tChangesetValues,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tEventEmitter.subscribe('Grid::beforeRequest', this.handleBeforeGridRequest);\n\t\tEventEmitter.subscribe('Grid::updated', this.update);\n\n\t\tvoid this.getData();\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tEventEmitter.unsubscribe('Grid::beforeRequest', this.handleBeforeGridRequest);\n\t\tEventEmitter.unsubscribe('Grid::updated', this.update);\n\n\t\tBX.Main?.gridManager?.destroy(gridId);\n\t\tPopupManager.getPopupById(`${gridId}-grid-settings-window`)?.destroy();\n\t},\n\tmethods: {\n\t\tasync getData(): Promise<void>\n\t\t{\n\t\t\tconst { html } = await apiClient.post('Task.HistoryGrid.get', { taskId: this.taskId });\n\n\t\t\tawait Runtime.html(this.$refs.grid, html);\n\n\t\t\tthis.update();\n\t\t},\n\t\thandleBeforeGridRequest(event: BaseEvent): void\n\t\t{\n\t\t\tconst [, eventArgs] = event.getData();\n\n\t\t\tif (eventArgs.url)\n\t\t\t{\n\t\t\t\tthis.nav = new Uri(eventArgs.url ?? '').getQueryParams().nav;\n\t\t\t}\n\n\t\t\teventArgs.url = `/bitrix/services/main/ajax.php?action=tasks.v2.Task.HistoryGrid.getData&nav=${this.nav}`;\n\t\t\teventArgs.method = 'POST';\n\t\t\teventArgs.data = {\n\t\t\t\ttaskId: this.taskId,\n\t\t\t};\n\t\t},\n\t\tupdate(): void\n\t\t{\n\t\t\tvoid this.$refs.changesetTime.update();\n\t\t\tvoid this.$refs.authors.update();\n\t\t\tvoid this.$refs.changesetLocations.update();\n\t\t\tvoid this.$refs.changesetValues.update();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-history-grid-container\">\n\t\t\t<div class=\"tasks-history-grid-header\">\n\t\t\t\t<HeadlineXl>{{ loc('TASKS_V2_HISTORY_LOG_HEADER') }}</HeadlineXl>\n\t\t\t</div>\n\t\t\t<div ref=\"grid\" class=\"tasks-history-grid-main-content\"><GridLoader/></div>\n\t\t\t<Authors ref=\"authors\" :getGrid=\"() => this.$refs.grid\"/>\n\t\t\t<ChangesetTime ref=\"changesetTime\" :getGrid=\"() => this.$refs.grid\"/>\n\t\t\t<ChangesetLocations ref=\"changesetLocations\" :getGrid=\"() => this.$refs.grid\" :taskId/>\n\t\t\t<ChangesetValues ref=\"changesetValues\" :getGrid=\"() => this.$refs.grid\"/>\n\t\t</div>\n\t`,\n};\n","import type { Slider } from 'main.sidepanel';\n\nimport { BitrixVue, type VueCreateAppResult } from 'ui.vue3';\nimport { locMixin } from 'ui.vue3.mixins.loc-mixin';\n\nimport { App } from './component/app';\n\nexport type Params = {\n\ttaskId: number,\n};\n\nexport class HistoryGrid\n{\n\t#application: ?VueCreateAppResult;\n\t#params: Params;\n\n\tconstructor(params: Params = {})\n\t{\n\t\tthis.#params = params;\n\t}\n\n\tstatic openHistoryGrid(params: Params): void\n\t{\n\t\tlet historyGrid = null;\n\t\tBX.SidePanel.Instance.open('tasks-history-grid', {\n\t\t\tcontentCallback: (slider: Slider): HTMLElement => {\n\t\t\t\thistoryGrid = new this(params);\n\n\t\t\t\treturn historyGrid.mount(slider);\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonClose: (): void => historyGrid?.unmount(),\n\t\t\t},\n\t\t\tcacheable: false,\n\t\t\twidth: 1200,\n\t\t});\n\t}\n\n\tmount(slider: Slider): void\n\t{\n\t\tthis.#application = this.#mountApplication(slider.getContentContainer());\n\t}\n\n\tunmount(): void\n\t{\n\t\tthis.#unmountApplication();\n\t}\n\n\t#mountApplication(container: HTMLElement): VueCreateAppResult\n\t{\n\t\tconst application = BitrixVue.createApp(App, this.#params);\n\n\t\tapplication.mixin(locMixin);\n\t\tapplication.mount(container);\n\n\t\treturn application;\n\t}\n\n\t#unmountApplication(): void\n\t{\n\t\tthis.#application?.unmount();\n\t}\n}\n"],"names":["ChangesetTime","props","getGrid","type","Function","required","data","changesetTimeRef","changesetTime","methods","[object Object]","time","this","querySelectorAll","map","changesetTimeNode","getChangesetTime","$nextTick","forEach","append","rowId","Number","closest","dataset","id","offsetTimestamp","getOffsetTimestamp","timestampString","timestamp","timezone","getOffset","DateTimeFormat","format","getFormat","setRef","element","template","Authors","authorsRefs","authors","authorNode","getAuthor","author","JSON","parse","authorId","authorType","getUserUrl","userId","userService","getUrl","localizationMap","NEW","TITLE","DESCRIPTION","CREATED_BY","RESPONSIBLE_ID","FLOW_ID","DEADLINE","ACCOMPLICES","AUDITORS","UF_TASK_WEBDAV_FILES","TAGS","PRIORITY","GROUP_ID","STAGE","PARENT_ID","DEPENDS_ON","STATUS","MARK","ADD_IN_REPORT","DELETE","RENEW","MOVE_TO_SPRINT","MOVE_TO_BACKLOG","DELETED_FILES","NEW_FILES","COMMENT","COMMENT_EDIT","COMMENT_DEL","RESULT_REMOVE","RESULT_EDIT","RESULT","START_DATE_PLAN","END_DATE_PLAN","DURATION_PLAN","DURATION_PLAN_SECONDS","DURATION_FACT","TIME_ESTIMATE","TIME_SPENT_IN_LOGS","CHECKLIST_ITEM_CREATE","CHECKLIST_ITEM_REMOVE","CHECKLIST_ITEM_RENAME","CHECKLIST_ITEM_UNCHECK","CHECKLIST_ITEM_CHECK","CHECKLIST_ITEM_MAKE_IMPORTANT","CHECKLIST_ITEM_MAKE_UNIMPORTANT","UF_CRM_TASK_ADDED","UF_CRM_TASK_DELETED","ChangesetLocations","taskId","String","setup","changeTypesRef","changeTypes","changes","changeNode","getChange","change","changeTypeNode","changeType","changesetLocation","isComment","includes","loc","handleClick","BX","SidePanel","Instance","open","width","HistoryChange","components","RichLoc","changeset","Object","component","default","offsetDateTimeFormat","value","timestampOffset","elapsedPreciseTimeFormat","durationInSeconds","durationFormat","DurationFormat","Math","floor","defaultFormat","formatMap","durationInMilliseconds","replace","UserElementList","UserElement","user","computed","isCollaber","_this$user","users","RelatedTaskElementList","RelatedTaskElement","relatedTaskItem","isLinkFilled","Type","isStringFilled","_this$relatedTaskItem","link","relatedTaskItems","isNotFilled","isNull","isHidden","length","GroupElement","group","keys","_this$group","FlowElement","viewFormExtension","flow","flowName","_this$flow","name","extension","Runtime","loadExtension","ViewForm","_this$viewFormExtensi","showInstance","flowId","_this$flow2","bindElement","$refs","flowLink","CrmElementList","CrmElement","crmItem","crmItems","_this$crmItems","CheckListElement","checkListItem","componentMap","ChangesetValues","changesetRef","changesetLocations","changesetValues","changesetValueNode","getChangesetInfo","location","querySelector","changesetValue","fromValue","changesetFromValue","toValue","changesetToValue","GridLoader","App","HeadlineXl","mounted","EventEmitter","subscribe","handleBeforeGridRequest","update","getData","beforeUnmount","unsubscribe","Main","_BX$Main","gridManager","_BX$Main$gridManager","destroy","PopupManager","getPopupById","_PopupManager$getPopu","html","apiClient","post","grid","event","eventArgs","url","nav","Uri","getQueryParams","method","container","application","BitrixVue","createApp","mixin","locMixin","mount","_babelHelpers$classPr","unmount","constructor","params","writable","babelHelpers","historyGrid","contentCallback","slider","events","onClose","_historyGrid","cacheable","getContentContainer"],"mappings":"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"}