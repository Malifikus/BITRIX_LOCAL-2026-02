{"version":3,"file":"new-chat-button-popup.bundle.js","sources":["../src/new-chat-button-popup.js"],"sourcesContent":["import { Tag, Loc, ajax } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { BannerDispatcher } from 'ui.banner-dispatcher';\n\nimport './new-chat-button-popup.css';\n\nexport class NewChatButtonPopup\n{\n\t#popup: ?Popup;\n\n\tstatic show(): void\n\t{\n\t\treturn new this().showPopup();\n\t}\n\n\tshowPopup(): void\n\t{\n\t\tBannerDispatcher.normal.toQueue((onDone) => {\n\t\t\tthis.#popup = this.getPopup();\n\n\t\t\tif (!this.#popup)\n\t\t\t{\n\t\t\t\tonDone();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst onClose = () => {\n\t\t\t\tonDone();\n\t\t\t};\n\n\t\t\tthis.#popup.show();\n\t\t\tthis.#popup.subscribe('onClose', onClose);\n\t\t\tthis.#popup.subscribe('onDestroy', onClose);\n\n\t\t\tthis.setViewed();\n\t\t});\n\t}\n\n\tgetPopup(): ?Popup\n\t{\n\t\tconst chatButton = document.getElementById('tasks-chat-button');\n\n\t\tif (!chatButton)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn new Popup({\n\t\t\tclassName: 'tasks-onboarding-new-chat-button-popup-wrapper',\n\t\t\tcontent: this.getContent(),\n\t\t\tbindElement: chatButton,\n\t\t\tbackground: 'var(--ui-color-bg-content-inapp)',\n\t\t\tangle: true,\n\t\t\tautoHide: true,\n\t\t\tautoHideHandler: () => true,\n\t\t\tcacheable: false,\n\t\t\tanimation: 'fading',\n\t\t\tpadding: 0,\n\t\t\tmaxWidth: 460,\n\t\t\tminWidth: 460,\n\t\t\toffsetLeft: 60,\n\t\t\tcloseByEsc: false,\n\t\t\tcloseIcon: true,\n\t\t});\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-onboarding-new-chat-button-popup\">\n\t\t\t\t<div class=\"tasks-onboarding-new-chat-button-popup-icon\">\n\t\t\t\t\t<img src=\"${this.getIconPath()}\" alt=\"\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-onboarding-new-chat-button-popup-content\">\n\t\t\t\t\t<div class=\"tasks-onboarding-new-chat-button-popup-title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_COMPONENT_ONBOARDING_NEW_CHAT_BUTTON_POPUP_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-onboarding-new-chat-button-popup-text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_COMPONENT_ONBOARDING_NEW_CHAT_BUTTON_POPUP_TEXT')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetIconPath(): string\n\t{\n\t\treturn '/bitrix/js/tasks/v2/component/onboarding/new-chat-button-popup/src/new-chat-button-popup.png';\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.#popup.close();\n\t}\n\n\tsetViewed(): void\n\t{\n\t\tvoid ajax.runAction('tasks.promotion.setViewed', {\n\t\t\tdata: {\n\t\t\t\tpromotion: 'tasks_new_chat_button',\n\t\t\t},\n\t\t});\n\t}\n}\n"],"names":["NewChatButtonPopup","show","showPopup","BannerDispatcher","normal","toQueue","onDone","getPopup","onClose","subscribe","setViewed","chatButton","document","getElementById","Popup","className","content","getContent","bindElement","background","angle","autoHide","autoHideHandler","cacheable","animation","padding","maxWidth","minWidth","offsetLeft","closeByEsc","closeIcon","Tag","render","getIconPath","Loc","getMessage","close","ajax","runAction","data","promotion"],"mappings":";;;;;;;;;;AAAA,CAIqC;AAErC,CAAO,MAAMA,kBAAkB,CAC/B;GAAA;KAAA;OAAA;OAAA;;;GAGC,OAAOC,IAAI,GACX;KACC,OAAO,IAAI,IAAI,EAAE,CAACC,SAAS,EAAE;;GAG9BA,SAAS,GACT;KACCC,oCAAgB,CAACC,MAAM,CAACC,OAAO,CAAEC,MAAM,IAAK;OAC3C,4CAAI,oBAAU,IAAI,CAACC,QAAQ,EAAE;OAE7B,IAAI,yCAAC,IAAI,iBAAO,EAChB;SACCD,MAAM,EAAE;SAER;;OAGD,MAAME,OAAO,GAAG,MAAM;SACrBF,MAAM,EAAE;QACR;OAED,4CAAI,kBAAQL,IAAI,EAAE;OAClB,4CAAI,kBAAQQ,SAAS,CAAC,SAAS,EAAED,OAAO,CAAC;OACzC,4CAAI,kBAAQC,SAAS,CAAC,WAAW,EAAED,OAAO,CAAC;OAE3C,IAAI,CAACE,SAAS,EAAE;MAChB,CAAC;;GAGHH,QAAQ,GACR;KACC,MAAMI,UAAU,GAAGC,QAAQ,CAACC,cAAc,CAAC,mBAAmB,CAAC;KAE/D,IAAI,CAACF,UAAU,EACf;OACC,OAAO,IAAI;;KAGZ,OAAO,IAAIG,gBAAK,CAAC;OAChBC,SAAS,EAAE,gDAAgD;OAC3DC,OAAO,EAAE,IAAI,CAACC,UAAU,EAAE;OAC1BC,WAAW,EAAEP,UAAU;OACvBQ,UAAU,EAAE,kCAAkC;OAC9CC,KAAK,EAAE,IAAI;OACXC,QAAQ,EAAE,IAAI;OACdC,eAAe,EAAE,MAAM,IAAI;OAC3BC,SAAS,EAAE,KAAK;OAChBC,SAAS,EAAE,QAAQ;OACnBC,OAAO,EAAE,CAAC;OACVC,QAAQ,EAAE,GAAG;OACbC,QAAQ,EAAE,GAAG;OACbC,UAAU,EAAE,EAAE;OACdC,UAAU,EAAE,KAAK;OACjBC,SAAS,EAAE;MACX,CAAC;;GAGHb,UAAU,GACV;KACC,OAAOc,aAAG,CAACC,MAAM,cAAC;;;iBAGL,CAAqB;;;;QAI9B,CAA2E;;;QAG3E,CAA0E;;;;GAI9E,GAXe,IAAI,CAACC,WAAW,EAAE,EAI3BC,aAAG,CAACC,UAAU,CAAC,wDAAwD,CAAC,EAGxED,aAAG,CAACC,UAAU,CAAC,uDAAuD,CAAC;;GAO9EF,WAAW,GACX;KACC,OAAO,8FAA8F;;GAGtGG,KAAK,GACL;KACC,4CAAI,kBAAQA,KAAK,EAAE;;GAGpB1B,SAAS,GACT;KACC,KAAK2B,cAAI,CAACC,SAAS,CAAC,2BAA2B,EAAE;OAChDC,IAAI,EAAE;SACLC,SAAS,EAAE;;MAEZ,CAAC;;CAEJ;;;;;;;;"}