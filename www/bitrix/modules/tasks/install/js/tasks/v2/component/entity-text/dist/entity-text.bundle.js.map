{"version":3,"file":"entity-text.bundle.js","sources":["../src/default-editor-options.js","../src/entity-text-editor.js","../src/entity-text-area.js","../src/collapsible-action/edit-button.js","../src/collapsible-action/expand-button.js","../src/collapsible-action/collapse-button.js","../src/entity-collapsible-text.js","../src/editor-actions/action-button.js","../src/editor-actions/copilot-button.js","../src/editor-actions/more-button.js","../src/editor-actions/attach-button.js","../src/editor-actions/mention-button.js","../src/editor-actions/number-list-button.js","../src/editor-actions/bullet-list-button.js"],"sourcesContent":["import { EntitySelectorEntity } from 'tasks.v2.const';\nimport type { TextEditorOptions } from 'ui.text-editor';\n\nexport const DefaultEditorOptions: TextEditorOptions = Object.freeze({\n\ttoolbar: [],\n\tfloatingToolbar: [\n\t\t'bold', 'italic', 'underline', 'strikethrough', '|',\n\t\t'numbered-list', 'bulleted-list', '|',\n\t\t'link', 'spoiler', 'quote', 'code', 'copilot',\n\t],\n\tremovePlugins: ['BlockToolbar'],\n\tvisualOptions: {\n\t\tborderWidth: 0,\n\t\tblockSpaceInline: 0,\n\t\tcolorBackground: 'transparent',\n\t},\n\tmention: {\n\t\tdialogOptions: {\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: EntitySelectorEntity.User,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\temailUsers: true,\n\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t},\n\t\t\t\t\titemOptions: {\n\t\t\t\t\t\tdefault: {\n\t\t\t\t\t\t\tlink: '',\n\t\t\t\t\t\t\tlinkTitle: '',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: EntitySelectorEntity.StructureNode,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tselectMode: 'usersOnly',\n\t\t\t\t\t\tallowFlatDepartments: false,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t},\n\tcopilot: {},\n\tparagraphPlaceholder: 'auto',\n});\n","import { Runtime, Type, Loc, Event } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport { toRaw } from 'ui.vue3';\nimport { FileEvent, getFilesFromDataTransfer, isFilePasted } from 'ui.uploader.core';\nimport { COMMAND_PRIORITY_NORMAL, PASTE_COMMAND } from 'ui.lexical.core';\nimport { TextEditor, Plugins, type TextEditorOptions } from 'ui.text-editor';\nimport type { UploaderFile, UploaderFileInfo } from 'ui.uploader.core';\nimport type { VueUploaderAdapter } from 'ui.uploader.vue';\nimport type { Store } from 'ui.vue3.vuex';\n\nimport { Core } from 'tasks.v2.core';\nimport { EntitySelectorEntity } from 'tasks.v2.const';\nimport { fileService, type FileService } from 'tasks.v2.provider.service.file-service';\n\nimport { DefaultEditorOptions } from './default-editor-options';\n\nexport const EntityTextTypes = Object.freeze({\n\tTask: 'task',\n\tResult: 'result',\n});\n\nexport type EntityTextType = $Values<typeof EntityTextTypes>;\n\nexport type EntityTextEditorOptions = {\n\tcontent?: string | null,\n\tblockSpaceInline?: string | number,\n};\n\nexport class EntityTextEditor extends EventEmitter\n{\n\t#editor: TextEditor;\n\t#fileService: FileService;\n\t#uploaderAdapter: VueUploaderAdapter;\n\t#syncHighlightsDebounced: Function;\n\t#entityId: number | string;\n\t#entityType: EntityTextType;\n\n\tconstructor(\n\t\tentityId: number | string,\n\t\tentityType: EntityTextType = EntityTextTypes.Task,\n\t\toptions: EntityTextEditorOptions = {},\n\t)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('Tasks.V2.Component.Entity-Text-Editor');\n\n\t\tthis.setEntityId(entityId, entityType);\n\t\tthis.initService(entityId, entityType);\n\t\tthis.initEditor(options);\n\t\tthis.#subscribeToEvents();\n\t\tthis.#registerCommands();\n\n\t\tthis.#syncHighlightsDebounced = Runtime.debounce(this.#syncHighlights, 500, this);\n\n\t\tthis.isTabHidden = false;\n\t}\n\n\tsetEntityId(entityId: number | string, entityType: EntityTextType): void\n\t{\n\t\tthis.#entityId = entityId;\n\t\tthis.#entityType = entityType;\n\t}\n\n\tgetEditor(): TextEditor\n\t{\n\t\treturn this.#editor;\n\t}\n\n\tgetEntityId(): number | string\n\t{\n\t\treturn this.#entityId;\n\t}\n\n\tgetEntityType(): string\n\t{\n\t\treturn this.#entityType;\n\t}\n\n\tinitService(entityId: number | string, entityType: EntityTextType): void\n\t{\n\t\tthis.#fileService = fileService.get(entityId, entityType);\n\t\tthis.#uploaderAdapter = this.#fileService.getAdapter();\n\t}\n\n\tinitEditor(options: EntityTextEditorOptions): void\n\t{\n\t\tconst content = options.content ?? null;\n\t\tconst restrictions = Core.getParams().restrictions;\n\n\t\tconst additionalEditorOptions: TextEditorOptions = {\n\t\t\tcontent,\n\t\t\tminHeight: 118,\n\t\t\tplaceholder: Loc.getMessage('TASKS_V2_CHANGE_DESCRIPTION'),\n\t\t\tnewLineMode: 'paragraph',\n\t\t\tevents: {\n\t\t\t\tonChange: this.handleEditorChange,\n\t\t\t\tonBlur: this.handleEditorBlur,\n\t\t\t},\n\t\t\tfile: {\n\t\t\t\tmode: Core.getParams().features.disk ? 'disk' : 'file',\n\t\t\t\tfiles: this.getFiles(),\n\t\t\t},\n\t\t\tvisualOptions: {\n\t\t\t\tborderWidth: 0,\n\t\t\t\tblockSpaceInline: options?.blockSpaceInline ?? 'var(--ui-space-stack-md2)',\n\t\t\t\tcolorBackground: 'transparent',\n\t\t\t},\n\t\t\tmention: {\n\t\t\t\tdialogOptions: {\n\t\t\t\t\twidth: 565,\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: EntitySelectorEntity.User,\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\temailUsers: true,\n\t\t\t\t\t\t\t\tinviteGuestLink: true,\n\t\t\t\t\t\t\t\tlockGuestLink: !restrictions.mailUserIntegration.available,\n\t\t\t\t\t\t\t\tlockGuestLinkFeatureId: restrictions.mailUserIntegration.featureId,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: EntitySelectorEntity.Department,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t},\n\t\t\tremovePlugins: [],\n\t\t\tcopilot: this.#getCopilotParams(),\n\t\t};\n\n\t\tthis.#editor = new TextEditor({ ...DefaultEditorOptions, ...additionalEditorOptions });\n\t}\n\n\tsetEditorText(content): void\n\t{\n\t\tthis.#editor.setText(content);\n\t}\n\n\tgetFiles(): UploaderFileInfo[]\n\t{\n\t\treturn this.#uploaderAdapter.getItems();\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.#unsubscribeToEvents();\n\t\tthis.#editor?.destroy();\n\t\tthis.#editor = null;\n\t}\n\n\t#subscribeToEvents(): void\n\t{\n\t\tthis.#fileService.subscribe('onFileComplete', this.onFileComplete);\n\t\tthis.#fileService.subscribe('onFileRemove', this.onFileRemove);\n\n\t\tEvent.bind(document, 'visibilitychange', this.onVisibilityChange);\n\t}\n\n\t#unsubscribeToEvents(): void\n\t{\n\t\tthis.#fileService.unsubscribe('onFileComplete', this.onFileComplete);\n\t\tthis.#fileService.unsubscribe('onFileRemove', this.onFileRemove);\n\n\t\tEvent.unbind(document, 'visibilitychange', this.onVisibilityChange);\n\t}\n\n\t#registerCommands(): void\n\t{\n\t\tthis.#editor.registerCommand(\n\t\t\tPASTE_COMMAND,\n\t\t\t(clipboardEvent: ClipboardEvent) => {\n\t\t\t\tconst clipboardData: DataTransfer = clipboardEvent.clipboardData;\n\t\t\t\tif (!clipboardData || !isFilePasted(clipboardData))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tclipboardEvent.preventDefault();\n\n\t\t\t\tgetFilesFromDataTransfer(clipboardData)\n\t\t\t\t\t.then((files: File[]): void => {\n\t\t\t\t\t\tfiles.forEach((file: File): void => {\n\t\t\t\t\t\t\tthis.#uploaderAdapter.getUploader().addFile(file, {\n\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t[FileEvent.LOAD_ERROR]: () => {},\n\t\t\t\t\t\t\t\t\t[FileEvent.UPLOAD_ERROR]: () => {},\n\t\t\t\t\t\t\t\t\t[FileEvent.UPLOAD_COMPLETE]: (event: BaseEvent): void => {\n\t\t\t\t\t\t\t\t\t\tconst uploaderFile: UploaderFile = event.getTarget();\n\t\t\t\t\t\t\t\t\t\tthis.insertFile(uploaderFile.toJSON());\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.catch((): void => {\n\t\t\t\t\t\tconsole.error('clipboard pasting error');\n\t\t\t\t\t});\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_NORMAL,\n\t\t);\n\t}\n\n\t#syncHighlights(): void\n\t{\n\t\tif (!this.#editor)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#editor.dispatchCommand(Plugins.File.GET_INSERTED_FILES_COMMAND, (nodes) => {\n\t\t\tconst inserted: Set<number | string> = new Set();\n\t\t\tfor (const node of nodes)\n\t\t\t{\n\t\t\t\tconst { serverFileId } = node.getInfo();\n\t\t\t\tif (Type.isStringFilled(serverFileId) || Type.isNumber(serverFileId))\n\t\t\t\t{\n\t\t\t\t\tinserted.add(serverFileId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.#uploaderAdapter.getUploader().getFiles().forEach((file: UploaderFile) => {\n\t\t\t\tif (inserted.has(file.getServerFileId()))\n\t\t\t\t{\n\t\t\t\t\tfile.setCustomData('tileSelected', true);\n\t\t\t\t\tinserted.delete(file.getServerFileId());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfile.setCustomData('tileSelected', false);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfor (const serverFileId: number | string of inserted)\n\t\t\t{\n\t\t\t\tthis.handleRemoveFile(serverFileId);\n\t\t\t}\n\t\t});\n\t}\n\n\t#getCopilotParams(): Object\n\t{\n\t\tif (Core.getParams().features.isCopilotEnabled)\n\t\t{\n\t\t\tswitch (this.#entityType)\n\t\t\t{\n\t\t\t\tcase EntityTextTypes.Task:\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcopilotOptions: {\n\t\t\t\t\t\t\tmoduleId: 'tasks',\n\t\t\t\t\t\t\tcategory: 'tasks',\n\t\t\t\t\t\t\tcontextId: `tasks_${this.#entityId}`,\n\t\t\t\t\t\t\tmenuForceTop: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttriggerBySpace: true,\n\t\t\t\t\t};\n\t\t\t\tcase EntityTextTypes.Result:\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcopilotOptions: {\n\t\t\t\t\t\t\tmoduleId: 'tasks',\n\t\t\t\t\t\t\tcategory: 'system',\n\t\t\t\t\t\t\tcontextId: `tasks_result_${this.#entityId}`,\n\t\t\t\t\t\t\tmenuForceTop: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttriggerBySpace: true,\n\t\t\t\t\t};\n\t\t\t\tdefault:\n\t\t\t\t\treturn {};\n\t\t\t}\n\t\t}\n\n\t\treturn {};\n\t}\n\n\thandleEditorChange = (): void => {\n\t\tthis.#syncHighlightsDebounced();\n\t\tthis.emit('editorChanged');\n\t};\n\n\thandleEditorBlur = (): void => {\n\t\tif (this.isTabHidden)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('editorBlurred');\n\t};\n\n\tonFileComplete = (event: BaseEvent): void => {\n\t\tconst file = event.getData();\n\t\tthis.#editor.dispatchCommand(Plugins.File.ADD_FILE_COMMAND, file);\n\t};\n\n\tonFileRemove = (event: BaseEvent): void => {\n\t\tconst { file } = event.getData();\n\t\tthis.handleRemoveFile(file.serverFileId);\n\t};\n\n\tonVisibilityChange = (): void => {\n\t\tthis.isTabHidden = document.hidden;\n\t};\n\n\thandleRemoveFile(serverFileId): void\n\t{\n\t\tthis.#editor.dispatchCommand(Plugins.File.REMOVE_FILE_COMMAND, {\n\t\t\tserverFileId,\n\t\t\tskipHistoryStack: true,\n\t\t});\n\n\t\tthis.#syncHighlightsDebounced();\n\t}\n\n\tinsertFile(fileInfo): void\n\t{\n\t\tthis.#editor.dispatchCommand(Plugins.File.INSERT_FILE_COMMAND, {\n\t\t\tserverFileId: fileInfo.serverFileId,\n\t\t\twidth: 600,\n\t\t\theight: 600,\n\t\t\tinfo: toRaw(fileInfo),\n\t\t});\n\t}\n\n\tget $store(): Store\n\t{\n\t\treturn Core.getStore();\n\t}\n}\n\nconst instances = {};\n\nfunction getKey(entityId: number | string, entityType: string): string\n{\n\treturn `${entityType}:${entityId}`;\n}\n\nexport const entityTextEditor = {\n\tget(\n\t\tentityId: number | string,\n\t\tentityType: EntityTextType = EntityTextTypes.Task,\n\t\toptions: EntityTextEditorOptions = {},\n\t): EntityTextEditor\n\t{\n\t\tconst key = getKey(entityId, entityType);\n\t\tinstances[key] ??= new EntityTextEditor(entityId, entityType, options);\n\n\t\tif (Type.isStringFilled(options?.content))\n\t\t{\n\t\t\tinstances[key].setEditorText(options.content);\n\t\t}\n\n\t\treturn instances[key];\n\t},\n\treplace(\n\t\ttempId: number | string,\n\t\tentityId: number,\n\t\tentityType: EntityTextType = EntityTextTypes.Task,\n\t): void\n\t{\n\t\tconst oldKey = getKey(tempId, entityType);\n\t\tconst newKey = getKey(entityId, entityType);\n\n\t\tinstances[newKey] = instances[oldKey];\n\t\tinstances[newKey]?.setEntityId(entityId, entityType);\n\t\tinstances[newKey]?.initService(entityId, entityType);\n\n\t\tdelete instances[oldKey];\n\t},\n\tdelete(\n\t\tentityId: number | string,\n\t\tentityType: EntityTextType = EntityTextTypes.Task,\n\t): void\n\t{\n\t\tconst key = getKey(entityId, entityType);\n\n\t\tinstances[key]?.destroy();\n\n\t\tdelete instances[key];\n\t},\n};\n","import type { BaseEvent } from 'main.core.events';\n\nimport { TextEditorComponent, type TextEditor } from 'ui.text-editor';\nimport type { VueUploaderAdapter } from 'ui.uploader.vue';\n\nimport type { UserFieldWidgetOptions } from 'disk.uploader.user-field-widget';\n\nimport { fileService } from 'tasks.v2.provider.service.file-service';\nimport { DiskUserFieldWidgetComponent } from 'tasks.v2.component.elements.user-field-widget-component';\nimport type { FileService } from 'tasks.v2.provider.service.file-service';\n\nimport { entityTextEditor, EntityTextTypes, type EntityTextEditor } from './entity-text-editor';\n\nimport './entity-text.css';\n\n// @vue/component\nexport const EntityTextArea = {\n\tcomponents: {\n\t\tTextEditorComponent,\n\t\tUserFieldWidgetComponent: DiskUserFieldWidgetComponent,\n\t},\n\tprops: {\n\t\tentityId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tentityType: {\n\t\t\ttype: String,\n\t\t\tdefault: EntityTextTypes.Task,\n\t\t\tvalidator: (value: string): boolean => Object.values(EntityTextTypes).includes(value),\n\t\t},\n\t\treadonly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tremoveFromServer: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['change', 'blur', 'filesChange'],\n\tsetup(props): {\n\t\teditor: TextEditor,\n\t\tentityTextEditor: EntityTextEditor,\n\t\tuploaderAdapter: VueUploaderAdapter,\n\t\tfileService: FileService,\n\t}\n\t{\n\t\treturn {\n\t\t\t/** @type TextEditor */\n\t\t\teditor: null,\n\t\t\tentityTextEditor: entityTextEditor.get(props.entityId, props.entityType),\n\t\t\tfileService: fileService.get(props.entityId, props.entityType),\n\t\t\tuploaderAdapter: fileService.get(props.entityId, props.entityType).getAdapter(),\n\t\t};\n\t},\n\tdata(): { files: Array<Object> }\n\t{\n\t\treturn {\n\t\t\tfiles: this.fileService.getFiles(),\n\t\t};\n\t},\n\tcomputed: {\n\t\twidgetOptions(): UserFieldWidgetOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tisEmbedded: true,\n\t\t\t\twithControlPanel: false,\n\t\t\t\tcanCreateDocuments: false,\n\t\t\t\tinsertIntoText: true,\n\t\t\t\ttileWidgetOptions: {\n\t\t\t\t\tcompact: true,\n\t\t\t\t\tenableDropzone: false,\n\t\t\t\t\thideDropArea: true,\n\t\t\t\t\treadonly: this.readonly,\n\t\t\t\t\tautoCollapse: false,\n\t\t\t\t\tremoveFromServer: this.removeFromServer,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonInsertIntoText: this.handleInsertFile,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tfilesCount(): number\n\t\t{\n\t\t\treturn this.files.length;\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.editor = this.entityTextEditor.getEditor();\n\t},\n\tmounted(): void\n\t{\n\t\tthis.fileService.subscribe('onFileAdd', this.onFileAdd);\n\t\tthis.fileService.subscribe('onFileRemove', this.onFileRemove);\n\t\tthis.entityTextEditor.subscribe('editorChanged', this.onEditorChange);\n\t\tthis.entityTextEditor.subscribe('editorBlurred', this.onEditorBlur);\n\t},\n\tunmounted(): void\n\t{\n\t\tthis.fileService.unsubscribe('onFileAdd', this.onFileAdd);\n\t\tthis.fileService.unsubscribe('onFileRemove', this.onFileRemove);\n\t\tthis.entityTextEditor.unsubscribe('editorChanged', this.onEditorChange);\n\t\tthis.entityTextEditor.unsubscribe('editorBlurred', this.onEditorBlur);\n\t},\n\tmethods: {\n\t\tonFileAdd(): void\n\t\t{\n\t\t\tthis.$emit('filesChange');\n\t\t},\n\t\tonFileRemove(): void\n\t\t{\n\t\t\tthis.$emit('filesChange');\n\t\t},\n\t\tonEditorChange(): void\n\t\t{\n\t\t\tthis.$emit('change');\n\t\t},\n\t\tonEditorBlur(): void\n\t\t{\n\t\t\tthis.$emit('blur');\n\t\t},\n\t\thandleInsertFile(event: BaseEvent): void\n\t\t{\n\t\t\tconst fileInfo = event.getData().item;\n\n\t\t\tthis.entityTextEditor.insertFile(fileInfo);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-entity-text-area-wrapper\" ref=\"editorWrapper\">\n\t\t\t<TextEditorComponent :editorInstance=\"editor\">\n\t\t\t\t<template v-if=\"filesCount > 0\" #footer>\n\t\t\t\t\t<div class=\"tasks-entity-text-area-files\" ref=\"filesWrapper\">\n\t\t\t\t\t\t<UserFieldWidgetComponent :uploaderAdapter :widgetOptions/>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</TextEditorComponent>\n\t\t</div>\n\t`,\n};\n","import { TextMd } from 'ui.system.typography.vue';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\n// @vue/component\nexport const EditButton = {\n\tcomponents: {\n\t\tBIcon,\n\t\tTextMd,\n\t},\n\tsetup(): { Outline: Object }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-card-entity-collapsible-edit-button\">\n\t\t\t<BIcon\n\t\t\t\tclass=\"tasks-card-entity-collapsible-edit-button-icon\"\n\t\t\t\t:name=\"Outline.EDIT_L\"\n\t\t\t\t:size=\"20\"\n\t\t\t/>\n\t\t\t<TextMd className=\"tasks-card-entity-collapsible-edit-button-text\">\n\t\t\t\t{{ loc('TASKS_V2_ENTITY_TEXT_EDIT') }}\n\t\t\t</TextMd>\n\t\t</div>\n\t`,\n};\n","import { TextMd } from 'ui.system.typography.vue';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\n// @vue/component\nexport const ExpandButton = {\n\tcomponents: {\n\t\tBIcon,\n\t\tTextMd,\n\t},\n\tprops: {\n\t\tshowFilesIndicator: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tfilesCount: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\tsetup(): { Outline: Object }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-card-entity-collapsible-collapse-button\">\n\t\t\t<span\n\t\t\t\tv-if=\"showFilesIndicator && filesCount\"\n\t\t\t\tclass=\"tasks-card-entity-collapsible-collapse-button-files\"\n\t\t\t>\n\t\t\t\t<BIcon\n\t\t\t\t\t:name=\"Outline.ATTACH\"\n\t\t\t\t\t:size=\"20\"\n\t\t\t\t\tclass=\"tasks-card-entity-collapsible-collapse-button-icon\"\n\t\t\t\t/>\n\t\t\t\t<TextMd className=\"tasks-card-entity-collapsible-collapse-button-text\">\n\t\t\t\t\t{{ filesCount }}\n\t\t\t\t</TextMd>\n\t\t\t</span>\n\t\t\t<TextMd className=\"tasks-card-entity-collapsible-collapse-button-text\">\n\t\t\t\t{{ loc('TASKS_V2_ENTITY_TEXT_EXPAND') }}\n\t\t\t</TextMd>\n\t\t</div>\n\t`,\n};\n","import { TextMd } from 'ui.system.typography.vue';\n\n// @vue/component\nexport const CollapseButton = {\n\tcomponents: {\n\t\tTextMd,\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-card-entity-collapsible-collapse-button\">\n\t\t\t<TextMd className=\"tasks-card-entity-collapsible-collapse-button-text\">\n\t\t\t\t{{ loc('TASKS_V2_ENTITY_TEXT_COLLAPSE') }}\n\t\t\t</TextMd>\n\t\t</div>\n\t`,\n};\n","import { HtmlFormatterComponent } from 'ui.bbcode.formatter.html-formatter';\nimport { TextMd } from 'ui.system.typography.vue';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport { EditButton } from './collapsible-action/edit-button';\nimport { ExpandButton } from './collapsible-action/expand-button';\nimport { CollapseButton } from './collapsible-action/collapse-button';\n\nimport './entity-text.css';\n\n// @vue/component\nexport const EntityCollapsibleText = {\n\tcomponents: {\n\t\tHtmlFormatterComponent,\n\t\tBIcon,\n\t\tTextMd,\n\t\tEditButton,\n\t\tExpandButton,\n\t\tCollapseButton,\n\t},\n\tprops: {\n\t\tcontent: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tfiles: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\treadonly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\topenByDefault: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\topened: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tshowFilesIndicator: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tmaxHeight: {\n\t\t\ttype: Number,\n\t\t\tdefault: 200,\n\t\t},\n\t},\n\temits: ['editButtonClick', 'update:opened'],\n\tsetup(): { Outline: Object }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisOverflowing: false,\n\t\t\tisMouseDown: false,\n\t\t\tselectionMade: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tfilesCount(): number\n\t\t{\n\t\t\treturn this.files.length;\n\t\t},\n\t\thasFiles(): boolean\n\t\t{\n\t\t\treturn this.filesCount > 0;\n\t\t},\n\t\thasContent(): boolean\n\t\t{\n\t\t\treturn this.content.length > 0;\n\t\t},\n\t\thidden(): boolean\n\t\t{\n\t\t\tif (this.opened)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.showFilesIndicator)\n\t\t\t{\n\t\t\t\treturn this.filesCount || this.isOverflowing;\n\t\t\t}\n\n\t\t\treturn this.isOverflowing;\n\t\t},\n\t\tshowCollapseButton(): boolean\n\t\t{\n\t\t\treturn this.opened && !this.openByDefault;\n\t\t},\n\t\tshowEditButton(): boolean\n\t\t{\n\t\t\treturn !this.readonly;\n\t\t},\n\t\tshowFooter(): boolean\n\t\t{\n\t\t\treturn this.hidden || this.showEditButton || this.showCollapseButton;\n\t\t},\n\t},\n\twatch: {\n\t\tasync content(): void\n\t\t{\n\t\t\tawait this.$nextTick();\n\n\t\t\tthis.updateIsOverflowing();\n\t\t},\n\t},\n\tasync mounted(): Promise<void>\n\t{\n\t\tawait this.$nextTick();\n\n\t\tthis.updateIsOverflowing();\n\n\t\tif (this.openByDefault)\n\t\t{\n\t\t\tthis.setPreviewShown(true);\n\t\t}\n\t},\n\tmethods: {\n\t\tupdateIsOverflowing(): void\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.openByDefault\n\t\t\t\t|| !this.$refs.htmlFormatter\n\t\t\t\t|| !this.$refs.preview\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst previewOffsetHeight = this.$refs.preview.offsetHeight;\n\t\t\tconst htmlFormatterOffsetHeight = this.$refs.htmlFormatter.$el.offsetHeight;\n\t\t\tconst offsetParam = this.opened ? 32 : 20;\n\n\t\t\tconst fitsWithinPreview = previewOffsetHeight - offsetParam <= htmlFormatterOffsetHeight;\n\t\t\tconst exceedsMaxHeight = htmlFormatterOffsetHeight > this.maxHeight;\n\n\t\t\tthis.isOverflowing = fitsWithinPreview && (!this.opened || exceedsMaxHeight);\n\n\t\t\tif (!this.isOverflowing && this.showCollapseButton)\n\t\t\t{\n\t\t\t\tthis.setPreviewShown(false);\n\t\t\t}\n\t\t},\n\t\tonPreviewClick(): void\n\t\t{\n\t\t\tif (this.hidden)\n\t\t\t{\n\t\t\t\tthis.setPreviewShown(true);\n\t\t\t}\n\t\t},\n\t\tsetPreviewShown(isShown: boolean): void\n\t\t{\n\t\t\tthis.$emit('update:opened', isShown);\n\t\t},\n\t\tonMouseDown(event): void\n\t\t{\n\t\t\tif (this.opened)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (event.button === 0)\n\t\t\t{\n\t\t\t\tthis.isMouseDown = true;\n\t\t\t\tthis.selectionMade = false;\n\t\t\t}\n\t\t},\n\t\tonMouseMove(): void\n\t\t{\n\t\t\tif (this.selectionMade || this.opened)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isMouseDown)\n\t\t\t{\n\t\t\t\tconst selection = window.getSelection();\n\t\t\t\tif (selection.toString().length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.selectionMade = true;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonMouseUp(event): void\n\t\t{\n\t\t\tif (this.opened)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isMouseDown = false;\n\t\t\tif (!this.selectionMade)\n\t\t\t{\n\t\t\t\tconst target = event.target;\n\t\t\t\tconst isLinkClick = target.tagName === 'A' || target.closest('a');\n\n\t\t\t\tif (!isLinkClick)\n\t\t\t\t{\n\t\t\t\t\tthis.onPreviewClick();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"hasContent\"\n\t\t\tclass=\"tasks-card-entity-collapsible-text\"\n\t\t\t:class=\"{ '--disable-animation': openByDefault }\"\n\t\t\t:style=\"{ 'maxHeight': opened ? 'none' : maxHeight + 'px' }\"\n\t\t\tref=\"preview\"\n\t\t>\n\t\t\t<HtmlFormatterComponent\n\t\t\t\t:bbcode=\"content\"\n\t\t\t\t:options=\"{ fileMode: 'disk' }\"\n\t\t\t\t:formatData=\"{ files }\"\n\t\t\t\tref=\"htmlFormatter\"\n\t\t\t\t@mousedown=\"onMouseDown\"\n\t\t\t\t@mousemove=\"onMouseMove\"\n\t\t\t\t@mouseup=\"onMouseUp\"\n\t\t\t/>\n\t\t\t<template v-if=\"hidden && isOverflowing\">\n\t\t\t\t<div class=\"tasks-card-entity-collapsible-shadow\">\n\t\t\t\t\t<div class=\"tasks-card-entity-collapsible-shadow-white-bottom\"/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t\t<slot/>\n\t\t<div\n\t\t\tv-if=\"showFooter\"\n\t\t\tclass=\"tasks-card-entity-collapsible-footer\"\n\t\t\t:class=\"{\n\t\t\t\t'--empty-content': !hasContent && hidden,\n\t\t\t\t'--without-padding': !showFilesIndicator && hasFiles,\n\t\t\t\t'--with-edit-button': showEditButton,\n\t\t\t}\"\n\t\t>\n\t\t\t<EditButton v-if=\"showEditButton\" @click=\"$emit('editButtonClick')\"/>\n\t\t\t<ExpandButton v-if=\"hidden\" :showFilesIndicator :filesCount @click=\"onPreviewClick\"/>\n\t\t\t<CollapseButton v-if=\"showCollapseButton\" @click=\"setPreviewShown(false)\"/>\n\t\t</div>\n\t`,\n};\n","import { TextSm } from 'ui.system.typography.vue';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport { hint, type HintParams } from 'ui.vue3.directives.hint';\n\nimport { tooltip } from 'tasks.v2.component.elements.hint';\n\nimport '../entity-text.css';\n\n// @vue/component\nexport const ActionButton = {\n\tcomponents: {\n\t\tBIcon,\n\t\tTextSm,\n\t},\n\tdirectives: { hint },\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tcopilotText: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\ticonName: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ticonColor: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\ticonSize: {\n\t\t\ttype: Number,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tcomputed: {\n\t\tshowTooltip(): boolean\n\t\t{\n\t\t\treturn this.title.length > 0;\n\t\t},\n\t\ttooltip(): Function\n\t\t{\n\t\t\treturn (): HintParams => tooltip({\n\t\t\t\ttext: this.title,\n\t\t\t\tpopupOptions: {\n\t\t\t\t\toffsetLeft: this.$el.offsetWidth / 2,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"tasks-card-entity-text-action-button-container\"\n\t\t\tv-hint=\"showTooltip ? tooltip : null\"\n\t\t>\n\t\t\t<button class=\"tasks-card-entity-text-action-button\" type=\"button\">\n\t\t\t\t<BIcon\n\t\t\t\t\t:name=\"iconName\"\n\t\t\t\t\t:color=\"iconColor\"\n\t\t\t\t\t:size=\"iconSize\"\n\t\t\t\t\thoverable\n\t\t\t\t\tclass=\"tasks-card-entity-text-action-button-icon\"\n\t\t\t\t/>\n\t\t\t</button>\n\t\t\t<TextSm\n\t\t\t\tv-if=\"copilotText\"\n\t\t\t\tclass=\"tasks-card-entity-text-action-button-text-copilot\"\n\t\t\t>\n\t\t\t\t{{ copilotText }}\n\t\t\t</TextSm>\n\t\t</div>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.vue';\nimport { Plugins } from 'ui.text-editor';\n\nimport { ActionButton } from './action-button';\n\n// @vue/component\nexport const CopilotButton = {\n\tname: 'EditorActionCopilot',\n\tcomponents: {\n\t\tActionButton,\n\t\tOutline,\n\t},\n\tprops: {\n\t\teditor: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tcomputed: {\n\t\tbuttonColor(): String\n\t\t{\n\t\t\treturn 'var(--ui-color-copilot-primary)';\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tthis.editor.focus(\n\t\t\t\t() => {\n\t\t\t\t\tthis.editor.dispatchCommand(Plugins.Copilot.INSERT_COPILOT_DIALOG_COMMAND);\n\t\t\t\t},\n\t\t\t\t{ defaultSelection: 'rootEnd' },\n\t\t\t);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ActionButton\n\t\t\t:iconName=\"Outline.COPILOT\"\n\t\t\t:iconColor=\"buttonColor\"\n\t\t\t:copilotText=\"loc('TASKS_V2_ENTITY_TEXT_ACTION_COPILOT')\"\n\t\t/>\n\t`,\n};\n","import { Plugins } from 'ui.text-editor';\nimport { BMenu, MenuOptions, MenuItemOptions } from 'ui.system.menu.vue';\nimport { BIcon, Outline, Editor } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\nimport 'ui.icon-set.editor';\n\nimport { ActionButton } from './action-button';\n\nimport '../entity-text.css';\n\n// @vue/component\nexport const MoreButton = {\n\tcomponents: {\n\t\tActionButton,\n\t\tBIcon,\n\t\tBMenu,\n\t},\n\tprops: {\n\t\teditor: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tEditor,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tmenuOptions(): MenuOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: 'tasks-entity-text-more-actions-menu',\n\t\t\t\tbindElement: this.$refs.actionButton.$el,\n\t\t\t\toffsetTop: 8,\n\t\t\t\titems: this.menuItems,\n\t\t\t\ttargetContainer: document.body,\n\t\t\t};\n\t\t},\n\t\tmenuItems(): MenuItemOptions[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('TASKS_V2_ENTITY_TEXT_MORE_CODE'),\n\t\t\t\t\ticon: Outline.DEVELOPER_RESOURCES,\n\t\t\t\t\tonClick: this.insertCodeBlock,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('TASKS_V2_ENTITY_TEXT_MORE_QUOTE'),\n\t\t\t\t\ticon: Outline.QUOTE,\n\t\t\t\t\tonClick: this.insertQuote,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('TASKS_V2_ENTITY_TEXT_MORE_SPOILER'),\n\t\t\t\t\ticon: Editor.INSERT_SPOILER,\n\t\t\t\t\tonClick: this.insertSpoiler,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t},\n\tmethods: {\n\t\tinsertQuote(): void\n\t\t{\n\t\t\tconst command = Plugins.Quote.TOGGLE_QUOTE_COMMAND ?? Plugins.Quote.INSERT_QUOTE_COMMAND;\n\n\t\t\tthis.editor.dispatchCommand(command);\n\t\t},\n\t\tinsertCodeBlock(): void\n\t\t{\n\t\t\tconst command = Plugins.Code.TOGGLE_CODE_COMMAND ?? Plugins.Code.INSERT_CODE_COMMAND;\n\n\t\t\tthis.editor.dispatchCommand(command);\n\t\t},\n\t\tinsertSpoiler(): void\n\t\t{\n\t\t\tconst command = Plugins.Spoiler.TOGGLE_SPOILER_COMMAND ?? Plugins.Spoiler.INSERT_SPOILER_COMMAND;\n\n\t\t\tthis.editor.dispatchCommand(command);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ActionButton \n\t\t\t:iconName=\"Outline.MORE_L\" \n\t\t\t:title=\"loc('TASKS_V2_ENTITY_TEXT_ACTION_MORE')\" \n\t\t\t@click=\"isMenuShown = true\"\n\t\t\tref=\"actionButton\"\n\t\t/>\n\t\t<BMenu v-if=\"isMenuShown\" :options=\"menuOptions\" @close=\"isMenuShown = false\"/>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.vue';\n\nimport { ActionButton } from './action-button';\n\n// @vue/component\nexport const AttachButton = {\n\tname: 'EditorActionAttach',\n\tcomponents: {\n\t\tActionButton,\n\t\tOutline,\n\t},\n\tprops: {\n\t\tfileService: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tthis.fileService.browse({\n\t\t\t\tbindElement: this.$el,\n\t\t\t\tonHideCallback: this.onFileBrowserClose,\n\t\t\t});\n\t\t},\n\t\tonFileBrowserClose(): void\n\t\t{\n\t\t\tthis.fileService.setFileBrowserClosed(false);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ActionButton\n\t\t\t:iconName=\"Outline.ATTACH\"\n\t\t\t:title=\"loc('TASKS_V2_ENTITY_TEXT_ACTION_ATTACH')\"\n\t\t\t@click=\"handleClick\"\n\t\t/>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.vue';\nimport { Plugins } from 'ui.text-editor';\n\nimport { ActionButton } from './action-button';\n\n// @vue/component\nexport const MentionButton = {\n\tname: 'EditorActionMention',\n\tcomponents: {\n\t\tActionButton,\n\t\tOutline,\n\t},\n\tprops: {\n\t\teditor: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tthis.editor.focus(\n\t\t\t\t() => {\n\t\t\t\t\tthis.editor.dispatchCommand(\n\t\t\t\t\t\tPlugins.Mention.INSERT_MENTION_DIALOG_COMMAND,\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\t{ defaultSelection: 'rootEnd' },\n\t\t\t);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ActionButton\n\t\t\t:iconName=\"Outline.MENTION\"\n\t\t\t:title=\"loc('TASKS_V2_ENTITY_TEXT_ACTION_MENTION')\"\n\t\t\t@click=\"handleClick\"\n\t\t/>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.vue';\nimport { INSERT_ORDERED_LIST_COMMAND } from 'ui.lexical.list';\n\nimport { ActionButton } from './action-button';\n\n// @vue/component\nexport const NumberListButton = {\n\tname: 'EditorActionNumberList',\n\tcomponents: {\n\t\tActionButton,\n\t\tOutline,\n\t},\n\tprops: {\n\t\teditor: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tthis.editor.dispatchCommand(INSERT_ORDERED_LIST_COMMAND);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ActionButton\n\t\t\t:iconName=\"Outline.NUMBERED_LIST\"\n\t\t\t:title=\"loc('TASKS_V2_ENTITY_TEXT_MORE_NUMBER_LIST')\"\n\t\t\t@click=\"handleClick\"\n\t\t/>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.vue';\nimport { INSERT_UNORDERED_LIST_COMMAND } from 'ui.lexical.list';\n\nimport { ActionButton } from './action-button';\n\n// @vue/component\nexport const BulletListButton = {\n\tname: 'EditorActionBulletList',\n\tcomponents: {\n\t\tActionButton,\n\t\tOutline,\n\t},\n\tprops: {\n\t\teditor: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tthis.editor.dispatchCommand(INSERT_UNORDERED_LIST_COMMAND);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ActionButton\n\t\t\t:iconName=\"Outline.BULLETED_LIST\"\n\t\t\t:title=\"loc('TASKS_V2_ENTITY_TEXT_MORE_BULLET_LIST')\"\n\t\t\t@click=\"handleClick\"\n\t\t/>\n\t`,\n};\n"],"names":["DefaultEditorOptions","Object","freeze","toolbar","floatingToolbar","removePlugins","visualOptions","borderWidth","blockSpaceInline","colorBackground","mention","dialogOptions","entities","id","EntitySelectorEntity","User","options","emailUsers","inviteEmployeeLink","itemOptions","default","link","linkTitle","StructureNode","selectMode","allowFlatDepartments","copilot","paragraphPlaceholder","EntityTextTypes","Task","Result","EntityTextEditor","EventEmitter","constructor","entityId","entityType","handleEditorChange","emit","handleEditorBlur","isTabHidden","onFileComplete","event","file","getData","dispatchCommand","Plugins","File","ADD_FILE_COMMAND","onFileRemove","handleRemoveFile","serverFileId","onVisibilityChange","document","hidden","setEventNamespace","setEntityId","initService","initEditor","Runtime","debounce","getEditor","getEntityId","getEntityType","fileService","get","getAdapter","content","restrictions","Core","getParams","additionalEditorOptions","minHeight","placeholder","Loc","getMessage","newLineMode","events","onChange","onBlur","mode","features","disk","files","getFiles","width","inviteGuestLink","lockGuestLink","mailUserIntegration","available","lockGuestLinkFeatureId","featureId","Department","TextEditor","setEditorText","setText","getItems","destroy","REMOVE_FILE_COMMAND","skipHistoryStack","insertFile","fileInfo","INSERT_FILE_COMMAND","height","info","toRaw","$store","getStore","subscribe","Event","bind","unsubscribe","unbind","registerCommand","PASTE_COMMAND","clipboardEvent","clipboardData","isFilePasted","preventDefault","getFilesFromDataTransfer","then","forEach","getUploader","addFile","FileEvent","LOAD_ERROR","UPLOAD_ERROR","UPLOAD_COMPLETE","uploaderFile","getTarget","toJSON","catch","console","error","COMMAND_PRIORITY_NORMAL","GET_INSERTED_FILES_COMMAND","nodes","inserted","Set","node","getInfo","Type","isStringFilled","isNumber","add","has","getServerFileId","setCustomData","delete","isCopilotEnabled","copilotOptions","moduleId","category","contextId","menuForceTop","triggerBySpace","instances","getKey","entityTextEditor","key","replace","tempId","oldKey","newKey","EntityTextArea","components","TextEditorComponent","UserFieldWidgetComponent","DiskUserFieldWidgetComponent","props","type","Number","String","required","validator","value","values","includes","readonly","Boolean","removeFromServer","emits","setup","editor","uploaderAdapter","data","computed","widgetOptions","isEmbedded","withControlPanel","canCreateDocuments","insertIntoText","tileWidgetOptions","compact","enableDropzone","hideDropArea","autoCollapse","onInsertIntoText","handleInsertFile","filesCount","length","created","mounted","onFileAdd","onEditorChange","onEditorBlur","unmounted","methods","$emit","item","template","EditButton","BIcon","TextMd","Outline","ExpandButton","showFilesIndicator","CollapseButton","EntityCollapsibleText","HtmlFormatterComponent","Array","openByDefault","opened","maxHeight","isOverflowing","isMouseDown","selectionMade","hasFiles","hasContent","showCollapseButton","showEditButton","showFooter","watch","$nextTick","updateIsOverflowing","setPreviewShown","$refs","htmlFormatter","preview","previewOffsetHeight","offsetHeight","htmlFormatterOffsetHeight","$el","offsetParam","fitsWithinPreview","exceedsMaxHeight","onPreviewClick","isShown","onMouseDown","button","onMouseMove","selection","window","getSelection","toString","onMouseUp","target","isLinkClick","tagName","closest","ActionButton","TextSm","directives","hint","title","copilotText","iconName","iconColor","iconSize","showTooltip","tooltip","text","popupOptions","offsetLeft","offsetWidth","CopilotButton","name","buttonColor","handleClick","focus","Copilot","INSERT_COPILOT_DIALOG_COMMAND","defaultSelection","MoreButton","BMenu","Editor","isMenuShown","menuOptions","bindElement","actionButton","offsetTop","items","menuItems","targetContainer","body","loc","icon","DEVELOPER_RESOURCES","onClick","insertCodeBlock","QUOTE","insertQuote","INSERT_SPOILER","insertSpoiler","command","Quote","TOGGLE_QUOTE_COMMAND","INSERT_QUOTE_COMMAND","Code","TOGGLE_CODE_COMMAND","INSERT_CODE_COMMAND","Spoiler","TOGGLE_SPOILER_COMMAND","INSERT_SPOILER_COMMAND","AttachButton","browse","onHideCallback","onFileBrowserClose","setFileBrowserClosed","MentionButton","Mention","INSERT_MENTION_DIALOG_COMMAND","NumberListButton","INSERT_ORDERED_LIST_COMMAND","BulletListButton","INSERT_UNORDERED_LIST_COMMAND"],"mappings":"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"}