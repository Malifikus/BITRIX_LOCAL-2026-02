{"version":3,"file":"task-service.bundle.js","sources":["../src/mappers.js","../src/auditor-service.js","../src/creator-service.js","../src/description-service.js","../src/task-get-extractor.js","../src/task-service.js","../src/mappers/replicate-creator.js","../src/index.js"],"sourcesContent":["import { Type, Text } from 'main.core';\n\nimport { Core } from 'tasks.v2.core';\nimport { Model, TemplateType } from 'tasks.v2.const';\nimport { idUtils } from 'tasks.v2.lib.id-utils';\nimport { CheckListMappers } from 'tasks.v2.provider.service.check-list-service';\nimport { RemindersMappers } from 'tasks.v2.provider.service.reminders-service';\nimport { TemplateMappers } from 'tasks.v2.provider.service.template-service';\nimport { DateStringConverter, TimeStringConverter } from 'tasks.v2.component.fields.replication';\nimport type { TaskModel, TaskReplicateParams } from 'tasks.v2.model.tasks';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\nimport type { UserDto } from 'tasks.v2.provider.service.user-service';\n\nimport type { TagDto, TaskDto, TaskSliderData, EmailDto, ReplicateParamsDto } from './types';\n\nexport function mapModelToDto(task: TaskModel): TaskDto\n{\n\tconst user = Core.getParams().currentUser;\n\tconst parentId = task.parentId;\n\tconst responsibleIds = task.responsibleIds;\n\n\treturn {\n\t\tid: task.id,\n\t\ttitle: task.title,\n\t\tdescription: mapValue(task.description, mapDescription(task.description)),\n\t\tdescriptionChecksum: task.descriptionChecksum,\n\t\tcreator: mapValue(task.creatorId, { id: task.creatorId }),\n\t\tcreatedTs: mapValue(task.createdTs, Math.floor(task.createdTs / 1000)),\n\t\tresponsible: mapValue(responsibleIds, responsibleIds?.length < 2 ? { id: responsibleIds?.[0] ?? 0 } : user),\n\t\tresponsibleCollection: mapValue(responsibleIds, responsibleIds?.map((id: number): UserDto => ({ id }))),\n\t\tdeadlineTs: mapValue(task.deadlineTs, Math.floor(task.deadlineTs / 1000)),\n\t\tdeadlineAfter: mapValue(task.deadlineAfter, Math.floor(task.deadlineAfter / 1000)),\n\t\tneedsControl: Core.getParams().restrictions.control.available ? task.needsControl : false,\n\t\tstartPlanTs: mapValue(task.startPlanTs, Math.floor(task.startPlanTs / 1000)),\n\t\tendPlanTs: mapValue(task.endPlanTs, Math.floor(task.endPlanTs / 1000)),\n\t\tstartDatePlanAfter: mapValue(task.startDatePlanAfter, Math.floor(task.startDatePlanAfter / 1000)),\n\t\tendDatePlanAfter: mapValue(task.endDatePlanAfter, Math.floor(task.endDatePlanAfter / 1000)),\n\t\tfileIds: task.fileIds,\n\t\tchecklist: task.checklist,\n\t\tparent: mapValue(parentId, idUtils.isTemplate(parentId) ? null : { id: parentId }),\n\t\tbase: mapValue(parentId, idUtils.isTemplate(parentId) ? { id: idUtils.unbox(parentId) } : null),\n\t\tdependsOn: task.relatedTaskIds,\n\t\tganttLinks: mapValue(task.ganttTaskIds, mapGanttLinks(task.id, task.ganttTaskIds)),\n\t\tgroup: mapValue(task.groupId, { id: task.groupId }),\n\t\tstage: mapValue(task.stageId, { id: task.stageId }),\n\t\tepicId: task.epicId,\n\t\tstoryPoints: task.storyPoints,\n\t\tflow: mapValue(task.flowId, { id: task.flowId }),\n\t\tpriority: mapValue(task.isImportant, task.isImportant ? 'high' : 'low'),\n\t\tstatus: task.status,\n\t\tstatusChangedTs: mapValue(task.statusChangedTs, Math.floor(task.statusChangedTs / 1000)),\n\t\taccomplices: mapValue(task.accomplicesIds, task.accomplicesIds?.map((id: number): UserDto => ({ id }))),\n\t\tauditors: mapValue(task.auditorsIds, task.auditorsIds?.map((id: number): UserDto => ({ id }))),\n\t\ttags: mapValue(task.tags, task.tags?.map((name: string): TagDto => ({ name }))),\n\t\tchatId: task.chatId,\n\t\tcrmItemIds: task.crmItemIds,\n\t\temail: task.email,\n\t\tallowsChangeDeadline: task.allowsChangeDeadline,\n\t\tallowsChangeDatePlan: task.allowsChangeDatePlan,\n\t\tallowsTimeTracking: task.allowsTimeTracking,\n\t\testimatedTime: task.estimatedTime,\n\t\tmatchesWorkTime: Core.getParams().restrictions.skipWeekends.available ? task.matchesWorkTime : false,\n\t\tmatchesSubTasksTime: (\n\t\t\tCore.getParams().restrictions.relatedSubtaskDeadlines.available\n\t\t\t\t? task.matchesSubTasksTime\n\t\t\t\t: false\n\t\t),\n\t\tautocompleteSubTasks: (\n\t\t\tCore.getParams().restrictions.relatedSubtaskDeadlines.available\n\t\t\t\t? task.autocompleteSubTasks\n\t\t\t\t: false\n\t\t),\n\t\tsource: task.source,\n\t\ttemplateId: task.templateId,\n\t\trequireResult: task.requireResult,\n\t\treminders: mapValue(task.reminders, task.reminders?.map((it) => RemindersMappers.mapModelToDto(it))),\n\t\tmaxDeadlineChangeDate: task.maxDeadlineChangeDate,\n\t\tmaxDeadlineChanges: task.maxDeadlineChanges,\n\t\trequireDeadlineChangeReason: task.requireDeadlineChangeReason,\n\t\tdeadlineChangeReason: task.deadlineChangeReason,\n\t\tcontainsSubTasks: task.containsSubTasks,\n\t\tuserFields: task.userFields,\n\t\ttype: mapValue(task.isForNewUser, task.isForNewUser ? TemplateType.NewUsers : TemplateType.Usual),\n\t\tpermissions: mapValue(\n\t\t\ttask.permissions,\n\t\t\ttask.permissions?.map((it) => TemplateMappers.mapPermissionModelToDto(it)),\n\t\t),\n\t\tmark: task.mark,\n\t\treplicate: task.replicate && Type.isObject(task.replicateParams),\n\t\treplicateParams: mapReplicateParamsToDto(task),\n\t};\n}\n\nexport function mapDtoToModel(taskDto: TaskDto): TaskModel\n{\n\tconst allowedNullFields = new Set([\n\t\t'maxDeadlineChangeDate',\n\t\t'maxDeadlineChanges',\n\t]);\n\n\tconst task: TaskModel = {\n\t\tid: taskDto.id,\n\t\ttitle: taskDto.title,\n\t\tisImportant: mapValue(taskDto.priority, taskDto.priority === 'high'),\n\t\tdescription: mapValue(taskDto.description, Text.decode(taskDto.description)),\n\t\tdescriptionChecksum: taskDto.descriptionChecksum,\n\t\tcreatorId: taskDto.creator?.id,\n\t\tcreatedTs: mapValue(taskDto.createdTs, taskDto.createdTs * 1000),\n\t\tresponsibleIds: mapTaskDtoToResponsibleIds(taskDto),\n\t\tdeadlineTs: mapValue(taskDto.deadlineTs, taskDto.deadlineTs * 1000),\n\t\tdeadlineAfter: mapValue(taskDto.deadlineAfter, taskDto.deadlineAfter * 1000),\n\t\tneedsControl: taskDto.needsControl,\n\t\tstartPlanTs: mapValue(taskDto.startPlanTs, taskDto.startPlanTs * 1000),\n\t\tendPlanTs: mapValue(taskDto.endPlanTs, taskDto.endPlanTs * 1000),\n\t\tstartDatePlanAfter: mapValue(taskDto.startDatePlanAfter, taskDto.startDatePlanAfter * 1000),\n\t\tendDatePlanAfter: mapValue(taskDto.endDatePlanAfter, taskDto.endDatePlanAfter * 1000),\n\t\tfileIds: taskDto.fileIds,\n\t\tchecklist: taskDto.checklist,\n\t\tcontainsChecklist: taskDto.containsChecklist,\n\t\tparentId: taskDto.parent?.id ?? mapValue(taskDto.base, idUtils.boxTemplate(taskDto.base?.id)),\n\t\tcontainsSubTasks: taskDto.containsSubTasks ?? taskDto.containsSubTemplates,\n\t\tcontainsRelatedTasks: taskDto.containsRelatedTasks,\n\t\tcontainsGanttLinks: taskDto.containsGanttLinks,\n\t\tcontainsPlacements: taskDto.containsPlacements,\n\t\tcontainsCommentFiles: taskDto.containsCommentFiles,\n\t\trequireResult: taskDto.requireResult,\n\t\tcontainsResults: taskDto.containsResults,\n\t\tnumberOfReminders: taskDto.numberOfReminders,\n\t\tgroupId: taskDto.group?.id,\n\t\tstageId: taskDto.stage?.id,\n\t\tflowId: taskDto.flow?.id,\n\t\tstatus: taskDto.status,\n\t\tstatusChangedTs: mapValue(taskDto.statusChangedTs, taskDto.statusChangedTs * 1000),\n\t\taccomplicesIds: mapValue(taskDto.accomplices, taskDto.accomplices?.map(({ id }: UserDto): number => id)),\n\t\tauditorsIds: mapValue(taskDto.auditors, taskDto.auditors?.map(({ id }: UserDto): number => id)),\n\t\tchatId: taskDto.chatId,\n\t\tcrmItemIds: taskDto.crmItemIds,\n\t\tallowsChangeDeadline: taskDto.allowsChangeDeadline,\n\t\tallowsChangeDatePlan: taskDto.allowsChangeDatePlan,\n\t\tallowsTimeTracking: taskDto.allowsTimeTracking,\n\t\ttimers: taskDto.timers,\n\t\ttimeSpent: taskDto.timeSpent,\n\t\testimatedTime: taskDto.estimatedTime,\n\t\tnumberOfElapsedTimes: taskDto.numberOfElapsedTimes,\n\t\tmatchesWorkTime: taskDto.matchesWorkTime,\n\t\tmatchesSubTasksTime: taskDto.matchesSubTasksTime,\n\t\tautocompleteSubTasks: taskDto.autocompleteSubTasks,\n\t\ttemplateId: taskDto.templateId,\n\t\trights: taskDto.rights,\n\t\ttags: mapValue(taskDto.tags, taskDto.tags?.map(({ name }: TagDto): string => name)),\n\t\tisFavorite: mapValue(taskDto.inFavorite, taskDto.inFavorite?.includes(Core.getParams().currentUser.id)),\n\t\tisMuted: mapValue(taskDto.inMute, taskDto.inMute?.includes(Core.getParams().currentUser.id)),\n\t\tarchiveLink: taskDto.archiveLink,\n\t\tmaxDeadlineChangeDate: taskDto.maxDeadlineChangeDate,\n\t\tmaxDeadlineChanges: taskDto.maxDeadlineChanges,\n\t\trequireDeadlineChangeReason: taskDto.requireDeadlineChangeReason,\n\t\tdeadlineChangeReason: taskDto.deadlineChangeReason,\n\t\temail: mapValue(\n\t\t\ttaskDto.email,\n\t\t\ttaskDto.email ? { ...taskDto.email, dateTs: taskDto.email.dateTs * 1000 } : null,\n\t\t),\n\t\tuserFields: mapValue(taskDto.userFields, mapUserFields(taskDto.id, taskDto.userFields ?? [])),\n\t\tisForNewUser: mapValue(taskDto.type, taskDto.type === TemplateType.NewUsers),\n\t\tpermissions: mapValue(\n\t\t\ttaskDto.permissions,\n\t\t\ttaskDto.permissions?.map((it) => TemplateMappers.mapPermissionDtoToModel(it)),\n\t\t),\n\t\treplicate: taskDto.replicate,\n\t\tmark: taskDto.mark,\n\t\treplicateParams: mapReplicateParamsToModel(taskDto),\n\t};\n\n\treturn Object.fromEntries(\n\t\tObject.entries(task).filter(([key: string, value: any]) => {\n\t\t\tif (allowedNullFields.has(key))\n\t\t\t{\n\t\t\t\treturn !Type.isUndefined(value);\n\t\t\t}\n\n\t\t\treturn !Type.isNil(value);\n\t\t}),\n\t);\n}\n\nexport function mapModelToSliderData(task: TaskModel, checkLists: CheckListModel[]): TaskSliderData\n{\n\tconst accomplices = CheckListMappers.getUserIdsFromChecklists(checkLists, 'accomplices');\n\tconst auditors = CheckListMappers.getUserIdsFromChecklists(checkLists, 'auditors');\n\n\tconst data = {\n\t\tTITLE: task.title,\n\t\tDESCRIPTION: mapValue(task.description, mapDescription(task.description)),\n\t\tRESPONSIBLE_ID: task.responsibleIds[0],\n\t\tGROUP_ID: task.groupId,\n\t\tDEADLINE_TS: mapValue(task.deadlineTs, Math.floor(task.deadlineTs / 1000)),\n\t\tIS_IMPORTANT: mapValue(task.isImportant, task.isImportant ? 'Y' : null),\n\t\tFILE_IDS: mapValue(task.fileIds, task.fileIds?.length > 0 ? task.fileIds : null),\n\t\tCHECKLIST: CheckListMappers.mapModelToSliderData(checkLists),\n\t\tACCOMPLICES: mapValue(accomplices, accomplices.length > 0 ? accomplices : null),\n\t\tAUDITORS: mapValue(auditors, auditors.length > 0 ? auditors : null),\n\t};\n\n\treturn Object.fromEntries(Object.entries(data).filter(([, value]) => !Type.isNil(value)));\n}\n\nexport function mapSliderDataToModel(data: TaskSliderData): TaskModel\n{\n\tconst task: TaskModel = {\n\t\ttitle: data.TITLE ? decodeURIComponent(data.TITLE) : null,\n\t\tdescription: Text.decode(data.DESCRIPTION),\n\t\tfileIds: data.UF_TASK_WEBDAV_FILES,\n\t\tparentId: Number(data.PARENT_ID) || mapValue(data.BASE_TEMPLATE, idUtils.boxTemplate(data.BASE_TEMPLATE)),\n\t\tcrmItemIds: data.UF_CRM_TASK ? data.UF_CRM_TASK.split(';').filter((id) => id.trim()) : undefined,\n\t\temail: data.UF_MAIL_MESSAGE ? mapEmail(data) : undefined,\n\t\ttags: data.TAGS ? data.TAGS.split(',').map((tag) => tag.trim()) : undefined,\n\t\tgroupId: Number(data.GROUP_ID) || undefined,\n\t\tflowId: Number(data.FLOW_ID) || undefined,\n\t\ttemplateId: Number(data.TEMPLATE) || undefined,\n\t\tcopiedFromId: Number(data.COPY) || undefined,\n\t\tsource: mapValue(data.IM_MESSAGE_ID, {\n\t\t\ttype: 'chat',\n\t\t\tentityId: Number(data.IM_CHAT_ID),\n\t\t\tsubEntityId: Number(data.IM_MESSAGE_ID),\n\t\t}),\n\t\tcontext: data.context || undefined,\n\t};\n\n\treturn Object.fromEntries(Object.entries(task).filter(([, value]) => !Type.isNil(value)));\n}\n\nfunction mapValue(value: any, mappedValue: any): any | undefined\n{\n\treturn Type.isNil(value) ? value : mappedValue;\n}\n\n// TODO: Temporary. Remove when removing old full card\nfunction mapDescription(description: ?string): ?string\n{\n\treturn description?.replaceAll(/\\[p]\\n|\\[p]\\[\\/p]|\\[\\/p]/gi, '').trim();\n}\n\nfunction mapGanttLinks(taskId: number, taskIds: number[]): { [taskId: number]: string }\n{\n\tif (!taskIds)\n\t{\n\t\treturn null;\n\t}\n\n\treturn Object.fromEntries(\n\t\ttaskIds.map((dependentId: number) => [\n\t\t\tdependentId,\n\t\t\tCore.getStore().getters[`${Model.GanttLinks}/getLink`]({ taskId, dependentId }).type,\n\t\t]),\n\t);\n}\n\nfunction mapEmail(data: Object): EmailDto\n{\n\tconst id = Number(data.UF_MAIL_MESSAGE);\n\tconst title = decodeURIComponent(data.MAIL_SUBJECT);\n\tconst from = decodeURIComponent(data.MAIL_FROM);\n\tconst dateTs = data.MAIL_DATE ? parseInt(data.MAIL_DATE, 10) * 1000 : null;\n\n\treturn {\n\t\tid,\n\t\ttitle,\n\t\tfrom,\n\t\tdateTs,\n\t\tlink: `/mail/message/${id}`,\n\t};\n}\n\nfunction mapUserFields(taskId: number, userFields: Array): Array<{ key: string, value: any }>\n{\n\tif (Type.isArrayFilled(userFields))\n\t{\n\t\treturn userFields;\n\t}\n\n\tconst task: TaskModel = Core.getStore().getters[`${Model.Tasks}/getById`](taskId);\n\n\treturn task && Type.isArray(task.userFields) ? task.userFields : [];\n}\n\nfunction mapTaskDtoToResponsibleIds(taskDto: TaskDto): number[] | undefined\n{\n\tconst responsibleIds: Set<number> = new Set();\n\n\tif (Type.isArray(taskDto.responsibleCollection))\n\t{\n\t\ttaskDto.responsibleCollection.forEach(({ id }) => responsibleIds.add(id));\n\t}\n\n\tif (Type.isArray(taskDto.multiResponsibles))\n\t{\n\t\ttaskDto.multiResponsibles.forEach(({ id }) => responsibleIds.add(id));\n\t}\n\n\tif (Type.isNumber(taskDto.responsible?.id))\n\t{\n\t\tresponsibleIds.add(taskDto.responsible.id);\n\t}\n\n\tif (responsibleIds.size > 0)\n\t{\n\t\treturn [...responsibleIds];\n\t}\n\n\treturn undefined;\n}\n\nfunction mapReplicateParamsToModel({ replicateParams }: TaskModel): ?TaskReplicateParams\n{\n\tif (!Type.isObject(replicateParams))\n\t{\n\t\treturn null;\n\t}\n\n\tconst startDate = DateStringConverter.parseServerDate(replicateParams.startDate);\n\tconst startTime = TimeStringConverter.parseServerTime(replicateParams.time);\n\n\tconst startTs = DateStringConverter.convertServerDateToTs(startDate, startTime);\n\n\tlet endTs = null;\n\tif (!Type.isNil(replicateParams.endDate))\n\t{\n\t\tconst endDate = DateStringConverter.parseServerDate(replicateParams.endDate);\n\t\tendTs = DateStringConverter.convertServerDateToTs(endDate);\n\t}\n\n\treturn {\n\t\t...replicateParams,\n\t\tstartTs,\n\t\tendTs,\n\t\tyearlyMonth1: mapValue(replicateParams.yearlyMonth1, replicateParams.yearlyMonth1 + 1),\n\t\tyearlyMonth2: mapValue(replicateParams.yearlyMonth2, replicateParams.yearlyMonth2 + 1),\n\t\tyearlyWeekDay: mapValue(replicateParams.yearlyWeekDay, replicateParams.yearlyWeekDay + 1),\n\t};\n}\n\nfunction mapReplicateParamsToDto({ replicateParams }: TaskModel): ReplicateParamsDto | undefined\n{\n\tif (!Type.isObject(replicateParams))\n\t{\n\t\treturn undefined;\n\t}\n\n\tconst startDate = DateStringConverter.convertTsToServerDateString(replicateParams.startTs);\n\tconst time = TimeStringConverter.convertTsToServerTimeString(replicateParams.startTs);\n\n\tconst endDate = Type.isNil(replicateParams.endTs)\n\t\t? null\n\t\t: DateStringConverter.convertTsToServerDateString(replicateParams.endTs)\n\t;\n\n\treturn {\n\t\t...replicateParams,\n\t\tstartDate,\n\t\ttime,\n\t\tendDate,\n\t\tyearlyMonth1: mapValue(replicateParams.yearlyMonth1, replicateParams.yearlyMonth1 - 1),\n\t\tyearlyMonth2: mapValue(replicateParams.yearlyMonth2, replicateParams.yearlyMonth2 - 1),\n\t\tyearlyWeekDay: mapValue(replicateParams.yearlyWeekDay, replicateParams.yearlyWeekDay - 1),\n\t};\n}\n","import { Core } from 'tasks.v2.core';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { taskService } from './task-service';\nimport { UpdateResult } from './types';\n\nexport const auditorService = new class\n{\n\tasync update(task: TaskModel, taskBefore: TaskModel): Promise<UpdateResult>\n\t{\n\t\tconst idsToAdd = task.auditorsIds.filter((id) => !taskBefore.auditorsIds.includes(id));\n\t\tconst idsToDelete = taskBefore.auditorsIds.filter((id) => !task.auditorsIds.includes(id));\n\n\t\tconst addResult = await this.#add(idsToAdd, taskBefore);\n\t\tconst deleteResult = await this.#delete(idsToDelete, taskBefore);\n\n\t\treturn { ...addResult, ...deleteResult };\n\t}\n\n\t#add(auditorsIds: number[], taskBefore: TaskModel): Promise<UpdateResult>\n\t{\n\t\tif (auditorsIds.length === 0)\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\tconst watch = auditorsIds.length === 1 && auditorsIds[0] === Core.getParams().currentUser.id;\n\t\tconst endpoint = watch ? 'Task.Audit.watch' : 'Task.Stakeholder.Auditor.add';\n\n\t\treturn taskService.requestUpdate(endpoint, { auditorsIds }, taskBefore);\n\t}\n\n\t#delete(auditorsIds: number[], taskBefore: TaskModel): Promise<UpdateResult>\n\t{\n\t\tif (auditorsIds.length === 0)\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\tconst unwatch = auditorsIds.length === 1 && auditorsIds[0] === Core.getParams().currentUser.id;\n\t\tconst endpoint = unwatch ? 'Task.Audit.unwatch' : 'Task.Stakeholder.Auditor.delete';\n\n\t\treturn taskService.requestUpdate(endpoint, { auditorsIds }, taskBefore);\n\t}\n}();\n","import { Core } from 'tasks.v2.core';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { taskService } from './task-service';\nimport { UpdateResult } from './types';\n\nexport const creatorService = new class\n{\n\tupdate(task: TaskModel, taskBefore: TaskModel): Promise<UpdateResult>\n\t{\n\t\tconst currentUserId = Core.getParams().currentUser.id;\n\t\tconst isAdmin = Core.getParams().rights.user.admin;\n\n\t\tconst fields = {\n\t\t\tcreatorId: task.creatorId,\n\t\t\tresponsibleIds: isAdmin ? taskBefore.responsibleIds : [currentUserId],\n\t\t};\n\n\t\treturn taskService.requestUpdate('Task.Stakeholder.Creator.update', fields, taskBefore);\n\t}\n}();\n","import { Endpoint } from 'tasks.v2.const';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { taskService } from './task-service';\nimport { UpdateResult } from './types';\n\nexport const descriptionService = new class\n{\n\tasync update(task: TaskModel, taskBefore: TaskModel): Promise<UpdateResult>\n\t{\n\t\tconst endpoint = task.forceUpdateDescription\n\t\t\t? Endpoint.TaskDescriptionForceUpdate\n\t\t\t: Endpoint.TaskDescriptionUpdate\n\t\t;\n\n\t\tconst fields = {\n\t\t\tdescription: task.description,\n\t\t\tdescriptionChecksum: task.descriptionChecksum,\n\t\t};\n\n\t\treturn taskService.requestUpdate(endpoint, fields, taskBefore);\n\t}\n}();\n","import { GroupMappers } from 'tasks.v2.provider.service.group-service';\nimport { FlowMappers } from 'tasks.v2.provider.service.flow-service';\nimport { UserMappers, type UserDto } from 'tasks.v2.provider.service.user-service';\nimport type { FlowModel } from 'tasks.v2.model.flows';\nimport type { GroupModel } from 'tasks.v2.model.groups';\nimport type { StageModel } from 'tasks.v2.model.stages';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { UserModel } from 'tasks.v2.model.users';\n\nimport { mapDtoToModel } from './mappers';\nimport type { TaskDto } from './types';\n\nexport class TaskGetExtractor\n{\n\t#data: TaskDto;\n\n\tconstructor(data: TaskDto)\n\t{\n\t\tthis.#data = data;\n\t}\n\n\tgetTask(): TaskModel\n\t{\n\t\treturn mapDtoToModel(this.#data);\n\t}\n\n\tgetFlow(): FlowModel | null\n\t{\n\t\treturn this.#data.flow ? FlowMappers.mapDtoToModel(this.#data.flow) : null;\n\t}\n\n\tgetGroup(): GroupModel | null\n\t{\n\t\treturn this.#data.group?.id ? GroupMappers.mapDtoToModel(this.#data.group) : null;\n\t}\n\n\tgetStages(): StageModel[]\n\t{\n\t\treturn this.#data.stage ? [GroupMappers.mapStageDtoToModel(this.#data.stage)] : [];\n\t}\n\n\tgetUsers(): UserModel[]\n\t{\n\t\treturn [\n\t\t\tthis.#data.creator ?? [],\n\t\t\tthis.#data.responsible ?? [],\n\t\t\t...this.#data?.responsibleCollection ?? [],\n\t\t\t...this.#data.multiResponsibles ?? [],\n\t\t\t...this.#data?.accomplices ?? [],\n\t\t\t...this.#data?.auditors ?? [],\n\t\t].map((userDto: UserDto): UserModel => UserMappers.mapDtoToModel(userDto));\n\t}\n}\n","import { Event, Runtime, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport type { Store } from 'ui.vue3.vuex';\n\nimport { Core } from 'tasks.v2.core';\nimport { Model, EventName, Endpoint } from 'tasks.v2.const';\nimport { idUtils } from 'tasks.v2.lib.id-utils';\nimport { apiClient } from 'tasks.v2.lib.api-client';\nimport { templateService } from 'tasks.v2.provider.service.template-service';\nimport { fileService } from 'tasks.v2.provider.service.file-service';\nimport { subTasksService, relatedTasksService, ganttService } from 'tasks.v2.provider.service.relation-service';\nimport { checkListService } from 'tasks.v2.provider.service.check-list-service';\nimport { remindersService } from 'tasks.v2.provider.service.reminders-service';\nimport { resultService } from 'tasks.v2.provider.service.result-service';\nimport { userFieldsManager } from 'tasks.v2.component.fields.user-fields';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { auditorService } from './auditor-service';\nimport { creatorService } from './creator-service';\nimport { descriptionService } from './description-service';\nimport { TaskGetExtractor } from './task-get-extractor';\nimport { mapModelToDto } from './mappers';\nimport type { TaskDto, SeparateFieldsMeta, TaskSelect, UpdateResult } from './types';\n\nconst separateFields: SeparateFieldsMeta[] = [\n\t{\n\t\tfields: new Set(['storyPoints', 'epicId']),\n\t\tendpoint: Endpoint.ScrumUpdateTask,\n\t},\n\t{\n\t\tfields: new Set(['requireResult']),\n\t\tendpoint: 'Task.Result.require',\n\t},\n\t{\n\t\tfields: new Set(['deadlineTs', 'deadlineChangeReason']),\n\t\tendpoint: Endpoint.TaskDeadlineUpdate,\n\t},\n\t{\n\t\tfields: new Set(['startPlanTs', 'endPlanTs', 'matchesWorkTime', 'matchesSubTasksTime']),\n\t\tendpoint: Endpoint.TaskPlanUpdate,\n\t},\n\t{\n\t\tfields: new Set(['responsibleIds']),\n\t\tendpoint: Endpoint.TaskStakeholderResponsibleDelegate,\n\t},\n\t{\n\t\tfields: new Set(['crmItemIds']),\n\t\tendpoint: Endpoint.TaskCrmItemSet,\n\t},\n\t{\n\t\tfields: new Set(['accomplicesIds']),\n\t\tendpoint: 'Task.Stakeholder.Accomplice.set',\n\t},\n\t{\n\t\tfields: new Set(['creatorId']),\n\t\tservice: creatorService,\n\t},\n\t{\n\t\tfields: new Set(['auditorsIds']),\n\t\tservice: auditorService,\n\t},\n\t{\n\t\tfields: new Set(['description', 'forceUpdateDescription']),\n\t\tservice: descriptionService,\n\t},\n];\n\nexport const taskService = new class\n{\n\tconstructor()\n\t{\n\t\tEvent.bind(window, 'beforeunload', () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst pendingIds = Object.keys(this.#updatePromises);\n\t\t\t\tpendingIds.forEach((id) => this.#updateTask(id));\n\t\t\t});\n\t\t});\n\t}\n\n\tasync get(id: number | string, taskSelect: TaskSelect, ignoreContains: boolean = false): Promise<TaskModel>\n\t{\n\t\tif (idUtils.isTemplate(id))\n\t\t{\n\t\t\tawait templateService.get(id);\n\n\t\t\tawait this.$store.dispatch(`${Model.Tasks}/removePartiallyLoaded`, id);\n\n\t\t\treturn this.getStoreTask(id);\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tconst data = await apiClient.post(Endpoint.TaskGet, { task: { id }, taskSelect });\n\n\t\t\tthis.extractTask(data, ignoreContains);\n\n\t\t\tawait this.$store.dispatch(`${Model.Tasks}/removePartiallyLoaded`, id);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error(Endpoint.TaskGet, error);\n\t\t}\n\n\t\treturn this.getStoreTask(id);\n\t}\n\n\tasync getCopy(id: number, tmpId: string): Promise<void>\n\t{\n\t\tif (idUtils.isTemplate(tmpId))\n\t\t{\n\t\t\tawait templateService.getCopy(idUtils.boxTemplate(id), tmpId);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst task = await this.get(id);\n\n\t\tif (task.checklist?.length > 0)\n\t\t{\n\t\t\tawait checkListService.load(id, tmpId);\n\t\t}\n\n\t\tconst fields = {\n\t\t\ttitle: task.title,\n\t\t\tdescription: task.description,\n\t\t\tcreatorId: Core.getParams().currentUser.id,\n\t\t\tresponsibleIds: task.responsibleIds,\n\t\t\tdeadlineTs: task.deadlineTs,\n\t\t\tneedsControl: task.needsControl,\n\t\t\tstartPlanTs: task.startPlanTs,\n\t\t\tendPlanTs: task.endPlanTs,\n\t\t\tfileIds: task.fileIds,\n\t\t\tcontainsSubTasks: task.containsSubTasks,\n\t\t\tgroupId: task.groupId,\n\t\t\tflowId: task.flowId,\n\t\t\tisImportant: task.isImportant,\n\t\t\taccomplicesIds: task.accomplicesIds,\n\t\t\tauditorsIds: task.auditorsIds,\n\t\t\tparentId: task.parentId,\n\t\t\tallowsChangeDeadline: task.allowsChangeDeadline,\n\t\t\tmatchesWorkTime: task.matchesWorkTime,\n\t\t\ttags: task.tags,\n\t\t\tcrmItemIds: task.crmItemIds,\n\t\t\trequireResult: task.requireResult,\n\t\t\tcontainsRelatedTasks: task.containsRelatedTasks,\n\t\t\trelatedTaskIds: task.relatedTaskIds,\n\t\t\treminders: task.reminders,\n\t\t\tnumberOfReminders: task.numberOfReminders,\n\t\t\tallowsTimeTracking: task.allowsTimeTracking,\n\t\t\testimatedTime: task.estimatedTime,\n\t\t\tuserFields: task.userFields,\n\t\t\tepicId: task.epicId,\n\t\t\tstoryPoints: task.storyPoints,\n\t\t};\n\n\t\tif (Type.isArrayFilled(fields.userFields))\n\t\t{\n\t\t\tfields.userFields = userFieldsManager.prepareUserFieldsForTaskFromTemplate(\n\t\t\t\tfields.userFields,\n\t\t\t\tCore.getParams().taskUserFieldScheme,\n\t\t\t);\n\t\t}\n\n\t\tthis.updateStoreTask(tmpId, fields);\n\t}\n\n\tasync getRights(id: number): Promise<void>\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst { rights } = await apiClient.post(Endpoint.TaskAccessGet, { task: { id } });\n\n\t\t\tthis.updateStoreTask(id, { rights: { ...this.getStoreTask(id)?.rights, ...rights } });\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error(Endpoint.TaskAccessGet, error);\n\t\t}\n\t}\n\n\tasync add(task: TaskModel): Promise<[number, ?Error]>\n\t{\n\t\tif (idUtils.isTemplate(task.id))\n\t\t{\n\t\t\treturn templateService.add(task);\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tconst data = await apiClient.post(Endpoint.TaskAdd, { task: mapModelToDto(task) });\n\n\t\t\tawait this.onAfterTaskAdded(task, data);\n\n\t\t\treturn [data.id, null];\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error(Endpoint.TaskAdd, error);\n\n\t\t\treturn [0, new Error(error.errors?.[0]?.message)];\n\t\t}\n\t}\n\n\tasync onAfterTaskAdded(initialTask: TaskModel, data: TaskDto): void\n\t{\n\t\tthis.insertStoreTask({ ...initialTask, id: data.id });\n\n\t\tthis.extractTask(data);\n\n\t\tif (initialTask.checklist?.length > 0)\n\t\t{\n\t\t\tawait checkListService.save(\n\t\t\t\tdata.id,\n\t\t\t\tthis.$store.getters[`${Model.CheckList}/getByIds`](initialTask.checklist),\n\t\t\t\ttrue,\n\t\t\t);\n\t\t}\n\n\t\tconst remindersIds = this.$store.getters[`${Model.Reminders}/getIds`](\n\t\t\tinitialTask.id,\n\t\t\tCore.getParams().currentUser.id,\n\t\t);\n\t\tif (remindersIds.length > 0)\n\t\t{\n\t\t\tawait remindersService.set(\n\t\t\t\tdata.id,\n\t\t\t\tremindersIds.map((id) => this.$store.getters[`${Model.Reminders}/getById`](id)),\n\t\t\t);\n\t\t}\n\n\t\tif (initialTask.responsibleIds.length > 1)\n\t\t{\n\t\t\tconst userIds = await this.addMultiTask(data.id, initialTask.responsibleIds);\n\n\t\t\tsubTasksService.addStore(initialTask.id, userIds.map((id) => `userTask${id}`));\n\t\t}\n\n\t\tif (initialTask.results?.length > 0)\n\t\t{\n\t\t\tawait resultService.save(\n\t\t\t\tdata.id,\n\t\t\t\tthis.$store.getters[`${Model.Results}/getByIds`](initialTask.results),\n\t\t\t\ttrue,\n\t\t\t);\n\t\t}\n\n\t\tif (initialTask.relatedToTaskId)\n\t\t{\n\t\t\tvoid relatedTasksService.add(initialTask.relatedToTaskId, [data.id]);\n\t\t}\n\n\t\tEventEmitter.emit(EventName.TaskAdded, {\n\t\t\ttask: this.getStoreTask(data.id),\n\t\t\tinitialTask,\n\t\t});\n\n\t\tinitialTask = this.getStoreTask(initialTask.id);\n\t\tconst subTaskIds = initialTask.subTaskIds;\n\t\tconst relatedTaskIds = initialTask.relatedTaskIds;\n\t\tconst ganttTaskIds = initialTask.ganttTaskIds;\n\n\t\tsubTaskIds.forEach((id) => {\n\t\t\tif (/^tmp\\..+/.test(id))\n\t\t\t{\n\t\t\t\tthis.deleteStore(id);\n\t\t\t}\n\t\t});\n\n\t\tif (initialTask.containsSubTasks)\n\t\t{\n\t\t\tsubTasksService.addStore(data.id, subTaskIds);\n\t\t\tvoid subTasksService.list(data.id, true);\n\t\t}\n\n\t\tif (initialTask.containsRelatedTasks)\n\t\t{\n\t\t\trelatedTasksService.addStore(data.id, relatedTaskIds);\n\t\t\tvoid relatedTasksService.list(data.id, true);\n\t\t}\n\n\t\tif (initialTask.containsGanttLinks)\n\t\t{\n\t\t\tganttService.addStore(data.id, ganttTaskIds);\n\t\t\tvoid ganttService.list(data.id, true);\n\t\t}\n\n\t\tif (initialTask.parentId)\n\t\t{\n\t\t\tsubTasksService.addStore(initialTask.parentId, [data.id]);\n\t\t}\n\n\t\tthis.deleteStore(initialTask.id);\n\t}\n\n\tasync copy(task: TaskModel, withSubTasks: boolean): Promise<[number, ?Error]>\n\t{\n\t\tif (idUtils.isTemplate(task.id))\n\t\t{\n\t\t\treturn templateService.copy(task);\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tconst checkLists = this.$store.getters[`${Model.CheckList}/getByIds`](task.checklist);\n\n\t\t\tconst data = await apiClient.post(Endpoint.TaskCopy, {\n\t\t\t\ttask: mapModelToDto({ ...task, id: task.copiedFromId, checklist: checkLists }),\n\t\t\t\twithSubTasks,\n\t\t\t});\n\n\t\t\tif (task.responsibleIds.length > 1)\n\t\t\t{\n\t\t\t\tconst userIds = await this.addMultiTask(data.id, task.responsibleIds);\n\n\t\t\t\tsubTasksService.addStore(task.id, userIds.map((id) => `userTask${id}`));\n\t\t\t}\n\n\t\t\tthis.updateStoreTask(task.id, { id: data.id });\n\n\t\t\tthis.extractTask(data);\n\n\t\t\tEventEmitter.emit(EventName.TaskAdded, {\n\t\t\t\ttask: this.getStoreTask(data.id),\n\t\t\t\tinitialTask: task,\n\t\t\t});\n\n\t\t\tif (task.checklist.length > 0)\n\t\t\t{\n\t\t\t\tvoid checkListService.load(data.id);\n\t\t\t}\n\n\t\t\treturn [data.id, null];\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error(Endpoint.TaskCopy, error);\n\n\t\t\treturn [0, new Error(error.errors?.[0]?.message)];\n\t\t}\n\t}\n\n\tasync addMultiTask(taskId: number, responsibleIds: number[]): Promise<number[]>\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst userIds = responsibleIds.filter((id) => id !== Core.getParams().currentUser.id);\n\n\t\t\tawait apiClient.post(Endpoint.TaskMultiTaskAdd, { taskId, userIds });\n\n\t\t\treturn userIds;\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error(Endpoint.TaskMultiTaskAdd, error);\n\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tasync update(id: number, fields: TaskModel): Promise<UpdateResult>\n\t{\n\t\tif (idUtils.isTemplate(id))\n\t\t{\n\t\t\treturn templateService.update(id, fields);\n\t\t}\n\n\t\tconst taskBeforeUpdate = this.getStoreTask(id);\n\n\t\tthis.updateStoreTask(id, fields);\n\n\t\tif (!idUtils.isReal(id))\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\tif (this.hasChanges(taskBeforeUpdate, fields))\n\t\t{\n\t\t\tEventEmitter.emit(EventName.TaskBeforeUpdate, {\n\t\t\t\ttask: this.getStoreTask(id),\n\t\t\t\tfields: { id, ...fields },\n\t\t\t});\n\t\t}\n\n\t\tconst result = await this.#updateTaskDebounced(id, fields, taskBeforeUpdate);\n\n\t\tEventEmitter.emit(EventName.TaskAfterUpdate, { task: this.getStoreTask(id) });\n\n\t\treturn result;\n\t}\n\n\tasync setFavorite(taskId: number, isFavorite: boolean): Promise<void>\n\t{\n\t\tthis.updateStoreTask(taskId, { isFavorite });\n\n\t\tconst endpoint = isFavorite ? Endpoint.TaskFavoriteAdd : Endpoint.TaskFavoriteDelete;\n\n\t\ttry\n\t\t{\n\t\t\tawait apiClient.post(endpoint, { taskId });\n\n\t\t\treturn true;\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis.updateStoreTask(taskId, { isFavorite: !isFavorite });\n\n\t\t\tconsole.error(endpoint, error);\n\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tasync setStage(taskId: number, stageId: number): Promise<void>\n\t{\n\t\tthis.updateStoreTask(taskId, { stageId });\n\n\t\ttry\n\t\t{\n\t\t\tawait apiClient.postComponent('bitrix:tasks.task', 'moveStage', { taskId, stageId });\n\n\t\t\treturn true;\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('bitrix:tasks.task.moveStage', error);\n\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tasync setMark(taskId: number, mark: string): Promise<void>\n\t{\n\t\tthis.updateStoreTask(taskId, { mark });\n\n\t\ttry\n\t\t{\n\t\t\tawait apiClient.post(Endpoint.TaskMarkSet, { task: { id: taskId, mark } });\n\n\t\t\treturn true;\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error(Endpoint.TaskMarkSet, error);\n\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tasync setMute(taskId: number, isMuted: boolean): Promise<void>\n\t{\n\t\tthis.updateStoreTask(taskId, { isMuted });\n\n\t\tconst endpoint = isMuted ? Endpoint.TaskAttentionMute : Endpoint.TaskAttentionUnmute;\n\n\t\ttry\n\t\t{\n\t\t\tawait apiClient.post(endpoint, { taskId });\n\n\t\t\treturn true;\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis.updateStoreTask(taskId, { isMuted: !isMuted });\n\n\t\t\tconsole.error(endpoint, error);\n\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tasync delete(id: number): Promise<void>\n\t{\n\t\tconst taskBeforeDelete = this.getStoreTask(id);\n\n\t\tthis.deleteStore(id);\n\n\t\tif (!idUtils.isReal(id))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tawait apiClient.post(Endpoint.TaskDelete, { task: { id } });\n\n\t\t\tEventEmitter.emit(EventName.TaskDeleted, { id });\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tvoid this.insertStoreTask(taskBeforeDelete);\n\n\t\t\tconsole.error(Endpoint.TaskDelete, error);\n\t\t}\n\t}\n\n\textractTask(data: TaskDto, ignoreContains: boolean = true): void\n\t{\n\t\tif (!data)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (data?.rights?.read === false)\n\t\t{\n\t\t\tthis.deleteStore(data.id);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst extractor = new TaskGetExtractor(data);\n\n\t\tconst task = extractor.getTask();\n\t\ttask.rights = { ...this.getStoreTask(task.id)?.rights, ...task.rights };\n\t\tif (ignoreContains)\n\t\t{\n\t\t\t[\n\t\t\t\t'containsSubTasks',\n\t\t\t\t'containsRelatedTasks',\n\t\t\t\t'containsGanttLinks',\n\t\t\t\t'containsPlacements',\n\t\t\t].forEach((prop) => delete task[prop]);\n\t\t}\n\n\t\tvoid Promise.all([\n\t\t\tthis.$store.dispatch(`${Model.Tasks}/upsert`, task),\n\t\t\tthis.$store.dispatch(`${Model.Flows}/upsert`, extractor.getFlow()),\n\t\t\tthis.$store.dispatch(`${Model.Groups}/insert`, extractor.getGroup()),\n\t\t\tthis.$store.dispatch(`${Model.Stages}/upsertMany`, extractor.getStages()),\n\t\t\tthis.$store.dispatch(`${Model.Users}/upsertMany`, extractor.getUsers()),\n\t\t]);\n\n\t\tvoid fileService.get(data.id).sync(data.fileIds);\n\t}\n\n\tdeleteStore(id: number): void\n\t{\n\t\tsubTasksService.unlinkStore(id);\n\t\trelatedTasksService.unlinkStore(id);\n\t\tganttService.unlinkStore(id);\n\t\tvoid this.$store.dispatch(`${Model.Tasks}/delete`, id);\n\t}\n\n\t#updateFields: { [taskId: number]: TaskModel } = {};\n\t#updateTaskBefore: { [taskId: number]: TaskModel } = {};\n\t#updatePromises: { [taskId: number]: Resolvable } = {};\n\t#updateServerTaskDebounced: { [taskId: number]: Function } = {};\n\n\t#updateTaskDebounced(id: number, fields: TaskModel, taskBeforeUpdate: TaskModel): Promise<UpdateResult>\n\t{\n\t\tthis.#updateFields[id] = { ...this.#updateFields[id], ...fields };\n\t\tthis.#updateTaskBefore[id] ??= taskBeforeUpdate;\n\t\tthis.#updatePromises[id] ??= new Resolvable();\n\t\tthis.#updateServerTaskDebounced[id] ??= Runtime.debounce(this.#updateTask, 500, this);\n\t\tthis.#updateServerTaskDebounced[id](id);\n\n\t\treturn this.#updatePromises[id];\n\t}\n\n\tasync #updateTask(id: number): Promise<void>\n\t{\n\t\tconst fields = this.#updateFields[id];\n\t\tdelete this.#updateFields[id];\n\n\t\tconst taskBefore = this.#updateTaskBefore[id];\n\t\tdelete this.#updateTaskBefore[id];\n\n\t\tconst promise = this.#updatePromises[id];\n\t\tdelete this.#updatePromises[id];\n\n\t\tconst task = { id, ...fields };\n\n\t\tconst result = await this.#updateTaskFields(task, taskBefore);\n\t\tconst results = await Promise.all(separateFields.map((meta) => this.#updateSeparateFields(\n\t\t\ttask,\n\t\t\ttaskBefore,\n\t\t\tmeta,\n\t\t)));\n\n\t\tpromise.resolve({ ...result, ...Object.assign({}, ...results) });\n\t}\n\n\t#updateTaskFields(task: TaskModel, taskBefore: TaskModel): Promise<UpdateResult>\n\t{\n\t\tconst fields = this.#getTaskFields(task);\n\t\tif (!this.hasChanges(taskBefore, fields))\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\treturn this.requestUpdate(Endpoint.TaskUpdate, fields, taskBefore);\n\t}\n\n\t#updateSeparateFields(task: TaskModel, taskBefore: TaskModel, meta: SeparateFieldsMeta): Promise<UpdateResult>\n\t{\n\t\tconst fields = this.#getFilteredFields(task, meta.fields);\n\t\tif (!this.hasChanges(taskBefore, fields))\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\tif (meta.service)\n\t\t{\n\t\t\treturn meta.service.update(task, taskBefore);\n\t\t}\n\n\t\treturn this.requestUpdate(meta.endpoint, fields, taskBefore);\n\t}\n\n\tasync requestUpdate(endpoint: string, fields: TaskModel, taskBefore: TaskModel): Promise<UpdateResult>\n\t{\n\t\tconst id = taskBefore.id;\n\t\tconst task = mapModelToDto({ id, ...fields });\n\t\tif (JSON.stringify(task) === JSON.stringify({ id }))\n\t\t{\n\t\t\treturn {};\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tconst data = await apiClient.post(endpoint, { task });\n\n\t\t\tthis.extractTask(data);\n\n\t\t\treturn {};\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis.updateStoreTask(id, taskBefore);\n\n\t\t\tconsole.error(endpoint, error);\n\n\t\t\treturn {\n\t\t\t\t[endpoint]: error.errors,\n\t\t\t};\n\t\t}\n\t}\n\n\t#getTaskFields(task: TaskModel): TaskModel\n\t{\n\t\treturn Object.fromEntries(Object.entries(task).filter(([field]) => {\n\t\t\treturn Object.values(separateFields).every(({ fields }) => !fields.has(field));\n\t\t}));\n\t}\n\n\t#getFilteredFields(fields: TaskModel, filterSet: Set): TaskModel\n\t{\n\t\treturn Object.fromEntries(Object.entries(fields).filter(([field]) => filterSet.has(field)));\n\t}\n\n\thasChanges(task: TaskModel, fields: TaskModel): boolean\n\t{\n\t\treturn Object.entries(fields).some(([field, value]) => JSON.stringify(task[field]) !== JSON.stringify(value));\n\t}\n\n\tasync insertStoreTask(task: TaskModel): Promise<void>\n\t{\n\t\tif (idUtils.isTemplate(task.id))\n\t\t{\n\t\t\tawait templateService.insertStoreTask(task);\n\n\t\t\treturn;\n\t\t}\n\n\t\tawait this.$store.dispatch(`${Model.Tasks}/insert`, task);\n\t}\n\n\tupdateStoreTask(id: number, fields: TaskModel): void\n\t{\n\t\tif (this.hasStoreTask(id))\n\t\t{\n\t\t\tvoid this.$store.dispatch(`${Model.Tasks}/update`, { id, fields });\n\t\t}\n\t}\n\n\thasStoreTask(id: number, withPartiallyLoaded: number = true): boolean\n\t{\n\t\tconst isPartiallyLoaded = this.$store.getters[`${Model.Tasks}/isPartiallyLoaded`](id);\n\n\t\treturn this.getStoreTask(id) !== null && (withPartiallyLoaded || !isPartiallyLoaded);\n\t}\n\n\tgetStoreTask(id: number): ?TaskModel\n\t{\n\t\tconst task = this.$store.getters[`${Model.Tasks}/getById`](id);\n\n\t\treturn task ? { ...task } : null;\n\t}\n\n\tget $store(): Store\n\t{\n\t\treturn Core.getStore();\n\t}\n}();\n\nfunction Resolvable(): Promise\n{\n\tconst promise = new Promise((resolve) => {\n\t\tthis.resolve = resolve;\n\t});\n\n\tpromise.resolve = this.resolve;\n\n\treturn promise;\n}\n","import {\n\tReplicationPeriod,\n\tReplicationRepeatTill,\n\tReplicationMonthlyType, ReplicationYearlyType,\n} from 'tasks.v2.const';\nimport type {\n\tTaskReplicateParams,\n\tTaskReplicationDaily,\n\tTaskReplicationWeekly,\n\tTaskReplicationMonthly,\n\tTaskReplicationYearly,\n} from 'tasks.v2.model.tasks';\n\nexport class ReplicateCreator\n{\n\tstatic createEmptyReplicateParams(): TaskReplicateParams\n\t{\n\t\treturn {\n\t\t\tperiod: ReplicationPeriod.Daily,\n\t\t\ttime: null,\n\t\t\tstartDate: null,\n\t\t\trepeatTill: ReplicationRepeatTill.Endless,\n\t\t\tendDate: null,\n\t\t\ttimes: null,\n\t\t\tnextExecutionTime: null,\n\t\t\tdeadlineOffset: null,\n\t\t\t...ReplicateCreator.createReplicateParamsDaily(),\n\t\t\t...ReplicateCreator.createReplicateParamsWeekly(),\n\t\t\t...ReplicateCreator.createReplicateParamsMonthly(),\n\t\t\t...ReplicateCreator.createReplicateParamsYearly(),\n\t\t};\n\t}\n\n\tstatic createReplicateParamsDaily(data: Partial<TaskReplicationDaily> = {}): TaskReplicationDaily\n\t{\n\t\treturn {\n\t\t\tdailyMonthInterval: null,\n\t\t\t...data,\n\t\t};\n\t}\n\n\tstatic createDefaultReplicationParamsDaily(): TaskReplicationDaily\n\t{\n\t\treturn ReplicateCreator.createReplicateParamsDaily({});\n\t}\n\n\tstatic createReplicateParamsWeekly(data: Partial<TaskReplicationWeekly> = {}): TaskReplicationWeekly\n\t{\n\t\treturn {\n\t\t\teveryWeek: null,\n\t\t\tweekDays: [],\n\t\t\t...data,\n\t\t};\n\t}\n\n\tstatic createDefaultReplicationParamsWeekly(): TaskReplicationWeekly\n\t{\n\t\treturn ReplicateCreator.createReplicateParamsWeekly({});\n\t}\n\n\tstatic createReplicateParamsMonthly(data: Partial<TaskReplicationMonthly> = {}): TaskReplicationMonthly\n\t{\n\t\treturn {\n\t\t\tmonthlyData: null,\n\t\t\tmonthlyDataNum: null,\n\t\t\tmonthlyMonthNum1: null,\n\t\t\tmonthlyMonthNum2: null,\n\t\t\tmonthlyWeekDay: null,\n\t\t\tmonthlyWeekDayNum: null,\n\t\t\t...data,\n\t\t};\n\t}\n\n\tstatic createDefaultReplicationParamsMonthly(): TaskReplicationMonthly\n\t{\n\t\treturn ReplicateCreator.createReplicateParamsMonthly({\n\t\t\tmonthlyType: ReplicationMonthlyType.Absolute,\n\t\t\tmonthlyDayNum: 1,\n\t\t});\n\t}\n\n\tstatic createReplicateParamsYearly(data: Partial<TaskReplicationYearly> = {}): TaskReplicationYearly\n\t{\n\t\treturn {\n\t\t\tyearlyData: null,\n\t\t\tyearlyDayNum: null,\n\t\t\tyearlyMonth1: null,\n\t\t\tyearlyMonth2: null,\n\t\t\tyearlyWeekDay: null,\n\t\t\tyearlyWeekDayNum: null,\n\t\t\t...data,\n\t\t};\n\t}\n\n\tstatic createDefaultReplicationParamsYearly(): TaskReplicationYearly\n\t{\n\t\treturn ReplicateCreator.createReplicateParamsYearly({\n\t\t\tyearlyType: ReplicationYearlyType.Absolute,\n\t\t\tyearlyDayNum: 1,\n\t\t\tyearlyMonth1: 1,\n\t\t});\n\t}\n}\n","import { mapModelToDto, mapDtoToModel, mapModelToSliderData, mapSliderDataToModel } from './mappers';\n\nexport { taskService } from './task-service';\nexport { ReplicateCreator } from './mappers/replicate-creator';\nexport const TaskMappers = { mapModelToDto, mapDtoToModel, mapModelToSliderData, mapSliderDataToModel };\nexport type { TaskDto, TagDto, Status, TemplatePermissionDto } from './types';\n"],"names":["mapModelToDto","task","user","Core","getParams","currentUser","parentId","responsibleIds","id","title","description","mapValue","mapDescription","descriptionChecksum","creator","creatorId","createdTs","Math","floor","responsible","length","responsibleCollection","map","deadlineTs","deadlineAfter","needsControl","restrictions","control","available","startPlanTs","endPlanTs","startDatePlanAfter","endDatePlanAfter","fileIds","checklist","parent","idUtils","isTemplate","base","unbox","dependsOn","relatedTaskIds","ganttLinks","ganttTaskIds","mapGanttLinks","group","groupId","stage","stageId","epicId","storyPoints","flow","flowId","priority","isImportant","status","statusChangedTs","accomplices","accomplicesIds","auditors","auditorsIds","tags","name","chatId","crmItemIds","email","allowsChangeDeadline","allowsChangeDatePlan","allowsTimeTracking","estimatedTime","matchesWorkTime","skipWeekends","matchesSubTasksTime","relatedSubtaskDeadlines","autocompleteSubTasks","source","templateId","requireResult","reminders","it","RemindersMappers","maxDeadlineChangeDate","maxDeadlineChanges","requireDeadlineChangeReason","deadlineChangeReason","containsSubTasks","userFields","type","isForNewUser","TemplateType","NewUsers","Usual","permissions","TemplateMappers","mapPermissionModelToDto","mark","replicate","Type","isObject","replicateParams","mapReplicateParamsToDto","mapDtoToModel","taskDto","allowedNullFields","Set","Text","decode","mapTaskDtoToResponsibleIds","containsChecklist","boxTemplate","containsSubTemplates","containsRelatedTasks","containsGanttLinks","containsPlacements","containsCommentFiles","containsResults","numberOfReminders","timers","timeSpent","numberOfElapsedTimes","rights","isFavorite","inFavorite","includes","isMuted","inMute","archiveLink","dateTs","mapUserFields","mapPermissionDtoToModel","mapReplicateParamsToModel","Object","fromEntries","entries","filter","key","value","has","isUndefined","isNil","mapModelToSliderData","checkLists","CheckListMappers","getUserIdsFromChecklists","data","TITLE","DESCRIPTION","RESPONSIBLE_ID","GROUP_ID","DEADLINE_TS","IS_IMPORTANT","FILE_IDS","CHECKLIST","ACCOMPLICES","AUDITORS","mapSliderDataToModel","decodeURIComponent","UF_TASK_WEBDAV_FILES","Number","PARENT_ID","BASE_TEMPLATE","UF_CRM_TASK","split","trim","undefined","UF_MAIL_MESSAGE","mapEmail","TAGS","tag","FLOW_ID","TEMPLATE","copiedFromId","COPY","IM_MESSAGE_ID","entityId","IM_CHAT_ID","subEntityId","context","mappedValue","replaceAll","taskId","taskIds","dependentId","getStore","getters","Model","GanttLinks","MAIL_SUBJECT","from","MAIL_FROM","MAIL_DATE","parseInt","link","isArrayFilled","Tasks","isArray","forEach","add","multiResponsibles","isNumber","size","startDate","DateStringConverter","parseServerDate","startTime","TimeStringConverter","parseServerTime","time","startTs","convertServerDateToTs","endTs","endDate","yearlyMonth1","yearlyMonth2","yearlyWeekDay","convertTsToServerDateString","convertTsToServerTimeString","auditorService","update","taskBefore","idsToAdd","idsToDelete","addResult","deleteResult","watch","endpoint","taskService","requestUpdate","unwatch","creatorService","currentUserId","isAdmin","admin","fields","descriptionService","forceUpdateDescription","Endpoint","TaskDescriptionForceUpdate","TaskDescriptionUpdate","TaskGetExtractor","constructor","getTask","getFlow","FlowMappers","getGroup","GroupMappers","getStages","mapStageDtoToModel","getUsers","userDto","UserMappers","separateFields","ScrumUpdateTask","TaskDeadlineUpdate","TaskPlanUpdate","TaskStakeholderResponsibleDelegate","TaskCrmItemSet","service","Event","bind","window","setTimeout","pendingIds","keys","get","taskSelect","ignoreContains","templateService","$store","dispatch","getStoreTask","apiClient","post","TaskGet","extractTask","error","console","getCopy","tmpId","checkListService","load","userFieldsManager","prepareUserFieldsForTaskFromTemplate","taskUserFieldScheme","updateStoreTask","getRights","TaskAccessGet","TaskAdd","onAfterTaskAdded","Error","errors","message","initialTask","insertStoreTask","save","CheckList","remindersIds","Reminders","remindersService","set","userIds","addMultiTask","subTasksService","addStore","results","resultService","Results","relatedToTaskId","relatedTasksService","EventEmitter","emit","EventName","TaskAdded","subTaskIds","test","deleteStore","list","ganttService","copy","withSubTasks","TaskCopy","TaskMultiTaskAdd","taskBeforeUpdate","isReal","hasChanges","TaskBeforeUpdate","result","TaskAfterUpdate","setFavorite","TaskFavoriteAdd","TaskFavoriteDelete","setStage","postComponent","setMark","TaskMarkSet","setMute","TaskAttentionMute","TaskAttentionUnmute","delete","taskBeforeDelete","TaskDelete","TaskDeleted","read","extractor","prop","Promise","all","Flows","Groups","Stages","Users","fileService","sync","unlinkStore","JSON","stringify","some","field","hasStoreTask","withPartiallyLoaded","isPartiallyLoaded","Resolvable","Runtime","debounce","promise","meta","resolve","assign","TaskUpdate","values","every","filterSet","ReplicateCreator","createEmptyReplicateParams","period","ReplicationPeriod","Daily","repeatTill","ReplicationRepeatTill","Endless","times","nextExecutionTime","deadlineOffset","createReplicateParamsDaily","createReplicateParamsWeekly","createReplicateParamsMonthly","createReplicateParamsYearly","dailyMonthInterval","createDefaultReplicationParamsDaily","everyWeek","weekDays","createDefaultReplicationParamsWeekly","monthlyData","monthlyDataNum","monthlyMonthNum1","monthlyMonthNum2","monthlyWeekDay","monthlyWeekDayNum","createDefaultReplicationParamsMonthly","monthlyType","ReplicationMonthlyType","Absolute","monthlyDayNum","yearlyData","yearlyDayNum","yearlyWeekDayNum","createDefaultReplicationParamsYearly","yearlyType","ReplicationYearlyType","TaskMappers"],"mappings":"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"}