{"version":3,"file":"description.bundle.js","sources":["../src/description-mixin.js","../src/actions/check-list.js","../src/description-editor.js","../src/mini-form-button.js","../src/actions/full-description.js","../src/mini-form.js","../src/description-preview.js","../src/description-sheet.js","../src/description-field.js","../src/description-inline.js"],"sourcesContent":["import { Runtime } from 'main.core';\nimport { EventName, Model } from 'tasks.v2.const';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\n\n// @vue/component\nexport const DescriptionMixin = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisAiCommandProcessing: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist);\n\t\t},\n\t},\n\tmethods: {\n\t\tasync handleCheckListButtonClick(): Promise<void>\n\t\t{\n\t\t\tif (this.isAiCommandProcessing)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isAiCommandProcessing = true;\n\n\t\t\tconst { CommandExecutor } = await Runtime.loadExtension('ai.command-executor');\n\n\t\t\tconst aiCommandExecutor = new CommandExecutor({\n\t\t\t\tmoduleId: 'tasks',\n\t\t\t\tcontextId: 'tasks_field_checklist',\n\t\t\t});\n\n\t\t\tconst editorText = this.editor.getText() || 'empty';\n\t\t\tconst checklistString = await aiCommandExecutor.makeChecklistFromText(editorText);\n\n\t\t\tthis.isAiCommandProcessing = false;\n\n\t\t\tthis.handleClose();\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.$bitrix.eventEmitter.emit(EventName.AiAddCheckList, checklistString);\n\t\t\t}, 500);\n\t\t},\n\t\thandleClose(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n};\n","import { Outline } from 'ui.icon-set.api.vue';\n\nimport { ActionButton } from 'tasks.v2.component.entity-text';\n\n// @vue/component\nexport const CheckList = {\n\tname: 'TaskDescriptionCheckList',\n\tcomponents: {\n\t\tActionButton,\n\t\tOutline,\n\t},\n\tprops: {\n\t\tloading: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tcomputed: {\n\t\tbuttonColor(): string\n\t\t{\n\t\t\treturn 'var(--ui-color-copilot-primary)';\n\t\t},\n\t\ticonName(): string\n\t\t{\n\t\t\treturn this.loading ? Outline.AI_STARS : Outline.LIST_AI;\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.loc('TASKS_V2_DESCRIPTION_ACTION_CHECK_LIST_HINT');\n\t\t},\n\t\tcopilotText(): string\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.loading\n\t\t\t\t\t? this.loc('TASKS_V2_DESCRIPTION_ACTION_CHECK_LIST_CREATING')\n\t\t\t\t\t: this.loc('TASKS_V2_DESCRIPTION_ACTION_CHECK_LIST_TITLE')\n\t\t\t);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ActionButton\n\t\t\t:iconColor=\"buttonColor\"\n\t\t\t:iconSize=\"loading ? 20 : null\"\n\t\t\t:iconName\n\t\t\t:title\n\t\t\t:copilotText\n\t\t/>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { TextEditor } from 'ui.text-editor';\nimport { Button as UiButton, ButtonColor, ButtonSize } from 'ui.vue3.components.button';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport { Core } from 'tasks.v2.core';\nimport { fileService, type FileService } from 'tasks.v2.provider.service.file-service';\nimport {\n\tentityTextEditor,\n\tCopilotButton,\n\tAttachButton,\n\tMentionButton,\n\tMoreButton,\n\tNumberListButton,\n\tBulletListButton,\n\ttype EntityTextEditor,\n} from 'tasks.v2.component.entity-text';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { DescriptionMixin } from './description-mixin';\nimport { CheckList } from './actions/check-list';\n\nimport './description.css';\n\n// @vue/component\nexport const DescriptionEditor = {\n\tname: 'TaskDescriptionContent',\n\tcomponents: {\n\t\tBIcon,\n\t\tUiButton,\n\t\tCheckList,\n\t\tCopilotButton,\n\t\tAttachButton,\n\t\tMentionButton,\n\t\tMoreButton,\n\t\tNumberListButton,\n\t\tBulletListButton,\n\t},\n\tmixins: [\n\t\tDescriptionMixin,\n\t],\n\tinject: {\n\t\ttask: {},\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tenableSaveButton: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['close', 'show'],\n\tsetup(props): { task: TaskModel, fileService: FileService, entityTextEditor: EntityTextEditor }\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t\tButtonColor,\n\t\t\tOutline,\n\t\t\tfileService: fileService.get(props.taskId),\n\t\t\tentityTextEditor: entityTextEditor.get(props.taskId),\n\t\t};\n\t},\n\tcomputed: {\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t\teditor(): TextEditor\n\t\t{\n\t\t\treturn this.entityTextEditor.getEditor();\n\t\t},\n\t\tisDiskModuleInstalled(): boolean\n\t\t{\n\t\t\treturn Core.getParams().features.disk;\n\t\t},\n\t\tisCopilotEnabled(): boolean\n\t\t{\n\t\t\treturn Core.getParams().features.isCopilotEnabled;\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.$emit('show');\n\n\t\tif (!Type.isStringFilled(this.task.description) || this.taskId === 0)\n\t\t{\n\t\t\tsetTimeout(this.focusToEnd, 500);\n\t\t}\n\t},\n\tmethods: {\n\t\tfocusToEnd(): void\n\t\t{\n\t\t\tthis.editor.focus(null, { defaultSelection: 'rootEnd' });\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-card-description-wrapper\" ref=\"wrapper\">\n\t\t\t<div class=\"tasks-card-description-header\" ref=\"descriptionHeader\">\n\t\t\t\t<div class=\"tasks-card-description-title\">\n\t\t\t\t\t{{ loc('TASKS_V2_CHANGE_DESCRIPTION') }}\n\t\t\t\t</div>\n\t\t\t\t<BIcon\n\t\t\t\t\t:name=\"Outline.CROSS_L\"\n\t\t\t\t\thoverable\n\t\t\t\t\tclass=\"tasks-card-description-field-icon\"\n\t\t\t\t\t@click=\"handleClose\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-card-description-editor-wrapper\" id=\"descriptionTextAreaDestination\"/>\n\t\t\t<div v-if=\"!readonly\" class=\"tasks-card-description-editor-footer\" ref=\"descriptionActions\">\n\t\t\t\t<div class=\"tasks-card-description-action-list\">\n\t\t\t\t\t<AttachButton v-if=\"isDiskModuleInstalled\" :fileService/>\n\t\t\t\t\t<MentionButton :editor/>\n\t\t\t\t\t<BulletListButton :editor/>\n\t\t\t\t\t<NumberListButton :editor/>\n\t\t\t\t\t<MoreButton :editor/>\n\t\t\t\t\t<CopilotButton v-if=\"isCopilotEnabled\" :editor/>\n\t\t\t\t\t<CheckList\n\t\t\t\t\t\tv-if=\"isCopilotEnabled\"\n\t\t\t\t\t\t:loading=\"isAiCommandProcessing\"\n\t\t\t\t\t\t@click=\"handleCheckListButtonClick\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-card-description-footer-buttons\">\n\t\t\t\t\t<UiButton\n\t\t\t\t\t\t:text=\"loc('TASKS_V2_DESCRIPTION_BUTTON_SAVE')\"\n\t\t\t\t\t\t:size=\"ButtonSize.MEDIUM\"\n\t\t\t\t\t\t:color=\"ButtonColor.PRIMARY\"\n\t\t\t\t\t\t:disabled=\"!enableSaveButton\"\n\t\t\t\t\t\t@click=\"handleClose\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BIcon, Outline } from 'ui.icon-set.api.vue';\n\nimport './description.css';\n\n// @vue/component\nexport const MiniFormButton = {\n\tname: 'TaskDescriptionMiniFormButton',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tfilesCount: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): void\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-card-change-description-mini-btn\">\n\t\t\t<div class=\"tasks-full-card-field-container --small-vertical-padding\">\n\t\t\t\t<div class=\"tasks-card-change-description\" :class=\"{ '--no-hover': filesCount }\">\n\t\t\t\t\t<template v-if=\"filesCount\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"Outline.ATTACH\"\n\t\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\t\tclass=\"tasks-card-description-field-icon-link\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"tasks-card-change-description-mini-text-files\">\n\t\t\t\t\t\t\t{{ loc('TASKS_V2_DESCRIPTION_FILES_COUNT', { '#COUNT#': String(filesCount) }) }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"tasks-card-change-description-mini-text\">\n\t\t\t\t\t\t\t{{ loc('TASKS_V2_CHANGE_DESCRIPTION') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"Outline.CREATE_CHAT\"\n\t\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\t\thoverable\n\t\t\t\t\t\t\tclass=\"tasks-card-description-field-icon\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.vue';\n\nimport { ActionButton } from 'tasks.v2.component.entity-text';\n\n// @vue/component\nexport const FullDescription = {\n\tname: 'TaskFullDescription',\n\tcomponents: {\n\t\tActionButton,\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<ActionButton\n\t\t\t:iconName=\"Outline.GO_TO_L\"\n\t\t\t:title=\"loc('TASKS_V2_DESCRIPTION_BUTTON_EXPAND')\"\n\t\t/>\n\t`,\n};\n","import type { TextEditor } from 'ui.text-editor';\nimport { Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport { Core } from 'tasks.v2.core';\nimport { fileService, type FileService } from 'tasks.v2.provider.service.file-service';\nimport {\n\tEntityTextArea,\n\tEntityTextTypes,\n\tentityTextEditor,\n\tCopilotButton,\n\tAttachButton,\n\tMentionButton,\n\tMoreButton,\n\tNumberListButton,\n\tBulletListButton,\n\ttype EntityTextEditor,\n} from 'tasks.v2.component.entity-text';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { DescriptionMixin } from './description-mixin';\nimport { CheckList } from './actions/check-list';\nimport { FullDescription } from './actions/full-description';\n\nimport './description.css';\n\n// @vue/component\nexport const MiniForm = {\n\tname: 'TaskDescriptionMiniForm',\n\tcomponents: {\n\t\tCheckList,\n\t\tCopilotButton,\n\t\tAttachButton,\n\t\tMentionButton,\n\t\tMoreButton,\n\t\tFullDescription,\n\t\tEntityTextArea,\n\t\tNumberListButton,\n\t\tBulletListButton,\n\t},\n\tmixins: [\n\t\tDescriptionMixin,\n\t],\n\tinject: {\n\t\ttask: {},\n\t\tisEdit: {},\n\t},\n\tprovide(): { fileService: FileService, entityTextEditor: EntityTextEditor }\n\t{\n\t\treturn {\n\t\t\teditor: () => this.editor,\n\t\t\tfileService: () => this.fileService,\n\t\t};\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tisSheetShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['expand', 'change', 'filesChange', 'close'],\n\tsetup(props): { task: TaskModel, fileService: FileService, entityTextEditor: EntityTextEditor }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tEntityTextTypes,\n\t\t\tfileService: fileService.get(props.taskId),\n\t\t\tentityTextEditor: entityTextEditor.get(props.taskId),\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisNeedTeleport: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t\teditor(): TextEditor\n\t\t{\n\t\t\treturn this.entityTextEditor.getEditor();\n\t\t},\n\t\tisDiskModuleInstalled(): boolean\n\t\t{\n\t\t\treturn Core.getParams().features.disk;\n\t\t},\n\t\tisCopilotEnabled(): boolean\n\t\t{\n\t\t\treturn Core.getParams().features.isCopilotEnabled;\n\t\t},\n\t},\n\twatch: {\n\t\tisSheetShown(newValue): void\n\t\t{\n\t\t\tthis.handleTeleport(newValue);\n\t\t},\n\t},\n\tmethods: {\n\t\thandleExpand(): void\n\t\t{\n\t\t\tthis.$emit('expand');\n\t\t},\n\t\thandleTeleport(isSheetShown): void\n\t\t{\n\t\t\tif (isSheetShown === true)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.isNeedTeleport = true;\n\t\t\t\t\tthis.editor.setVisualOptions({ blockSpaceInline: 'var(--ui-space-stack-xl)' });\n\t\t\t\t}, 100);\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.editor.focus(null, { defaultSelection: 'rootEnd' });\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.isNeedTeleport = false;\n\t\t\t\tthis.editor.setMaxHeight(null);\n\t\t\t\tthis.editor.setVisualOptions({ blockSpaceInline: 'var(--ui-space-stack-md2)' });\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-card-change-description-mini-container\">\n\t\t\t<div\n\t\t\t\tclass=\"tasks-full-card-field-container --description-preview\"\n\t\t\t\tref=\"container\"\n\t\t\t\ttabindex=\"-1\"\n\t\t\t>\n\t\t\t\t<Teleport :to=\"isNeedTeleport ? '#descriptionTextAreaDestination' : undefined\" :disabled=\"!isNeedTeleport\">\n\t\t\t\t\t<EntityTextArea\n\t\t\t\t\t\t:entityId=\"taskId\"\n\t\t\t\t\t\t:entityType=\"EntityTextTypes.Task\"\n\t\t\t\t\t\t:readonly\n\t\t\t\t\t\t:removeFromServer=\"!isEdit\"\n\t\t\t\t\t\t@change=\"$emit('change')\"\n\t\t\t\t\t\t@filesChange=\"$emit('filesChange')\"\n\t\t\t\t\t\tref=\"descriptionTextArea\"\n\t\t\t\t\t/>\n\t\t\t\t</Teleport>\n\t\t\t\t<div class=\"tasks-card-description-footer-container\">\n\t\t\t\t\t<div class=\"tasks-card-description-footer\">\n\t\t\t\t\t\t<div class=\"tasks-card-description-action-list\">\n\t\t\t\t\t\t\t<AttachButton v-if=\"isDiskModuleInstalled\" :fileService/>\n\t\t\t\t\t\t\t<MentionButton :editor/>\n\t\t\t\t\t\t\t<BulletListButton :editor/>\n\t\t\t\t\t\t\t<NumberListButton :editor/>\n\t\t\t\t\t\t\t<MoreButton :editor/>\n\t\t\t\t\t\t\t<CopilotButton v-if=\"isCopilotEnabled\" :editor/>\n\t\t\t\t\t\t\t<CheckList\n\t\t\t\t\t\t\t\tv-if=\"isCopilotEnabled\"\n\t\t\t\t\t\t\t\t:loading=\"isAiCommandProcessing\"\n\t\t\t\t\t\t\t\t@click=\"handleCheckListButtonClick\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"tasks-card-description-footer-buttons\"\n\t\t\t\t\t\t\tref=\"fullDescriptionArea\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<FullDescription @click=\"handleExpand\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport type { VueUploaderAdapter } from 'ui.uploader.vue';\nimport 'ui.icon-set.outline';\n\nimport type { UserFieldWidgetOptions } from 'disk.uploader.user-field-widget';\n\nimport { fileService } from 'tasks.v2.provider.service.file-service';\nimport { DiskUserFieldWidgetComponent } from 'tasks.v2.component.elements.user-field-widget-component';\nimport { EntityCollapsibleText } from 'tasks.v2.component.entity-text';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport './description.css';\n\n// @vue/component\nexport const DescriptionPreview = {\n\tname: 'TaskDescriptionPreview',\n\tcomponents: {\n\t\tBIcon,\n\t\tEntityCollapsibleText,\n\t\tUserFieldWidgetComponent: DiskUserFieldWidgetComponent,\n\t},\n\tinject: {\n\t\ttask: {},\n\t\tisEdit: {},\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tfiles: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tisMiniFormShown: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['editButtonClick'],\n\tsetup(props): { task: TaskModel, uploaderAdapter: VueUploaderAdapter }\n\t{\n\t\treturn {\n\t\t\tBIcon,\n\t\t\tOutline,\n\t\t\tuploaderAdapter: fileService.get(props.taskId).getAdapter(),\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\topened: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttaskDescription(): string\n\t\t{\n\t\t\treturn this.task.description ?? '';\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t\tfilesCount(): number\n\t\t{\n\t\t\treturn this.files.length;\n\t\t},\n\t\twidgetOptions(): UserFieldWidgetOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tisEmbedded: true,\n\t\t\t\twithControlPanel: false,\n\t\t\t\tcanCreateDocuments: false,\n\t\t\t\ttileWidgetOptions: {\n\t\t\t\t\tcompact: true,\n\t\t\t\t\thideDropArea: true,\n\t\t\t\t\treadonly: true,\n\t\t\t\t\tenableDropzone: false,\n\t\t\t\t\tautoCollapse: false,\n\t\t\t\t\tremoveFromServer: !this.isEdit,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-full-card-field-container\">\n\t\t\t<EntityCollapsibleText\n\t\t\t\tref=\"collapsible\"\n\t\t\t\t:content=\"taskDescription\"\n\t\t\t\t:files\n\t\t\t\t:readonly\n\t\t\t\t:openByDefault=\"isMiniFormShown\"\n\t\t\t\tshowFilesIndicator\n\t\t\t\t:maxHeight=\"300\"\n\t\t\t\tv-model:opened=\"opened\"\n\t\t\t\t@editButtonClick=\"$emit('editButtonClick')\"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"opened && filesCount\"\n\t\t\t\t\tclass=\"tasks-card-description-editor-files --read-only\"\n\t\t\t\t\t:class=\"{ '--with-description': taskDescription.length > 0 }\"\n\t\t\t\t\tref=\"filesWrapper\"\n\t\t\t\t>\n\t\t\t\t\t<UserFieldWidgetComponent :uploaderAdapter :widgetOptions/>\n\t\t\t\t</div>\n\t\t\t</EntityCollapsibleText>\n\t\t</div>\n\t`,\n};\n","import { Text } from 'main.core';\n\nimport { Core } from 'tasks.v2.core';\nimport { EntityTypes } from 'tasks.v2.provider.service.file-service';\nimport { BottomSheet } from 'tasks.v2.component.elements.bottom-sheet';\nimport { DropZone } from 'tasks.v2.component.drop-zone';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { DescriptionEditor } from './description-editor';\n\nimport './description.css';\n\n// @vue/component\nexport const DescriptionSheet = {\n\tname: 'TaskDescriptionSheet',\n\tcomponents: {\n\t\tBottomSheet,\n\t\tDescriptionEditor,\n\t\tDropZone,\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t},\n\tprops: {\n\t\tsheetBindProps: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tenableSaveButton: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['close'],\n\tsetup(): { task: TaskModel }\n\t{\n\t\treturn {\n\t\t\tEntityTypes,\n\t\t};\n\t},\n\tdata(): void\n\t{\n\t\treturn {\n\t\t\tuniqueKey: Text.getRandom(),\n\t\t};\n\t},\n\tcomputed: {\n\t\tbottomSheetContainer(): HTMLElement | null\n\t\t{\n\t\t\treturn document.getElementById(`b24-bottom-sheet-${this.uniqueKey}`) || null;\n\t\t},\n\t\tisDiskModuleInstalled(): boolean\n\t\t{\n\t\t\treturn Core.getParams().features.disk;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BottomSheet\n\t\t\tisExpanded\n\t\t\t:padding=\"0\"\n\t\t\t:popupPadding=\"0\"\n\t\t\t:sheetBindProps\n\t\t\t:uniqueKey\n\t\t\t@close=\"$emit('close')\"\n\t\t>\n\t\t\t<DescriptionEditor\n\t\t\t\t:taskId\n\t\t\t\t:enableSaveButton\n\t\t\t\t@close=\"$emit('close')\"\n\t\t\t/>\n\t\t\t<DropZone\n\t\t\t\tv-if=\"isDiskModuleInstalled && task.rights.edit\"\n\t\t\t\t:container=\"bottomSheetContainer || {}\"\n\t\t\t\t:entityId=\"taskId\"\n\t\t\t\t:entityType=\"EntityTypes.Task\"\n\t\t\t/>\n\t\t</BottomSheet>\n\t`,\n};\n","import { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport type { VueUploaderAdapter } from 'ui.uploader.vue';\nimport type { TextEditor } from 'ui.text-editor';\n\nimport { Endpoint } from 'tasks.v2.const';\nimport { fileService } from 'tasks.v2.provider.service.file-service';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { entityTextEditor, type EntityTextEditor } from 'tasks.v2.component.entity-text';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { UserModel } from 'tasks.v2.model.users';\nimport type { FileService } from 'tasks.v2.provider.service.file-service';\n\nimport { MiniFormButton } from './mini-form-button.js';\nimport { MiniForm } from './mini-form.js';\nimport { DescriptionPreview } from './description-preview';\nimport { DescriptionSheet } from './description-sheet';\n\nimport './description.css';\n\n// @vue/component\nexport const DescriptionField = {\n\tname: 'TaskDescriptionField',\n\tcomponents: {\n\t\tMiniFormButton,\n\t\tMiniForm,\n\t\tDescriptionPreview,\n\t\tDescriptionSheet,\n\t},\n\texpose: ['save'],\n\tinject: {\n\t\ttask: {},\n\t\tisEdit: {},\n\t},\n\tprops: {\n\t\tisSheetShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tsheetBindProps: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\t// eslint-disable-next-line max-len\n\tsetup(props): { task: TaskModel, fileService: FileService, uploaderAdapter: VueUploaderAdapter, entityTextEditor: EntityTextEditor }\n\t{\n\t\treturn {\n\t\t\tfileService: fileService.get(props.taskId),\n\t\t\tuploaderAdapter: fileService.get(props.taskId).getAdapter(),\n\t\t\tentityTextEditor: entityTextEditor.get(props.taskId),\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tchecksum: '',\n\t\t\tisSaving: false,\n\t\t\tisMiniFormShown: false,\n\t\t\tenableSaveButton: false,\n\t\t\thasFilesChanges: false,\n\t\t\tfiles: this.fileService.getFiles(),\n\t\t};\n\t},\n\tcomputed: {\n\t\ttaskDescription(): string\n\t\t{\n\t\t\treturn this.task.description ?? '';\n\t\t},\n\t\ttaskDescriptionChecksum(): string\n\t\t{\n\t\t\treturn this.task.descriptionChecksum ?? '';\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t\tfilesCount(): number\n\t\t{\n\t\t\treturn this.files.length;\n\t\t},\n\t\tshouldShowDescriptionField(): boolean\n\t\t{\n\t\t\treturn !this.readonly\n\t\t\t\t|| this.taskDescription.length > 0\n\t\t\t\t|| (this.filesCount > 0 && !this.readonly)\n\t\t\t;\n\t\t},\n\t\tshouldShowMiniForm(): boolean\n\t\t{\n\t\t\tif (this.readonly)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.isEdit)\n\t\t\t{\n\t\t\t\treturn this.isMiniFormShown || this.task.description.length > 0;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tshouldShowMiniFormButton(): boolean\n\t\t{\n\t\t\treturn this.taskDescription.length === 0\n\t\t\t\t&& (\n\t\t\t\t\t(!this.isEdit && !this.isMiniFormShown)\n\t\t\t\t\t|| (this.isEdit && this.filesCount === 0)\n\t\t\t\t)\n\t\t\t;\n\t\t},\n\t\tshouldShowDescriptionPreview(): boolean\n\t\t{\n\t\t\treturn this.isEdit && (this.taskDescription.length > 0 || this.filesCount > 0);\n\t\t},\n\t\tminiFormStyle(): Object | null\n\t\t{\n\t\t\tif (this.isEdit)\n\t\t\t{\n\t\t\t\treturn { display: 'none' };\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\teditor(): TextEditor\n\t\t{\n\t\t\treturn this.entityTextEditor.getEditor();\n\t\t},\n\t},\n\twatch: {\n\t\ttaskDescriptionChecksum: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tif (this.editor && this.isSheetShown && !this.hasChanges())\n\t\t\t\t{\n\t\t\t\t\tthis.updateChecksum();\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.entityTextEditor.setEditorText(this.taskDescription);\n\t\tthis.updateChecksum();\n\t},\n\tmethods: {\n\t\texpandDescription(): void\n\t\t{\n\t\t\tthis.setSheetShown(true);\n\t\t},\n\t\topenEditMode(): void\n\t\t{\n\t\t\tif (this.editor && this.hasChanges() && !this.isSaving)\n\t\t\t{\n\t\t\t\tthis.entityTextEditor.setEditorText(this.taskDescription);\n\t\t\t}\n\n\t\t\tthis.updateChecksum();\n\n\t\t\tthis.setSheetShown(true);\n\t\t},\n\t\tcloseEditMode(): void\n\t\t{\n\t\t\tvoid this.handleSave();\n\n\t\t\tthis.setSheetShown(false);\n\n\t\t\tthis.hasFilesChanges = false;\n\t\t\tthis.enableSaveButton = false;\n\t\t},\n\t\thandleMiniFormButtonClick(): void\n\t\t{\n\t\t\tif (this.isEdit)\n\t\t\t{\n\t\t\t\tthis.openEditMode();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.isMiniFormShown = true;\n\t\t\t}\n\t\t},\n\t\thandleTextChanges(): void\n\t\t{\n\t\t\tif (this.isEdit)\n\t\t\t{\n\t\t\t\tif (this.hasFilesChanges)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.enableSaveButton = this.hasChanges();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvoid this.save();\n\n\t\t\t\tthis.enableSaveButton = true;\n\t\t\t}\n\t\t},\n\t\thandleFilesChanges(): void\n\t\t{\n\t\t\tif (!this.isSheetShown)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.hasFilesChanges = true;\n\t\t\tthis.enableSaveButton = true;\n\t\t},\n\t\tasync handleSave(): void\n\t\t{\n\t\t\tif (!this.editor || !this.hasChanges())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isSaving = true;\n\n\t\t\tconst result = await this.save();\n\n\t\t\tif (result?.[Endpoint.TaskDescriptionUpdate]?.length > 0)\n\t\t\t{\n\t\t\t\tconst errorData = result[Endpoint.TaskDescriptionUpdate][0];\n\n\t\t\t\tconst { customData } = errorData;\n\n\t\t\t\tif (customData && customData.changed && customData.changedBy)\n\t\t\t\t{\n\t\t\t\t\tthis.showDescriptionChangedAlert(customData.changedBy);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.isSaving = false;\n\t\t},\n\t\tasync save(forceUpdateDescription = false): Promise\n\t\t{\n\t\t\treturn taskService.update(this.taskId, {\n\t\t\t\tforceUpdateDescription,\n\t\t\t\tdescription: this.editor.getText(),\n\t\t\t\tdescriptionChecksum: this.checksum,\n\t\t\t});\n\t\t},\n\t\thasChanges(): boolean\n\t\t{\n\t\t\tconst preparedOldText = this.getPreparedText(this.taskDescription);\n\t\t\tconst preparedNewText = this.getPreparedText(this.editor?.getText());\n\n\t\t\treturn preparedOldText !== preparedNewText;\n\t\t},\n\t\tgetPreparedText(text): string | null\n\t\t{\n\t\t\treturn text\n\t\t\t\t.replaceAll(/\\[p]\\n|\\[p]\\[\\/p]|\\[\\/p]/gi, '')\n\t\t\t\t.trim()\n\t\t\t;\n\t\t},\n\t\tsetSheetShown(isShown: boolean): void\n\t\t{\n\t\t\tthis.$emit('update:isSheetShown', isShown);\n\t\t},\n\t\tshowDescriptionChangedAlert(changedBy: UserModel): string\n\t\t{\n\t\t\tMessageBox.show({\n\t\t\t\tuseAirDesign: true,\n\t\t\t\ttitle: this.loc('TASKS_V2_DESCRIPTION_CHECKSUM_ERROR_TITLE'),\n\t\t\t\tmessage: this.loc(`TASKS_V2_DESCRIPTION_CHECKSUM_ERROR_DESC_${changedBy.gender.toUpperCase()}`, {\n\t\t\t\t\t'#NAME#': changedBy.name,\n\t\t\t\t}),\n\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\tokCaption: this.loc('TASKS_V2_DESCRIPTION_CHECKSUM_ERROR_BUTTON_OK'),\n\t\t\t\tonOk: (dialog) => this.onOkDescriptionChangedAlert(dialog),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tcloseByEsc: false,\n\t\t\t\t\tautoHide: false,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonClose: () => this.onCloseDescriptionChangedAlert(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tasync onOkDescriptionChangedAlert(dialog): void\n\t\t{\n\t\t\tdialog.close();\n\n\t\t\tawait this.save(true);\n\t\t},\n\t\tonCloseDescriptionChangedAlert(): void\n\t\t{\n\t\t\tthis.updateChecksum();\n\t\t},\n\t\tupdateChecksum(): void\n\t\t{\n\t\t\tthis.checksum = this.taskDescriptionChecksum;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"shouldShowDescriptionField\"\n\t\t\tclass=\"tasks-card-description-field\"\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-field-id=\"'description'\"\n\t\t>\n\t\t\t<MiniFormButton\n\t\t\t\tv-if=\"shouldShowMiniFormButton\"\n\t\t\t\t:filesCount\n\t\t\t\t@click=\"handleMiniFormButtonClick\"\n\t\t\t/>\n\t\t\t<MiniForm\n\t\t\t\tv-if=\"shouldShowMiniForm\"\n\t\t\t\t:taskId\n\t\t\t\t:isSheetShown\n\t\t\t\t:style=\"miniFormStyle\"\n\t\t\t\t@expand=\"expandDescription\"\n\t\t\t\t@change=\"handleTextChanges\"\n\t\t\t\t@filesChange=\"handleFilesChanges\"\n\t\t\t/>\n\t\t\t<DescriptionPreview\n\t\t\t\tv-if=\"shouldShowDescriptionPreview\"\n\t\t\t\t:taskId\n\t\t\t\t:files\n\t\t\t\t:isMiniFormShown\n\t\t\t\t@editButtonClick=\"openEditMode\"\n\t\t\t/>\n\t\t</div>\n\t\t<DescriptionSheet\n\t\t\tv-if=\"isSheetShown\"\n\t\t\t:sheetBindProps\n\t\t\t:enableSaveButton\n\t\t\t@close=\"closeEditMode\"\n\t\t/>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { TextEditor, TextEditorComponent } from 'ui.text-editor';\nimport type { TextEditorOptions } from 'ui.text-editor';\n\nimport { Core } from 'tasks.v2.core';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { fileService } from 'tasks.v2.provider.service.file-service';\nimport { DefaultEditorOptions } from 'tasks.v2.component.entity-text';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport './description.css';\n\n// @vue/component\nexport const DescriptionInline = {\n\tname: 'TaskDescriptionInline',\n\tcomponents: {\n\t\tTextEditorComponent,\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t},\n\tsetup(): { task: TaskModel }\n\t{\n\t\treturn {\n\t\t\teditor: null,\n\t\t\tDefaultEditorOptions,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisFocused: false,\n\t\t\tisScrolledToTop: true,\n\t\t\tisScrolledToBottom: true,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttaskDescription(): string\n\t\t{\n\t\t\treturn this.task.description;\n\t\t},\n\t\tcopilotParams(): Object\n\t\t{\n\t\t\tif (Core.getParams().features.isCopilotEnabled)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tcopilotOptions: {\n\t\t\t\t\t\tmoduleId: 'tasks',\n\t\t\t\t\t\tcategory: 'tasks',\n\t\t\t\t\t\tcontextId: `tasks_${this.taskId}`,\n\t\t\t\t\t\tmenuForceTop: false,\n\t\t\t\t\t},\n\t\t\t\t\ttriggerBySpace: true,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {};\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tconst additionalEditorOptions: TextEditorOptions = {\n\t\t\tminHeight: 20,\n\t\t\tmaxHeight: 112,\n\t\t\tplaceholder: this.loc('TASKS_V2_DESCRIPTION_INLINE_EDITOR_PLACEHOLDER'),\n\t\t\tcontent: this.taskDescription,\n\t\t\tnewLineMode: 'paragraph',\n\t\t\tevents: {\n\t\t\t\tonFocus: this.handleEditorFocus,\n\t\t\t\tonBlur: this.handleEditorBlur,\n\t\t\t\tonChange: this.handleEditorChange,\n\t\t\t},\n\t\t\tcopilot: this.copilotParams,\n\t\t};\n\n\t\tthis.editor = new TextEditor({ ...DefaultEditorOptions, ...additionalEditorOptions });\n\t},\n\tmounted(): void\n\t{\n\t\tEvent.bind(this.editor.getScrollerContainer(), 'scroll', this.handleScroll);\n\n\t\tfileService.get(this.taskId).getAdapter().getUploader().assignPaste(this.$refs.description);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tEvent.unbind(this.editor.getScrollerContainer(), 'scroll', this.handleScroll);\n\n\t\tfileService.get(this.taskId).getAdapter().getUploader().unassignPaste(this.$refs.description);\n\t},\n\tmethods: {\n\t\thasScroll(): boolean\n\t\t{\n\t\t\treturn !this.isScrolledToTop || !this.isScrolledToBottom;\n\t\t},\n\t\tasync handleEditorFocus(): void\n\t\t{\n\t\t\tthis.isFocused = true;\n\t\t},\n\t\tasync handleEditorBlur(): void\n\t\t{\n\t\t\tthis.isFocused = false;\n\n\t\t\tconst description = this.editor.getText();\n\t\t\tvoid taskService.update(this.taskId, { description });\n\t\t},\n\t\thandleEditorChange(): void\n\t\t{\n\t\t\tthis.handleScroll();\n\t\t},\n\t\thandleScroll(): void\n\t\t{\n\t\t\tconst container = this.editor.getScrollerContainer();\n\t\t\tthis.isScrolledToTop = container.scrollTop === 0;\n\t\t\tthis.isScrolledToBottom = container.scrollTop + container.clientHeight >= container.scrollHeight - 5;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"tasks-card-description-inline\"\n\t\t\t:class=\"{ '--bottom-shadow': !isScrolledToBottom, '--top-shadow': !isScrolledToTop }\"\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-field-id=\"'description'\"\n\t\t\tref=\"description\"\n\t\t>\n\t\t\t<div class=\"tasks-card-description-inline-shadow --revert\" :class=\"{'--shown': !isScrolledToTop}\">\n\t\t\t\t<div class=\"tasks-card-description-inline-shadow-white\"/>\n\t\t\t\t<div class=\"tasks-card-description-inline-shadow-black\"/>\n\t\t\t</div>\n\t\t\t<TextEditorComponent :editorInstance=\"editor\"/>\n\t\t\t<div class=\"tasks-card-description-inline-shadow\" :class=\"{'--shown': !isScrolledToBottom}\">\n\t\t\t\t<div class=\"tasks-card-description-inline-shadow-white\"/>\n\t\t\t\t<div class=\"tasks-card-description-inline-shadow-black\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n"],"names":["DescriptionMixin","data","isAiCommandProcessing","computed","checkLists","$store","getters","Model","CheckList","task","checklist","methods","handleCheckListButtonClick","CommandExecutor","Runtime","loadExtension","aiCommandExecutor","moduleId","contextId","editorText","editor","getText","checklistString","makeChecklistFromText","handleClose","setTimeout","$bitrix","eventEmitter","emit","EventName","AiAddCheckList","$emit","name","components","ActionButton","Outline","props","loading","type","Boolean","default","setup","buttonColor","iconName","AI_STARS","LIST_AI","title","loc","copilotText","template","DescriptionEditor","BIcon","UiButton","CopilotButton","AttachButton","MentionButton","MoreButton","NumberListButton","BulletListButton","mixins","inject","taskId","Number","String","required","enableSaveButton","emits","ButtonSize","ButtonColor","fileService","get","entityTextEditor","readonly","rights","edit","getEditor","isDiskModuleInstalled","Core","getParams","features","disk","isCopilotEnabled","mounted","Type","isStringFilled","description","focusToEnd","focus","defaultSelection","MiniFormButton","filesCount","FullDescription","MiniForm","EntityTextArea","isEdit","provide","isSheetShown","EntityTextTypes","isNeedTeleport","watch","newValue","handleTeleport","handleExpand","setVisualOptions","blockSpaceInline","setMaxHeight","DescriptionPreview","EntityCollapsibleText","UserFieldWidgetComponent","DiskUserFieldWidgetComponent","files","Array","isMiniFormShown","uploaderAdapter","getAdapter","opened","taskDescription","length","widgetOptions","isEmbedded","withControlPanel","canCreateDocuments","tileWidgetOptions","compact","hideDropArea","enableDropzone","autoCollapse","removeFromServer","DescriptionSheet","BottomSheet","DropZone","sheetBindProps","Object","EntityTypes","uniqueKey","Text","getRandom","bottomSheetContainer","document","getElementById","DescriptionField","expose","checksum","isSaving","hasFilesChanges","getFiles","taskDescriptionChecksum","descriptionChecksum","shouldShowDescriptionField","shouldShowMiniForm","shouldShowMiniFormButton","shouldShowDescriptionPreview","miniFormStyle","display","handler","hasChanges","updateChecksum","deep","setEditorText","expandDescription","setSheetShown","openEditMode","closeEditMode","handleSave","handleMiniFormButtonClick","handleTextChanges","save","handleFilesChanges","result","Endpoint","TaskDescriptionUpdate","errorData","customData","changed","changedBy","showDescriptionChangedAlert","forceUpdateDescription","taskService","update","preparedOldText","getPreparedText","preparedNewText","text","replaceAll","trim","isShown","MessageBox","show","useAirDesign","message","gender","toUpperCase","buttons","MessageBoxButtons","OK_CANCEL","okCaption","onOk","dialog","onOkDescriptionChangedAlert","popupOptions","closeByEsc","autoHide","events","onClose","onCloseDescriptionChangedAlert","close","DescriptionInline","TextEditorComponent","DefaultEditorOptions","isFocused","isScrolledToTop","isScrolledToBottom","copilotParams","copilotOptions","category","menuForceTop","triggerBySpace","created","additionalEditorOptions","minHeight","maxHeight","placeholder","content","newLineMode","onFocus","handleEditorFocus","onBlur","handleEditorBlur","onChange","handleEditorChange","copilot","TextEditor","Event","bind","getScrollerContainer","handleScroll","getUploader","assignPaste","$refs","beforeUnmount","unbind","unassignPaste","hasScroll","container","scrollTop","clientHeight","scrollHeight"],"mappings":"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"}