{"version":3,"file":"task-full-card.bundle.js","sources":["../src/component/task-header/burger-menu/burger-menu.js","../src/component/task-header/task-header.js","../src/component/aha/task-settings-hint.js","../src/component/chat/message-menu.js","../src/component/aha/chat-aha/chat-aha.js","../src/component/aha/important-messages-aha/important-messages-aha.js","../src/component/chat/chat.js","../src/component/chips/chips.js","../src/component/footer-create/footer-create.js","../src/component/footer-edit/footer-edit-const.js","../src/component/footer-edit/more/more.js","../src/component/footer-edit/footer-edit.js","../src/component/placeholder/placeholder.js","../src/component/app.js","../src/lib/close-popup.js","../src/task-full-card.js","../src/images/marshmallow_sad_pink_with_orange_lock.png"],"sourcesContent":["import { Notifier } from 'ui.notification-manager';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { AirButtonStyle, ButtonSize } from 'ui.vue3.components.button';\nimport { BMenu, type MenuOptions, type MenuItemOptions } from 'ui.system.menu.vue';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport { Core, type RightsParams } from 'tasks.v2.core';\nimport { TaskCard } from 'tasks.v2.application.task-card';\nimport { Analytics, Model } from 'tasks.v2.const';\nimport { showLimit } from 'tasks.v2.lib.show-limit';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport './burger-menu.css';\n\nconst sectionPersonal = 'sectionPersonal';\nconst sectionTasks = 'sectionTasks';\nconst sectionCopy = 'sectionCopy';\nconst sectionLinks = 'sectionLinks';\n\n// @vue/component\nexport const BurgerMenu = {\n\tname: 'TaskFullCardBurgerMenu',\n\tcomponents: {\n\t\tBIcon,\n\t\tBMenu,\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t\tanalytics: {},\n\t},\n\tsetup(): { task: TaskModel, userRights: RightsParams }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tuserRights: Core.getParams().rights,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tcurrentUserId: `${Model.Interface}/currentUserId`,\n\t\t}),\n\t\tmenuOptions(): Function\n\t\t{\n\t\t\treturn (): MenuOptions => ({\n\t\t\t\tid: 'tasks-full-card-header-burger-menu',\n\t\t\t\tbindElement: this.$refs.container,\n\t\t\t\tsections: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: sectionPersonal,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: sectionTasks,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: sectionCopy,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: sectionLinks,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: this.menuItems,\n\t\t\t});\n\t\t},\n\t\tmenuItems(): MenuItemOptions[]\n\t\t{\n\t\t\treturn [\n\t\t\t\tthis.task.rights.favorite && this.getFavoriteItem(),\n\t\t\t\tthis.task.rights.watch && this.getWatchItem(),\n\t\t\t\tthis.task.rights.mute && this.getMuteItem(),\n\t\t\t\tthis.userRights.tasks.create && this.getCreateNewTaskItem(),\n\t\t\t\tthis.task.rights.createSubtask && this.getCreateSubtaskItem(),\n\t\t\t\tthis.task.rights.copy && this.getCreateTaskCopyItem(),\n\t\t\t\tthis.userRights.tasks.createFromTemplate && this.getCreateNewTaskWithTemplateItem(),\n\t\t\t\tfalse && this.task.rights.saveAsTemplate && this.getCreateTemplateFromTaskItem(), // TODO: handle later\n\t\t\t\tthis.getCopyTaskIdItem(),\n\t\t\t\tthis.getGoToBitrixMarketItem(),\n\t\t\t\tthis.userRights.tasks.robot && this.getGoToRobotsItem(),\n\t\t\t].filter((item: MenuItemOptions) => item);\n\t\t},\n\t\tisStakeholderLocked(): boolean\n\t\t{\n\t\t\treturn !Core.getParams().restrictions.stakeholder.available;\n\t\t},\n\t},\n\tmethods: {\n\t\tgetFavoriteItem(): MenuItemOptions\n\t\t{\n\t\t\tconst favor = {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_FAVOR_ACTION'),\n\t\t\t\ticon: Outline.FAVORITE,\n\t\t\t\tsuccessNotification: this.loc('TASKS_V2_TASK_FULL_CARD_FAVOR_NOTIF_SUCC'),\n\t\t\t\tfailNotification: this.loc('TASKS_V2_TASK_FULL_CARD_FAVOR_NOTIF_FAIL'),\n\t\t\t};\n\n\t\t\tconst unFavor = {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_UNFAVOR_ACTION'),\n\t\t\t\ticon: Outline.NON_FAVORITE,\n\t\t\t\tsuccessNotification: this.loc('TASKS_V2_TASK_FULL_CARD_UNFAVOR_NOTIF_SUCC'),\n\t\t\t\tfailNotification: this.loc('TASKS_V2_TASK_FULL_CARD_UNFAVOR_NOTIF_FAIL'),\n\t\t\t};\n\n\t\t\tconst action = this.task.isFavorite ? unFavor : favor;\n\n\t\t\treturn {\n\t\t\t\tsectionCode: sectionPersonal,\n\t\t\t\ttitle: action.title,\n\t\t\t\ticon: action.icon,\n\t\t\t\tonClick: async (): void => {\n\t\t\t\t\tconst isSuccess = await taskService.setFavorite(this.taskId, !this.task.isFavorite);\n\t\t\t\t\tNotifier.notifyViaBrowserProvider({\n\t\t\t\t\t\tid: 'task-notify-favorite',\n\t\t\t\t\t\ttext: isSuccess ? action.successNotification : action.failNotification,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetWatchItem(): MenuItemOptions\n\t\t{\n\t\t\tconst watch = {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_BECOME_AUDITOR_ACTION'),\n\t\t\t\ticon: Outline.OBSERVER,\n\t\t\t\tsuccessNotification: this.loc('TASKS_V2_TASK_FULL_CARD_BECOME_AUDITOR_NOTIF_SUCC'),\n\t\t\t\tfailNotification: this.loc('TASKS_V2_TASK_FULL_CARD_BECOME_AUDITOR_NOTIF_FAIL'),\n\t\t\t\tauditorsIds: [...this.task.auditorsIds, this.currentUserId],\n\t\t\t\tendpoint: 'Task.Audit.watch',\n\t\t\t};\n\n\t\t\tconst unWatch = {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_STOP_BEING_AUDITOR_ACTION'),\n\t\t\t\ticon: Outline.CROSSED_EYE,\n\t\t\t\tsuccessNotification: this.loc('TASKS_V2_TASK_FULL_CARD_STOP_BEING_AUDITOR_NOTIF_SUCC'),\n\t\t\t\tfailNotification: this.loc('TASKS_V2_TASK_FULL_CARD_STOP_BEING_AUDITOR_NOTIF_FAIL'),\n\t\t\t\tauditorsIds: this.task.auditorsIds.filter((id: number) => id !== this.currentUserId),\n\t\t\t\tendpoint: 'Task.Audit.unwatch',\n\t\t\t};\n\n\t\t\tconst action = this.task.auditorsIds.includes(this.currentUserId) ? unWatch : watch;\n\n\t\t\treturn {\n\t\t\t\tsectionCode: sectionPersonal,\n\t\t\t\ttitle: action.title,\n\t\t\t\ticon: action.icon,\n\t\t\t\tisLocked: this.isStakeholderLocked,\n\t\t\t\tonClick: async (): void => {\n\t\t\t\t\tif (this.isStakeholderLocked)\n\t\t\t\t\t{\n\t\t\t\t\t\tvoid showLimit({\n\t\t\t\t\t\t\tfeatureId: Core.getParams().restrictions.stakeholder.featureId,\n\t\t\t\t\t\t\tbindElement: this.$el,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst result = await taskService.update(this.taskId, {\n\t\t\t\t\t\tauditorsIds: action.auditorsIds,\n\t\t\t\t\t});\n\n\t\t\t\t\tconst isSuccess = !result[action.endpoint]?.length;\n\n\t\t\t\t\tNotifier.notifyViaBrowserProvider({\n\t\t\t\t\t\tid: 'task-notify-watch',\n\t\t\t\t\t\ttext: isSuccess ? action.successNotification : action.failNotification,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetMuteItem(): MenuItemOptions\n\t\t{\n\t\t\tconst mute = {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_MUTE_ACTION'),\n\t\t\t\ticon: Outline.SOUND_OFF,\n\t\t\t\tsuccessNotificationTitle: this.loc('TASKS_V2_TASK_FULL_CARD_MUTE_NOTIF_SUCC_TITLE'),\n\t\t\t\tsuccessNotification: this.loc('TASKS_V2_TASK_FULL_CARD_MUTE_NOTIF_SUCC_DESCR'),\n\t\t\t\tfailNotification: this.loc('TASKS_V2_TASK_FULL_CARD_MUTE_NOTIF_FAIL'),\n\t\t\t};\n\n\t\t\tconst unMute = {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_UNMUTE_ACTION'),\n\t\t\t\ticon: Outline.SOUND_ON,\n\t\t\t\tsuccessNotificationTitle: this.loc('TASKS_V2_TASK_FULL_CARD_UNMUTE_NOTIF_SUCC_TITLE'),\n\t\t\t\tsuccessNotification: this.loc('TASKS_V2_TASK_FULL_CARD_UNMUTE_NOTIF_SUCC_DESCR'),\n\t\t\t\tfailNotification: this.loc('TASKS_V2_TASK_FULL_CARD_UNMUTE_NOTIF_FAIL'),\n\t\t\t};\n\n\t\t\tconst action = this.task.isMuted ? unMute : mute;\n\n\t\t\treturn {\n\t\t\t\tsectionCode: sectionPersonal,\n\t\t\t\ttitle: action.title,\n\t\t\t\ticon: action.icon,\n\t\t\t\tonClick: async (): void => {\n\t\t\t\t\tconst isSuccess = await taskService.setMute(this.taskId, !this.task.isMuted);\n\t\t\t\t\tNotifier.notifyViaBrowserProvider({\n\t\t\t\t\t\tid: 'task-notify-mute',\n\t\t\t\t\t\ttitle: action.successNotificationTitle,\n\t\t\t\t\t\ttext: isSuccess ? action.successNotification : action.failNotification,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetCreateNewTaskItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: sectionTasks,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_CREATE_STANDALONE_TASK'),\n\t\t\t\ticon: Outline.TASK,\n\t\t\t\tonClick: (): void => TaskCard.showCompactCard({\n\t\t\t\t\tgroupId: this.task.groupId,\n\t\t\t\t\tanalytics: this.getAnalytics(),\n\t\t\t\t}),\n\t\t\t};\n\t\t},\n\t\tgetCreateSubtaskItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: sectionTasks,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_CREATE_SUBTASK'),\n\t\t\t\ticon: Outline.RELATED_TASKS,\n\t\t\t\tonClick: (): void => TaskCard.showCompactCard({\n\t\t\t\t\tgroupId: this.task.groupId,\n\t\t\t\t\tparentId: this.taskId,\n\t\t\t\t\tanalytics: this.getAnalytics(Analytics.Element.ContextMenuSubtask),\n\t\t\t\t}),\n\t\t\t};\n\t\t},\n\t\tgetCreateTaskCopyItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: sectionTasks,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_CREATE_TASK_COPY'),\n\t\t\t\ticon: Outline.DUPLICATE,\n\t\t\t\tonClick: (): void => TaskCard.showFullCard({\n\t\t\t\t\tcopiedFromId: this.taskId,\n\t\t\t\t\tanalytics: this.getAnalytics(),\n\t\t\t\t}),\n\t\t\t};\n\t\t},\n\t\tgetCreateNewTaskWithTemplateItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: sectionTasks,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_CREATE_STANDALONE_TASK_WITH_TEMPLATE'),\n\t\t\t\ticon: Outline.CHEVRON_RIGHT_L,\n\t\t\t\tonClick: (): void => {\n\t\t\t\t\t// TODO: change to new template creation page when it will be ready\n\t\t\t\t\tBX.SidePanel.Instance.open(`/company/personal/user/${this.currentUserId}/tasks/templates/`, {\n\t\t\t\t\t\tnewWindowLabel: false,\n\t\t\t\t\t\tcopyLinkLabel: false,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetCreateTemplateFromTaskItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: sectionTasks,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_CREATE_TEMPLATE_FROM_TASK'),\n\t\t\t\ticon: Outline.TEMPLATE_TASK,\n\t\t\t\tonClick: (): void => TaskCard.showCompactCard({\n\t\t\t\t\tgroupId: this.task.groupId,\n\t\t\t\t\tanalytics: this.getAnalytics(),\n\t\t\t\t}),\n\t\t\t};\n\t\t},\n\t\tgetCopyTaskIdItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: sectionCopy,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_COPY_TASK_ID_ACTION'),\n\t\t\t\ticon: Outline.COPY,\n\t\t\t\tonClick: (): void => {\n\t\t\t\t\tconst isCopyingSuccess = BX.clipboard.copy(this.taskId);\n\t\t\t\t\tif (isCopyingSuccess)\n\t\t\t\t\t{\n\t\t\t\t\t\tNotifier.notifyViaBrowserProvider({\n\t\t\t\t\t\t\tid: 'task-notify-copy',\n\t\t\t\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_COPY_TASK_ID_NOTIF'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetGoToBitrixMarketItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: sectionLinks,\n\t\t\t\tuiButtonOptions: {\n\t\t\t\t\ticon: Outline.MARKET,\n\t\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_GO_TO_BITRIX_MARKET'),\n\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\tuseAirDesign: true,\n\t\t\t\t\tstyle: AirButtonStyle.OUTLINE,\n\t\t\t\t\twide: true,\n\t\t\t\t\tdisabled: false,\n\t\t\t\t\tonclick: (): void => BX.rest.Marketplace.open({ PLACEMENT: 'TASK_LIST_CONTEXT_MENU' }),\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetGoToRobotsItem(): MenuItemOptions\n\t\t{\n\t\t\tconst isLocked = !Core.getParams().restrictions.robots.available;\n\n\t\t\treturn {\n\t\t\t\tsectionCode: sectionLinks,\n\t\t\t\tuiButtonOptions: {\n\t\t\t\t\ticon: isLocked ? Outline.LOCK_L : Outline.ROBOT,\n\t\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_GO_TO_ROBOTS'),\n\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\tuseAirDesign: true,\n\t\t\t\t\tstyle: AirButtonStyle.OUTLINE,\n\t\t\t\t\twide: true,\n\t\t\t\t\tdisabled: false,\n\t\t\t\t\tonclick: (): void => {\n\t\t\t\t\t\tif (isLocked)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.isMenuShown = false;\n\n\t\t\t\t\t\t\tvoid showLimit({\n\t\t\t\t\t\t\t\tfeatureId: Core.getParams().restrictions.robots.featureId,\n\t\t\t\t\t\t\t\tbindElement: this.$refs.container,\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\t\t\t\t`/bitrix/components/bitrix/tasks.automation/slider.php?site_id=${this.loc('SITE_ID')}&project_id=${this.task.groupId}&task_id=${this.taskId}`,\n\t\t\t\t\t\t\t{ cacheable: false, customLeftBoundary: 0, loader: 'bizproc:automation-loader' },\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetAnalytics(element = Analytics.Element.ContextMenu): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\telement,\n\t\t\t\tcontext: this.analytics?.context ?? Analytics.Section.Tasks,\n\t\t\t\tadditionalContext: Analytics.SubSection.TaskCard,\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"tasks-full-card-header-burger\"\n\t\t\tref=\"container\"\n\t\t\t@click=\"isMenuShown = true\"\n\t\t>\n\t\t\t<BIcon :name=\"Outline.MORE_L\" hoverable/>\n\t\t</div>\n\t\t<BMenu v-if=\"isMenuShown\" :options=\"menuOptions()\" @close=\"isMenuShown = false\"/>\n\t`,\n};\n","import { Title as TitleField } from 'tasks.v2.component.fields.title';\nimport { Importance } from 'tasks.v2.component.fields.importance';\n\nimport { BurgerMenu } from './burger-menu/burger-menu';\nimport './task-header.css';\n\n// @vue/component\nexport const TaskHeader = {\n\tname: 'TaskFullCardHeader',\n\tcomponents: {\n\t\tTitleField,\n\t\tImportance,\n\t\tBurgerMenu,\n\t},\n\tinject: {\n\t\tisEdit: {},\n\t\tisTemplate: {},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-full-card-header\">\n\t\t\t<TitleField/>\n\t\t\t<Importance/>\n\t\t\t<BurgerMenu v-if=\"!isTemplate && isEdit\"/>\n\t\t</div>\n\t`,\n};\n","import { Hint } from 'tasks.v2.component.elements.hint';\nimport { highlighter } from 'tasks.v2.lib.highlighter';\n\nimport './task-settings-hint.css';\n\n// @vue/component\nexport const TaskSettingsHint = {\n\tname: 'TasksTaskSettingsHint',\n\tcomponents: {\n\t\tHint,\n\t},\n\tprops: {\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\tdefault: () => null,\n\t\t},\n\t},\n\tcomputed: {},\n\tcreated()\n\t{\n\t\tvoid highlighter.highlight(this.bindElement);\n\t},\n\ttemplate: `\n\t\t<Hint\n\t\t\tv-if=\"isShown\"\n\t\t\t:bindElement\n\t\t\t:options=\"{\n\t\t\t\tmaxWidth: 460,\n\t\t\t\tcloseIcon: true,\n\t\t\t\toffsetLeft: 14,\n\t\t\t}\"\n\t\t\t@close=\"$emit('close')\"\n\t\t>\n\t\t\t<div class=\"tasks-task-settings-hint\">\n\t\t\t\t<div class=\"tasks-task-settings-hint-image\">\n\t\t\t\t\t<div class=\"tasks-task-settings-hint-icon\"/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-task-settings-hint-content\">\n\t\t\t\t\t<div class=\"tasks-task-settings-hint-title\">\n\t\t\t\t\t\t{{ loc('TASKS_V2_TASK_FULL_CARD_AHA_TASK_SETTINGS_HINT_TITLE') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-task-settings-hint-text\">\n\t\t\t\t\t\t{{ loc('TASKS_V2_TASK_FULL_CARD_AHA_TASK_SETTINGS_HINT_TEXT') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Hint>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Outline } from 'ui.icon-set.api.vue';\n\nimport { EventName } from 'tasks.v2.const';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\n\nimport type { MenuItemOptions } from 'ui.system.menu';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\n// eslint-disable-next-line no-unused-vars\nimport type { TaskCommentsMessageMenu } from 'im.v2.lib.menu';\n\n/**\n * @param {typeof TaskCommentsMessageMenu} baseMenu\n * @returns {typeof TaskCommentsMessageMenu}\n */\n// eslint-disable-next-line max-lines-per-function\nexport const TaskFullCardMessageMenu = (baseMenu) => class extends baseMenu\n{\n\tgetAddResultItem(): ?MenuItemOptions\n\t{\n\t\tif (\n\t\t\tthis.isDeletedMessage()\n\t\t\t|| !this.isOwnMessage()\n\t\t\t|| !this.#shouldShowAddResult()\n\t\t)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('TASKS_V2_TASK_FULL_CARD_MESSAGE_ADD_RESULT'),\n\t\t\ticon: Outline.FLAG,\n\t\t\tonClick: (): void => {\n\t\t\t\tEventEmitter.emit(EventName.AddResultFromChat, {\n\t\t\t\t\ttaskId: this.getTaskId(),\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\ttext: this.context.text,\n\t\t\t\t\tauthorId: this.context.authorId,\n\t\t\t\t});\n\n\t\t\t\tthis.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetRemoveResultItem(): ?MenuItemOptions\n\t{\n\t\tif (\n\t\t\tthis.isDeletedMessage()\n\t\t\t|| !this.isOwnMessage()\n\t\t\t|| !this.#shouldShowRemoveResult()\n\t\t)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('TASKS_V2_TASK_FULL_CARD_MESSAGE_DELETE_RESULT'),\n\t\t\ticon: Outline.FLAG_WITH_CROSS,\n\t\t\tonClick: (): void => {\n\t\t\t\tEventEmitter.emit(EventName.DeleteResultFromChat, {\n\t\t\t\t\ttaskId: this.getTaskId(),\n\t\t\t\t\tresultId: this.#getMessageResultId(),\n\t\t\t\t});\n\n\t\t\t\tthis.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetTaskId(): number\n\t{\n\t\treturn 0; // reinitialize in the calling class\n\t}\n\n\t#shouldShowAddResult(): boolean\n\t{\n\t\tconst task = this.#getTask();\n\t\tif (!task)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn !this.#getMessageResultId();\n\t}\n\n\t#shouldShowRemoveResult(): boolean\n\t{\n\t\tconst task = this.#getTask();\n\t\tif (!task)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.#getMessageResultId() > 0;\n\t}\n\n\t#getMessageResultId(): number\n\t{\n\t\tconst task = this.#getTask();\n\t\tif (!task)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst map = task?.resultsMessageMap || {};\n\t\tconst messageId = this.context.id;\n\n\t\tfor (const [resultId, boundMessageId] of Object.entries(map))\n\t\t{\n\t\t\tif (boundMessageId !== null && Number(boundMessageId) === Number(messageId))\n\t\t\t{\n\t\t\t\treturn Number(resultId);\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\t#getTask(): ?TaskModel\n\t{\n\t\treturn taskService.getStoreTask(this.getTaskId());\n\t}\n};\n","import { highlighter } from 'tasks.v2.lib.highlighter';\nimport { HeadlineSm, TextMd } from 'ui.system.typography.vue';\nimport { Button as UiButton, AirButtonStyle, ButtonSize } from 'ui.vue3.components.button';\nimport { Outline } from 'ui.icon-set.api.vue';\n\nimport { Hint } from 'tasks.v2.component.elements.hint';\n\nimport './chat-aha.css';\n\n// @vue/component\nexport const ChatAha = {\n\tcomponents: {\n\t\tUiButton,\n\t\tHint,\n\t\tTextMd,\n\t\tHeadlineSm,\n\t},\n\tprops: {\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\tdefault: () => null,\n\t\t},\n\t},\n\temits: ['close'],\n\tsetup(): void\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tAirButtonStyle,\n\t\t\tButtonSize,\n\t\t};\n\t},\n\tcreated()\n\t{\n\t\tvoid highlighter.highlight(this.bindElement, 1000);\n\t},\n\ttemplate: `\n\t\t<Hint\n\t\t\tv-if=\"isShown\"\n\t\t\t:bindElement\n\t\t\t:options=\"{\n\t\t\t\tcloseIcon: true,\n\t\t\t\tminWidth: 500,\n\t\t\t\tmaxWidth: 500,\n\t\t\t\tpadding: 0,\n\t\t\t\toffsetLeft: 22,\n\t\t\t}\"\n\t\t\t@close=\"$emit('close')\"\n\t\t>\n\t\t\t<div class=\"tasks-chat-aha-container\">\n\t\t\t\t<div class=\"tasks-chat-aha-icon\"/>\n\t\t\t\t<div class=\"tasks-chat-aha-info\">\n\t\t\t\t\t<HeadlineSm class=\"tasks-chat-aha-info-text\">\n\t\t\t\t\t\t{{ loc('TASKS_V2_TASK_FULL_CARD_CHAT_AHA_TITLE') }}\n\t\t\t\t\t</HeadlineSm>\n\t\t\t\t\t<TextMd class=\"tasks-chat-aha-info-text\">\n\t\t\t\t\t\t{{ loc('TASKS_V2_TASK_FULL_CARD_CHAT_AHA_DESC') }}\n\t\t\t\t\t</TextMd>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Hint>\n\t`,\n};\n","import { highlighter } from 'tasks.v2.lib.highlighter';\nimport { HeadlineSm, TextMd } from 'ui.system.typography.vue';\nimport { Button as UiButton, AirButtonStyle, ButtonSize } from 'ui.vue3.components.button';\nimport { Outline } from 'ui.icon-set.api.vue';\n\nimport { Hint } from 'tasks.v2.component.elements.hint';\n\nimport './important-messages-aha.css';\n\n// @vue/component\nexport const ImportantMessagesAha = {\n\tcomponents: {\n\t\tUiButton,\n\t\tHint,\n\t\tTextMd,\n\t\tHeadlineSm,\n\t},\n\tprops: {\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\tdefault: () => null,\n\t\t},\n\t},\n\temits: ['close'],\n\tsetup(): void\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tAirButtonStyle,\n\t\t\tButtonSize,\n\t\t};\n\t},\n\tcreated()\n\t{\n\t\tvoid highlighter.highlight(this.bindElement, 2000);\n\t},\n\ttemplate: `\n\t\t<Hint\n\t\t\tv-if=\"isShown\"\n\t\t\t:bindElement\n\t\t\t:options=\"{\n\t\t\t\tcloseIcon: true,\n\t\t\t\tminWidth: 500,\n\t\t\t\tmaxWidth: 500,\n\t\t\t\tpadding: 0,\n\t\t\t\toffsetLeft: bindElement.offsetWidth / 4,\n\t\t\t\tangle: {\n\t\t\t\t\toffset: bindElement.offsetWidth / 4,\n\t\t\t\t}\n\t\t\t}\"\n\t\t\t@close=\"$emit('close')\"\n\t\t>\n\t\t\t<div class=\"tasks-important-messages-aha-container\">\n\t\t\t\t<div class=\"tasks-important-messages-aha-icon\"/>\n\t\t\t\t<div class=\"tasks-important-messages-aha-info\">\n\t\t\t\t\t<HeadlineSm class=\"tasks-important-messages-aha-info-text\">\n\t\t\t\t\t\t{{ loc('TASKS_V2_TASK_FULL_CARD_IMPORTANT_MESSAGES_TITLE') }}\n\t\t\t\t\t</HeadlineSm>\n\t\t\t\t\t<TextMd class=\"tasks-important-messages-aha-info-text\">\n\t\t\t\t\t\t{{ loc('TASKS_V2_TASK_FULL_CARD_IMPORTANT_MESSAGES_DESC') }}\n\t\t\t\t\t</TextMd>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Hint>\n\t`,\n};\n","import { Runtime } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nimport { Core } from 'tasks.v2.core';\nimport { Option } from 'tasks.v2.const';\nimport { ahaMoments } from 'tasks.v2.lib.aha-moments';\n\nimport type { MessageMenuContext } from 'im.v2.lib.menu';\n\nimport { TaskFullCardMessageMenu } from './message-menu';\nimport { ChatAha } from '../aha/chat-aha/chat-aha';\nimport { ImportantMessagesAha } from '../aha/important-messages-aha/important-messages-aha';\n\nimport './chat.css';\n\n// @vue/component\nexport const Chat = {\n\tname: 'TaskFullCardChat',\n\tcomponents: {\n\t\tChatAha,\n\t\tImportantMessagesAha,\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t\tisEdit: {},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\t/** @type MessageMenuContext */\n\t\t\tmessageMenuManager: null,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisTaskChatAhaShown: false,\n\t\t\tisTaskImportantMessagesAhaShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttaskChatAhaBindElement(): ?HTMLElement\n\t\t{\n\t\t\tif (this.$refs.chat)\n\t\t\t{\n\t\t\t\treturn this.$refs.chat.querySelector('.bx-im-chat-header__left');\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\ttaskImportantMessagesAhaBindElement(): ?HTMLElement\n\t\t{\n\t\t\tif (this.$refs.chat)\n\t\t\t{\n\t\t\t\treturn this.$refs.chat.querySelector('.bx-im-send-panel__container');\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t},\n\twatch: {\n\t\tasync taskId(): void\n\t\t{\n\t\t\tawait this.openChat();\n\n\t\t\tvoid this.registerMessageMenu();\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tif (this.isEdit)\n\t\t{\n\t\t\tthis.registerMessageMenu();\n\t\t}\n\t},\n\tmounted(): void\n\t{\n\t\tvoid this.openChat();\n\t},\n\tunmounted(): void\n\t{\n\t\tthis.unregisterMessageMenu();\n\t\tthis.app?.bitrixVue.unmount();\n\t},\n\tmethods: {\n\t\tasync openChat(): Promise<void>\n\t\t{\n\t\t\tif (!Core.getParams().features.im)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.app?.bitrixVue.unmount();\n\n\t\t\tconst { Messenger } = await Runtime.loadExtension('im.public');\n\n\t\t\tthis.app ??= await Messenger.initApplication('task'); // im.v2.application.integration.task\n\n\t\t\tif (this.isEdit)\n\t\t\t{\n\t\t\t\tawait this.app.mount({\n\t\t\t\t\trootContainer: this.$refs.chat,\n\t\t\t\t\tchatId: this.task.chatId,\n\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t\ttype: Core.getParams().chatType,\n\t\t\t\t});\n\n\t\t\t\tthis.tryShowAha();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tawait this.app.mountPlaceholder({\n\t\t\t\t\trootContainer: this.$refs.chat,\n\t\t\t\t\ttaskId: `'${this.taskId}'`,\n\t\t\t\t});\n\n\t\t\t\tEventEmitter.emit('tasks:card:onMembersCountChange', {\n\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t\tuserCounter: 1,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tasync registerMessageMenu(): void\n\t\t{\n\t\t\tif (!Core.getParams().features.im)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { TaskCommentsMessageMenu, MessageMenuManager } = await Runtime.loadExtension('im.v2.lib.menu');\n\t\t\tthis.messageMenuManager = MessageMenuManager;\n\n\t\t\tconst taskId = this.taskId;\n\t\t\tconst taskFullCardMessageMenu = class extends TaskFullCardMessageMenu(TaskCommentsMessageMenu)\n\t\t\t{\n\t\t\t\tgetTaskId(): number\n\t\t\t\t{\n\t\t\t\t\treturn taskId;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.messageMenuManager.getInstance().registerMenuByCallback(this.isCurrentChat, taskFullCardMessageMenu);\n\t\t},\n\t\tunregisterMessageMenu(): void\n\t\t{\n\t\t\tthis.messageMenuManager?.getInstance().unregisterMenuByCallback(this.isCurrentChat);\n\t\t},\n\t\tisCurrentChat(messageContext: MessageMenuContext): boolean\n\t\t{\n\t\t\treturn messageContext.chatId === this.task.chatId;\n\t\t},\n\t\ttryShowAha(): void\n\t\t{\n\t\t\tif (this.taskChatAhaBindElement && ahaMoments.shouldShow(Option.AhaTaskChatPopup))\n\t\t\t{\n\t\t\t\tahaMoments.setActive(Option.AhaTaskChatPopup);\n\n\t\t\t\tsetTimeout(this.showTaskChatAha, 3000);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.taskImportantMessagesAhaBindElement && ahaMoments.shouldShow(Option.AhaTaskImportantMessagesPopup))\n\t\t\t{\n\t\t\t\tahaMoments.setActive(Option.AhaTaskImportantMessagesPopup);\n\n\t\t\t\tsetTimeout(this.showTaskImportantMessagesAha, 3000);\n\t\t\t}\n\t\t},\n\t\tshowTaskChatAha(): void\n\t\t{\n\t\t\tthis.isTaskChatAhaShown = true;\n\n\t\t\tahaMoments.setShown(Option.AhaTaskChatPopup);\n\t\t},\n\t\tshowTaskImportantMessagesAha(): void\n\t\t{\n\t\t\tthis.isTaskImportantMessagesAhaShown = true;\n\n\t\t\tahaMoments.setShown(Option.AhaTaskImportantMessagesPopup);\n\t\t},\n\t\thandleCloseChatAha(): void\n\t\t{\n\t\t\tthis.isTaskChatAhaShown = false;\n\t\t\tahaMoments.setInactive(Option.AhaTaskChatPopup);\n\n\t\t\tif (ahaMoments.shouldShow(Option.AhaTaskImportantMessagesPopup))\n\t\t\t{\n\t\t\t\tsetTimeout(this.showTaskImportantMessagesAha, 2000);\n\t\t\t}\n\t\t},\n\t\thandleCloseImportantMessagesAha(): void\n\t\t{\n\t\t\tthis.isTaskImportantMessagesAhaShown = false;\n\t\t\tahaMoments.setInactive(Option.AhaTaskImportantMessagesPopup);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-full-card-chat\" ref=\"chat\">\n\t\t\t<div style=\"color: #f00\">module 'im' is not installed</div>\n\t\t</div>\n\t\t<ChatAha\n\t\t\tv-if=\"isTaskChatAhaShown\"\n\t\t\t:isShown=\"isTaskChatAhaShown\"\n\t\t\t:bindElement=\"taskChatAhaBindElement\"\n\t\t\t@close=\"handleCloseChatAha\"\n\t\t/>\n\t\t<ImportantMessagesAha\n\t\t\tv-if=\"isTaskImportantMessagesAhaShown\"\n\t\t\t:isShown=\"isTaskImportantMessagesAhaShown\"\n\t\t\t:bindElement=\"taskImportantMessagesAhaBindElement\"\n\t\t\t@close=\"handleCloseImportantMessagesAha\"\n\t\t/>\n\t`,\n};\n","import { Chip, ChipDesign } from 'ui.system.chip.vue';\nimport { Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport type { AppChip } from 'tasks.v2.application.task-card';\n\nimport './chips.css';\n\nconst maxVisible = 50;\n\n// @vue/component\nexport const Chips = {\n\tcomponents: {\n\t\tChip,\n\t},\n\tprops: {\n\t\t/** @type AppChip[] */\n\t\tchips: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tChipDesign,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tchipsCollapsed: true,\n\t\t};\n\t},\n\tcomputed: {\n\t\tpreparedChips(): AppChip[]\n\t\t{\n\t\t\treturn this.chips.filter(({ isEnabled }) => isEnabled ?? true).map((chip, index) => ({\n\t\t\t\t...chip,\n\t\t\t\tcollapsed: index >= maxVisible,\n\t\t\t}));\n\t\t},\n\t\thasCollapsedChips(): boolean\n\t\t{\n\t\t\treturn this.preparedChips.some(({ collapsed }) => collapsed);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-full-card-chips\">\n\t\t\t<template v-for=\"(chip, key) of preparedChips\" :key>\n\t\t\t\t<component\n\t\t\t\t\tv-if=\"!chip.collapsed || !chipsCollapsed\"\n\t\t\t\t\t:is=\"chip.component\"\n\t\t\t\t\tv-bind=\"chip.props ?? {}\"\n\t\t\t\t\tv-on=\"chip.events ?? {}\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<Chip\n\t\t\t\tv-if=\"hasCollapsedChips\"\n\t\t\t\t:design=\"ChipDesign.ShadowNoAccent\"\n\t\t\t\t:icon=\"chipsCollapsed ? Outline.APPS : Outline.CHEVRON_TOP_L\"\n\t\t\t\t:text=\"chipsCollapsed ? loc('TASKS_V2_TASK_FULL_CARD_MORE') : ''\"\n\t\t\t\t@click=\"chipsCollapsed = !chipsCollapsed\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { BitrixVue } from 'ui.vue3';\nimport { Button as UiButton, AirButtonStyle, ButtonSize } from 'ui.vue3.components.button';\nimport { BLine } from 'ui.system.skeleton.vue';\n\nimport { Core } from 'tasks.v2.core';\nimport { AddTaskButton } from 'tasks.v2.component.add-task-button';\n\nimport './footer-create.css';\n\n// @vue/component\nexport const FooterCreate = {\n\tcomponents: {\n\t\tUiButton,\n\t\tAddTaskButton,\n\t\tTemplatesButton: BitrixVue.defineAsyncComponent(\n\t\t\t'tasks.v2.component.templates-button',\n\t\t\t'TemplatesButton',\n\t\t\t{\n\t\t\t\tdelay: 0,\n\t\t\t\tloadingComponent: {\n\t\t\t\t\tcomponents: { BLine },\n\t\t\t\t\ttemplate: '<BLine :width=\"131\" :height=\"22\"/>',\n\t\t\t\t},\n\t\t\t},\n\t\t),\n\t\tTemplatePermissionsButton: BitrixVue.defineAsyncComponent(\n\t\t\t'tasks.v2.component.template-permissions-button',\n\t\t\t'TemplatePermissionsButton',\n\t\t\t{\n\t\t\t\tdelay: 0,\n\t\t\t\tloadingComponent: {\n\t\t\t\t\tcomponents: { BLine },\n\t\t\t\t\ttemplate: '<BLine :width=\"131\" :height=\"22\"/>',\n\t\t\t\t},\n\t\t\t},\n\t\t),\n\t},\n\tinject: {\n\t\t/** @type{boolean} */\n\t\tisTemplate: {},\n\t},\n\tprops: {\n\t\tcreationError: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['addTask', 'copyTask', 'fromTemplate', 'template', 'update:creationError', 'close'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t\tButtonSize,\n\t\t};\n\t},\n\tcomputed: {\n\t\thasError: {\n\t\t\tget(): boolean\n\t\t\t{\n\t\t\t\treturn this.creationError;\n\t\t\t},\n\t\t\tset(creationError: boolean): void\n\t\t\t{\n\t\t\t\tthis.$emit('update:creationError', creationError);\n\t\t\t},\n\t\t},\n\t\tisTemplateEnabled(): boolean\n\t\t{\n\t\t\treturn Core.getParams().features.isTemplateEnabled;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-full-card-footer\">\n\t\t\t<div class=\"tasks-full-card-footer-create\">\n\t\t\t\t<div class=\"tasks-full-card-footer-main-buttons\">\n\t\t\t\t\t<AddTaskButton\n\t\t\t\t\t\tv-model:hasError=\"hasError\"\n\t\t\t\t\t\t@addTask=\"$emit('addTask')\"\n\t\t\t\t\t\t@copyTask=\"$emit('copyTask', $event)\"\n\t\t\t\t\t\t@fromTemplate=\"$emit('fromTemplate', $event)\"\n\t\t\t\t\t/>\n\t\t\t\t\t<UiButton\n\t\t\t\t\t\t:text=\"loc('TASKS_V2_TASK_FULL_CARD_CANCEL')\"\n\t\t\t\t\t\t:size=\"ButtonSize.LARGE\"\n\t\t\t\t\t\t:style=\"AirButtonStyle.PLAIN\"\n\t\t\t\t\t\t:dataset=\"{ taskButtonId: 'cancel' }\"\n\t\t\t\t\t\t@click=\"$emit('close')\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<TemplatesButton v-if=\"!isTemplate && isTemplateEnabled\" @template=\"$emit('template', $event)\"/>\n\t\t\t\t<TemplatePermissionsButton v-if=\"isTemplate\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export const ButtonId = Object.freeze({\n\tStart: 'start',\n\tTake: 'take',\n\tPause: 'pause',\n\tComplete: 'complete',\n\tRenew: 'renew',\n\tReview: 'review',\n\tApprove: 'approve',\n});\n","import { EventEmitter } from 'main.core.events';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Button as UiButton, AirButtonStyle, ButtonSize } from 'ui.vue3.components.button';\nimport { BMenu, MenuItemDesign, type MenuOptions, type MenuItemOptions } from 'ui.system.menu.vue';\nimport { Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport { TaskCard } from 'tasks.v2.application.task-card';\nimport { EventName, GroupType, Model, TaskStatus, Analytics } from 'tasks.v2.const';\nimport { usersDialog } from 'tasks.v2.lib.user-selector-dialog';\nimport { showLimit } from 'tasks.v2.lib.show-limit';\nimport { idUtils } from 'tasks.v2.lib.id-utils';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { templateService } from 'tasks.v2.provider.service.template-service';\nimport { statusService } from 'tasks.v2.provider.service.status-service';\nimport type { GroupModel } from 'tasks.v2.model.groups';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { CoreParams } from 'tasks.v2.core';\n\nimport { ButtonId } from '../footer-edit-const';\nimport type { ButtonOptions } from '../footer-edit';\n\nimport './more.css';\n\n// @vue/component\nexport const More = {\n\tname: 'TaskFullCardMoreActionsStatus',\n\tcomponents: {\n\t\tUiButton,\n\t\tBMenu,\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t\tisTemplate: {},\n\t\tsettings: {},\n\t\tanalytics: {},\n\t},\n\tprops: {\n\t\tselectedButtons: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t},\n\tsetup(): {\n\t\tOutline: typeof Outline,\n\t\tAirButtonStyle: typeof AirButtonStyle,\n\t\tButtonSize: typeof ButtonSize,\n\t\ttask: TaskModel,\n\t\tsettings: CoreParams,\n\t\t}\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tAirButtonStyle,\n\t\t\tButtonSize,\n\t\t};\n\t},\n\tdata(): { isMenuShown: boolean, loading: boolean }\n\t{\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t\tloading: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tcurrentUserId: `${Model.Interface}/currentUserId`,\n\t\t}),\n\t\tgroup(): ?GroupModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Groups}/getById`](this.task.groupId);\n\t\t},\n\t\tisScrum(): boolean\n\t\t{\n\t\t\treturn this.group?.type === GroupType.Scrum;\n\t\t},\n\t\tisCreator(): boolean\n\t\t{\n\t\t\treturn this.currentUserId === this.task.creatorId;\n\t\t},\n\t\tisResponsible(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.task.responsibleIds.includes(this.currentUserId)\n\t\t\t\t|| this.task.accomplicesIds?.includes(this.currentUserId)\n\t\t\t);\n\t\t},\n\t\tmenuOptions(): Function\n\t\t{\n\t\t\treturn (): MenuOptions => ({\n\t\t\t\tid: 'tasks-full-card-footer-more-menu',\n\t\t\t\tbindElement: this.$refs.button,\n\t\t\t\titems: this.menuItems,\n\t\t\t});\n\t\t},\n\t\tmenuItems(): MenuItemOptions[]\n\t\t{\n\t\t\tif (this.isTemplate)\n\t\t\t{\n\t\t\t\treturn [\n\t\t\t\t\tthis.getCreateSubtaskForTemplate(),\n\t\t\t\t\tthis.getCopyTemplate(),\n\t\t\t\t\tthis.getDeleteTemplate(),\n\t\t\t\t].filter((item) => item !== null);\n\t\t\t}\n\n\t\t\tconst statuses = {\n\t\t\t\t[TaskStatus.Pending]: [\n\t\t\t\t\tthis.getCompleteItem(),\n\t\t\t\t\tthis.getDefferItem(),\n\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\tthis.getDeleteItem(),\n\t\t\t\t\tthis.getStartItem(),\n\t\t\t\t],\n\t\t\t\t[TaskStatus.InProgress]: [\n\t\t\t\t\tthis.getPauseItem(),\n\t\t\t\t\tthis.getDefferItem(),\n\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\tthis.getDeleteItem(),\n\t\t\t\t],\n\t\t\t\t[TaskStatus.Deferred]: [\n\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\tthis.getDeleteItem(),\n\t\t\t\t\tthis.getCompleteItem(),\n\t\t\t\t],\n\t\t\t\t[TaskStatus.SupposedlyCompleted]: [\n\t\t\t\t\tthis.getFixItem(),\n\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\tthis.getDeleteItem(),\n\t\t\t\t],\n\t\t\t\t[TaskStatus.Completed]: [\n\t\t\t\t\tthis.getRenewItem(),\n\t\t\t\t\tthis.getDeleteItem(),\n\t\t\t\t],\n\t\t\t};\n\n\t\t\tconst items = statuses[this.task.status] || [];\n\n\t\t\treturn items.filter((item) => item !== null);\n\t\t},\n\t\tselectedButtonIds(): Set\n\t\t{\n\t\t\treturn new Set(this.selectedButtons.map((button: ButtonOptions) => button?.id));\n\t\t},\n\t\tisDelegateLocked(): boolean\n\t\t{\n\t\t\treturn !this.settings.restrictions.delegating.available;\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tthis.isMenuShown = true;\n\t\t},\n\t\tgetStartItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.start)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (this.selectedButtonIds.has(ButtonId.Start) || this.selectedButtonIds.has(ButtonId.Take))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_START'),\n\t\t\t\ticon: Outline.PLAY_L,\n\t\t\t\tonClick: (): void => this.waitStatus(statusService.start(this.taskId)),\n\t\t\t};\n\t\t},\n\t\tgetDefferItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.defer)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_DEFER'),\n\t\t\t\ticon: Outline.PAUSE_L,\n\t\t\t\tonClick: (): void => this.waitStatus(statusService.defer(this.taskId)),\n\t\t\t};\n\t\t},\n\t\tgetPauseItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.pause)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (this.selectedButtonIds.has(ButtonId.Pause))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_PAUSE'),\n\t\t\t\ticon: Outline.HOURGLASS,\n\t\t\t\tonClick: (): void => this.waitStatus(statusService.pause(this.taskId)),\n\t\t\t};\n\t\t},\n\t\tgetRenewItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.renew)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (this.selectedButtonIds.has(ButtonId.Renew))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_RENEW'),\n\t\t\t\ticon: Outline.UNDO,\n\t\t\t\tonClick: (): void => this.waitStatus(statusService.renew(this.taskId)),\n\t\t\t};\n\t\t},\n\t\tgetFixItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.renew && !this.task.rights.disapprove)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst title = this.isCreator && !this.isResponsible\n\t\t\t\t? this.loc('TASKS_V2_TASK_FULL_CARD_DISAPPROVE')\n\t\t\t\t: this.loc('TASKS_V2_TASK_FULL_CARD_FIX')\n\t\t\t;\n\n\t\t\tconst onClick = this.task.rights.renew\n\t\t\t\t? (): void => this.waitStatus(statusService.renew(this.taskId))\n\t\t\t\t: (): void => this.waitStatus(statusService.disapprove(this.taskId))\n\t\t\t;\n\n\t\t\treturn {\n\t\t\t\ttitle,\n\t\t\t\tonClick,\n\t\t\t\ticon: Outline.UNDO,\n\t\t\t};\n\t\t},\n\t\tgetCompleteItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.complete)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (this.selectedButtonIds.has(ButtonId.Complete))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_COMPLETE'),\n\t\t\t\ticon: Outline.SENDED,\n\t\t\t\tonClick: (): void => this.waitStatus(statusService.complete(\n\t\t\t\t\tthis.taskId,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontext: this.analytics?.context ?? Analytics.Section.Tasks,\n\t\t\t\t\t\tadditionalContext: this.analytics?.additionalContext ?? Analytics.SubSection.TaskCard,\n\t\t\t\t\t\telement: Analytics.Element.ContextMenu,\n\t\t\t\t\t},\n\t\t\t\t)),\n\t\t\t};\n\t\t},\n\t\tgetDelegateItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.delegate)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ticon: Outline.DELEGATE,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_DELEGATE'),\n\t\t\t\tisLocked: this.isDelegateLocked,\n\t\t\t\tonClick: (): void => this.handleDelegateSelect(),\n\t\t\t};\n\t\t},\n\t\thandleClose(responsibleIds: number[]): void\n\t\t{\n\t\t\tif (responsibleIds.length === 1)\n\t\t\t{\n\t\t\t\tvoid taskService.update(this.taskId, { responsibleIds });\n\t\t\t}\n\t\t},\n\t\tasync handleDelegateSelect(): void\n\t\t{\n\t\t\tif (this.isDelegateLocked)\n\t\t\t{\n\t\t\t\tvoid showLimit({\n\t\t\t\t\tfeatureId: this.settings.restrictions.delegating.featureId,\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid usersDialog.show({\n\t\t\t\ttargetNode: this.$refs.button,\n\t\t\t\tids: this.task.responsibleIds,\n\t\t\t\tisMultiple: false,\n\t\t\t\tonClose: this.handleClose,\n\t\t\t});\n\t\t},\n\t\tgetDeleteItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.remove)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdesign: MenuItemDesign.Alert,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_DELETE'),\n\t\t\t\ticon: Outline.TRASHCAN,\n\t\t\t\tonClick: (): void => {\n\t\t\t\t\tvoid taskService.delete(this.taskId);\n\t\t\t\t\tEventEmitter.emit(EventName.CloseFullCard, { taskId: this.taskId });\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tasync waitStatus(statusPromise: Promise): Promise<void>\n\t\t{\n\t\t\tthis.loading = true;\n\t\t\tawait statusPromise;\n\t\t\tthis.loading = false;\n\t\t},\n\t\tgetCreateSubtaskForTemplate(): MenuItemOptions | null\n\t\t{\n\t\t\tif (!this.settings.rights.templates.create)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst isLocked = !this.settings.restrictions.templatesSubtasks.available;\n\n\t\t\treturn {\n\t\t\t\tisLocked,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_TEMPLATE_CREATE_SUBTASK'),\n\t\t\t\ticon: Outline.RELATED_TASKS,\n\t\t\t\tonClick: (): void => {\n\t\t\t\t\tif (isLocked)\n\t\t\t\t\t{\n\t\t\t\t\t\tvoid showLimit({\n\t\t\t\t\t\t\tfeatureId: this.settings.restrictions.templatesSubtasks.featureId,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tTaskCard.showCompactCard({\n\t\t\t\t\t\ttaskId: 'template0',\n\t\t\t\t\t\tgroupId: this.task.groupId,\n\t\t\t\t\t\tparentId: this.taskId,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetCopyTemplate(): MenuItemOptions | null\n\t\t{\n\t\t\tif (!this.settings.rights.templates.create)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_TEMPLATE_COPY'),\n\t\t\t\ticon: Outline.COPY,\n\t\t\t\tonClick: (): void => TaskCard.showFullCard({ taskId: 'template0', copiedFromId: idUtils.unbox(this.taskId) }),\n\t\t\t};\n\t\t},\n\t\tgetDeleteTemplate(): MenuItemOptions | null\n\t\t{\n\t\t\tif (!this.task.rights.remove)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdesign: MenuItemDesign.Alert,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_TEMPLATE_DELETE'),\n\t\t\t\ticon: Outline.TRASHCAN,\n\t\t\t\tonClick: async (): Promise<void> => {\n\t\t\t\t\tawait templateService.delete(this.taskId);\n\t\t\t\t\tEventEmitter.emit(EventName.CloseFullCard, {\n\t\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div ref=\"button\">\n\t\t\t<UiButton\n\t\t\t\tv-if=\"menuItems.length > 0\"\n\t\t\t\t:size=\"ButtonSize.LARGE\"\n\t\t\t\t:style=\"AirButtonStyle.PLAIN\"\n\t\t\t\t:leftIcon=\"Outline.MORE_L\"\n\t\t\t\t:loading\n\t\t\t\t:dataset=\"{ taskButtonId: 'more' }\"\n\t\t\t\tref=\"button\"\n\t\t\t\t@click=\"handleClick\"\n\t\t\t/>\n\t\t</div>\n\t\t<BMenu v-if=\"isMenuShown\" :options=\"menuOptions()\" @close=\"isMenuShown = false\"/>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { BitrixVue } from 'ui.vue3';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { BLine } from 'ui.system.skeleton.vue';\nimport { Button as UiButton, AirButtonStyle, ButtonSize, ButtonIcon } from 'ui.vue3.components.button';\nimport { TextMd, TextXs } from 'ui.system.typography.vue';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport { TaskCard } from 'tasks.v2.application.task-card';\nimport { GroupType, Model, Option, TaskStatus, Mark, EventName, Analytics } from 'tasks.v2.const';\nimport { Hint } from 'tasks.v2.component.elements.hint';\nimport { ahaMoments } from 'tasks.v2.lib.aha-moments';\nimport { idUtils } from 'tasks.v2.lib.id-utils';\nimport { statusService } from 'tasks.v2.provider.service.status-service';\nimport { MarkTaskButton } from 'tasks.v2.component.mark-task-button';\nimport type { GroupModel } from 'tasks.v2.model.groups';\nimport type { TaskModel, TimerModel } from 'tasks.v2.model.tasks';\n\n// eslint-disable-next-line import/namespace\nimport { More } from './more/more';\nimport { ButtonId } from './footer-edit-const';\n\nimport './footer-edit.css';\n\nexport type ButtonOptions = {\n\tid: string,\n\ttext: string,\n\tcolor: string,\n\tdisabled: boolean,\n\tonClick: Function,\n\ticon?: ?string,\n};\n\n// @vue/component\nexport const FooterEdit = {\n\tcomponents: {\n\t\tHint,\n\t\tUiButton,\n\t\tBIcon,\n\t\tMore,\n\t\tTextMd,\n\t\tTextXs,\n\t\tMarkTaskButton,\n\t\tTemplatePermissionsButton: BitrixVue.defineAsyncComponent(\n\t\t\t'tasks.v2.component.template-permissions-button',\n\t\t\t'TemplatePermissionsButton',\n\t\t\t{\n\t\t\t\tdelay: 0,\n\t\t\t\tloadingComponent: {\n\t\t\t\t\tcomponents: { BLine },\n\t\t\t\t\ttemplate: '<BLine :width=\"131\" :height=\"22\"/>',\n\t\t\t\t},\n\t\t\t},\n\t\t),\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t\tisTemplate: {},\n\t\tsettings: {},\n\t\tanalytics: {},\n\t},\n\tsetup(): { task: TaskModel, Outline: typeof Outline }\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t\tButtonSize,\n\t\t\tButtonIcon,\n\t\t\tOutline,\n\t\t\tTaskStatus,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tloading: false,\n\t\t\tshowStartTimeTrackingHint: false,\n\t\t\tcomputedSecondaryButton: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tcurrentUserId: `${Model.Interface}/currentUserId`,\n\t\t}),\n\t\ttimer(): ?TimerModel\n\t\t{\n\t\t\treturn this.task.timers?.find((timer: TimerModel) => timer.userId === this.currentUserId);\n\t\t},\n\t\tgroup(): ?GroupModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Groups}/getById`](this.task.groupId);\n\t\t},\n\t\tisScrum(): boolean\n\t\t{\n\t\t\treturn this.group?.type === GroupType.Scrum;\n\t\t},\n\t\tisCreator(): boolean\n\t\t{\n\t\t\treturn this.currentUserId === this.task.creatorId;\n\t\t},\n\t\tprimaryButton(): ButtonOptions | null\n\t\t{\n\t\t\tconst inProgress = (this.task.rights.timeTracking)\n\t\t\t\t? [\n\t\t\t\t\tthis.getStartTimerButton(),\n\t\t\t\t\tthis.getPauseButton(AirButtonStyle.OUTLINE),\n\t\t\t\t]\n\t\t\t\t: [this.getCompleteButton()];\n\n\t\t\tconst statuses = {\n\t\t\t\t[TaskStatus.Pending]: [\n\t\t\t\t\tthis.getTakeButton(),\n\t\t\t\t\tthis.getStartTimerButton(),\n\t\t\t\t\tthis.getPauseButton(AirButtonStyle.OUTLINE),\n\t\t\t\t\tthis.getStartButton(),\n\t\t\t\t\tthis.getCompleteButton(),\n\t\t\t\t],\n\t\t\t\t[TaskStatus.InProgress]: inProgress,\n\t\t\t\t[TaskStatus.Deferred]: this.getRenewButton(),\n\t\t\t\t[TaskStatus.SupposedlyCompleted]: [\n\t\t\t\t\tthis.getApproveButton(),\n\t\t\t\t\tthis.getReviewButton(),\n\t\t\t\t],\n\t\t\t\t[TaskStatus.Completed]: this.getRenewButton(AirButtonStyle.PLAIN),\n\t\t\t};\n\n\t\t\tif (Type.isArray(statuses[this.task.status]))\n\t\t\t{\n\t\t\t\treturn statuses[this.task.status].find((item) => item !== null);\n\t\t\t}\n\n\t\t\treturn statuses[this.task.status] || null;\n\t\t},\n\t\tsecondaryButton(): ButtonOptions | null\n\t\t{\n\t\t\treturn this.computedSecondaryButton;\n\t\t},\n\t\tselectedButtons(): ButtonOptions[]\n\t\t{\n\t\t\treturn [this.primaryButton, this.secondaryButton];\n\t\t},\n\t\tshouldShowStartTimeTrackingHint(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.showStartTimeTrackingHint\n\t\t\t\t&& this.primaryButton?.id === ButtonId.Start\n\t\t\t);\n\t\t},\n\t\tshouldShowMarkTaskButton(): boolean\n\t\t{\n\t\t\treturn this.task.rights.mark || (this.task.mark !== Mark.None);\n\t\t},\n\t\tshowFooter(): boolean\n\t\t{\n\t\t\tif (this.isTemplate)\n\t\t\t{\n\t\t\t\treturn this.settings.rights.tasks.createFromTemplate || this.task.rights.edit;\n\t\t\t}\n\n\t\t\treturn Boolean(\n\t\t\t\tthis.primaryButton\n\t\t\t\t|| this.secondaryButton\n\t\t\t\t|| this.shouldShowMarkTaskButton,\n\t\t\t);\n\t\t},\n\t},\n\twatch: {\n\t\tprimaryButton: {\n\t\t\thandler: 'updateSecondaryButton',\n\t\t\timmediate: true,\n\t\t},\n\t\t'task.status': {\n\t\t\thandler: 'updateSecondaryButton',\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.$bitrix.eventEmitter.subscribe(EventName.TimeTrackingChange, this.handleTimeTrackingActivating);\n\t},\n\tmethods: {\n\t\tgetStartButton(): ?ButtonOptions\n\t\t{\n\t\t\tif (!this.task.rights.start || this.timer)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tid: ButtonId.Start,\n\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_START'),\n\t\t\t\tonClick: (): void => this.waitStatus(statusService.start(this.taskId)),\n\t\t\t};\n\t\t},\n\t\tgetTakeButton(): ?ButtonOptions\n\t\t{\n\t\t\tif (!this.task.rights.take || this.task.status !== TaskStatus.Pending)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tid: ButtonId.Take,\n\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_TAKE'),\n\t\t\t\tonClick: (): void => this.waitStatus(statusService.take(this.taskId)),\n\t\t\t};\n\t\t},\n\t\tgetStartTimerButton(): ?ButtonOptions\n\t\t{\n\t\t\tif (!this.task.rights.timeTracking || this.timer)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tid: ButtonId.Start,\n\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_START'),\n\t\t\t\tonClick: (): void => this.waitStatus(statusService.startTimer(this.taskId)),\n\t\t\t\ticon: ButtonIcon.START,\n\t\t\t};\n\t\t},\n\t\tgetCompleteButton(style: string): ?ButtonOptions\n\t\t{\n\t\t\tif (!this.task.rights.complete)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tid: ButtonId.Complete,\n\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_COMPLETE'),\n\t\t\t\tstyle,\n\t\t\t\tonClick: (): void => this.waitStatus(statusService.complete(\n\t\t\t\t\tthis.taskId,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontext: this.analytics?.context ?? Analytics.Section.Tasks,\n\t\t\t\t\t\tadditionalContext: this.analytics?.additionalContext ?? Analytics.SubSection.TaskCard,\n\t\t\t\t\t\telement: Analytics.Element.ContextMenu,\n\t\t\t\t\t},\n\t\t\t\t)),\n\t\t\t};\n\t\t},\n\t\tgetPauseButton(style: string): ?ButtonOptions\n\t\t{\n\t\t\tif (!this.task.rights.timeTracking || !this.timer)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tid: ButtonId.Pause,\n\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_PAUSE_TIMER'),\n\t\t\t\tstyle,\n\t\t\t\tonClick: (): void => this.waitStatus(statusService.pauseTimer(this.taskId)),\n\t\t\t};\n\t\t},\n\t\tgetRenewButton(style: string): ?ButtonOptions\n\t\t{\n\t\t\tif (!this.task.rights.renew)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tid: ButtonId.Renew,\n\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_RENEW'),\n\t\t\t\tstyle,\n\t\t\t\tonClick: (): void => this.waitStatus(statusService.renew(this.taskId)),\n\t\t\t};\n\t\t},\n\t\tgetReviewButton(): ButtonOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: ButtonId.Review,\n\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_ON_REVIEW_MSGVER_1'),\n\t\t\t\tdisabled: true,\n\t\t\t};\n\t\t},\n\t\tgetApproveButton(): ButtonOptions\n\t\t{\n\t\t\tif (!this.task.rights.approve)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tid: ButtonId.Approve,\n\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_APPROVE'),\n\t\t\t\tonClick: (): void => this.waitStatus(statusService.approve(this.taskId)),\n\t\t\t};\n\t\t},\n\t\tupdateSecondaryButton(): void\n\t\t{\n\t\t\tvoid this.$nextTick(() => {\n\t\t\t\tconst inProgress = this.task.rights.timeTracking\n\t\t\t\t\t? this.getCompleteButton(this.timer ? '' : AirButtonStyle.OUTLINE)\n\t\t\t\t\t: null;\n\n\t\t\t\tconst statuses = {\n\t\t\t\t\t[TaskStatus.Pending]: this.getCompleteButton(AirButtonStyle.OUTLINE),\n\t\t\t\t\t[TaskStatus.InProgress]: inProgress,\n\t\t\t\t};\n\n\t\t\t\tlet secondary = statuses[this.task.status] || null;\n\n\t\t\t\tif (secondary && this.primaryButton && secondary.id === this.primaryButton.id)\n\t\t\t\t{\n\t\t\t\t\tsecondary = null;\n\t\t\t\t}\n\n\t\t\t\tthis.computedSecondaryButton = secondary;\n\t\t\t});\n\t\t},\n\t\thandleOverPrimaryButton(): void\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.task.rights.timeTracking\n\t\t\t\t&& this.primaryButton?.id === ButtonId.Start\n\t\t\t\t&& ahaMoments.shouldShow(Option.AhaStartTimeTracking)\n\t\t\t)\n\t\t\t{\n\t\t\t\tahaMoments.setActive(Option.AhaStartTimeTracking);\n\t\t\t\tthis.showStartTimeTrackingHint = true;\n\t\t\t}\n\t\t},\n\t\thandleTimeTrackingActivating(): void\n\t\t{\n\t\t\tvoid this.waitStatus(new Promise((resolve) => {\n\t\t\t\tconst unwatch = this.$watch(\n\t\t\t\t\t() => this.task.rights.timeTracking,\n\t\t\t\t\tasync () => {\n\t\t\t\t\t\tawait this.$nextTick();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t},\n\t\t\t\t\t{ immediate: false },\n\t\t\t\t);\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tunwatch();\n\t\t\t\t\tresolve();\n\t\t\t\t}, 5000);\n\t\t\t}));\n\t\t},\n\t\thideStartTimeTrackingHint(): void\n\t\t{\n\t\t\tthis.showStartTimeTrackingHint = false;\n\t\t},\n\t\thidePermanentStartTimeTrackingHint(): void\n\t\t{\n\t\t\tthis.hideStartTimeTrackingHint();\n\n\t\t\tahaMoments.setInactive(Option.AhaStartTimeTracking);\n\t\t\tahaMoments.setShown(Option.AhaStartTimeTracking);\n\t\t},\n\t\tasync waitStatus(statusPromise: Promise): Promise<void>\n\t\t{\n\t\t\tthis.loading = true;\n\t\t\tawait statusPromise;\n\t\t\tthis.loading = false;\n\t\t},\n\t\tcreateTaskFromTemplate(): void\n\t\t{\n\t\t\tTaskCard.showFullCard({\n\t\t\t\ttemplateId: idUtils.unbox(this.taskId),\n\t\t\t\tanalytics: {\n\t\t\t\t\tcontext: Analytics.Section.Templates,\n\t\t\t\t\tadditionalContext: Analytics.SubSection.TemplatesCard,\n\t\t\t\t\telement: Analytics.Element.CreateButton,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"showFooter\" class=\"tasks-full-card-footer\">\n\t\t\t<div class=\"tasks-full-card-footer-edit\">\n\t\t\t\t<UiButton\n\t\t\t\t\tv-if=\"isTemplate && settings.rights.tasks.createFromTemplate\"\n\t\t\t\t\t:text=\"loc('TASKS_V2_TASK_TEMPLATE_CREATE_TASK')\"\n\t\t\t\t\t:size=\"ButtonSize.LARGE\"\n\t\t\t\t\t:dataset=\"{ taskButtonId: 'createFromTemplate' }\"\n\t\t\t\t\t:leftIcon=\"Outline.PLUS_L\"\n\t\t\t\t\t@click=\"createTaskFromTemplate\"\n\t\t\t\t/>\n\t\t\t\t<template v-if=\"!isTemplate\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"primaryButton\"\n\t\t\t\t\t\tref=\"primaryButton\"\n\t\t\t\t\t\t@mouseover=\"handleOverPrimaryButton\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<UiButton\n\t\t\t\t\t\t\t:text=\"primaryButton.text\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.LARGE\"\n\t\t\t\t\t\t\t:style=\"primaryButton.style ?? AirButtonStyle.FILLED\"\n\t\t\t\t\t\t\t:disabled=\"Boolean(primaryButton.disabled)\"\n\t\t\t\t\t\t\t:loading\n\t\t\t\t\t\t\t:leftIcon=\"primaryButton.icon\"\n\t\t\t\t\t\t\t:dataset=\"{ taskButtonId: 'status' }\"\n\t\t\t\t\t\t\t@click=\"primaryButton.onClick\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<UiButton\n\t\t\t\t\t\tv-if=\"secondaryButton && !loading\"\n\t\t\t\t\t\t:text=\"secondaryButton.text\"\n\t\t\t\t\t\t:size=\"ButtonSize.LARGE\"\n\t\t\t\t\t\t:style=\"secondaryButton.style ?? AirButtonStyle.FILLED\"\n\t\t\t\t\t\t:disabled=\"secondaryButton.disabled ?? false\"\n\t\t\t\t\t\t:dataset=\"{ taskButtonId: 'secondary' }\"\n\t\t\t\t\t\t@click=\"secondaryButton.onClick\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t\t<More :selectedButtons/>\n\t\t\t\t<div class=\"tasks-full-card-footer-edit-grow\"/>\n\t\t\t\t<MarkTaskButton v-if=\"!isTemplate && shouldShowMarkTaskButton\"/>\n\t\t\t\t<TemplatePermissionsButton v-if=\"isTemplate && task.rights.edit\"/>\n\t\t\t</div>\n\t\t\t<Hint\n\t\t\t\tv-if=\"shouldShowStartTimeTrackingHint\"\n\t\t\t\t:bindElement=\"$refs.primaryButton\"\n\t\t\t\t:options=\"{\n\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\toffsetLeft: 24,\n\t\t\t\t\tminWidth: 344,\n\t\t\t\t\tmaxWidth: 344,\n\t\t\t\t}\"\n\t\t\t\t@close=\"hideStartTimeTrackingHint\"\n\t\t\t>\n\t\t\t\t<div class=\"tasks-full-card-start-time-tracking-hint\">\n\t\t\t\t\t<TextMd class=\"tasks-full-card-start-time-tracking-hint-info-text\">\n\t\t\t\t\t\t{{ loc('TASKS_V2_TASK_FULL_CARD_AHA_START_TIME_TRACKING_HINT_TEXT') }}\n\t\t\t\t\t</TextMd>\n\t\t\t\t\t<TextXs\n\t\t\t\t\t\tclass=\"tasks-full-card-start-time-tracking-hint-info-link\"\n\t\t\t\t\t\t@click.stop=\"hidePermanentStartTimeTrackingHint\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ loc('TASKS_V2_TASK_FULL_CARD_AHA_START_TIME_TRACKING_HINT_MORE') }}\n\t\t\t\t\t</TextXs>\n\t\t\t\t</div>\n\t\t\t</Hint>\n\t\t</div>\n\t`,\n};\n","import { Button as UiButton, AirButtonStyle, ButtonSize } from 'ui.vue3.components.button';\n\nimport './placeholder.css';\n\n// @vue/component\nexport const Placeholder = {\n\tcomponents: {\n\t\tUiButton,\n\t},\n\tprops: {\n\t\timgSrc: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\thead: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tdescr: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\taction: {\n\t\t\ttype: Object,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t\tAirButtonStyle,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {};\n\t},\n\tcomputed: {},\n\tmethods: {},\n\ttemplate: `\n\t\t<div class=\"tasks-full-card-placeholder\">\n\t\t\t<div class=\"tasks-full-card-placeholder__content\">\n\t\t\t\t<div v-if=\"imgSrc\" class=\"tasks-full-card-placeholder__img-container\">\n\t\t\t\t\t<img :src=\"imgSrc\" alt=\"noAccess\" class=\"tasks-full-card-placeholder__img\"/>\n\t\t\t\t</div>\n\t\t\t\t<h3 v-if=\"head\" class=\"tasks-full-card-placeholder__head\">{{ head }}</h3>\n\t\t\t\t<p v-if=\"descr\" class=\"tasks-full-card-placeholder__descr\">{{ descr }}</p>\n\t\t\t\t<div class=\"tasks-full-card-placeholder__action-container\">\n\t\t\t\t\t<UiButton\n\t\t\t\t\t\tv-if=\"action\"\n\t\t\t\t\t\tclass=\"tasks-full-card-placeholder__action\"\n\t\t\t\t\t\t:text=\"action.text\"\n\t\t\t\t\t\t:size=\"ButtonSize.MEDIUM\"\n\t\t\t\t\t\t:style=\"AirButtonStyle.FILLED\"\n\t\t\t\t\t\t:disabled=\"action.disabled\"\n\t\t\t\t\t\t:loading=\"action.isLoading\"\n\t\t\t\t\t\t@click=\"action.click\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Reflection, Runtime, Loc } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport { Notifier } from 'ui.notification-manager';\nimport { renderSkeleton } from 'ui.system.skeleton';\nimport { BLine } from 'ui.system.skeleton.vue';\nimport { BitrixVue, computed } from 'ui.vue3';\nimport { mapActions, mapGetters } from 'ui.vue3.vuex';\n\nimport { analytics } from 'tasks.v2.lib.analytics';\nimport { Core } from 'tasks.v2.core';\nimport { idUtils } from 'tasks.v2.lib.id-utils';\nimport { ahaMoments } from 'tasks.v2.lib.aha-moments';\nimport { CardType, EventName, Model, TaskField, Option, GroupType, Analytics } from 'tasks.v2.const';\nimport { FieldList } from 'tasks.v2.component.elements.field-list';\nimport { ContentResizer } from 'tasks.v2.component.elements.content-resizer';\nimport { DropZone } from 'tasks.v2.component.drop-zone';\nimport { entityTextEditor, EntityTextTypes } from 'tasks.v2.component.entity-text';\nimport { userFieldsSlider } from 'tasks.v2.component.user-fields-slider';\n\nimport { DescriptionField } from 'tasks.v2.component.fields.description';\nimport { Creator, creatorMeta } from 'tasks.v2.component.fields.creator';\nimport { Responsible, responsibleMeta } from 'tasks.v2.component.fields.responsible';\nimport { Deadline, deadlineMeta } from 'tasks.v2.component.fields.deadline';\nimport { Status, statusMeta } from 'tasks.v2.component.fields.status';\nimport { Files, FilesChip } from 'tasks.v2.component.fields.files';\nimport { CheckList, CheckListChip } from 'tasks.v2.component.fields.check-list';\nimport { Group, Stage, Epic, StoryPoints, GroupChip, groupMeta } from 'tasks.v2.component.fields.group';\nimport { Flow, FlowChip, flowMeta } from 'tasks.v2.component.fields.flow';\nimport { Accomplices, AccomplicesChip, accomplicesMeta } from 'tasks.v2.component.fields.accomplices';\nimport { Auditors, AuditorsChip, auditorsMeta } from 'tasks.v2.component.fields.auditors';\nimport { Tags, TagsChip, tagsMeta } from 'tasks.v2.component.fields.tags';\nimport { Crm, CrmChip, crmMeta } from 'tasks.v2.component.fields.crm';\nimport { DatePlan, DatePlanChip } from 'tasks.v2.component.fields.date-plan';\nimport { TimeTracking, TimeTrackingChip, timeTrackingMeta } from 'tasks.v2.component.fields.time-tracking';\nimport { SubTasks, SubTasksChip } from 'tasks.v2.component.fields.sub-tasks';\nimport { ParentTask, ParentTaskChip } from 'tasks.v2.component.fields.parent-task';\nimport { RelatedTasks, RelatedTasksChip } from 'tasks.v2.component.fields.related-tasks';\nimport { Gantt, GanttChip, ganttMeta } from 'tasks.v2.component.fields.gantt';\nimport { Results, ResultsChip } from 'tasks.v2.component.fields.results';\nimport { Reminders, RemindersChip } from 'tasks.v2.component.fields.reminders';\nimport { Replication, ReplicationChip } from 'tasks.v2.component.fields.replication';\nimport { Email, EmailFrom, EmailDate, EmailChip, emailMeta } from 'tasks.v2.component.fields.email';\nimport { UserFields, UserFieldsChip, userFieldsManager } from 'tasks.v2.component.fields.user-fields';\nimport { Placements, PlacementsChip } from 'tasks.v2.component.fields.placements';\nimport { CreatedDate, createdDateMeta } from 'tasks.v2.component.fields.created-date';\n\nimport { fileService, EntityTypes } from 'tasks.v2.provider.service.file-service';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { templateService } from 'tasks.v2.provider.service.template-service';\nimport { deadlineService } from 'tasks.v2.provider.service.deadline-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { GroupModel } from 'tasks.v2.model.groups';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\nimport type { SheetBindProps } from 'tasks.v2.component.elements.bottom-sheet';\nimport type { AppField, AppChip } from 'tasks.v2.application.task-card';\nimport type { UserFieldScheme } from 'tasks.v2.model.interface';\n\nimport { TaskHeader } from './task-header/task-header';\nimport { TaskSettingsHint } from './aha/task-settings-hint';\nimport { Chat } from './chat/chat';\nimport { Chips } from './chips/chips';\nimport { FooterCreate } from './footer-create/footer-create';\nimport { FooterEdit } from './footer-edit/footer-edit';\nimport { Placeholder } from './placeholder/placeholder';\nimport './app.css';\n\nconst UserOptions = Reflection.namespace('BX.userOptions');\n\n// @vue/component\nexport const App = {\n\tname: 'TaskFullCard',\n\tcomponents: {\n\t\tTaskHeader,\n\t\tDescriptionField,\n\t\tFiles,\n\t\tCheckList,\n\t\tDatePlan,\n\t\tSubTasks,\n\t\tParentTask,\n\t\tRelatedTasks,\n\t\tGantt,\n\t\tResults,\n\t\tPlacements,\n\t\tReminders,\n\t\tReplication,\n\t\tFieldList,\n\t\tChat,\n\t\tFooterCreate,\n\t\tFooterEdit,\n\t\tPlaceholder,\n\t\tDropZone,\n\t\tChips,\n\t\tContentResizer,\n\t\tTaskSettingsHint,\n\t\tEmail,\n\t\tEmailFrom,\n\t\tEmailDate,\n\t\tUserFields,\n\t\tCreatedDate,\n\t},\n\tprovide(): Object\n\t{\n\t\treturn {\n\t\t\tanalytics: this.analytics,\n\t\t\tcardType: CardType.Full,\n\t\t\tsettings: Core.getParams(),\n\t\t\t/** @type { TaskModel } */\n\t\t\ttask: computed((): TaskModel => taskService.getStoreTask(this.taskId)),\n\t\t\t/** @type { number | string } */\n\t\t\ttaskId: computed((): number | string => this.taskId),\n\t\t\t/** @type { boolean } */\n\t\t\tisEdit: computed((): boolean => idUtils.isReal(this.taskId)),\n\t\t\t/** @type { boolean } */\n\t\t\tisTemplate: computed((): boolean => idUtils.isTemplate(this.taskId)),\n\t\t};\n\t},\n\tprops: {\n\t\tid: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tinitialTask: {\n\t\t\t/** @type TaskModel */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tanalytics: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tEntityTextTypes,\n\t\t\tEntityTypes,\n\t\t\tTaskField,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\ttaskId: this.id,\n\t\t\tisFilesSheetShown: false,\n\t\t\tisDescriptionSheetShown: false,\n\t\t\tisCheckListSheetShown: false,\n\t\t\tisDatePlanSheetShown: false,\n\t\t\tisTimeTrackingSheetShown: false,\n\t\t\tisTimeTrackingChipSheetShown: false,\n\t\t\tisResultListSheetShown: false,\n\t\t\tisResultEditorSheetShown: false,\n\t\t\tisResultChipSheetShown: false,\n\t\t\tisReminderSheetShown: false,\n\t\t\tisRemindersSheetShown: false,\n\t\t\tisReplicationSheetShown: false,\n\t\t\tisReplicationHistorySheetShown: false,\n\t\t\tisPrimaryFieldsHovered: false,\n\t\t\tisSettingsPopupShown: false,\n\t\t\tisTaskSettingsHintShown: false,\n\t\t\tcheckListId: 0,\n\t\t\tfiles: fileService.get(this.id).getFiles(),\n\t\t\tisLoading: true,\n\t\t\tcreationError: false,\n\t\t\ttaskInitial: null,\n\t\t\tplaceholderImgUrl: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tdefaultDeadlineTs: `${Model.Interface}/defaultDeadlineTs`,\n\t\t\tfullCardWidth: `${Model.Interface}/fullCardWidth`,\n\t\t\tstateFlags: `${Model.Interface}/stateFlags`,\n\t\t\ttaskUserFieldScheme: `${Model.Interface}/taskUserFieldScheme`,\n\t\t\ttemplateUserFieldScheme: `${Model.Interface}/templateUserFieldScheme`,\n\t\t}),\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn taskService.getStoreTask(this.taskId);\n\t\t},\n\t\tgroup(): GroupModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Groups}/getById`](this.task.groupId);\n\t\t},\n\t\tchecklist(): CheckListModel[]\n\t\t{\n\t\t\tif (!this.task.checklist)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist);\n\t\t},\n\t\tisEdit(): boolean\n\t\t{\n\t\t\treturn idUtils.isReal(this.taskId);\n\t\t},\n\t\tisTemplate(): boolean\n\t\t{\n\t\t\treturn idUtils.isTemplate(this.taskId);\n\t\t},\n\t\tisCreator(): boolean\n\t\t{\n\t\t\treturn this.currentUserId === this.task.creatorId;\n\t\t},\n\t\tisAdmin(): boolean\n\t\t{\n\t\t\treturn Core.getParams().rights.user.admin;\n\t\t},\n\t\tisFlowFilledOnAdd(): boolean\n\t\t{\n\t\t\treturn this.task.flowId > 0 && !this.isEdit;\n\t\t},\n\t\tcanChangeDeadline(): boolean\n\t\t{\n\t\t\tif (!this.isEdit)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\tthis.task.rights.deadline\n\t\t\t\t&& !this.isFlowFilledOnAdd\n\t\t\t);\n\t\t},\n\t\tcanChangeDeadlineWithoutLimitation(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\t!this.isEdit\n\t\t\t\t|| this.isCreator\n\t\t\t\t|| this.task.rights.edit\n\t\t\t\t|| this.isAdmin\n\t\t\t);\n\t\t},\n\t\tisPartiallyLoaded(): boolean\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/isPartiallyLoaded`](this.taskId);\n\t\t},\n\t\tuserFieldScheme(): UserFieldScheme[]\n\t\t{\n\t\t\treturn this.isTemplate\n\t\t\t\t? this.templateUserFieldScheme\n\t\t\t\t: this.taskUserFieldScheme\n\t\t\t;\n\t\t},\n\t\tdefaultRequireResult(): boolean\n\t\t{\n\t\t\treturn this.isTemplate ? false : (this.stateFlags.defaultRequireResult ?? false);\n\t\t},\n\t\t// eslint-disable-next-line max-lines-per-function,sonarjs/cognitive-complexity\n\t\tfields(): AppField[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\ttitle: creatorMeta.title,\n\t\t\t\t\tcomponent: Creator,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: responsibleMeta.getTitle(!this.task.isForNewUser && this.task.responsibleIds.length > 1),\n\t\t\t\t\tcomponent: Responsible,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: deadlineMeta.title,\n\t\t\t\t\tcomponent: Deadline,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t\t\tisTemplate: this.isTemplate,\n\t\t\t\t\t\tisHovered: this.isPrimaryFieldsHovered || this.isTaskSettingsHintShown,\n\t\t\t\t\t},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tisSettingsPopupShown: (value) => {\n\t\t\t\t\t\t\tthis.isSettingsPopupShown = value;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: timeTrackingMeta.title,\n\t\t\t\t\tcomponent: TimeTracking,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tisSheetShown: this.isTimeTrackingSheetShown,\n\t\t\t\t\t\tsheetBindProps: this.sheetBindProps,\n\t\t\t\t\t},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'update:isSheetShown': (isShown: boolean): void => {\n\t\t\t\t\t\t\tthis.isTimeTrackingSheetShown = isShown;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t!this.isTemplate && {\n\t\t\t\t\ttitle: statusMeta.title,\n\t\t\t\t\tcomponent: Status,\n\t\t\t\t\twithSeparator: true,\n\t\t\t\t},\n\t\t\t\t!this.isTemplate && {\n\t\t\t\t\ttitle: createdDateMeta.title,\n\t\t\t\t\tcomponent: CreatedDate,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: emailMeta.title,\n\t\t\t\t\tcomponent: Email,\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: EmailChip,\n\t\t\t\t\t\tisEnabled: this.wasFilled(TaskField.Email),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: emailMeta.fromTitle,\n\t\t\t\t\tcomponent: EmailFrom,\n\t\t\t\t\twithSeparator: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: emailMeta.dateTitle,\n\t\t\t\t\tcomponent: EmailDate,\n\t\t\t\t},\n\t\t\t\t!this.isTemplate && {\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: ResultsChip,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tisSheetShown: this.isResultChipSheetShown,\n\t\t\t\t\t\t\tsheetBindProps: this.sheetBindProps,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t'update:isSheetShown': (isShown: boolean): void => {\n\t\t\t\t\t\t\t\tthis.isResultChipSheetShown = isShown;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tCore.getParams().features.disk && {\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: FilesChip,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tisEnabled:\n\t\t\t\t\t\t\tthis.wasFilled(TaskField.Files)\n\t\t\t\t\t\t\t|| this.files.length > 0\n\t\t\t\t\t\t\t|| this.task.rights.attachFile\n\t\t\t\t\t\t\t|| this.task.rights.edit,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: BitrixVue.defineAsyncComponent(\n\t\t\t\t\t\t\t'tasks.v2.component.fields.comment-files',\n\t\t\t\t\t\t\t'CommentFilesChip',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdelay: 0,\n\t\t\t\t\t\t\t\tloadingComponent: {\n\t\t\t\t\t\t\t\t\tcomponents: { BLine },\n\t\t\t\t\t\t\t\t\ttemplate: '<BLine :width=\"212\" :height=\"32\"/>',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t),\n\t\t\t\t\t\tisEnabled: this.task.containsCommentFiles === true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: CheckListChip,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tshowCheckList: this.openCheckList,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tisEnabled: this.task.rights.checklistSave,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tCore.getParams().features.isProjectsEnabled && {\n\t\t\t\t\ttitle: groupMeta.getTitle(this.task.groupId),\n\t\t\t\t\tcomponent: Group,\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: GroupChip,\n\t\t\t\t\t\tisEnabled: this.wasFilled(TaskField.Group) || this.task.rights.edit,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: accomplicesMeta.title,\n\t\t\t\t\tcomponent: Accomplices,\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: AccomplicesChip,\n\t\t\t\t\t\tisEnabled: this.wasFilled(TaskField.Accomplices) || this.task.rights.changeAccomplices,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: auditorsMeta.title,\n\t\t\t\t\tcomponent: Auditors,\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: AuditorsChip,\n\t\t\t\t\t\tisEnabled: this.wasFilled(TaskField.Auditors) || this.task.rights.addAuditors,\n\t\t\t\t\t},\n\t\t\t\t\twithSeparator: this.wasFilled(TaskField.Accomplices),\n\t\t\t\t},\n\t\t\t\t!this.isTemplate && {\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: PlacementsChip,\n\t\t\t\t\t\tisEnabled: this.isEdit && this.wasFilled(TaskField.Placements),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t!this.isTemplate && Core.getParams().features.isFlowEnabled && {\n\t\t\t\t\ttitle: flowMeta.title,\n\t\t\t\t\tcomponent: Flow,\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: FlowChip,\n\t\t\t\t\t\tisEnabled: this.wasFilled(TaskField.Flow) || this.task.rights.edit,\n\t\t\t\t\t},\n\t\t\t\t\twithSeparator: true,\n\t\t\t\t},\n\t\t\t\tCore.getParams().features.isProjectsEnabled && {\n\t\t\t\t\ttitle: groupMeta.stageTitle,\n\t\t\t\t\tcomponent: Stage,\n\t\t\t\t},\n\t\t\t\tCore.getParams().features.isProjectsEnabled && {\n\t\t\t\t\ttitle: groupMeta.epicTitle,\n\t\t\t\t\tcomponent: Epic,\n\t\t\t\t},\n\t\t\t\tCore.getParams().features.isProjectsEnabled && {\n\t\t\t\t\ttitle: groupMeta.storyPointsTitle,\n\t\t\t\t\tcomponent: StoryPoints,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: tagsMeta.title,\n\t\t\t\t\tcomponent: Tags,\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: TagsChip,\n\t\t\t\t\t\tisEnabled: this.wasFilled(TaskField.Tags) || this.task.rights.edit,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t!this.isTemplate && {\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: RemindersChip,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tisSheetShown: this.isReminderSheetShown,\n\t\t\t\t\t\t\tsheetBindProps: this.sheetBindProps,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t'update:isSheetShown': (isShown: boolean): void => {\n\t\t\t\t\t\t\t\tthis.isReminderSheetShown = isShown;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\tisEnabled: this.wasFilled(TaskField.Reminders) || this.task.rights.reminder,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tCore.getParams().features.crm && {\n\t\t\t\t\ttitle: crmMeta.title,\n\t\t\t\t\tcomponent: Crm,\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: CrmChip,\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t\tisEnabled: this.wasFilled(TaskField.Crm) || this.task.rights.edit,\n\t\t\t\t\t},\n\t\t\t\t\twithSeparator: this.wasFilled(TaskField.Group) || this.wasFilled(TaskField.Flow),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: ParentTaskChip,\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t\tisEnabled: this.wasFilled(TaskField.Parent) || this.task.rights.edit,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: SubTasksChip,\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t\tisEnabled: this.wasFilled(TaskField.SubTasks) || this.task.rights.createSubtask || !this.isEdit,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: RelatedTasksChip,\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t\tisEnabled: this.wasFilled(TaskField.RelatedTasks) || this.task.rights.edit,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t!this.isTemplate && {\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: GanttChip,\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t\tisEnabled: this.wasFilled(TaskField.Gantt) || this.task.rights[ganttMeta.right],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: DatePlanChip,\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t\tisEnabled: this.wasFilled(TaskField.DatePlan) || this.task.rights.edit,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tisSheetShown: this.isDatePlanSheetShown,\n\t\t\t\t\t\t\tsheetBindProps: this.sheetBindProps,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t'update:isSheetShown': (isShown: boolean): void => {\n\t\t\t\t\t\t\t\tthis.isDatePlanSheetShown = isShown;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tthis.isTemplate && {\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: ReplicationChip,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tisSheetShown: this.isReplicationSheetShown,\n\t\t\t\t\t\t\tsheetBindProps: this.sheetBindProps,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tisEnabled: this.wasFilled(TaskField.Replication) || this.task.rights.edit,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t'update:isSheetShown': (isShown: boolean): void => {\n\t\t\t\t\t\t\t\tthis.isReplicationSheetShown = isShown;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: TimeTrackingChip,\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t\tisEnabled: this.task.rights.edit || this.task.rights.elapsedTime,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tisSheetShown: this.isTimeTrackingChipSheetShown,\n\t\t\t\t\t\t\tsheetBindProps: this.sheetBindProps,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t'update:isSheetShown': (isShown: boolean): void => {\n\t\t\t\t\t\t\t\tthis.isTimeTrackingChipSheetShown = isShown;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: UserFieldsChip,\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t\tisEnabled: this.shouldShowUserFieldsChip,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\topen: this.openUserFieldsHandler,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t].filter((field) => field);\n\t\t},\n\t\tsheetBindProps(): SheetBindProps\n\t\t{\n\t\t\treturn {\n\t\t\t\tgetBindElement: () => this.$refs.title,\n\t\t\t\tgetTargetContainer: () => this.$refs.main,\n\t\t\t};\n\t\t},\n\t\tprimaryFields(): AppField[]\n\t\t{\n\t\t\treturn this.getFields(new WeakMap([\n\t\t\t\t[Creator, true],\n\t\t\t\t[Responsible, true],\n\t\t\t\t[Deadline, true],\n\t\t\t\t[TimeTracking, (\n\t\t\t\t\tthis.task.allowsTimeTracking\n\t\t\t\t\t|| (\n\t\t\t\t\t\tthis.task.rights.elapsedTime\n\t\t\t\t\t\t&& this.task.numberOfElapsedTimes\n\t\t\t\t\t)\n\t\t\t\t)],\n\t\t\t\t[Status, this.isEdit],\n\t\t\t\t[CreatedDate, this.isEdit],\n\t\t\t]));\n\t\t},\n\t\tprojectFields(): AppField[]\n\t\t{\n\t\t\tconst isScrum = this.group?.type === GroupType.Scrum;\n\n\t\t\treturn this.getFields(new WeakMap([\n\t\t\t\t[Group, this.wasFilled(TaskField.Group)],\n\t\t\t\t[Flow, this.wasFilled(TaskField.Flow)],\n\t\t\t\t[Stage, !this.isTemplate && this.isEdit && this.group?.id > 0 && (this.task.stageId !== 0 || !isScrum)],\n\t\t\t\t[Epic, !this.isTemplate && isScrum],\n\t\t\t\t[StoryPoints, !this.isTemplate && isScrum],\n\t\t\t\t[Crm, this.wasFilled(TaskField.Crm)],\n\t\t\t]));\n\t\t},\n\t\tparticipantsFields(): AppField[]\n\t\t{\n\t\t\treturn this.getFields(new WeakMap([\n\t\t\t\t[Accomplices, this.wasFilled(TaskField.Accomplices)],\n\t\t\t\t[Auditors, this.wasFilled(TaskField.Auditors)],\n\t\t\t]));\n\t\t},\n\t\ttagsFields(): AppField[]\n\t\t{\n\t\t\treturn this.getFields(new WeakMap([\n\t\t\t\t[Tags, this.wasFilled(TaskField.Tags)],\n\t\t\t]));\n\t\t},\n\t\temailFields(): Object[]\n\t\t{\n\t\t\treturn this.getFields(new WeakMap([\n\t\t\t\t[Email, this.wasFilled(TaskField.Email)],\n\t\t\t\t[EmailFrom, this.wasFilled(TaskField.Email) && this.task.email.from],\n\t\t\t\t[EmailDate, this.wasFilled(TaskField.Email) && this.task.email.dateTs],\n\t\t\t]));\n\t\t},\n\t\tchips(): AppChip[]\n\t\t{\n\t\t\treturn this.fields.filter(({ chip }) => chip && chip.isEnabled !== false).map(({ chip }) => chip);\n\t\t},\n\t\tisBottomSheetShown(): boolean\n\t\t{\n\t\t\treturn this.isDescriptionSheetShown\n\t\t\t\t|| this.isFilesSheetShown\n\t\t\t\t|| this.isCheckListSheetShown\n\t\t\t\t|| this.isDatePlanSheetShown\n\t\t\t\t|| this.isTimeTrackingSheetShown\n\t\t\t\t|| this.isTimeTrackingChipSheetShown\n\t\t\t\t|| this.isResultListSheetShown\n\t\t\t\t|| this.isResultEditorSheetShown\n\t\t\t\t|| this.isResultChipSheetShown\n\t\t\t\t|| this.isReminderSheetShown\n\t\t\t\t|| this.isRemindersSheetShown\n\t\t\t\t|| this.isReplicationSheetShown\n\t\t\t\t|| this.isReplicationHistorySheetShown;\n\t\t},\n\t\tisDiskModuleInstalled(): boolean\n\t\t{\n\t\t\treturn Core.getParams().features.disk;\n\t\t},\n\t\ttaskSettingsBindElement(): ?HTMLElement\n\t\t{\n\t\t\tif (this.isPrimaryFieldsHovered)\n\t\t\t{\n\t\t\t\treturn this.$refs.main.querySelector('[data-settings-label]');\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tisCopyMode(): boolean\n\t\t{\n\t\t\treturn this.initialTask?.copiedFromId && !idUtils.isReal(this.task?.id);\n\t\t},\n\t\tplaceholderOptions(): any\n\t\t{\n\t\t\treturn {\n\t\t\t\timgSrc: this.iconUrl,\n\t\t\t\thead: Loc.getMessage('TASKS_V2_TASK_FULL_CARD_PLACEHOLDER_TITLE_NO_RIGHTS'),\n\t\t\t};\n\t\t},\n\t\tisReplicateTemplate(): boolean\n\t\t{\n\t\t\treturn this.isTemplate && (this.task?.replicate === true);\n\t\t},\n\t\thasFilledUserFields(): boolean\n\t\t{\n\t\t\treturn userFieldsManager.hasFilledUserFields(this.task?.userFields || [], this.userFieldScheme);\n\t\t},\n\t\thasRequiredUserFields(): boolean\n\t\t{\n\t\t\treturn userFieldsManager.hasMandatoryUserFields(this.userFieldScheme);\n\t\t},\n\t\tshouldShowUserFields(): boolean\n\t\t{\n\t\t\treturn this.isEdit\n\t\t\t\t? this.hasFilledUserFields\n\t\t\t\t: this.hasRequiredUserFields || this.hasFilledUserFields\n\t\t\t;\n\t\t},\n\t\tshouldShowUserFieldsChip(): boolean\n\t\t{\n\t\t\tif (this.isAdmin)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn (this.task.rights.edit && this.userFieldScheme.length > 0) || this.hasFilledUserFields;\n\t\t},\n\t},\n\twatch: {\n\t\tasync isLoading(): Promise<void>\n\t\t{\n\t\t\tawait this.$nextTick();\n\n\t\t\tthis.renderSkeleton();\n\t\t},\n\t\tasync isPrimaryFieldsHovered(isHovered: boolean): Promise<void>\n\t\t{\n\t\t\tif (isHovered && ahaMoments.shouldShow(Option.AhaTaskSettingsMessagePopup))\n\t\t\t{\n\t\t\t\tsetTimeout(this.showTaskSettingsHint, 500);\n\t\t\t}\n\t\t},\n\t\t'task.templateId': function(templateId: number, previousTemplateId: number): void\n\t\t{\n\t\t\tif (this.taskInitial && !this.isEdit && templateId && templateId !== previousTemplateId)\n\t\t\t{\n\t\t\t\tvoid this.handleTemplate(templateId);\n\t\t\t}\n\t\t},\n\t},\n\tasync created(): Promise<void>\n\t{\n\t\tif (!this.isEdit && !this.task)\n\t\t{\n\t\t\tawait taskService.insertStoreTask({\n\t\t\t\t...this.initialTask,\n\t\t\t\tid: this.taskId,\n\t\t\t\tcreatorId: Core.getParams().currentUser.id,\n\t\t\t\tresponsibleIds: [Core.getParams().currentUser.id],\n\t\t\t\tdeadlineTs: this.initialTask.deadlineTs ?? this.defaultDeadlineTs,\n\t\t\t\tneedsControl: this.stateFlags.needsControl ?? null,\n\t\t\t\tmatchesWorkTime: this.stateFlags.matchesWorkTime ?? null,\n\t\t\t\trequireResult: Core.getParams().restrictions.requiredResult.available && this.defaultRequireResult,\n\t\t\t});\n\n\t\t\tif (this.initialTask.copiedFromId)\n\t\t\t{\n\t\t\t\tawait taskService.getCopy(this.initialTask.copiedFromId, this.taskId);\n\t\t\t}\n\n\t\t\tif (this.initialTask.templateId)\n\t\t\t{\n\t\t\t\tawait templateService.getTask(this.initialTask.templateId, this.taskId);\n\t\t\t}\n\n\t\t\tif (this.analytics.context)\n\t\t\t{\n\t\t\t\tanalytics.sendClickCreate(this.analytics, {\n\t\t\t\t\tcollabId: this.group?.type === GroupType.Collab ? this.group.id : null,\n\t\t\t\t\tcardType: CardType.Full,\n\t\t\t\t\tviewersCount: this.initialTask?.auditorsIds?.length ?? 0,\n\t\t\t\t\tcoexecutorsCount: this.initialTask?.accomplicesIds?.length ?? 0,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tawait this.$store.dispatch(`${Model.Tasks}/clearFieldsFilled`, this.taskId);\n\n\t\tif (this.isEdit && (!this.task || this.isPartiallyLoaded))\n\t\t{\n\t\t\tawait taskService.get(this.taskId);\n\t\t}\n\n\t\tif (this.task?.fileIds?.length > 0)\n\t\t{\n\t\t\tawait fileService.get(this.taskId).list(this.task.fileIds);\n\t\t}\n\n\t\tthis.isLoading = false;\n\n\t\tif (!this.task)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isTemplate && !this.canChangeDeadlineWithoutLimitation && this.task.maxDeadlineChanges)\n\t\t{\n\t\t\tvoid deadlineService.updateDeadlineChangeCount(this.task.id);\n\t\t}\n\n\t\tentityTextEditor.get(\n\t\t\tthis.taskId,\n\t\t\tEntityTextTypes.Task,\n\t\t\t{ content: this.task?.description },\n\t\t);\n\n\t\tthis.taskInitial = this.task;\n\n\t\tif (this.isEdit && this.analytics.context)\n\t\t{\n\t\t\tanalytics.sendTaskView(this.analytics, {\n\t\t\t\tviewersCount: this.task?.auditorsIds?.length ?? 0,\n\t\t\t\tcoexecutorsCount: this.task?.accomplicesIds?.length ?? 0,\n\t\t\t});\n\t\t}\n\n\t\tawait Runtime.loadExtension(Core.getParams().externalExtensions);\n\n\t\tEventEmitter.emit(EventName.FullCardInit, { task: this.task });\n\t},\n\tasync mounted(): void\n\t{\n\t\tEventEmitter.subscribe(EventName.FullCardHasChanges, this.handleHasChanges);\n\n\t\tthis.renderSkeleton();\n\t\tthis.iconUrl = (await import('../images/marshmallow_sad_pink_with_orange_lock.png')).default;\n\t},\n\tunmounted(): void\n\t{\n\t\tEventEmitter.unsubscribe(EventName.FullCardHasChanges, this.handleHasChanges);\n\n\t\tif (!this.isEdit)\n\t\t{\n\t\t\tvoid this.$store.dispatch(`${Model.Tasks}/delete`, this.taskId);\n\t\t\tfileService.delete(this.taskId);\n\t\t\tentityTextEditor.delete(this.taskId);\n\t\t}\n\t},\n\tmethods: {\n\t\t...mapActions(Model.Interface, [\n\t\t\t'updateFullCardWidth',\n\t\t]),\n\t\tgetFields(map: WeakMap): AppField[]\n\t\t{\n\t\t\treturn this.fields.filter(({ component }) => map.get(component));\n\t\t},\n\t\twasFilled(fieldId: string): boolean\n\t\t{\n\t\t\treturn Boolean(this.task.filledFields[fieldId]);\n\t\t},\n\t\tasync addTask(): Promise<void>\n\t\t{\n\t\t\tconst checklists = this.checklist;\n\n\t\t\tconst [id, error] = await taskService.add(this.task);\n\n\t\t\tif (!id)\n\t\t\t{\n\t\t\t\tthis.handleCreationError(error);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.taskId = id;\n\n\t\t\tfileService.replace(this.id, id);\n\n\t\t\tentityTextEditor.replace(this.id, id);\n\n\t\t\tconst isSuccess = Boolean(id);\n\n\t\t\tthis.sendAddTaskAnalytics(isSuccess, checklists);\n\n\t\t\tthis.notifyGrid();\n\t\t},\n\t\tasync copyTask(event: Object): Promise<void>\n\t\t{\n\t\t\tconst { withSubTasks } = event;\n\n\t\t\tconst [id, error] = await taskService.copy(this.task, withSubTasks);\n\n\t\t\tif (!id)\n\t\t\t{\n\t\t\t\tthis.handleCreationError(error);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.taskId = id;\n\n\t\t\tfileService.delete(this.id);\n\t\t\tawait fileService.get(this.taskId).sync(this.task.fileIds);\n\n\t\t\tentityTextEditor.replace(this.id, id);\n\n\t\t\tthis.notifyGrid();\n\t\t},\n\t\tasync createFromTemplate(event: Object): Promise<void>\n\t\t{\n\t\t\tconst { withSubTasks } = event;\n\n\t\t\tconst [id, error] = await templateService.addTask(\n\t\t\t\tthis.task.templateId,\n\t\t\t\tthis.task,\n\t\t\t\twithSubTasks,\n\t\t\t);\n\n\t\t\tif (!id)\n\t\t\t{\n\t\t\t\tthis.handleCreationError(error);\n\n\t\t\t\tthis.sendAddTaskFromTemplateAnalytics(false);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.taskId = id;\n\n\t\t\tthis.sendAddTaskFromTemplateAnalytics(true);\n\n\t\t\tfileService.delete(this.id);\n\t\t\tawait fileService.get(this.taskId).sync(this.task.fileIds);\n\n\t\t\tentityTextEditor.replace(this.id, id);\n\n\t\t\tthis.notifyGrid();\n\t\t},\n\t\thandleCreationError(error: Error): void\n\t\t{\n\t\t\tthis.creationError = true;\n\n\t\t\tNotifier.notifyViaBrowserProvider({\n\t\t\t\tid: 'task-notify-add-error',\n\t\t\t\ttext: error?.message,\n\t\t\t});\n\t\t},\n\t\tnotifyGrid(): void\n\t\t{\n\t\t\tEventEmitter.emit(EventName.NotifyGrid, new BaseEvent({\n\t\t\t\tdata: this.taskId,\n\t\t\t\tcompatData: [\n\t\t\t\t\t'ADD',\n\t\t\t\t\t{\n\t\t\t\t\t\ttask: this.task,\n\t\t\t\t\t\toptions: {},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t}));\n\t\t},\n\t\topenCheckList(checkListId?: number): void\n\t\t{\n\t\t\tthis.checkListId = checkListId;\n\t\t\tthis.isCheckListSheetShown = true;\n\t\t},\n\t\tcloseCheckList(checkListId?: number): void\n\t\t{\n\t\t\tthis.checkListId = checkListId;\n\t\t\tthis.isCheckListSheetShown = false;\n\t\t},\n\t\topenUserFieldsHandler(): void\n\t\t{\n\t\t\tvoid userFieldsSlider.open({\n\t\t\t\ttaskId: this.taskId,\n\t\t\t\tisTemplate: this.isTemplate,\n\t\t\t\ttemplateId: this.isEdit ? null : this.task?.templateId,\n\t\t\t\tcopiedFromId: this.isEdit ? null : this.task?.copiedFromId,\n\t\t\t});\n\t\t},\n\t\thandleCloseTaskSettingsHint(): void\n\t\t{\n\t\t\tthis.isTaskSettingsHintShown = false;\n\t\t\tahaMoments.setInactive(Option.AhaTaskSettingsMessagePopup);\n\n\t\t\tif (ahaMoments.shouldShow(Option.AhaTaskSettingsMessagePopup))\n\t\t\t{\n\t\t\t\tahaMoments.setShown(Option.AhaTaskSettingsMessagePopup);\n\t\t\t}\n\t\t},\n\t\thandleEndResize(newWidth: number): void\n\t\t{\n\t\t\tconst cardWidth = this.validateCardWidth(newWidth);\n\n\t\t\tvoid this.updateFullCardWidth(cardWidth);\n\n\t\t\tUserOptions.delay = 100;\n\t\t\tUserOptions.save('tasks', 'fullCard', 'cardWidth', cardWidth);\n\t\t},\n\t\tvalidateCardWidth(width: ?number): ?number\n\t\t{\n\t\t\treturn Number.isNaN(parseInt(width, 10)) ? null : parseInt(width, 10);\n\t\t},\n\t\thandleHasChanges(event: BaseEvent): { taskId: number | string, hasChanges: boolean }\n\t\t{\n\t\t\tconst handleResult = { taskId: this.taskId };\n\n\t\t\tif (this.isEdit || event.getData().taskId !== this.taskId)\n\t\t\t{\n\t\t\t\thandleResult.hasChanges = false;\n\n\t\t\t\treturn handleResult;\n\t\t\t}\n\n\t\t\thandleResult.hasChanges = JSON.stringify(this.task) !== JSON.stringify(this.taskInitial);\n\n\t\t\treturn handleResult;\n\t\t},\n\t\ttryClose(): void\n\t\t{\n\t\t\tEventEmitter.emit(EventName.TryCloseFullCard, { taskId: this.taskId });\n\t\t},\n\t\tshowTaskSettingsHint(): void\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.isSettingsPopupShown === false\n\t\t\t\t&& this.taskSettingsBindElement\n\t\t\t)\n\t\t\t{\n\t\t\t\tahaMoments.setActive(Option.AhaTaskSettingsMessagePopup);\n\t\t\t\tthis.isTaskSettingsHintShown = true;\n\t\t\t}\n\t\t},\n\t\tasync handleTemplate(templateId: number): Promise<void>\n\t\t{\n\t\t\tthis.isLoading = true;\n\n\t\t\tawait templateService.getTask(templateId, this.taskId);\n\n\t\t\tif (this.task?.fileIds?.length > 0)\n\t\t\t{\n\t\t\t\tawait fileService.get(this.taskId).list(this.task?.fileIds);\n\t\t\t}\n\n\t\t\tawait this.$store.dispatch(`${Model.Tasks}/clearFieldsFilled`, this.taskId);\n\n\t\t\tthis.isLoading = false;\n\t\t},\n\t\trenderSkeleton(): void\n\t\t{\n\t\t\tif (this.$refs.skeleton)\n\t\t\t{\n\t\t\t\tconst skeletonPath = '/bitrix/js/tasks/v2/application/task-card/src/skeleton-full.html?v=1';\n\t\t\t\tconst templateSkeletonPath = '/bitrix/js/tasks/v2/application/task-card/src/skeleton-template.html?v=1';\n\n\t\t\t\tvoid renderSkeleton(this.isTemplate ? templateSkeletonPath : skeletonPath, this.$refs.skeleton);\n\t\t\t}\n\t\t},\n\t\tsendAddTaskAnalytics(isSuccess: boolean, checklists: CheckListModel[]): void\n\t\t{\n\t\t\tconst collabId = this.group?.type === GroupType.Collab ? this.group.id : null;\n\t\t\tconst viewersCount = this.task.auditorsIds.length;\n\t\t\tconst coexecutorsCount = this.task.accomplicesIds.length;\n\n\t\t\tif (this.task.templateId)\n\t\t\t{\n\t\t\t\tthis.sendAddTaskFromTemplateAnalytics(isSuccess);\n\t\t\t}\n\t\t\telse if (this.task.parentId)\n\t\t\t{\n\t\t\t\tanalytics.sendAddTask(this.analytics, {\n\t\t\t\t\tisSuccess,\n\t\t\t\t\tcollabId,\n\t\t\t\t\tviewersCount,\n\t\t\t\t\tcoexecutorsCount,\n\t\t\t\t\tevent: Analytics.Event.SubTaskAdd,\n\t\t\t\t\tcardType: CardType.Full,\n\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (checklists.length > 0)\n\t\t\t{\n\t\t\t\tconst checklistCount = checklists.filter(({ parentId }) => parentId === 0).length;\n\t\t\t\tconst checklistItemsCount = checklists.filter(({ parentId }) => parentId !== 0).length;\n\n\t\t\t\tanalytics.sendAddTaskWithCheckList(this.analytics, {\n\t\t\t\t\tisSuccess,\n\t\t\t\t\tcollabId,\n\t\t\t\t\tviewersCount,\n\t\t\t\t\tchecklistCount,\n\t\t\t\t\tchecklistItemsCount,\n\t\t\t\t\tcardType: CardType.Full,\n\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tanalytics.sendAddTask(this.analytics, {\n\t\t\t\t\tisSuccess,\n\t\t\t\t\tcollabId,\n\t\t\t\t\tviewersCount,\n\t\t\t\t\tcoexecutorsCount,\n\t\t\t\t\tevent: Analytics.Event.TaskCreate,\n\t\t\t\t\tcardType: CardType.Full,\n\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tsendAddTaskFromTemplateAnalytics(isSuccess: boolean): void\n\t\t{\n\t\t\tconst collabId = this.group?.type === GroupType.Collab ? this.group.id : null;\n\t\t\tconst viewersCount = this.task.auditorsIds.length;\n\t\t\tconst coexecutorsCount = this.task.accomplicesIds.length;\n\n\t\t\tanalytics.sendAddTask(this.analytics, {\n\t\t\t\tisSuccess,\n\t\t\t\tcollabId,\n\t\t\t\tviewersCount,\n\t\t\t\tcoexecutorsCount,\n\t\t\t\tevent: Analytics.Event.PatternTaskCreate,\n\t\t\t\tcardType: CardType.Full,\n\t\t\t\ttaskId: this.taskId,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-full-card\" :class=\"{ '--blur': isDescriptionSheetShown }\" :data-task-id=\"taskId\" data-task-full>\n\t\t\t<template v-if=\"task && !isPartiallyLoaded && !isLoading\">\n\t\t\t\t<div\n\t\t\t\t\tref=\"main\"\n\t\t\t\t\tclass=\"tasks-full-card-main\"\n\t\t\t\t\t:class=\"{ '--overlay': isBottomSheetShown }\"\n\t\t\t\t\t:style=\"{ width: (isTemplate ? '100%' : fullCardWidth + 'px') }\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"tasks-full-card-content\" :data-task-card-scroll=\"taskId\" ref=\"scrollContent\">\n\t\t\t\t\t\t<div ref=\"title\">\n\t\t\t\t\t\t\t<TaskHeader/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<CheckList\n\t\t\t\t\t\t\t:checkListId\n\t\t\t\t\t\t\t:isShown=\"isCheckListSheetShown\"\n\t\t\t\t\t\t\t:sheetBindProps\n\t\t\t\t\t\t\t@close=\"closeCheckList\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<DescriptionField\n\t\t\t\t\t\t\tv-model:isSheetShown=\"isDescriptionSheetShown\"\n\t\t\t\t\t\t\t:taskId\n\t\t\t\t\t\t\t:sheetBindProps\n\t\t\t\t\t\t\tref=\"description\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"tasks-full-card-fields\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container\"\n\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t@mouseover=\"isPrimaryFieldsHovered = true\"\n\t\t\t\t\t\t\t\t@mouseleave=\"isPrimaryFieldsHovered = false\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<FieldList :fields=\"primaryFields\"/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-full-card-chips-fields\">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"emailFields.length > 0\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<FieldList :fields=\"emailFields\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"!isTemplate && (task.requireResult || wasFilled(TaskField.Results))\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --custom\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Results\n\t\t\t\t\t\t\t\t\t\tv-model:isSheetShown=\"isResultEditorSheetShown\"\n\t\t\t\t\t\t\t\t\t\tv-model:isListSheetShown=\"isResultListSheetShown\"\n\t\t\t\t\t\t\t\t\t\t:sheetBindProps\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"isDiskModuleInstalled && (files.length > 0 || wasFilled(TaskField.Files))\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --small-vertical-padding\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Files v-model:isSheetShown=\"isFilesSheetShown\" :taskId :sheetBindProps/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"wasFilled(TaskField.CheckList)\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --custom\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<CheckList\n\t\t\t\t\t\t\t\t\t\tisPreview\n\t\t\t\t\t\t\t\t\t\t:isComponentShown=\"!isCheckListSheetShown\"\n\t\t\t\t\t\t\t\t\t\t:checkListId\n\t\t\t\t\t\t\t\t\t\t@open=\"openCheckList\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"projectFields.length > 0\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<FieldList :fields=\"projectFields\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"participantsFields.length > 0\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<FieldList\n\t\t\t\t\t\t\t\t\t\t:fields=\"participantsFields\"\n\t\t\t\t\t\t\t\t\t\t:useSeparator=\"participantsFields.length > 1\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"!isTemplate && isEdit && wasFilled(TaskField.Placements)\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --custom\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Placements/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"!isTemplate && wasFilled(TaskField.Reminders)\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --custom\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Reminders\n\t\t\t\t\t\t\t\t\t\tv-model:isSheetShown=\"isReminderSheetShown\"\n\t\t\t\t\t\t\t\t\t\tv-model:isListSheetShown=\"isRemindersSheetShown\"\n\t\t\t\t\t\t\t\t\t\t:sheetBindProps\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"tagsFields.length > 0\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<FieldList :fields=\"tagsFields\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"wasFilled(TaskField.Parent)\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --custom\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<ParentTask/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"wasFilled(TaskField.SubTasks) && !isCopyMode\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --custom --task-list\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<SubTasks/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"wasFilled(TaskField.RelatedTasks)\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --custom --task-list\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<RelatedTasks/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"!isTemplate && wasFilled(TaskField.Gantt)\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --custom --task-list\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Gantt/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"wasFilled(TaskField.DatePlan)\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<DatePlan v-model:isSheetShown=\"isDatePlanSheetShown\" :sheetBindProps/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"isTemplate && wasFilled(TaskField.Replication)\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --custom tasks-full-card-field-container-replication\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Replication\n\t\t\t\t\t\t\t\t\t\tv-model:isSheetShown=\"isReplicationSheetShown\"\n\t\t\t\t\t\t\t\t\t\tv-model:isHistorySheetShown=\"isReplicationHistorySheetShown\"\n\t\t\t\t\t\t\t\t\t\t:sheetBindProps\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"shouldShowUserFields\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --custom\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<UserFields @open=\"openUserFieldsHandler\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<Chips :chips/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<TaskSettingsHint\n\t\t\t\t\t\t\t\tv-if=\"isTaskSettingsHintShown\"\n\t\t\t\t\t\t\t\t:isShown=\"isTaskSettingsHintShown\"\n\t\t\t\t\t\t\t\t:bindElement=\"taskSettingsBindElement\"\n\t\t\t\t\t\t\t\t@close=\"handleCloseTaskSettingsHint\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<FooterEdit v-if=\"isEdit\"/>\n\t\t\t\t\t<FooterCreate\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\tv-model:creationError=\"creationError\"\n\t\t\t\t\t\t@addTask=\"addTask\"\n\t\t\t\t\t\t@copyTask=\"copyTask\"\n\t\t\t\t\t\t@fromTemplate=\"createFromTemplate\"\n\t\t\t\t\t\t@close=\"tryClose\"\n\t\t\t\t\t\t@template=\"handleTemplate\"\n\t\t\t\t\t/>\n\t\t\t\t\t<ContentResizer v-if=\"!isTemplate\" @endResize=\"handleEndResize\"/>\n\t\t\t\t\t<DropZone\n\t\t\t\t\t\tv-if=\"isDiskModuleInstalled && !isBottomSheetShown && task.rights.edit\"\n\t\t\t\t\t\t:container=\"$refs.main || {}\"\n\t\t\t\t\t\t:entityId=\"taskId\"\n\t\t\t\t\t\t:entityType=\"EntityTypes.Task\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<Chat v-if=\"!isTemplate\"/>\n\t\t\t</template>\n\t\t\t<template v-else-if=\"isLoading\">\n\t\t\t\t<div ref=\"skeleton\" style=\"width: 100%;\"/>\n\t\t\t</template>\n\t\t\t<Placeholder\n\t\t\t\tv-else\n\t\t\t\t:imgSrc=\"placeholderOptions.imgSrc\"\n\t\t\t\t:head=\"placeholderOptions.head\"\n\t\t\t\t:descr=\"placeholderOptions.descr\"\n\t\t\t\t:action=\"placeholderOptions.action\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\n\nexport class ClosePopup\n{\n\tshow(onOk: Function): void\n\t{\n\t\tMessageBox.show({\n\t\t\tuseAirDesign: true,\n\t\t\ttitle: Loc.getMessage('TASKS_V2_TASK_FULL_CARD_CLOSE_POPUP_TITLE_MSGVER_1'),\n\t\t\tmessage: Loc.getMessage('TASKS_V2_TASK_FULL_CARD_CLOSE_POPUP_MESSAGE'),\n\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\tokCaption: Loc.getMessage('TASKS_V2_TASK_FULL_CARD_CLOSE_POPUP_OK_CAPTION'),\n\t\t\tonOk,\n\t\t\tpopupOptions: {\n\t\t\t\tcloseIcon: false,\n\t\t\t},\n\t\t});\n\t}\n}\n","import { Event, Text, Type, Uri, Loc, Runtime } from 'main.core';\nimport { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { SidePanel, type Slider, type SliderEvent } from 'main.sidepanel';\nimport type { Popup } from 'main.popup';\n\nimport { BitrixVue, type VueCreateAppResult } from 'ui.vue3';\nimport { locMixin } from 'ui.vue3.mixins.loc-mixin';\n\nimport { TaskCard, type Params } from 'tasks.v2.application.task-card';\nimport { Core } from 'tasks.v2.core';\nimport { EventName } from 'tasks.v2.const';\nimport { idUtils } from 'tasks.v2.lib.id-utils';\nimport { TaskMappers } from 'tasks.v2.provider.service.task-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { App } from './component/app';\nimport { ClosePopup } from './lib/close-popup';\n\nconst openedCards = new Set();\n\nexport class TaskFullCard\n{\n\t#params: Params;\n\t#slider: Slider;\n\t#application: ?VueCreateAppResult;\n\t#handlers: { [eventName: string]: Function };\n\t#needToReloadGrid: boolean = false;\n\t#isCloseConfirmed: boolean = false;\n\t#shouldCloseComplete: boolean = true;\n\n\tconstructor(params: Params = {})\n\t{\n\t\tthis.#params = Object.fromEntries(Object.entries(params).filter(([, value]) => !Type.isUndefined(value)));\n\n\t\tthis.#params.taskId ||= Text.getRandom();\n\t\tif (this.#params.taskId === 'template0')\n\t\t{\n\t\t\tthis.#params.taskId = idUtils.boxTemplate(Text.getRandom());\n\t\t}\n\t}\n\n\tstatic isOpened(taskId: number): boolean\n\t{\n\t\treturn openedCards.has(taskId);\n\t}\n\n\tasync mount(slider: Slider): Promise<void>\n\t{\n\t\tif (!slider.isOpen())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst queryParams = new Uri(this.#params.link?.url ?? this.#params.url).getQueryParams();\n\t\tthis.#params = {\n\t\t\t...TaskMappers.mapSliderDataToModel({ ...queryParams, ...slider.getRequestParams() }),\n\t\t\t...this.#params,\n\t\t\t...(['tasks_planning', 'tasks_kanban_sprint'].includes(queryParams.SCOPE) ? { deadlineTs: 0 } : {}),\n\t\t};\n\n\t\tthis.#params.groupId ||= Core.getParams().defaultCollab?.id || undefined;\n\n\t\tthis.#slider = slider;\n\n\t\tthis.#updateSliderUrl();\n\n\t\tthis.#subscribe();\n\n\t\tthis.#application = await this.#mountApplication(slider.getContentContainer());\n\n\t\topenedCards.add(this.#params.taskId);\n\t}\n\n\tunmount(): void\n\t{\n\t\tthis.#unmountApplication();\n\n\t\tthis.#unsubscribe();\n\n\t\tif (this.#needToReloadGrid && BX.Tasks.Util)\n\t\t{\n\t\t\tconst id = this.#params.taskId;\n\t\t\tBX.Tasks.Util.fireGlobalTaskEvent('UPDATE', { ID: id }, { STAY_AT_PAGE: true }, { id });\n\t\t}\n\n\t\topenedCards.delete(this.#params.taskId);\n\t}\n\n\tonClose(event: SliderEvent): void\n\t{\n\t\tif (this.#isCloseConfirmed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t/** @type {{ taskId: number | string, hasChanges: boolean }[]} */\n\t\tconst allChanges = EventEmitter.emit(EventName.FullCardHasChanges, { taskId: this.#params.taskId });\n\t\tconst hasChanges = allChanges.find((result) => result.taskId === this.#params.taskId)?.hasChanges;\n\t\tif (!hasChanges)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tevent.denyAction();\n\t\tnew ClosePopup().show((dialog) => {\n\t\t\tdialog.close();\n\t\t\tthis.#isCloseConfirmed = true;\n\t\t\tthis.#slider.close();\n\t\t});\n\t}\n\n\tonCloseComplete(): void\n\t{\n\t\tthis.unmount();\n\t\tif (this.#shouldCloseComplete && this.#params.closeCompleteUrl)\n\t\t{\n\t\t\tlocation.href = this.#params.closeCompleteUrl;\n\t\t}\n\t}\n\n\tasync #mountApplication(container: HTMLElement): Promise<VueCreateAppResult>\n\t{\n\t\tawait Core.init();\n\n\t\tconst { taskId, analytics, url, link, closeCompleteUrl, ...initialTask } = this.#params;\n\n\t\tconst application = BitrixVue.createApp(App, {\n\t\t\tid: taskId,\n\t\t\tinitialTask: Object.fromEntries(Object.entries(initialTask).filter(([, value]) => !Type.isNil(value))),\n\t\t\tanalytics,\n\t\t});\n\n\t\tapplication.mixin(locMixin);\n\t\tapplication.use(Core.getStore());\n\t\tapplication.mount(container);\n\n\t\treturn application;\n\t}\n\n\t#unmountApplication(): void\n\t{\n\t\tthis.#application?.unmount();\n\n\t\tEventEmitter.emit(EventName.FullCardClosed, this.#params);\n\t}\n\n\t#subscribe(): void\n\t{\n\t\tthis.#handlers = {\n\t\t\t[EventName.FullCardInit]: this.#handleTaskCardInit,\n\t\t\t[EventName.TaskAdded]: this.#handleTaskAdd,\n\t\t\t[EventName.TaskBeforeUpdate]: this.#handleTaskUpdate,\n\t\t\t[EventName.TemplateAdded]: this.#handleTemplateAdd,\n\t\t\t[EventName.TemplateBeforeUpdate]: this.#handleTemplateUpdate,\n\t\t\t[EventName.CloseFullCard]: this.#onClose,\n\t\t\t[EventName.TryCloseFullCard]: this.#onTryClose,\n\t\t\t[EventName.OpenViewSliderCard]: this.#openViewSliderCard,\n\t\t\t[EventName.OpenCompactCard]: this.#openCompactCard,\n\t\t\t[EventName.OpenGrid]: this.#openGrid,\n\t\t\t[EventName.OpenTemplateHistory]: this.#openTemplateHistory,\n\t\t\t[EventName.OpenHistory]: this.#openHistory,\n\t\t\t'BX.Main.Popup:onShow': this.#handlePopupShow,\n\t\t};\n\n\t\tObject.entries(this.#handlers).forEach(([event, handler]) => EventEmitter.subscribe(event, handler));\n\t}\n\n\t#unsubscribe(): void\n\t{\n\t\tObject.entries(this.#handlers).forEach(([event, handler]) => EventEmitter.unsubscribe(event, handler));\n\t}\n\n\t#handleTaskUpdate = (event: BaseEvent): void => {\n\t\tconst task: TaskModel = event.getData().task;\n\t\tconst taskId = task.id;\n\n\t\tconst relationIds = new Set([...task.subTaskIds, ...task.relatedTaskIds, ...task.ganttTaskIds]);\n\t\tconst isRelationTaskUpdated = relationIds.has(taskId);\n\n\t\tconst fields = Object.keys(event.getData().fields);\n\t\tconst fieldsForReloadGrid = new Set(['deadlineTs', 'responsibleIds']);\n\t\tconst isFieldsForGridUpdated = fields.some((it: string) => fieldsForReloadGrid.has(it));\n\n\t\tif (isRelationTaskUpdated || (taskId === this.#params.taskId && isFieldsForGridUpdated))\n\t\t{\n\t\t\tthis.#needToReloadGrid = true;\n\t\t}\n\n\t\tthis.#updateSliderTitle(task.title);\n\t};\n\n\t#handleTaskCardInit = (event: BaseEvent): void => {\n\t\tconst task: TaskModel = event.getData().task;\n\n\t\tif (task.id === this.#params.taskId)\n\t\t{\n\t\t\tthis.#updateSliderTitle(task.title);\n\t\t}\n\t};\n\n\t#handleTaskAdd = (event: BaseEvent): void => {\n\t\tconst initialTask: TaskModel = event.getData().initialTask;\n\t\tif (initialTask.id !== this.#params.taskId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst task: TaskModel = event.getData().task;\n\n\t\topenedCards.delete(this.#params.taskId);\n\t\tthis.#params.taskId = task.id;\n\t\topenedCards.add(this.#params.taskId);\n\n\t\tthis.#isCloseConfirmed = true;\n\n\t\tthis.#updateSliderTitle(task.title);\n\t\tthis.#updateSliderUrl();\n\t};\n\n\t#handleTemplateAdd = (event: BaseEvent): void => {\n\t\tconst initialTemplate: TaskModel = event.getData().initialTemplate;\n\t\tif (initialTemplate.id !== this.#params.taskId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst template: TaskModel = event.getData().template;\n\n\t\tthis.#params.taskId = template.id;\n\t\tthis.#isCloseConfirmed = true;\n\n\t\tthis.#updateSliderTitle(template.title);\n\t\tthis.#updateSliderUrl();\n\t};\n\n\t#handleTemplateUpdate = (event: BaseEvent): void => {\n\t\tconst template: TaskModel = event.getData().template;\n\n\t\tthis.#updateSliderTitle(template.title);\n\t};\n\n\t#updateSliderUrl(): void\n\t{\n\t\tconst taskId = Number.isInteger(this.#params.taskId) ? this.#params.taskId : 0;\n\t\tconst taskUrl = TaskCard.getUrl(this.#params.taskId, this.#params.groupId);\n\n\t\tif (!idUtils.isTemplate(this.#params.taskId))\n\t\t{\n\t\t\tthis.#slider.setMinimizeOptions({\n\t\t\t\tentityType: 'tasks:task',\n\t\t\t\tentityName: Loc.getMessage('INTRANET_BINDINGS_TASK'),\n\t\t\t\turl: taskUrl,\n\t\t\t\tentityId: taskId,\n\t\t\t});\n\t\t}\n\n\t\tthis.#slider.setUrl(taskUrl);\n\n\t\tSidePanel.Instance.resetBrowserHistory();\n\t}\n\n\t#updateSliderTitle(title: string): void\n\t{\n\t\tif (Type.isStringFilled(title))\n\t\t{\n\t\t\tthis.#slider.setTitle(title);\n\t\t\tSidePanel.Instance.updateBrowserTitle();\n\t\t}\n\t}\n\n\t#onTryClose = (event: BaseEvent): void => {\n\t\tif (event.getData().taskId === this.#params.taskId)\n\t\t{\n\t\t\tthis.#slider.close();\n\t\t}\n\t};\n\n\t#onClose = (event: BaseEvent): void => {\n\t\tif (event.getData().taskId === this.#params.taskId)\n\t\t{\n\t\t\tthis.#isCloseConfirmed = true;\n\t\t\tthis.#slider.close();\n\t\t}\n\t};\n\n\t#openViewSliderCard = (baseEvent: BaseEvent): void => {\n\t\tconst { taskId } = baseEvent.getData();\n\n\t\tthis.#shouldCloseComplete = false;\n\n\t\tSidePanel.Instance.open(new Uri(TaskCard.getUrl(taskId)).setQueryParam('OLD_FORM', 'Y').toString(), {\n\t\t\tcacheable: false,\n\t\t\trequestMethod: 'post',\n\t\t\tevents: {\n\t\t\t\tonCloseComplete: (): void => {\n\t\t\t\t\tif (this.#params.closeCompleteUrl)\n\t\t\t\t\t{\n\t\t\t\t\t\tlocation.href = this.#params.closeCompleteUrl;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tthis.#slider.close(true);\n\t};\n\n\t#openHistory = async (baseEvent: BaseEvent): Promise<void> => {\n\t\tconst { taskId } = baseEvent.getData();\n\n\t\tconst { HistoryGrid } = await Runtime.loadExtension('tasks.v2.application.history-grid');\n\n\t\tHistoryGrid.openHistoryGrid({ taskId });\n\t};\n\n\t#openCompactCard = async (baseEvent: BaseEvent): Promise<void> => {\n\t\tconst params = baseEvent.getData();\n\n\t\tTaskCard.showCompactCard({\n\t\t\t...params,\n\t\t\tgroupId: this.#params.groupId,\n\t\t});\n\t};\n\n\t#openGrid = (baseEvent: BaseEvent): void => {\n\t\tconst { taskId, type } = baseEvent.getData();\n\t\tconst userId = Core.getParams().currentUser.id;\n\n\t\tSidePanel.Instance.open(`/company/personal/user/${userId}/tasks/?relationToId=${taskId}&relationType=${type}`, {\n\t\t\tnewWindowLabel: false,\n\t\t\tcopyLinkLabel: false,\n\t\t});\n\t};\n\n\t#openTemplateHistory = (baseEvent: BaseEvent): void => {\n\t\tconst params = baseEvent.getData();\n\n\t\tlet templateHistoryGrid = null;\n\t\tBX.SidePanel.Instance.open('tasks-template-history-grid', {\n\t\t\tcontentCallback: async (slider: Slider): Promise<HTMLElement> => {\n\t\t\t\tconst exports = await Runtime.loadExtension('tasks.v2.application.template-history-grid');\n\n\t\t\t\ttemplateHistoryGrid = new exports.TemplateHistoryGrid(params);\n\n\t\t\t\treturn templateHistoryGrid.mount(slider);\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonClose: (): void => templateHistoryGrid?.unmount(),\n\t\t\t},\n\t\t\tcacheable: false,\n\t\t\twidth: 1200,\n\t\t});\n\t};\n\n\t#handlePopupShow = (event: BaseEvent): void => {\n\t\tconst popup: Popup = event.getCompatData()[0];\n\t\tif (popup.getTargetContainer() !== document.body)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst onScroll = () => popup.adjustPosition();\n\t\tconst onClose = () => {\n\t\t\tpopup.unsubscribe('onClose', onClose);\n\t\t\tpopup.unsubscribe('onDestroy', onClose);\n\t\t\tEvent.unbind(document, 'scroll', onScroll, true);\n\t\t};\n\n\t\tpopup.subscribe('onClose', onClose);\n\t\tpopup.subscribe('onDestroy', onClose);\n\t\tEvent.bind(document, 'scroll', onScroll, true);\n\t};\n}\n","export default \"/bitrix/js/tasks/v2/application/task-full-card/dist/images/marshmallow_sad_pink_with_orange_lock.png\""],"names":["sectionPersonal","sectionTasks","sectionCopy","sectionLinks","BurgerMenu","name","components","BIcon","BMenu","inject","task","taskId","analytics","setup","Outline","userRights","Core","getParams","rights","data","isMenuShown","computed","mapGetters","currentUserId","Model","Interface","menuOptions","id","bindElement","$refs","container","sections","code","items","menuItems","favorite","getFavoriteItem","watch","getWatchItem","mute","getMuteItem","tasks","create","getCreateNewTaskItem","createSubtask","getCreateSubtaskItem","copy","getCreateTaskCopyItem","createFromTemplate","getCreateNewTaskWithTemplateItem","saveAsTemplate","getCreateTemplateFromTaskItem","getCopyTaskIdItem","getGoToBitrixMarketItem","robot","getGoToRobotsItem","filter","item","isStakeholderLocked","restrictions","stakeholder","available","methods","favor","title","loc","icon","FAVORITE","successNotification","failNotification","unFavor","NON_FAVORITE","action","isFavorite","sectionCode","onClick","isSuccess","taskService","setFavorite","Notifier","notifyViaBrowserProvider","text","OBSERVER","auditorsIds","endpoint","unWatch","CROSSED_EYE","includes","isLocked","showLimit","featureId","$el","result","update","length","SOUND_OFF","successNotificationTitle","unMute","SOUND_ON","isMuted","setMute","TASK","TaskCard","showCompactCard","groupId","getAnalytics","RELATED_TASKS","parentId","Analytics","Element","ContextMenuSubtask","DUPLICATE","showFullCard","copiedFromId","CHEVRON_RIGHT_L","BX","SidePanel","Instance","open","newWindowLabel","copyLinkLabel","TEMPLATE_TASK","COPY","isCopyingSuccess","clipboard","uiButtonOptions","MARKET","size","ButtonSize","SMALL","useAirDesign","style","AirButtonStyle","OUTLINE","wide","disabled","onclick","rest","Marketplace","PLACEMENT","robots","LOCK_L","ROBOT","cacheable","customLeftBoundary","loader","element","ContextMenu","context","Section","Tasks","additionalContext","SubSection","template","TaskHeader","TitleField","Importance","isEdit","isTemplate","TaskSettingsHint","Hint","props","isShown","type","Boolean","required","HTMLElement","default","created","highlighter","highlight","TaskFullCardMessageMenu","baseMenu","getAddResultItem","isDeletedMessage","isOwnMessage","Loc","getMessage","FLAG","EventEmitter","emit","EventName","AddResultFromChat","getTaskId","messageId","authorId","close","getRemoveResultItem","FLAG_WITH_CROSS","DeleteResultFromChat","resultId","map","resultsMessageMap","boundMessageId","Object","entries","Number","getStoreTask","ChatAha","UiButton","TextMd","HeadlineSm","emits","ImportantMessagesAha","Chat","messageMenuManager","isTaskChatAhaShown","isTaskImportantMessagesAhaShown","taskChatAhaBindElement","chat","querySelector","taskImportantMessagesAhaBindElement","openChat","registerMessageMenu","mounted","unmounted","unregisterMessageMenu","app","bitrixVue","unmount","features","im","Messenger","Runtime","loadExtension","initApplication","mount","rootContainer","chatId","chatType","tryShowAha","mountPlaceholder","userCounter","TaskCommentsMessageMenu","MessageMenuManager","taskFullCardMessageMenu","getInstance","registerMenuByCallback","isCurrentChat","unregisterMenuByCallback","messageContext","ahaMoments","shouldShow","Option","AhaTaskChatPopup","setActive","setTimeout","showTaskChatAha","AhaTaskImportantMessagesPopup","showTaskImportantMessagesAha","setShown","handleCloseChatAha","setInactive","handleCloseImportantMessagesAha","maxVisible","Chips","Chip","chips","Array","ChipDesign","chipsCollapsed","preparedChips","isEnabled","chip","index","collapsed","hasCollapsedChips","some","FooterCreate","AddTaskButton","TemplatesButton","BitrixVue","defineAsyncComponent","delay","loadingComponent","BLine","TemplatePermissionsButton","creationError","hasError","get","set","$emit","isTemplateEnabled","ButtonId","freeze","Start","Take","Pause","Complete","Renew","Review","Approve","More","settings","selectedButtons","loading","group","$store","getters","Groups","isScrum","GroupType","Scrum","isCreator","creatorId","isResponsible","responsibleIds","accomplicesIds","button","getCreateSubtaskForTemplate","getCopyTemplate","getDeleteTemplate","statuses","TaskStatus","Pending","getCompleteItem","getDefferItem","getDelegateItem","getDeleteItem","getStartItem","InProgress","getPauseItem","Deferred","SupposedlyCompleted","getFixItem","Completed","getRenewItem","status","selectedButtonIds","Set","isDelegateLocked","delegating","handleClick","start","has","PLAY_L","waitStatus","statusService","defer","PAUSE_L","pause","HOURGLASS","renew","UNDO","disapprove","complete","SENDED","delegate","DELEGATE","handleDelegateSelect","handleClose","usersDialog","show","targetNode","ids","isMultiple","onClose","remove","design","MenuItemDesign","Alert","TRASHCAN","delete","CloseFullCard","statusPromise","templates","templatesSubtasks","idUtils","unbox","templateService","FooterEdit","TextXs","MarkTaskButton","ButtonIcon","showStartTimeTrackingHint","computedSecondaryButton","timer","timers","find","userId","primaryButton","inProgress","timeTracking","getStartTimerButton","getPauseButton","getCompleteButton","getTakeButton","getStartButton","getRenewButton","getApproveButton","getReviewButton","PLAIN","Type","isArray","secondaryButton","shouldShowStartTimeTrackingHint","shouldShowMarkTaskButton","mark","Mark","None","showFooter","edit","handler","immediate","$bitrix","eventEmitter","subscribe","TimeTrackingChange","handleTimeTrackingActivating","take","startTimer","START","pauseTimer","approve","updateSecondaryButton","$nextTick","secondary","handleOverPrimaryButton","AhaStartTimeTracking","Promise","resolve","unwatch","$watch","hideStartTimeTrackingHint","hidePermanentStartTimeTrackingHint","createTaskFromTemplate","templateId","Templates","TemplatesCard","CreateButton","Placeholder","imgSrc","String","head","descr","UserOptions","Reflection","namespace","App","DescriptionField","Files","CheckList","DatePlan","SubTasks","ParentTask","RelatedTasks","Gantt","Results","Placements","Reminders","Replication","FieldList","DropZone","ContentResizer","Email","EmailFrom","EmailDate","UserFields","CreatedDate","provide","cardType","CardType","Full","isReal","initialTask","EntityTextTypes","EntityTypes","TaskField","isFilesSheetShown","isDescriptionSheetShown","isCheckListSheetShown","isDatePlanSheetShown","isTimeTrackingSheetShown","isTimeTrackingChipSheetShown","isResultListSheetShown","isResultEditorSheetShown","isResultChipSheetShown","isReminderSheetShown","isRemindersSheetShown","isReplicationSheetShown","isReplicationHistorySheetShown","isPrimaryFieldsHovered","isSettingsPopupShown","isTaskSettingsHintShown","checkListId","files","fileService","getFiles","isLoading","taskInitial","placeholderImgUrl","defaultDeadlineTs","fullCardWidth","stateFlags","taskUserFieldScheme","templateUserFieldScheme","checklist","isAdmin","user","admin","isFlowFilledOnAdd","flowId","canChangeDeadline","deadline","canChangeDeadlineWithoutLimitation","isPartiallyLoaded","userFieldScheme","defaultRequireResult","fields","creatorMeta","component","Creator","responsibleMeta","getTitle","isForNewUser","Responsible","deadlineMeta","Deadline","isHovered","events","value","timeTrackingMeta","TimeTracking","isSheetShown","sheetBindProps","statusMeta","Status","withSeparator","createdDateMeta","emailMeta","EmailChip","wasFilled","fromTitle","dateTitle","ResultsChip","disk","FilesChip","attachFile","containsCommentFiles","CheckListChip","showCheckList","openCheckList","checklistSave","isProjectsEnabled","groupMeta","Group","GroupChip","accomplicesMeta","Accomplices","AccomplicesChip","changeAccomplices","auditorsMeta","Auditors","AuditorsChip","addAuditors","PlacementsChip","isFlowEnabled","flowMeta","Flow","FlowChip","stageTitle","Stage","epicTitle","Epic","storyPointsTitle","StoryPoints","tagsMeta","Tags","TagsChip","RemindersChip","reminder","crm","crmMeta","Crm","CrmChip","ParentTaskChip","Parent","SubTasksChip","RelatedTasksChip","GanttChip","ganttMeta","right","DatePlanChip","ReplicationChip","TimeTrackingChip","elapsedTime","UserFieldsChip","shouldShowUserFieldsChip","openUserFieldsHandler","field","getBindElement","getTargetContainer","main","primaryFields","getFields","WeakMap","allowsTimeTracking","numberOfElapsedTimes","projectFields","stageId","participantsFields","tagsFields","emailFields","email","from","dateTs","isBottomSheetShown","isDiskModuleInstalled","taskSettingsBindElement","isCopyMode","placeholderOptions","iconUrl","isReplicateTemplate","replicate","hasFilledUserFields","userFieldsManager","userFields","hasRequiredUserFields","hasMandatoryUserFields","shouldShowUserFields","renderSkeleton","AhaTaskSettingsMessagePopup","showTaskSettingsHint","previousTemplateId","handleTemplate","insertStoreTask","currentUser","deadlineTs","needsControl","matchesWorkTime","requireResult","requiredResult","getCopy","getTask","sendClickCreate","collabId","Collab","viewersCount","coexecutorsCount","dispatch","fileIds","list","maxDeadlineChanges","deadlineService","updateDeadlineChangeCount","entityTextEditor","Task","content","description","sendTaskView","externalExtensions","FullCardInit","FullCardHasChanges","handleHasChanges","unsubscribe","mapActions","fieldId","filledFields","addTask","checklists","error","add","handleCreationError","replace","sendAddTaskAnalytics","notifyGrid","copyTask","event","withSubTasks","sync","sendAddTaskFromTemplateAnalytics","message","NotifyGrid","BaseEvent","compatData","options","closeCheckList","userFieldsSlider","handleCloseTaskSettingsHint","handleEndResize","newWidth","cardWidth","validateCardWidth","updateFullCardWidth","save","width","isNaN","parseInt","handleResult","getData","hasChanges","JSON","stringify","tryClose","TryCloseFullCard","skeleton","skeletonPath","templateSkeletonPath","sendAddTask","Event","SubTaskAdd","checklistCount","checklistItemsCount","sendAddTaskWithCheckList","TaskCreate","PatternTaskCreate","ClosePopup","onOk","MessageBox","buttons","MessageBoxButtons","OK_CANCEL","okCaption","popupOptions","closeIcon","openedCards","TaskFullCard","constructor","params","relationIds","subTaskIds","relatedTaskIds","ganttTaskIds","isRelationTaskUpdated","keys","fieldsForReloadGrid","isFieldsForGridUpdated","it","initialTemplate","baseEvent","Uri","getUrl","setQueryParam","toString","requestMethod","onCloseComplete","closeCompleteUrl","location","href","HistoryGrid","openHistoryGrid","templateHistoryGrid","contentCallback","slider","exports","TemplateHistoryGrid","popup","getCompatData","document","body","onScroll","adjustPosition","unbind","bind","fromEntries","isUndefined","Text","getRandom","boxTemplate","isOpened","isOpen","queryParams","link","url","getQueryParams","TaskMappers","mapSliderDataToModel","getRequestParams","SCOPE","defaultCollab","undefined","getContentContainer","Util","fireGlobalTaskEvent","ID","STAY_AT_PAGE","allChanges","denyAction","dialog","init","application","createApp","isNil","mixin","locMixin","use","getStore","FullCardClosed","TaskAdded","TaskBeforeUpdate","TemplateAdded","TemplateBeforeUpdate","OpenViewSliderCard","OpenCompactCard","OpenGrid","OpenTemplateHistory","OpenHistory","forEach","isInteger","taskUrl","setMinimizeOptions","entityType","entityName","entityId","setUrl","resetBrowserHistory","isStringFilled","setTitle","updateBrowserTitle"],"mappings":"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"}