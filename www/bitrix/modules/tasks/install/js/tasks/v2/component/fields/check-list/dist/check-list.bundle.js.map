{"version":3,"file":"check-list.bundle.js","sources":["../src/lib/check-list-meta.js","../src/components/check-list/check-list-stub.js","../src/components/check-list-popup/check-list-popup.js","../src/components/check-list-sheet/check-list-sheet.js","../src/lib/check-list-manager.js","../src/components/check-list-list/check-list-list.js","../src/lib/check-list-const.js","../src/lib/check-list-drag-manager.js","../src/lib/check-list-item-drag-manager.js","../src/lib/check-list-list-drag-manager.js","../src/components/check-list-widget/component/check-list-item-mixin.js","../src/components/check-list-widget/component/check-list-parent-item.js","../src/components/check-list-widget/component/check-list-checkbox.js","../src/components/check-list-widget/component/check-list-child-item.js","../src/components/check-list-widget/component/check-list-add-item.js","../src/components/check-list-widget/component/check-list-drop-list.js","../src/components/check-list-widget/component/check-list-drop-item.js","../src/components/check-list-widget/component/check-list-group-completed-list.js","../src/components/check-list-widget/check-list-widget.js","../src/components/check-list-item-panel/check-list-item-panel-meta.js","../src/components/check-list-item-panel/check-list-item-panel.js","../src/lib/check-list-notifier.js","../src/components/check-list/check-list.js","../src/check-list-chip.js"],"sourcesContent":["import { Loc } from 'main.core';\nimport { TaskField } from 'tasks.v2.const';\n\nexport const checkListMeta = Object.freeze({\n\tid: TaskField.CheckList,\n\ttitle: Loc.getMessage('TASKS_V2_CHECK_LIST_TITLE'),\n});\n","import { Button as UiButton, ButtonSize } from 'ui.vue3.components.button';\nimport { Outline } from 'ui.icon-set.api.vue';\n\n// @vue/component\nexport const CheckListStub = {\n\tname: 'CheckListStub',\n\tcomponents: {\n\t\tUiButton,\n\t},\n\temits: ['click'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t\tOutline,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div class=\"check-list-stub\">\n\t\t\t<div class=\"check-list-stub-icon\"/>\n\t\t\t<div class=\"check-list-stub-title\">\n\t\t\t\t{{ loc('TASKS_V2_CHECK_LIST_STUB_TITLE') }}\n\t\t\t</div>\n\t\t\t<div class=\"check-list-stub-btn\">\n\t\t\t\t<UiButton\n\t\t\t\t\t:text=\"loc('TASKS_V2_CHECK_LIST_STUB_BTN')\"\n\t\t\t\t\t:size=\"ButtonSize.MEDIUM\"\n\t\t\t\t\t:leftIcon=\"Outline.PLUS_L\"\n\t\t\t\t\t@click=\"$emit('click')\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Event } from 'main.core';\nimport type { PopupOptions } from 'main.popup';\n\nimport { Popup } from 'ui.vue3.components.popup';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { EventName, Model } from 'tasks.v2.const';\n\nimport './check-list-popup.css';\n\n// @vue/component\nexport const CheckListPopup = {\n\tname: 'TaskCheckListPopup',\n\tcomponents: {\n\t\tPopup,\n\t},\n\tinject: {\n\t\ttaskId: {},\n\t},\n\tinheritAttrs: false,\n\temits: ['show', 'close', 'resize'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tresizeObserver: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `tasks-check-list-popup-${this.taskId}`;\n\t\t},\n\t\toptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tclassName: 'tasks-check-list-popup',\n\t\t\t\twidth: 580,\n\t\t\t\theight: 500,\n\t\t\t\tborderRadius: '18px',\n\t\t\t\toffsetTop: 0,\n\t\t\t\tpadding: 0,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tanimation: {\n\t\t\t\t\tshowClassName: 'tasks-check-list-popup-show',\n\t\t\t\t\tcloseClassName: 'tasks-check-list-popup-close',\n\t\t\t\t\tcloseAnimationType: 'animation',\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: this.handleClose,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\t...mapGetters({\n\t\t\ttitleFieldOffsetHeight: `${Model.Interface}/titleFieldOffsetHeight`,\n\t\t}),\n\t},\n\twatch: {\n\t\tasync titleFieldOffsetHeight(): Promise<void>\n\t\t{\n\t\t\tif (!this.$refs.childComponent)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.$nextTick();\n\n\t\t\tthis.resize();\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.resizeObserver = new ResizeObserver((entries: ResizeObserverEntry[]) => {\n\t\t\tfor (const entry of entries)\n\t\t\t{\n\t\t\t\tif (entry.target === this.$refs.wrapper)\n\t\t\t\t{\n\t\t\t\t\tthis.resize();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\tmounted(): void\n\t{\n\t\tEvent.bind(window, 'resize', this.resize);\n\n\t\tEvent.bind(document, 'keydown', this.handleKeyDown, { capture: true });\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tEvent.unbind(window, 'resize', this.resize);\n\n\t\tEvent.unbind(document, 'keydown', this.handleKeyDown, { capture: true });\n\t},\n\tmethods: {\n\t\tresize(): void\n\t\t{\n\t\t\tconst popupInstance = this.$refs.childComponent?.getPopupInstance();\n\t\t\tif (popupInstance)\n\t\t\t{\n\t\t\t\tthis.$emit('resize');\n\n\t\t\t\tpopupInstance.adjustPosition();\n\t\t\t}\n\t\t},\n\t\thandleShow(): void\n\t\t{\n\t\t\tthis.$emit('show', { popupInstance: this.$refs.childComponent.getPopupInstance() });\n\n\t\t\tthis.$refs.childComponent?.getPopupInstance().adjustPosition();\n\t\t\tsetTimeout(() => this.resizeObserver.observe(this.$parent.$refs.wrapper), 300);\n\t\t},\n\t\thandleClose(): void\n\t\t{\n\t\t\tthis.resizeObserver.disconnect();\n\t\t\tthis.$bitrix.eventEmitter.emit(EventName.CloseCheckList);\n\n\t\t\tthis.$emit('close');\n\t\t},\n\t\thandleKeyDown(event: KeyboardEvent): void\n\t\t{\n\t\t\tif (event.key === 'Escape')\n\t\t\t{\n\t\t\t\tthis.$emit('close');\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Popup :options ref=\"childComponent\">\n\t\t\t<slot :handleShow=\"handleShow\" :handleClose=\"handleClose\"/>\n\t\t</Popup>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { BottomSheet } from 'tasks.v2.component.elements.bottom-sheet';\n\n// @vue/component\nexport const CheckListSheet = {\n\tname: 'TaskCheckListSheet',\n\tcomponents: {\n\t\tBottomSheet,\n\t},\n\tprops: {\n\t\tisEmpty: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tsheetBindProps: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['show', 'close', 'isShown', 'addFastCheckList', 'resize'],\n\twatch: {\n\t\tasync isShown(value): void\n\t\t{\n\t\t\tawait this.$nextTick();\n\n\t\t\tif (value === true)\n\t\t\t{\n\t\t\t\tEvent.bind(document, 'keydown', this.handleKeyDown, { capture: true });\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tEvent.unbind(document, 'keydown', this.handleKeyDown, { capture: true });\n\t\t\t}\n\n\t\t\tthis.$emit('isShown', value);\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClose(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\thandleKeyDown(event: KeyboardEvent): void\n\t\t{\n\t\t\tif (event.key === 'Escape')\n\t\t\t{\n\t\t\t\tthis.handleClose();\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BottomSheet\n\t\t\tv-if=\"isShown\"\n\t\t\t:sheetBindProps\n\t\t\t:padding=\"0\"\n\t\t\t:popupPadding=\"0\"\n\t\t\t@close=\"handleClose\"\n\t\t>\n\t\t\t<slot :handleShow=\"$emit('show')\" :handleClose=\"handleClose\"/>\n\t\t</BottomSheet>\n\t`,\n};\n","import { Dom, Type } from 'main.core';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\nimport type { UserModel } from 'tasks.v2.model.users';\n\ntype Params = {\n\tcomputed?: {\n\t\tcheckLists: () => CheckListModel[],\n\t},\n};\n\nexport class CheckListManager\n{\n\t#params: Params;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\t}\n\n\tgetItem(itemId: number | string): ?CheckListModel\n\t{\n\t\treturn this.#getCheckLists().find((item: CheckListModel) => item.id === this.prepareItemId(itemId));\n\t}\n\n\tgetItems(itemIds: [number | string]): CheckListModel[]\n\t{\n\t\tconst itemIdsSet = new Set(itemIds);\n\n\t\treturn this.#getCheckLists().filter((item: CheckListModel) => itemIdsSet.has(item.id));\n\t}\n\n\tgetItemsOnLevel(parentId: number | string): CheckListModel[]\n\t{\n\t\treturn this.#getCheckLists()\n\t\t\t.filter((item: CheckListModel) => item.parentId === parentId)\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\t}\n\n\tgetItemLevel(checkListItem: CheckListModel): number\n\t{\n\t\tlet level = 0;\n\t\tlet current = checkListItem;\n\n\t\tconst visitedIds = new Set();\n\n\t\tconst findParent = (parentId) => this.#getCheckLists().find((item: CheckListModel) => item.id === parentId);\n\n\t\twhile (current.parentId !== 0)\n\t\t{\n\t\t\tif (visitedIds.has(current.id))\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tvisitedIds.add(current.id);\n\n\t\t\tcurrent = findParent(current.parentId);\n\t\t\tif (!current)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tlevel++;\n\t\t}\n\n\t\treturn level;\n\t}\n\n\tisParentItem(itemId: number | string): boolean\n\t{\n\t\tconst item = this.getItem(itemId);\n\n\t\treturn item && item.parentId === 0;\n\t}\n\n\tisItemDescendant(potentialAncestor: ?CheckListModel, item?: CheckListModel): boolean\n\t{\n\t\tif (item?.parentId === potentialAncestor?.id)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (item?.parentId === 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst parent = this.#getCheckLists().find((i: CheckListModel) => i.id === item?.parentId);\n\t\tif (!parent)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.isItemDescendant(potentialAncestor, parent);\n\t}\n\n\tshowItems(\n\t\titemIds: (number | string)[],\n\t\tupdateFn: (updates: CheckListModel[]) => void,\n\t): void\n\t{\n\t\tconst updates: CheckListModel[] = [];\n\n\t\titemIds.forEach((itemId: number | string) => this.#setItemsVisibility(itemId, false, updates));\n\n\t\tif (updates.length > 0)\n\t\t{\n\t\t\tupdateFn(updates);\n\t\t}\n\t}\n\n\thideItems(\n\t\titemIds: (number | string)[],\n\t\tupdateFn: (updates: CheckListModel[]) => void,\n\t): void\n\t{\n\t\tconst updates: CheckListModel[] = [];\n\n\t\titemIds.forEach((itemId: number | string) => this.#setItemsVisibility(itemId, true, updates));\n\n\t\tif (updates.length > 0)\n\t\t{\n\t\t\tupdateFn(updates);\n\t\t}\n\t}\n\n\tsyncParentCompletionState(\n\t\titemId: number | string,\n\t\tupdateFn: (id: string | number, fields: Partial<CheckListModel>) => void,\n\t\tparentItemId?: number | string,\n\t): void\n\t{\n\t\tconst changedItem = this.#getCheckLists().find((item: CheckListModel) => item.id === itemId);\n\n\t\tif ((!changedItem || !changedItem.parentId) && !parentItemId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst parentId = parentItemId || changedItem.parentId;\n\n\t\tconst parentItem = this.#getCheckLists().find((item: CheckListModel) => item.id === parentId);\n\t\tif (!parentItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst childrenItems = this.#getCheckLists().filter((item: CheckListModel) => item.parentId === parentItem.id);\n\t\tconst isEmptyParent = (childrenItems.length === 0);\n\n\t\tconst allChildrenCompleted = childrenItems.every((child: CheckListModel) => {\n\t\t\treturn child.localCompleteState ?? child.isComplete;\n\t\t});\n\t\tconst someChildrenIncomplete = !allChildrenCompleted;\n\n\t\tconst parentCompleted = parentItem.localCompleteState ?? parentItem.isComplete;\n\t\tconst shouldUpdateParent = (\n\t\t\tisEmptyParent\n\t\t\t|| (allChildrenCompleted && !parentCompleted)\n\t\t\t|| (someChildrenIncomplete && parentCompleted)\n\t\t);\n\t\tif (!shouldUpdateParent)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tupdateFn(parentItem.id, {\n\t\t\tisComplete: allChildrenCompleted && !isEmptyParent,\n\t\t});\n\n\t\tif (parentItem.parentId)\n\t\t{\n\t\t\tthis.syncParentCompletionState(parentItem.id, updateFn);\n\t\t}\n\t}\n\n\tgetAllGroupModeItems(): CheckListModel[]\n\t{\n\t\treturn this.#getCheckLists().filter((item: CheckListModel) => item.groupMode?.active === true);\n\t}\n\n\tgetAllSelectedItems(): CheckListModel[]\n\t{\n\t\treturn this.#getCheckLists().filter((item: CheckListModel) => {\n\t\t\treturn (item.parentId !== 0 && item.groupMode?.selected === true);\n\t\t});\n\t}\n\n\tgetAllSelectedItemsWithChildren(): CheckListModel[]\n\t{\n\t\tconst result = new Map();\n\n\t\tconst selectedItems = this.getAllSelectedItems();\n\t\tconst allItems = this.#getCheckLists();\n\n\t\tselectedItems.forEach((item: CheckListModel) => result.set(item.id, item));\n\n\t\tconst getChildren = (parentIds: (string | number)[]): void => {\n\t\t\tconst children = allItems.filter((item: CheckListModel) => {\n\t\t\t\treturn parentIds.includes(item.parentId) && !result.has(item.id);\n\t\t\t});\n\n\t\t\tchildren.forEach((child: CheckListModel) => result.set(child.id, child));\n\n\t\t\tif (children.length > 0)\n\t\t\t{\n\t\t\t\tgetChildren(children.map((child: CheckListModel) => child.id));\n\t\t\t}\n\t\t};\n\n\t\tgetChildren(selectedItems.map((item: CheckListModel) => item.id));\n\n\t\treturn [...result.values()];\n\t}\n\n\tgetAllChildren(itemId: number | string): CheckListModel[]\n\t{\n\t\tconst visited = new Set();\n\n\t\tconst result = [];\n\n\t\tconst collectChildren = (currentId: number | string) => {\n\t\t\tif (visited.has(currentId))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvisited.add(currentId);\n\n\t\t\tconst children = this.#getCheckLists()\n\t\t\t\t.filter((item: CheckListModel) => item.parentId === currentId)\n\t\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\n\t\t\tchildren.forEach((child: CheckListModel) => {\n\t\t\t\tif (!visited.has(child.id))\n\t\t\t\t{\n\t\t\t\t\tresult.push(child);\n\t\t\t\t\tcollectChildren(child.id);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tcollectChildren(itemId);\n\n\t\treturn result;\n\t}\n\n\tgetAllCompletedChildren(itemId: number | string): CheckListModel[]\n\t{\n\t\treturn this.getAllChildren(itemId).filter((item: CheckListModel) => {\n\t\t\treturn (item.localCompleteState ?? item.isComplete) === true;\n\t\t});\n\t}\n\n\tgetChildren(itemId: number | string): CheckListModel[]\n\t{\n\t\treturn this.#getCheckLists().filter((item: CheckListModel) => {\n\t\t\treturn item.parentId === itemId;\n\t\t});\n\t}\n\n\tgetSiblings(itemId: number | string, parentId: number | string): CheckListModel[]\n\t{\n\t\treturn this.#getCheckLists()\n\t\t\t.filter((sibling: CheckListModel) => sibling.parentId === parentId && sibling.id !== itemId)\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\t}\n\n\tresortItemsOnLevel(\n\t\tparentId: number | string,\n\t\tupdateFn: (updates: CheckListModel[]) => void,\n\t): void\n\t{\n\t\tconst allItems = this.#getCheckLists()\n\t\t\t.filter((item: CheckListModel) => item.parentId === parentId);\n\n\t\tconst sortedItems = [...allItems].sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\n\t\tconst updates = sortedItems\n\t\t\t.map((item: CheckListModel, newIndex: number) => ({\n\t\t\t\t...item,\n\t\t\t\tsortIndex: newIndex,\n\t\t\t}));\n\n\t\tif (updates.length > 0)\n\t\t{\n\t\t\tupdateFn(updates);\n\t\t}\n\t}\n\n\tresortItemsBeforeIndex(\n\t\tparentId: number | string,\n\t\tsortIndex: number,\n\t\tupdateFn: (updates: CheckListModel[]) => void,\n\t): void\n\t{\n\t\tconst allItems = this.#getCheckLists()\n\t\t\t.filter((item: CheckListModel) => item.parentId === parentId);\n\n\t\tconst itemsToResort = allItems\n\t\t\t.filter((item: CheckListModel) => item.sortIndex <= sortIndex)\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\n\t\tconst updates = itemsToResort\n\t\t\t.map((item: CheckListModel, index: number) => ({\n\t\t\t\t...item,\n\t\t\t\tsortIndex: index,\n\t\t\t}));\n\n\t\tupdateFn(updates);\n\t}\n\n\tresortItemsAfterIndex(\n\t\tparentId: number | string,\n\t\tsortIndex: number,\n\t\tupdateFn: (updates: CheckListModel[]) => void,\n\t): void\n\t{\n\t\tconst allItems = this.#getCheckLists()\n\t\t\t.filter((item: CheckListModel) => item.parentId === parentId);\n\n\t\tconst itemsToResort = allItems\n\t\t\t.filter((item: CheckListModel) => item.sortIndex >= sortIndex)\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\n\t\tconst updates = itemsToResort\n\t\t\t.map((item: CheckListModel, index: number) => ({\n\t\t\t\t...item,\n\t\t\t\tsortIndex: (sortIndex + 1) + index,\n\t\t\t}));\n\n\t\tupdateFn(updates);\n\t}\n\n\tmoveRight(item: CheckListModel, updateFn: (updates: CheckListModel[]) => void): void\n\t{\n\t\tif (item.parentId === 0 || this.getItemLevel(item) > 5)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst itemsOnLevel = this.getItemsOnLevel(item.parentId);\n\n\t\tconst currentIndex = itemsOnLevel.findIndex((sibling: CheckListModel) => sibling.id === item.id);\n\t\tif (currentIndex <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet newParent = null;\n\t\tfor (let i = currentIndex - 1; i >= 0; i--)\n\t\t{\n\t\t\tconst candidate = itemsOnLevel[i];\n\t\t\tif (!this.isItemDescendant(candidate, item))\n\t\t\t{\n\t\t\t\tnewParent = candidate;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!newParent)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newParentChildren = this.#getCheckLists()\n\t\t\t.filter((child: CheckListModel) => child.parentId === newParent.id)\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\n\t\tconst updates = itemsOnLevel\n\t\t\t.filter((sibling: CheckListModel, index: number) => index > currentIndex)\n\t\t\t.map((sibling: CheckListModel) => ({\n\t\t\t\t...sibling,\n\t\t\t\tsortIndex: sibling.sortIndex - 1,\n\t\t\t}));\n\n\t\tupdates.push({\n\t\t\t...item,\n\t\t\tparentId: newParent.id,\n\t\t\tparentNodeId: newParent.nodeId,\n\t\t\tsortIndex: newParentChildren.length > 0\n\t\t\t\t? newParentChildren[newParentChildren.length - 1].sortIndex + 1\n\t\t\t\t: 0,\n\t\t});\n\n\t\tupdateFn(updates);\n\t}\n\n\tmoveLeft(item: CheckListModel, updateFn: (updates: CheckListModel[]) => void): void\n\t{\n\t\tif (item.parentId === 0 || this.getItemLevel(item) <= 1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentParent = this.#getCheckLists().find((parent: CheckListModel) => parent.id === item.parentId);\n\t\tif (!currentParent)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst itemsOnLevel = this.getItemsOnLevel(currentParent.parentId);\n\n\t\tconst parentInNewListIndex = itemsOnLevel\n\t\t\t.findIndex((sibling: CheckListModel) => sibling.id === currentParent.id);\n\n\t\tconst currentSiblingsUpdates = this.#getCheckLists()\n\t\t\t.filter((sibling: CheckListModel) => (\n\t\t\t\tsibling.parentId === item.parentId\n\t\t\t\t&& sibling.sortIndex > item.sortIndex\n\t\t\t))\n\t\t\t.map((sibling: CheckListModel) => ({\n\t\t\t\t...sibling,\n\t\t\t\tsortIndex: sibling.sortIndex - 1,\n\t\t\t}));\n\n\t\tlet newSortIndex = 0;\n\t\tif (\n\t\t\tparentInNewListIndex === -1\n\t\t\t|| parentInNewListIndex === itemsOnLevel.length - 1\n\t\t)\n\t\t{\n\t\t\tnewSortIndex = itemsOnLevel.length > 0 ? itemsOnLevel[itemsOnLevel.length - 1].sortIndex + 1 : 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewSortIndex = itemsOnLevel[parentInNewListIndex].sortIndex + 1;\n\n\t\t\tconst shiftUpdates = itemsOnLevel\n\t\t\t\t.filter((sibling: CheckListModel) => sibling.sortIndex >= newSortIndex)\n\t\t\t\t.map((sibling: CheckListModel) => ({\n\t\t\t\t\t...sibling,\n\t\t\t\t\tsortIndex: sibling.sortIndex + 1,\n\t\t\t\t}));\n\n\t\t\tcurrentSiblingsUpdates.push(...shiftUpdates);\n\t\t}\n\n\t\tconst movedItemUpdate = {\n\t\t\t...item,\n\t\t\tparentId: currentParent.parentId,\n\t\t\tparentNodeId: currentParent.parentNodeId || null,\n\t\t\tsortIndex: newSortIndex,\n\t\t};\n\n\t\tupdateFn([...currentSiblingsUpdates, movedItemUpdate]);\n\t}\n\n\tfindNearestItem(\n\t\tinitialItem: CheckListModel,\n\t\tselected: boolean,\n\t\texcludeChildrenOf: CheckListModel[] = [],\n\t): ?CheckListModel\n\t{\n\t\tif (!initialItem)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst rootParent = this.#getRootParent(initialItem);\n\t\tif (!rootParent)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst currentSortIndex = initialItem.sortIndex;\n\n\t\tconst excludedParentIds = new Set(excludeChildrenOf.map((item: CheckListModel) => item.id));\n\n\t\tconst eligibleItems = this.#getCheckLists()\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex)\n\t\t\t.filter((item: CheckListModel) => {\n\t\t\t\tconst isChildOfExcluded = excludedParentIds.has(item.parentId);\n\n\t\t\t\treturn (\n\t\t\t\t\titem.id !== initialItem.id\n\t\t\t\t\t&& item.parentId !== 0\n\t\t\t\t\t&& item.groupMode?.selected === selected\n\t\t\t\t\t&& this.#getRootParent(item)?.id === rootParent.id\n\t\t\t\t\t&& !isChildOfExcluded\n\t\t\t\t);\n\t\t\t});\n\n\t\tif (eligibleItems.length === 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn eligibleItems.reduce((nearest: CheckListModel, item: CheckListModel) => {\n\t\t\treturn (\n\t\t\t\titem.sortIndex > currentSortIndex\n\t\t\t\t&& (\n\t\t\t\t\titem.sortIndex < nearest.sortIndex\n\t\t\t\t\t|| nearest.sortIndex <= currentSortIndex\n\t\t\t\t)\n\t\t\t) ? item : nearest;\n\t\t});\n\t}\n\n\tgetFirstVisibleChild(itemId: number | string): ?CheckListModel\n\t{\n\t\tconst children = this.#getCheckLists()\n\t\t\t.filter((item: CheckListModel) => item.parentId === itemId && !item.hidden)\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\n\t\treturn children[0] || null;\n\t}\n\n\tgetEmptiesItem(): CheckListModel[]\n\t{\n\t\treturn this.#getCheckLists().filter((item: CheckListModel) => {\n\t\t\treturn item.title === '';\n\t\t});\n\t}\n\n\thasEmptyItemWithFiles(hasItemFiles: (item: CheckListModel) => boolean): boolean\n\t{\n\t\treturn this.#getCheckLists().some((item: CheckListModel) => {\n\t\t\treturn item.title === '' && hasItemFiles(item);\n\t\t});\n\t}\n\n\thasEmptyParentItem(): boolean\n\t{\n\t\treturn this.#getCheckLists().some((item: CheckListModel) => {\n\t\t\treturn item.parentId === 0 && item.title === '';\n\t\t});\n\t}\n\n\tgetFirstEmptyItem(): ?CheckListModel\n\t{\n\t\tconst items = this.#getCheckLists()\n\t\t\t.filter((item: CheckListModel) => item.title === '')\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\n\t\treturn items[0] || null;\n\t}\n\n\tgetChildWithEmptyTitle(itemId: number | string): ?CheckListModel\n\t{\n\t\tconst children = this.#getCheckLists()\n\t\t\t.filter((item: CheckListModel) => item.parentId === itemId)\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => b.sortIndex - a.sortIndex)\n\t\t\t.find((item: CheckListModel) => item.title === '');\n\n\t\treturn children || null;\n\t}\n\n\tisItemCollapsed(item: CheckListModel, isPreview: boolean, positionIndex: number): boolean\n\t{\n\t\tif (\n\t\t\t!Type.isNull(item.localCollapsedState)\n\t\t\t&& !Type.isUndefined(item.localCollapsedState)\n\t\t)\n\t\t{\n\t\t\treturn item.localCollapsedState;\n\t\t}\n\n\t\tif (!isPreview)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (item.collapsed && !item.expanded)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (item.expanded)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn positionIndex !== 0;\n\t}\n\n\tgetRootParentByChildId(itemId: number | string): ?CheckListModel\n\t{\n\t\tconst childItem = this.getItem(itemId);\n\t\tif (!childItem)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (childItem.parentId === 0)\n\t\t{\n\t\t\treturn childItem;\n\t\t}\n\n\t\tlet currentItem = childItem;\n\n\t\tconst visitedIds = new Set();\n\n\t\twhile (currentItem && currentItem.parentId !== 0)\n\t\t{\n\t\t\tif (visitedIds.has(currentItem.id))\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tvisitedIds.add(currentItem.id);\n\n\t\t\tconst parent = this.getItem(currentItem.parentId);\n\t\t\tif (!parent)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcurrentItem = parent;\n\t\t}\n\n\t\treturn currentItem?.parentId === 0 ? currentItem : null;\n\t}\n\n\texpandIdsWithChildren(itemIds: Set<string | number>): Set<string | number>\n\t{\n\t\tconst fullSet = new Set(itemIds);\n\n\t\tif (itemIds.size === 0 || this.#getCheckLists().length === 0)\n\t\t{\n\t\t\treturn fullSet;\n\t\t}\n\n\t\tconst checkListMap = new Map(this.#getCheckLists().map((item: CheckListModel) => [item.id, item]));\n\n\t\tconst processedIds = new Set();\n\n\t\titemIds.forEach((id: string | number) => {\n\t\t\tif (!processedIds.has(id))\n\t\t\t{\n\t\t\t\tthis.#findNestedChildren(id, checkListMap, fullSet, processedIds);\n\t\t\t}\n\t\t});\n\n\t\treturn fullSet;\n\t}\n\n\tfindItemIdsWithUser(rootId: number | string, userId: number): Set<string | number>\n\t{\n\t\tconst allItems = this.getAllChildren(rootId);\n\t\tconst rootItem = this.getItem(rootId);\n\n\t\tif (rootItem)\n\t\t{\n\t\t\tallItems.unshift(rootItem);\n\t\t}\n\n\t\tconst result = new Set();\n\t\tallItems.forEach((item: CheckListModel) => {\n\t\t\tconst hasUser = (\n\t\t\t\titem.accomplices?.some((user: UserModel) => user.id === userId)\n\t\t\t\t|| item.auditors?.some((user: UserModel) => user.id === userId)\n\t\t\t);\n\n\t\t\tif (hasUser && item.parentId !== 0)\n\t\t\t{\n\t\t\t\tresult.add(item.id);\n\t\t\t}\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tprepareItemId(itemId: number | string): number | string\n\t{\n\t\tconst num = parseInt(itemId, 10);\n\n\t\tconst isStringExactlyAnInteger = !Number.isNaN(num) && num.toString() === itemId;\n\n\t\treturn isStringExactlyAnInteger ? parseInt(itemId, 10) : itemId;\n\t}\n\n\tisFirstItemHigherLevelThan(firstItem: CheckListModel, secondItem: CheckListModel): boolean\n\t{\n\t\tconst firstItemLevel = this.getItemLevel(firstItem);\n\t\tconst secondItemLevel = this.getItemLevel(secondItem);\n\n\t\treturn firstItemLevel < secondItemLevel;\n\t}\n\n\thasItemChildren(item: CheckListModel): boolean\n\t{\n\t\treturn this.#getCheckLists().some((child: CheckListModel) => child.parentId === item.id);\n\t}\n\n\tisItemCompleted(item: CheckListModel): boolean\n\t{\n\t\treturn item.localCompleteState ?? item.isComplete;\n\t}\n\n\tscrollToCheckList(container: HTMLElement, checkListId: number | string, behavior: string = 'instant'): void\n\t{\n\t\tlet scrollContainer = container.closest('[data-task-card-scroll]');\n\t\tif (!scrollContainer)\n\t\t{\n\t\t\tscrollContainer = container.querySelector('[data-task-card-scroll]');\n\t\t}\n\t\tconst checkListNode = container.querySelector([`[data-id=\"${checkListId}\"]`]);\n\n\t\tif (scrollContainer && checkListNode)\n\t\t{\n\t\t\tconst checkListRect = Dom.getPosition(checkListNode);\n\t\t\tconst containerRect = Dom.getPosition(scrollContainer);\n\n\t\t\tconst offsetTopInsideContainer = (\n\t\t\t\tcheckListRect.top\n\t\t\t\t- containerRect.top\n\t\t\t\t+ scrollContainer.scrollTop\n\t\t\t);\n\n\t\t\tscrollContainer.scrollTo({\n\t\t\t\ttop: offsetTopInsideContainer - 200,\n\t\t\t\tbehavior,\n\t\t\t});\n\t\t}\n\t}\n\n\thandleTargetParentFilter(\n\t\tmovedItem: CheckListModel,\n\t\tcurrentUserId: number,\n\t\tupdateFn: (updates: CheckListModel[]) => void,\n\t): boolean\n\t{\n\t\tconst itemIdsToUpdateInNewParent = new Map();\n\t\tconst targetParentItem = this.getRootParentByChildId(movedItem.id);\n\t\tconst draggedChildren = this.#getDraggedChildren(movedItem);\n\n\t\tthis.#processCompletedFilter(movedItem, targetParentItem, itemIdsToUpdateInNewParent);\n\t\tdraggedChildren.forEach((child: CheckListModel) => {\n\t\t\tthis.#processCompletedFilter(child, targetParentItem, itemIdsToUpdateInNewParent);\n\t\t});\n\n\t\tconst myItemIds = this.findItemIdsWithUser(targetParentItem.id, currentUserId);\n\t\tthis.#processUserFilter(movedItem, targetParentItem, myItemIds, itemIdsToUpdateInNewParent);\n\t\tdraggedChildren.forEach((child: CheckListModel) => {\n\t\t\tthis.#processUserFilter(child, targetParentItem, myItemIds, itemIdsToUpdateInNewParent);\n\t\t});\n\n\t\tthis.#applyVisibilityChanges(itemIdsToUpdateInNewParent, updateFn);\n\n\t\treturn true;\n\t}\n\n\t#getDraggedChildren(movedItem: CheckListModel): CheckListModel[]\n\t{\n\t\treturn this.getAllChildren(movedItem.id);\n\t}\n\n\t#processCompletedFilter(\n\t\titem: CheckListModel,\n\t\ttargetParentItem: any,\n\t\titemIdsMap: Map<string | number, string>,\n\t): void\n\t{\n\t\tif (targetParentItem.areCompletedCollapsed && this.isItemCompleted(item))\n\t\t{\n\t\t\titemIdsMap.set(item.id, 'hide');\n\t\t}\n\n\t\tif (!targetParentItem.areCompletedCollapsed && this.isItemCompleted(item))\n\t\t{\n\t\t\titemIdsMap.set(item.id, 'show');\n\t\t}\n\t}\n\n\t#processUserFilter(\n\t\titem: CheckListModel,\n\t\ttargetParentItem: any,\n\t\tmyItemIds: Set<string | number>,\n\t\titemIdsMap: Map<string | number, string>,\n\t): void\n\t{\n\t\tif (targetParentItem.myFilterActive && !myItemIds.has(item.id))\n\t\t{\n\t\t\titemIdsMap.set(item.id, 'hide');\n\t\t}\n\n\t\tif (\n\t\t\t!targetParentItem.myFilterActive\n\t\t\t&& myItemIds.has(item.id)\n\t\t\t&& !itemIdsMap.has(item.id)\n\t\t)\n\t\t{\n\t\t\titemIdsMap.set(item.id, 'show');\n\t\t}\n\t}\n\n\t#applyVisibilityChanges(\n\t\titemIdsToUpdateInNewParent: Map<string | number, string>,\n\t\tupdateFn: (updates: CheckListModel[]) => void,\n\t): void\n\t{\n\t\tconst { hideIds, showIds } = this.#splitIdsByAction(itemIdsToUpdateInNewParent);\n\n\t\tconst updates = this.#createVisibilityUpdates(hideIds, showIds);\n\t\tif (updates.length > 0)\n\t\t{\n\t\t\tupdateFn(updates);\n\t\t}\n\t}\n\n\t#splitIdsByAction(itemIdsMap: Map<string | number, string>): Object\n\t{\n\t\tconst hideIds = [];\n\t\tconst showIds = [];\n\n\t\tfor (const [id, action] of itemIdsMap)\n\t\t{\n\t\t\tif (action === 'hide')\n\t\t\t{\n\t\t\t\thideIds.push(id);\n\t\t\t}\n\t\t\telse if (action === 'show')\n\t\t\t{\n\t\t\t\tshowIds.push(id);\n\t\t\t}\n\t\t}\n\n\t\treturn { hideIds, showIds };\n\t}\n\n\t#createVisibilityUpdates(hideIds: Array<string | number>, showIds: Array<string | number>): CheckListModel[]\n\t{\n\t\tconst updates = [];\n\n\t\tthis.getItems(showIds).forEach((item: CheckListModel) => {\n\t\t\tupdates.push({ ...item, hidden: false });\n\t\t});\n\n\t\tthis.getItems(hideIds).forEach((item: CheckListModel) => {\n\t\t\tupdates.push({ ...item, hidden: true });\n\t\t});\n\n\t\treturn updates;\n\t}\n\n\t#setItemsVisibility(\n\t\titemId: number | string,\n\t\thidden: boolean,\n\t\tupdates: CheckListModel[],\n\t): void\n\t{\n\t\tconst item = this.getItem(itemId);\n\t\tif (!item || item.hidden === hidden)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst updatedItem = { ...item, hidden };\n\t\tupdates.push(updatedItem);\n\n\t\tconst children = this.getChildren(itemId);\n\t\tchildren.forEach((child: CheckListModel) => {\n\t\t\tthis.#setItemsVisibility(child.id, hidden, updates);\n\t\t});\n\t}\n\n\t#findNestedChildren(\n\t\tparentId: string | number,\n\t\tcheckListMap: Map<string | number, CheckListModel>,\n\t\tresultSet: Set<string | number>,\n\t\tprocessedIds: Set<string | number>,\n\t): void\n\t{\n\t\tif (processedIds.has(parentId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tprocessedIds.add(parentId);\n\n\t\tcheckListMap.forEach((item: CheckListModel) => {\n\t\t\tif (item.parentId === parentId && !resultSet.has(item.id))\n\t\t\t{\n\t\t\t\tresultSet.add(item.id);\n\n\t\t\t\tthis.#findNestedChildren(item.id, checkListMap, resultSet, processedIds);\n\t\t\t}\n\t\t});\n\t}\n\n\t#getRootParent(item: CheckListModel): ?CheckListModel\n\t{\n\t\tif (!item || item.parentId === 0)\n\t\t{\n\t\t\treturn item || null;\n\t\t}\n\n\t\tconst parentItem = this.#getCheckLists().find((parent: CheckListModel) => parent.id === item.parentId);\n\t\tif (!parentItem)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.#getRootParent(parentItem);\n\t}\n\n\t#getCheckLists(): CheckListModel[]\n\t{\n\t\treturn this.#params?.computed?.checkLists() ?? [];\n\t}\n}\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { hint, type HintParams } from 'ui.vue3.directives.hint';\nimport { BIcon, Animated, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.animated';\nimport 'ui.icon-set.outline';\n\nimport { Model } from 'tasks.v2.const';\nimport { checkListService } from 'tasks.v2.provider.service.check-list-service';\nimport { tooltip } from 'tasks.v2.component.elements.hint';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\n\nimport { CheckListManager } from '../../lib/check-list-manager';\nimport { checkListMeta } from '../../lib/check-list-meta';\n\nimport './check-list-list.css';\n\n// @vue/component\nexport const CheckListList = {\n\tname: 'TaskCheckListList',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tdirectives: { hint },\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t\tisEdit: {},\n\t},\n\tprops: {\n\t\tisEmpty: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['open', 'addFastCheckList'],\n\tsetup(): { task: TaskModel }\n\t{\n\t\treturn {\n\t\t\tAnimated,\n\t\t\tOutline,\n\t\t\tcheckListMeta,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisLoading: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tdeletingCheckListIds: `${Model.Interface}/deletingCheckListIds`,\n\t\t\tdisableCheckListAnimations: `${Model.Interface}/disableCheckListAnimations`,\n\t\t}),\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist);\n\t\t},\n\t\tisFilledEmpty(): boolean\n\t\t{\n\t\t\treturn this.checkListLength === 0 && this.task.filledFields[checkListMeta.id];\n\t\t},\n\t\tcheckListLength(): number\n\t\t{\n\t\t\tconst deletingRootIds = Object.values(this.deletingCheckListIds);\n\n\t\t\tconst deletingIds = new Set();\n\n\t\t\tdeletingRootIds.forEach((rootId: string | number) => {\n\t\t\t\tdeletingIds.add(rootId);\n\n\t\t\t\tthis.checkListManager\n\t\t\t\t\t.getAllChildren(rootId)\n\t\t\t\t\t.forEach((child: CheckListModel) => {\n\t\t\t\t\t\tdeletingIds.add(child.id);\n\t\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn this.checkLists.filter(({ id }) => !deletingIds.has(id)).length;\n\t\t},\n\t\tcontainsChecklist(): boolean\n\t\t{\n\t\t\treturn this.task.containsChecklist;\n\t\t},\n\t\tloading(): boolean\n\t\t{\n\t\t\treturn this.isLoading === true;\n\t\t},\n\t\tcanCheckListAdd(): boolean\n\t\t{\n\t\t\tif (!this.isEdit)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn this.task.rights.checklistAdd;\n\t\t},\n\t\taddTooltip(): Function\n\t\t{\n\t\t\treturn (): HintParams => tooltip({\n\t\t\t\ttext: this.loc('TASKS_V2_CHECK_LIST_STUB_BTN'),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\toffsetLeft: this.$refs.stubAddIcon.$el.offsetWidth / 2,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t},\n\tasync created(): void\n\t{\n\t\tthis.checkListManager = new CheckListManager({\n\t\t\tcomputed: {\n\t\t\t\tcheckLists: () => this.checkLists,\n\t\t\t},\n\t\t});\n\n\t\tif (this.containsChecklist && this.checkLists.length === 0)\n\t\t{\n\t\t\tthis.isLoading = true;\n\n\t\t\tawait this.loadData();\n\n\t\t\tthis.isLoading = false;\n\t\t}\n\t},\n\tmethods: {\n\t\tasync loadData(): Promise<void>\n\t\t{\n\t\t\tawait checkListService.load(this.taskId);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"tasks-check-list-list\"\n\t\t\t:class=\"{ '--default': loading || isFilledEmpty }\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"tasks-check-list-list-content\"\n\t\t\t\t:class=\"{ '--default': loading || isFilledEmpty }\"\n\t\t\t>\n\t\t\t\t<div v-if=\"loading\" class=\"tasks-check-list-list-transition-content\">\n\t\t\t\t\t<div class=\"tasks-check-list-list-content-row\">\n\t\t\t\t\t\t<BIcon :name=\"Animated.LOADER_WAIT\"/>\n\t\t\t\t\t\t<div class=\"tasks-check-list-list-content-text\">\n\t\t\t\t\t\t\t{{ loc('TASKS_V2_CHECK_LIST_LOADING') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<Transition name=\"check-list-fade\" mode=\"in-out\" :css=\"!disableCheckListAnimations\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"!loading && isFilledEmpty\"\n\t\t\t\t\t\tkey=\"empty\"\n\t\t\t\t\t\tclass=\"tasks-check-list-list-transition-content\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"tasks-check-list-list-content-row --stub\"\n\t\t\t\t\t\t\t@click=\"() => canCheckListAdd && $emit('addFastCheckList')\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"tasks-check-list-list-content-row-main\">\n\t\t\t\t\t\t\t\t<BIcon :name=\"Outline.CHECK_LIST\"/>\n\t\t\t\t\t\t\t\t<div class=\"tasks-check-list-list-content-text\">\n\t\t\t\t\t\t\t\t\t{{ loc('TASKS_V2_CHECK_LIST_CHIP_TITLE') }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-check-list-list-content-row-icon\">\n\t\t\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t\t\tv-if=\"canCheckListAdd\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-check-list-list-add\"\n\t\t\t\t\t\t\t\t\tv-hint=\"addTooltip\"\n\t\t\t\t\t\t\t\t\t:name=\"Outline.PLUS_L\"\n\t\t\t\t\t\t\t\t\thoverable\n\t\t\t\t\t\t\t\t\tref=\"stubAddIcon\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</Transition>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!loading && !isFilledEmpty\"\n\t\t\t\t\tkey=\"content\"\n\t\t\t\t\tclass=\"tasks-check-list-list-transition-content\"\n\t\t\t\t>\n\t\t\t\t\t<slot/>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"canCheckListAdd\"\n\t\t\t\t\t\tclass=\"tasks-check-list-list-content-row --footer\"\n\t\t\t\t\t\t@click=\"$emit('addFastCheckList')\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"tasks-check-list-list-content-btn\"\n\t\t\t\t\t\t\t:class=\"{ '--empty': isEmpty }\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<BIcon :name=\"Outline.PLUS_L\"/>\n\t\t\t\t\t\t\t<div class=\"tasks-check-list-list-content-btn-text\">\n\t\t\t\t\t\t\t\t{{ loc('TASKS_V2_CHECK_LIST_ADD_LABEL') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export const Context = Object.freeze({\n\tSheet: 'sheet',\n\tPopup: 'popup',\n\tPreview: 'preview',\n});\n","import { EventEmitter } from 'main.core.events';\nimport { Model } from 'tasks.v2.const';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\n\nimport type { CheckListManager } from './check-list-manager';\n\nexport type Params = {\n\tstore: any,\n\tcheckListManager: CheckListManager,\n\tcanAddItem?: boolean,\n\tstubItemId?: string,\n\tcurrentUserId?: string,\n};\n\nexport class CheckListDragManager extends EventEmitter\n{\n\t#store;\n\t#checkListManager;\n\n\t#stubItemId: string;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('Tasks.V2.CheckList.CheckListDragManager');\n\n\t\tthis.#store = params.store;\n\t\tthis.#checkListManager = params.checkListManager;\n\n\t\tthis.#stubItemId = params.stubItemId;\n\t}\n\n\tmoveDropPreview(\n\t\tdraggedItem: CheckListModel,\n\t\toveredItem: CheckListModel,\n\t\tdirectionFromBottom: boolean,\n\t\tisSameLevelMove: boolean,\n\t): void\n\t{\n\t\tlet tmpDraggedIndex = (\n\t\t\tdirectionFromBottom\n\t\t\t\t? this.#calculateAfterSortIndex(overedItem) - 0.5\n\t\t\t\t: this.#calculateBeforeSortIndex(overedItem) + 0.5\n\t\t);\n\n\t\tif (!isSameLevelMove)\n\t\t{\n\t\t\tconst isDraggedItemHigher = this.#checkListManager.isFirstItemHigherLevelThan(draggedItem, overedItem);\n\t\t\tconst isOverStubItem = overedItem.id === this.#stubItemId;\n\t\t\tif (!isDraggedItemHigher && !isOverStubItem)\n\t\t\t{\n\t\t\t\ttmpDraggedIndex = this.#calculateBeforeSortIndex(overedItem) + 0.5;\n\n\t\t\t\tvoid this.#store.dispatch(`${Model.CheckList}/update`, {\n\t\t\t\t\tid: overedItem.id,\n\t\t\t\t\tfields: { sortIndex: tmpDraggedIndex + 1 },\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tvoid this.#store.dispatch(`${Model.CheckList}/update`, {\n\t\t\tid: draggedItem.id,\n\t\t\tfields: {\n\t\t\t\tsortIndex: tmpDraggedIndex,\n\t\t\t\tparentId: overedItem.parentId,\n\t\t\t},\n\t\t});\n\t}\n\n\tresortLevelDependingOnPosition(\n\t\tdraggedItem: CheckListModel,\n\t\toveredItem: CheckListModel,\n\t\tdirectionFromBottom: boolean,\n\t\tisSameLevelMove: boolean,\n\t): void\n\t{\n\t\tlet newDraggedSortIndex = (\n\t\t\tdirectionFromBottom\n\t\t\t\t? this.#calculateAfterSortIndex(overedItem)\n\t\t\t\t: this.#calculateBeforeSortIndex(overedItem)\n\t\t);\n\n\t\tlet levelResort = false;\n\t\tif (!isSameLevelMove)\n\t\t{\n\t\t\tconst isDraggedItemHigher = this.#checkListManager.isFirstItemHigherLevelThan(draggedItem, overedItem);\n\t\t\tif (!isDraggedItemHigher)\n\t\t\t{\n\t\t\t\tnewDraggedSortIndex = this.#calculateBeforeSortIndex(overedItem);\n\n\t\t\t\tlevelResort = true;\n\t\t\t}\n\t\t}\n\n\t\tif (levelResort)\n\t\t{\n\t\t\tthis.resortLevel(overedItem.parentId);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst updates: CheckListModel[] = [\n\t\t\t{\n\t\t\t\t...draggedItem,\n\t\t\t\tsortIndex: newDraggedSortIndex,\n\t\t\t\tparentId: overedItem.parentId,\n\t\t\t},\n\t\t];\n\n\t\tif (directionFromBottom)\n\t\t{\n\t\t\tthis.#checkListManager.resortItemsAfterIndex(\n\t\t\t\toveredItem.parentId,\n\t\t\t\tnewDraggedSortIndex,\n\t\t\t\t(resortUpdates: CheckListModel[]) => {\n\t\t\t\t\tthis.#store.dispatch(`${Model.CheckList}/upsertMany`, [...updates, ...resortUpdates]);\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#checkListManager.resortItemsBeforeIndex(\n\t\t\t\toveredItem.parentId,\n\t\t\t\tnewDraggedSortIndex,\n\t\t\t\t(resortUpdates: CheckListModel[]) => {\n\t\t\t\t\tthis.#store.dispatch(`${Model.CheckList}/upsertMany`, [...updates, ...resortUpdates]);\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t}\n\n\tresortLevel(parentId: number): void\n\t{\n\t\tthis.#checkListManager.resortItemsOnLevel(\n\t\t\tparentId,\n\t\t\t(updates: CheckListModel[]) => {\n\t\t\t\tthis.#store.dispatch(`${Model.CheckList}/upsertMany`, updates);\n\t\t\t},\n\t\t);\n\t}\n\n\t#calculateAfterSortIndex(item: CheckListModel): number\n\t{\n\t\treturn item.sortIndex + 1;\n\t}\n\n\t#calculateBeforeSortIndex(item: CheckListModel): number\n\t{\n\t\treturn item.sortIndex - 1;\n\t}\n}\n","import { Dom } from 'main.core';\nimport { DragEndEvent, Draggable, DragOverEvent } from 'ui.draganddrop.draggable';\n\nimport { Model } from 'tasks.v2.const';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\n\nimport { CheckListDragManager, type Params } from './check-list-drag-manager';\n\nexport class CheckListItemDragManager extends CheckListDragManager\n{\n\t#store;\n\t#checkListManager;\n\t#draggable;\n\t#draggedItem = {\n\t\titem: null,\n\t\tchildrenIds: [],\n\t\tenterDropzone: false,\n\t};\n\n\t#canAddItem: boolean;\n\t#stubItemId: string;\n\t#currentUserId: string;\n\t#isSameLevelMove: boolean = false;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.#store = params.store;\n\t\tthis.#checkListManager = params.checkListManager;\n\n\t\tthis.#canAddItem = params.canAddItem;\n\t\tthis.#stubItemId = params.stubItemId;\n\t\tthis.#currentUserId = params.currentUserId;\n\t}\n\n\tinit(container: HTMLElement, offsetX: number = 0, listDropzone: Array<HTMLElement> = []): void\n\t{\n\t\tthis.#draggable = new Draggable({\n\t\t\tcontainer,\n\t\t\tdraggable: '.check-list-draggable-item',\n\t\t\tdragElement: '.check-list-drag-item',\n\t\t\tdelay: 0,\n\t\t\ttype: Draggable.MOVE,\n\t\t\toffset: { x: offsetX },\n\t\t\tdropzone: listDropzone,\n\t\t});\n\n\t\tthis.#draggable.subscribe('beforeStart', this.#handleBeforeDragStart.bind(this));\n\t\tthis.#draggable.subscribe('start', this.#handleDragStart.bind(this));\n\t\tthis.#draggable.subscribe('over', this.#handleDragOver.bind(this));\n\t\tthis.#draggable.subscribe('end', this.#handleDragEnd.bind(this));\n\n\t\tthis.#draggable.subscribe('drop', this.#handleDropEnd.bind(this));\n\t\tthis.#draggable.subscribe('dropzone:enter', this.#handleDropZoneEnter.bind(this));\n\t\tthis.#draggable.subscribe('dropzone:out', this.#handleDropZoneOut.bind(this));\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.#draggable?.destroy();\n\t}\n\n\t#handleBeforeDragStart(event): void\n\t{\n\t\tconst data = event.getData();\n\t\tconst source = data?.source;\n\t\tconst dataset = source?.dataset;\n\t\tif (!dataset)\n\t\t{\n\t\t\tevent.preventDefault();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst draggedItemId = this.#checkListManager.prepareItemId(dataset.id);\n\t\tconst draggedItem = this.#checkListManager.getItem(draggedItemId);\n\t\tif (!draggedItem)\n\t\t{\n\t\t\tevent.preventDefault();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#store.dispatch(`${Model.Interface}/setDisableCheckListAnimations`, true);\n\t\tthis.#store.dispatch(`${Model.Interface}/setDraggedCheckListId`, draggedItem.id);\n\n\t\tthis.#draggedItem = {\n\t\t\titem: draggedItem,\n\t\t\tchildrenIds: [],\n\t\t\tenterDropzone: false,\n\t\t};\n\n\t\tif (this.#checkListManager.hasItemChildren(draggedItem))\n\t\t{\n\t\t\tDom.addClass(source, '--multiple-drag');\n\t\t}\n\t}\n\n\t#handleDragStart(): void\n\t{\n\t\tconst draggedItem: CheckListModel = this.#draggedItem.item;\n\n\t\tif (this.#checkListManager.hasItemChildren(draggedItem))\n\t\t{\n\t\t\tconst children: CheckListModel[] = this.#checkListManager.getAllChildren(draggedItem.id);\n\t\t\tthis.#draggedItem.childrenIds = children.map((child: CheckListModel) => child.id);\n\n\t\t\tthis.#checkListManager.hideItems(\n\t\t\t\tthis.#draggedItem.childrenIds,\n\t\t\t\t(updates: CheckListModel[]) => {\n\t\t\t\t\tthis.#store.dispatch(`${Model.CheckList}/upsertMany`, updates);\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t}\n\n\t#handleDragOver(event: DragOverEvent): void\n\t{\n\t\tconst { source: { dataset }, over, clientY } = event.getData();\n\n\t\tconst overedItem = this.#getItemByNode(over);\n\t\tif (overedItem)\n\t\t{\n\t\t\tconst isOverStubItem = overedItem.id === this.#stubItemId;\n\t\t\tconst draggedItemId = this.#checkListManager.prepareItemId(dataset.id);\n\t\t\tconst draggedItem = this.#checkListManager.getItem(draggedItemId);\n\t\t\tthis.#draggedItem.item = draggedItem;\n\n\t\t\tconst overedRootParent = this.#checkListManager.getRootParentByChildId(overedItem.id);\n\t\t\tconst draggedRootParent = this.#checkListManager.getRootParentByChildId(draggedItem.id);\n\n\t\t\tconst overedRootParentId = (isOverStubItem ? overedItem.parentId : overedRootParent.id);\n\n\t\t\tif (!this.#canAddItem && overedRootParentId !== draggedRootParent.id)\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst overMiddlePoint = this.#draggable.getElementMiddlePoint(over);\n\t\t\tconst direction = (clientY > overMiddlePoint.y) ? 1 : -1;\n\t\t\tlet directionFromBottom = (direction === 1);\n\n\t\t\tif (isOverStubItem)\n\t\t\t{\n\t\t\t\tdirectionFromBottom = false;\n\t\t\t}\n\n\t\t\tthis.#isSameLevelMove = draggedItem.parentId === overedItem.parentId;\n\t\t\tif (this.#isSameLevelMove)\n\t\t\t{\n\t\t\t\tvoid this.#handleItemMovingOnSameLevel(draggedItem, overedItem, directionFromBottom);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.#handleItemMovingOnBetweenLevel(draggedItem, overedItem, directionFromBottom);\n\t\t\t}\n\t\t}\n\t}\n\n\t#handleDragEnd(event: DragEndEvent): void\n\t{\n\t\tconst { source, source: { dataset } } = event.getData();\n\n\t\tconst draggedItemId = this.#checkListManager.prepareItemId(dataset.id);\n\t\tconst draggedItem = this.#checkListManager.getItem(draggedItemId);\n\n\t\tDom.removeClass(source, '--multiple-drag');\n\n\t\tif (this.#draggedItem.enterDropzone)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.resortLevel(draggedItem.parentId);\n\n\t\tthis.#handleDrop(draggedItem);\n\t}\n\n\t#handleDropEnd(event): void\n\t{\n\t\tconst { dropzone, source: { dataset } } = event.getData();\n\n\t\tconst draggedItemId = this.#checkListManager.prepareItemId(dataset.id);\n\t\tconst draggedItem = this.#checkListManager.getItem(draggedItemId);\n\n\t\tconst newParentId = this.#checkListManager.prepareItemId(dropzone.dataset.id);\n\n\t\tif (draggedItem.parentId !== newParentId)\n\t\t{\n\t\t\tthis.resortLevel(draggedItem.parentId);\n\t\t}\n\n\t\tvoid this.#store.dispatch(`${Model.CheckList}/update`, {\n\t\t\tid: draggedItem.id,\n\t\t\tfields: {\n\t\t\t\tsortIndex: this.#checkListManager.getChildren(newParentId).length + 1,\n\t\t\t\tparentId: newParentId,\n\t\t\t\thidden: false,\n\t\t\t},\n\t\t});\n\n\t\tthis.resortLevel(newParentId);\n\n\t\tthis.#handleDrop(draggedItem);\n\n\t\tDom.removeClass(dropzone, '--dropzone');\n\t}\n\n\t#handleDropZoneEnter(event): void\n\t{\n\t\tconst { dropzone, source: { dataset } } = event.getData();\n\t\tconst draggedItemId = this.#checkListManager.prepareItemId(dataset.id);\n\t\tconst draggedItem = this.#checkListManager.getItem(draggedItemId);\n\t\tif (!draggedItem)\n\t\t{\n\t\t\tevent.preventDefault();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#draggedItem.enterDropzone = true;\n\n\t\tthis.#checkListManager.hideItems(\n\t\t\t[draggedItemId],\n\t\t\t(updates: CheckListModel[]) => {\n\t\t\t\tthis.#store.dispatch(`${Model.CheckList}/upsertMany`, updates);\n\t\t\t},\n\t\t);\n\n\t\tDom.addClass(dropzone, '--dropzone');\n\t}\n\n\t#handleDropZoneOut(event): void\n\t{\n\t\tconst { dropzone, source: { dataset } } = event.getData();\n\t\tconst draggedItemId = this.#checkListManager.prepareItemId(dataset.id);\n\t\tconst draggedItem = this.#checkListManager.getItem(draggedItemId);\n\t\tif (!draggedItem)\n\t\t{\n\t\t\tevent.preventDefault();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#draggedItem.enterDropzone = false;\n\n\t\tthis.#checkListManager.showItems(\n\t\t\t[draggedItemId],\n\t\t\t(updates: CheckListModel[]) => {\n\t\t\t\tthis.#store.dispatch(`${Model.CheckList}/upsertMany`, updates);\n\t\t\t},\n\t\t);\n\n\t\tDom.removeClass(dropzone, '--dropzone');\n\t}\n\n\t#handleDrop(draggedItem: CheckListModel): void\n\t{\n\t\tconst draggedItemChanged = (\n\t\t\tdraggedItem.parentId !== this.#draggedItem.item.parentId\n\t\t\t|| draggedItem.sortIndex !== this.#draggedItem.item.sortIndex\n\t\t);\n\t\tif (draggedItemChanged)\n\t\t{\n\t\t\tthis.emit('update', draggedItem.id);\n\t\t}\n\n\t\tif (this.#draggedItem.childrenIds.length > 0)\n\t\t{\n\t\t\tthis.#checkListManager.showItems(\n\t\t\t\tthis.#draggedItem.childrenIds,\n\t\t\t\t(updates: CheckListModel[]) => {\n\t\t\t\t\tthis.#store.dispatch(`${Model.CheckList}/upsertMany`, updates);\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\tthis.#draggedItem = {\n\t\t\titem: null,\n\t\t\tchildrenIds: [],\n\t\t\tenterDropzone: false,\n\t\t};\n\n\t\tthis.#store.dispatch(`${Model.Interface}/setDraggedCheckListId`, null);\n\t\tthis.#store.dispatch(`${Model.Interface}/setDisableCheckListAnimations`, false);\n\n\t\tif (!this.#isSameLevelMove)\n\t\t{\n\t\t\tthis.#checkListManager.handleTargetParentFilter(\n\t\t\t\tdraggedItem,\n\t\t\t\tthis.#currentUserId,\n\t\t\t\t(updates: CheckListModel[]) => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.#store.dispatch(`${Model.CheckList}/upsertMany`, updates);\n\t\t\t\t\t}, 1000);\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\tthis.emit('end', draggedItem.id);\n\t}\n\n\tasync #handleItemMovingOnSameLevel(\n\t\tdraggedItem: CheckListModel,\n\t\toveredItem: CheckListModel,\n\t\tdirectionFromBottom: boolean,\n\t): Promise<void>\n\t{\n\t\tconst isFirstOnLevel = (overedItem.sortIndex === 0);\n\t\tconst numberOfItemPerLevel = this.#checkListManager.getChildren(overedItem.parentId).length;\n\t\tconst isSimpleAndLastOnLevel = (\n\t\t\toveredItem.sortIndex === (numberOfItemPerLevel - 1)\n\t\t\t&& !this.#checkListManager.hasItemChildren(overedItem)\n\t\t);\n\n\t\tconst shouldSkip = (\n\t\t\tMath.abs(draggedItem.sortIndex - overedItem.sortIndex) === 1\n\t\t\t&& !isFirstOnLevel\n\t\t\t&& !isSimpleAndLastOnLevel\n\t\t);\n\t\tif (shouldSkip)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.moveDropPreview(draggedItem, overedItem, directionFromBottom, true);\n\t\tthis.resortLevelDependingOnPosition(draggedItem, overedItem, directionFromBottom, true);\n\t}\n\n\tasync #handleItemMovingOnBetweenLevel(\n\t\tdraggedItem: CheckListModel,\n\t\toveredItem: CheckListModel,\n\t\tdirectionFromBottom: boolean,\n\t): void\n\t{\n\t\tconst previousParentId = draggedItem.parentId;\n\n\t\tthis.moveDropPreview(draggedItem, overedItem, directionFromBottom, false);\n\t\tthis.resortLevelDependingOnPosition(draggedItem, overedItem, directionFromBottom, false);\n\n\t\tthis.resortLevel(previousParentId);\n\t}\n\n\t#getItemByNode(node: HTMLElement): CheckListModel\n\t{\n\t\tconst itemId = this.#checkListManager.prepareItemId(node.dataset.id);\n\n\t\tconst isStubItem = itemId === this.#stubItemId;\n\t\tif (isStubItem)\n\t\t{\n\t\t\tconst parentId = this.#checkListManager.prepareItemId(node.dataset.parentId);\n\t\t\tconst sortIndex = (this.#checkListManager.getChildren(parentId).length);\n\n\t\t\treturn {\n\t\t\t\tid: this.#stubItemId,\n\t\t\t\tparentId,\n\t\t\t\tsortIndex,\n\t\t\t};\n\t\t}\n\n\t\treturn this.#checkListManager.getItem(itemId);\n\t}\n}\n","import { Dom } from 'main.core';\nimport { Model } from 'tasks.v2.const';\nimport { DragEndEvent, Draggable, DragOverEvent, DragStartEvent } from 'ui.draganddrop.draggable';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\nimport { CheckListDragManager } from './check-list-drag-manager';\nimport type { CheckListManager } from './check-list-manager';\n\ntype Params = {\n\tstore: any,\n\tcheckListManager: CheckListManager,\n};\n\nexport class CheckListListDragManager extends CheckListDragManager\n{\n\t#store;\n\t#checkListManager;\n\t#draggable;\n\t#draggedItem = null;\n\t#container: HTMLElement;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.#store = params.store;\n\t\tthis.#checkListManager = params.checkListManager;\n\t}\n\n\tinit(container: HTMLElement, offsetX: number = 0): void\n\t{\n\t\tthis.#container = container;\n\n\t\tthis.#draggable = new Draggable({\n\t\t\tcontainer: this.#container,\n\t\t\tdraggable: '.check-list-draggable-list',\n\t\t\tdragElement: '.check-list-drag-list',\n\t\t\tdelay: 0,\n\t\t\ttype: Draggable.MOVE,\n\t\t\toffset: { x: offsetX },\n\t\t});\n\n\t\tthis.#draggable.subscribe('beforeStart', this.#handleBeforeDragStart.bind(this));\n\t\tthis.#draggable.subscribe('start', this.#handleDragStart.bind(this));\n\t\tthis.#draggable.subscribe('over', this.#handleDragOver.bind(this));\n\t\tthis.#draggable.subscribe('end', this.#handleDragEnd.bind(this));\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.#draggable?.destroy();\n\t}\n\n\t#handleBeforeDragStart(event): void\n\t{\n\t\tconst data = event.getData();\n\t\tconst source = data?.source;\n\t\tconst dataset = source?.dataset;\n\t\tif (!dataset)\n\t\t{\n\t\t\tevent.preventDefault();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst draggedItemId = this.#checkListManager.prepareItemId(dataset.id);\n\t\tconst draggedItem = this.#checkListManager.getItem(draggedItemId);\n\t\tif (!draggedItem)\n\t\t{\n\t\t\tevent.preventDefault();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#draggedItem = draggedItem;\n\n\t\tthis.#setYOffset(source);\n\t}\n\n\t#handleDragStart(event: DragStartEvent): void\n\t{\n\t\tthis.#store.dispatch(`${Model.Interface}/setDisableCheckListAnimations`, true);\n\t\tthis.#store.dispatch(`${Model.Interface}/setDraggedCheckListId`, this.#draggedItem.id);\n\t}\n\n\t#handleDragOver(event: DragOverEvent): void\n\t{\n\t\tconst { over, clientY } = event.getData();\n\n\t\tconst overedItemId = this.#checkListManager.prepareItemId(over.dataset.id);\n\t\tconst overedItem = this.#checkListManager.getItem(overedItemId);\n\t\tif (overedItem)\n\t\t{\n\t\t\tconst overMiddlePoint = this.#draggable.getElementMiddlePoint(over);\n\t\t\tconst direction = (clientY > overMiddlePoint.y) ? 1 : -1;\n\t\t\tconst directionFromBottom = (direction === 1);\n\n\t\t\tvoid this.#handleItemMoving(this.#draggedItem, overedItem, directionFromBottom);\n\t\t}\n\t}\n\n\t#handleDragEnd(event: DragEndEvent): void\n\t{\n\t\tconst { source: { dataset } } = event.getData();\n\n\t\tconst draggedItemId = this.#checkListManager.prepareItemId(dataset.id);\n\t\tconst draggedItem = this.#checkListManager.getItem(draggedItemId);\n\n\t\tthis.resortLevel(draggedItem.parentId);\n\n\t\tconst draggedItemChanged = draggedItem.sortIndex !== this.#draggedItem.sortIndex;\n\t\tif (draggedItemChanged)\n\t\t{\n\t\t\tthis.emit('update', draggedItem.id);\n\t\t}\n\n\t\tthis.#store.dispatch(`${Model.Interface}/setDraggedCheckListId`, null);\n\t\tthis.#store.dispatch(`${Model.Interface}/setDisableCheckListAnimations`, false);\n\t\tthis.#draggedItem = null;\n\n\t\tthis.emit('end', draggedItem.id);\n\t}\n\n\t#handleItemMoving(\n\t\tdraggedItem: CheckListModel,\n\t\toveredItem: CheckListModel,\n\t\tdirectionFromBottom: boolean,\n\t): Promise<void>\n\t{\n\t\tconst isFirstOnLevel = (overedItem.sortIndex === 0);\n\t\tconst numberOfItemPerLevel = this.#checkListManager.getChildren(overedItem.parentId).length;\n\t\tconst isLastOnLevel = (overedItem.sortIndex === (numberOfItemPerLevel - 1));\n\n\t\tconst shouldSkip = (\n\t\t\tMath.abs(draggedItem.sortIndex - overedItem.sortIndex) === 1\n\t\t\t&& !isFirstOnLevel\n\t\t\t&& !isLastOnLevel\n\t\t);\n\t\tif (shouldSkip)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.moveDropPreview(draggedItem, overedItem, directionFromBottom, true);\n\t\tthis.resortLevelDependingOnPosition(draggedItem, overedItem, directionFromBottom, true);\n\t}\n\n\t#setYOffset(draggedItemElement: HTMLElement): void\n\t{\n\t\tconst relativePosition = Dom.getRelativePosition(draggedItemElement, this.#container);\n\n\t\tconst relativeTop = relativePosition.top;\n\t\tconst isTopItem = relativeTop <= 0;\n\n\t\tconst offsetY = isTopItem ? relativeTop : 0;\n\n\t\tconst options = this.#draggable.getOptions();\n\t\toptions.offset.y = -offsetY;\n\n\t\tthis.#draggable.setOptions(options);\n\t}\n}\n","import { Dom, Type } from 'main.core';\nimport { mapActions, mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'tasks.v2.const';\nimport { checkListService } from 'tasks.v2.provider.service.check-list-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\nimport type { UserModel } from 'tasks.v2.model.users';\n\nimport { CheckListManager } from '../../../lib/check-list-manager';\n\n// @vue/component\nexport const CheckListItemMixin = {\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t\tisEdit: {},\n\t},\n\tprops: {\n\t\tid: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tisPreview: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: [\n\t\t'update',\n\t\t'addItem',\n\t\t'removeItem',\n\t\t'focus',\n\t\t'blur',\n\t\t'emptyBlur',\n\t\t'show',\n\t\t'hide',\n\t],\n\tsetup(): { task: TaskModel } {},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisHovered: false,\n\t\t\tscrollContainer: null,\n\t\t\tisDragEnabled: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tcurrentUserId: `${Model.Interface}/currentUserId`,\n\t\t\tdraggedCheckListId: `${Model.Interface}/draggedCheckListId`,\n\t\t}),\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist);\n\t\t},\n\t\titem(): CheckListModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getById`](this.id);\n\t\t},\n\t\tcanAdd(): boolean\n\t\t{\n\t\t\tif (!this.isEdit)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn this.task.rights.checklistAdd;\n\t\t},\n\t\tcanEdit(): boolean\n\t\t{\n\t\t\tif (!this.isEdit)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst checkListItem = this.checkListManager.getRootParentByChildId(this.item?.id);\n\n\t\t\treturn (\n\t\t\t\tthis.task.rights.checklistEdit\n\t\t\t\t|| checkListItem?.creator?.id === this.currentUserId\n\t\t\t);\n\t\t},\n\t\tcanModify(): boolean\n\t\t{\n\t\t\treturn this.item?.actions.modify === true;\n\t\t},\n\t\tcanRemove(): boolean\n\t\t{\n\t\t\treturn this.item?.actions.remove === true;\n\t\t},\n\t\tcanToggle(): boolean\n\t\t{\n\t\t\treturn this.item?.actions.toggle === true;\n\t\t},\n\t\thasAttachments(): boolean\n\t\t{\n\t\t\treturn this.hasUsers;\n\t\t},\n\t\thasUsers(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.hasAccomplices\n\t\t\t\t|| this.hasAuditors\n\t\t\t);\n\t\t},\n\t\thasAccomplices(): boolean\n\t\t{\n\t\t\treturn this.accomplices?.length > 0;\n\t\t},\n\t\thasAuditors(): boolean\n\t\t{\n\t\t\treturn this.auditors?.length > 0;\n\t\t},\n\t\taccomplices(): ?UserModel[]\n\t\t{\n\t\t\treturn this.item.accomplices;\n\t\t},\n\t\tauditors(): ?UserModel[]\n\t\t{\n\t\t\treturn this.item.auditors;\n\t\t},\n\t\tfiles(): ?[]\n\t\t{\n\t\t\treturn this.item.attachments;\n\t\t},\n\t\ttextColor(): string\n\t\t{\n\t\t\treturn this.completed ? 'var(--ui-color-base-4)' : 'var(--ui-color-base-1)';\n\t\t},\n\t\tlinkColor(): string\n\t\t{\n\t\t\treturn this.completed ? 'var(--ui-color-base-4)' : 'var(--ui-color-accent-main-link)';\n\t\t},\n\t\tgroupMode(): boolean\n\t\t{\n\t\t\treturn this.item.groupMode?.active === true;\n\t\t},\n\t\tgroupModeSelected(): boolean\n\t\t{\n\t\t\treturn this.item.groupMode?.selected === true;\n\t\t},\n\t\tcompleted(): boolean\n\t\t{\n\t\t\treturn this.checkListManager.isItemCompleted(this.item);\n\t\t},\n\t\tcanDragItem(): boolean\n\t\t{\n\t\t\tif (!this.isDragEnabled)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\tthis.isHovered\n\t\t\t\t&& this.canModify\n\t\t\t\t&& !this.readOnly\n\t\t\t\t&& !this.groupMode\n\t\t\t);\n\t\t},\n\t\treadOnly(): boolean\n\t\t{\n\t\t\treturn this.isPreview;\n\t\t},\n\t\ttextReadOnly(): boolean\n\t\t{\n\t\t\treturn this.groupMode || this.isPreview || !this.canModify;\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.checkListManager = new CheckListManager({\n\t\t\tcomputed: {\n\t\t\t\tcheckLists: () => this.checkLists,\n\t\t\t},\n\t\t});\n\t},\n\tmounted(): void\n\t{\n\t\tsetTimeout(() => {\n\t\t\tthis.isDragEnabled = true;\n\t\t}, 1000);\n\t},\n\tmethods: {\n\t\t...mapActions(Model.Interface, [\n\t\t\t'addCheckListCompletionCallback',\n\t\t]),\n\t\thandleFocus(): void\n\t\t{\n\t\t\tthis.$emit('focus', this.id);\n\t\t},\n\t\thandleBlur(): void\n\t\t{\n\t\t\tthis.$emit('blur', this.id);\n\t\t},\n\t\thandleEmptyBlur(): void\n\t\t{\n\t\t\tthis.$emit('emptyBlur', this.id);\n\t\t},\n\t\thandleLinkClick(event: PointerEvent): void\n\t\t{\n\t\t\tevent.stopPropagation();\n\t\t},\n\t\tupdateCheckList(id: number | string, fields: Partial<CheckListModel>): Promise<void>\n\t\t{\n\t\t\tthis.$emit('update', this.id);\n\n\t\t\treturn this.$store.dispatch(`${Model.CheckList}/update`, { id, fields });\n\t\t},\n\t\tupsertCheckLists(items: CheckListModel[]): Promise<void>\n\t\t{\n\t\t\tthis.$emit('update', this.id);\n\n\t\t\treturn this.$store.dispatch(`${Model.CheckList}/upsertMany`, items);\n\t\t},\n\t\tupdateTitle(title: string = ''): void\n\t\t{\n\t\t\tthis.$store.dispatch(`${Model.CheckList}/update`, {\n\t\t\t\tid: this.id,\n\t\t\t\tfields: { title },\n\t\t\t});\n\n\t\t\tthis.$emit('update', this.id);\n\t\t},\n\t\taddItem(sort: ?number): void\n\t\t{\n\t\t\tif (!this.canAdd)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit(\n\t\t\t\t'addItem',\n\t\t\t\t{\n\t\t\t\t\tid: this.id,\n\t\t\t\t\tsort: Type.isNumber(sort) ? sort : null,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tremoveItem(): void\n\t\t{\n\t\t\tthis.$emit('removeItem', this.id);\n\t\t},\n\t\tasync complete(isComplete: boolean): void\n\t\t{\n\t\t\tif (this.canToggle === false)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.updateCheckList(this.id, { localCompleteState: isComplete });\n\n\t\t\tconst listParents = new Map();\n\t\t\tthis.checkListManager.syncParentCompletionState(\n\t\t\t\tthis.id,\n\t\t\t\t(id: string | number, fields: Partial<CheckListModel>) => {\n\t\t\t\t\tlistParents.set(id, fields);\n\t\t\t\t\tthis.updateCheckList(id, { localCompleteState: fields.isComplete });\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tthis.$emit('update', this.id);\n\n\t\t\tconst completionCallback = () => {\n\t\t\t\tthis.updateCheckList(this.id, { isComplete });\n\t\t\t\tlistParents.forEach((fields: Partial<CheckListModel>, id: string | number) => {\n\t\t\t\t\tthis.updateCheckList(id, fields);\n\t\t\t\t\tif (this.isPreview && this.isEdit)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.saveCompleteState(id, fields.isComplete);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tthis.addCheckListCompletionCallback({\n\t\t\t\tid: this.id,\n\t\t\t\tcallback: completionCallback,\n\t\t\t});\n\n\t\t\tif (this.isPreview && this.isEdit)\n\t\t\t{\n\t\t\t\tthis.saveCompleteState(this.id, isComplete);\n\t\t\t}\n\t\t},\n\t\tsaveCompleteState(itemId: string | number, isComplete: boolean): void\n\t\t{\n\t\t\tif (isComplete)\n\t\t\t{\n\t\t\t\tvoid checkListService.complete(this.taskId, itemId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvoid checkListService.renew(this.taskId, itemId);\n\t\t\t}\n\t\t},\n\t\tasync scrollToItem(): Promise<void>\n\t\t{\n\t\t\tawait new Promise((resolve) => {\n\t\t\t\tsetTimeout(() => resolve(), 300);\n\t\t\t});\n\n\t\t\tconst item = this.$refs.item;\n\t\t\tconst scrollContainer = this.$parent.$el?.closest('[data-list]');\n\n\t\t\tconst itemRect = Dom.getPosition(item);\n\t\t\tconst containerRect = Dom.getPosition(scrollContainer);\n\n\t\t\tconst offsetTopInsideContainer = itemRect.top - containerRect.top + scrollContainer.scrollTop;\n\n\t\t\tscrollContainer.scrollTo({\n\t\t\t\ttop: offsetTopInsideContainer - 200,\n\t\t\t\tbehavior: 'smooth',\n\t\t\t});\n\t\t},\n\t},\n};\n","import { Event, Text } from 'main.core';\n\nimport { hint, type HintParams } from 'ui.vue3.directives.hint';\nimport { BMenu, type MenuOptions, type MenuItemOptions } from 'ui.vue3.components.menu';\nimport { BIcon, Actions, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.actions';\nimport 'ui.icon-set.outline';\n\nimport { Model } from 'tasks.v2.const';\nimport { GrowingTextArea } from 'tasks.v2.component.elements.growing-text-area';\nimport { UserAvatarList } from 'tasks.v2.component.elements.user-avatar-list';\nimport { UserCheckbox } from 'tasks.v2.component.elements.user-checkbox';\nimport { ProgressBar } from 'tasks.v2.component.elements.progress-bar';\nimport { tooltip } from 'tasks.v2.component.elements.hint';\nimport { checkListService } from 'tasks.v2.provider.service.check-list-service';\n\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\nimport type { UserModel } from 'tasks.v2.model.users';\n\nimport { CheckListItemMixin } from './check-list-item-mixin';\n\n// @vue/component\nexport const CheckListParentItem = {\n\tname: 'CheckListParentItem',\n\tcomponents: {\n\t\tBIcon,\n\t\tBMenu,\n\t\tGrowingTextArea,\n\t\tUserAvatarList,\n\t\tUserCheckbox,\n\t\tProgressBar,\n\t},\n\tdirectives: { hint },\n\tmixins: [\n\t\tCheckListItemMixin,\n\t],\n\tinject: ['setItemsRef'],\n\tprops: {\n\t\tpositionIndex: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: [\n\t\t'startGroupMode',\n\t\t'openCheckList',\n\t],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tActions,\n\t\t\tOutline,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisSticky: false,\n\t\t\tisMenuShown: false,\n\t\t\tmenuRemoveSectionCode: 'removeSection',\n\t\t};\n\t},\n\tcomputed: {\n\t\tmenuOptions(): MenuOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: `check-list-parent-item-action-menu-${Text.getRandom()}`,\n\t\t\t\tbindElement: this.$refs.more.$el,\n\t\t\t\tminWidth: 250,\n\t\t\t\toffsetLeft: -100,\n\t\t\t\tsections: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: this.menuRemoveSectionCode,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: this.menuItems,\n\t\t\t\ttargetContainer: document.body,\n\t\t\t\tcloseByEsc: true,\n\t\t\t};\n\t\t},\n\t\tmenuItems(): MenuItemOptions[]\n\t\t{\n\t\t\tconst collapseItem = {\n\t\t\t\ttitle: (this.item.areCompletedCollapsed\n\t\t\t\t\t? this.loc('TASKS_V2_CHECK_LIST_ITEM_MENU_SHOW')\n\t\t\t\t\t: this.loc('TASKS_V2_CHECK_LIST_ITEM_MENU_HIDE')\n\t\t\t\t),\n\t\t\t\ticon: this.item.areCompletedCollapsed ? Outline.OBSERVER : Outline.CROSSED_EYE,\n\t\t\t\tdataset: {\n\t\t\t\t\tid: `MenuProfileHide-${this.id}`,\n\t\t\t\t},\n\t\t\t\tonClick: () => {\n\t\t\t\t\tconst newValue = !this.item.areCompletedCollapsed;\n\n\t\t\t\t\tvoid this.updateCheckList(this.id, { areCompletedCollapsed: newValue });\n\n\t\t\t\t\tthis.toggleCompleted(this.id, newValue);\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tconst groupActionsItem = {\n\t\t\t\ttitle: this.loc('TASKS_V2_CHECK_LIST_ITEM_MENU_GROUP'),\n\t\t\t\ticon: Outline.MULTICHOICE_ON,\n\t\t\t\tdataset: {\n\t\t\t\t\tid: `MenuProfileGroup-${this.id}`,\n\t\t\t\t},\n\t\t\t\tonClick: () => {\n\t\t\t\t\tif (this.collapsed)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.toggleCollapse();\n\t\t\t\t\t}\n\t\t\t\t\tthis.$emit('startGroupMode', this.id);\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tconst editItem = {\n\t\t\t\tsectionCode: this.menuRemoveSectionCode,\n\t\t\t\ttitle: this.loc('TASKS_V2_CHECK_LIST_ITEM_MENU_EDIT'),\n\t\t\t\ticon: Outline.EDIT_L,\n\t\t\t\tdataset: {\n\t\t\t\t\tid: `MenuProfileEdit-${this.id}`,\n\t\t\t\t},\n\t\t\t\tonClick: () => {\n\t\t\t\t\tif (this.canModify)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$emit('openCheckList', this.id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tconst removeItem = {\n\t\t\t\tsectionCode: this.menuRemoveSectionCode,\n\t\t\t\tdesign: 'alert',\n\t\t\t\ttitle: this.loc('TASKS_V2_CHECK_LIST_ITEM_MENU_REMOVE'),\n\t\t\t\ticon: Outline.TRASHCAN,\n\t\t\t\tdataset: {\n\t\t\t\t\tid: `MenuProfileRemove-${this.id}`,\n\t\t\t\t},\n\t\t\t\tonClick: this.removeItem.bind(this),\n\t\t\t};\n\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\treturn [\n\t\t\t\t\tcollapseItem,\n\t\t\t\t\tthis.canModify ? editItem : null,\n\t\t\t\t\tthis.canRemove ? removeItem : null,\n\t\t\t\t];\n\t\t\t}\n\n\t\t\treturn [\n\t\t\t\tcollapseItem,\n\t\t\t\tthis.canModify ? groupActionsItem : null,\n\t\t\t\tthis.canRemove ? removeItem : null,\n\t\t\t];\n\t\t},\n\t\titemIcon(): string\n\t\t{\n\t\t\treturn this.completed ? Outline.CHECK_L : Outline.CHECK_LIST;\n\t\t},\n\t\tcheckListStatus(): string\n\t\t{\n\t\t\tconst label = this.loc('TASKS_V2_CHECK_LIST_STATUS_LABEL_NEW');\n\n\t\t\treturn label\n\t\t\t\t.replace('#completed#', this.completedCount)\n\t\t\t\t.replace('#total#', this.totalCount);\n\t\t},\n\t\tcompletedCount(): number\n\t\t{\n\t\t\treturn this.checkLists.filter((checklist: CheckListModel) => {\n\t\t\t\tif (checklist.parentId !== this.id)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn checklist.localCompleteState ?? checklist.isComplete;\n\t\t\t}).length;\n\t\t},\n\t\ttotalCount(): number\n\t\t{\n\t\t\treturn this.checkLists.filter((checklist: CheckListModel) => {\n\t\t\t\treturn checklist.parentId === this.id;\n\t\t\t}).length;\n\t\t},\n\t\tcurrentUserResponsible(): boolean\n\t\t{\n\t\t\treturn this.task.responsibleIds.includes(this.currentUserId);\n\t\t},\n\t\tcurrentUser(): UserModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Users}/getById`](this.currentUserId);\n\t\t},\n\t\tnumberMyItems(): number\n\t\t{\n\t\t\treturn this.checkListManager.findItemIdsWithUser(this.id, this.currentUserId).size;\n\t\t},\n\t\tmyFilterTooltip(): Function\n\t\t{\n\t\t\treturn (): HintParams => tooltip({\n\t\t\t\ttext: (\n\t\t\t\t\tthis.myFilterActive\n\t\t\t\t\t\t? this.loc('TASKS_V2_CHECK_LIST_MY_FILTER_HINT_ALL')\n\t\t\t\t\t\t: this.loc('TASKS_V2_CHECK_LIST_MY_FILTER_HINT_MY')\n\t\t\t\t),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\toffsetLeft: this.$refs.myFilter.offsetWidth / 2,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tmyFilterActive(): boolean\n\t\t{\n\t\t\treturn this.item.myFilterActive;\n\t\t},\n\t\tfontSize(): number\n\t\t{\n\t\t\treturn this.isPreview ? 15 : 17;\n\t\t},\n\t\tcollapsed(): boolean\n\t\t{\n\t\t\tif (this.checkListManager.isParentItem(this.draggedCheckListId))\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn this.checkListManager.isItemCollapsed(this.item, this.isPreview, this.positionIndex);\n\t\t},\n\t},\n\twatch: {\n\t\tmyFilterActive(value: boolean): void\n\t\t{\n\t\t\tthis.handleMyFilter(value);\n\t\t},\n\t\ttotalCount(): void\n\t\t{\n\t\t\tthis.handleCompleteState();\n\n\t\t\tif (!this.numberMyItems && this.myFilterActive)\n\t\t\t{\n\t\t\t\tthis.handleMyFilter(false);\n\t\t\t}\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.scrollContainer = this.$parent.$el?.closest('[data-list]');\n\n\t\tif (this.setItemsRef)\n\t\t{\n\t\t\tthis.setItemsRef(this.id, this);\n\t\t}\n\n\t\tif (this.scrollContainer)\n\t\t{\n\t\t\tEvent.bind(this.scrollContainer, 'scroll', this.handleScroll);\n\n\t\t\tvoid this.$nextTick(this.checkSticky);\n\n\t\t\tthis.mutationObserver = new MutationObserver(() => {\n\t\t\t\tthis.checkSticky();\n\t\t\t});\n\t\t\tthis.mutationObserver.observe(\n\t\t\t\tthis.scrollContainer,\n\t\t\t\t{\n\t\t\t\t\tchildList: true,\n\t\t\t\t\tsubtree: true,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\tif (!this.isPreview)\n\t\t{\n\t\t\tthis.handleCompleteState();\n\t\t}\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tif (this.scrollContainer)\n\t\t{\n\t\t\tEvent.unbind(this.scrollContainer, 'scroll', this.handleScroll);\n\t\t}\n\n\t\tif (this.mutationObserver)\n\t\t{\n\t\t\tthis.mutationObserver.disconnect();\n\t\t}\n\n\t\tif (this.setItemsRef)\n\t\t{\n\t\t\tthis.setItemsRef(this.id, null);\n\t\t}\n\t},\n\tmethods: {\n\t\thandleScroll(): void\n\t\t{\n\t\t\tthis.checkSticky();\n\t\t},\n\t\thandleTextClick(): void\n\t\t{\n\t\t\tif (this.isPreview && this.canModify)\n\t\t\t{\n\t\t\t\tthis.$emit('openCheckList', this.id);\n\t\t\t}\n\t\t},\n\t\thandleMyFilter(checked: boolean): void\n\t\t{\n\t\t\tconst myItemIds = this.checkListManager.findItemIdsWithUser(\n\t\t\t\tthis.id,\n\t\t\t\tthis.currentUserId,\n\t\t\t);\n\n\t\t\tthis.$store.dispatch(`${Model.CheckList}/update`, {\n\t\t\t\tid: this.id,\n\t\t\t\tfields: { myFilterActive: checked },\n\t\t\t});\n\n\t\t\tif (checked === true)\n\t\t\t{\n\t\t\t\tconst idsToHide = this.checkListManager.getAllChildren(this.id)\n\t\t\t\t\t.filter((item: CheckListModel) => !myItemIds.has(item.id))\n\t\t\t\t\t.map((item: CheckListModel) => item.id);\n\n\t\t\t\tthis.checkListManager.hideItems(\n\t\t\t\t\tidsToHide,\n\t\t\t\t\t(updates: CheckListModel[]) => this.upsertCheckLists(updates),\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst childrenIds = this.checkListManager\n\t\t\t\t\t.getAllChildren(this.id)\n\t\t\t\t\t.filter((item: CheckListModel) => {\n\t\t\t\t\t\tconst completed = (item.localCompleteState ?? item.isComplete);\n\n\t\t\t\t\t\treturn !this.item.areCompletedCollapsed || !completed;\n\t\t\t\t\t})\n\t\t\t\t\t.map((item: CheckListModel) => item.id);\n\n\t\t\t\tthis.checkListManager.showItems(\n\t\t\t\t\tchildrenIds,\n\t\t\t\t\t(updates: CheckListModel[]) => this.upsertCheckLists(updates),\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\thandleCompleteState(): void\n\t\t{\n\t\t\tif (this.totalCount > 0)\n\t\t\t{\n\t\t\t\tthis.complete(this.totalCount === this.completedCount);\n\t\t\t}\n\t\t\telse if (this.completed)\n\t\t\t{\n\t\t\t\tthis.complete(false);\n\t\t\t}\n\t\t},\n\t\tcheckSticky(): void\n\t\t{\n\t\t\tif (!this.scrollContainer || !this.$refs.item)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst stickyRect = this.$refs.item.getBoundingClientRect();\n\t\t\tconst containerRect = this.scrollContainer.getBoundingClientRect();\n\n\t\t\tthis.isSticky = stickyRect.top <= (containerRect.top + stickyRect.height / 2);\n\t\t},\n\t\tshowMenu(): void\n\t\t{\n\t\t\tthis.isMenuShown = true;\n\t\t},\n\t\ttoggleCollapse(): void\n\t\t{\n\t\t\tconst localCollapsedState = !this.collapsed;\n\n\t\t\tif (this.isPreview && this.isEdit)\n\t\t\t{\n\t\t\t\tif (localCollapsedState === true)\n\t\t\t\t{\n\t\t\t\t\tvoid checkListService.collapse(this.taskId, this.id);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvoid checkListService.expand(this.taskId, this.id);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.$store.dispatch(`${Model.CheckList}/update`, {\n\t\t\t\tid: this.id,\n\t\t\t\tfields: { localCollapsedState },\n\t\t\t});\n\t\t},\n\t\tcollapse(): void\n\t\t{\n\t\t\tthis.$store.dispatch(`${Model.CheckList}/update`, {\n\t\t\t\tid: this.id,\n\t\t\t\tfields: { localCollapsedState: true },\n\t\t\t});\n\t\t},\n\t\ttoggleCompleted(itemId: number | string, collapsed: boolean): void\n\t\t{\n\t\t\tconst myItemIds = this.checkListManager.findItemIdsWithUser(\n\t\t\t\tthis.id,\n\t\t\t\tthis.currentUserId,\n\t\t\t);\n\n\t\t\tthis.checkListManager.getAllCompletedChildren(itemId)\n\t\t\t\t.filter((item: CheckListModel) => {\n\t\t\t\t\treturn !this.myFilterActive || myItemIds.has(item.id);\n\t\t\t\t})\n\t\t\t\t.forEach((item: CheckListModel) => {\n\t\t\t\t\tif (collapsed === false)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.checkListManager.showItems(\n\t\t\t\t\t\t\t[item.id],\n\t\t\t\t\t\t\t(updates: CheckListModel[]) => this.upsertCheckLists(updates),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.checkListManager.hideItems(\n\t\t\t\t\t\t\t[item.id],\n\t\t\t\t\t\t\t(updates: CheckListModel[]) => this.upsertCheckLists(updates),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"item\"\n\t\t\tclass=\"check-list-widget-parent-item\"\n\t\t\t:class=\"{\n\t\t\t\t'--complete': completed,\n\t\t\t\t'--collapsed': collapsed,\n\t\t\t\t'--preview': isPreview,\n\t\t\t\t'--editable': canModify,\n\t\t\t}\"\n\t\t\t:data-id=\"id\"\n\t\t\t:data-parent=\"id\"\n\t\t\t@mouseover=\"isHovered = true\"\n\t\t\t@mouseleave=\"isHovered = false\"\n\t\t>\n\t\t\t<div class=\"check-list-widget-parent-item-label-container\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!readOnly\"\n\t\t\t\t\tclass=\"check-list-widget-item-drag\"\n\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t'check-list-drag-list': canDragItem,\n\t\t\t\t\t}\"\n\t\t\t\t>\n\t\t\t\t\t<BIcon v-if=\"canDragItem\" :name=\"Outline.DRAG_L\"/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"check-list-widget-item-icon\">\n\t\t\t\t\t<BIcon :name=\"itemIcon\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"check-list-widget-parent-item-title-container\">\n\t\t\t\t<GrowingTextArea\n\t\t\t\t\tref=\"growingTextArea\"\n\t\t\t\t\tclass=\"check-list-widget-parent-item-title\"\n\t\t\t\t\t:data-check-list-id=\"'check-list-parent-item-title-' + id\"\n\t\t\t\t\t:modelValue=\"item.title\"\n\t\t\t\t\t:placeholder=\"loc('TASKS_V2_CHECK_LIST_LIST_PLACEHOLDER')\"\n\t\t\t\t\t:readonly=\"textReadOnly\"\n\t\t\t\t\t:fontColor=\"textColor\"\n\t\t\t\t\t:linkColor\n\t\t\t\t\t:fontSize\n\t\t\t\t\t:lineHeight=\"20\"\n\t\t\t\t\t:fontWeight=\"500\"\n\t\t\t\t\t@click=\"handleTextClick\"\n\t\t\t\t\t@linkClick=\"handleLinkClick\"\n\t\t\t\t\t@update:modelValue=\"updateTitle\"\n\t\t\t\t\t@input=\"updateTitle\"\n\t\t\t\t\t@focus=\"handleFocus\"\n\t\t\t\t\t@emptyFocus=\"scrollToItem\"\n\t\t\t\t\t@blur=\"handleBlur\"\n\t\t\t\t\t@emptyBlur=\"handleEmptyBlur\"\n\t\t\t\t/>\n\t\t\t\t<template v-if=\"hasAttachments\">\n\t\t\t\t\t<div class=\"check-list-widget-item-attach --parent\">\n\t\t\t\t\t\t<div v-if=\"hasUsers\" class=\"check-list-widget-item-attach-users\">\n\t\t\t\t\t\t\t<div v-if=\"hasAccomplices\" class=\"check-list-widget-item-attach-users-list\">\n\t\t\t\t\t\t\t\t<BIcon :name=\"Outline.GROUP\"/>\n\t\t\t\t\t\t\t\t<UserAvatarList :users=\"accomplices\"/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-if=\"hasAuditors\" class=\"check-list-widget-item-attach-users-list\">\n\t\t\t\t\t\t\t\t<BIcon :name=\"Outline.OBSERVER\"/>\n\t\t\t\t\t\t\t\t<UserAvatarList :users=\"auditors\"/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<div class=\"check-list-widget-parent-item-title-status\">\n\t\t\t\t\t<div class=\"check-list-widget-parent-item-title-status-label\">\n\t\t\t\t\t\t{{ checkListStatus }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<ProgressBar\n\t\t\t\t\t\t:totalValue=\"totalCount\"\n\t\t\t\t\t\t:completedValue=\"completedCount\"\n\t\t\t\t\t\t:width=\"56\"\n\t\t\t\t\t\t:height=\"5\"\n\t\t\t\t\t\tcolor=\"var(--ui-color-accent-main-primary-alt)\"\n\t\t\t\t\t\tbgColor=\"var(--ui-color-base-7)\"\n\t\t\t\t\t\t:borderRadius=\"30\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"check-list-widget-parent-item-action\">\n\t\t\t\t<div class=\"check-list-widget-parent-item-main-action\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tref=\"myFilter\"\n\t\t\t\t\t\tclass=\"check-list-widget-parent-item-main-action-filter\"\n\t\t\t\t\t\tv-hint=\"myFilterTooltip\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<UserCheckbox\n\t\t\t\t\t\t\tv-if=\"!currentUserResponsible && numberMyItems > 0\"\n\t\t\t\t\t\t\t:init-user=\"currentUser\"\n\t\t\t\t\t\t\t:number=\"numberMyItems\"\n\t\t\t\t\t\t\tv-model:checked=\"item.myFilterActive\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"check-list-widget-parent-item-main-action-actions\">\n\t\t\t\t\t\t<BIcon ref=\"more\" :name=\"Outline.MORE_L\" @click=\"showMenu\"/>\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"collapsed ? Outline.CHEVRON_DOWN_L : Outline.CHEVRON_TOP_L\"\n\t\t\t\t\t\t\t@click=\"toggleCollapse()\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"isSticky && !isPreview\" class=\"check-list-widget-parent-item-empty\"/>\n\t\t\t</div>\n\t\t\t<BMenu v-if=\"isMenuShown\" :options=\"menuOptions\" @close=\"isMenuShown = false\"/>\n\t\t</div>\n\t`,\n};\n","import { Checkbox as UiCheckbox } from 'tasks.v2.component.elements.checkbox';\n\nimport './check-list-checkbox.css';\n\n// @vue/component\nexport const CheckListCheckbox = {\n\tname: 'CheckListCheckbox',\n\tcomponents: {\n\t\tUiCheckbox,\n\t},\n\tprops: {\n\t\timportant: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tchecked: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\thighlight: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['click'],\n\ttemplate: `\n\t\t<UiCheckbox\n\t\t\t:checked\n\t\t\t:important\n\t\t\t:disabled\n\t\t\t:highlight\n\t\t\tclass=\"check-list-widget-checkbox\"\n\t\t\t@click=\"$emit('click', $event)\"\n\t\t/>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nimport { BLine } from 'ui.system.skeleton.vue';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\nimport type { VueUploaderAdapter } from 'ui.uploader.vue';\n\nimport type { UserFieldWidgetOptions } from 'disk.uploader.user-field-widget';\n\nimport { EventName, Model } from 'tasks.v2.const';\nimport { GrowingTextArea } from 'tasks.v2.component.elements.growing-text-area';\nimport { UserAvatarList } from 'tasks.v2.component.elements.user-avatar-list';\nimport { fileService, EntityTypes } from 'tasks.v2.provider.service.file-service';\nimport { highlighter } from 'tasks.v2.lib.highlighter';\nimport { DiskUserFieldWidgetComponent } from 'tasks.v2.component.elements.user-field-widget-component';\n\nimport { CheckListItemMixin } from './check-list-item-mixin';\nimport { CheckListCheckbox } from './check-list-checkbox';\n\n// @vue/component\nexport const CheckListChildItem = {\n\tname: 'CheckListChildItem',\n\tcomponents: {\n\t\tBIcon,\n\t\tBLine,\n\t\tGrowingTextArea,\n\t\tUserAvatarList,\n\t\tCheckListCheckbox,\n\t\tUserFieldWidgetComponent: DiskUserFieldWidgetComponent,\n\t},\n\tmixins: [\n\t\tCheckListItemMixin,\n\t],\n\tinject: ['setItemsRef'],\n\tprops: {\n\t\titemOffset: {\n\t\t\ttype: String,\n\t\t\tdefault: '0',\n\t\t},\n\t\tcheckListId: {\n\t\t\ttype: [Number, String],\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\temits: [\n\t\t'toggleGroupModeSelected',\n\t\t'openCheckList',\n\t],\n\tsetup(props: Object): { uploaderAdapter: VueUploaderAdapter }\n\t{\n\t\tconst fileServiceInstance = fileService.get(\n\t\t\tprops.id,\n\t\t\tEntityTypes.CheckListItem,\n\t\t\t{ parentEntityId: props.taskId },\n\t\t);\n\n\t\treturn {\n\t\t\tOutline,\n\t\t\tfileService: fileServiceInstance,\n\t\t\tuploaderAdapter: fileServiceInstance.getAdapter(),\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tuploadingFiles: this.fileService.getFiles(),\n\t\t\tfilesLoading: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\twidgetOptions(): UserFieldWidgetOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tisEmbedded: true,\n\t\t\t\twithControlPanel: false,\n\t\t\t\tcanCreateDocuments: false,\n\t\t\t\ttileWidgetOptions: {\n\t\t\t\t\tcompact: true,\n\t\t\t\t\thideDropArea: true,\n\t\t\t\t\tenableDropzone: false,\n\t\t\t\t\treadonly: this.isPreview,\n\t\t\t\t\tautoCollapse: false,\n\t\t\t\t\tremoveFromServer: !this.isEdit,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\thasAttachments(): boolean\n\t\t{\n\t\t\treturn this.hasUsers || this.hasFilesAttach;\n\t\t},\n\t\thasFilesAttach(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.hasFiles\n\t\t\t\t|| this.fileService.isUploading()\n\t\t\t\t|| this.fileService.hasUploadingError()\n\t\t\t);\n\t\t},\n\t\thasFiles(): boolean\n\t\t{\n\t\t\treturn this.filesNumber > 0;\n\t\t},\n\t\tfilesNumber(): boolean\n\t\t{\n\t\t\tif (!this.files)\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\treturn this.files.length;\n\t\t},\n\t\thasTrashcanIcon(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.isHovered\n\t\t\t\t&& this.canModify\n\t\t\t\t&& !this.item.panelIsShown\n\t\t\t\t&& !this.groupMode\n\t\t\t\t&& !this.readOnly\n\t\t\t);\n\t\t},\n\t\ttoggleable(): boolean\n\t\t{\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\treturn this.canModify;\n\t\t\t}\n\n\t\t\treturn this.canToggle;\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tif (this.hasFilesAttach)\n\t\t{\n\t\t\tvoid this.loadFiles();\n\t\t}\n\t},\n\tmounted(): void\n\t{\n\t\tif (this.setItemsRef)\n\t\t{\n\t\t\tthis.setItemsRef(this.id, this);\n\t\t}\n\n\t\tif (this.checkListId === this.id)\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.$refs.growingTextArea?.focusTextarea();\n\t\t\t}, 500);\n\t\t}\n\n\t\tthis.subscribeToEvents();\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tif (this.setItemsRef)\n\t\t{\n\t\t\tthis.setItemsRef(this.id, null);\n\t\t}\n\n\t\tthis.unsubscribeToEvents();\n\t},\n\tmethods: {\n\t\tsubscribeToEvents(): void\n\t\t{\n\t\t\tEventEmitter.subscribe(EventName.HighlightCheckListItem + this.id, this.handleHighlightItemEvent);\n\t\t},\n\t\tunsubscribeToEvents(): void\n\t\t{\n\t\t\tEventEmitter.unsubscribe(EventName.HighlightCheckListItem + this.id, this.handleHighlightItemEvent);\n\t\t},\n\t\ttoggleGroupModeSelected(): void\n\t\t{\n\t\t\tthis.$store.dispatch(`${Model.CheckList}/update`, {\n\t\t\t\tid: this.id,\n\t\t\t\tfields: {\n\t\t\t\t\tgroupMode: {\n\t\t\t\t\t\tactive: true,\n\t\t\t\t\t\tselected: !this.groupModeSelected,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.$emit('toggleGroupModeSelected', this.id);\n\t\t},\n\t\tasync loadFiles(): Promise<void>\n\t\t{\n\t\t\tthis.filesLoading = true;\n\n\t\t\tconst ids = this.files?.map((file) => file?.id ?? file);\n\n\t\t\tawait this.fileService.list(ids ?? []);\n\n\t\t\tthis.filesLoading = false;\n\t\t},\n\t\thandleEnter(): void\n\t\t{\n\t\t\tif (!this.item)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.addItem(this.item.sortIndex + 1);\n\t\t},\n\t\thandleClick(event: PointerEvent): void\n\t\t{\n\t\t\tconst filesWidget = this.$refs['files-widget'];\n\n\t\t\tif (this.isClickInsideFilesWidget(filesWidget?.$el, event.target))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.groupMode)\n\t\t\t{\n\t\t\t\tthis.toggleGroupModeSelected();\n\t\t\t}\n\n\t\t\tif (this.isPreview && this.canModify)\n\t\t\t{\n\t\t\t\tthis.$emit('openCheckList', this.id);\n\t\t\t}\n\t\t},\n\t\tisClickInsideFilesWidget(filesNode: HTMLElement, target: HTMLElement): boolean\n\t\t{\n\t\t\tif (!filesNode || !target)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst excludedClasses = ['ui-tile-uploader-items'];\n\n\t\t\tconst isInsideWidget = filesNode.contains(target);\n\t\t\tif (!isInsideWidget)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst hasExcludedClass = excludedClasses.some((className: string) => Dom.hasClass(target, className));\n\n\t\t\treturn !hasExcludedClass;\n\t\t},\n\t\thandleHighlightItemEvent(): void\n\t\t{\n\t\t\tvoid highlighter.highlight(this.$el);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"item\"\n\t\t\tclass=\"check-list-widget-child-item\"\n\t\t\t:class=\"{\n\t\t\t\t'--complete': completed,\n\t\t\t\t'--group-mode': groupMode,\n\t\t\t\t'--group-mode-selected': groupModeSelected,\n\t\t\t\t'--preview': isPreview,\n\t\t\t\t'--toggleable': toggleable,\n\t\t\t}\"\n\t\t\t:style=\"{ marginLeft: itemOffset }\"\n\t\t\t@mouseover=\"isHovered = true\"\n\t\t\t@mouseleave=\"isHovered = false\"\n\t\t\t@click=\"handleClick\"\n\t\t>\n\t\t\t<div class=\"check-list-widget-child-item-base\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!readOnly\"\n\t\t\t\t\tclass=\"check-list-widget-item-drag\"\n\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t'check-list-drag-item': canDragItem,\n\t\t\t\t\t}\"\n\t\t\t\t>\n\t\t\t\t\t<BIcon v-if=\"canDragItem\" :name=\"Outline.DRAG_L\"/>\n\t\t\t\t</div>\n\t\t\t\t<CheckListCheckbox\n\t\t\t\t\t:important=\"!item.isImportant\"\n\t\t\t\t\t:disabled=\"!canToggle || groupMode\"\n\t\t\t\t\t:checked=\"completed\"\n\t\t\t\t\t@click=\"complete(!completed)\"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"item.isImportant\"\n\t\t\t\t\tclass=\"check-list-widget-child-item-important\"\n\t\t\t\t>\n\t\t\t\t\t<BIcon :name=\"Outline.FIRE_SOLID\"/>\n\t\t\t\t</div>\n\t\t\t\t<GrowingTextArea\n\t\t\t\t\tref=\"growingTextArea\"\n\t\t\t\t\tclass=\"check-list-widget-child-item-title\"\n\t\t\t\t\t:data-check-list-id=\"'check-list-child-item-title-' + item.id\"\n\t\t\t\t\t:modelValue=\"item.title\"\n\t\t\t\t\t:placeholder=\"loc('TASKS_V2_CHECK_LIST_ITEM_PLACEHOLDER')\"\n\t\t\t\t\t:readonly=\"textReadOnly\"\n\t\t\t\t\t:fontColor=\"textColor\"\n\t\t\t\t\t:linkColor\n\t\t\t\t\t:fontSize=\"15\"\n\t\t\t\t\t:lineHeight=\"20\"\n\t\t\t\t\t@update:modelValue=\"updateTitle\"\n\t\t\t\t\t@linkClick=\"handleLinkClick\"\n\t\t\t\t\t@input=\"updateTitle\"\n\t\t\t\t\t@focus=\"handleFocus\"\n\t\t\t\t\t@blur=\"handleBlur\"\n\t\t\t\t\t@emptyBlur=\"handleEmptyBlur\"\n\t\t\t\t\t@emptyFocus=\"scrollToItem\"\n\t\t\t\t\t@enterBlur=\"handleEnter\"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"hasTrashcanIcon\"\n\t\t\t\t\tclass=\"check-list-widget-child-item-action\"\n\t\t\t\t\t@click=\"removeItem\"\n\t\t\t\t>\n\t\t\t\t\t<BIcon :name=\"Outline.TRASHCAN\"/>\n\t\t\t\t</div>\n\t\t\t\t<template v-else-if=\"groupMode\">\n\t\t\t\t\t<CheckListCheckbox :checked=\"groupModeSelected\" highlight @click=\"toggleGroupModeSelected\"/>\n\t\t\t\t</template>\n\t\t\t\t<div v-else class=\"check-list-widget-child-item-action-stub\"/>\n\t\t\t</div>\n\t\t\t<template v-if=\"hasAttachments\">\n\t\t\t\t<div class=\"check-list-widget-item-attach\">\n\t\t\t\t\t<div v-if=\"hasUsers\" class=\"check-list-widget-item-attach-users\">\n\t\t\t\t\t\t<div v-if=\"hasAccomplices\" class=\"check-list-widget-item-attach-users-list\">\n\t\t\t\t\t\t\t<BIcon :name=\"Outline.GROUP\"/>\n\t\t\t\t\t\t\t<UserAvatarList :users=\"accomplices\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"hasAuditors\" class=\"check-list-widget-item-attach-users-list\">\n\t\t\t\t\t\t\t<BIcon :name=\"Outline.OBSERVER\"/>\n\t\t\t\t\t\t\t<UserAvatarList :users=\"auditors\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"hasFilesAttach\" class=\"check-list-widget-item-attach-files\">\n\t\t\t\t\t\t<div class=\"check-list-widget-item-attach-files-list\">\n\t\t\t\t\t\t\t<template v-if=\"filesLoading\">\n\t\t\t\t\t\t\t\t<div class=\"check-list-widget-item-attach-files-list-skeleton\">\n\t\t\t\t\t\t\t\t\t<BLine v-for=\"key in filesNumber\" :key :height=\"90\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<UserFieldWidgetComponent :uploaderAdapter :widgetOptions ref=\"files-widget\"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\n// @vue/component\nexport const CheckListAddItem = {\n\tname: 'CheckListAddItem',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tisPreview: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['addItem'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"check-list-widget-add-item\"\n\t\t\t:class=\"{'--preview': isPreview}\"\n\t\t\t@mousedown=\"$emit('addItem')\"\n\t\t>\n\t\t\t<div class=\"check-list-widget-add-item-icon\">\n\t\t\t\t<BIcon :name=\"Outline.PLUS_L\"/>\n\t\t\t</div>\n\t\t\t<div class=\"check-list-widget-add-item-title\">{{ loc('TASKS_V2_CHECK_LIST_ITEM_ADD_BTN') }}</div>\n\t\t</div>\n\t`,\n};\n","// @vue/component\nexport const CheckListDropList = {\n\tname: 'CheckListDropList',\n\ttemplate: `\n\t\t<div class=\"check-list-widget-drop-list\"/>\n\t`,\n};\n","// @vue/component\nexport const CheckListDropItem = {\n\tname: 'CheckListDropItem',\n\tprops: {\n\t\tdropOffset: {\n\t\t\ttype: String,\n\t\t\tdefault: '0',\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"check-list-widget-drop-item\" :style=\"{ marginLeft: dropOffset }\"/>\n\t`,\n};\n","import { BIcon, Actions, Outline } from 'ui.icon-set.api.vue';\n\nimport 'ui.icon-set.actions';\nimport 'ui.icon-set.outline';\n\n// @vue/component\nexport const CheckListGroupCompletedList = {\n\tname: 'CheckListGroupCompletedList',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\ttotalCompletedParents: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tActions,\n\t\t\tOutline,\n\t\t};\n\t},\n\tcomputed: {\n\t\tcompletedParentsLabel(): string\n\t\t{\n\t\t\treturn this.loc(\n\t\t\t\t'TASKS_V2_CHECK_LIST_PREVIEW_COMPLETED',\n\t\t\t\t{ '#number#': this.totalCompletedParents },\n\t\t\t);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"check-list-widget-group-completed-list\">\n\t\t\t<div class=\"check-list-widget-group-completed-list-icon\">\n\t\t\t\t<BIcon :name=\"Outline.CHECK_L\"/>\n\t\t\t</div>\n\t\t\t<div class=\"check-list-widget-group-completed-list-title\">\n\t\t\t\t{{ completedParentsLabel }}\n\t\t\t</div>\n\t\t\t<div class=\"check-list-widget-group-completed-list-action\">\n\t\t\t\t<BIcon :name=\"Actions.CHEVRON_RIGHT\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { EventName, Model } from 'tasks.v2.const';\nimport { highlighter } from 'tasks.v2.lib.highlighter';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\n\nimport { Context } from '../../lib/check-list-const';\nimport { CheckListItemDragManager } from '../../lib/check-list-item-drag-manager';\nimport { CheckListListDragManager } from '../../lib/check-list-list-drag-manager';\nimport { CheckListManager } from '../../lib/check-list-manager';\n\nimport { CheckListParentItem } from './component/check-list-parent-item';\nimport { CheckListChildItem } from './component/check-list-child-item';\nimport { CheckListAddItem } from './component/check-list-add-item';\nimport { CheckListDropList } from './component/check-list-drop-list';\nimport { CheckListDropItem } from './component/check-list-drop-item';\nimport { CheckListGroupCompletedList } from './component/check-list-group-completed-list';\n\nimport './check-list-widget.css';\n\n// @vue/component\nexport const CheckListWidget = {\n\tname: 'CheckListWidget',\n\tcomponents: {\n\t\tCheckListParentItem,\n\t\tCheckListChildItem,\n\t\tCheckListAddItem,\n\t\tCheckListDropList,\n\t\tCheckListDropItem,\n\t\tCheckListGroupCompletedList,\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t},\n\tprops: {\n\t\tcontext: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tcheckListId: {\n\t\t\ttype: [Number, String],\n\t\t\tdefault: 0,\n\t\t},\n\t\tparentId: {\n\t\t\ttype: [Number, String],\n\t\t\tdefault: 0,\n\t\t},\n\t\tisPreview: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: [\n\t\t'show',\n\t\t'update',\n\t\t'addItem',\n\t\t'addItemFromBtn',\n\t\t'removeItem',\n\t\t'focus',\n\t\t'blur',\n\t\t'emptyBlur',\n\t\t'startGroupMode',\n\t\t'toggleGroupModeSelected',\n\t\t'openCheckList',\n\t],\n\tsetup(): { task: TaskModel } {},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tscrollContainer: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tcurrentUserId: `${Model.Interface}/currentUserId`,\n\t\t\tdisableCheckListAnimations: `${Model.Interface}/disableCheckListAnimations`,\n\t\t\tdraggedCheckListId: `${Model.Interface}/draggedCheckListId`,\n\t\t}),\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist);\n\t\t},\n\t\tparentCheckLists(): CheckListModel[] {\n\t\t\treturn this.checkLists\n\t\t\t\t.filter((checkList: CheckListModel) => {\n\t\t\t\t\tif (checkList.parentId !== 0 || checkList.hidden)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn !(this.isPreview && checkList.isComplete);\n\t\t\t\t})\n\t\t\t\t.sort((a: CheckListModel, b: CheckListModel) => {\n\t\t\t\t\tif (a.isComplete === b.isComplete)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn a.sortIndex - b.sortIndex;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn a.isComplete ? 1 : -1;\n\t\t\t\t});\n\t\t},\n\t\ttotalCompletedParents(): number\n\t\t{\n\t\t\treturn this.checkLists.filter((checkList: CheckListModel) => {\n\t\t\t\treturn checkList.parentId === 0 && checkList.isComplete;\n\t\t\t}).length;\n\t\t},\n\t\tsiblings(): CheckListModel[]\n\t\t{\n\t\t\treturn this.checkLists\n\t\t\t\t.filter((item: CheckListModel) => item.parentId === this.parentId)\n\t\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\t\t},\n\t\tcanAddItem(): boolean\n\t\t{\n\t\t\treturn this.task.rights.checklistAdd;\n\t\t},\n\t\tparentItemDragged(): boolean\n\t\t{\n\t\t\treturn this.checkListManager.isParentItem(this.draggedCheckListId);\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.checkListManager = new CheckListManager({\n\t\t\tcomputed: {\n\t\t\t\tcheckLists: () => this.checkLists,\n\t\t\t},\n\t\t});\n\n\t\tif (!this.isPreview)\n\t\t{\n\t\t\tthis.listDragManager = new CheckListListDragManager({\n\t\t\t\tstore: this.$store,\n\t\t\t\tcheckListManager: this.checkListManager,\n\t\t\t});\n\t\t\tthis.listDragManager.subscribe('update', (baseEvent: BaseEvent) => {\n\t\t\t\tconst draggedItemId = baseEvent.getData();\n\t\t\t\tthis.$emit('update', draggedItemId);\n\t\t\t});\n\t\t\tthis.listDragManager.subscribe('end', (baseEvent: BaseEvent) => {\n\t\t\t\tconst draggedItemId = baseEvent.getData();\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.scrollToTarget(draggedItemId, 0, false);\n\t\t\t\t\tthis.handleDropException();\n\t\t\t\t}, 100);\n\t\t\t});\n\n\t\t\tthis.itemDragManager = new CheckListItemDragManager({\n\t\t\t\tstore: this.$store,\n\t\t\t\tcheckListManager: this.checkListManager,\n\t\t\t\tcanAddItem: this.canAddItem,\n\t\t\t\tstubItemId: 'add-item',\n\t\t\t\tcurrentUserId: this.currentUserId,\n\t\t\t});\n\t\t\tthis.itemDragManager.subscribe('update', (baseEvent: BaseEvent) => {\n\t\t\t\tconst draggedItemId = baseEvent.getData();\n\t\t\t\tthis.$emit('update', draggedItemId);\n\t\t\t});\n\t\t\tthis.itemDragManager.subscribe('end', () => {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.handleDropException();\n\t\t\t\t}, 100);\n\t\t\t});\n\t\t}\n\t},\n\tmounted(): void\n\t{\n\t\tthis.scrollContainer = this.$el.parentElement;\n\n\t\tthis.subscribeToEvents();\n\n\t\tif (!this.isPreview)\n\t\t{\n\t\t\tthis.initDragManager();\n\t\t}\n\n\t\tthis.focusTo(this.checkListId);\n\n\t\tthis.$emit('show');\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.itemDragManager?.destroy();\n\t\tthis.unsubscribeFromEvents();\n\t},\n\tmethods: {\n\t\tsubscribeToEvents(): void\n\t\t{\n\t\t\tEventEmitter.subscribe(EventName.ShowCheckList, this.handleShowCheckListEvent);\n\t\t\tEventEmitter.subscribe(EventName.ShowCheckListItems, this.handleShowCheckListItemsEvent);\n\t\t},\n\t\tunsubscribeFromEvents(): void\n\t\t{\n\t\t\tEventEmitter.unsubscribe(EventName.ShowCheckList, this.handleShowCheckListEvent);\n\t\t\tEventEmitter.unsubscribe(EventName.ShowCheckListItems, this.handleShowCheckListItemsEvent);\n\t\t},\n\t\tfocusTo(checkListId: string | number): void\n\t\t{\n\t\t\tconst focusedItem = this.checkListManager.getItem(checkListId);\n\t\t\tif (!focusedItem)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { targetId, offset, shouldHighlight } = this.calculateFocusTarget(focusedItem);\n\n\t\t\tthis.scrollToTarget(targetId, offset, shouldHighlight);\n\t\t},\n\t\tcalculateFocusTarget(focusedItem: CheckListModel): {\n\t\t\ttargetId: string | number,\n\t\t\toffset: number,\n\t\t\tshouldHighlight: boolean,\n\t\t}\n\t\t{\n\t\t\tconst isRootItem = focusedItem.parentId === 0;\n\t\t\tif (!isRootItem)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\ttargetId: focusedItem.id,\n\t\t\t\t\toffset: 140,\n\t\t\t\t\tshouldHighlight: false,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst childWithEmptyTitle = this.checkListManager.getChildWithEmptyTitle(focusedItem.id);\n\n\t\t\treturn {\n\t\t\t\ttargetId: childWithEmptyTitle?.id ?? focusedItem.id,\n\t\t\t\toffset: childWithEmptyTitle ? 140 : 0,\n\t\t\t\tshouldHighlight: true,\n\t\t\t};\n\t\t},\n\t\tscrollToTarget(targetId: string | number, offset: number, shouldHighlight: boolean): void\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst targetNode = this.scrollContainer.querySelector(`[data-id=\"${targetId}\"]`);\n\t\t\t\tif (!targetNode)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (shouldHighlight)\n\t\t\t\t{\n\t\t\t\t\tthis.highlightParentContainer(targetId);\n\t\t\t\t}\n\n\t\t\t\tthis.scrollContainer.scrollTop = targetNode.offsetTop - offset;\n\t\t\t}, 0);\n\t\t},\n\t\thighlightParentContainer(targetId: string | number): void\n\t\t{\n\t\t\tconst highlightElement = this.scrollContainer.querySelector(`[data-parent-container=\"${targetId}\"]`);\n\t\t\tif (highlightElement)\n\t\t\t{\n\t\t\t\tvoid highlighter.highlight(highlightElement);\n\t\t\t}\n\t\t},\n\t\tgetItemOffset(item: CheckListModel): string\n\t\t{\n\t\t\tif (item.parentId === 0)\n\t\t\t{\n\t\t\t\treturn '0';\n\t\t\t}\n\n\t\t\tconst level = this.checkListManager.getItemLevel(item);\n\t\t\tif (level === 1)\n\t\t\t{\n\t\t\t\treturn '0';\n\t\t\t}\n\n\t\t\treturn `${(level - 1) * 28}px`;\n\t\t},\n\t\thandleDropException(): void\n\t\t{\n\t\t\tconst container = this.$el.closest('[data-list]');\n\t\t\tconst allItems = container.querySelectorAll('.check-list-widget-item.--dragged_item');\n\t\t\tallItems.forEach((item: HTMLElement) => item.remove());\n\t\t},\n\t\tgetChildren(parent: CheckListModel): CheckListModel[]\n\t\t{\n\t\t\treturn this.checkListManager\n\t\t\t\t.getAllChildren(parent.id)\n\t\t\t\t.filter((checkList: CheckListModel) => !checkList.hidden);\n\t\t},\n\t\tisCollapsed(item: CheckListModel, positionIndex: number): boolean\n\t\t{\n\t\t\tif (this.checkListManager.isParentItem(this.draggedCheckListId))\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn this.checkListManager.isItemCollapsed(item, this.isPreview, positionIndex);\n\t\t},\n\t\tgetFirstCompletedCheckList(): ?CheckListModel\n\t\t{\n\t\t\tconst completedCheckLists = this.checkLists\n\t\t\t\t.filter((checkList: CheckListModel) => {\n\t\t\t\t\treturn checkList.parentId === 0 && checkList.isComplete === true;\n\t\t\t\t})\n\t\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\n\t\t\treturn completedCheckLists[0];\n\t\t},\n\t\thandleShowCheckListEvent(event: BaseEvent): void\n\t\t{\n\t\t\tconst { checkListId } = event.getData();\n\t\t\tif (!checkListId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('openCheckList', checkListId);\n\n\t\t\tthis.focusTo(checkListId);\n\t\t},\n\t\tasync handleShowCheckListItemsEvent(event: BaseEvent): Promise<void>\n\t\t{\n\t\t\tconst { checkListItemIds } = event.getData();\n\n\t\t\tif (!Type.isArrayFilled(checkListItemIds))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst firstItemId = checkListItemIds[0];\n\n\t\t\tthis.focusTo(firstItemId);\n\n\t\t\tthis.$emit('openCheckList', firstItemId);\n\n\t\t\tawait this.$nextTick();\n\n\t\t\tcheckListItemIds.forEach((itemId: number) => {\n\t\t\t\tEventEmitter.emit(EventName.HighlightCheckListItem + itemId);\n\t\t\t});\n\t\t},\n\t\tshowFirstCompletedCheckList(): void\n\t\t{\n\t\t\tconst firstCompletedCheckList = this.getFirstCompletedCheckList();\n\n\t\t\tthis.$emit('openCheckList', firstCompletedCheckList.id);\n\t\t},\n\t\tinitDragManager(): void\n\t\t{\n\t\t\tlet offsetX = 0;\n\t\t\tif (\n\t\t\t\tthis.context !== Context.Popup\n\t\t\t\t&& Type.isElementNode(this.$root.$el)\n\t\t\t)\n\t\t\t{\n\t\t\t\tconst parentRect = Dom.getPosition(this.$el);\n\t\t\t\tconst parentRelativeRect = Dom.getRelativePosition(\n\t\t\t\t\tthis.$el,\n\t\t\t\t\tthis.$root.$el,\n\t\t\t\t);\n\n\t\t\t\toffsetX = parentRelativeRect.left - parentRect.left;\n\t\t\t}\n\n\t\t\tthis.listDragManager.init(this.scrollContainer, offsetX);\n\n\t\t\tconst listDropzone = this.canAddItem ? this.$refs.parentComponents?.map((parent) => parent.$el) : [];\n\n\t\t\tthis.itemDragManager.init(this.scrollContainer, offsetX, listDropzone);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"check-list-widget-container\">\n\t\t\t<TransitionGroup\n\t\t\t\t:css=\"!disableCheckListAnimations\"\n\t\t\t\tname=\"check-list\"\n\t\t\t\ttag=\"ul\"\n\t\t\t\tclass=\"check-list-widget --parent\"\n\t\t\t\t:class=\"{\n\t\t\t\t\t'--preview': isPreview,\n\t\t\t\t\t'--dragged': parentItemDragged,\n\t\t\t\t}\"\n\t\t\t>\n\t\t\t\t<li\n\t\t\t\t\tv-for=\"(parentItem, parentItemIndex) in parentCheckLists\"\n\t\t\t\t\t:key=\"'parent-' + parentItem.id + parentItemIndex\"\n\t\t\t\t\tclass=\"check-list-widget-item --parent check-list-draggable-list\"\n\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t'--preview': isPreview,\n\t\t\t\t\t\t'--collapsed': isCollapsed(parentItem, parentItemIndex),\n\t\t\t\t\t\t'--hidden': parentItem.hidden,\n\t\t\t\t\t\t'--dragged_item': parentItem.id === draggedCheckListId,\n\t\t\t\t\t}\"\n\t\t\t\t\t:data-id=\"parentItem.id\"\n\t\t\t\t\t:data-parent-container=\"parentItem.id\"\n\t\t\t\t>\n\t\t\t\t\t<template v-if=\"parentItem.id === draggedCheckListId\">\n\t\t\t\t\t\t<CheckListDropList/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<CheckListParentItem\n\t\t\t\t\t\t\tref=\"parentComponents\"\n\t\t\t\t\t\t\t:id=\"parentItem.id\"\n\t\t\t\t\t\t\t:isPreview\n\t\t\t\t\t\t\t:positionIndex=\"parentItemIndex\"\n\t\t\t\t\t\t\t@update=\"(id) => $emit('update', id)\"\n\t\t\t\t\t\t\t@removeItem=\"(id) => $emit('removeItem', id)\"\n\t\t\t\t\t\t\t@focus=\"(id) => $emit('focus', id)\"\n\t\t\t\t\t\t\t@blur=\"(id) => $emit('blur', id)\"\n\t\t\t\t\t\t\t@emptyBlur=\"(id) => $emit('emptyBlur', id)\"\n\t\t\t\t\t\t\t@startGroupMode=\"(id) => $emit('startGroupMode', id)\"\n\t\t\t\t\t\t\t@openCheckList=\"(id) => $emit('openCheckList', id)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<TransitionGroup\n\t\t\t\t\t\tv-if=\"parentItem.id !== draggedCheckListId\"\n\t\t\t\t\t\t:css=\"!disableCheckListAnimations\"\n\t\t\t\t\t\tname=\"check-list\"\n\t\t\t\t\t\ttag=\"ul\"\n\t\t\t\t\t\tclass=\"check-list-widget\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<li\n\t\t\t\t\t\t\tv-if=\"!isCollapsed(parentItem, parentItemIndex)\"\n\t\t\t\t\t\t\tv-for=\"(childItem, childIndex) in getChildren(parentItem)\"\n\t\t\t\t\t\t\t:key=\"'child-' + parentItem.id + childItem.id + childIndex\"\n\t\t\t\t\t\t\t:data-id=\"childItem.id\"\n\t\t\t\t\t\t\tclass=\"check-list-widget-item check-list-draggable-item\"\n\t\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t\t'--dragged_item': childItem.id === draggedCheckListId,\n\t\t\t\t\t\t\t}\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<template v-if=\"childItem.id === draggedCheckListId\">\n\t\t\t\t\t\t\t\t<CheckListDropItem :dropOffset=\"getItemOffset(childItem)\"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<CheckListChildItem\n\t\t\t\t\t\t\t\t\t:id=\"childItem.id\"\n\t\t\t\t\t\t\t\t\t:itemOffset=\"getItemOffset(childItem)\"\n\t\t\t\t\t\t\t\t\t:isPreview\n\t\t\t\t\t\t\t\t\t:checkListId\n\t\t\t\t\t\t\t\t\t@update=\"(id) => $emit('update', id)\"\n\t\t\t\t\t\t\t\t\t@addItem=\"(data) => $emit('addItem', data)\"\n\t\t\t\t\t\t\t\t\t@removeItem=\"(id) => $emit('removeItem', id)\"\n\t\t\t\t\t\t\t\t\t@focus=\"(id) => $emit('focus', id)\"\n\t\t\t\t\t\t\t\t\t@blur=\"(id) => $emit('blur', id)\"\n\t\t\t\t\t\t\t\t\t@emptyBlur=\"(id) => $emit('emptyBlur', id)\"\n\t\t\t\t\t\t\t\t\t@toggleGroupModeSelected=\"(id) => $emit('toggleGroupModeSelected', id)\"\n\t\t\t\t\t\t\t\t\t@openCheckList=\"(id) => $emit('openCheckList', id)\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li\n\t\t\t\t\t\t\tv-if=\"!isCollapsed(parentItem, parentItemIndex)\"\n\t\t\t\t\t\t\t:key=\"'add-' + parentItem.id + parentItemIndex\"\n\t\t\t\t\t\t\tdata-id=\"add-item\"\n\t\t\t\t\t\t\t:data-parent-id=\"parentItem.id\"\n\t\t\t\t\t\t\tclass=\"check-list-widget-item check-list-draggable-item\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<CheckListAddItem\n\t\t\t\t\t\t\t\tv-if=\"canAddItem\"\n\t\t\t\t\t\t\t\t:isPreview\n\t\t\t\t\t\t\t\t@addItem=\"$emit('addItemFromBtn', parentItem.id)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</TransitionGroup>\n\t\t\t\t</li>\n\t\t\t\t<li\n\t\t\t\t\tv-if=\"isPreview && totalCompletedParents > 0\"\n\t\t\t\t\tkey=\"completed-list\"\n\t\t\t\t\tclass=\"check-list-widget-item --completed-list\"\n\t\t\t\t>\n\t\t\t\t\t<CheckListGroupCompletedList :totalCompletedParents @click=\"showFirstCompletedCheckList\"/>\n\t\t\t\t</li>\n\t\t\t</TransitionGroup>\n\t\t</div>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.vue';\n\nexport const PanelSection = Object.freeze({\n\tImportant: 'important',\n\tAttachments: 'attachments',\n\tMovement: 'movement',\n\tAccomplice: 'accomplice',\n\tAuditor: 'auditor',\n\tForward: 'forward',\n\tDelete: 'delete',\n\tCancel: 'cancel',\n});\n\nexport const PanelAction = Object.freeze({\n\tSetImportant: 'setImportant',\n\tAttachFile: 'attachFile',\n\tMoveRight: 'moveRight',\n\tMoveLeft: 'moveLeft',\n\tAssignAccomplice: 'assignAccomplice',\n\tAssignAuditor: 'assignAuditor',\n\tForward: 'forward',\n\tDelete: 'delete',\n\tCancel: 'cancel',\n});\n\nexport const PanelMeta = Object.freeze({\n\tdefaultSections: [\n\t\t{\n\t\t\tname: PanelSection.Important,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.FIRE,\n\t\t\t\t\tactiveIcon: Outline.FIRE_SOLID,\n\t\t\t\t\taction: PanelAction.SetImportant,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_IMPORTANT_HINT',\n\t\t\t\t\tclassName: '--important',\n\t\t\t\t\thoverable: false,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tname: PanelSection.Attachments,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.ATTACH,\n\t\t\t\t\taction: PanelAction.AttachFile,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_ATTACH_HINT',\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tname: PanelSection.Movement,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.POINT_RIGHT,\n\t\t\t\t\taction: PanelAction.MoveRight,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_MOVE_RIGHT_HINT',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.POINT_LEFT,\n\t\t\t\t\taction: PanelAction.MoveLeft,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_MOVE_LEFT_HINT',\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tname: PanelSection.Accomplice,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.PERSON,\n\t\t\t\t\taction: PanelAction.AssignAccomplice,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_ACCOMPLICE_HINT',\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tname: PanelSection.Auditor,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.OBSERVER,\n\t\t\t\t\taction: PanelAction.AssignAuditor,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_AUDITOR_HINT',\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tname: PanelSection.Forward,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.FORWARD,\n\t\t\t\t\taction: PanelAction.Forward,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_FORWARD_HINT',\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tname: PanelSection.Delete,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.TRASHCAN,\n\t\t\t\t\taction: PanelAction.Delete,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_REMOVE_HINT',\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tname: PanelSection.Cancel,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.CROSS_L,\n\t\t\t\t\taction: PanelAction.Cancel,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_CANCEL_HINT',\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t].filter(Boolean),\n});\n\nexport type Section = {\n\tname: string,\n\titems: Item[],\n};\n\nexport type Item = {\n\ticon: string,\n\tactiveIcon?: string,\n\taction: string,\n\tlabel?: string,\n\thint?: string,\n\tactive?: boolean,\n\thoverable?: boolean,\n\tdisabled?: boolean,\n\tclassName?: string,\n};\n\nexport type VisibleSections = Section[];\nexport type VisibleActions = string[];\nexport type ActiveActions = string[];\n","import { hint, type HintParams } from 'ui.vue3.directives.hint';\nimport { BIcon } from 'ui.icon-set.api.vue';\n\nimport { Core } from 'tasks.v2.core';\nimport { Model } from 'tasks.v2.const';\n\nimport 'tasks.v2.component.elements.hint';\n\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { PanelAction, PanelSection, PanelMeta } from './check-list-item-panel-meta';\nimport { CheckListManager } from '../../lib/check-list-manager';\n\nimport type { VisibleSections, VisibleActions, Section, Item, ActiveActions } from './check-list-item-panel-meta';\n\nimport './check-list-item-panel.css';\n\n// @vue/component\nexport const CheckListItemPanel = {\n\tname: 'CheckListItemPanel',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tdirectives: { hint },\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t\tisEdit: {},\n\t},\n\tprops: {\n\t\tcurrentItem: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => null,\n\t\t},\n\t},\n\temits: ['action'],\n\tsetup(): { task: TaskModel } {},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcurrentHintElement: null,\n\t\t\tcurrentHintText: '',\n\t\t};\n\t},\n\tcomputed: {\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist);\n\t\t},\n\t\tisStakeholdersRestricted(): boolean\n\t\t{\n\t\t\treturn !Core.getParams().restrictions.stakeholder.available;\n\t\t},\n\t\tsections(): VisibleSections\n\t\t{\n\t\t\treturn PanelMeta.defaultSections\n\t\t\t\t.filter((section) => this.visibleSections.includes(section.name) && this.canShowPanelSection(section.name))\n\t\t\t\t.map((section) => ({\n\t\t\t\t\t...section,\n\t\t\t\t\titems: section.items\n\t\t\t\t\t\t.filter((item: Item) => this.visibleActions.includes(item.action))\n\t\t\t\t\t\t.map((item: Item) => ({\n\t\t\t\t\t\t\t...item,\n\t\t\t\t\t\t\tdisabled: this.isItemDisabled(item),\n\t\t\t\t\t\t\tactive: this.isItemActive(item),\n\t\t\t\t\t\t\thoverable: item.hoverable ?? true,\n\t\t\t\t\t\t})),\n\t\t\t\t}))\n\t\t\t\t.filter((section) => section.items.length > 0)\n\t\t\t;\n\t\t},\n\t\ttooltip(): Function\n\t\t{\n\t\t\treturn (): HintParams => ({\n\t\t\t\ttext: this.currentHintText,\n\t\t\t\ttimeout: 500,\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tclassName: 'tasks-hint',\n\t\t\t\t\tbackground: 'var(--ui-color-bg-content-inapp)',\n\t\t\t\t\tdarkMode: false,\n\t\t\t\t\toffsetLeft: -(this.currentHintElement?.offsetWidth ?? 0),\n\t\t\t\t\tpadding: 6,\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tforceBindPosition: true,\n\t\t\t\t\t\tforceTop: true,\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tvisibleSections(): VisibleSections\n\t\t{\n\t\t\treturn PanelMeta.defaultSections.map((section: Section) => section.name);\n\t\t},\n\t\tvisibleActions(): VisibleActions\n\t\t{\n\t\t\tif (!this.currentItem)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tlet actions = [\n\t\t\t\tPanelAction.SetImportant,\n\t\t\t\tPanelAction.MoveRight,\n\t\t\t\tPanelAction.MoveLeft,\n\t\t\t\tPanelAction.AssignAccomplice,\n\t\t\t\tPanelAction.AssignAuditor,\n\t\t\t\tPanelAction.Forward,\n\t\t\t\tPanelAction.Delete,\n\t\t\t];\n\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tactions.push(PanelAction.Cancel);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tactions.push(PanelAction.AttachFile);\n\t\t\t}\n\n\t\t\tif (this.currentItem.parentId === 0)\n\t\t\t{\n\t\t\t\tactions = [\n\t\t\t\t\tPanelAction.AssignAccomplice,\n\t\t\t\t\tPanelAction.AssignAuditor,\n\t\t\t\t];\n\t\t\t}\n\n\t\t\tconst stakeholdersActions = new Set([\n\t\t\t\tPanelAction.AssignAccomplice,\n\t\t\t\tPanelAction.AssignAuditor,\n\t\t\t]);\n\n\t\t\treturn actions.filter((action: string) => {\n\t\t\t\tconst isDisabledStakeholders = stakeholdersActions.has(action) && this.isStakeholdersRestricted;\n\n\t\t\t\treturn !isDisabledStakeholders;\n\t\t\t});\n\t\t},\n\t\tdisabledActions(): []\n\t\t{\n\t\t\tif (!this.currentItem)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst disabledActions = [];\n\n\t\t\tconst itemLevel = this.checkListManager.getItemLevel(this.currentItem);\n\t\t\tconst canModify = this.currentItem.actions.modify === true;\n\t\t\tconst canRemove = this.currentItem.actions.remove === true;\n\n\t\t\tconst conditionHandlers = {\n\t\t\t\t[PanelAction.SetImportant]: () => {\n\t\t\t\t\treturn canModify === false;\n\t\t\t\t},\n\t\t\t\t[PanelAction.AttachFile]: () => {\n\t\t\t\t\treturn canModify === false;\n\t\t\t\t},\n\t\t\t\t[PanelAction.MoveLeft]: () => {\n\t\t\t\t\treturn itemLevel === 1 || canModify === false;\n\t\t\t\t},\n\t\t\t\t[PanelAction.MoveRight]: () => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\titemLevel === 5\n\t\t\t\t\t\t|| this.currentItem.sortIndex === 0\n\t\t\t\t\t\t|| canModify === false\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\t[PanelAction.AssignAccomplice]: () => {\n\t\t\t\t\treturn canModify === false || this.canChangeAccomplices === false;\n\t\t\t\t},\n\t\t\t\t[PanelAction.AssignAuditor]: () => {\n\t\t\t\t\treturn canModify === false || this.canAuditorsAdd === false;\n\t\t\t\t},\n\t\t\t\t[PanelAction.Forward]: () => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\tcanModify === false\n\t\t\t\t\t\t|| this.currentItem.title === ''\n\t\t\t\t\t\t|| !this.canCheckListAdd\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\t[PanelAction.Delete]: () => {\n\t\t\t\t\treturn canRemove === false;\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tObject.entries(conditionHandlers)\n\t\t\t\t.forEach(([action: string, condition: function]) => {\n\t\t\t\t\tif (condition())\n\t\t\t\t\t{\n\t\t\t\t\t\tdisabledActions.push(action);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\n\t\t\treturn disabledActions;\n\t\t},\n\t\tactiveActions(): ActiveActions\n\t\t{\n\t\t\tif (!this.currentItem)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst actions = [];\n\n\t\t\tif (this.currentItem.isImportant)\n\t\t\t{\n\t\t\t\tactions.push(PanelAction.SetImportant);\n\t\t\t}\n\n\t\t\treturn actions;\n\t\t},\n\t\titemGroupModeSelected(): boolean\n\t\t{\n\t\t\tif (!this.currentItem)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.currentItem.groupMode?.selected === true;\n\t\t},\n\t\tcanCheckListAdd(): boolean\n\t\t{\n\t\t\tif (!this.isEdit)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn this.task.rights.checklistAdd;\n\t\t},\n\t\tcanAuditorsAdd(): boolean\n\t\t{\n\t\t\tif (!this.isEdit)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn this.task.rights.addAuditors;\n\t\t},\n\t\tcanChangeAccomplices(): boolean\n\t\t{\n\t\t\tif (!this.isEdit)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn this.task.rights.changeAccomplices;\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.checkListManager = new CheckListManager({\n\t\t\tcomputed: {\n\t\t\t\tcheckLists: () => this.checkLists,\n\t\t\t},\n\t\t});\n\t},\n\tmethods: {\n\t\tisItemDisabled(item: Item): boolean\n\t\t{\n\t\t\treturn item.disabled ?? this.disabledActions.includes(item.action);\n\t\t},\n\t\tisItemActive(item: Item): boolean\n\t\t{\n\t\t\treturn item.active ?? this.activeActions.includes(item.action);\n\t\t},\n\t\tgetItemIcon(item: Item): string\n\t\t{\n\t\t\treturn (item.active && item.activeIcon) ? item.activeIcon : item.icon;\n\t\t},\n\t\thandleItemClick(event: MouseEvent, item: Item): void\n\t\t{\n\t\t\tif (!item.disabled)\n\t\t\t{\n\t\t\t\tthis.$emit('action', {\n\t\t\t\t\taction: item.action,\n\t\t\t\t\tnode: event.currentTarget,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\thandleItemMouseEnter(event: MouseEvent, item: Item): void\n\t\t{\n\t\t\tthis.currentHintElement = event.currentTarget;\n\t\t\tthis.currentHintText = item.hint ? this.loc(item.hint) : null;\n\t\t},\n\t\tcanShowPanelSection(sectionName: string): boolean\n\t\t{\n\t\t\treturn !(sectionName === PanelSection.Attachments && !Core.getParams().features.disk);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"sections.length > 0\" class=\"check-list-widget-item-panel\" @mousedown.prevent>\n\t\t\t<template v-for=\"section in sections\" :key=\"section.name\">\n\t\t\t\t<div class=\"check-list-widget-item-panel-section\" :class=\"'--' + section.name\">\n\t\t\t\t\t<template v-for=\"item in section.items\" :key=\"item.action\" >\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-hint=\"tooltip\"\n\t\t\t\t\t\t\tclass=\"check-list-widget-item-panel-section-item\"\n\t\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t\t'--disabled': item.disabled,\n\t\t\t\t\t\t\t\t'--active': item.active,\n\t\t\t\t\t\t\t\t[item.className]: Boolean(item.className),\n\t\t\t\t\t\t\t}\"\n\t\t\t\t\t\t\t@click=\"handleItemClick($event, item)\"\n\t\t\t\t\t\t\t@mouseenter=\"handleItemMouseEnter($event, item)\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<BIcon :name=\"getItemIcon(item)\" :hoverable=\"item.hoverable\"/>\n\t\t\t\t\t\t\t<span v-if=\"item.label\">{{ loc(item.label) }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { Loc, Text, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { UI } from 'ui.notification';\n\ntype Params = {\n\tcontent: string,\n\ttimerValue?: number,\n}\n\nexport class CheckListNotifier extends EventEmitter\n{\n\t#interval: ?number = null;\n\t#timerValue: number = 5;\n\t#counter: number = 5;\n\t#content: string = '';\n\n\t#balloonWithTimer: BX.UI.Notification.Balloon;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('Tasks.V2.CheckList.CheckListNotifier');\n\n\t\tthis.#content = params.content;\n\t\tthis.#timerValue = Type.isUndefined(params.timerValue) ? this.#timerValue : params.timerValue;\n\t}\n\n\tshowBalloonWithTimer(): void\n\t{\n\t\tthis.#counter = this.#timerValue;\n\n\t\tconst balloonId = `check-list-balloon-${Text.getRandom()}`;\n\n\t\tthis.#balloonWithTimer = UI.Notification.Center.notify({\n\t\t\tid: balloonId,\n\t\t\tcontent: this.#getBalloonContent(),\n\t\t\tactions: [{\n\t\t\t\ttitle: Loc.getMessage('TASKS_V2_CHECK_LIST_BALLOON_CANCEL'),\n\t\t\t\tevents: {\n\t\t\t\t\tmouseup: this.#handleCancelClick.bind(this),\n\t\t\t\t},\n\t\t\t}],\n\t\t});\n\n\t\tconst handler = (baseEvent: BaseEvent) => {\n\t\t\tconst closingBalloon = baseEvent.getTarget();\n\t\t\tif (closingBalloon.getId() === balloonId)\n\t\t\t{\n\t\t\t\tthis.#handleClosingBalloon();\n\n\t\t\t\tEventEmitter.unsubscribe('UI.Notification.Balloon:onClose', handler);\n\t\t\t}\n\t\t};\n\n\t\tEventEmitter.subscribe('UI.Notification.Balloon:onClose', handler);\n\n\t\tthis.#startTimer();\n\t}\n\n\tstopTimer(): void\n\t{\n\t\tthis.#balloonWithTimer.close();\n\t}\n\n\t#startTimer(): void\n\t{\n\t\tthis.#interval = setInterval(() => {\n\t\t\tthis.#counter--;\n\n\t\t\tthis.#balloonWithTimer.update({ content: this.#getBalloonContent() });\n\n\t\t\tif (this.#counter <= 0)\n\t\t\t{\n\t\t\t\tthis.stopTimer();\n\t\t\t}\n\t\t}, 1000);\n\t}\n\n\t#handleCancelClick()\n\t{\n\t\tthis.emit('complete', false);\n\n\t\tthis.#balloonWithTimer.close();\n\t}\n\n\t#handleClosingBalloon()\n\t{\n\t\tclearInterval(this.#interval);\n\n\t\tthis.emit('complete', true);\n\t}\n\n\t#getBalloonContent(): string\n\t{\n\t\treturn this.#content.replace('#countdown#', this.#counter);\n\t}\n}\n","import { Dom, Event, Text, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport { mapActions, mapGetters } from 'ui.vue3.vuex';\nimport type { BitrixVueComponentProps } from 'ui.vue3';\nimport type { MenuItemOptions, MenuOptions } from 'ui.system.menu';\nimport { Button as UiButton, AirButtonStyle, ButtonSize, ButtonIcon } from 'ui.vue3.components.button';\nimport { BMenu } from 'ui.vue3.components.menu';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport { Model } from 'tasks.v2.const';\nimport { usersDialog } from 'tasks.v2.lib.user-selector-dialog';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { checkListService } from 'tasks.v2.provider.service.check-list-service';\nimport { EntityTypes, FileService, fileService } from 'tasks.v2.provider.service.file-service';\n\nimport { highlighter } from 'tasks.v2.lib.highlighter';\nimport type { UserModel } from 'tasks.v2.model.users';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { checkListMeta } from '../../lib/check-list-meta';\nimport { CheckListStub } from './check-list-stub';\nimport { CheckListPopup } from '../check-list-popup/check-list-popup';\nimport { CheckListSheet } from '../check-list-sheet/check-list-sheet';\nimport { CheckListList } from '../check-list-list/check-list-list';\nimport { CheckListWidget } from '../check-list-widget/check-list-widget';\nimport { CheckListItemPanel } from '../check-list-item-panel/check-list-item-panel';\n\nimport { Context } from '../../lib/check-list-const';\nimport { CheckListManager } from '../../lib/check-list-manager';\nimport { CheckListNotifier } from '../../lib/check-list-notifier';\n\nimport { PanelAction } from '../check-list-item-panel/check-list-item-panel-meta';\n\nimport './check-list.css';\n\n// @vue/component\nexport const CheckList = {\n\tname: 'TaskCheckList',\n\tcomponents: {\n\t\tCheckListWidget,\n\t\tCheckListItemPanel,\n\t\tCheckListStub,\n\t\tUiButton,\n\t\tBIcon,\n\t\tBMenu,\n\t},\n\tprovide(): Object\n\t{\n\t\treturn {\n\t\t\tsetItemsRef: this.setItemsRef,\n\t\t\tgetItemsRef: this.getItemsRef,\n\t\t};\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t\tisEdit: {},\n\t},\n\tprops: {\n\t\tisAutonomous: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tisPreview: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tisComponentShown: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tcheckListId: {\n\t\t\ttype: [Number, String],\n\t\t\tdefault: 0,\n\t\t},\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tsheetBindProps: {\n\t\t\ttype: Object,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\temits: ['show', 'close', 'resize', 'open'],\n\tsetup(): { task: TaskModel }\n\t{\n\t\treturn {\n\t\t\tresizeObserver: null,\n\t\t\tAirButtonStyle,\n\t\t\tButtonSize,\n\t\t\tButtonIcon,\n\t\t\tOutline,\n\t\t\tcheckListMeta,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\titemPanelIsShown: false,\n\t\t\tcheckListWasUpdated: false,\n\t\t\tlastUpdatedCheckListId: 0,\n\t\t\titemId: null,\n\t\t\titemPanelStyles: {\n\t\t\t\ttop: '0',\n\t\t\t\tdisplay: 'flex',\n\t\t\t},\n\t\t\tisItemPanelFreeze: false,\n\t\t\titemPanelTopOffset: this.isAutonomous ? 5 : 2,\n\t\t\titemPanelTopLimit: this.isAutonomous ? 450 : 700,\n\t\t\titemsRefs: {},\n\t\t\tisForwardMenuShown: false,\n\t\t\tforwardMenuSectionCode: 'createSection',\n\t\t\tforwardBindElement: null,\n\t\t\tshownPopups: new Set(),\n\t\t\tnotifiers: new Map(),\n\t\t\tisFreeze: false,\n\t\t\tclosing: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tcurrentUserId: `${Model.Interface}/currentUserId`,\n\t\t\tdeletingCheckListIds: `${Model.Interface}/deletingCheckListIds`,\n\t\t\tcheckListCompletionCallback: `${Model.Interface}/checkListCompletionCallback`,\n\t\t\tdraggedCheckListId: `${Model.Interface}/draggedCheckListId`,\n\t\t}),\n\t\tcomponentName(): BitrixVueComponentProps\n\t\t{\n\t\t\treturn {\n\t\t\t\t[Context.Sheet]: CheckListSheet,\n\t\t\t\t[Context.Popup]: CheckListPopup,\n\t\t\t\t[Context.Preview]: CheckListList,\n\t\t\t}[this.context];\n\t\t},\n\t\tcontext(): string\n\t\t{\n\t\t\treturn {\n\t\t\t\t[true]: Context.Sheet,\n\t\t\t\t[this.isAutonomous]: Context.Popup,\n\t\t\t\t[this.isPreview]: Context.Preview,\n\t\t\t}.true;\n\t\t},\n\t\tcontextClass(): string\n\t\t{\n\t\t\treturn `--${this.context}`;\n\t\t},\n\t\tcomponentShown(): boolean\n\t\t{\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\treturn this.isComponentShown;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\tif (!this.task)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist);\n\t\t},\n\t\tparentCheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.checkLists.filter((checkList: CheckListModel) => checkList.parentId === 0);\n\t\t},\n\t\thasFewParentCheckLists(): boolean\n\t\t{\n\t\t\treturn this.parentCheckLists.length > 1;\n\t\t},\n\t\tcurrentItem(): ?CheckListModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getById`](this.itemId);\n\t\t},\n\t\titemGroupModeSelected(): boolean\n\t\t{\n\t\t\tif (!this.currentItem)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.currentItem.groupMode?.selected === true;\n\t\t},\n\t\tforwardMenuOptions(): MenuOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: `check-list-item-forward-menu-${this.currentItem.id}`,\n\t\t\t\tbindElement: this.forwardBindElement,\n\t\t\t\tmaxWidth: 400,\n\t\t\t\tmaxHeight: 300,\n\t\t\t\toffsetLeft: -110,\n\t\t\t\tsections: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: this.forwardMenuSectionCode,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: this.forwardMenuItems,\n\t\t\t\ttargetContainer: document.body,\n\t\t\t};\n\t\t},\n\t\tforwardMenuItems(): MenuItemOptions[]\n\t\t{\n\t\t\tconst checklistItems = this.parentCheckLists\n\t\t\t\t.filter((checkList: CheckListModel) => checkList.id !== this.currentItem.parentId)\n\t\t\t\t.map((checkList: CheckListModel) => ({\n\t\t\t\t\ttitle: checkList.title,\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\tid: `ForwardMenuCheckList-${checkList.id}`,\n\t\t\t\t\t},\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\tthis.hideItemPanel();\n\t\t\t\t\t\tif (this.itemGroupModeSelected)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvoid this.forwardGroupItemsToChecklist(this.currentItem.id, checkList.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.forwardToChecklist(this.currentItem.id, checkList.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}));\n\n\t\t\treturn [\n\t\t\t\t...checklistItems,\n\t\t\t\t{\n\t\t\t\t\tsectionCode: this.forwardMenuSectionCode,\n\t\t\t\t\ttitle: this.loc('TASKS_V2_CHECK_LIST_ITEM_FORWARD_MENU_CREATE'),\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\tid: `ForwardMenuCreateNew-${this.currentItem.id}`,\n\t\t\t\t\t},\n\t\t\t\t\tonClick: this.forwardToNewChecklist.bind(this, this.currentItem.id),\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tstub(): boolean\n\t\t{\n\t\t\treturn this.checkLists.length === 0 || this.emptyList === true;\n\t\t},\n\t\temptyList(): boolean\n\t\t{\n\t\t\tconst siblings = this.parentCheckLists\n\t\t\t\t.filter((item: CheckListModel) => !this.deletingCheckListIds[item.id]);\n\n\t\t\treturn siblings.length === 0;\n\t\t},\n\t\tparentItemDragged(): boolean\n\t\t{\n\t\t\treturn this.checkListManager.isParentItem(this.draggedCheckListId);\n\t\t},\n\t\tcanCheckListAdd(): boolean\n\t\t{\n\t\t\tif (!this.isEdit)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn this.task.rights.checklistAdd;\n\t\t},\n\t},\n\twatch: {\n\t\tasync titleFieldOffsetHeight(): Promise<void>\n\t\t{\n\t\t\tif (!this.$refs.popupComponent)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.$nextTick();\n\t\t\tthis.resize();\n\t\t},\n\t\tcomponentShown(value: boolean): void\n\t\t{\n\t\t\tif (!this.isPreview)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.executeCheckListCompletionCallbacks();\n\n\t\t\tvoid this.$nextTick(() => {\n\t\t\t\tif (value)\n\t\t\t\t{\n\t\t\t\t\tthis.subscribeToEvents();\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.checkListId\n\t\t\t\t\t\t&& this.checkListManager.getItem(this.checkListId)\n\t\t\t\t\t\t&& this.$refs.list\n\t\t\t\t\t)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.scrollToCheckList(this.checkListId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.unsubscribeFromEvents();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tcheckListWasUpdated(value: boolean): void\n\t\t{\n\t\t\tif (!this.currentItem)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (value === true)\n\t\t\t{\n\t\t\t\tconst parentItem = this.checkListManager.getRootParentByChildId(this.currentItem.id);\n\n\t\t\t\tthis.lastUpdatedCheckListId = parentItem ? parentItem.id : 0;\n\t\t\t}\n\t\t},\n\t\tcheckListId(value: boolean): void\n\t\t{\n\t\t\tconst isNewCheckList = Type.isString(value);\n\t\t\tif (isNewCheckList)\n\t\t\t{\n\t\t\t\tthis.checkListWasUpdated = true;\n\t\t\t}\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.checkListManager = new CheckListManager({\n\t\t\tcomputed: {\n\t\t\t\tcheckLists: () => this.checkLists,\n\t\t\t},\n\t\t});\n\t},\n\tmounted(): void\n\t{\n\t\tif (this.isAutonomous || this.isPreview)\n\t\t{\n\t\t\tthis.subscribeToEvents();\n\t\t}\n\t},\n\tasync beforeUnmount(): Promise<void>\n\t{\n\t\tif (this.isAutonomous || this.isPreview)\n\t\t{\n\t\t\tthis.unsubscribeFromEvents();\n\t\t}\n\n\t\tif (this.isPreview)\n\t\t{\n\t\t\tthis.executeCheckListCompletionCallbacks();\n\n\t\t\tif (this.isEdit)\n\t\t\t{\n\t\t\t\tawait checkListService.forceSavePending(this.taskId);\n\t\t\t}\n\t\t}\n\t},\n\tmethods: {\n\t\t...mapActions(Model.Interface, [\n\t\t\t'addCheckListItemToDeleting',\n\t\t\t'removeCheckListItemFromDeleting',\n\t\t\t'executeCheckListCompletionCallbacks',\n\t\t]),\n\t\tsubscribeToEvents(): void\n\t\t{\n\t\t\tEvent.bind(this.$refs.list, 'scroll', this.handleScroll);\n\n\t\t\tEventEmitter.subscribe('BX.Main.Popup:onShow', this.handleShowPopup);\n\t\t\tEventEmitter.subscribe('BX.Main.Popup:onClose', this.handleClosePopup);\n\t\t\tEventEmitter.subscribe('BX.Main.Popup:onDestroy', this.handleClosePopup);\n\t\t},\n\t\tunsubscribeFromEvents(): void\n\t\t{\n\t\t\tEvent.unbind(this.$refs.list, 'scroll', this.handleScroll);\n\n\t\t\tEventEmitter.unsubscribe('BX.Main.Popup:onShow', this.handleShowPopup);\n\t\t\tEventEmitter.unsubscribe('BX.Main.Popup:onClose', this.handleClosePopup);\n\t\t\tEventEmitter.unsubscribe('BX.Main.Popup:onDestroy', this.handleClosePopup);\n\t\t},\n\t\tscrollToCheckList(checkListId: number | string): void\n\t\t{\n\t\t\tthis.checkListManager.scrollToCheckList(this.$refs.list, checkListId);\n\t\t},\n\t\thandleUpdate(itemId: number | string): void\n\t\t{\n\t\t\tthis.itemId = itemId;\n\n\t\t\tthis.handleUpdatingFreezeState();\n\n\t\t\tthis.checkListWasUpdated = true;\n\t\t},\n\t\thandleUpdatingFreezeState(): void\n\t\t{\n\t\t\tif (!this.isFreeze && (this.hasEmptyItem() || this.getItemIdWithUploadingFiles()))\n\t\t\t{\n\t\t\t\tthis.freeze();\n\t\t\t}\n\n\t\t\tif (this.isFreeze)\n\t\t\t{\n\t\t\t\tthis.unfreeze();\n\t\t\t}\n\t\t},\n\t\thandleRemove(itemId: number | string): void\n\t\t{\n\t\t\tthis.itemId = itemId;\n\n\t\t\tthis.freeze();\n\n\t\t\tthis.addItemToDelete(itemId);\n\n\t\t\tthis.checkListManager.hideItems(\n\t\t\t\t[itemId],\n\t\t\t\t(updates: CheckListModel[]) => this.upsertCheckLists(updates),\n\t\t\t);\n\n\t\t\tconst messageKey = (\n\t\t\t\tthis.currentItem.parentId === 0\n\t\t\t\t\t? 'TASKS_V2_CHECK_LIST_ITEM_REMOVE_BALLOON_PARENT'\n\t\t\t\t\t: 'TASKS_V2_CHECK_LIST_ITEM_REMOVE_BALLOON_CHILD'\n\t\t\t);\n\n\t\t\tconst notifier = new CheckListNotifier({\n\t\t\t\tcontent: this.loc(messageKey),\n\t\t\t});\n\t\t\tnotifier.subscribeOnce('complete', (baseEvent: BaseEvent) => {\n\t\t\t\tconst timerHasEnded = baseEvent.getData();\n\n\t\t\t\tif (timerHasEnded)\n\t\t\t\t{\n\t\t\t\t\tthis.removeItem(itemId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.checkListManager.showItems(\n\t\t\t\t\t\t[itemId],\n\t\t\t\t\t\t(updates: CheckListModel[]) => this.upsertCheckLists(updates),\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tthis.removeItemFromDelete(itemId);\n\n\t\t\t\tthis.unfreeze();\n\n\t\t\t\tthis.notifiers.delete(itemId);\n\t\t\t});\n\n\t\t\tthis.notifiers.set(itemId, notifier);\n\n\t\t\tnotifier.showBalloonWithTimer();\n\n\t\t\tif (this.isCurrentItemEmpty())\n\t\t\t{\n\t\t\t\tnotifier.stopTimer();\n\t\t\t}\n\t\t},\n\t\thandleScroll(): void\n\t\t{\n\t\t\tthis.isForwardMenuShown = false;\n\n\t\t\tthis.updatePanelPosition();\n\t\t},\n\t\thandleShow(data): void\n\t\t{\n\t\t\tthis.$emit('show', data);\n\t\t},\n\t\tasync handleClose(): void\n\t\t{\n\t\t\tif (this.closing)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.closing = true;\n\n\t\t\tthis.cleanNotifiers();\n\t\t\tthis.cancelGroupMode();\n\t\t\tthis.cleanCollapsedState();\n\t\t\tthis.executeCheckListCompletionCallbacks();\n\n\t\t\tif (this.hasEmptyItem())\n\t\t\t{\n\t\t\t\tconst firstEmptyItem = this.checkListManager.getFirstEmptyItem();\n\n\t\t\t\tthis.focusToItem(firstEmptyItem.id, true);\n\n\t\t\t\tthis.closing = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst itemIdWithUploadingFiles = this.getItemIdWithUploadingFiles();\n\t\t\tif (itemIdWithUploadingFiles)\n\t\t\t{\n\t\t\t\tthis.focusToItem(itemIdWithUploadingFiles, true);\n\n\t\t\t\tthis.closing = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.cleanEmptyItems();\n\n\t\t\tconst checkListId = this.lastUpdatedCheckListId === 0 ? this.checkListId : this.lastUpdatedCheckListId;\n\n\t\t\tthis.$emit('close', this.deletingCheckListIds[checkListId] ? 0 : checkListId);\n\n\t\t\tawait this.saveCheckList();\n\n\t\t\tthis.closing = false;\n\t\t},\n\t\thandleIsShown(isShown: boolean): void\n\t\t{\n\t\t\tif (isShown)\n\t\t\t{\n\t\t\t\tthis.subscribeToEvents();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unsubscribeFromEvents();\n\t\t\t}\n\t\t},\n\t\thandleShowPopup(baseEvent: BaseEvent): void\n\t\t{\n\t\t\tconst [popup] = baseEvent.getCompatData();\n\t\t\tconst isHintPopup = popup.getId().startsWith('bx-vue-hint-');\n\t\t\tif (isHintPopup)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.shownPopups.add(popup);\n\n\t\t\tthis.freeze();\n\t\t},\n\t\thandleClosePopup(baseEvent: BaseEvent): void\n\t\t{\n\t\t\tconst [popup] = baseEvent.getCompatData();\n\t\t\tconst isHintPopup = popup.getId().startsWith('bx-vue-hint-');\n\t\t\tif (isHintPopup)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.shownPopups.delete(popup);\n\n\t\t\tthis.unfreeze();\n\t\t},\n\t\tasync handleGroupRemove(itemId: number | string): Promise<void>\n\t\t{\n\t\t\tthis.itemId = itemId;\n\n\t\t\tthis.freeze();\n\n\t\t\tthis.addItemToDelete(itemId);\n\n\t\t\tthis.hideItemPanel(itemId);\n\n\t\t\tconst allSelectedItems = this.checkListManager.getAllSelectedItems();\n\n\t\t\tconst nearestItem = this.checkListManager.findNearestItem(this.currentItem, false);\n\t\t\tif (nearestItem)\n\t\t\t{\n\t\t\t\tawait this.updateCheckList(nearestItem.id, {\n\t\t\t\t\tgroupMode: {\n\t\t\t\t\t\tactive: true,\n\t\t\t\t\t\tselected: true,\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.showItemPanel(nearestItem.id);\n\t\t\t\t}, 0);\n\t\t\t}\n\n\t\t\tconst allSelectedItemIds = allSelectedItems.map((item: CheckListModel) => item.id);\n\n\t\t\tthis.checkListManager.hideItems(\n\t\t\t\tallSelectedItemIds,\n\t\t\t\t(updates: CheckListModel[]) => this.upsertCheckLists(updates),\n\t\t\t);\n\n\t\t\tconst messageKey = (\n\t\t\t\tallSelectedItems.length > 1\n\t\t\t\t\t? 'TASKS_V2_CHECK_LIST_ITEM_REMOVE_BALLOON_CHILDREN'\n\t\t\t\t\t: 'TASKS_V2_CHECK_LIST_ITEM_REMOVE_BALLOON_CHILD'\n\t\t\t);\n\n\t\t\tconst notifier = new CheckListNotifier({\n\t\t\t\tcontent: this.loc(messageKey),\n\t\t\t});\n\t\t\tnotifier.subscribeOnce('complete', (baseEvent: BaseEvent) => {\n\t\t\t\tconst timerHasEnded = baseEvent.getData();\n\t\t\t\tconst idsToShow = [];\n\t\t\t\tallSelectedItems.forEach((item: CheckListModel) => {\n\t\t\t\t\tif (timerHasEnded)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.removeItem(item.id);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tidsToShow.push(item.id);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.removeItemFromDelete(item.id);\n\t\t\t\t});\n\n\t\t\t\tthis.checkListManager.showItems(\n\t\t\t\t\tidsToShow,\n\t\t\t\t\t(updates: CheckListModel[]) => this.upsertCheckLists(updates),\n\t\t\t\t);\n\n\t\t\t\tif (timerHasEnded)\n\t\t\t\t{\n\t\t\t\t\tif (nearestItem && !this.deletingCheckListIds[nearestItem.id])\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showItemPanel(nearestItem.id);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.cancelGroupMode();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showItemPanel(this.currentItem.id);\n\t\t\t\t}\n\n\t\t\t\tthis.unfreeze();\n\n\t\t\t\tthis.notifiers.delete(itemId);\n\t\t\t});\n\n\t\t\tthis.notifiers.set(itemId, notifier);\n\n\t\t\tnotifier.showBalloonWithTimer();\n\t\t},\n\t\thandleFocus(itemId: number | string): void\n\t\t{\n\t\t\tthis.isItemPanelFreeze = false;\n\n\t\t\tthis.showItemPanel(itemId);\n\t\t},\n\t\thandleBlur(itemId: number | string): void\n\t\t{\n\t\t\tthis.itemId = itemId;\n\n\t\t\tif (\n\t\t\t\tthis.isCurrentItemEmpty()\n\t\t\t\t&& this.hasItemFiles(this.currentItem)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isItemPanelFreeze === false)\n\t\t\t{\n\t\t\t\tthis.hideItemPanel(itemId);\n\t\t\t}\n\t\t},\n\t\thandleEmptyBlur(itemId: number | string): void\n\t\t{\n\t\t\tthis.itemId = itemId;\n\n\t\t\tif (this.currentItem.parentId === 0)\n\t\t\t{\n\t\t\t\tthis.setDefaultCheckListTitle(itemId);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.hasItemFiles(this.currentItem))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isItemPanelFreeze === false)\n\t\t\t{\n\t\t\t\tthis.removeItem(itemId);\n\t\t\t}\n\t\t},\n\t\thandleGroupMode(itemId: number | string): void\n\t\t{\n\t\t\tthis.itemId = itemId;\n\n\t\t\tthis.cancelGroupMode();\n\n\t\t\tconst firstChild = this.checkListManager.getFirstVisibleChild(itemId);\n\t\t\tif (!firstChild)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.activateGroupMode(itemId);\n\t\t\tthis.showItemPanel(firstChild.id);\n\t\t},\n\t\thandleGroupModeSelect(itemId: number | string): void\n\t\t{\n\t\t\tthis.itemId = itemId;\n\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tthis.showItemPanel(itemId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showItemPanelOnNearestSelectedItem(itemId);\n\t\t\t}\n\t\t},\n\t\thandlePanelAction({ action, node }: {action: string, node: HTMLElement}): void\n\t\t{\n\t\t\tconst actionHandlers = {\n\t\t\t\t[PanelAction.SetImportant]: (n) => this.setImportant(n),\n\t\t\t\t[PanelAction.AttachFile]: (n) => this.attachFile(n),\n\t\t\t\t[PanelAction.MoveRight]: (n) => this.moveGroupToRight(n),\n\t\t\t\t[PanelAction.MoveLeft]: (n) => this.moveGroupToLeft(n),\n\t\t\t\t[PanelAction.AssignAccomplice]: (n) => {\n\t\t\t\t\tif (!this.isItemPanelFreeze)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showParticipantDialog(n, 'accomplices');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t[PanelAction.AssignAuditor]: (n) => {\n\t\t\t\t\tif (!this.isItemPanelFreeze)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showParticipantDialog(n, 'auditors');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t[PanelAction.Forward]: (n) => this.forward(n),\n\t\t\t\t[PanelAction.Delete]: (n) => this.delete(n),\n\t\t\t\t[PanelAction.Cancel]: (n) => this.cancelGroupMode(n),\n\t\t\t};\n\n\t\t\tactionHandlers[action]?.(node);\n\t\t},\n\t\thandleOpenCheckList(checkListId: number | string): void\n\t\t{\n\t\t\tthis.cleanNotifiers();\n\t\t\tthis.cleanCollapsedState();\n\n\t\t\tthis.$emit('open', checkListId);\n\t\t},\n\t\tupdateCheckList(id: number | string, fields: Partial<CheckListModel>): Promise<void>\n\t\t{\n\t\t\treturn this.$store.dispatch(`${Model.CheckList}/update`, { id, fields });\n\t\t},\n\t\tasync updateTask(fields: Partial<TaskModel>): Promise<void>\n\t\t{\n\t\t\treturn taskService.updateStoreTask(this.taskId, fields);\n\t\t},\n\t\tupsertCheckLists(items: CheckListModel[]): Promise<void>\n\t\t{\n\t\t\treturn this.$store.dispatch(`${Model.CheckList}/upsertMany`, items);\n\t\t},\n\t\tinsertCheckList(item: CheckListModel): Promise<void>\n\t\t{\n\t\t\treturn this.$store.dispatch(`${Model.CheckList}/insert`, item);\n\t\t},\n\t\tinsertManyCheckLists(items: CheckListModel[]): Promise<void>\n\t\t{\n\t\t\treturn this.$store.dispatch(`${Model.CheckList}/insertMany`, items);\n\t\t},\n\t\tdeleteCheckList(id: number | string): Promise<void>\n\t\t{\n\t\t\treturn this.$store.dispatch(`${Model.CheckList}/delete`, id);\n\t\t},\n\t\tasync saveCheckList(): Promise<void>\n\t\t{\n\t\t\tif (!this.isDemoCheckListModified())\n\t\t\t{\n\t\t\t\tthis.removeChecklists();\n\n\t\t\t\tthis.checkListWasUpdated = false;\n\t\t\t}\n\n\t\t\tif (this.checkListWasUpdated && this.isEdit)\n\t\t\t{\n\t\t\t\tconst deletingIds = new Set(Object.values(this.deletingCheckListIds));\n\t\t\t\tconst fullListDeletingIds = this.checkListManager.expandIdsWithChildren(deletingIds);\n\n\t\t\t\tconst checkListsToSave = this.checkLists.filter((checkList: CheckListModel) => {\n\t\t\t\t\treturn !fullListDeletingIds.has(checkList.id);\n\t\t\t\t});\n\n\t\t\t\tawait checkListService.save(this.taskId, checkListsToSave);\n\t\t\t}\n\n\t\t\tthis.checkListWasUpdated = false;\n\t\t},\n\t\tisDemoCheckListModified(): boolean\n\t\t{\n\t\t\tif (this.getCheckListsNumber() > 1)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst [checkList] = this.checkLists;\n\t\t\tif (!checkList)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst demoTitle = this.loc('TASKS_V2_CHECK_LIST_TITLE_NUMBER', { '#number#': 1 });\n\n\t\t\treturn (\n\t\t\t\tcheckList.title !== demoTitle\n\t\t\t\t|| this.checkListManager.getChildren(checkList.id).length > 0\n\t\t\t\t|| this.hasItemUsers(checkList)\n\t\t\t\t|| this.hasItemFiles(checkList)\n\t\t\t);\n\t\t},\n\t\tremoveChecklists(): void\n\t\t{\n\t\t\tthis.checkLists\n\t\t\t\t.filter((checklist: CheckListModel) => checklist.parentId === 0)\n\t\t\t\t.forEach((item: CheckListModel) => {\n\t\t\t\t\tthis.removeItem(item.id);\n\t\t\t\t});\n\t\t},\n\t\tasync addCheckList(empty: boolean = false): Promise<string>\n\t\t{\n\t\t\tconst parentId = Text.getRandom();\n\t\t\tconst childId = Text.getRandom();\n\n\t\t\tconst checklist = [...this.task.checklist, parentId];\n\n\t\t\tconst items = [this.getDataForNewCheckList(parentId)];\n\t\t\tif (!empty)\n\t\t\t{\n\t\t\t\titems.push({\n\t\t\t\t\tid: childId,\n\t\t\t\t\tnodeId: childId,\n\t\t\t\t\tparentId,\n\t\t\t\t\tparentNodeId: parentId,\n\t\t\t\t\tsortIndex: 0,\n\t\t\t\t});\n\n\t\t\t\tchecklist.push(childId);\n\t\t\t}\n\n\t\t\tawait this.insertManyCheckLists(items);\n\t\t\tvoid this.updateTask({ checklist });\n\n\t\t\tthis.checkListWasUpdated = true;\n\n\t\t\treturn parentId;\n\t\t},\n\t\tasync addFastCheckList(): void\n\t\t{\n\t\t\tconst checkListId = await this.addCheckList();\n\n\t\t\tthis.handleOpenCheckList(checkListId);\n\t\t},\n\t\tshowForwardMenu(node: HTMLElement): void\n\t\t{\n\t\t\tthis.forwardBindElement = node;\n\n\t\t\tthis.isForwardMenuShown = true;\n\t\t},\n\t\tgetCheckListsNumber(): number\n\t\t{\n\t\t\treturn this.checkLists.filter((checklist: CheckListModel) => {\n\t\t\t\treturn checklist.parentId === 0 && !this.deletingCheckListIds[checklist.id];\n\t\t\t}).length;\n\t\t},\n\t\tgetDataForNewCheckList(parentId: string): CheckListModel\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: parentId,\n\t\t\t\tnodeId: parentId,\n\t\t\t\tparentId: 0,\n\t\t\t\ttitle: this.loc('TASKS_V2_CHECK_LIST_TITLE_NUMBER', { '#number#': this.getCountForNewCheckList() }),\n\t\t\t\tsortIndex: this.getSortForNewCheckList(),\n\t\t\t};\n\t\t},\n\t\tgetSortForNewCheckList(): number\n\t\t{\n\t\t\treturn this.getCheckListsNumber();\n\t\t},\n\t\tgetCountForNewCheckList(): number\n\t\t{\n\t\t\treturn this.getCheckListsNumber() + 1;\n\t\t},\n\t\tsetItemsRef(id, ref): void\n\t\t{\n\t\t\tthis.itemsRefs[id] = ref;\n\t\t},\n\t\tgetItemsRef(id): Object\n\t\t{\n\t\t\treturn this.itemsRefs[id];\n\t\t},\n\t\tfocusToItem(itemId: number | string, highlight: boolean = false): void\n\t\t{\n\t\t\tvoid this.$nextTick(() => {\n\t\t\t\tconst itemRef = this.getItemsRef(itemId);\n\t\t\t\titemRef?.$refs.growingTextArea?.focusTextarea();\n\t\t\t\tif (highlight)\n\t\t\t\t{\n\t\t\t\t\tvoid highlighter.highlight(itemRef?.$refs.item);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\taddItem({ id, sort }: {id: number | string, sort: number}): void\n\t\t{\n\t\t\tif (this.hasActiveGroupMode())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.itemId = id;\n\n\t\t\tconst childId = Text.getRandom();\n\t\t\tconst parentId = this.currentItem.parentId;\n\n\t\t\tthis.resortItemsAfterIndex(parentId, sort);\n\n\t\t\tthis.insertItem(parentId, childId, sort);\n\t\t},\n\t\taddItemFromBtn(checkListId: number | string): void\n\t\t{\n\t\t\tif (this.hasActiveGroupMode())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\tthis.handleOpenCheckList(checkListId);\n\t\t\t}\n\n\t\t\tconst childId = Text.getRandom();\n\t\t\tconst sortIndex = this.checkListManager.getChildren(checkListId).length;\n\n\t\t\tthis.insertItem(checkListId, childId, sortIndex);\n\t\t},\n\t\tinsertItem(parentId: number, childId: number, sortIndex: number): void\n\t\t{\n\t\t\tconst parentItem = parentId ? this.checkListManager.getItem(parentId) : null;\n\t\t\tvoid this.insertCheckList({\n\t\t\t\tid: childId,\n\t\t\t\tnodeId: childId,\n\t\t\t\tparentId,\n\t\t\t\tparentNodeId: parentItem ? parentItem.nodeId : null,\n\t\t\t\tsortIndex,\n\t\t\t});\n\t\t\tvoid this.updateTask({ checklist: [...this.task.checklist, childId] });\n\t\t},\n\t\tremoveItem(id: number | string, isRootCall: boolean = true): void\n\t\t{\n\t\t\tif (!this.task)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst item = this.checkListManager.getItem(id);\n\t\t\tif (!item)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst children = this.checkListManager.getChildren(item.id);\n\n\t\t\tif (\n\t\t\t\titem?.title\n\t\t\t\t|| item.parentId === 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.checkListWasUpdated = true;\n\t\t\t}\n\n\t\t\tif (children.length > 0)\n\t\t\t{\n\t\t\t\tchildren.forEach((child: CheckListModel) => {\n\t\t\t\t\tthis.removeItem(child.id, false);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst checkListIds = this.task.checklist.filter((itemId) => itemId !== item.id);\n\t\t\tvoid this.updateTask({\n\t\t\t\tcontainsChecklist: checkListIds.length > 0,\n\t\t\t\tchecklist: checkListIds,\n\t\t\t});\n\t\t\tvoid this.deleteCheckList(item.id);\n\n\t\t\tif (isRootCall)\n\t\t\t{\n\t\t\t\tthis.resortItemsOnLevel(item.parentId);\n\t\t\t}\n\n\t\t\tfileService.delete(item.id, EntityTypes.CheckListItem);\n\t\t},\n\t\taddItemToDelete(itemId: number | string): void\n\t\t{\n\t\t\tthis.addCheckListItemToDeleting(itemId);\n\t\t},\n\t\tremoveItemFromDelete(itemId: number | string): void\n\t\t{\n\t\t\tthis.removeCheckListItemFromDeleting(itemId);\n\n\t\t\tif (this.isPreview && this.isEdit && Type.isNumber(itemId))\n\t\t\t{\n\t\t\t\tvoid checkListService.delete(this.taskId, itemId);\n\t\t\t}\n\t\t},\n\t\tresortItemsAfterIndex(parentId: number | string, sortIndex: number): void\n\t\t{\n\t\t\tthis.checkListManager.resortItemsAfterIndex(\n\t\t\t\tparentId,\n\t\t\t\tsortIndex,\n\t\t\t\t(updates: CheckListModel[]) => {\n\t\t\t\t\tif (updates.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tvoid this.upsertCheckLists(updates);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tresortItemsOnLevel(parentId: number | string): void\n\t\t{\n\t\t\tthis.checkListManager.resortItemsOnLevel(\n\t\t\t\tparentId,\n\t\t\t\t(updates: CheckListModel[]) => this.upsertCheckLists(updates),\n\t\t\t);\n\t\t},\n\t\tshowItemPanel(itemId: number | string): void\n\t\t{\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.itemId = itemId;\n\n\t\t\tthis.itemPanelIsShown = true;\n\n\t\t\tvoid this.updateCheckList(itemId, { panelIsShown: true });\n\n\t\t\tvoid this.$nextTick(() => this.updatePanelPosition());\n\t\t},\n\t\thideItemPanel(itemId: number | string): void\n\t\t{\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.itemPanelIsShown = false;\n\n\t\t\tif (this.hasActiveGroupMode() && this.checkListManager.getAllSelectedItems().length === 0)\n\t\t\t{\n\t\t\t\tthis.deactivateGroupMode();\n\t\t\t}\n\n\t\t\tconst item = this.checkListManager.getItem(itemId);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\tvoid this.updateCheckList(itemId, { panelIsShown: false });\n\t\t\t}\n\n\t\t\tthis.isItemPanelFreeze = false;\n\t\t},\n\t\tshowItemPanelOnNearestSelectedItem(itemId: number | string): void\n\t\t{\n\t\t\t// eslint-disable-next-line no-lonely-if\n\t\t\tconst nearestSelectedItem = this.checkListManager.findNearestItem(this.currentItem, true);\n\t\t\tif (nearestSelectedItem)\n\t\t\t{\n\t\t\t\tthis.showItemPanel(nearestSelectedItem.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hideItemPanel(itemId);\n\t\t\t}\n\t\t},\n\t\tupdatePanelPosition()\n\t\t{\n\t\t\tif (this.itemPanelIsShown === false)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst itemRef = this.$refs.list.querySelector([`[data-id=\"${this.currentItem.id}\"]`]);\n\n\t\t\tconst panelRect = Dom.getPosition(this.$refs.panel.$el);\n\t\t\tconst listRect = Dom.getPosition(this.$refs.list);\n\t\t\tconst itemRect = Dom.getRelativePosition(itemRef, this.$refs.list);\n\t\t\tconst isParentItem = (this.currentItem.parentId === 0);\n\n\t\t\tconst paddingOffset = 18;\n\t\t\tconst panelWidth = panelRect.width === 0 ? 304 : panelRect.width;\n\n\t\t\tconst top = itemRect.top - 28;\n\t\t\tconst topLimitValue = isParentItem ? -30 : 40;\n\t\t\tconst panelVisible = top > topLimitValue && top < this.itemPanelTopLimit;\n\n\t\t\tconst topPopupLimitValue = isParentItem ? 0 : 70;\n\t\t\tconst popupVisible = top > topPopupLimitValue && top < this.itemPanelTopLimit;\n\t\t\tif (!popupVisible)\n\t\t\t{\n\t\t\t\tthis.shownPopups.forEach((popup) => {\n\t\t\t\t\tpopup.close();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst display = panelVisible ? 'flex' : 'none';\n\t\t\tif (isParentItem)\n\t\t\t{\n\t\t\t\tconst left = listRect.width - panelWidth - (paddingOffset * 2) - 80;\n\n\t\t\t\tthis.itemPanelStyles = {\n\t\t\t\t\ttop: `${top}px`,\n\t\t\t\t\tleft: `${left}px`,\n\t\t\t\t\tdisplay,\n\t\t\t\t};\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst left = listRect.width - panelWidth - paddingOffset;\n\n\t\t\t\tthis.itemPanelStyles = {\n\t\t\t\t\ttop: `${top}px`,\n\t\t\t\t\tleft: `${left}px`,\n\t\t\t\t\tdisplay,\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t\tsetImportant(): void\n\t\t{\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tconst updates = this.checkListManager.getAllSelectedItems()\n\t\t\t\t\t.map((item: CheckListModel) => ({\n\t\t\t\t\t\t...item,\n\t\t\t\t\t\tisImportant: !item.isImportant,\n\t\t\t\t\t}));\n\n\t\t\t\tvoid this.upsertCheckLists(updates);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvoid this.updateCheckList(this.currentItem.id, { isImportant: !this.currentItem.isImportant });\n\t\t\t}\n\n\t\t\tthis.checkListWasUpdated = true;\n\t\t},\n\t\tattachFile(node: HTMLElement): void\n\t\t{\n\t\t\tthis.fileServiceInstances ??= new Map();\n\n\t\t\tconst fileServiceInstance = this.getCurrentFileService();\n\n\t\t\tthis.fileServiceInstances.set(this.currentItem.id, fileServiceInstance);\n\n\t\t\tconst handleFreeze = (freeze: boolean) => {\n\t\t\t\tif (freeze)\n\t\t\t\t{\n\t\t\t\t\tthis.freeze();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.unfreeze();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\thandleFreeze(true);\n\n\t\t\tfileServiceInstance.browse({\n\t\t\t\tbindElement: node,\n\t\t\t\tonShowCallback: () => {\n\t\t\t\t\tthis.isItemPanelFreeze = true;\n\t\t\t\t},\n\t\t\t\tonHideCallback: () => {\n\t\t\t\t\tthis.isItemPanelFreeze = false;\n\t\t\t\t},\n\t\t\t});\n\t\t\tfileServiceInstance.subscribe('onFileAdd', () => {\n\t\t\t\thandleFreeze(true);\n\t\t\t});\n\t\t\tfileServiceInstance.subscribe('onFileComplete', () => {\n\t\t\t\tthis.isItemPanelFreeze = fileServiceInstance.isUploading();\n\t\t\t\thandleFreeze(this.isItemPanelFreeze || this.hasEmptyItem());\n\t\t\t\tthis.focusToItem(this.currentItem.id);\n\t\t\t\tthis.checkListWasUpdated = true;\n\t\t\t});\n\t\t},\n\t\tgetCurrentFileService(): ?FileService\n\t\t{\n\t\t\tif (!this.currentItem)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn fileService.get(\n\t\t\t\tthis.currentItem.id,\n\t\t\t\tEntityTypes.CheckListItem,\n\t\t\t\t{ parentEntityId: this.taskId },\n\t\t\t);\n\t\t},\n\t\thasItemFiles(item: CheckListModel): boolean\n\t\t{\n\t\t\tif (!item)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst fileServiceInstance = this.getCurrentFileService();\n\n\t\t\tconst files = item.attachments;\n\n\t\t\treturn (\n\t\t\t\tfiles.length > 0\n\t\t\t\t|| fileServiceInstance?.isUploading()\n\t\t\t\t|| fileServiceInstance?.hasUploadingError()\n\t\t\t);\n\t\t},\n\t\thasItemUsers(item: CheckListModel): boolean\n\t\t{\n\t\t\treturn (item.accomplices.length > 0 || item.auditors.length > 0);\n\t\t},\n\t\tgetItemIdWithUploadingFiles(): ?string | ?number | undefined\n\t\t{\n\t\t\tif (!this.fileServiceInstances)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn [...this.fileServiceInstances.values()].find(\n\t\t\t\t(fileServiceInstance: FileService) => fileServiceInstance.isUploading(),\n\t\t\t)?.getEntityId();\n\t\t},\n\t\tisCurrentItemEmpty(): boolean\n\t\t{\n\t\t\tif (!this.currentItem)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn this.currentItem.title === '';\n\t\t},\n\t\tmoveGroupToRight(): void\n\t\t{\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tthis.checkListManager.getAllSelectedItems()\n\t\t\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex)\n\t\t\t\t\t.forEach((item: CheckListModel) => {\n\t\t\t\t\t\tthis.moveRight(item);\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.moveRight(this.currentItem);\n\t\t\t}\n\t\t},\n\t\tmoveRight(item: CheckListModel): void\n\t\t{\n\t\t\tthis.checkListManager.moveRight(\n\t\t\t\titem,\n\t\t\t\t(updates: CheckListModel[]) => {\n\t\t\t\t\tvoid this.upsertCheckLists(updates);\n\t\t\t\t\tthis.checkListWasUpdated = true;\n\n\t\t\t\t\tif (!item.groupMode?.active)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.focusToItem(item.id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tmoveGroupToLeft(): void\n\t\t{\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tthis.checkListManager.getAllSelectedItems()\n\t\t\t\t\t.sort((a: CheckListModel, b: CheckListModel) => b.sortIndex - a.sortIndex)\n\t\t\t\t\t.forEach((item: CheckListModel) => {\n\t\t\t\t\t\tthis.moveLeft(item);\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.moveLeft(this.currentItem);\n\t\t\t}\n\t\t},\n\t\tmoveLeft(item: CheckListModel): void\n\t\t{\n\t\t\tthis.checkListManager.moveLeft(\n\t\t\t\titem,\n\t\t\t\t(updates: CheckListModel[]) => {\n\t\t\t\t\tvoid this.upsertCheckLists(updates);\n\t\t\t\t\tthis.checkListWasUpdated = true;\n\n\t\t\t\t\tif (!item.groupMode?.active)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.focusToItem(item.id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tasync forward(node: HTMLElement): Promise<void>\n\t\t{\n\t\t\tif (this.hasFewParentCheckLists)\n\t\t\t{\n\t\t\t\tthis.showForwardMenu(node);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hideItemPanel();\n\n\t\t\t\tvoid this.forwardToNewChecklist(this.currentItem.id);\n\t\t\t}\n\n\t\t\tthis.checkListWasUpdated = true;\n\t\t},\n\t\tasync forwardToNewChecklist(itemId: number | string): Promise<void>\n\t\t{\n\t\t\tconst newParentId = await this.addCheckList(true);\n\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tvoid this.forwardGroupItemsToChecklist(itemId, newParentId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.forwardToChecklist(itemId, newParentId);\n\t\t\t}\n\t\t},\n\t\tforwardToChecklist(itemId: number | string, checkListId: number | string): void\n\t\t{\n\t\t\tconst finalSortIndex = this.checkListManager.getChildren(checkListId).length;\n\n\t\t\tconst movingItem = this.checkListManager.getItem(itemId);\n\n\t\t\tvoid this.updateCheckList(movingItem.id, {\n\t\t\t\tparentId: checkListId,\n\t\t\t\tsortIndex: finalSortIndex,\n\t\t\t});\n\n\t\t\tthis.resortItemsOnLevel(checkListId);\n\t\t\tthis.resortItemsOnLevel(movingItem.parentId);\n\n\t\t\tthis.handleTargetParentFilter(movingItem);\n\t\t},\n\t\tasync forwardGroupItemsToChecklist(itemId: number | string, checkListId: number | string): Promise<void>\n\t\t{\n\t\t\tconst finalSortIndex = this.checkListManager.getChildren(checkListId).length;\n\n\t\t\tconst movingItem = this.checkListManager.getItem(itemId);\n\n\t\t\tconst checkListIdsFromWhichWereForwarded = new Set();\n\n\t\t\tconst allSelectedItems = this.checkListManager.getAllSelectedItems();\n\t\t\tconst nearestItem = this.checkListManager.findNearestItem(movingItem, false, allSelectedItems);\n\t\t\tif (nearestItem)\n\t\t\t{\n\t\t\t\tthis.showItemPanel(nearestItem.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.cancelGroupMode();\n\t\t\t}\n\n\t\t\tconst allSelectedWithChildren = this.checkListManager.getAllSelectedItemsWithChildren();\n\n\t\t\tconst selectedItemsIds = new Set(allSelectedItems.map((item: CheckListModel) => item.id));\n\n\t\t\tconst updates = [];\n\n\t\t\tallSelectedItems.forEach((item: CheckListModel) => {\n\t\t\t\tconst shouldUpdateParentId = !selectedItemsIds.has(item.parentId);\n\n\t\t\t\tcheckListIdsFromWhichWereForwarded.add(item.parentId);\n\n\t\t\t\tupdates.push({\n\t\t\t\t\t...item,\n\t\t\t\t\tparentId: shouldUpdateParentId ? checkListId : item.parentId,\n\t\t\t\t\tgroupMode: {\n\t\t\t\t\t\tactive: false,\n\t\t\t\t\t\tselected: false,\n\t\t\t\t\t},\n\t\t\t\t\tsortIndex: shouldUpdateParentId ? finalSortIndex : item.sortIndex,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tallSelectedWithChildren.forEach((item: CheckListModel) => {\n\t\t\t\tif (!selectedItemsIds.has(item.id))\n\t\t\t\t{\n\t\t\t\t\tupdates.push({\n\t\t\t\t\t\t...item,\n\t\t\t\t\t\tgroupMode: {\n\t\t\t\t\t\t\tactive: false,\n\t\t\t\t\t\t\tselected: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tawait this.upsertCheckLists(updates);\n\n\t\t\tif (nearestItem)\n\t\t\t{\n\t\t\t\tvoid this.updateCheckList(nearestItem.id, {\n\t\t\t\t\tgroupMode: {\n\t\t\t\t\t\tactive: true,\n\t\t\t\t\t\tselected: true,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.resortItemsOnLevel(checkListId);\n\t\t\tcheckListIdsFromWhichWereForwarded.forEach((id: number | string) => {\n\t\t\t\tthis.resortItemsOnLevel(id);\n\t\t\t});\n\n\t\t\tallSelectedWithChildren.forEach((item: CheckListModel) => {\n\t\t\t\tthis.handleTargetParentFilter(item);\n\t\t\t});\n\t\t},\n\t\thandleTargetParentFilter(movedItem: CheckListModel): void\n\t\t{\n\t\t\tthis.checkListManager.handleTargetParentFilter(\n\t\t\t\tmovedItem,\n\t\t\t\tthis.currentUserId,\n\t\t\t\t(updates: CheckListModel[]) => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tvoid this.upsertCheckLists(updates);\n\t\t\t\t\t}, 1000);\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tdelete(): void\n\t\t{\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tvoid this.handleGroupRemove(this.currentItem.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hideItemPanel();\n\t\t\t\tthis.handleRemove(this.currentItem.id);\n\t\t\t}\n\t\t},\n\t\tcancelGroupMode(): void\n\t\t{\n\t\t\tthis.deactivateGroupMode();\n\t\t\tthis.hideItemPanel();\n\t\t},\n\t\tcleanCollapsedState(): void\n\t\t{\n\t\t\tconst updates = this.parentCheckLists\n\t\t\t\t.map((item: CheckListModel) => ({\n\t\t\t\t\t...item,\n\t\t\t\t\tlocalCollapsedState: null,\n\t\t\t\t}));\n\n\t\t\tvoid this.upsertCheckLists(updates);\n\t\t},\n\t\tcleanEmptyItems(): void\n\t\t{\n\t\t\tthis.checkListManager.getEmptiesItem().forEach((item: CheckListModel) => {\n\t\t\t\tthis.removeItem(item.id);\n\t\t\t});\n\t\t},\n\t\tshowParticipantDialog(targetNode: HTMLElement, type: 'accomplices' | 'auditors'): void\n\t\t{\n\t\t\tconst ids = this.currentItem[type].map((user: UserModel) => user.id);\n\t\t\tconst itemId = this.currentItem.id;\n\t\t\tconst handleClose = (usersIds: number[]) => {\n\t\t\t\tthis.saveParticipants(itemId, type, usersIds);\n\n\t\t\t\tthis.isItemPanelFreeze = false;\n\n\t\t\t\tif (!this.itemGroupModeSelected && this.currentItem.id === itemId)\n\t\t\t\t{\n\t\t\t\t\tthis.focusToItem(itemId);\n\t\t\t\t}\n\n\t\t\t\tthis.updatePanelPosition();\n\t\t\t};\n\n\t\t\tvoid usersDialog.show({\n\t\t\t\ttargetNode,\n\t\t\t\tids,\n\t\t\t\twithAngle: true,\n\t\t\t\tonClose: handleClose,\n\t\t\t});\n\n\t\t\tthis.isItemPanelFreeze = true;\n\t\t},\n\t\tasync saveParticipants(id: number | string, type: 'accomplices' | 'auditors', usersIds: number[]): void\n\t\t{\n\t\t\tconst users = this.$store.getters[`${Model.Users}/getByIds`](usersIds);\n\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tconst updates = this.checkListManager.getAllSelectedItems()\n\t\t\t\t\t.map((item: CheckListModel) => ({\n\t\t\t\t\t\t...item,\n\t\t\t\t\t\t[type]: users,\n\t\t\t\t\t}));\n\n\t\t\t\tvoid this.upsertCheckLists(updates);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvoid this.updateCheckList(id, {\n\t\t\t\t\t[type]: users,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst task = taskService.getStoreTask(this.taskId);\n\t\t\tconst existingIds = task[`${type}Ids`];\n\t\t\tconst mergedIds = [...new Set([...existingIds, ...usersIds])];\n\n\t\t\tconst fields = {\n\t\t\t\t[`${type}Ids`]: mergedIds,\n\t\t\t};\n\n\t\t\tvoid this.updateTask(fields);\n\n\t\t\tthis.checkListWasUpdated = true;\n\t\t},\n\t\tactivateGroupMode(parentItemId: number | string): void\n\t\t{\n\t\t\tthis.itemId = parentItemId;\n\n\t\t\tconst visibleItems = this.checkListManager.getAllChildren(parentItemId)\n\t\t\t\t.filter((item: CheckListModel) => !item.hidden);\n\n\t\t\tconst updates = visibleItems\n\t\t\t\t.map((item: CheckListModel, index: number) => ({\n\t\t\t\t\t...item,\n\t\t\t\t\tgroupMode: {\n\t\t\t\t\t\tactive: true,\n\t\t\t\t\t\tselected: index === 0,\n\t\t\t\t\t},\n\t\t\t\t}));\n\n\t\t\tupdates.push({\n\t\t\t\t...this.currentItem,\n\t\t\t\tgroupMode: {\n\t\t\t\t\tactive: true,\n\t\t\t\t\tselected: false,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tvoid this.upsertCheckLists(updates);\n\t\t},\n\t\tdeactivateGroupMode(): void\n\t\t{\n\t\t\tconst updates = this.checkListManager.getAllGroupModeItems()\n\t\t\t\t.map((item: CheckListModel) => ({\n\t\t\t\t\t...item,\n\t\t\t\t\tgroupMode: {\n\t\t\t\t\t\tactive: false,\n\t\t\t\t\t\tselected: false,\n\t\t\t\t\t},\n\t\t\t\t}));\n\n\t\t\tvoid this.upsertCheckLists(updates);\n\t\t},\n\t\thasActiveGroupMode(): boolean\n\t\t{\n\t\t\treturn this.checkListManager.getAllGroupModeItems().length > 0;\n\t\t},\n\t\tfreeze(): void\n\t\t{\n\t\t\tthis.isFreeze = true;\n\t\t\tthis.$refs.childComponent?.$refs?.childComponent?.freeze();\n\t\t},\n\t\tunfreeze(): void\n\t\t{\n\t\t\tif (this.hasEmptyItem() || this.getItemIdWithUploadingFiles())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isFreeze = false;\n\t\t\tthis.$refs.childComponent?.$refs?.childComponent?.unfreeze();\n\t\t},\n\t\thasEmptyItem(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.checkListManager.hasEmptyItemWithFiles(this.hasItemFiles)\n\t\t\t\t|| this.checkListManager.hasEmptyParentItem()\n\t\t\t);\n\t\t},\n\t\tsetDefaultCheckListTitle(itemId: number | string): void\n\t\t{\n\t\t\tvoid this.updateCheckList(itemId, {\n\t\t\t\ttitle: this.loc(\n\t\t\t\t\t'TASKS_V2_CHECK_LIST_TITLE_NUMBER',\n\t\t\t\t\t{ '#number#': this.getCheckListsNumber() },\n\t\t\t\t),\n\t\t\t});\n\t\t},\n\t\tcleanNotifiers(): void\n\t\t{\n\t\t\tthis.notifiers.forEach((notifier: CheckListNotifier) => notifier.stopTimer());\n\t\t\tthis.notifiers.clear();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<component\n\t\t\tv-if=\"componentShown\"\n\t\t\tref=\"childComponent\"\n\t\t\t:is=\"componentName\"\n\t\t\t:isShown\n\t\t\t:sheetBindProps\n\t\t\t:isEmpty=\"emptyList\"\n\t\t\t@show=\"handleShow\"\n\t\t\t@close=\"handleClose\"\n\t\t\t@isShown=\"handleIsShown\"\n\t\t\t@addFastCheckList=\"addFastCheckList\"\n\t\t\t@resize=\"$emit('resize')\"\n\t\t>\n\t\t\t<template v-slot:default=\"{ handleShow, handleClose }\">\n\t\t\t\t<div\n\t\t\t\t\tref=\"wrapper\"\n\t\t\t\t\tclass=\"tasks-check-list-wrapper\"\n\t\t\t\t\t:class=\"contextClass\"\n\t\t\t\t\tdata-field-container\n\t\t\t\t\t:data-task-field-id=\"checkListMeta.id\"\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"!isPreview && !parentItemDragged\"\n\t\t\t\t\t\tclass=\"tasks-check-list-close-icon\"\n\t\t\t\t\t\t:class=\"contextClass\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<BIcon :name=\"Outline.CROSS_L\" @click=\"$emit('close')\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div ref=\"list\" data-list class=\"tasks-check-list-content\" :class=\"contextClass\">\n\t\t\t\t\t\t<CheckListWidget\n\t\t\t\t\t\t\tv-show=\"!stub\"\n\t\t\t\t\t\t\t:context\n\t\t\t\t\t\t\t:checkListId\n\t\t\t\t\t\t\t:isPreview\n\t\t\t\t\t\t\t@update=\"handleUpdate\"\n\t\t\t\t\t\t\t@show=\"handleShow\"\n\t\t\t\t\t\t\t@addItem=\"addItem\"\n\t\t\t\t\t\t\t@addItemFromBtn=\"addItemFromBtn\"\n\t\t\t\t\t\t\t@removeItem=\"handleRemove\"\n\t\t\t\t\t\t\t@focus=\"handleFocus\"\n\t\t\t\t\t\t\t@blur=\"handleBlur\"\n\t\t\t\t\t\t\t@emptyBlur=\"handleEmptyBlur\"\n\t\t\t\t\t\t\t@startGroupMode=\"handleGroupMode\"\n\t\t\t\t\t\t\t@toggleGroupModeSelected=\"handleGroupModeSelect\"\n\t\t\t\t\t\t\t@openCheckList=\"handleOpenCheckList\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<CheckListStub v-if=\"stub && !isPreview\" @click=\"addCheckList\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-show=\"!stub && !isPreview\" class=\"tasks-check-list-footer\" :class=\"contextClass\">\n\t\t\t\t\t\t<UiButton\n\t\t\t\t\t\t\tv-if=\"canCheckListAdd\"\n\t\t\t\t\t\t\t:text=\"loc('TASKS_V2_CHECK_LIST_NEW_BTN')\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.MEDIUM\"\n\t\t\t\t\t\t\t:leftIcon=\"ButtonIcon.ADD\"\n\t\t\t\t\t\t\t:style=\"AirButtonStyle.PLAIN_NO_ACCENT\"\n\t\t\t\t\t\t\t@click=\"addCheckList\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<UiButton\n\t\t\t\t\t\t\t:text=\"loc('TASKS_V2_CHECK_LIST_SAVE_BTN')\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.MEDIUM\"\n\t\t\t\t\t\t\t@click=\"$emit('close')\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<CheckListItemPanel\n\t\t\t\t\t\tv-if=\"itemPanelIsShown && !isPreview\"\n\t\t\t\t\t\tref=\"panel\"\n\t\t\t\t\t\t:currentItem\n\t\t\t\t\t\t:style=\"itemPanelStyles\"\n\t\t\t\t\t\t@action=\"handlePanelAction\"\n\t\t\t\t\t/>\n\t\t\t\t\t<BMenu\n\t\t\t\t\t\tv-if=\"isForwardMenuShown\"\n\t\t\t\t\t\t:options=\"forwardMenuOptions\"\n\t\t\t\t\t\t@close=\"isForwardMenuShown = false\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</component>\n\t`,\n};\n","import { Text, Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { checkListService } from 'tasks.v2.provider.service.check-list-service';\n\nimport { Chip, ChipDesign } from 'ui.system.chip.vue';\nimport { Animated, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.animated';\nimport 'ui.icon-set.outline';\n\nimport { EventName, Model } from 'tasks.v2.const';\nimport { fieldHighlighter } from 'tasks.v2.lib.field-highlighter';\nimport { fileService, EntityTypes } from 'tasks.v2.provider.service.file-service';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\nimport { CheckListManager } from './lib/check-list-manager';\n\nimport { checkListMeta } from './lib/check-list-meta';\n\n// @vue/component\nexport const CheckListChip = {\n\tcomponents: {\n\t\tChip,\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t\tisEdit: {},\n\t},\n\tprops: {\n\t\tisAutonomous: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['showCheckList'],\n\tsetup(): { task: TaskModel }\n\t{\n\t\treturn {\n\t\t\tcheckListMeta,\n\t\t};\n\t},\n\tcomputed: {\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist);\n\t\t},\n\t\tisUploading(): boolean\n\t\t{\n\t\t\treturn this.task.checklist?.some((itemId) => {\n\t\t\t\treturn fileService.get(\n\t\t\t\t\titemId,\n\t\t\t\t\tEntityTypes.CheckListItem,\n\t\t\t\t\t{ parentEntityId: this.taskId },\n\t\t\t\t).isUploading();\n\t\t\t});\n\t\t},\n\t\tdesign(): string\n\t\t{\n\t\t\treturn {\n\t\t\t\t[!this.isAutonomous && !this.isSelected]: ChipDesign.ShadowNoAccent,\n\t\t\t\t[!this.isAutonomous && this.isSelected]: ChipDesign.ShadowAccent,\n\t\t\t\t[this.isAutonomous && !this.isSelected]: ChipDesign.OutlineNoAccent,\n\t\t\t\t[this.isAutonomous && this.isSelected]: ChipDesign.OutlineAccent,\n\t\t\t}.true;\n\t\t},\n\t\tisSelected(): boolean\n\t\t{\n\t\t\tif (this.isAutonomous)\n\t\t\t{\n\t\t\t\treturn this.checkLists.length > 0;\n\t\t\t}\n\n\t\t\treturn this.wasFilled || this.checkLists.length > 0;\n\t\t},\n\t\twasFilled(): boolean\n\t\t{\n\t\t\treturn this.task.filledFields[checkListMeta.id];\n\t\t},\n\t\tcheckListItemCount(): number\n\t\t{\n\t\t\treturn this.checkLists.filter((checkList: CheckListModel) => checkList.parentId !== 0).length;\n\t\t},\n\t\ttext(): string\n\t\t{\n\t\t\tif (this.isAutonomous && this.checkListItemCount > 0)\n\t\t\t{\n\t\t\t\tconst completedCount = this.getCompletedCount();\n\n\t\t\t\treturn this.loc(\n\t\t\t\t\t'TASKS_V2_CHECK_LIST_COUNT_TITLE',\n\t\t\t\t\t{\n\t\t\t\t\t\t'#count#': completedCount,\n\t\t\t\t\t\t'#total#': this.checkListItemCount,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn this.loc('TASKS_V2_CHECK_LIST_CHIP_TITLE');\n\t\t},\n\t\ticon(): string\n\t\t{\n\t\t\tif (this.isUploading && !this.wasFilled)\n\t\t\t{\n\t\t\t\treturn Animated.LOADER_WAIT;\n\t\t\t}\n\n\t\t\treturn Outline.CHECK_LIST;\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.checkListManager = new CheckListManager({\n\t\t\tcomputed: {\n\t\t\t\tcheckLists: () => this.checkLists,\n\t\t\t},\n\t\t});\n\t},\n\tmounted(): void\n\t{\n\t\tthis.$bitrix.eventEmitter.subscribe(EventName.AiAddCheckList, this.handleAiAdd);\n\t\tthis.$bitrix.eventEmitter.subscribe(EventName.CloseCheckList, this.handleFieldClose);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventName.AiAddCheckList, this.handleAiAdd);\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventName.CloseCheckList, this.handleFieldClose);\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tif (this.isAutonomous)\n\t\t\t{\n\t\t\t\tvoid this.showCheckList();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line no-lonely-if\n\t\t\t\tif (this.isSelected)\n\t\t\t\t{\n\t\t\t\t\tvoid this.highlightField();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvoid this.showCheckList();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tasync handleAiAdd(baseEvent: BaseEvent): Promise<void>\n\t\t{\n\t\t\tconst checkListId = await this.buildAiCheckList(baseEvent.getData());\n\n\t\t\tawait this.highlightField();\n\n\t\t\tthis.checkListManager.scrollToCheckList(this.$root.$el, checkListId, 'smooth');\n\n\t\t\tif (this.isEdit)\n\t\t\t{\n\t\t\t\tvoid checkListService.save(this.taskId, this.checkLists);\n\t\t\t}\n\t\t},\n\t\thandleFieldClose(): void\n\t\t{\n\t\t\tif (this.isAutonomous)\n\t\t\t{\n\t\t\t\tthis.$el.focus();\n\t\t\t}\n\t\t},\n\t\tasync showCheckList(): Promise<void>\n\t\t{\n\t\t\tif (!this.isSelected)\n\t\t\t{\n\t\t\t\tawait this.buildEmptyCheckList();\n\t\t\t}\n\n\t\t\tthis.$emit('showCheckList');\n\t\t},\n\t\tasync buildEmptyCheckList(): Promise<void>\n\t\t{\n\t\t\tconst parentId = Text.getRandom();\n\t\t\tconst childId = Text.getRandom();\n\n\t\t\tawait this.$store.dispatch(`${Model.CheckList}/insertMany`, [\n\t\t\t\t{\n\t\t\t\t\tid: parentId,\n\t\t\t\t\tnodeId: parentId,\n\t\t\t\t\ttitle: this.loc('TASKS_V2_CHECK_LIST_TITLE_NUMBER', { '#number#': 1 }),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: childId,\n\t\t\t\t\tnodeId: childId,\n\t\t\t\t\tparentId,\n\t\t\t\t},\n\t\t\t]);\n\n\t\t\tawait taskService.updateStoreTask(this.taskId, {\n\t\t\t\tchecklist: [parentId, childId],\n\t\t\t});\n\t\t},\n\t\tasync buildAiCheckList(baseText: string): Promise<string>\n\t\t{\n\t\t\tif (!Type.isString(baseText) || baseText === '')\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst titles = baseText\n\t\t\t\t.split(/\\r\\n|\\r|\\n/g)\n\t\t\t\t.map((line: string) => line.trim())\n\t\t\t\t.filter((line: string) => line !== '');\n\t\t\tif (titles.length === 0)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst items = [];\n\n\t\t\tconst parentId = Text.getRandom();\n\t\t\tconst checkListsNumber = this.getCheckListsNumber();\n\n\t\t\tconst taskChecklist = [...this.task.checklist, parentId];\n\n\t\t\titems.push({\n\t\t\t\tid: parentId,\n\t\t\t\tnodeId: parentId,\n\t\t\t\tparentId: 0,\n\t\t\t\ttitle: this.loc('TASKS_V2_CHECK_LIST_TITLE_NUMBER', { '#number#': checkListsNumber + 1 }),\n\t\t\t\tsortIndex: checkListsNumber,\n\t\t\t});\n\n\t\t\ttitles.forEach((title: string, index: number) => {\n\t\t\t\tconst childId = Text.getRandom();\n\n\t\t\t\titems.push({\n\t\t\t\t\tid: childId,\n\t\t\t\t\tnodeId: childId,\n\t\t\t\t\tparentId,\n\t\t\t\t\ttitle,\n\t\t\t\t\tsortIndex: index,\n\t\t\t\t});\n\n\t\t\t\ttaskChecklist.push(childId);\n\t\t\t});\n\n\t\t\tawait this.$store.dispatch(`${Model.CheckList}/insertMany`, items);\n\n\t\t\tawait taskService.updateStoreTask(this.taskId, {\n\t\t\t\tchecklist: taskChecklist,\n\t\t\t});\n\n\t\t\treturn parentId;\n\t\t},\n\t\thighlightField(): Promise<void>\n\t\t{\n\t\t\treturn fieldHighlighter.setContainer(this.$root.$el).highlight(checkListMeta.id);\n\t\t},\n\t\tgetCheckListsNumber(): number\n\t\t{\n\t\t\treturn this.checkLists.filter((checklist: CheckListModel) => checklist.parentId === 0).length;\n\t\t},\n\t\tgetCompletedCount(): number\n\t\t{\n\t\t\treturn this.checkLists.filter((checklist: CheckListModel) => {\n\t\t\t\treturn checklist.isComplete && checklist.parentId !== 0;\n\t\t\t}).length;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Chip\n\t\t\t:design\n\t\t\t:icon\n\t\t\t:text\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-chip-id=\"checkListMeta.id\"\n\t\t\t@click=\"handleClick\"\n\t\t/>\n\t`,\n};\n"],"names":["checkListMeta","Object","freeze","id","TaskField","CheckList","title","Loc","getMessage","CheckListStub","name","components","UiButton","emits","setup","ButtonSize","Outline","template","CheckListPopup","Popup","inject","taskId","inheritAttrs","resizeObserver","computed","popupId","options","className","width","height","borderRadius","offsetTop","padding","autoHide","closeByEsc","animation","showClassName","closeClassName","closeAnimationType","events","onClose","handleClose","mapGetters","titleFieldOffsetHeight","Model","Interface","watch","$refs","childComponent","$nextTick","resize","created","ResizeObserver","entries","entry","target","wrapper","mounted","Event","bind","window","document","handleKeyDown","capture","beforeUnmount","unbind","methods","popupInstance","getPopupInstance","$emit","adjustPosition","handleShow","setTimeout","observe","$parent","disconnect","$bitrix","eventEmitter","emit","EventName","CloseCheckList","event","key","stopPropagation","CheckListSheet","BottomSheet","props","isEmpty","type","Boolean","default","isShown","required","sheetBindProps","value","CheckListManager","constructor","params","getItem","itemId","find","item","prepareItemId","getItems","itemIds","itemIdsSet","Set","filter","has","getItemsOnLevel","parentId","sort","a","b","sortIndex","getItemLevel","checkListItem","level","current","visitedIds","findParent","add","isParentItem","isItemDescendant","potentialAncestor","parent","i","showItems","updateFn","updates","forEach","length","hideItems","syncParentCompletionState","parentItemId","changedItem","parentItem","childrenItems","isEmptyParent","allChildrenCompleted","every","child","localCompleteState","isComplete","someChildrenIncomplete","parentCompleted","shouldUpdateParent","getAllGroupModeItems","groupMode","active","getAllSelectedItems","selected","getAllSelectedItemsWithChildren","result","Map","selectedItems","allItems","set","getChildren","parentIds","children","includes","map","values","getAllChildren","visited","collectChildren","currentId","push","getAllCompletedChildren","getSiblings","sibling","resortItemsOnLevel","sortedItems","newIndex","resortItemsBeforeIndex","itemsToResort","index","resortItemsAfterIndex","moveRight","itemsOnLevel","currentIndex","findIndex","newParent","candidate","newParentChildren","parentNodeId","nodeId","moveLeft","currentParent","parentInNewListIndex","currentSiblingsUpdates","newSortIndex","shiftUpdates","movedItemUpdate","findNearestItem","initialItem","excludeChildrenOf","rootParent","currentSortIndex","excludedParentIds","eligibleItems","isChildOfExcluded","reduce","nearest","getFirstVisibleChild","hidden","getEmptiesItem","hasEmptyItemWithFiles","hasItemFiles","some","hasEmptyParentItem","getFirstEmptyItem","items","getChildWithEmptyTitle","isItemCollapsed","isPreview","positionIndex","Type","isNull","localCollapsedState","isUndefined","collapsed","expanded","getRootParentByChildId","childItem","currentItem","expandIdsWithChildren","fullSet","size","checkListMap","processedIds","findItemIdsWithUser","rootId","userId","rootItem","unshift","hasUser","accomplices","user","auditors","num","parseInt","isStringExactlyAnInteger","Number","isNaN","toString","isFirstItemHigherLevelThan","firstItem","secondItem","firstItemLevel","secondItemLevel","hasItemChildren","isItemCompleted","scrollToCheckList","container","checkListId","behavior","scrollContainer","closest","querySelector","checkListNode","checkListRect","Dom","getPosition","containerRect","offsetTopInsideContainer","top","scrollTop","scrollTo","handleTargetParentFilter","movedItem","currentUserId","itemIdsToUpdateInNewParent","targetParentItem","draggedChildren","myItemIds","itemIdsMap","areCompletedCollapsed","myFilterActive","hideIds","showIds","action","updatedItem","resultSet","checkLists","CheckListList","BIcon","directives","hint","task","isEdit","Animated","data","isLoading","deletingCheckListIds","disableCheckListAnimations","$store","getters","checklist","isFilledEmpty","checkListLength","filledFields","deletingRootIds","deletingIds","checkListManager","containsChecklist","loading","canCheckListAdd","rights","checklistAdd","addTooltip","tooltip","text","loc","popupOptions","offsetLeft","stubAddIcon","$el","offsetWidth","loadData","checkListService","load","Context","Sheet","Preview","CheckListDragManager","EventEmitter","setEventNamespace","store","stubItemId","moveDropPreview","draggedItem","overedItem","directionFromBottom","isSameLevelMove","tmpDraggedIndex","isDraggedItemHigher","isOverStubItem","dispatch","fields","resortLevelDependingOnPosition","newDraggedSortIndex","levelResort","resortLevel","resortUpdates","CheckListItemDragManager","childrenIds","enterDropzone","canAddItem","init","offsetX","listDropzone","Draggable","draggable","dragElement","delay","MOVE","offset","x","dropzone","subscribe","destroy","getData","source","dataset","preventDefault","draggedItemId","addClass","over","clientY","overedRootParent","draggedRootParent","overedRootParentId","overMiddlePoint","getElementMiddlePoint","direction","y","removeClass","newParentId","draggedItemChanged","isFirstOnLevel","numberOfItemPerLevel","isSimpleAndLastOnLevel","shouldSkip","Math","abs","previousParentId","node","isStubItem","CheckListListDragManager","overedItemId","isLastOnLevel","draggedItemElement","relativePosition","getRelativePosition","relativeTop","isTopItem","offsetY","getOptions","setOptions","CheckListItemMixin","String","isHovered","isDragEnabled","draggedCheckListId","canAdd","canEdit","checklistEdit","creator","canModify","actions","modify","canRemove","remove","canToggle","toggle","hasAttachments","hasUsers","hasAccomplices","hasAuditors","files","attachments","textColor","completed","linkColor","groupModeSelected","canDragItem","readOnly","textReadOnly","mapActions","handleFocus","handleBlur","handleEmptyBlur","handleLinkClick","updateCheckList","upsertCheckLists","updateTitle","addItem","isNumber","removeItem","complete","listParents","completionCallback","saveCompleteState","addCheckListCompletionCallback","callback","renew","scrollToItem","Promise","resolve","itemRect","CheckListParentItem","BMenu","GrowingTextArea","UserAvatarList","UserCheckbox","ProgressBar","mixins","Actions","isSticky","isMenuShown","menuRemoveSectionCode","menuOptions","Text","getRandom","bindElement","more","minWidth","sections","code","menuItems","targetContainer","body","collapseItem","icon","OBSERVER","CROSSED_EYE","onClick","newValue","toggleCompleted","groupActionsItem","MULTICHOICE_ON","toggleCollapse","editItem","sectionCode","EDIT_L","design","TRASHCAN","itemIcon","CHECK_L","CHECK_LIST","checkListStatus","label","replace","completedCount","totalCount","currentUserResponsible","responsibleIds","currentUser","Users","numberMyItems","myFilterTooltip","myFilter","fontSize","handleMyFilter","handleCompleteState","setItemsRef","handleScroll","checkSticky","mutationObserver","MutationObserver","childList","subtree","handleTextClick","checked","idsToHide","stickyRect","getBoundingClientRect","showMenu","collapse","expand","CheckListCheckbox","UiCheckbox","important","disabled","highlight","CheckListChildItem","BLine","UserFieldWidgetComponent","DiskUserFieldWidgetComponent","itemOffset","fileServiceInstance","fileService","get","EntityTypes","CheckListItem","parentEntityId","uploaderAdapter","getAdapter","uploadingFiles","getFiles","filesLoading","widgetOptions","isEmbedded","withControlPanel","canCreateDocuments","tileWidgetOptions","compact","hideDropArea","enableDropzone","readonly","autoCollapse","removeFromServer","hasFilesAttach","hasFiles","isUploading","hasUploadingError","filesNumber","hasTrashcanIcon","panelIsShown","toggleable","loadFiles","growingTextArea","focusTextarea","subscribeToEvents","unsubscribeToEvents","HighlightCheckListItem","handleHighlightItemEvent","unsubscribe","toggleGroupModeSelected","ids","file","list","handleEnter","handleClick","filesWidget","isClickInsideFilesWidget","filesNode","excludedClasses","isInsideWidget","contains","hasExcludedClass","hasClass","highlighter","CheckListAddItem","CheckListDropList","CheckListDropItem","dropOffset","CheckListGroupCompletedList","totalCompletedParents","completedParentsLabel","CheckListWidget","context","parentCheckLists","checkList","siblings","parentItemDragged","listDragManager","baseEvent","scrollToTarget","handleDropException","itemDragManager","parentElement","initDragManager","focusTo","unsubscribeFromEvents","ShowCheckList","handleShowCheckListEvent","ShowCheckListItems","handleShowCheckListItemsEvent","focusedItem","targetId","shouldHighlight","calculateFocusTarget","isRootItem","childWithEmptyTitle","targetNode","highlightParentContainer","highlightElement","getItemOffset","querySelectorAll","isCollapsed","getFirstCompletedCheckList","completedCheckLists","checkListItemIds","isArrayFilled","firstItemId","showFirstCompletedCheckList","firstCompletedCheckList","isElementNode","$root","parentRect","parentRelativeRect","left","parentComponents","PanelSection","Important","Attachments","Movement","Accomplice","Auditor","Forward","Delete","Cancel","PanelAction","SetImportant","AttachFile","MoveRight","MoveLeft","AssignAccomplice","AssignAuditor","PanelMeta","defaultSections","FIRE","activeIcon","FIRE_SOLID","hoverable","ATTACH","POINT_RIGHT","POINT_LEFT","PERSON","FORWARD","CROSS_L","CheckListItemPanel","currentHintElement","currentHintText","isStakeholdersRestricted","Core","getParams","restrictions","stakeholder","available","section","visibleSections","canShowPanelSection","visibleActions","isItemDisabled","isItemActive","timeout","background","darkMode","bindOptions","forceBindPosition","forceTop","position","itemGroupModeSelected","stakeholdersActions","isDisabledStakeholders","disabledActions","itemLevel","conditionHandlers","canChangeAccomplices","canAuditorsAdd","condition","activeActions","isImportant","addAuditors","changeAccomplices","getItemIcon","handleItemClick","currentTarget","handleItemMouseEnter","sectionName","features","disk","CheckListNotifier","content","timerValue","showBalloonWithTimer","balloonId","UI","Notification","Center","notify","mouseup","handler","closingBalloon","getTarget","getId","stopTimer","close","setInterval","update","clearInterval","provide","getItemsRef","isAutonomous","isComponentShown","AirButtonStyle","ButtonIcon","itemPanelIsShown","checkListWasUpdated","lastUpdatedCheckListId","itemPanelStyles","display","isItemPanelFreeze","itemPanelTopOffset","itemPanelTopLimit","itemsRefs","isForwardMenuShown","forwardMenuSectionCode","forwardBindElement","shownPopups","notifiers","isFreeze","closing","checkListCompletionCallback","componentName","true","contextClass","componentShown","hasFewParentCheckLists","forwardMenuOptions","maxWidth","maxHeight","forwardMenuItems","checklistItems","hideItemPanel","forwardGroupItemsToChecklist","forwardToChecklist","forwardToNewChecklist","stub","emptyList","popupComponent","executeCheckListCompletionCallbacks","isNewCheckList","isString","forceSavePending","handleShowPopup","handleClosePopup","handleUpdate","handleUpdatingFreezeState","hasEmptyItem","getItemIdWithUploadingFiles","unfreeze","handleRemove","addItemToDelete","messageKey","notifier","subscribeOnce","timerHasEnded","removeItemFromDelete","delete","isCurrentItemEmpty","updatePanelPosition","cleanNotifiers","cancelGroupMode","cleanCollapsedState","firstEmptyItem","focusToItem","itemIdWithUploadingFiles","cleanEmptyItems","saveCheckList","handleIsShown","popup","getCompatData","isHintPopup","startsWith","handleGroupRemove","allSelectedItems","nearestItem","showItemPanel","allSelectedItemIds","idsToShow","setDefaultCheckListTitle","handleGroupMode","firstChild","activateGroupMode","handleGroupModeSelect","showItemPanelOnNearestSelectedItem","handlePanelAction","actionHandlers","n","setImportant","attachFile","moveGroupToRight","moveGroupToLeft","showParticipantDialog","forward","handleOpenCheckList","updateTask","taskService","updateStoreTask","insertCheckList","insertManyCheckLists","deleteCheckList","isDemoCheckListModified","removeChecklists","fullListDeletingIds","checkListsToSave","save","getCheckListsNumber","demoTitle","hasItemUsers","addCheckList","empty","childId","getDataForNewCheckList","addFastCheckList","showForwardMenu","getCountForNewCheckList","getSortForNewCheckList","ref","itemRef","hasActiveGroupMode","insertItem","addItemFromBtn","isRootCall","checkListIds","addCheckListItemToDeleting","removeCheckListItemFromDeleting","deactivateGroupMode","nearestSelectedItem","panelRect","panel","listRect","paddingOffset","panelWidth","topLimitValue","panelVisible","topPopupLimitValue","popupVisible","fileServiceInstances","getCurrentFileService","handleFreeze","browse","onShowCallback","onHideCallback","getEntityId","finalSortIndex","movingItem","checkListIdsFromWhichWereForwarded","allSelectedWithChildren","selectedItemsIds","shouldUpdateParentId","usersIds","saveParticipants","usersDialog","show","withAngle","users","getStoreTask","existingIds","mergedIds","visibleItems","clear","CheckListChip","Chip","isSelected","ChipDesign","ShadowNoAccent","ShadowAccent","OutlineNoAccent","OutlineAccent","wasFilled","checkListItemCount","getCompletedCount","LOADER_WAIT","AiAddCheckList","handleAiAdd","handleFieldClose","showCheckList","highlightField","buildAiCheckList","focus","buildEmptyCheckList","baseText","titles","split","line","trim","checkListsNumber","taskChecklist","fieldHighlighter","setContainer"],"mappings":"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"}