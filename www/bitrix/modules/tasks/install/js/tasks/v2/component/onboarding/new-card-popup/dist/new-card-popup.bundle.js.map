{"version":3,"file":"new-card-popup.bundle.js","sources":["../src/new-card-popup.js"],"sourcesContent":["import { Tag, Loc, Event, ajax } from 'main.core';\nimport { Popup } from 'main.popup';\n\nimport { Button, AirButtonStyle, ButtonSize } from 'ui.buttons';\nimport { Icon, Outline } from 'ui.icon-set.api.core';\nimport { BannerDispatcher } from 'ui.banner-dispatcher';\n\nimport './new-card-popup.css';\n\nexport class NewCardPopup\n{\n\t#popup: Popup;\n\n\tstatic show(): void\n\t{\n\t\treturn new this().showPopup();\n\t}\n\n\tshowPopup(): void\n\t{\n\t\tBannerDispatcher.high.toQueue((onDone) => {\n\t\t\tthis.#popup = this.getPopup();\n\n\t\t\tconst onClose = () => {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tonDone();\n\t\t\t\t}, 1000);\n\t\t\t};\n\n\t\t\tthis.#popup.show();\n\t\t\tthis.#popup.subscribe('onClose', onClose);\n\t\t\tthis.#popup.subscribe('onDestroy', onClose);\n\n\t\t\tthis.setViewed();\n\t\t});\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\treturn new Popup({\n\t\t\tcontent: this.getContent(),\n\t\t\tdisableScroll: true,\n\t\t\tautoHide: true,\n\t\t\tpadding: 0,\n\t\t\twidth: 905,\n\t\t\theight: 525,\n\t\t\tautoHideHandler: () => true,\n\t\t\toverlay: {\n\t\t\t\tbackgroundColor: '#0A2D5F',\n\t\t\t\topacity: 58,\n\t\t\t},\n\t\t\tcloseIcon: false,\n\t\t\tcloseByEsc: false,\n\t\t\tclassName: 'tasks-onboarding-new-card-popup-wrapper',\n\t\t});\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-onboarding-new-card-popup\">\n\t\t\t\t<div class=\"tasks-onboarding-new-card-popup-content-gradient\">\n\t\t\t\t\t<div class=\"tasks-onboarding-new-card-popup-content\">\n\t\t\t\t\t\t<div class=\"tasks-onboarding-new-card-popup-left\">\n\t\t\t\t\t\t\t<div class=\"tasks-onboarding-new-card-popup-title\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_COMPONENT_ONBOARDING_NEW_CARD_POPUP_TITLE')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-onboarding-new-card-popup-feature-list\">\n\t\t\t\t\t\t\t\t${this.getFeatures().map((feature) => this.getFeatureElement(feature))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t${this.getButton()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-onboarding-new-card-popup-right\">\n\t\t\t\t\t\t\t<img \n\t\t\t\t\t\t\t\tclass=\"tasks-onboarding-new-card-popup-cosmozeph\" \n\t\t\t\t\t\t\t\tsrc=\"${this.getCosmozephPath()}\" \n\t\t\t\t\t\t\t\talt=\"\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div class=\"tasks-onboarding-new-card-popup-video-border\">\n\t\t\t\t\t\t\t\t${this.getVideoElement()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-onboarding-new-card-popup-pill --fast\">${Loc.getMessage('TASKS_COMPONENT_ONBOARDING_NEW_CARD_POPUP_FAST')}</div>\n\t\t\t\t\t\t\t<div class=\"tasks-onboarding-new-card-popup-pill --simple\">${Loc.getMessage('TASKS_COMPONENT_ONBOARDING_NEW_CARD_POPUP_SIMPLE')}</div>\n\t\t\t\t\t\t\t<div class=\"tasks-onboarding-new-card-popup-pill --ai\">${Loc.getMessage('TASKS_COMPONENT_ONBOARDING_NEW_CARD_POPUP_AI')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetOverlay(): HTMLElement\n\t{\n\t\tconst element = Tag.render`<div class=\"tasks-onboarding-new-card-popup-overlay\"></div>`;\n\n\t\tEvent.bind(element, 'click', () => {\n\t\t\tthis.close();\n\t\t});\n\n\t\treturn element;\n\t}\n\n\tgetFeatureElement(feature): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-onboarding-new-card-popup-feature\">\n\t\t\t\t${this.getFeatureIcon(feature.icon)}\n\t\t\t\t<div class=\"tasks-onboarding-new-card-popup-feature-content\">\n\t\t\t\t\t<div class=\"tasks-onboarding-new-card-popup-feature-title\">${feature.title}</div>\n\t\t\t\t\t<div class=\"tasks-onboarding-new-card-popup-feature-subtitle\">${feature.subtitle}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetFeatureIcon(featureIcon): HTMLElement\n\t{\n\t\tconst icon = new Icon({\n\t\t\ticon: featureIcon,\n\t\t\tsize: 22,\n\t\t\tcolor: '#fff',\n\t\t});\n\n\t\treturn icon.render();\n\t}\n\n\tgetButton(): HTMLElement\n\t{\n\t\tconst button = new Button({\n\t\t\tuseAirDesign: true,\n\t\t\ttext: Loc.getMessage('TASKS_COMPONENT_ONBOARDING_NEW_CARD_POPUP_BUTTON_START'),\n\t\t\tstyle: AirButtonStyle.FILLED,\n\t\t\tsize: ButtonSize.EXTRA_LARGE,\n\t\t\tonclick: () => {\n\t\t\t\tthis.close();\n\t\t\t},\n\t\t});\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-onboarding-new-card-popup-button-container\">\n\t\t\t\t${button.render()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetVideoElement(): HTMLElement\n\t{\n\t\tconst video = Tag.render`\n\t\t\t<video\n\t\t\t\tclass=\"tasks-onboarding-new-card-popup-video\"\n\t\t\t\tautoplay\n\t\t\t\tloop\n\t\t\t\tmuted\n\t\t\t\tplaysinline\n\t\t\t\tpreload=\"auto\"\n\t\t\t>\n\t\t\t\t<source src=\"${this.getVideoPath()}\" type=\"video/webm\">\n\t\t\t</video>\n\t\t`;\n\n\t\tsetTimeout(() => {\n\t\t\tEvent.bind(video, 'error', () => {});\n\n\t\t\tEvent.bind(video, 'loadeddata', () => {\n\t\t\t\tvideo.play().catch(() => {});\n\t\t\t});\n\n\t\t\tvideo.load();\n\t\t\tconst playPromise = video.play();\n\n\t\t\tif (playPromise !== undefined)\n\t\t\t{\n\t\t\t\tplayPromise.catch(() => {\n\t\t\t\t\tvideo.muted = true;\n\t\t\t\t\tvideo.play();\n\t\t\t\t});\n\t\t\t}\n\t\t}, 0);\n\n\t\treturn video;\n\t}\n\n\tgetVideoPath(): string\n\t{\n\t\treturn '/bitrix/js/tasks/v2/component/onboarding/new-card-popup/src/preview.webm';\n\t}\n\n\tgetCosmozephPath(): string\n\t{\n\t\treturn '/bitrix/js/tasks/v2/component/onboarding/new-card-popup/src/cosmozeph.png';\n\t}\n\n\tgetFeatures(): Array\n\t{\n\t\treturn [\n\t\t\t{\n\t\t\t\ticon: Outline.AI_STARS,\n\t\t\t\ttitle: Loc.getMessage('TASKS_COMPONENT_ONBOARDING_NEW_CARD_POPUP_FEATURE_TITLE_1'),\n\t\t\t\tsubtitle: Loc.getMessage('TASKS_COMPONENT_ONBOARDING_NEW_CARD_POPUP_FEATURE_DESCRIPTION_1'),\n\t\t\t},\n\t\t\t{\n\t\t\t\ticon: Outline.CHATS,\n\t\t\t\ttitle: Loc.getMessage('TASKS_COMPONENT_ONBOARDING_NEW_CARD_POPUP_FEATURE_TITLE_2'),\n\t\t\t\tsubtitle: Loc.getMessage('TASKS_COMPONENT_ONBOARDING_NEW_CARD_POPUP_FEATURE_DESCRIPTION_2'),\n\t\t\t},\n\t\t\t{\n\t\t\t\ticon: Outline.ACTION_REQUIRED,\n\t\t\t\ttitle: Loc.getMessage('TASKS_COMPONENT_ONBOARDING_NEW_CARD_POPUP_FEATURE_TITLE_3'),\n\t\t\t\tsubtitle: Loc.getMessage('TASKS_COMPONENT_ONBOARDING_NEW_CARD_POPUP_FEATURE_DESCRIPTION_3'),\n\t\t\t},\n\t\t];\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.#popup.close();\n\t}\n\n\tsetViewed(): void\n\t{\n\t\tvoid ajax.runAction('tasks.promotion.setViewed', {\n\t\t\tdata: {\n\t\t\t\tpromotion: 'tasks_new_card',\n\t\t\t},\n\t\t});\n\t}\n}\n"],"names":["NewCardPopup","show","showPopup","BannerDispatcher","high","toQueue","onDone","getPopup","onClose","setTimeout","subscribe","setViewed","Popup","content","getContent","disableScroll","autoHide","padding","width","height","autoHideHandler","overlay","backgroundColor","opacity","closeIcon","closeByEsc","className","Tag","render","Loc","getMessage","getFeatures","map","feature","getFeatureElement","getButton","getCosmozephPath","getVideoElement","getOverlay","element","Event","bind","close","getFeatureIcon","icon","title","subtitle","featureIcon","Icon","size","color","button","Button","useAirDesign","text","style","AirButtonStyle","FILLED","ButtonSize","EXTRA_LARGE","onclick","video","getVideoPath","play","catch","load","playPromise","undefined","muted","Outline","AI_STARS","CHATS","ACTION_REQUIRED","ajax","runAction","data","promotion"],"mappings":"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"}