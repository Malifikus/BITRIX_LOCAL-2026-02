this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};this.BX.Tasks.V2=this.BX.Tasks.V2||{};this.BX.Tasks.V2.Component=this.BX.Tasks.V2.Component||{};(function(t,s,e,i,a,c,n,d,o,l,h,r,k){"use strict";const p=Object.freeze({id:e.TaskField.Accomplices,title:i.Loc.getMessage("TASKS_V2_ACCOMPLICES_TITLE")});const u={name:"TaskAccomplices",components:{Participants:s.Participants},inject:{task:{},taskId:{},analytics:{},cardType:{}},setup(){return{accomplicesMeta:p}},computed:{dataset(){return{"data-task-id":this.taskId,"data-task-field-id":p.id,"data-task-field-value":this.task.accomplicesIds.join(",")}},isLocked(){return!d.Core.getParams().restrictions.stakeholder.available},featureId(){return d.Core.getParams().restrictions.stakeholder.featureId},accomplicesCount(){var t,s;return(t=(s=this.task.accomplicesIds)==null?void 0:s.length)!=null?t:0}},methods:{update(t){const s=k.taskService.hasChanges(this.task,{accomplicesIds:t})&&t.length>0&&t.length>=this.accomplicesCount;void k.taskService.update(this.taskId,{accomplicesIds:t});if(s){var e,a;l.analytics.sendAddCoexecutor(this.analytics,{cardType:this.cardType,taskId:i.Type.isNumber(this.taskId)?this.taskId:0,viewersCount:(e=(a=this.task.auditorsIds)==null?void 0:a.length)!=null?e:0,coexecutorsCount:t.length})}}},template:`\n\t\t<Participants\n\t\t\t:taskId\n\t\t\t:context="accomplicesMeta.id"\n\t\t\t:userIds="task.accomplicesIds"\n\t\t\t:canAdd="task.rights.changeAccomplices"\n\t\t\t:canRemove="task.rights.changeAccomplices"\n\t\t\t:dataset\n\t\t\t:isLocked\n\t\t\t:featureId\n\t\t\t@update="update"\n\t\t/>\n\t`};const m={components:{Chip:a.Chip},inject:{task:{},taskId:{},analytics:{},cardType:{}},setup(){return{Outline:c.Outline,accomplicesMeta:p}},computed:{design(){return this.isSelected?a.ChipDesign.ShadowAccent:a.ChipDesign.ShadowNoAccent},isSelected(){return this.task.filledFields[p.id]},isLocked(){return!d.Core.getParams().restrictions.stakeholder.available}},methods:{handleClick(){if(this.isSelected){this.highlightField();return}if(this.isLocked){void h.showLimit({featureId:d.Core.getParams().restrictions.stakeholder.featureId,bindElement:this.$el});return}void r.usersDialog.show({targetNode:this.$el,ids:this.task.accomplicesIds,onClose:this.handleClose})},handleClose(t){if(!this.isSelected&&t.length>0){var s,e;this.highlightField();l.analytics.sendAddCoexecutor(this.analytics,{cardType:this.cardType,taskId:i.Type.isNumber(this.taskId)?this.taskId:0,viewersCount:(s=(e=this.task.auditorsIds)==null?void 0:e.length)!=null?s:0,coexecutorsCount:t.length})}void k.taskService.update(this.taskId,{accomplicesIds:t})},highlightField(){void o.fieldHighlighter.setContainer(this.$root.$el).highlight(p.id)}},template:`\n\t\t<Chip\n\t\t\tv-if="isSelected || task.rights.changeAccomplices"\n\t\t\t:design\n\t\t\t:icon="Outline.PERSON"\n\t\t\t:lock="isLocked"\n\t\t\t:text="loc('TASKS_V2_ACCOMPLICES_TITLE_CHIP')"\n\t\t\t:data-task-id="taskId"\n\t\t\t:data-task-chip-id="accomplicesMeta.id"\n\t\t\t:data-task-chip-value="task.accomplicesIds.join(',')"\n\t\t\t@click="handleClick"\n\t\t/>\n\t`};t.Accomplices=u;t.AccomplicesChip=m;t.accomplicesMeta=p})(this.BX.Tasks.V2.Component.Fields=this.BX.Tasks.V2.Component.Fields||{},BX.Tasks.V2.Component.Elements,BX.Tasks.V2.Const,BX,BX.UI.System.Chip.Vue,BX.UI.IconSet,BX,BX.Tasks.V2,BX.Tasks.V2.Lib,BX.Tasks.V2.Lib,BX.Tasks.V2.Lib,BX.Tasks.V2.Lib,BX.Tasks.V2.Provider.Service);
//# sourceMappingURL=accomplices.bundle.map.js