{"version":3,"file":"comment-files.bundle.js","sources":["../src/comment-files.js"],"sourcesContent":["import { Tag } from 'main.core';\n\nimport { Chip, ChipDesign } from 'ui.system.chip.vue';\nimport { Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport './comment-files.css';\n\n// @vue/component\nexport const CommentFilesChip = {\n\tcomponents: {\n\t\tChip,\n\t},\n\tinject: {\n\t\ttaskId: {},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tChipDesign,\n\t\t};\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(`tasks-comment-files-${this.taskId}`, {\n\t\t\t\twidth: 800,\n\t\t\t\tcustomLeftBoundary: 0,\n\t\t\t\tcustomRightBoundary: 0,\n\t\t\t\tcontentCallback: async (): Promise<HTMLElement> => {\n\t\t\t\t\tthis.content ??= await this.getContent(this.taskId);\n\n\t\t\t\t\treturn this.content;\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tasync getContent(taskId: number): Promise<HTMLElement | string>\n\t\t{\n\t\t\tconst response = await BX.ajax.runComponentAction('bitrix:tasks.task', 'getFiles', {\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: { taskId },\n\t\t\t});\n\n\t\t\tif (!response.data?.html)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst content = document.createElement('div');\n\t\t\tBX.html(null, response.data.asset.join(' ')).then(() => {\n\t\t\t\tcontent.innerHTML = response.data.html;\n\t\t\t\tBX.ajax.processScripts(BX.processHTML(response.data.html).SCRIPT);\n\t\t\t});\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"tasks-field-comment-files\">\n\t\t\t\t\t${content}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Chip\n\t\t\t:text=\"loc('TASKS_V2_COMMENT_FILES_TITLE_CHIP')\"\n\t\t\t:icon=\"Outline.FILE\"\n\t\t\t:design=\"ChipDesign.ShadowAccent\"\n\t\t\t@click=\"handleClick\"\n\t\t/>\n\t`,\n};\n"],"names":["CommentFilesChip","components","Chip","inject","taskId","setup","Outline","ChipDesign","methods","handleClick","BX","SidePanel","Instance","open","width","customLeftBoundary","customRightBoundary","contentCallback","content","getContent","response","ajax","runComponentAction","mode","data","html","document","createElement","asset","join","then","innerHTML","processScripts","processHTML","SCRIPT","Tag","render","template"],"mappings":";;;;;;;;;;AAAA;CAQA;AACA,OAAaA,gBAAgB,GAAG;GAC/BC,UAAU,EAAE;WACXC;IACA;GACDC,MAAM,EAAE;KACPC,MAAM,EAAE;IACR;GACDC,KAAK,GACL;KACC,OAAO;gBACNC,0BAAO;mBACPC;MACA;IACD;GACDC,OAAO,EAAE;KACRC,WAAW,GACX;OACCC,EAAE,CAACC,SAAS,CAACC,QAAQ,CAACC,IAAI,CAAE,uBAAsB,IAAI,CAACT,MAAO,EAAC,EAAE;SAChEU,KAAK,EAAE,GAAG;SACVC,kBAAkB,EAAE,CAAC;SACrBC,mBAAmB,EAAE,CAAC;SACtBC,eAAe,EAAE,YAAkC;WAAA;WAClD,qBAAI,CAACC,OAAO,4BAAZ,IAAI,CAACA,OAAO,GAAK,MAAM,IAAI,CAACC,UAAU,CAAC,IAAI,CAACf,MAAM,CAAC;WAEnD,OAAO,IAAI,CAACc,OAAO;;QAEpB,CAAC;MACF;KACD,MAAMC,UAAU,CAACf,MAAc,EAC/B;OAAA;OACC,MAAMgB,QAAQ,GAAG,MAAMV,EAAE,CAACW,IAAI,CAACC,kBAAkB,CAAC,mBAAmB,EAAE,UAAU,EAAE;SAClFC,IAAI,EAAE,OAAO;SACbC,IAAI,EAAE;WAAEpB;;QACR,CAAC;OAEF,IAAI,oBAACgB,QAAQ,CAACI,IAAI,aAAb,eAAeC,IAAI,GACxB;SACC,OAAO,EAAE;;OAGV,MAAMP,OAAO,GAAGQ,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;OAC7CjB,EAAE,CAACe,IAAI,CAAC,IAAI,EAAEL,QAAQ,CAACI,IAAI,CAACI,KAAK,CAACC,IAAI,CAAC,GAAG,CAAC,CAAC,CAACC,IAAI,CAAC,MAAM;SACvDZ,OAAO,CAACa,SAAS,GAAGX,QAAQ,CAACI,IAAI,CAACC,IAAI;SACtCf,EAAE,CAACW,IAAI,CAACW,cAAc,CAACtB,EAAE,CAACuB,WAAW,CAACb,QAAQ,CAACI,IAAI,CAACC,IAAI,CAAC,CAACS,MAAM,CAAC;QACjE,CAAC;OAEF,OAAOC,aAAG,CAACC,MAAM,cAAC;;OAEhB,CAAU;;IAEZ,GAFIlB,OAAO;;IAIZ;GACDmB,QAAQ,EAAG;;;;;;;;CAQZ,CAAC;;;;;;;;"}