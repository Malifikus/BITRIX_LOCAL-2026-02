{"version":3,"file":"task-settings-popup.bundle.js","sources":["../src/component/setting/task-setting.js","../src/component/setting/task-deadline-default-setting.js","../src/component/setting/task-deadline-settings.js","../src/component/task-settings.js","../src/task-settings-popup.js"],"sourcesContent":["import { TextSm } from 'ui.system.typography.vue';\nimport { SwitcherSize, type SwitcherOptions } from 'ui.switcher';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport { Switcher } from 'ui.vue3.components.switcher';\n\nimport { showLimit } from 'tasks.v2.lib.show-limit';\nimport { QuestionMark } from 'tasks.v2.component.elements.question-mark';\n\nimport './task-setting.css';\n\n// @vue/component\nexport const TaskSetting = {\n\tname: 'TasksTaskSetting',\n\tcomponents: {\n\t\tSwitcher,\n\t\tTextSm,\n\t\tQuestionMark,\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tlabel: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tquestionMarkHint: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tlock: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tfeatureId: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\temits: ['update:modelValue'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tcomputed: {\n\t\tswitcherOptions(): SwitcherOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsize: SwitcherSize.small,\n\t\t\t\tuseAirDesign: true,\n\t\t\t};\n\t\t},\n\t\thasLabelSlot(): boolean\n\t\t{\n\t\t\treturn Boolean(this.$slots.label);\n\t\t},\n\t},\n\tmethods: {\n\t\thandleContainerClick(): void\n\t\t{\n\t\t\tif (this.lock)\n\t\t\t{\n\t\t\t\tthis.handleLockClick();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('update:modelValue', !this.modelValue);\n\t\t},\n\t\thandleLockClick(): void\n\t\t{\n\t\t\tif (!this.featureId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid showLimit({\n\t\t\t\tfeatureId: this.featureId,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-task-setting\">\n\t\t\t<div class=\"tasks-task-setting-switcher\">\n\t\t\t\t<Switcher\n\t\t\t\t\t:isChecked=\"modelValue\"\n\t\t\t\t\t:options=\"switcherOptions\"\n\t\t\t\t\t@click=\"handleContainerClick\"\n\t\t\t\t/>\n\t\t\t\t<slot v-if=\"hasLabelSlot\" name=\"label\"/>\n\t\t\t\t<TextSm\n\t\t\t\t\tv-else\n\t\t\t\t\tclass=\"tasks-task-setting-switcher-label\"\n\t\t\t\t\t@click=\"handleContainerClick\"\n\t\t\t\t>{{ label }}</TextSm>\n\t\t\t\t<QuestionMark v-if=\"questionMarkHint\" :hintText=\"questionMarkHint\"/>\n\t\t\t\t<BIcon \n\t\t\t\t\tv-if=\"lock\"\n\t\t\t\t\t:name=\"Outline.LOCK_M\"\n\t\t\t\t\tclass=\"tasks-task-setting-switcher-lock\"\n\t\t\t\t\t@click=\"handleLockClick\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div v-if=\"modelValue && $slots.default\" class=\"tasks-task-setting-content\">\n\t\t\t\t<slot/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { DurationFormat } from 'main.date';\nimport 'ui.forms';\nimport { DurationUnit } from 'tasks.v2.const';\n\nimport './task-deadline-default-setting.css';\n\n// @vue/component\nexport const TaskDeadlineDefaultSetting = {\n\tname: 'TasksTaskDeadlineDefaultSetting',\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t\tdefault: 0,\n\t\t},\n\t},\n\temits: [\n\t\t'update:modelValue',\n\t\t'updateDeadlineUserOption',\n\t],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tperiodOptions: [\n\t\t\t\t{ value: DurationUnit.Hours, label: this.loc('TASKS_V2_TASK_SETTINGS_POPUP_DEADLINE_PERIOD_HOUR') },\n\t\t\t\t{ value: DurationUnit.Days, label: this.loc('TASKS_V2_TASK_SETTINGS_POPUP_DEADLINE_PERIOD_DAY') },\n\t\t\t\t{ value: DurationUnit.Weeks, label: this.loc('TASKS_V2_TASK_SETTINGS_POPUP_DEADLINE_PERIOD_WEEK') },\n\t\t\t\t{ value: DurationUnit.Months, label: this.loc('TASKS_V2_TASK_SETTINGS_POPUP_DEADLINE_PERIOD_MONTH') },\n\t\t\t],\n\t\t\tselectedPeriod: DurationUnit.Days,\n\t\t\tlocalValue: '',\n\t\t};\n\t},\n\twatch: {\n\t\tmodelValue: {\n\t\t\timmediate: true,\n\t\t\thandler(newValue): void\n\t\t\t{\n\t\t\t\tif (newValue <= 0)\n\t\t\t\t{\n\t\t\t\t\tthis.localValue = '';\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst bestPeriod = this.findBestPeriod(newValue);\n\t\t\t\tthis.selectedPeriod = bestPeriod.period;\n\n\t\t\t\tconst periodInSeconds = this.getPeriodInSeconds(bestPeriod.period);\n\n\t\t\t\tconst valueInPeriod = newValue / periodInSeconds;\n\n\t\t\t\tthis.localValue = this.formatValue(valueInPeriod, bestPeriod.period);\n\t\t\t},\n\t\t},\n\t},\n\tmethods: {\n\t\thandleBlur(): void\n\t\t{\n\t\t\tthis.updateModelValue();\n\t\t},\n\t\tfindBestPeriod(seconds: number): { period: string, value: number }\n\t\t{\n\t\t\tconst periods = [\n\t\t\t\t{ period: DurationUnit.Months, duration: this.getPeriodInSeconds(DurationUnit.Months) },\n\t\t\t\t{ period: DurationUnit.Weeks, duration: this.getPeriodInSeconds(DurationUnit.Weeks) },\n\t\t\t\t{ period: DurationUnit.Days, duration: this.getPeriodInSeconds(DurationUnit.Days) },\n\t\t\t\t{ period: DurationUnit.Hours, duration: this.getPeriodInSeconds(DurationUnit.Hours) },\n\t\t\t].sort((a, b) => b.duration - a.duration);\n\n\t\t\tfor (const { period, duration } of periods)\n\t\t\t{\n\t\t\t\tconst value = seconds / duration;\n\n\t\t\t\tif (Number.isInteger(value) && value >= 1)\n\t\t\t\t{\n\t\t\t\t\treturn { period, value };\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const { period, duration } of periods)\n\t\t\t{\n\t\t\t\tconst value = seconds / duration;\n\n\t\t\t\tif (value >= 1 && value < 1000)\n\t\t\t\t{\n\t\t\t\t\treturn { period, value };\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn { period: DurationUnit.Hours, value: seconds / this.getPeriodInSeconds(DurationUnit.Hours) };\n\t\t},\n\t\tformatValue(value: number, period: string): string\n\t\t{\n\t\t\tif (period === DurationUnit.Hours && value >= 24)\n\t\t\t{\n\t\t\t\tconst days = value / 24;\n\t\t\t\tif (days === Math.floor(days))\n\t\t\t\t{\n\t\t\t\t\treturn days.toString();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (value % 1 !== 0)\n\t\t\t{\n\t\t\t\treturn value.toFixed(2).replace(/\\.?0+$/, '');\n\t\t\t}\n\n\t\t\treturn value.toString();\n\t\t},\n\t\tupdateSelectedPeriod(event): void\n\t\t{\n\t\t\tthis.selectedPeriod = event.target.value;\n\t\t\tthis.updateModelValue();\n\t\t},\n\t\tupdateModelValue(): void\n\t\t{\n\t\t\tif (!this.localValue || Number.isNaN(parseFloat(this.localValue)))\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', 0);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst numericValue = parseFloat(this.localValue);\n\t\t\tif (numericValue <= 0)\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', 0);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.emitDeadlineUserOptionUpdate(this.selectedPeriod);\n\n\t\t\tconst periodInSeconds = this.getPeriodInSeconds(this.selectedPeriod);\n\t\t\tconst seconds = numericValue * periodInSeconds;\n\n\t\t\tthis.$emit('update:modelValue', Math.round(seconds));\n\t\t},\n\t\tgetPeriodInSeconds(selectedPeriod: string): number\n\t\t{\n\t\t\tconst unitDurations = DurationFormat.getUnitDurations();\n\n\t\t\tswitch (selectedPeriod)\n\t\t\t{\n\t\t\t\tcase DurationUnit.Hours:\n\t\t\t\t\treturn unitDurations.H / 1000;\n\t\t\t\tcase DurationUnit.Days:\n\t\t\t\t\treturn unitDurations.d / 1000;\n\t\t\t\tcase DurationUnit.Weeks:\n\t\t\t\t\treturn unitDurations.d * 7 / 1000;\n\t\t\t\tcase DurationUnit.Months:\n\t\t\t\t\treturn unitDurations.d * 30 / 1000;\n\t\t\t\tdefault:\n\t\t\t\t\treturn unitDurations.H / 1000;\n\t\t\t}\n\t\t},\n\t\temitDeadlineUserOptionUpdate(selectedPeriod: string): void\n\t\t{\n\t\t\tthis.$emit('updateDeadlineUserOption', {\n\t\t\t\tisExactDeadlineTime: selectedPeriod === DurationUnit.Hours,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-task-deadline-setting\">\n\t\t\t<div class=\"ui-ctl ui-ctl-textbox\">\n\t\t\t\t<input\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\tv-model.trim=\"localValue\"\n\t\t\t\t\tdata-id=\"tasks-task-deadline-setting-value\"\n\t\t\t\t\t@blur=\"handleBlur\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown\">\n\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"/>\n\t\t\t\t<select class=\"ui-ctl-element\" :value=\"selectedPeriod\" @change=\"updateSelectedPeriod\">\n\t\t\t\t\t<option\n\t\t\t\t\t\tv-for=\"option in periodOptions\"\n\t\t\t\t\t\t:key=\"option.value\"\n\t\t\t\t\t\t:value=\"option.value\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ option.label }}\n\t\t\t\t\t</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Text } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\nimport type { BaseEvent } from 'main.core.events';\n\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { DatePicker, DatePickerEvent } from 'ui.date-picker';\nimport { RichLoc } from 'ui.vue3.components.rich-loc';\nimport { TextSm } from 'ui.system.typography.vue';\nimport { BInput, InputDesign } from 'ui.system.input.vue';\nimport { Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport { Model } from 'tasks.v2.const';\nimport { calendar } from 'tasks.v2.lib.calendar';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { TaskSetting } from './task-setting';\n\nimport './task-deadline-settings.css';\n\nconst limitType = Object.freeze({\n\tdate: 'date',\n\tcount: 'count',\n});\n\n// @vue/component\nexport const TaskDeadlineSettings = {\n\tname: 'TasksTaskDeadlineSettings',\n\tcomponents: {\n\t\tBInput,\n\t\tTaskSetting,\n\t\tTextSm,\n\t\tRichLoc,\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t\tisEdit: {},\n\t},\n\temits: [\n\t\t'updateDeadlineUserOption',\n\t\t'freeze',\n\t\t'unfreeze',\n\t],\n\tsetup(): { task: TaskModel }\n\t{\n\t\treturn {\n\t\t\tInputDesign,\n\t\t\tOutline,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tlimitDeadline: false,\n\t\t\tlimitType: limitType.date,\n\t\t\tisCalendarShown: false,\n\t\t\tlocalDeadlineUserOption: {\n\t\t\t\trequireDeadlineChangeReason: false,\n\t\t\t\tmaxDeadlineChangeDate: this.formatDate(this.getDefaultDate()),\n\t\t\t\tmaxDeadlineChanges: 1,\n\t\t\t},\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tdeadlineUserOption: `${Model.Interface}/deadlineUserOption`,\n\t\t}),\n\t\trequireDeadlineChangeReason: {\n\t\t\tget(): boolean\n\t\t\t{\n\t\t\t\treturn this.localDeadlineUserOption.requireDeadlineChangeReason === true;\n\t\t\t},\n\t\t\tset(value: boolean): void\n\t\t\t{\n\t\t\t\tthis.localDeadlineUserOption.requireDeadlineChangeReason = value;\n\t\t\t\tthis.emitDeadlineUserOptionUpdate();\n\t\t\t},\n\t\t},\n\t\tlocalMaxDeadlineChangeDate: {\n\t\t\tget(): ?Date\n\t\t\t{\n\t\t\t\treturn DateTimeFormat.parse(this.localDeadlineUserOption.maxDeadlineChangeDate);\n\t\t\t},\n\t\t\tset(date: ?Date): void\n\t\t\t{\n\t\t\t\tthis.localDeadlineUserOption.maxDeadlineChangeDate = this.formatDate(date);\n\t\t\t\tthis.emitDeadlineUserOptionUpdate();\n\t\t\t},\n\t\t},\n\t\tlocalMaxDeadlineChanges: {\n\t\t\tget(): string\n\t\t\t{\n\t\t\t\treturn String(this.localDeadlineUserOption.maxDeadlineChanges ?? '');\n\t\t\t},\n\t\t\tset(value: string): void\n\t\t\t{\n\t\t\t\tthis.localDeadlineUserOption.maxDeadlineChanges = value === '' ? 1 : value;\n\t\t\t\tthis.emitDeadlineUserOptionUpdate();\n\t\t\t},\n\t\t},\n\t\tlimitByDate(): boolean\n\t\t{\n\t\t\treturn this.limitType === limitType.date;\n\t\t},\n\t\tlimitByCount(): boolean\n\t\t{\n\t\t\treturn this.limitType === limitType.count;\n\t\t},\n\t},\n\twatch: {\n\t\tisCalendarShown(value: boolean): void\n\t\t{\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tthis.datePicker.show();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.datePicker.hide();\n\t\t\t}\n\n\t\t\tthis.$emit(value ? 'freeze' : 'unfreeze');\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tif (this.isEdit)\n\t\t{\n\t\t\tthis.localDeadlineUserOption.requireDeadlineChangeReason = this.task.requireDeadlineChangeReason;\n\t\t\tthis.localDeadlineUserOption.maxDeadlineChangeDate = this.task.maxDeadlineChangeDate;\n\t\t\tthis.localDeadlineUserOption.maxDeadlineChanges = this.task.maxDeadlineChanges;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.localDeadlineUserOption.requireDeadlineChangeReason = this.deadlineUserOption.requireDeadlineChangeReason;\n\t\t\tthis.localDeadlineUserOption.maxDeadlineChangeDate = this.deadlineUserOption.maxDeadlineChangeDate;\n\t\t\tthis.localDeadlineUserOption.maxDeadlineChanges = this.deadlineUserOption.maxDeadlineChanges;\n\t\t}\n\n\t\tif (this.localDeadlineUserOption.maxDeadlineChangeDate)\n\t\t{\n\t\t\tvoid this.switchToDateLimit();\n\t\t}\n\n\t\tif (this.localDeadlineUserOption.maxDeadlineChanges)\n\t\t{\n\t\t\tthis.switchToCountLimit();\n\t\t}\n\n\t\tthis.limitDeadline = Boolean(this.localMaxDeadlineChangeDate || this.localMaxDeadlineChanges);\n\t},\n\tunmounted(): void\n\t{\n\t\tthis.datePicker?.destroy();\n\t},\n\tmethods: {\n\t\tcreateDatePicker(): DatePicker\n\t\t{\n\t\t\tconst selectedDateTs = this.localMaxDeadlineChangeDate ? this.localMaxDeadlineChangeDate.getTime() : null;\n\n\t\t\treturn new DatePicker({\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tid: `tasks-deadline-settings-calendar-popup-${Text.getRandom()}`,\n\t\t\t\t\tbindElement: this.$refs.calendarInput.$el,\n\t\t\t\t\toffsetTop: -8,\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tforceBindPosition: true,\n\t\t\t\t\t\tforceTop: true,\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tselectedDates: selectedDateTs ? [selectedDateTs] : null,\n\t\t\t\tenableTime: false,\n\t\t\t\tevents: {\n\t\t\t\t\t[DatePickerEvent.SELECT]: (event: BaseEvent) => {\n\t\t\t\t\t\tconst { date } = event.getData();\n\t\t\t\t\t\tthis.localMaxDeadlineChangeDate = calendar.createDateFromUtc(date);\n\t\t\t\t\t\tthis.isCalendarShown = false;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\temitDeadlineUserOptionUpdate(): void\n\t\t{\n\t\t\tconst maxDeadlineChangeDate = this.limitByDate ? this.localDeadlineUserOption.maxDeadlineChangeDate : null;\n\t\t\tconst maxDeadlineChanges = this.limitByDate ? null : this.localDeadlineUserOption.maxDeadlineChanges;\n\n\t\t\tthis.$emit('updateDeadlineUserOption', {\n\t\t\t\trequireDeadlineChangeReason: this.localDeadlineUserOption.requireDeadlineChangeReason,\n\t\t\t\tmaxDeadlineChangeDate: this.limitDeadline ? maxDeadlineChangeDate : null,\n\t\t\t\tmaxDeadlineChanges: this.limitDeadline ? maxDeadlineChanges : null,\n\t\t\t});\n\t\t},\n\t\ttoggleLimit(): void\n\t\t{\n\t\t\tthis.limitDeadline = !this.limitDeadline;\n\n\t\t\tif (\n\t\t\t\tthis.limitDeadline\n\t\t\t\t&& !this.localDeadlineUserOption.maxDeadlineChangeDate\n\t\t\t\t&& !this.localDeadlineUserOption.maxDeadlineChanges\n\t\t\t)\n\t\t\t{\n\t\t\t\tvoid this.switchToDateLimit();\n\t\t\t}\n\n\t\t\tthis.emitDeadlineUserOptionUpdate();\n\t\t},\n\t\tasync switchToDateLimit(): Promise<void>\n\t\t{\n\t\t\tif (!this.limitDeadline)\n\t\t\t{\n\t\t\t\tthis.limitDeadline = true;\n\t\t\t}\n\n\t\t\tif (!this.localDeadlineUserOption.maxDeadlineChangeDate)\n\t\t\t{\n\t\t\t\tthis.localMaxDeadlineChangeDate = this.getDefaultDate();\n\t\t\t}\n\n\t\t\tthis.limitType = limitType.date;\n\n\t\t\tawait this.$nextTick();\n\t\t\tthis.datePicker = this.createDatePicker();\n\n\t\t\tthis.emitDeadlineUserOptionUpdate();\n\t\t},\n\t\tswitchToCountLimit(): void\n\t\t{\n\t\t\tif (!this.limitDeadline)\n\t\t\t{\n\t\t\t\tthis.limitDeadline = true;\n\t\t\t}\n\n\t\t\tif (!this.localDeadlineUserOption.maxDeadlineChanges)\n\t\t\t{\n\t\t\t\tthis.localMaxDeadlineChanges = 1;\n\t\t\t}\n\n\t\t\tthis.limitType = limitType.count;\n\n\t\t\tthis.emitDeadlineUserOptionUpdate();\n\t\t},\n\t\tgetDefaultDate(): Date\n\t\t{\n\t\t\tconst now = new Date();\n\n\t\t\treturn new Date(\n\t\t\t\tnow.getFullYear(),\n\t\t\t\tnow.getMonth() + 1,\n\t\t\t\tnow.getDate(),\n\t\t\t);\n\t\t},\n\t\tformatDate(date: ?Date): ?string\n\t\t{\n\t\t\tif (!date)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn DateTimeFormat.format(DateTimeFormat.getFormat('SHORT_DATE_FORMAT'), date);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-task-deadline-settings\">\n\t\t\t<div class=\"tasks-task-deadline-settings-line\"/>\n\t\t\t<TaskSetting\n\t\t\t\tv-model=\"requireDeadlineChangeReason\"\n\t\t\t\t:label=\"loc('TASKS_V2_TASK_SETTINGS_POPUP_DEADLINE_REASON_LABEL')\"\n\t\t\t\t:questionMarkHint=\"loc('TASKS_V2_TASK_SETTINGS_POPUP_DEADLINE_REASON_HINT')\"\n\t\t\t/>\n\t\t\t<TaskSetting :modelValue=\"limitDeadline\" @update:modelValue=\"toggleLimit\">\n\t\t\t\t<template #label>\n\t\t\t\t\t<TextSm class=\"tasks-task-deadline-settings-label\">\n\t\t\t\t\t\t<div class=\"tasks-task-deadline-settings-label-text\" @click=\"toggleLimit\">\n\t\t\t\t\t\t\t{{ loc('TASKS_V2_TASK_SETTINGS_POPUP_DEADLINE_LIMIT_LABEL') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-task-deadline-settings-label-filter\">\n\t\t\t\t\t\t\t<span :class=\"{'--active': limitByDate}\" @click=\"switchToDateLimit\">\n\t\t\t\t\t\t\t{{ loc('TASKS_V2_TASK_SETTINGS_POPUP_DEADLINE_LIMIT_BY_DATE') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span :class=\"{'--active': limitByCount}\" @click=\"switchToCountLimit\">\n\t\t\t\t\t\t\t{{ loc('TASKS_V2_TASK_SETTINGS_POPUP_DEADLINE_LIMIT_BY_COUNT') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</TextSm>\n\t\t\t\t</template>\n\t\t\t\t<RichLoc\n\t\t\t\t\tv-if=\"limitByDate\"\n\t\t\t\t\tclass=\"tasks-task-deadline-settings-content --date\"\n\t\t\t\t\t:text=\"loc('TASKS_V2_TASK_SETTINGS_POPUP_DEADLINE_BEFORE')\"\n\t\t\t\t\tplaceholder=\"[date/]\"\n\t\t\t\t>\n\t\t\t\t\t<template #date>\n\t\t\t\t\t\t<BInput\n\t\t\t\t\t\t\tref=\"calendarInput\"\n\t\t\t\t\t\t\t:modelValue=\"formatDate(localMaxDeadlineChangeDate)\"\n\t\t\t\t\t\t\t:design=\"InputDesign.LightGrey\"\n\t\t\t\t\t\t\t:icon=\"Outline.CALENDAR_WITH_SLOTS\"\n\t\t\t\t\t\t\thoverable\n\t\t\t\t\t\t\tdata-id=\"tasks-task-deadline-settings-max-date\"\n\t\t\t\t\t\t\t@click=\"isCalendarShown = !isCalendarShown\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</RichLoc>\n\t\t\t\t<RichLoc\n\t\t\t\t\tv-else\n\t\t\t\t\tclass=\"tasks-task-deadline-settings-content --count\"\n\t\t\t\t\t:text=\"loc('TASKS_V2_TASK_SETTINGS_POPUP_DEADLINE_NOT_GREATER_THAN')\"\n\t\t\t\t\tplaceholder=\"[count/]\"\n\t\t\t\t>\n\t\t\t\t\t<template #count>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\tmin=\"1\"\n\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\tv-model.trim=\"localMaxDeadlineChanges\"\n\t\t\t\t\t\t\t\tdata-id=\"tasks-task-deadline-settings-max-changes\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</RichLoc>\n\t\t\t</TaskSetting>\n\t\t</div>\n\t`,\n};\n","import { DurationFormat } from 'main.date';\n\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Core } from 'tasks.v2.core';\nimport { Model } from 'tasks.v2.const';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { TaskSetting } from './setting/task-setting';\nimport { TaskDeadlineDefaultSetting } from './setting/task-deadline-default-setting';\nimport { TaskDeadlineSettings } from './setting/task-deadline-settings';\n\nimport './task-settings.css';\n\n// @vue/component\nexport const TaskSettings = {\n\tname: 'TasksTaskSettings',\n\tcomponents: {\n\t\tTaskSetting,\n\t\tTaskDeadlineDefaultSetting,\n\t\tTaskDeadlineSettings,\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t\tisEdit: {},\n\t},\n\temits: [\n\t\t'updateFlags',\n\t\t'updateDeadlineUserOption',\n\t\t'freeze',\n\t\t'unfreeze',\n\t],\n\tsetup(): { task: TaskModel } {},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tlocalFlags: {\n\t\t\t\tneedsControl: false,\n\t\t\t\tmatchesWorkTime: false,\n\t\t\t},\n\t\t\tlocalDeadlineUserOption: {\n\t\t\t\tdefaultDeadlineInSeconds: 0,\n\t\t\t\tcanChangeDeadline: false,\n\t\t\t\tmaxDeadlineChangeDate: null,\n\t\t\t\tmaxDeadlineChanges: null,\n\t\t\t},\n\t\t\tlocalAutocompleteSubTasks: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tstateFlags: `${Model.Interface}/stateFlags`,\n\t\t\tdeadlineUserOption: `${Model.Interface}/deadlineUserOption`,\n\t\t}),\n\t\tisDefaultDeadlineActive: {\n\t\t\tget(): boolean\n\t\t\t{\n\t\t\t\treturn this.localDeadlineUserOption.defaultDeadlineInSeconds > 0;\n\t\t\t},\n\t\t\tset(value: boolean): void\n\t\t\t{\n\t\t\t\tthis.localDeadlineUserOption.defaultDeadlineInSeconds = value ? this.defaultDeadlineSeconds : 0;\n\t\t\t\tthis.emitDeadlineUserOptionUpdate({\n\t\t\t\t\tdefaultDeadlineInSeconds: this.localDeadlineUserOption.defaultDeadlineInSeconds,\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\t\tdefaultDeadlineSeconds: {\n\t\t\tget(): number\n\t\t\t{\n\t\t\t\tif (!this.localDeadlineUserOption.defaultDeadlineInSeconds)\n\t\t\t\t{\n\t\t\t\t\tconst unitDurations = DurationFormat.getUnitDurations();\n\n\t\t\t\t\treturn unitDurations.d * 5 / 1000;\n\t\t\t\t}\n\n\t\t\t\treturn this.localDeadlineUserOption.defaultDeadlineInSeconds;\n\t\t\t},\n\t\t\tset(value: number): void\n\t\t\t{\n\t\t\t\tthis.localDeadlineUserOption.defaultDeadlineInSeconds = value;\n\n\t\t\t\tthis.emitDeadlineUserOptionUpdate({\n\t\t\t\t\tdefaultDeadlineInSeconds: this.localDeadlineUserOption.defaultDeadlineInSeconds,\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\t\tautocompleteSubTasks: {\n\t\t\tget(): boolean\n\t\t\t{\n\t\t\t\treturn this.localAutocompleteSubTasks === true;\n\t\t\t},\n\t\t\tset(value: boolean): void\n\t\t\t{\n\t\t\t\tthis.localAutocompleteSubTasks = value;\n\n\t\t\t\tthis.emitFlagsUpdate({ autocompleteSubTasks: value });\n\t\t\t},\n\t\t},\n\t\ttaskControl: {\n\t\t\tget(): boolean\n\t\t\t{\n\t\t\t\treturn this.localFlags.needsControl === true;\n\t\t\t},\n\t\t\tset(value: boolean): void\n\t\t\t{\n\t\t\t\tthis.localFlags.needsControl = value;\n\t\t\t\tthis.emitFlagsUpdate({ needsControl: value });\n\t\t\t},\n\t\t},\n\t\tcanChangeDeadline: {\n\t\t\tget(): boolean\n\t\t\t{\n\t\t\t\treturn this.localDeadlineUserOption.canChangeDeadline === true;\n\t\t\t},\n\t\t\tset(value: boolean): void\n\t\t\t{\n\t\t\t\tthis.localDeadlineUserOption.canChangeDeadline = value;\n\t\t\t\tif (!value)\n\t\t\t\t{\n\t\t\t\t\tthis.localDeadlineUserOption.maxDeadlineChangeDate = null;\n\t\t\t\t\tthis.localDeadlineUserOption.maxDeadlineChanges = null;\n\t\t\t\t}\n\n\t\t\t\tthis.emitDeadlineUserOptionUpdate({\n\t\t\t\t\tallowsChangeDeadline: value,\n\t\t\t\t\tcanChangeDeadline: value,\n\t\t\t\t\tmaxDeadlineChangeDate: null,\n\t\t\t\t\tmaxDeadlineChanges: null,\n\t\t\t\t});\n\t\t\t},\n\t\t},\n\t\tmatchesWorkTime: {\n\t\t\tget(): boolean\n\t\t\t{\n\t\t\t\treturn this.localFlags.matchesWorkTime === true;\n\t\t\t},\n\t\t\tset(value: boolean): void\n\t\t\t{\n\t\t\t\tthis.localFlags.matchesWorkTime = value;\n\t\t\t\tthis.emitFlagsUpdate({ matchesWorkTime: value });\n\t\t\t},\n\t\t},\n\t\tisMatchesWorkTimeLocked(): boolean\n\t\t{\n\t\t\treturn !Core.getParams().restrictions.skipWeekends.available;\n\t\t},\n\t\tmatchesWorkTimeFeatureId(): string\n\t\t{\n\t\t\treturn Core.getParams().restrictions.skipWeekends.featureId;\n\t\t},\n\t\tisTaskControlLocked(): boolean\n\t\t{\n\t\t\treturn !Core.getParams().restrictions.control.available;\n\t\t},\n\t\ttaskControlFeatureId(): string\n\t\t{\n\t\t\treturn Core.getParams().restrictions.control.featureId;\n\t\t},\n\t\tisAutocompleteSubTasksLocked(): boolean\n\t\t{\n\t\t\treturn !Core.getParams().restrictions.relatedSubtaskDeadlines.available;\n\t\t},\n\t\tautocompleteSubTasksFeatureId(): string\n\t\t{\n\t\t\treturn Core.getParams().restrictions.relatedSubtaskDeadlines.featureId;\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.localDeadlineUserOption.defaultDeadlineInSeconds = this.deadlineUserOption.defaultDeadlineInSeconds;\n\n\t\tif (this.isEdit)\n\t\t{\n\t\t\tthis.localFlags.needsControl = this.isTaskControlLocked ? false : this.task.needsControl;\n\t\t\tthis.localFlags.matchesWorkTime = this.isMatchesWorkTimeLocked ? false : this.task.matchesWorkTime;\n\n\t\t\tthis.localDeadlineUserOption.canChangeDeadline = this.task.allowsChangeDeadline;\n\t\t\tthis.localDeadlineUserOption.maxDeadlineChangeDate = this.task.maxDeadlineChangeDate;\n\t\t\tthis.localDeadlineUserOption.maxDeadlineChanges = this.task.maxDeadlineChanges;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.localFlags.needsControl = this.stateFlags.needsControl;\n\t\t\tthis.localFlags.matchesWorkTime = this.stateFlags.matchesWorkTime;\n\n\t\t\tthis.localDeadlineUserOption.canChangeDeadline = this.deadlineUserOption.canChangeDeadline;\n\t\t\tthis.localDeadlineUserOption.maxDeadlineChangeDate = this.deadlineUserOption.maxDeadlineChangeDate;\n\t\t\tthis.localDeadlineUserOption.maxDeadlineChanges = this.deadlineUserOption.maxDeadlineChanges;\n\t\t}\n\n\t\tthis.localAutocompleteSubTasks = this.task.autocompleteSubTasks;\n\t},\n\tmethods: {\n\t\temitFlagsUpdate(updatedData: Object): void\n\t\t{\n\t\t\tthis.$emit('updateFlags', updatedData);\n\t\t},\n\t\temitDeadlineUserOptionUpdate(updatedData: Object): void\n\t\t{\n\t\t\tthis.$emit('updateDeadlineUserOption', updatedData);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-task-settings\">\n\t\t\t<TaskSetting\n\t\t\t\tv-model=\"taskControl\"\n\t\t\t\t:label=\"loc('TASKS_V2_TASK_SETTINGS_POPUP_CONTROL_LABEL')\"\n\t\t\t\t:questionMarkHint=\"loc('TASKS_V2_TASK_SETTINGS_POPUP_CONTROL_HINT')\"\n\t\t\t\t:lock=\"isTaskControlLocked\"\n\t\t\t\t:featureId=\"taskControlFeatureId\"\n\t\t\t/>\n\t\t\t<TaskSetting\n\t\t\t\tv-model=\"isDefaultDeadlineActive\"\n\t\t\t\t:label=\"loc('TASKS_V2_TASK_SETTINGS_POPUP_DEADLINE_LABEL')\"\n\t\t\t>\n\t\t\t\t<TaskDeadlineDefaultSetting\n\t\t\t\t\tv-if=\"isDefaultDeadlineActive\"\n\t\t\t\t\tv-model=\"defaultDeadlineSeconds\"\n\t\t\t\t\t@updateDeadlineUserOption=\"(data) => $emit('updateDeadlineUserOption', data)\"\n\t\t\t\t/>\n\t\t\t</TaskSetting>\n\t\t\t<TaskSetting\n\t\t\t\tv-model=\"canChangeDeadline\"\n\t\t\t\t:label=\"loc('TASKS_V2_TASK_SETTINGS_POPUP_DEADLINES_LABEL')\"\n\t\t\t>\n\t\t\t\t<TaskDeadlineSettings\n\t\t\t\t\tv-if=\"canChangeDeadline\"\n\t\t\t\t\t@updateDeadlineUserOption=\"(data) => $emit('updateDeadlineUserOption', data)\"\n\t\t\t\t\t@freeze=\"$emit('freeze')\"\n\t\t\t\t\t@unfreeze=\"$emit('unfreeze')\"\n\t\t\t\t/>\n\t\t\t</TaskSetting>\n\t\t\t<TaskSetting\n\t\t\t\tv-model=\"matchesWorkTime\"\n\t\t\t\t:label=\"loc('TASKS_V2_TASK_SETTINGS_POPUP_WORK_TIME_LABEL')\"\n\t\t\t\t:questionMarkHint=\"loc('TASKS_V2_TASK_SETTINGS_POPUP_WORK_TIME_HINT')\"\n\t\t\t\t:lock=\"isMatchesWorkTimeLocked\"\n\t\t\t\t:featureId=\"matchesWorkTimeFeatureId\"\n\t\t\t/>\n\t\t\t<TaskSetting\n\t\t\t\tv-model=\"autocompleteSubTasks\"\n\t\t\t\t:label=\"loc('TASKS_V2_TASK_SETTINGS_POPUP_AUTO_COMPLETE_SUBTASKS_LABEL')\"\n\t\t\t\t:lock=\"isAutocompleteSubTasksLocked\"\n\t\t\t\t:featureId=\"autocompleteSubTasksFeatureId\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport type { PopupOptions } from 'main.popup';\n\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { AirButtonStyle, Button as UiButton, ButtonSize } from 'ui.vue3.components.button';\nimport { Popup } from 'ui.vue3.components.popup';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport { Model } from 'tasks.v2.const';\nimport { QuestionMark } from 'tasks.v2.component.elements.question-mark';\nimport { deadlineService } from 'tasks.v2.provider.service.deadline-service';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { stateService } from 'tasks.v2.provider.service.state-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { TaskSettings } from './component/task-settings';\n\nimport './task-settings-popup.css';\n\n// @vue/component\nexport const TaskSettingsPopup = {\n\tname: 'TaskSettingsPopup',\n\tcomponents: {\n\t\tBIcon,\n\t\tUiButton,\n\t\tQuestionMark,\n\t\tPopup,\n\t\tTaskSettings,\n\t},\n\tinject: {\n\t\ttask: {},\n\t\ttaskId: {},\n\t\tisEdit: {},\n\t},\n\tprops: {\n\t\tbindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\temits: ['close'],\n\tsetup(): { task: TaskModel }\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t\tButtonSize,\n\t\t\tOutline,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tpendingFlagsData: {},\n\t\t\tpendingDeadlineUserOption: {},\n\t\t\tsaving: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tstateFlags: `${Model.Interface}/stateFlags`,\n\t\t\tdeadlineUserOption: `${Model.Interface}/deadlineUserOption`,\n\t\t}),\n\t\toptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: `tasks-settings-popup-${this.taskId}`,\n\t\t\t\tclassName: 'tasks-task-settings-popup',\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\twidth: 530,\n\t\t\t\ttargetContainer: document.body,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClose(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tasync handleSave(): void\n\t\t{\n\t\t\tthis.saving = true;\n\n\t\t\tconst isMaxDeadlineChangesChanged = (\n\t\t\t\tthis.pendingDeadlineUserOption.maxDeadlineChanges\n\t\t\t\t&& this.task.maxDeadlineChanges !== this.pendingDeadlineUserOption.maxDeadlineChanges\n\t\t\t);\n\t\t\tif (this.isEdit && isMaxDeadlineChangesChanged)\n\t\t\t{\n\t\t\t\tvoid deadlineService.cleanChangeLog(this.task.id);\n\t\t\t}\n\n\t\t\tif (this.isEdit)\n\t\t\t{\n\t\t\t\tif (!Type.isNil(this.pendingDeadlineUserOption.defaultDeadlineInSeconds))\n\t\t\t\t{\n\t\t\t\t\tawait this.$store.dispatch(\n\t\t\t\t\t\t`${Model.Interface}/updateDeadlineUserOption`,\n\t\t\t\t\t\t{ defaultDeadlineInSeconds: this.pendingDeadlineUserOption.defaultDeadlineInSeconds },\n\t\t\t\t\t);\n\n\t\t\t\t\tvoid stateService.set({\n\t\t\t\t\t\tdefaultDeadline: this.deadlineUserOption,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tawait this.$store.dispatch(\n\t\t\t\t\t`${Model.Interface}/updateStateFlags`,\n\t\t\t\t\tthis.pendingFlagsData,\n\t\t\t\t);\n\t\t\t\tawait this.$store.dispatch(\n\t\t\t\t\t`${Model.Interface}/updateDeadlineUserOption`,\n\t\t\t\t\tthis.pendingDeadlineUserOption,\n\t\t\t\t);\n\n\t\t\t\tvoid stateService.set({\n\t\t\t\t\tneedsControl: this.stateFlags.needsControl,\n\t\t\t\t\tmatchesWorkTime: this.stateFlags.matchesWorkTime,\n\t\t\t\t\tdefaultRequireResult: this.stateFlags.defaultRequireResult,\n\t\t\t\t\tdefaultDeadline: this.deadlineUserOption,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tawait taskService.update(this.taskId, {\n\t\t\t\t...this.pendingFlagsData,\n\t\t\t\t...this.pendingDeadlineUserOption,\n\t\t\t});\n\n\t\t\tthis.$emit('close');\n\n\t\t\tthis.saving = false;\n\t\t},\n\t\thandleFlagsUpdate(updatedData: Object): void\n\t\t{\n\t\t\tthis.pendingFlagsData = {\n\t\t\t\t...this.pendingFlagsData,\n\t\t\t\t...updatedData,\n\t\t\t};\n\t\t},\n\t\thandleDeadlineUserOptionUpdate(updatedData: Object): void\n\t\t{\n\t\t\tthis.pendingDeadlineUserOption = {\n\t\t\t\t...this.pendingDeadlineUserOption,\n\t\t\t\t...updatedData,\n\t\t\t};\n\t\t},\n\t\tfreeze(): void\n\t\t{\n\t\t\tthis.$refs.popup?.freeze();\n\t\t},\n\t\tunfreeze(): void\n\t\t{\n\t\t\tthis.$refs.popup?.unfreeze();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Popup ref=\"popup\" :options @close=\"handleClose\">\n\t\t\t<div class=\"tasks-task-settings-popup-header\">\n\t\t\t\t<div class=\"tasks-task-settings-popup-title-container\">\n\t\t\t\t\t<div class=\"tasks-task-settings-popup-title\">\n\t\t\t\t\t\t{{ loc('TASKS_V2_TASK_SETTINGS_POPUP_TITLE') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<QuestionMark :hintText=\"loc('TASKS_V2_TASK_SETTINGS_POPUP_TITLE_HINT')\"/>\n\t\t\t\t</div>\n\t\t\t\t<BIcon\n\t\t\t\t\t:name=\"Outline.CROSS_L\"\n\t\t\t\t\thoverable\n\t\t\t\t\tclass=\"tasks-task-settings-popup-close-icon\"\n\t\t\t\t\t@click=\"handleClose\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-task-settings-popup-content\">\n\t\t\t\t<TaskSettings\n\t\t\t\t\t@updateFlags=\"handleFlagsUpdate\"\n\t\t\t\t\t@updateDeadlineUserOption=\"handleDeadlineUserOptionUpdate\"\n\t\t\t\t\t@freeze=\"freeze\"\n\t\t\t\t\t@unfreeze=\"unfreeze\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-task-settings-popup-footer\">\n\t\t\t\t<UiButton\n\t\t\t\t\t:text=\"loc('TASKS_V2_TASK_SETTINGS_POPUP_BTN_CANCEL')\"\n\t\t\t\t\t:size=\"ButtonSize.MEDIUM\"\n\t\t\t\t\t:style=\"AirButtonStyle.PLAIN\"\n\t\t\t\t\t:dataset=\"{\n\t\t\t\t\t\ttaskSettingsButtonId: 'cancel',\n\t\t\t\t\t}\"\n\t\t\t\t\t@click=\"handleClose\"\n\t\t\t\t/>\n\t\t\t\t<UiButton\n\t\t\t\t\t:text=\"loc('TASKS_V2_TASK_SETTINGS_POPUP_BTN_SAVE')\"\n\t\t\t\t\t:size=\"ButtonSize.MEDIUM\"\n\t\t\t\t\t:style=\"AirButtonStyle.FILLED\"\n\t\t\t\t\t:dataset=\"{\n\t\t\t\t\t\ttaskSettingsButtonId: 'save',\n\t\t\t\t\t}\"\n\t\t\t\t\t:loading=\"saving\"\n\t\t\t\t\t@click=\"handleSave\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n"],"names":["TaskSetting","name","components","Switcher","TextSm","QuestionMark","BIcon","props","modelValue","type","Boolean","required","label","String","default","questionMarkHint","lock","featureId","emits","setup","Outline","computed","switcherOptions","size","SwitcherSize","small","useAirDesign","hasLabelSlot","$slots","methods","handleContainerClick","handleLockClick","$emit","showLimit","template","TaskDeadlineDefaultSetting","Number","data","periodOptions","value","DurationUnit","Hours","loc","Days","Weeks","Months","selectedPeriod","localValue","watch","immediate","handler","newValue","bestPeriod","findBestPeriod","period","periodInSeconds","getPeriodInSeconds","valueInPeriod","formatValue","handleBlur","updateModelValue","seconds","periods","duration","sort","a","b","isInteger","days","Math","floor","toString","toFixed","replace","updateSelectedPeriod","event","target","isNaN","parseFloat","numericValue","emitDeadlineUserOptionUpdate","round","unitDurations","DurationFormat","getUnitDurations","H","d","isExactDeadlineTime","limitType","Object","freeze","date","count","TaskDeadlineSettings","BInput","RichLoc","inject","task","taskId","isEdit","InputDesign","limitDeadline","isCalendarShown","localDeadlineUserOption","requireDeadlineChangeReason","maxDeadlineChangeDate","formatDate","getDefaultDate","maxDeadlineChanges","mapGetters","deadlineUserOption","Model","Interface","get","set","localMaxDeadlineChangeDate","DateTimeFormat","parse","localMaxDeadlineChanges","limitByDate","limitByCount","datePicker","show","hide","created","switchToDateLimit","switchToCountLimit","unmounted","destroy","createDatePicker","selectedDateTs","getTime","DatePicker","popupOptions","id","Text","getRandom","bindElement","$refs","calendarInput","$el","offsetTop","bindOptions","forceBindPosition","forceTop","position","selectedDates","enableTime","events","DatePickerEvent","SELECT","getData","calendar","createDateFromUtc","toggleLimit","$nextTick","now","Date","getFullYear","getMonth","getDate","format","getFormat","TaskSettings","localFlags","needsControl","matchesWorkTime","defaultDeadlineInSeconds","canChangeDeadline","localAutocompleteSubTasks","stateFlags","isDefaultDeadlineActive","defaultDeadlineSeconds","autocompleteSubTasks","emitFlagsUpdate","taskControl","allowsChangeDeadline","isMatchesWorkTimeLocked","Core","getParams","restrictions","skipWeekends","available","matchesWorkTimeFeatureId","isTaskControlLocked","control","taskControlFeatureId","isAutocompleteSubTasksLocked","relatedSubtaskDeadlines","autocompleteSubTasksFeatureId","updatedData","TaskSettingsPopup","UiButton","Popup","HTMLElement","AirButtonStyle","ButtonSize","pendingFlagsData","pendingDeadlineUserOption","saving","options","className","width","targetContainer","document","body","handleClose","handleSave","isMaxDeadlineChangesChanged","deadlineService","cleanChangeLog","Type","isNil","$store","dispatch","stateService","defaultDeadline","defaultRequireResult","taskService","update","handleFlagsUpdate","handleDeadlineUserOptionUpdate","popup","unfreeze"],"mappings":"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"}