this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};this.BX.Tasks.V2=this.BX.Tasks.V2||{};(function(t,s,a,e,n){"use strict";let o=t=>t,l;const r=s.Extension.getSettings("tasks.v2.application.task-card");const i=top.BX.Runtime.loadExtension;class c{static showCompactCard(t={}){var c;if(window!==top){void i("tasks.v2.application.task-card").then((s=>s.TaskCard.showCompactCard(t)));return}const p=n.idUtils.isTemplate((c=t.taskId)!=null?c:0)?r.hasMandatoryTemplateUserFields:r.hasMandatoryTaskUserFields;if(p&&r.formV2Enabled){this.showFullCard(t);return}const d=`tasks-compact-card-${t.taskId}`;if(a.PopupManager.getPopupById(d)){return}const u=s.Tag.render(l||(l=o`<div/>`));void e.renderSkeleton("/bitrix/js/tasks/v2/application/task-card/src/skeleton.html?v=1",u);let k=null;const h=new a.Popup({id:d,className:"tasks-compact-card-popup",width:580,minHeight:324,borderRadius:"16px",noAllPaddings:true,content:u,cacheable:false,events:{onAfterClose:()=>k.unmount()},overlay:{opacity:100,backgroundColor:"#0363",blur:"blur(2px)"}});void i("tasks.v2.application.task-compact-card").then((s=>{k=new s.TaskCompactCard(t);k.mount(h)}));h.show()}static showFullCard(t={}){var s;let a=null;const e={contentCallback:async s=>{const e=await i("tasks.v2.application.task-full-card");a=new e.TaskFullCard(t);return a.mount(s)},events:{onClose:t=>{var s;return(s=a)==null?void 0:s.onClose(t)},onCloseComplete:()=>{if(a){a.onCloseComplete()}else if(t.closeCompleteUrl){location.href=t.closeCompleteUrl}}}};BX.SidePanel.Instance.open((s=t.url)!=null?s:this.getUrl(t.taskId),e)}static getUrl(t,a){const e=String(t).split("template")[1];const n=Number(e)||e||t;const o=Number.isInteger(n);const l=(t!=null&&t.startsWith!=null&&t.startsWith("template")?r.templatePath:a?r.groupTaskPath:r.userTaskPath).replace("#user_id#",r.userId).replace("#group_id#",a).replace("#task_id#",o?n:0).replace("#template_id#",o?n:0).replace("#action#",o?"view":"edit");if(o){return l}return new s.Uri(l).setQueryParam("id",n).toString()}}t.TaskCard=c})(this.BX.Tasks.V2.Application=this.BX.Tasks.V2.Application||{},BX,BX.Main,BX.UI.System,BX.Tasks.V2.Lib);
//# sourceMappingURL=task-card.bundle.map.js