this.BX=this.BX||{};(function(e,t,s,a,r,i,n,o,l,c,u,p,d,h,b,v,g,m,P){"use strict";class L extends P.EventEmitter{constructor(e){super();this.cache=new m.Cache.MemoryCache;this.setOptions(e);this.setEventNamespace("BX.Intranet.AvatarWidget.Content")}setOptions(e){this.cache.set("options",e);return this}getOptions(){return this.cache.get("options",{})}getLayout(){throw new Error("Must be implemented in a child class")}getConfig(){return{html:this.getLayout(),minHeight:"50px",margin:"0 13px"}}}class _{static send(e){r.sendData({tool:_.TOOLS,category:_.CATEGORY,event:e})}static sendOpenProfile(){r.sendData({tool:_.TOOLS,category:_.CATEGORY_PROFILE,event:_.EVENT_PROFILE_VIEW,c_section:_.CATEGORY})}static sendOpenCommonSecurity(){r.sendData({tool:"settings",category:"common_security",event:"start_page",c_section:_.CATEGORY})}}_.TOOLS="intranet";_.CATEGORY="ava_menu";_.CATEGORY_PROFILE="user_profile";_.EVENT_OPEN_WIDGET="menu_open";_.EVENT_PROFILE_VIEW="profile_view";_.EVENT_CLICK_SALARY="click_salary";_.EVENT_CLICK_INSTALL_DESKTOP_APP="click_install_desktop_app";_.EVENT_CLICK_INSTALL_MOBILE_APP="click_install_mobile_app";_.EVENT_CLICK_FAST_MOBILE_AUTH="click_fast_mobile_auth";_.EVENT_CLICK_2FA_SETUP="click_2fa_setup";_.EVENT_CLICK_EXTENSION="click_extension";_.EVENT_CLICK_LOGOUT="click_logout";_.EVENT_CLICK_CHANGE_PORTAL_THEME="click_change_portal_theme";_.EVENT_CLICK_NETWORK="click_network";_.EVENT_CLICK_ACTIVITY_PORTAL_LIST="click_activity_portal_list";_.EVENT_CLICK_PULSE="click_open_pulse";_.EVENT_CLICK_MY_DOCUMENTS="click_open_my_documents";class f{constructor(e={}){this.cache=new m.Cache.MemoryCache;this.options=e}getLayout(){throw new Error("Must be implemented in a child class")}getIconClass(){throw new Error("Must be implemented in a child class")}onClick(){throw new Error("Must be implemented in a child class")}getIconElement(){throw new Error("Must be implemented in a child class")}getTitle(){return this.options.title||this.options.text||""}}let E=e=>e,y,C,w;var I=babelHelpers.classPrivateFieldLooseKey("getCounterWrapper");class B extends f{constructor(...e){super(...e);Object.defineProperty(this,I,{value:H})}getLayout(){return this.cache.remember("layout",(()=>m.Tag.render(y||(y=E`
				<div data-testid="bx-avatar-widget-main-tool-${0}" onclick="${0}" class="intranet-avatar-widget-main-tool__wrapper">
					<div class="intranet-avatar-widget-main-tool-icon__wrapper">
						${0}
						${0}
					</div>
					<div class="intranet-avatar-widget-main-tool__title">
						${0}
					</div>
				</div>
			`),this.getId(),this.onClick.bind(this),this.getIconElement(),babelHelpers.classPrivateFieldLooseBase(this,I)[I](),this.getTitle())))}getIconElement(){return this.cache.remember("icon",(()=>m.Tag.render(C||(C=E`<i class="ui-icon-set ${0} intranet-avatar-widget-main-tool__icon"/>`),this.getIconClass())))}getCounter(){return null}getId(){return""}}function H(){return this.cache.remember("counterWrapper",(()=>{const e=this.getCounter();return m.Tag.render(w||(w=E`
				<div class="intranet-avatar-widget-main-tool__counter-wrapper">
					${0}
				</div>
			`),e==null?void 0:e.render())}))}var O=babelHelpers.classPrivateFieldLooseKey("getMenu");class F extends B{constructor(...e){super(...e);Object.defineProperty(this,O,{value:T})}getIconClass(){return"--o-box"}onClick(){_.send(_.EVENT_CLICK_EXTENSION);babelHelpers.classPrivateFieldLooseBase(this,O)[O]().toggle()}getId(){return"extension"}}function T(){return this.cache.remember("menu",(()=>{const e=new d.Menu({bindElement:this.getIconElement(),items:this.options.items,angle:true,cachable:false,offsetLeft:10,fixed:true});P.EventEmitter.subscribe("SidePanel.Slider:onOpenStart",(()=>{e.close()}));return e}))}class A extends B{getIconClass(){return"--o-shield-checked"}onClick(){_.send(_.EVENT_CLICK_2FA_SETUP);g.SidePanel.Instance.open(this.options.url,{width:1100})}getCounter(){return this.cache.remember("counter",(()=>{if(!this.options.hasCounter){return null}o.PULL.subscribe({moduleId:"intranet",command:this.options.counterEventName,callback:()=>{this.getCounter().destroy();const e=this.getLayout().querySelector(".intranet-avatar-widget-item__icon");m.Dom.removeClass(e,"--active");this.cache.delete("counter")}});return new u.Counter({color:u.Counter.Color.DANGER,size:u.Counter.Size.MEDIUM,value:1,style:u.CounterStyle.FILLED_ALERT,useAirDesign:true})}))}getId(){return"security"}}class k extends B{getIconClass(){return"--o-file"}onClick(){_.send(_.EVENT_CLICK_MY_DOCUMENTS);if(this.options.isLocked){i.FeaturePromotersRegistry.getPromoter({code:"limit_office_e_signature"}).show();return}const e=Number(m.Loc.getMessage("USER_ID"));if(e>0){n.Router.openSlider(`${m.Loc.getMessage("SITE_DIR")}company/personal/user/${e}/sign?noRedirect=Y`,{width:1e3,cacheable:false})}}getCounter(){return this.cache.remember("counter",(()=>{if(Number(this.options.counter)<1){return null}o.PULL.subscribe({moduleId:"sign",command:this.options.counterEventName,callback:e=>{if(!m.Type.isNumber(e==null?void 0:e.needActionCount)){return}this.options.counter=e.needActionCount;if((e==null?void 0:e.needActionCount)>0){this.getCounter().update(e.needActionCount)}else{this.getCounter().destroy();const e=this.getLayout().querySelector(".intranet-avatar-widget-item__icon");m.Dom.removeClass(e,"--active");this.cache.delete("counter")}}});return new u.Counter({color:u.Counter.Color.DANGER,size:u.Counter.Size.MEDIUM,value:this.options.counter,style:u.CounterStyle.FILLED_ALERT,useAirDesign:true})}))}getId(){return"my-documents"}}var S=babelHelpers.classPrivateFieldLooseKey("getMenu");var K=babelHelpers.classPrivateFieldLooseKey("getHintInstance");class x extends B{constructor(...e){super(...e);Object.defineProperty(this,K,{value:X});Object.defineProperty(this,S,{value:N})}getIconClass(){return"--o-favorite"}getLayout(){const e=super.getLayout();if(babelHelpers.classPrivateFieldLooseBase(this,S)[S]().isHidden()){return null}if(babelHelpers.classPrivateFieldLooseBase(this,S)[S]().isDisabled()){m.Dom.attr(e,"data-hint","");m.Dom.attr(e,"data-hint-interactivity","");m.Event.bind(e,"mouseenter",(()=>{babelHelpers.classPrivateFieldLooseBase(this,K)[K]().show(e,this.options.disabledHint)}));m.Event.bind(e,"mouseleave",(()=>{babelHelpers.classPrivateFieldLooseBase(this,K)[K]().hide(e)}))}return super.getLayout()}onClick(){_.send(_.EVENT_CLICK_SALARY);if(!babelHelpers.classPrivateFieldLooseBase(this,S)[S]().isHidden()&&!babelHelpers.classPrivateFieldLooseBase(this,S)[S]().isDisabled()){babelHelpers.classPrivateFieldLooseBase(this,S)[S]().show(this.getLayout())}}getId(){return"salary-vacation"}}function N(){return this.cache.remember("salaryMenu",(()=>new l.SalaryVacationMenu))}function X(){return this.cache.remember("hint",(()=>BX.UI.Hint.createInstance({popupParameters:{fixed:true}})))}let M=e=>e,D,$,W,j,R,U,V,G;var Y=babelHelpers.classPrivateFieldLooseKey("activeOnclick");var z=babelHelpers.classPrivateFieldLooseKey("handleClickTaskStatus");var q=babelHelpers.classPrivateFieldLooseKey("getFullName");var Q=babelHelpers.classPrivateFieldLooseKey("getWorkPosition");var J=babelHelpers.classPrivateFieldLooseKey("getAvatar");var Z=babelHelpers.classPrivateFieldLooseKey("getStatus");var ee=babelHelpers.classPrivateFieldLooseKey("getWorkStatusBlock");var te=babelHelpers.classPrivateFieldLooseKey("getWorkStatusControlPanel");var se=babelHelpers.classPrivateFieldLooseKey("getToolsContainer");var ae=babelHelpers.classPrivateFieldLooseKey("getTools");var re=babelHelpers.classPrivateFieldLooseKey("setEventHandlers");class ie extends L{constructor(...e){super(...e);Object.defineProperty(this,re,{value:ve});Object.defineProperty(this,ae,{value:be});Object.defineProperty(this,se,{value:he});Object.defineProperty(this,te,{value:de});Object.defineProperty(this,ee,{value:pe});Object.defineProperty(this,Z,{value:ue});Object.defineProperty(this,J,{value:ce});Object.defineProperty(this,Q,{value:le});Object.defineProperty(this,q,{value:oe});Object.defineProperty(this,z,{value:ne});Object.defineProperty(this,Y,{writable:true,value:true})}getConfig(){return{html:this.getLayout()}}getOptions(){return super.getOptions()}getLayout(){return this.cache.remember("layout",(()=>{babelHelpers.classPrivateFieldLooseBase(this,re)[re]();const e=()=>{if(babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]){BX.SidePanel.Instance.open(this.getOptions().url);_.sendOpenProfile()}};return m.Tag.render(D||(D=M`
				<div class="intranet-avatar-widget-item__wrapper" data-testid="bx-avatar-widget-content-main">
					<div onclick="${0}" class="intranet-avatar-widget-item-main__wrapper-head">
						<div class="intranet-avatar-widget-item__avatar">
							${0}
						</div>
						<div class="intranet-avatar-widget-item__info-wrapper">
							${0}
							${0}
						</div>
					</div>
					${0}
					${0}
					${0}
				</div>
			`),e,babelHelpers.classPrivateFieldLooseBase(this,J)[J]().getContainer(),babelHelpers.classPrivateFieldLooseBase(this,q)[q](),babelHelpers.classPrivateFieldLooseBase(this,Q)[Q](),babelHelpers.classPrivateFieldLooseBase(this,Z)[Z](),babelHelpers.classPrivateFieldLooseBase(this,ee)[ee](),babelHelpers.classPrivateFieldLooseBase(this,se)[se]())}))}}function ne(e){e.stopPropagation();e.preventDefault()}function oe(){return this.cache.remember("title",(()=>m.Tag.render($||($=M`
				<span class="intranet-avatar-widget-item__title">
					<span>${0}</span>
					<i class="ui-icon-set --chevron-right-s intranet-avatar-widget-item__chevron"/>
				</span>
			`),this.getOptions().fullName)))}function le(){return this.cache.remember("workPosition",(()=>{if(!this.getOptions().workPosition){return null}return m.Tag.render(W||(W=M`
				<span class="intranet-avatar-widget-item__description">${0}</span>
			`),this.getOptions().workPosition)}))}function ce(){return this.cache.remember("avatar",(()=>{const e={size:48,userpicPath:encodeURI(this.getOptions().userPhotoSrc)};let t=null;if(this.getOptions().role==="extranet"){t=new s.AvatarRoundExtranet(e)}else if(this.getOptions().role==="collaber"){t=new s.AvatarRoundGuest(e)}else{t=new s.AvatarRound(e)}return t}))}function ue(){return this.cache.remember("status",(()=>{if(!this.getOptions().status&&!this.getOptions().vacation){return null}const e=m.Tag.render(j||(j=M`
				<div class="intranet-avatar-widget-main__status-wrapper"></div>
			`));if(this.getOptions().vacation){m.Dom.append(m.Tag.render(R||(R=M`
					<span class="intranet-avatar-widget-main__status --vacation">
						${0}
					</span>
				`),this.getOptions().vacation),e)}if(this.getOptions().status){const t=m.Tag.render(U||(U=M`
					<span class="intranet-avatar-widget-main__status">
						${0}
					</span>
				`),this.getOptions().status);if(this.getOptions().role==="collaber"){m.Dom.addClass(t,"--collaber")}else if(this.getOptions().role==="extranet"){m.Dom.addClass(t,"--extranet")}m.Dom.append(t,e)}return e}))}function pe(){return this.cache.remember("worktime",(()=>{if(!this.getOptions().isTimemanAvailable){return null}if(!babelHelpers.classPrivateFieldLooseBase(this,te)[te]()){return null}return m.Tag.render(V||(V=M`
				<div
					class="intranet-avatar-widget-item__task-status task-status"
					onclick="${0}"
				>
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,z)[z],babelHelpers.classPrivateFieldLooseBase(this,te)[te]())}))}function de(){return this.cache.remember("taskStatusActions",(()=>{try{return(new a.WorkStatusControlPanel).renderWorkStatusControlPanel()}catch(e){console.error(e);return null}}))}function he(){return this.cache.remember("tools-container",(()=>{if(!this.getOptions().tools||Object.keys(this.getOptions().tools).length===0){return null}const e=m.Tag.render(G||(G=M`
				<div class="intranet-avatar-widget-main-tools__wrapper"></div>
			`));const t=babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]();m.Dom.style(e,"grid-template-columns",`repeat(${t.length}, 1fr)`);t.forEach((t=>{m.Dom.append(t.getLayout(),e)}));return e}))}function be(){return this.cache.remember("tools",(()=>{const e=this.getOptions().tools;return[e.myDocuments?new k(e.myDocuments):null,e.salaryVacation?new x(e.salaryVacation):null,e.security?new A(e.security):null,e.extension?new F(e.extension):null].filter(Boolean)}))}function ve(){P.EventEmitter.subscribe("BX.Intranet.UserProfile:Avatar:changed",(({data:[{url:e,userId:t}]})=>{if(this.getOptions().id>0&&t&&this.getOptions().id.toString()===t.toString()){const t=encodeURI(e);this.getOptions().userPhotoSrc=t;babelHelpers.classPrivateFieldLooseBase(this,J)[J]().setUserPic(t)}}));P.EventEmitter.subscribe("BX.Intranet.UserProfile:Name:changed",(({data:[{fullName:e}]})=>{this.getOptions().fullName=e;babelHelpers.classPrivateFieldLooseBase(this,q)[q]().querySelector("span").innerHTML=e}));P.EventEmitter.subscribe("BX.Intranet.AvatarWidget.Popup:enabledAutoHide",(()=>{babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]=true}));P.EventEmitter.subscribe("BX.Intranet.AvatarWidget.Popup:disabledAutoHide",(()=>{babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]=false}))}let ge=e=>e,me;class Pe{constructor(e={}){this.cache=new m.Cache.MemoryCache;this.options=e}getLayout(){return m.Tag.render(me||(me=ge`
			<div data-testid="bx-avatar-widget-footer-tool-${0}" onclick="${0}" class="intranet-avatar-widget-footer__item">
				${0}
			</div>
		`),this.getId(),this.onClick.bind(this),this.getTitle())}onClick(){throw new Error("Must be implemented in a child class")}getTitle(){return this.options.title||this.options.text||""}getId(){return""}}class Le extends Pe{onClick(){_.send(_.EVENT_CLICK_CHANGE_PORTAL_THEME);P.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:openChild");BX.Intranet.Bitrix24.ThemePicker.Singleton.showDialog(false)}getId(){return"theme"}}class _e extends Pe{onClick(){_.send(_.EVENT_CLICK_PULSE);m.ajax.runAction("intranet.user.widget.getUserStatComponent",{mode:"class"}).then((e=>{m.Runtime.html(null,e.data.html).then((()=>{if(window.openIntranetUStat){P.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:openChild");openIntranetUStat()}})).catch((()=>{}))})).catch((()=>{}))}getId(){return"pulse"}}class fe extends Pe{onClick(){_.send(_.EVENT_CLICK_LOGOUT);if(!m.Type.isNil(c.DesktopApi)&&c.DesktopApi.isDesktop()){c.DesktopApi.logout()}else{const e=new m.Uri(window.location.pathname);e.removeQueryParam(this.options.removeQueryParam);const t=new m.Uri(this.options.path);t.setQueryParam("sessid",BX.bitrix_sessid());t.setQueryParam("backurl",encodeURIComponent(e.toString()));document.location.href=t}}getId(){return"logout"}}let Ee=e=>e,ye;var Ce=babelHelpers.classPrivateFieldLooseKey("getTools");class we extends L{constructor(...e){super(...e);Object.defineProperty(this,Ce,{value:Ie})}getConfig(){return{html:this.getLayout(),withoutBackground:true,margin:"0 0 16px 0"}}getLayout(){return this.cache.remember("layout",(()=>{const e=m.Tag.render(ye||(ye=Ee`
				<div data-testid="bx-avatar-widget-content-footer" class="intranet-avatar-widget-footer__wrapper"/>
			`));const t=babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]();t.forEach((t=>{m.Dom.append(t.getLayout(),e)}));return e}))}}function Ie(){return this.cache.remember("tools",(()=>{const e=this.getOptions().tools;return[e.theme?new Le(e.theme):null,e.pulse?new _e(e.pulse):null,e.logout?new fe(e.logout):null].filter(Boolean)}))}let Be=e=>e,He,Oe,Fe,Te;var Ae=babelHelpers.classPrivateFieldLooseKey("getCounterWrapper");class ke extends f{constructor(...e){super(...e);Object.defineProperty(this,Ae,{value:Se})}getLayout(){return this.cache.remember("layout",(()=>m.Tag.render(He||(He=Be`
				<div data-testid="bx-avatar-widget-tool-${0}" onclick="${0}" class="intranet-avatar-widget-secondary-tool__wrapper">
					${0}
					<div class="intranet-avatar-widget-item__info-wrapper">
						<span class="intranet-avatar-widget-item__title">
							${0}
						</span>
					</div>
					${0}
					${0}
				</div>
			`),this.getId(),this.onClick.bind(this),this.getIconElement(),this.getTitle(),babelHelpers.classPrivateFieldLooseBase(this,Ae)[Ae](),this.getActionElement())))}getIconElement(){return this.cache.remember("icon",(()=>m.Tag.render(Oe||(Oe=Be`<i class="ui-icon-set ${0} intranet-avatar-widget-secondary-tool__icon"/>`),this.getIconClass())))}getActionElement(){return this.cache.remember("actionElement",(()=>m.Tag.render(Fe||(Fe=Be`<i class="ui-icon-set --chevron-right-m intranet-avatar-widget-item__chevron"/>`))))}getCounter(){return null}getId(){return""}}function Se(){return this.cache.remember("counterWrapper",(()=>{const e=this.getCounter();return m.Tag.render(Te||(Te=Be`
				<div class="intranet-avatar-widget-item__counter">
					${0}
				</div>
			`),e==null?void 0:e.render())}))}class Ke extends ke{getIconClass(){return"--o-structure-vertical"}onClick(){if(this.options.type==="desktop"){_.send(_.EVENT_CLICK_ACTIVITY_PORTAL_LIST);P.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:openChild");new p.DesktopAccountList({bindElement:document.querySelector('[data-id="bx-avatar-widget"]')}).show()}else if(this.options.type==="network"){_.send(_.EVENT_CLICK_NETWORK);window.open(this.options.path,"_blank")}}getId(){return"account-changer"}}class xe extends ke{getIconClass(){return"--o-filter-2-lines"}onClick(){window.open(this.options.path,"_blank")}getId(){return"administration"}}class Ne extends ke{getIconClass(){return"--o-achievement"}onClick(){const e=this.options.userId;BX.Runtime.loadExtension("performan.application.user-profile").then((()=>{new BX.Performan.Application.UserProfile({userId:e}).show()}))}getId(){return"performan-user-profile"}}class Xe extends ke{getIconClass(){return"--o-palette"}onClick(){_.send(_.EVENT_CLICK_CHANGE_PORTAL_THEME);P.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:openChild");BX.Intranet.Bitrix24.ThemePicker.Singleton.showDialog(false)}getId(){return"theme"}}let Me=e=>e,De;class $e extends L{getLayout(){return this.cache.remember("layout",(()=>{const e=m.Tag.render(De||(De=Me`
				<div data-testid="bx-avatar-widget-content-${0}" class="intranet-avatar-widget-item__wrapper"></div>
			`),this.getId());this.getTools().forEach((t=>{m.Dom.append(t.getLayout(),e)}));return e}))}getTools(){return this.cache.remember("tools",(()=>{const e=this.getOptions().tools;return[e.theme?new Xe(e.theme):null,e.accountChanger?new Ke(e.accountChanger):null,e.admin?new xe(e.admin):null,e.performanUserProfile?new Ne(e.performanUserProfile):null].filter(Boolean)}))}getId(){return"secondary"}}class We extends ke{getIconClass(){return"--o-mobile"}onClick(){_.send(_.EVENT_CLICK_INSTALL_MOBILE_APP);P.EventEmitter.emit("BX.Intranet.AvatarWidget.FastMobileAuthTool:onClick")}}class je extends ke{getIconClass(){return"--o-qr-code"}onClick(){_.send(_.EVENT_CLICK_FAST_MOBILE_AUTH);P.EventEmitter.emit("BX.Intranet.AvatarWidget.FastMobileAuthTool:onClick")}getId(){return"fast-mobile-auth"}}let Re=e=>e,Ue,Ve,Ge,Ye,ze;var qe=babelHelpers.classPrivateFieldLooseKey("getMobileIcon");var Qe=babelHelpers.classPrivateFieldLooseKey("getDesktopIcon");var Je=babelHelpers.classPrivateFieldLooseKey("getInstallMenu");var Ze=babelHelpers.classPrivateFieldLooseKey("getInstallMenuItems");class et extends ke{constructor(...e){super(...e);Object.defineProperty(this,Ze,{value:rt});Object.defineProperty(this,Je,{value:at});Object.defineProperty(this,Qe,{value:st});Object.defineProperty(this,qe,{value:tt})}getIconElement(){return this.cache.remember("icon",(()=>{if(this.options.mobile.installed){return m.Tag.render(Ue||(Ue=Re`
					<span class="intranet-avatar-widget-secondary-tool-icons__wrapper">
						${0}
						<div class="intranet-avatar-widget-secondary-tool-icons__seporator"></div>
						${0}
					</span>
				`),babelHelpers.classPrivateFieldLooseBase(this,qe)[qe](),babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe]())}return babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe]()}))}getActionElement(){return this.cache.remember("actionElement",(()=>{if(this.options.desktop.installed&&this.options.menu){const e=e=>{babelHelpers.classPrivateFieldLooseBase(this,Je)[Je](e.target).toggle()};return m.Tag.render(Ve||(Ve=Re`
					<i onclick="${0}" class="ui-icon-set --more-m intranet-avatar-widget-item__more"/>
				`),e)}const e=new h.DesktopDownload;const t=new v.Button({size:v.Button.Size.EXTRA_SMALL,text:this.options.desktop.buttonName,useAirDesign:true,style:v.AirButtonStyle.FILLED,noCaps:true,onclick:()=>{e.handleDownloadClick(t)},wide:true}).render();return m.Tag.render(Ge||(Ge=Re`
				<span class="intranet-avatar-widget-secondary-tool-application__button-wrapper">
					${0}
				</span>
			`),t)}))}onClick(){}getId(){return"applications-installer"}}function tt(){return this.cache.remember("mobileIcon",(()=>{let e="ui-icon-set --mobile-selected intranet-avatar-widget-secondary-tool-application__icon";if(this.options.mobile.installed){e+=" --installed"}return m.Tag.render(Ye||(Ye=Re`
				<i class="${0}"/>
			`),e)}))}function st(){return this.cache.remember("desktopIcon",(()=>{let e="ui-icon-set intranet-avatar-widget-secondary-tool-application__icon";if(this.options.desktop.installed){e+=" --screen-selected --installed"}else{e+=" --o-screen"}return m.Tag.render(ze||(ze=Re`
				<i class="${0}"/>
			`),e)}))}function at(e){return this.cache.remember("installMenu",(()=>{const t=babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze]();if(t.length===0){return null}return new d.Menu({bindElement:e,items:t,offsetLeft:5,angle:true,fixed:true})}))}function rt(){const e=[];this.options.menu.forEach((t=>{if(t.type==="desktop"){e.push({text:t.title,href:t.installLink,onclick:()=>{_.send(_.EVENT_CLICK_INSTALL_DESKTOP_APP);babelHelpers.classPrivateFieldLooseBase(this,Je)[Je]().close()}})}else if(t.type==="mobile"){e.push({text:t.title,onclick:()=>{_.send(_.EVENT_CLICK_INSTALL_MOBILE_APP);babelHelpers.classPrivateFieldLooseBase(this,Je)[Je]().close();P.EventEmitter.emit("BX.Intranet.AvatarWidget.ApplicationInstallerTool:onClick")}})}}));return e}let it=e=>e,nt;var ot=babelHelpers.classPrivateFieldLooseKey("getTools");class lt extends L{constructor(...e){super(...e);Object.defineProperty(this,ot,{value:ct})}getLayout(){return this.cache.remember("layout",(()=>{const e=m.Tag.render(nt||(nt=it`
				<div data-testid="bx-avatar-widget-content-application" class="intranet-avatar-widget-item__wrapper"></div>
			`));babelHelpers.classPrivateFieldLooseBase(this,ot)[ot]().forEach((t=>{m.Dom.append(t.getLayout(),e)}));return e}))}}function ct(){return this.cache.remember("tools",(()=>{const e=this.getOptions().tools;return[e.installMobile?new We(e.installMobile):null,e.fastMobileAuth?new je(e.fastMobileAuth):null,e.applicationsInstaller?new et(e.applicationsInstaller):null].filter(Boolean)}))}let ut=e=>e,pt;var dt=babelHelpers.classPrivateFieldLooseKey("getBackButton");class ht extends L{constructor(...e){super(...e);Object.defineProperty(this,dt,{value:bt})}getConfig(){return{html:this.getLayout()}}getLayout(){return this.cache.remember("layout",(()=>m.Tag.render(pt||(pt=ut`
				<div data-testid="bx-avatar-widget-content-${0}" class="intranet-avatar-widget-item__wrapper">
					<div class="intranet-avatar-widget-item-subsection__header">
						${0}
						<span class="intranet-avatar-widget-item-subsection__title">
							${0}
						</span>
					</div>
					${0}
				</div>
			`),this.getId(),babelHelpers.classPrivateFieldLooseBase(this,dt)[dt]().render(),this.getOptions().title,this.getContentWrapper())))}getId(){return""}}function bt(){return this.cache.remember("backButton",(()=>{const e=new v.Button({icon:"chevron-left-l",size:v.Button.Size.EXTRA_EXTRA_SMALL,style:v.AirButtonStyle.OUTLINE,useAirDesign:true,onclick:()=>{P.EventEmitter.emit("BX.Intranet.AvatarWidget.Subsection:back")}});e.setCollapsed(true);return e}))}let vt=e=>e,gt,mt;var Pt=babelHelpers.classPrivateFieldLooseKey("getQR");var Lt=babelHelpers.classPrivateFieldLooseKey("getWarning");class _t extends ht{constructor(...e){super(...e);Object.defineProperty(this,Lt,{value:Et});Object.defineProperty(this,Pt,{value:ft})}getContentWrapper(){return this.cache.remember("content",(()=>m.Tag.render(gt||(gt=vt`
				<div class="intranet-avatar-widget-fast-mobile-auth__wrapper">
					${0}
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,Pt)[Pt]().render(),babelHelpers.classPrivateFieldLooseBase(this,Lt)[Lt]())))}getId(){return"mobile-auth"}}function ft(){return this.cache.remember("qr",(()=>new b.ShortQrAuth({intent:"profile",small:false,stub:false})))}function Et(){return this.cache.remember("warning",(()=>m.Tag.render(mt||(mt=vt`
				<div class="intranet-avatar-widget-fast-mobile-auth-tool__warning">
					${0}
				</div>
			`),this.getOptions().warning)))}class yt extends ke{getIconClass(){return"--o-shield-checked"}onClick(){_.send(_.EVENT_CLICK_2FA_SETUP);g.SidePanel.Instance.open(this.options.url,{width:1100})}getId(){return"security"}}class Ct extends $e{getTools(){return this.cache.remember("tools",(()=>{const e=this.getOptions().tools;return[e.security?new yt(e.security):null,e.theme?new Xe(e.theme):null].filter(Boolean)}))}getId(){return"extranet-secondary"}}let wt=e=>e,It;var Bt=babelHelpers.classPrivateFieldLooseKey("annualSummaryPopup");class Ht extends L{constructor(...e){super(...e);Object.defineProperty(this,Bt,{writable:true,value:null})}getLayout(){return this.cache.remember("layout",(()=>m.Tag.render(It||(It=wt`
				<div
						data-testid="bx-avatar-widget-tool-${0}"
						onclick="${0}"
						class="intranet-avatar-widget-item__wrapper intranet-avatar-widget-annual-summary-tool__wrapper"
						>
						<div class="intranet-avatar-widget-annual-summary-tool__background"></div>
						<span class="intranet-avatar-widget-annual-summary-tool__title">
							${0}
						</span>
				</div>
			`),this.getId(),this.onClick.bind(this),this.getTitle())))}getTitle(){return this.getOptions().title}onClick(){if(babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt]){babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt].show();P.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:openChild");return}m.Dom.addClass(this.getLayout(),"intranet-avatar-widget-annual-summary-tool__wrapper--loading");Promise.all([m.ajax.runAction("intranet.v2.AnnualSummary.load",{}),m.Runtime.loadExtension("intranet.notify-banner.annual-summary")]).then((([e,{AnnualSummary:t}])=>{const{topFeatures:s,options:a}=e.data;m.Dom.removeClass(this.getLayout(),"intranet-avatar-widget-annual-summary-tool__wrapper--loading");P.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:openChild");babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt]=new t(s,{...a,section:"profile"});babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt].subscribe("onShow",(()=>BX.userOptions.save("intranet","annual_summary_25_last_show",null,Math.floor(Date.now()/1e3))));babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt].show()})).catch((e=>{console.error(e)}))}getId(){return"annual-summary"}}var Ot=babelHelpers.classPrivateFieldLooseKey("cache");var Ft=babelHelpers.classPrivateFieldLooseKey("popupsShowAfterBasePopup");var Tt=babelHelpers.classPrivateFieldLooseKey("getContent");var At=babelHelpers.classPrivateFieldLooseKey("getAnnualSummaryContent");var kt=babelHelpers.classPrivateFieldLooseKey("getMainContent");var St=babelHelpers.classPrivateFieldLooseKey("getSecondaryContent");var Kt=babelHelpers.classPrivateFieldLooseKey("getApplicationContent");var xt=babelHelpers.classPrivateFieldLooseKey("getFooterContent");var Nt=babelHelpers.classPrivateFieldLooseKey("getMobileAuthContent");var Xt=babelHelpers.classPrivateFieldLooseKey("getFastMobileAuthSubsection");var Mt=babelHelpers.classPrivateFieldLooseKey("getExtranetSecondaryContent");var Dt=babelHelpers.classPrivateFieldLooseKey("setAutoHideEventHandlers");var $t=babelHelpers.classPrivateFieldLooseKey("setSubsectionEventHandlers");class Wt extends P.EventEmitter{constructor(e){super();Object.defineProperty(this,$t,{value:Zt});Object.defineProperty(this,Dt,{value:Jt});Object.defineProperty(this,Mt,{value:Qt});Object.defineProperty(this,Xt,{value:qt});Object.defineProperty(this,Nt,{value:zt});Object.defineProperty(this,xt,{value:Yt});Object.defineProperty(this,Kt,{value:Gt});Object.defineProperty(this,St,{value:Vt});Object.defineProperty(this,kt,{value:Ut});Object.defineProperty(this,At,{value:Rt});Object.defineProperty(this,Tt,{value:jt});Object.defineProperty(this,Ot,{writable:true,value:new m.Cache.MemoryCache});Object.defineProperty(this,Ft,{writable:true,value:[]});this.setOptions(e);this.setEventNamespace("BX.Intranet.AvatarWidget.Popup");this.setEventHandlers()}setOptions(e){babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].set("options",e)}getOptions(){return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].get("options",{})}show(){this.getBasePopup().show();this.emit("show");_.send(_.EVENT_OPEN_WIDGET)}close(){this.getBasePopup().close()}getBasePopup(){return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].remember("popup",(()=>{this.emit("beforeInit");const e=new t.PopupComponentsMaker({target:this.getOptions().target,width:390,content:babelHelpers.classPrivateFieldLooseBase(this,Tt)[Tt](),popupLoader:this.getOptions().loader,padding:0,offsetTop:-50,offsetLeft:0});e.getPopup().setFixed(true);const s=()=>{if(BX.SidePanel.Instance.isOpen()){e.getPopup().setOverlay({backgroundColor:"transparent"});e.getPopup().showOverlay()}};s();e.getPopup().subscribe("onClose",(()=>{babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft]=[];e.getPopup().removeOverlay()}));e.getPopup().subscribe("onBeforeShow",s);babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].set("popup",e);babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].set("contentWrapper",e.getContentWrapper());this.emit("afterInit");return e}))}setEventHandlers(){this.subscribe("beforeInit",(()=>{P.EventEmitter.subscribe("BX.Intranet.AvatarWidget.Popup:makeWithHint",(()=>{this.subscribe("afterInit",(()=>{BX.UI.Hint.init(this.getBasePopup().getPopup().getPopupContainer())}))}));this.subscribe("afterInit",(()=>{babelHelpers.classPrivateFieldLooseBase(this,Dt)[Dt]();babelHelpers.classPrivateFieldLooseBase(this,$t)[$t]();const e=()=>{this.close()};P.EventEmitter.subscribe("SidePanel.Slider:onOpenStart",e);P.EventEmitter.subscribe("BX.Intranet.AvatarWidget.Popup:openChild",e)}))}))}}function jt(){return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].remember("content",(()=>{const e=[babelHelpers.classPrivateFieldLooseBase(this,kt)[kt]().getConfig()];if(this.getOptions().content.promo){e.push(babelHelpers.classPrivateFieldLooseBase(this,At)[At]().getConfig())}e.push(babelHelpers.classPrivateFieldLooseBase(this,Kt)[Kt]().getConfig());if(this.getOptions().content.extranetSecondary){e.push(babelHelpers.classPrivateFieldLooseBase(this,Mt)[Mt]().getConfig())}if(this.getOptions().content.secondary){e.push(babelHelpers.classPrivateFieldLooseBase(this,St)[St]().getConfig())}e.push(babelHelpers.classPrivateFieldLooseBase(this,xt)[xt]().getConfig());return e}))}function Rt(){return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].remember("annualSummaryContent",(()=>new Ht({...this.getOptions().content.promo.tools.annualSummary})))}function Ut(){return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].remember("mainContent",(()=>new ie({...this.getOptions().content.main})))}function Vt(){return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].remember("secondaryContent",(()=>new $e({...this.getOptions().content.secondary})))}function Gt(){return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].remember("applicationContent",(()=>new lt({...this.getOptions().content.application})))}function Yt(){return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].remember("footerContent",(()=>new we({...this.getOptions().content.footer})))}function zt(){return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].remember("mobileAuthContent",(()=>new _t({...this.getOptions().content.mobileAuth.tools.fastMobileAuth})))}function qt(){return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].remember("fastMobileAuthSubsection",(()=>new t.PopupComponentsMaker({content:[babelHelpers.classPrivateFieldLooseBase(this,Nt)[Nt]().getConfig()]}).getContentWrapper()))}function Qt(){return babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot].remember("extranetSecondaryContent",(()=>new Ct({...this.getOptions().content.extranetSecondary})))}function Jt(){P.EventEmitter.subscribe("BX.Main.Popup:onShow",(e=>{if(!this.getBasePopup().getPopup().isShown()){return}m.Dom.style(this.getBasePopup().getPopup().getPopupContainer(),"overflow-y","hidden");const t=e.getTarget();if(t&&t.getId()===this.getBasePopup().getPopup().getId()){this.getBasePopup().getPopup().setAutoHide(true);P.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:enabledAutoHide")}else{this.getBasePopup().getPopup().setAutoHide(false);P.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:disabledAutoHide");if(!babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft].includes(t)){babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft].push(t)}const e=()=>{babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft]=babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft].filter((e=>e!==t));if(babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft].length===0){this.getBasePopup().getPopup().setAutoHide(true);m.Dom.style(this.getBasePopup().getPopup().getPopupContainer(),"overflow-y","auto");P.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:enabledAutoHide")}};t.subscribeOnce("onClose",e);t.subscribeOnce("onDestroy",e)}}))}function Zt(){const e=()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,Xt)[Xt]();this.getBasePopup().getPopup().setContent(e)};P.EventEmitter.subscribe("BX.Intranet.AvatarWidget.FastMobileAuthTool:onClick",e);P.EventEmitter.subscribe("BX.Intranet.AvatarWidget.ApplicationInstallerTool:onClick",e);P.EventEmitter.subscribe("BX.Intranet.AvatarWidget.Subsection:back",(()=>{this.getBasePopup().getPopup().setContent(this.getBasePopup().getContentWrapper())}))}var es=babelHelpers.classPrivateFieldLooseKey("cache");var ts=babelHelpers.classPrivateFieldLooseKey("instance");var ss=babelHelpers.classPrivateFieldLooseKey("getPopup");class as{constructor(){Object.defineProperty(this,ss,{value:rs});Object.defineProperty(this,es,{writable:true,value:new m.Cache.MemoryCache})}static getInstance(){if(!babelHelpers.classPrivateFieldLooseBase(this,ts)[ts]){babelHelpers.classPrivateFieldLooseBase(this,ts)[ts]=new this}return babelHelpers.classPrivateFieldLooseBase(this,ts)[ts]}show(){if(babelHelpers.classPrivateFieldLooseBase(this,ss)[ss]().getBasePopup().isShown()){return}babelHelpers.classPrivateFieldLooseBase(this,ss)[ss]().show()}setOptions(e){babelHelpers.classPrivateFieldLooseBase(this,es)[es].set("options",e);return this}getOptions(){return babelHelpers.classPrivateFieldLooseBase(this,es)[es].get("options",{})}}function rs(){return babelHelpers.classPrivateFieldLooseBase(this,es)[es].remember("popup",(()=>new Wt({target:this.getOptions().buttonWrapper,loader:this.getOptions().loader,content:{...this.getOptions().data}})))}Object.defineProperty(as,ts,{writable:true,value:void 0});e.AvatarWidget=as})(this.BX.Intranet=this.BX.Intranet||{},BX.UI,BX.UI,BX.Timeman,BX.UI.Analytics,BX.UI,BX.Crm,BX,BX.HumanResources.HcmLink,BX.Messenger.v2.Lib,BX.UI,BX.Intranet,BX.Main,BX.Intranet,BX.UI,BX.UI,BX.SidePanel,BX,BX.Event);
//# sourceMappingURL=avatar-widget.bundle.map.js