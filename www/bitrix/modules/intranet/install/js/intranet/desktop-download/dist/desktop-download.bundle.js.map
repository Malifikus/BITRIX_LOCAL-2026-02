{"version":3,"file":"desktop-download.bundle.js","sources":["../src/desktop-download.js"],"sourcesContent":["import { Extension, Browser, Loc, Dom } from 'main.core';\nimport { Menu } from 'main.popup';\n\nexport type DesktopLinksType = {\n\twindows: string,\n\tmacos: string,\n\tlinuxDeb: string,\n\tlinuxRpm: string,\n\tmsi: string,\n\tmacosArm: string,\n}\n\nexport class DesktopDownload\n{\n\tlinks: DesktopLinksType;\n\tmenuMac: ?Menu;\n\tmenuLinux: ?Menu;\n\n\tconstructor()\n\t{\n\t\tthis.links = DesktopDownload.getLinks();\n\t}\n\n\tstatic getLinks(): DesktopLinksType\n\t{\n\t\treturn Extension.getSettings('intranet.desktop-download').downloadLinks;\n\t}\n\n\tstatic getLinkForCurrentUser(): string\n\t{\n\t\tconst downloadLinks = this.getLinks();\n\n\t\tif (Browser.isMac())\n\t\t{\n\t\t\treturn downloadLinks.macos;\n\t\t}\n\n\t\tif (Browser.isLinux())\n\t\t{\n\t\t\tconst UA = navigator.userAgent.toLowerCase();\n\n\t\t\tif (\n\t\t\t\tUA.includes('Fedora')\n\t\t\t\t|| UA.includes('CentOS')\n\t\t\t\t|| UA.includes('Red Hat')\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn downloadLinks.linuxRpm;\n\t\t\t}\n\n\t\t\treturn downloadLinks.linuxDeb;\n\t\t}\n\n\t\treturn downloadLinks.windows;\n\t}\n\n\tshowMenuForMac(target: HTMLElement): void\n\t{\n\t\tif (!this.menuMac)\n\t\t{\n\t\t\tthis.menuMac = new Menu({\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage('INTRANET_DESKTOP_DOWNLOAD_LINK_MAC_INTEL'),\n\t\t\t\t\t\thref: this.links.macos,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage('INTRANET_DESKTOP_DOWNLOAD_LINK_MAC_ARM'),\n\t\t\t\t\t\thref: this.links.macosArm,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tangle: true,\n\t\t\t});\n\t\t}\n\n\t\tthis.menuMac.getPopupWindow().setBindElement(target);\n\t\tthis.menuMac.getPopupWindow().setOffset({\n\t\t\toffsetLeft: Dom.getPosition(target).width / 2,\n\t\t});\n\n\t\tthis.menuMac.toggle();\n\t}\n\n\tshowMenuForLinux(target: HTMLElement): void\n\t{\n\t\tif (!this.menuLinux)\n\t\t{\n\t\t\tthis.menuLinux = new Menu({\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage('INTRANET_DESKTOP_DOWNLOAD_LINK_LINUX_DEB'),\n\t\t\t\t\t\thref: this.links.linuxDeb,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage('INTRANET_DESKTOP_DOWNLOAD_LINK_LINUX_RPM'),\n\t\t\t\t\t\thref: this.links.linuxRpm,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tangle: true,\n\t\t\t});\n\t\t}\n\n\t\tthis.menuLinux.getPopupWindow().setBindElement(target);\n\t\tthis.menuLinux.getPopupWindow().setOffset({\n\t\t\toffsetLeft: Dom.getPosition(target).width / 2,\n\t\t});\n\n\t\tthis.menuLinux.toggle();\n\t}\n\n\thandleDownloadClick(target: HTMLElement): void\n\t{\n\t\tif (Browser.isMac())\n\t\t{\n\t\t\tthis.showMenuForMac(target);\n\t\t}\n\t\telse if (Browser.isLinux())\n\t\t{\n\t\t\tthis.showMenuForLinux(target);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdocument.location.href = this.links.windows;\n\t\t}\n\t}\n}\n"],"names":["DesktopDownload","constructor","this","links","getLinks","[object Object]","Extension","getSettings","downloadLinks","Browser","isMac","macos","isLinux","UA","navigator","userAgent","toLowerCase","includes","linuxRpm","linuxDeb","windows","showMenuForMac","target","menuMac","Menu","items","text","Loc","getMessage","href","macosArm","angle","getPopupWindow","setBindElement","setOffset","offsetLeft","Dom","getPosition","width","toggle","showMenuForLinux","menuLinux","handleDownloadClick","document","location"],"mappings":"iDAYO,MAAMA,EAMZC,cAECC,KAAKC,MAAQH,EAAgBI,WAG9BC,kBAEC,OAAOC,YAAUC,YAAY,6BAA6BC,cAG3DH,+BAEC,MAAMG,EAAgBN,KAAKE,WAE3B,GAAIK,UAAQC,QAEX,OAAOF,EAAcG,MAGtB,GAAIF,UAAQG,UACZ,CACC,MAAMC,EAAKC,UAAUC,UAAUC,cAE/B,OACCH,EAAGI,SAAS,WACTJ,EAAGI,SAAS,WACZJ,EAAGI,SAAS,WAGRT,EAAcU,SAGfV,EAAcW,SAGtB,OAAOX,EAAcY,QAGtBC,eAAeC,GAETpB,KAAKqB,UAETrB,KAAKqB,QAAU,IAAIC,OAAK,CACvBC,MAAO,CACN,CACCC,KAAMC,MAAIC,WAAW,4CACrBC,KAAM3B,KAAKC,MAAMQ,OAElB,CACCe,KAAMC,MAAIC,WAAW,0CACrBC,KAAM3B,KAAKC,MAAM2B,WAGnBC,OAAO,KAIT7B,KAAKqB,QAAQS,iBAAiBC,eAAeX,GAC7CpB,KAAKqB,QAAQS,iBAAiBE,UAAU,CACvCC,WAAYC,MAAIC,YAAYf,GAAQgB,MAAQ,IAG7CpC,KAAKqB,QAAQgB,SAGdC,iBAAiBlB,GAEXpB,KAAKuC,YAETvC,KAAKuC,UAAY,IAAIjB,OAAK,CACzBC,MAAO,CACN,CACCC,KAAMC,MAAIC,WAAW,4CACrBC,KAAM3B,KAAKC,MAAMgB,UAElB,CACCO,KAAMC,MAAIC,WAAW,4CACrBC,KAAM3B,KAAKC,MAAMe,WAGnBa,OAAO,KAIT7B,KAAKuC,UAAUT,iBAAiBC,eAAeX,GAC/CpB,KAAKuC,UAAUT,iBAAiBE,UAAU,CACzCC,WAAYC,MAAIC,YAAYf,GAAQgB,MAAQ,IAG7CpC,KAAKuC,UAAUF,SAGhBG,oBAAoBpB,GAEfb,UAAQC,QAEXR,KAAKmB,eAAeC,GAEZb,UAAQG,UAEhBV,KAAKsC,iBAAiBlB,GAItBqB,SAASC,SAASf,KAAO3B,KAAKC,MAAMiB"}