(function(){BX.namespace("BX.Intranet.UserOtpConnected");BX.Intranet.UserOtpConnected={init(e){this.signedParameters=e.signedParameters;this.componentName=e.componentName;this.otpDays=e.otpDays;this.provider=new BX.Intranet.PushOtp.EnablePushOtpProvider({intent:e.intent,ttl:e.ttl,pullConfig:e.pullConfig,phoneNumber:e.phoneNumber,isPhoneNumberConfirmed:e.isPhoneNumberConfirmed,signedUserId:e.signedUserId,events:{onPopupClose:()=>{BX.SidePanel.Instance.reload()}}});const t=e.provideSmsOtp?this.provider.full():this.provider.onlyPushOtp();const n=document.querySelector("[data-role='intranet-otp-change-phone']");if(BX.type.isDomNode(n)){BX.bind(n,"click",(()=>{if(BX.getClass("BX.Intranet.UserProfile.Security")){BX.Intranet.UserProfile.Security.showOtpComponent()}}))}const r=document.querySelector("[data-role='intranet-recovery-codes']");if(BX.type.isDomNode(r)){BX.bind(r,"click",(()=>{if(BX.getClass("BX.Intranet.UserProfile.Security")){BX.Intranet.UserProfile.Security.showRecoveryCodesComponent()}}))}const s=document.querySelector("[data-role='intranet-otp-defer']");if(BX.type.isDomNode(s)){BX.bind(s,"click",(()=>{this.showOtpDaysPopup(s,"defer")}))}const o=document.querySelector("[data-role='intranet-otp-deactivate']");if(BX.type.isDomNode(o)){BX.bind(o,"click",(()=>{this.showOtpDaysPopup(o,"deactivate")}))}this.bannerPushOtp=null;if(e.canShowBannerPushOtp){if(!e.isOtpActive){this.bannerPushOtp=new BX.Intranet.NotifyBanner.PushOtp({clickEnableBtn:()=>{t.show()}})}else if(e.isNotPushOtp){this.bannerPushOtp=new BX.Intranet.NotifyBanner.PushOtp({clickEnableBtn:()=>{t.show()},clickDisableBtn:e=>{this.showOtpDaysPopup(e.target)}})}}},reload(){if(BX.getClass("BX.Intranet.UserProfile.Security")){BX.Intranet.UserProfile.Security.showOtpConnectedComponent()}},deactivateUserOtp(e){BX.ajax.runComponentAction(this.componentName,"deactivateOtp",{signedParameters:this.signedParameters,mode:"ajax",data:{numDays:e}}).then((e=>{this.reload()}),(e=>{if(BX.getClass("BX.Intranet.UserProfile.Security")){BX.Intranet.UserProfile.Security.showErrorPopup(e.errors[0].message)}}))},activateUserOtp(){BX.ajax.runComponentAction(this.componentName,"activateOtp",{signedParameters:this.signedParameters,mode:"ajax",data:{}}).then((e=>{this.reload()}),(e=>{if(BX.getClass("BX.Intranet.UserProfile.Security")){BX.Intranet.UserProfile.Security.showErrorPopup(e.errors[0].message)}}))},deferUserOtp(e){BX.ajax.runComponentAction(this.componentName,"deferOtp",{signedParameters:this.signedParameters,mode:"ajax",data:{numDays:e}}).then((e=>{this.reload()}),(e=>{if(BX.getClass("BX.Intranet.UserProfile.Security")){BX.Intranet.UserProfile.Security.showErrorPopup(e.errors[0].message)}}))},getPopupOtpProvider(){return this.provider},showOtpDaysPopup(e,t){t=t=="defer"?"defer":"deactivate";const n=this;const r=[];for(const e in this.otpDays){r.push({text:this.otpDays[e],numDays:e,onclick(e,r){this.popupWindow.close();if(t==="deactivate"){n.deactivateUserOtp(r.numDays)}else{n.deferUserOtp(r.numDays)}}})}BX.PopupMenu.show("securityOtpDaysPopup",e,r,{offsetTop:10,offsetLeft:0,events:{onPopupClose(){BX.PopupMenu.destroy("securityOtpDaysPopup")}}})}}})();
//# sourceMappingURL=script.map.js