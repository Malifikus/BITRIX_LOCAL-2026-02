{"version":3,"file":"script.js","sources":["src/component-slider.js","src/security-section.js","src/banner-factory.js","src/restore-network-password.js"],"sourcesContent":["import { Layout } from 'ui.sidepanel.layout';\nimport { SidePanel, Slider } from 'main.sidepanel';\n\nexport class ComponentSlider\n{\n\t#id: string;\n\t#title: ?string;\n\t#width: ?number;\n\t#cacheable: ?boolean;\n\t#events: Object = {};\n\t#componentContent: () => Promise;\n\t#buttons: Array<Button> = [];\n\t#extensions: Array<string> = [];\n\n\tconstructor(options)\n\t{\n\t\tthis.#id = options.id;\n\t\tthis.#title = options.title ?? '';\n\t\tthis.#width = options.width ?? 1100;\n\t\tthis.#cacheable = options.cacheable !== false;\n\t\tthis.#events = options.events ?? {};\n\t\tthis.#componentContent = options.componentContent;\n\t\tthis.#buttons = options.buttons ?? [];\n\t\tthis.#extensions = options.extensions ?? [];\n\t}\n\n\topen()\n\t{\n\t\tSidePanel.Instance.open(\n\t\t\tthis.#id,\n\t\t\t{\n\t\t\t\twidth: this.#width,\n\t\t\t\tcacheable: this.#cacheable,\n\t\t\t\tcontentCallback: () => {\n\t\t\t\t\treturn Layout.createContent({\n\t\t\t\t\t\ttitle: this.#title ?? '',\n\t\t\t\t\t\textensions: this.#extensions,\n\t\t\t\t\t\tdesign: { section: false, margin: true },\n\t\t\t\t\t\tcontent: () => {\n\t\t\t\t\t\t\treturn this.#componentContent().then(this.#prepareComponentResponse);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbuttons: () => {\n\t\t\t\t\t\t\treturn this.#buttons;\n\t\t\t\t\t\t},\n\t\t\t\t\t}).then((container) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\thtml: container?.innerHTML ?? '',\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tevents: this.#events,\n\t\t\t},\n\t\t);\n\t}\n\n\t#prepareComponentResponse(response): string\n\t{\n\t\tlet content = response?.data?.html;\n\n\t\t(response?.data?.assets.css || []).forEach((link) => {\n\t\t\tcontent += `<link rel=\"stylesheet\" href=\"${link}\">`;\n\t\t});\n\t\t(response?.data?.assets.js || []).forEach((link) => {\n\t\t\tcontent += `<script src=\"${link}\"><\\/script>`;\n\t\t});\n\t\t(response?.data?.assets.string || []).forEach((script) => {\n\t\t\tcontent += script;\n\t\t});\n\n\t\treturn content;\n\t}\n}\n","import { ComponentSlider } from './component-slider';\nimport { Loc, Type, Text, Event } from 'main.core';\nimport { Counter, CounterStyle } from 'ui.cnt';\nimport { SidePanel } from 'main.sidepanel';\nimport { sendData } from 'ui.analytics';\n\nexport class SecuritySection\n{\n\t#signedParameters: string;\n\t#userId: number;\n\t#isCloud: boolean;\n\t#passwordNetworkUrl: string;\n\t#signedUserId: string;\n\n\tconstructor(options)\n\t{\n\t\tthis.#signedParameters = options.signedParameters;\n\t\tthis.#signedUserId = options.signedUserId;\n\t\tthis.#userId = options.userId;\n\t\tthis.#isCloud = options.isCloud === true;\n\t\tthis.#passwordNetworkUrl = Type.isStringFilled(options.passwordNetworkUrl) ? options.passwordNetworkUrl : '';\n\t\tthis.#setAnalyticsEventHandlers(options);\n\t}\n\n\topen2FaSlider(): void\n\t{\n\t\tnew ComponentSlider({\n\t\t\tid: 'user_profile_2fa',\n\t\t\ttitle: Loc.getMessage('INTRANET_USER_SECURITY_PUSH_OTP_AUTH'),\n\t\t\twidth: 600,\n\t\t\textensions: [\n\t\t\t\t'intranet.push-otp.connect-popup',\n\t\t\t],\n\t\t\tcomponentContent: () => {\n\t\t\t\treturn BX.ajax.runComponentAction(\n\t\t\t\t\t'bitrix:intranet.user.profile.security',\n\t\t\t\t\t'otpList',\n\t\t\t\t\t{\n\t\t\t\t\t\tsignedParameters: this.#signedParameters,\n\t\t\t\t\t\tmode: 'ajax',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tuserId: this.#userId,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonClose: () => {\n\t\t\t\t\tthis.reload();\n\t\t\t\t},\n\t\t\t},\n\t\t}).open();\n\t}\n\n\topenOld2Fa(): void\n\t{\n\t\tBX.Intranet.UserProfile.Security.changeContent('otpList');\n\t}\n\n\topenChangePassword(): void\n\t{\n\t\tif (this.#isCloud)\n\t\t{\n\t\t\tif (Type.isStringFilled(this.#passwordNetworkUrl))\n\t\t\t{\n\t\t\t\twindow.open(this.#passwordNetworkUrl);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconsole.error('Password change URL is not defined.');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.openPasswordSlider();\n\t\t}\n\t}\n\n\topenPasswordSlider(): void\n\t{\n\t\tSidePanel.Instance.open(\n\t\t\t`/bitrix/components/bitrix/intranet.user.profile.password/index.php?userId=${Text.encode(this.#userId)}`,\n\t\t\t{\n\t\t\t\tcacheable: false,\n\t\t\t\twidth: 700,\n\t\t\t},\n\t\t);\n\t}\n\n\topenOldPassword(): void\n\t{\n\t\tBX.Intranet.UserProfile.Security.changeContent('changePassword');\n\t}\n\n\treload(): void\n\t{\n\t\tBX.Intranet.UserProfile.Security.changeContent('otpConnected');\n\t}\n\n\tlogoutAllRequest(): Promise\n\t{\n\t\treturn BX.ajax.runAction('intranet.v2.Otp.logoutAll', {\n\t\t\tdata: {\n\t\t\t\tsignedUserId: this.#signedUserId,\n\t\t\t},\n\t\t});\n\t}\n\n\tlogoutAll(): void\n\t{\n\t\tthis.logoutAllRequest()?.then((response) => {\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: Loc.getMessage('INTRANET_USER_SECURITY_EXIT_SUCCESS'),\n\t\t\t\tautoHide: true,\n\t\t\t\tposition: 'bottom-right',\n\t\t\t\tcloseButton: false,\n\t\t\t});\n\t\t});\n\t}\n\n\trenderPhoneConfirmationCounter(wrapper: HTMLElement): void\n\t{\n\t\tconst counter = new Counter({\n\t\t\tcolor: Counter.Color.DANGER,\n\t\t\tsize: Counter.Size.MEDIUM,\n\t\t\tvalue: 1,\n\t\t\tstyle: CounterStyle.FILLED_ALERT,\n\t\t\tuseAirDesign: true,\n\t\t});\n\t\tcounter.renderTo(wrapper);\n\t}\n\n\t#setAnalyticsEventHandlers(options): void\n\t{\n\t\tif (options.emailElement)\n\t\t{\n\t\t\tEvent.bind(options.emailElement, 'click', () => {\n\t\t\t\tsendData({\n\t\t\t\t\ttool: 'user_settings',\n\t\t\t\t\tcategory: 'security',\n\t\t\t\t\tevent: 'click',\n\t\t\t\t\tc_element: 'email',\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tif (options.phoneElement)\n\t\t{\n\t\t\tEvent.bind(options.phoneElement, 'click', () => {\n\t\t\t\tsendData({\n\t\t\t\t\ttool: 'user_settings',\n\t\t\t\t\tcategory: 'security',\n\t\t\t\t\tevent: 'click',\n\t\t\t\t\tc_element: 'phone',\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tif (options.socservElement)\n\t\t{\n\t\t\tEvent.bind(options.socservElement, 'click', () => {\n\t\t\t\tsendData({\n\t\t\t\t\ttool: 'user_settings',\n\t\t\t\t\tcategory: 'security',\n\t\t\t\t\tevent: 'click',\n\t\t\t\t\tc_element: 'socserv',\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tif (options.passwordElement)\n\t\t{\n\t\t\tEvent.bind(options.passwordElement, 'click', () => {\n\t\t\t\tsendData({\n\t\t\t\t\ttool: 'user_settings',\n\t\t\t\t\tcategory: 'security',\n\t\t\t\t\tevent: 'click',\n\t\t\t\t\tc_element: 'password',\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n}\n","import { PushOtp } from 'intranet.notify-banner.push-otp';\nimport { ConnectPopup, EnablePushOtpProvider, pauseOtpRequest } from 'intranet.push-otp.connect-popup';\nimport { Menu } from 'intranet.push-otp.menu';\nimport { sendData } from 'ui.analytics';\n\nexport class BannerFactory\n{\n\tstatic create(options): ?PushOtp\n\t{\n\t\tlet bannerPushOtp = null;\n\t\tif (options.canShowBannerPushOtp)\n\t\t{\n\t\t\tif (!options.isOtpActive)\n\t\t\t{\n\t\t\t\tconst popup = this.#getConnectPopup(options);\n\t\t\t\tbannerPushOtp = new PushOtp({\n\t\t\t\t\ttitle: options.title,\n\t\t\t\t\ttext: options.text,\n\t\t\t\t\tclickEnableBtn: () => {\n\t\t\t\t\t\tpopup.show();\n\t\t\t\t\t\tthis.#sendAnalyticEvent('banner_on');\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (options.isNotPushOtp)\n\t\t\t{\n\t\t\t\tlet clickDisableBtn = null;\n\n\t\t\t\tif (options.canDeactivate)\n\t\t\t\t{\n\t\t\t\t\tclickDisableBtn = (event) => {\n\t\t\t\t\t\tconst menu = new Menu(event.button, {\n\t\t\t\t\t\t\tdays: options.days,\n\t\t\t\t\t\t\tcallback: (item) => {\n\t\t\t\t\t\t\t\tpauseOtpRequest(\n\t\t\t\t\t\t\t\t\titem.numDays,\n\t\t\t\t\t\t\t\t\toptions.signedUserId,\n\t\t\t\t\t\t\t\t).then(() => BX.Intranet.UserProfile.Security.changeContent('otpConnected'))\n\t\t\t\t\t\t\t\t\t.catch((response) => console.error(response));\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tmenu.show();\n\t\t\t\t\t\tthis.#sendAnalyticEvent('banner_off');\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tconst popup = this.#getConnectPopup(options);\n\t\t\t\tbannerPushOtp = new PushOtp({\n\t\t\t\t\ttitle: options.title,\n\t\t\t\t\ttext: options.text,\n\t\t\t\t\tclickEnableBtn: () => {\n\t\t\t\t\t\tpopup.show();\n\t\t\t\t\t\tthis.#sendAnalyticEvent('banner_on');\n\t\t\t\t\t},\n\t\t\t\t\tclickDisableBtn,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn bannerPushOtp;\n\t}\n\n\tstatic #getConnectPopup(options): ConnectPopup\n\t{\n\t\tconst provider = new EnablePushOtpProvider(options);\n\n\t\treturn options.provideSmsOtp\n\t\t\t? provider.full()\n\t\t\t: provider.onlyPushOtp();\n\t}\n\n\tstatic #sendAnalyticEvent(cElement: string): void\n\t{\n\t\tsendData({\n\t\t\ttool: 'user_settings',\n\t\t\tcategory: 'security',\n\t\t\tevent: 'click',\n\t\t\tc_element: cElement,\n\t\t});\n\t}\n}\n","import { AirButtonStyle, Button, CloseButton } from 'ui.buttons';\nimport { ajax, Cache, Tag, Text, Loc } from 'main.core';\nimport { Popup } from 'main.popup';\n\nexport class RestoreNetworkPassword\n{\n\t#options: Object;\n\t#cache: MemoryCache = new Cache.MemoryCache();\n\n\tconstructor(options)\n\t{\n\t\tthis.#options = options;\n\t}\n\n\trenderTo(target: HTMLElement): void\n\t{\n\t\tif (this.#options.useEmail)\n\t\t{\n\t\t\tthis.#getEmailRestoreButton().renderTo(target);\n\t\t}\n\n\t\tif (this.#options.usePhone)\n\t\t{\n\t\t\tthis.#getPhoneRestoreButton().renderTo(target);\n\t\t}\n\t}\n\n\t#getEmailRestoreButton(): Button\n\t{\n\t\treturn this.#cache.remember('emailRestoreButton', () => {\n\t\t\treturn new Button({\n\t\t\t\ttext: Loc.getMessage('INTRANET_USER_SECURITY_RESTORE_PASSWORD_BUTTON_EMAIL'),\n\t\t\t\tstyle: AirButtonStyle.OUTLINE,\n\t\t\t\tuseAirDesign: true,\n\t\t\t\tonclick: (button) => {\n\t\t\t\t\tbutton.setWaiting(true);\n\t\t\t\t\tajax.runAction('bitrix24.v2.Password.restoreByEmail', {\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tuserId: this.#options.userId,\n\t\t\t\t\t\t},\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\tthis.#createPopup(this.#createSuccessContentByEmail()).show();\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tbutton.setWaiting(false);\n\n\t\t\t\t\t\tif (response.errors[0].message)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.#createPopup(this.#createErrorContent(response.errors[0].message)).show();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\t#getPhoneRestoreButton(): Button\n\t{\n\t\treturn this.#cache.remember('phoneRestoreButton', () => {\n\t\t\treturn new Button({\n\t\t\t\ttext: Loc.getMessage('INTRANET_USER_SECURITY_RESTORE_PASSWORD_BUTTON_PHONE'),\n\t\t\t\tstyle: AirButtonStyle.OUTLINE,\n\t\t\t\tuseAirDesign: true,\n\t\t\t\tonclick: (button) => {\n\t\t\t\t\tbutton.setWaiting(true);\n\t\t\t\t\tajax.runAction('bitrix24.v2.Password.restoreByPhone', {\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tuserId: this.#options.userId,\n\t\t\t\t\t\t},\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\tbutton.setWaiting(false);\n\t\t\t\t\t\tthis.#createPopup(this.#createSuccessContentByPhone()).show();\n\t\t\t\t\t}).catch((response) => {\n\t\t\t\t\t\tbutton.setWaiting(false);\n\n\t\t\t\t\t\tif (response.errors[0].message)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.#createPopup(this.#createErrorContent(response.errors[0].message)).show();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\t#createSuccessContentByEmail(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"b24network-account-popup-inner\">\n\t\t\t\t<div class=\"b24network-account-popup-title\">\n\t\t\t\t\t${Loc.getMessage('INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_TITLE_SUCCESS')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"b24network-account-popup-text\">${Loc.getMessage('INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_DESCRIPTION_BY_EMAIL_1')}</div>\n\t\t\t\t<div class=\"b24network-account-popup-text\">${Loc.getMessage('INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_DESCRIPTION_BY_EMAIL_2')}</div>\n\t\t\t\t<div class=\"b24network-account-popup-text\">${Loc.getMessage('INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_DESCRIPTION_BY_EMAIL_3')}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#createSuccessContentByPhone(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"b24network-account-popup-inner\">\n\t\t\t\t<div class=\"b24network-account-popup-title\">\n\t\t\t\t\t${Loc.getMessage('INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_TITLE_SUCCESS')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"b24network-account-popup-text\">${Loc.getMessage('INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_DESCRIPTION_BY_PHONE_1')}</div>\n\t\t\t\t<div class=\"b24network-account-popup-text\">${Loc.getMessage('INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_DESCRIPTION_BY_PHONE_2')}</div>\n\t\t\t\t<div class=\"b24network-account-popup-text\">${Loc.getMessage('INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_DESCRIPTION_BY_PHONE_3')}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#createErrorContent(errorMessage: string): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"b24network-account-popup-inner\">\n\t\t\t\t<div class=\"b24network-account-popup-title\">\n\t\t\t\t\t${Loc.getMessage('INTRANET_USER_SECURITY_RESTORE_PASSWORD_POPUP_TITLE_ERROR')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"b24network-account-popup-text\">${Text.encode(errorMessage)}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#createPopup(content: HTMLElement): Popup\n\t{\n\t\tconst popup = new Popup({\n\t\t\tautoHide: true,\n\t\t\tclassName: 'b24network-account-popup',\n\t\t\tcloseByEsc: true,\n\t\t\tcloseIcon: true,\n\t\t\tcontent,\n\t\t\tcacheable: false,\n\t\t\twidth: 450,\n\t\t\tbuttons: [\n\t\t\t\tnew CloseButton({\n\t\t\t\t\tonclick() {\n\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t},\n\t\t\t\t\tuseAirDesign: true,\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\n\t\treturn popup;\n\t}\n}\n"],"names":["ComponentSlider","constructor","options","id","title","width","cacheable","events","componentContent","buttons","extensions","open","SidePanel","Instance","contentCallback","Layout","createContent","design","section","margin","content","then","container","html","innerHTML","response","data","assets","css","forEach","link","js","string","script","SecuritySection","signedParameters","signedUserId","userId","isCloud","Type","isStringFilled","passwordNetworkUrl","open2FaSlider","Loc","getMessage","BX","ajax","runComponentAction","mode","onClose","reload","openOld2Fa","Intranet","UserProfile","Security","changeContent","openChangePassword","window","console","error","openPasswordSlider","Text","encode","openOldPassword","logoutAllRequest","runAction","logoutAll","UI","Notification","Center","notify","autoHide","position","closeButton","renderPhoneConfirmationCounter","wrapper","counter","Counter","color","Color","DANGER","size","Size","MEDIUM","value","style","CounterStyle","FILLED_ALERT","useAirDesign","renderTo","emailElement","Event","bind","sendData","tool","category","event","c_element","phoneElement","socservElement","passwordElement","BannerFactory","create","bannerPushOtp","canShowBannerPushOtp","isOtpActive","popup","PushOtp","text","clickEnableBtn","show","isNotPushOtp","clickDisableBtn","canDeactivate","menu","Menu","button","days","callback","item","pauseOtpRequest","numDays","catch","provider","EnablePushOtpProvider","provideSmsOtp","full","onlyPushOtp","cElement","RestoreNetworkPassword","Cache","MemoryCache","target","useEmail","usePhone","remember","Button","AirButtonStyle","OUTLINE","onclick","setWaiting","errors","message","Tag","render","errorMessage","Popup","className","closeByEsc","closeIcon","CloseButton","close"],"mappings":"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"}