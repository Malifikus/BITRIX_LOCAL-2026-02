{"version":3,"file":"setup-template-activity.bundle.js","sources":["../src/component/draggable-container/draggable-container.js","../src/component/block/block.js","../src/component/add-block-btn/add-block-btn.js","../src/constants.js","../src/utils.js","../src/component/add-element-btn/add-element-btn.js","../src/component/app-header/app-header.js","../src/component/preview-btn/preview-btn.js","../src/component/title-field/title-field.js","../src/component/description-field/description-field.js","../src/component/delimiter-field/delimiter-field.js","../src/component/edit-constant-popup-form/edit-constant-popup-form.js","../src/component/constant-field/constant-field.js","../src/component/title-icon-field/title-icon-field.js","../src/component/preview-layout/preview-layout.js","../src/component/preview-header/preview-header.js","../src/component/preview-block/preview-block.js","../src/component/preview-app/preview-app.js","../src/component/app/app.js","../src/index.js"],"sourcesContent":["import { Dom, Event } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nimport './draggable-container.css';\n\ntype DragState = {\n\tsourceBlockIndex: number | null,\n\tdraggedItemIndex: number | null,\n\tdraggedElement: HTMLElement | null,\n\tghostElement: HTMLElement | null,\n\toffsetX: number,\n\toffsetY: number,\n\tlastTargetBlockIndex: number | null,\n\tlastTargetItemIndex: number | null,\n};\n\n// @vue/component\nexport const DraggableContainer = {\n\tname: 'DraggableContainer',\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tblockIndex: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['update:items'],\n\tdata(): {\n\t\tisDragging: boolean,\n\t\tdropTargetIndex: number | null,\n\t\tdragState: DragState,\n\t\t}\n\t{\n\t\treturn {\n\t\t\tisDragging: false,\n\t\t\tdropTargetIndex: null,\n\t\t\tdragState: {\n\t\t\t\tsourceBlockIndex: null,\n\t\t\t\tdraggedItemIndex: null,\n\t\t\t\tdraggedElement: null,\n\t\t\t\tghostElement: null,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\tlastTargetBlockIndex: null,\n\t\t\t\tlastTargetItemIndex: null,\n\t\t\t},\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tdraggedItemIndex(): number | null\n\t\t{\n\t\t\treturn this.isDragging ? this.dragState.draggedItemIndex : null;\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.boundHandleDragMove = this.handleDragMove.bind(this);\n\t\tthis.boundHandleDragEnd = this.handleDragEnd.bind(this);\n\n\t\tEventEmitter.subscribe('Bizproc.SetupTemplate:Draggable:start', this.onGlobalDragStart);\n\t\tEventEmitter.subscribe('Bizproc.SetupTemplate:Draggable:dragover', this.onGlobalDragOver);\n\t\tEventEmitter.subscribe('Bizproc.SetupTemplate:Draggable:end', this.onGlobalDragEnd);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tEventEmitter.unsubscribe('Bizproc.SetupTemplate:Draggable:start', this.onGlobalDragStart);\n\t\tEventEmitter.unsubscribe('Bizproc.SetupTemplate:Draggable:dragover', this.onGlobalDragOver);\n\t\tEventEmitter.unsubscribe('Bizproc.SetupTemplate:Draggable:end', this.onGlobalDragEnd);\n\t},\n\tmethods:\n\t\t{\n\t\t\tonGlobalDragStart(e: BaseEvent): void\n\t\t\t{\n\t\t\t\tconst payload = e.getData();\n\t\t\t\tconst { sourceItemIndex, sourceBlockIndex, event, element } = payload;\n\n\t\t\t\tif (sourceBlockIndex !== this.blockIndex)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tthis.isDragging = true;\n\t\t\t\tthis.dragState.sourceBlockIndex = this.blockIndex;\n\t\t\t\tthis.dragState.draggedItemIndex = sourceItemIndex;\n\t\t\t\tthis.dragState.draggedElement = element;\n\n\t\t\t\tthis.createGhost(event);\n\t\t\t\tDom.addClass(this.dragState.draggedElement, '--dragging');\n\t\t\t\tDom.addClass(document.body, '--user-dragging');\n\t\t\t\tEvent.bind(document, 'mousemove', this.boundHandleDragMove);\n\t\t\t\tEvent.bind(document, 'mouseup', this.boundHandleDragEnd);\n\t\t\t},\n\t\t\tonGlobalDragOver(e: BaseEvent): void\n\t\t\t{\n\t\t\t\tconst payload = e.getData();\n\t\t\t\tif (payload.targetBlockIndex === this.blockIndex)\n\t\t\t\t{\n\t\t\t\t\tthis.dropTargetIndex = payload.targetItemIndex;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.dropTargetIndex = null;\n\t\t\t\t}\n\n\t\t\t\tif (this.isDragging)\n\t\t\t\t{\n\t\t\t\t\tthis.dragState.lastTargetBlockIndex = payload.targetBlockIndex;\n\t\t\t\t\tthis.dragState.lastTargetItemIndex = payload.targetItemIndex;\n\t\t\t\t}\n\t\t\t},\n\t\t\thandleDragMove(event: MouseEvent): void\n\t\t\t{\n\t\t\t\tif (!this.isDragging)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.updateGhostPosition(event);\n\n\t\t\t\tconst result = { targetBlockIndex: null, targetItemIndex: null };\n\t\t\t\tconst elementUnderCursor = document.elementFromPoint(event.clientX, event.clientY);\n\n\t\t\t\tif (elementUnderCursor)\n\t\t\t\t{\n\t\t\t\t\tconst container = elementUnderCursor.closest('[data-draggable-container]');\n\t\t\t\t\tif (container)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.targetBlockIndex = parseInt(container.dataset.blockIndex, 10);\n\t\t\t\t\t\tconst allItems = [...container.querySelectorAll('[data-draggable-item]')];\n\t\t\t\t\t\tconst closestItem = elementUnderCursor.closest('[data-draggable-item]');\n\n\t\t\t\t\t\tif (closestItem)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst rect = closestItem.getBoundingClientRect();\n\t\t\t\t\t\t\tconst isAfter = (event.clientY - rect.top) > rect.height / 2;\n\t\t\t\t\t\t\tconst index = allItems.indexOf(closestItem);\n\t\t\t\t\t\t\tresult.targetItemIndex = isAfter ? index + 1 : index;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (allItems.length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresult.targetItemIndex = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tEventEmitter.emit('Bizproc.SetupTemplate:Draggable:dragover', result);\n\t\t\t},\n\t\t\thandleDragEnd(): void\n\t\t\t{\n\t\t\t\tif (!this.isDragging)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tEventEmitter.emit('Bizproc.SetupTemplate:Draggable:drop', {\n\t\t\t\t\tsourceBlockIndex: this.dragState.sourceBlockIndex,\n\t\t\t\t\tsourceItemIndex: this.dragState.draggedItemIndex,\n\t\t\t\t\ttargetBlockIndex: this.dragState.lastTargetBlockIndex,\n\t\t\t\t\ttargetItemIndex: this.dragState.lastTargetItemIndex,\n\t\t\t\t});\n\n\t\t\t\tEventEmitter.emit('Bizproc.SetupTemplate:Draggable:end');\n\t\t\t},\n\t\t\tonGlobalDragEnd(): void\n\t\t\t{\n\t\t\t\tif (this.isDragging)\n\t\t\t\t{\n\t\t\t\t\tthis.resetDragState();\n\t\t\t\t}\n\t\t\t\tthis.isDragging = false;\n\t\t\t\tthis.dropTargetIndex = null;\n\t\t\t},\n\t\t\tresetDragState(): void\n\t\t\t{\n\t\t\t\tDom.removeClass(document.body, '--user-dragging');\n\t\t\t\tif (this.dragState.draggedElement)\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(this.dragState.draggedElement, '--dragging');\n\t\t\t\t}\n\n\t\t\t\tif (this.dragState.ghostElement)\n\t\t\t\t{\n\t\t\t\t\tDom.remove(this.dragState.ghostElement);\n\t\t\t\t}\n\n\t\t\t\tEvent.unbind(document, 'mousemove', this.boundHandleDragMove);\n\t\t\t\tEvent.unbind(document, 'mouseup', this.boundHandleDragEnd);\n\n\t\t\t\tthis.dragState = {\n\t\t\t\t\tsourceBlockIndex: null,\n\t\t\t\t\tdraggedItemIndex: null,\n\t\t\t\t\tdraggedElement: null,\n\t\t\t\t\tghostElement: null,\n\t\t\t\t\toffsetX: 0,\n\t\t\t\t\toffsetY: 0,\n\t\t\t\t\tlastTargetBlockIndex: null,\n\t\t\t\t\tlastTargetItemIndex: null,\n\t\t\t\t};\n\t\t\t},\n\t\t\tupdateGhostPosition(event: MouseEvent): void\n\t\t\t{\n\t\t\t\tif (!this.dragState.ghostElement)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tDom.style(this.dragState.ghostElement, 'left', `${event.clientX - this.dragState.offsetX}px`);\n\t\t\t\tDom.style(this.dragState.ghostElement, 'top', `${event.clientY - this.dragState.offsetY}px`);\n\t\t\t},\n\t\t\tcreateGhost(event: MouseEvent): void\n\t\t\t{\n\t\t\t\tconst rect = this.dragState.draggedElement.getBoundingClientRect();\n\t\t\t\tthis.dragState.offsetX = event.clientX - rect.left;\n\t\t\t\tthis.dragState.offsetY = event.clientY - rect.top;\n\n\t\t\t\tconst ghost = this.dragState.draggedElement.cloneNode(true);\n\t\t\t\tDom.addClass(ghost, '--ghost');\n\t\t\t\tDom.style(ghost, 'width', `${rect.width}px`);\n\t\t\t\tDom.append(ghost, document.body);\n\t\t\t\tthis.dragState.ghostElement = ghost;\n\n\t\t\t\tthis.updateGhostPosition(event);\n\t\t\t},\n\t\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<slot\n\t\t\t\t:dropTargetIndex=\"dropTargetIndex\"\n\t\t\t\t:draggedItemIndex=\"draggedItemIndex\"\n\t\t\t></slot>\n\t\t</div>\n\t`,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline } from 'ui.icon-set.api.core';\nimport { DraggableContainer } from '../draggable-container/draggable-container';\n\nimport './block.css';\n\nimport type { Item } from '../../types';\n\ntype DndSlotProps = {\n\tdropTargetIndex: number | null,\n\tdraggedItemIndex: number | null,\n};\n\n// @vue/component\nexport const BlockComponent = {\n\tname: 'BlockComponent',\n\tcomponents: {\n\t\tBIcon,\n\t\tDraggableContainer,\n\t},\n\tprops: {\n\t\tposition: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\t/** type Array<Item> */\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tblockIndex: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['deleteBlock', 'update:items'],\n\tsetup(): { [string]: string }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_BLOCK_TITLE', {\n\t\t\t\t'#POSITION#': this.position,\n\t\t\t});\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonItemsUpdate(newItems: Array<Item>): void\n\t\t{\n\t\t\tthis.$emit('update:items', newItems);\n\t\t},\n\t\tshowDropPlaceholder(dnd: DndSlotProps, itemIndex: number): boolean\n\t\t{\n\t\t\treturn dnd.dropTargetIndex === itemIndex && dnd.dropTargetIndex !== dnd.draggedItemIndex;\n\t\t},\n\t\tshowFinalDropPlaceholder(dnd: DndSlotProps): boolean\n\t\t{\n\t\t\treturn dnd.dropTargetIndex === this.items.length && dnd.draggedItemIndex !== this.items.length;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bizproc-setuptemplateactivity-block\">\n\t\t\t<div class=\"bizproc-setuptemplateactivity-block__header\">\n\t\t\t\t<div class=\"bizproc-setuptemplateactivity-block__header-wrap\">\n\t\t\t\t\t<p class=\"bizproc-setuptemplateactivity-block__title\">\n\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t</p>\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\t:name=\"Outline.CROSS_L\"\n\t\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t\tclass=\"bizproc-setuptemplateactivity-block__delete-icon\"\n\t\t\t\t\t\t@click=\"$emit('deleteBlock')\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<DraggableContainer\n\t\t\t\t:items=\"items\"\n\t\t\t\t:blockIndex=\"blockIndex\"\n\t\t\t\t@update:items=\"onItemsUpdate\"\n\t\t\t\tv-slot=\"dnd\"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\t:data-block-index=\"blockIndex\"\n\t\t\t\t\tclass=\"bizproc-setuptemplateactivity-block__items\"\n\t\t\t\t\tdata-draggable-container=\"true\"\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-for=\"(item, itemIndex) in items\"\n\t\t\t\t\t\t:key=\"item.id\"\n\t\t\t\t\t\tclass=\"bizproc-setuptemplateactivity-draggable-wrapper\"\n\t\t\t\t\t\tdata-draggable-item=\"true\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"showDropPlaceholder(dnd, itemIndex)\"\n\t\t\t\t\t\t\tclass=\"bizproc-setuptemplateactivity-drop-placeholder\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t\t<slot\n\t\t\t\t\t\t\tname=\"item\"\n\t\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t\t:itemIndex=\"itemIndex\"\n\t\t\t\t\t\t></slot>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"showFinalDropPlaceholder(dnd)\"\n\t\t\t\t\t\tclass=\"bizproc-setuptemplateactivity-drop-placeholder\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t</DraggableContainer>\n\t\t\t<div class=\"bizproc-setuptemplateactivity-block__footer\">\n\t\t\t\t<div class=\"bizproc-setuptemplateactivity-block__footer-wrap\">\n\t\t\t\t\t<slot name=\"footer\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","// @vue/component\nexport const AddBlockBtn = {\n\tname: 'AddBlockBtn',\n\ttemplate: `\n\t\t<button\n\t\t\tclass=\"ui-btn --air --wide --style-outline-no-accent ui-btn-no-caps --with-icon\"\n\t\t\ttype=\"button\"\n\t\t>\n\t\t\t<div class=\"ui-icon-set --plus-l\"/>\n\t\t\t<span class=\"ui-btn-text\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_ADD_BLOCK') }}\n\t\t\t</span>\n\t\t</button>\n\t`,\n};\n","import type { ConstantType, DelimiterType, ItemType } from './types';\n\nexport const ITEM_TYPES: Record<string, ItemType> = Object.freeze({\n\tDELIMITER: 'delimiter',\n\tTITLE: 'title',\n\tTITLE_WITH_ICON: 'titleWithIcon',\n\tICON_TITLE: 'iconTitle',\n\tDESCRIPTION: 'description',\n\tCONSTANT: 'constant',\n});\n\nexport const CONSTANT_TYPES: Record<string, ConstantType> = Object.freeze({\n\tSTRING: 'string',\n\tINT: 'int',\n\tUSER: 'user',\n\tFILE: 'file',\n\tTEXT: 'text',\n\tSELECT: 'select',\n});\n\nexport const DELIMITER_TYPES: Record<string, DelimiterType> = Object.freeze({\n\tLINE: 'line',\n});\n\nexport const CONSTANT_ID_PREFIX = 'SetupTemplateActivity_';\n\nexport const PRESET_TITLE_ICONS = {\n\tIMAGE: 'o-image',\n\tATTACH: 'o-attach',\n\tSETTINGS: 'o-settings',\n\tSTARS: 'o-ai-stars',\n};\n","import {\n\tCONSTANT_ID_PREFIX,\n\tCONSTANT_TYPES,\n\tDELIMITER_TYPES,\n\tITEM_TYPES,\n\tPRESET_TITLE_ICONS,\n} from './constants';\nimport type {\n\tConstantItem,\n\tDelimiterItem,\n\tDescriptionItem,\n\tTitleItem,\n\tTitleWithIconItem,\n\tConstantConvertedData,\n} from './types';\n\nexport function makeEmptyBlock(): {...}\n{\n\treturn {\n\t\tid: generateConstantId(),\n\t\titems: [],\n\t};\n}\n\nexport function makeEmptyDelimiter(): DelimiterItem\n{\n\treturn {\n\t\tid: generateConstantId(),\n\t\titemType: ITEM_TYPES.DELIMITER,\n\t\tdelimiterType: DELIMITER_TYPES.LINE,\n\t};\n}\n\nexport function makeEmptyTitle(): TitleItem\n{\n\treturn {\n\t\tid: generateConstantId(),\n\t\titemType: ITEM_TYPES.TITLE,\n\t\ttext: '',\n\t};\n}\n\nexport function makeEmptyTitleWithIcon(): TitleWithIconItem\n{\n\treturn {\n\t\tid: generateConstantId(),\n\t\titemType: ITEM_TYPES.TITLE_WITH_ICON,\n\t\ttext: '',\n\t\ticon: 'IMAGE',\n\t};\n}\n\nexport function makeEmptyDescription(): DescriptionItem\n{\n\treturn {\n\t\tid: generateConstantId(),\n\t\titemType: ITEM_TYPES.DESCRIPTION,\n\t\ttext: '',\n\t};\n}\n\nexport function makeEmptyConstant(): ConstantItem\n{\n\treturn {\n\t\titemType: ITEM_TYPES.CONSTANT,\n\t\tid: generateConstantId(),\n\t\tname: '',\n\t\tconstantType: CONSTANT_TYPES.STRING,\n\t\tmultiple: false,\n\t\tdescription: '',\n\t\tdefault: '',\n\t\toptions: [],\n\t\trequired: false,\n\t};\n}\n\nexport function convertConstants(constant: ConstantItem): ConstantConvertedData\n{\n\treturn {\n\t\tName: constant.name,\n\t\tDescription: constant.description,\n\t\tType: constant.constantType,\n\t\tRequired: 0,\n\t\tMultiple: constant.multiple ? 1 : 0,\n\t\tOptions: (constant.options && constant.options.length > 0) ? constant.options : null,\n\t\tDefault: constant.default,\n\t};\n}\n\nfunction generateRandomString(length: number): string\n{\n\tconst characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\tlet result = '';\n\tconst charactersLength = characters.length;\n\tfor (let i = 0; i < length; i++)\n\t{\n\t\tresult += characters.charAt(Math.floor(Math.random() * charactersLength));\n\t}\n\n\treturn result;\n}\n\nexport function generateConstantId(): string\n{\n\treturn CONSTANT_ID_PREFIX + generateRandomString(10);\n}\n","import { BMenu } from 'ui.system.menu.vue';\nimport {\n\tmakeEmptyTitle,\n\tmakeEmptyDescription,\n\tmakeEmptyDelimiter,\n\tmakeEmptyConstant,\n\tmakeEmptyTitleWithIcon,\n} from '../../utils';\nimport type { MenuOptions } from 'ui.system.menu';\n\ntype AddElementBtnData = {\n\tisMenuShown: boolean;\n\toffsetLeft: number;\n};\n\n// @vue/component\nexport const AddElementBtn = {\n\tname: 'AddElementBtn',\n\tcomponents: {\n\t\tBMenu,\n\t},\n\temits: ['add:element', 'create:constant'],\n\tdata(): AddElementBtnData\n\t{\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t\toffsetLeft: 0,\n\t\t};\n\t},\n\tcomputed: {\n\t\tmenuOptions(): MenuOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tbindElement: this.$refs.addElementButton,\n\t\t\t\toffsetLeft: this.offsetLeft,\n\t\t\t\tfixed: false,\n\t\t\t\tcacheable: false,\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_TITLE_ITEM_LABEL'),\n\t\t\t\t\t\tonClick: () => this.$emit('add:element', makeEmptyTitle()),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_ICON_TITLE_ITEM_LABEL'),\n\t\t\t\t\t\tonClick: () => this.$emit('add:element', makeEmptyTitleWithIcon()),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_DESCRIPTION_ITEM_LABEL'),\n\t\t\t\t\t\tonClick: () => this.$emit('add:element', makeEmptyDescription()),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_DELIMITER_ITEM_LABEL'),\n\t\t\t\t\t\tonClick: () => this.$emit('add:element', makeEmptyDelimiter()),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_MENU'),\n\t\t\t\t\t\tonClick: () => this.$emit('create:constant', makeEmptyConstant()),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonShowMenu(event: MouseEvent): void\n\t\t{\n\t\t\tconst { left = 0 } = this.$refs.addElementButton?.getBoundingClientRect() ?? {};\n\n\t\t\tthis.offsetLeft = Math.abs(event.clientX - left);\n\t\t\tthis.isMenuShown = true;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<button\n\t\t\tref=\"addElementButton\"\n\t\t\tclass=\"ui-btn --air --wide --style-outline-no-accent ui-btn-no-caps --with-icon bizproc-setuptemplateactivity-add-element-btn\"\n\t\t\ttype=\"button\"\n\t\t\t@click=\"onShowMenu\"\n\t\t>\n\t\t\t<div class=\"ui-icon-set --plus-l\"/>\n\t\t\t<span class=\"ui-btn-text\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_ADD_ITEM') }}\n\t\t\t</span>\n\t\t\t<BMenu\n\t\t\t\tv-if=\"isMenuShown\"\n\t\t\t\t:options=\"menuOptions\"\n\t\t\t\t@close=\"isMenuShown = false\"\n\t\t\t/>\n\t\t</button>\n\t`,\n};\n","import './app-header.css';\n\n// @vue/component\nexport const AppHeader = {\n\tname: 'AppHeader',\n\ttemplate: `\n\t\t<header class=\"bizproc-setuptemplateactivity-app-header\">\n\t\t\t<div class=\"bizproc-setuptemplateactivity-app-header__title-wrap\">\n\t\t\t\t<h3 class=\"bizproc-setuptemplateactivity-app-header__title\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_APP_TITLE') }}\n\t\t\t\t</h3>\n\t\t\t\t<div class=\"bizproc-setuptemplateactivity-app-header__preview-btn\">\n\t\t\t\t\t<slot name=\"preview-btn\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<p class=\"bizproc-setuptemplateactivity-app-header__description\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_HEADER_DESCRIPTION') }}\n\t\t\t</p>\n\t\t</header>\n\t`,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline } from 'ui.icon-set.api.core';\nimport './preview-btn.css';\n\n// @vue/component\nexport const PreviewBtn = {\n\tname: 'PreviewBtn',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tshowPreview: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\ticon(): string\n\t\t{\n\t\t\treturn this.showPreview\n\t\t\t\t? Outline.CROSSED_EYE\n\t\t\t\t: Outline.OBSERVER;\n\t\t},\n\t\tlabel(): string\n\t\t{\n\t\t\treturn this.showPreview\n\t\t\t\t? this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_HIDE_PREVIEW_BTN_TEXT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_SHOW_PREVIEW_BTN_TEXT');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<button\n\t\t\tclass=\"bizproc-setuptemplateactivity-preview-btn\"\n\t\t\ttype=\"button\"\n\t\t>\n\t\t\t<BIcon\n\t\t\t\t:name=\"icon\"\n\t\t\t\t:size=\"24\"\n\t\t\t\tclass=\"bizproc-setuptemplateactivity-preview-btn__icon\"\n\t\t\t/>\n\t\t\t<span class=\"bizproc-setuptemplateactivity-preview-btn__label\">\n\t\t\t\t{{ label }}\n\t\t\t</span>\n\t\t</button\n\t`,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline, Main } from 'ui.icon-set.api.core';\nimport { UpdateItemPropertyEventPayload } from '../../types';\n\nimport './title-field.css';\n// eslint-disable-next-line no-unused-vars\nimport type { TitleItem } from '../../types';\n\n// @vue/component\nexport const TitleField = {\n\tname: 'TitleField',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\t/** @type TitleItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['updateItemProperty', 'delete'],\n\tsetup(): { [string]: string }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tMain,\n\t\t};\n\t},\n\tmethods: {\n\t\tonInput(event: Event): void\n\t\t{\n\t\t\tconst payload: UpdateItemPropertyEventPayload = {\n\t\t\t\tpropertyValues: {\n\t\t\t\t\ttext: event.target.value,\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.$emit('updateItemProperty', payload);\n\t\t},\n\t\thandleDragStart(event: Event): void\n\t\t{\n\t\t\tthis.$emit('itemDragStart', {\n\t\t\t\tevent,\n\t\t\t\telement: this.$el,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bizproc-setuptemplateactivity-field-wrapper\">\n\t\t\t<div\n\t\t\t\tclass=\"bizproc-setuptemplateactivity-field-drag-icon\"\n\t\t\t\t@mousedown.prevent=\"handleDragStart\"\n\t\t\t>\n\t\t\t\t<BIcon :name=\"Main.MORE_POINTS\" :size=\"18\"/>\n\t\t\t</div>\n\t\t\t<div class=\"bizproc-setuptemplateactivity-title-field\">\n\t\t\t\t<div class=\"ui-ctl-container\">\n\t\t\t\t\t<div class=\"ui-ctl-top\">\n\t\t\t\t\t\t<div class=\"ui-ctl-title bizproc-setuptemplateactivity-title-field__label\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_TITLE_ITEM_LABEL') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100\">\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t:value=\"item.text\"\n\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t@input=\"onInput\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bizproc-setuptemplateactivity-title-field__controls\">\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\t:name=\"Outline.CROSS_L\"\n\t\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t\tclass=\"bizproc-setuptemplateactivity-title-field__delete-icon\"\n\t\t\t\t\t\t@click=\"$emit('delete')\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline, Main } from 'ui.icon-set.api.core';\n\nimport './description-field.css';\n\n// eslint-disable-next-line no-unused-vars\nimport type { DescriptionItem, UpdateItemPropertyEventPayload } from '../../types';\n\n// @vue/component\nexport const DescriptionField = {\n\tname: 'DescriptionField',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\t/** @type DescriptionItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['updateItemProperty'],\n\tsetup(): { [string]: string }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tMain,\n\t\t};\n\t},\n\tmethods: {\n\t\tonInput(event: Event): void\n\t\t{\n\t\t\tconst payload: UpdateItemPropertyEventPayload = {\n\t\t\t\tpropertyValues: {\n\t\t\t\t\ttext: event.target.value,\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.$emit('updateItemProperty', payload);\n\t\t},\n\t\thandleDragStart(event: Event): void\n\t\t{\n\t\t\tthis.$emit('itemDragStart', {\n\t\t\t\tevent,\n\t\t\t\telement: this.$el,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bizproc-setuptemplateactivity-field-wrapper\">\n\t\t\t<div\n\t\t\t\tclass=\"bizproc-setuptemplateactivity-field-drag-icon\"\n\t\t\t\t@mousedown.prevent=\"handleDragStart\"\n\t\t\t>\n\t\t\t\t<BIcon :name=\"Main.MORE_POINTS\" :size=\"18\"/>\n\t\t\t</div>\n\t\t\t<div class=\"bizproc-setuptemplateactivity-description-feild\">\n\t\t\t\t<div class=\"ui-ctl-container\">\n\t\t\t\t\t<div class=\"ui-ctl-top\">\n\t\t\t\t\t\t<div class=\"ui-ctl-title bizproc-setuptemplateactivity-description-feild__label\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_DESCRIPTION_ITEM_LABEL') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textarea ui-ctl-w100\">\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t:value=\"item.text\"\n\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\trows=\"4\"\n\t\t\t\t\t\t\t@input=\"onInput\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bizproc-setuptemplateactivity-description-feild__controls\">\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\t:name=\"Outline.CROSS_L\"\n\t\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t\tclass=\"bizproc-setuptemplateactivity-description-feild__delete-icon\"\n\t\t\t\t\t\t@click=\"$emit('delete')\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline, Main } from 'ui.icon-set.api.core';\n\nimport './delimiter-field.css';\n\n// eslint-disable-next-line no-unused-vars\nimport type { DelimiterItem, UpdateItemPropertyEventPayload } from '../../types';\n\n// @vue/component\nexport const DelimiterField = {\n\tname: 'DelimiterField',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\t/** @type DelimiterItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['updateItemProperty'],\n\tsetup(): { [string]: string }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tMain,\n\t\t};\n\t},\n\tmethods: {\n\t\tonSelect(event: Event): void\n\t\t{\n\t\t\tconst payload: UpdateItemPropertyEventPayload = {\n\t\t\t\tpropertyValues: {\n\t\t\t\t\tdelimiterType: event.target.value,\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.$emit('updateItemProperty', payload);\n\t\t},\n\t\thandleDragStart(event: Event): void\n\t\t{\n\t\t\tthis.$emit('itemDragStart', {\n\t\t\t\tevent,\n\t\t\t\telement: this.$el,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bizproc-setuptemplateactivity-field-wrapper\">\n\t\t\t<div\n\t\t\t\tclass=\"bizproc-setuptemplateactivity-field-drag-icon\"\n\t\t\t\t@mousedown.prevent=\"handleDragStart\"\n\t\t\t>\n\t\t\t\t<BIcon :name=\"Main.MORE_POINTS\" :size=\"18\"/>\n\t\t\t</div>\n\t\t\t<div class=\"bizproc-setuptemplateactivity-delimiter-field\">\n\t\t\t\t<div class=\"ui-ctl-container\">\n\t\t\t\t\t<div class=\"ui-ctl-top\">\n\t\t\t\t\t\t<div class=\"ui-ctl-title\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_DELIMITER_ITEM_LABEL') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t:value=\"item.delimiterType\"\n\t\t\t\t\t\t\tclass=\"ui-ctl-element ui-ctl-w100\"\n\t\t\t\t\t\t\t@change=\"onSelect\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<option value=\"line\">\n\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_DELIMITER_ITEM_OPTION_LINE') }}\n\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bizproc-setuptemplateactivity-delimiter-field__controls\">\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\t:name=\"Outline.CROSS_L\"\n\t\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t\tclass=\"bizproc-setuptemplateactivity-delimiter-field__delete-icon\"\n\t\t\t\t\t\t@click=\"$emit('delete')\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport {\n\tButton as UiButton,\n\tAirButtonStyle,\n\tButtonSize,\n} from 'ui.vue3.components.button';\nimport { CONSTANT_TYPES } from '../../constants';\nimport './edit-constant-popup-form.css';\n// eslint-disable-next-line no-unused-vars\nimport type { ConstantItem } from '../../types';\n\ntype EditConstantPopupFormData = {\n\tname: string;\n\tconstantType: string;\n\tmultiple: boolean;\n\tdescription: string;\n\tdefaultValue: string;\n\toptions: Array<Record<string, string>>;\n\trequired: boolean;\n};\n\n// @vue/component\nexport const EditConstantPopupForm = {\n\tname: 'EditConstantPopupForm',\n\tcomponents: {\n\t\tUiButton,\n\t},\n\tinject: ['editSlider'],\n\tprops: {\n\t\t/** @type ConstantItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\t/** Record<string, string> */\n\t\tfieldTypeNames: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['update:item', 'cancel'],\n\tsetup(): { [string]: string }\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t\tButtonSize,\n\t\t};\n\t},\n\tdata(): EditConstantPopupFormData\n\t{\n\t\treturn {\n\t\t\tname: this.item.name,\n\t\t\tconstantType: this.item.constantType,\n\t\t\tmultiple: this.item.multiple,\n\t\t\tdescription: this.item.description,\n\t\t\tdefaultValue: this.item.default,\n\t\t\toptions: [...this.item.options],\n\t\t\trequired: this.item.required,\n\t\t\terrors: {\n\t\t\t\tname: '',\n\t\t\t\toptions: this.item.options.map(() => ''),\n\t\t\t},\n\t\t};\n\t},\n\tcomputed: {\n\t\tisSelectType(): boolean\n\t\t{\n\t\t\treturn this.constantType === CONSTANT_TYPES.SELECT;\n\t\t},\n\t\terrorMessages(): string\n\t\t{\n\t\t\treturn {\n\t\t\t\trequired: this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_ERROR_LABEL_REQUIRED'),\n\t\t\t};\n\t\t},\n\t},\n\twatch: {\n\t\tconstantType(type): void\n\t\t{\n\t\t\tthis.options = [];\n\t\t},\n\t},\n\tmethods: {\n\t\tonAddOption(): void\n\t\t{\n\t\t\tthis.options.push({\n\t\t\t\tname: '',\n\t\t\t});\n\t\t\tthis.errors.options.push('');\n\t\t},\n\t\tonDeleteOption(index: number): void\n\t\t{\n\t\t\tthis.options.splice(index, 1);\n\t\t\tthis.errors.options.splice(index, 1);\n\t\t},\n\t\tvalidateName(): boolean\n\t\t{\n\t\t\tthis.errors.name = '';\n\n\t\t\tif (!Type.isStringFilled(this.name.trim()))\n\t\t\t{\n\t\t\t\tthis.errors.name = this.errorMessages.required;\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tvalidateOption(index: number): boolean\n\t\t{\n\t\t\tconst name = this.options[index].name.trim();\n\t\t\tthis.errors.options[index] = '';\n\n\t\t\tif (!Type.isStringFilled(name))\n\t\t\t{\n\t\t\t\tthis.errors.options[index] = this.errorMessages.required;\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tvalidateOptions(): boolean\n\t\t{\n\t\t\tif (this.constantType !== CONSTANT_TYPES.SELECT)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tlet errorsCount = 0;\n\t\t\tthis.errors.options = [];\n\n\t\t\tthis.options.forEach((option, index) => {\n\t\t\t\tif (Type.isStringFilled(option.name.trim()))\n\t\t\t\t{\n\t\t\t\t\tthis.errors.options[index] = '';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\terrorsCount += 1;\n\t\t\t\t\tthis.errors.options[index] = this.errorMessages.required;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn errorsCount === 0;\n\t\t},\n\t\tresetErrors(): void\n\t\t{\n\t\t\tthis.errors = {\n\t\t\t\tname: '',\n\t\t\t\toptions: [],\n\t\t\t};\n\t\t},\n\t\tonSave(): void\n\t\t{\n\t\t\tconst isValid = ([\n\t\t\t\tthis.validateName(),\n\t\t\t\tthis.validateOptions(),\n\t\t\t])\n\t\t\t\t.every((value: boolean) => value);\n\n\t\t\tif (!isValid)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('update:item', {\n\t\t\t\tpropertyValues: {\n\t\t\t\t\t...this.item,\n\t\t\t\t\tname: this.name,\n\t\t\t\t\tdescription: this.description,\n\t\t\t\t\tconstantType: this.constantType,\n\t\t\t\t\tmultiple: this.multiple,\n\t\t\t\t\toptions: [...this.options],\n\t\t\t\t\tdefault: this.defaultValue,\n\t\t\t\t\trequired: this.required,\n\t\t\t\t},\n\t\t\t});\n\t\t\tthis.editSlider?.close();\n\t\t},\n\t\tonCancel(): void\n\t\t{\n\t\t\tthis.editSlider?.close();\n\t\t\tthis.$emit('cancel');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bizproc-setuptemplateactivity-edit-constant-popup\">\n\t\t\t<div class=\"bizproc-setuptemplateactivity-edit-constant-popup__container\">\n\t\t\t\t<div class=\"bizproc-setuptemplateactivity-edit-constant-popup__header\">\n\t\t\t\t\t<h1 class=\"bizproc-setuptemplateactivity-edit-constant-popup__title\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_SLIDER_TITLE') }}\n\t\t\t\t\t</h1>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"bizproc-setuptemplateactivity-edit-constant-popup__content\">\n\t\t\t\t\t<div class=\"bizproc-setuptemplateactivity-edit-constant-popup__block\">\n\t\t\t\t\t\t<div class=\"ui-ctl-container\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-top\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl-title\">\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_NAME_LABEL') }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tv-model=\"name\"\n\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\t:class=\"{ '--error': errors.name !== '' }\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t@blur=\"validateName\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-if=\"errors.name\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-label-text-error\">\n\t\t\t\t\t\t\t\t{{ errors.name }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"ui-ctl-container\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-top\">\n\t\t\t\t\t\t\t\t<label class=\"ui-ctl-title\">\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_TYPE_LABEL') }}\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t\t\t\t<select\n\t\t\t\t\t\t\t\t\tv-model=\"constantType\"\n\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\t\t\tv-for=\"[fieldType, fieldText] in Object.entries(fieldTypeNames)\"\n\t\t\t\t\t\t\t\t\t\t:key=\"fieldType\"\n\t\t\t\t\t\t\t\t\t\t:value=\"fieldType\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{{ fieldText }}\n\t\t\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-ctl-container\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-top\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl-title\">\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_MULTIPLE_LABEL') }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<label class=\"ui-ctl ui-ctl-radio ui-ctl-inline\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tv-model=\"multiple\"\n\t\t\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\t\t:value=\"true\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_MULTIPLE_VALUE_YES') }}\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<label class=\"ui-ctl ui-ctl-radio ui-ctl-inline\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tv-model=\"multiple\"\n\t\t\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\t\t:value=\"false\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_MULTIPLE_VALUE_NO') }}\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"ui-ctl-container\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-top\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl-title\">\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_REQUIRED_LABEL') }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<label class=\"ui-ctl ui-ctl-radio ui-ctl-inline\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tv-model=\"required\"\n\t\t\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\t\t:value=\"true\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_REQUIRED_VALUE_YES') }}\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<label class=\"ui-ctl ui-ctl-radio ui-ctl-inline\">\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tv-model=\"required\"\n\t\t\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\t\t:value=\"false\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_REQUIRED_VALUE_NO') }}\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"ui-ctl-container\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-top\">\n\t\t\t\t\t\t\t\t<label class=\"ui-ctl-title\">\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_VALUE') }}\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tv-model=\"defaultValue\"\n\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<template v-if=\"isSelectType\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-for=\"(option, index) in options\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-container\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl-top\">\n\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl-title\">\n\t\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_OPTION_LABEL')  }} {{ index + 1 }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100\">\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-clear\"\n\t\t\t\t\t\t\t\t\t\t@click=\"onDeleteOption(index)\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\tv-model=\"option.name\"\n\t\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\t\t:class=\"{ '--error': errors.options[index] !== '' }\"\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t@blur=\"validateOption(index)\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"errors.options[index]\"\n\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-label-text-error\">\n\t\t\t\t\t\t\t\t\t{{ errors.options[index] }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"isSelectType\"\n\t\t\t\t\t\t\tclass=\"ui-ctl-container\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclass=\"ui-btn --air --wide --style-outline-no-accent ui-btn-no-caps\"\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t@click=\"onAddOption\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"ui-icon-set --plus-l\"/>\n\t\t\t\t\t\t\t\t<span class=\"ui-btn-text\">\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_ADD_OPTION_BTN') }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"ui-ctl-container\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-top\">\n\t\t\t\t\t\t\t\t<label class=\"ui-ctl-title\">\n\t\t\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_DESCRIPTION') }}\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textarea ui-ctl-w100\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tv-model=\"description\"\n\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"bizproc-setuptemplateactivity-edit-constant-popup__footer\">\n\t\t\t\t<UiButton\n\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_SAVE')\"\n\t\t\t\t\t:size=\"ButtonSize.LARGE\"\n\t\t\t\t\t@click=\"onSave\"\n\t\t\t\t/>\n\t\t\t\t<UiButton\n\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_CANCEL')\"\n\t\t\t\t\t:style=\"AirButtonStyle.PLAIN\"\n\t\t\t\t\t:size=\"ButtonSize.LARGE\"\n\t\t\t\t\t@click=\"onCancel\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline, Main } from 'ui.icon-set.api.core';\nimport { EventEmitter } from 'main.core.events';\nimport { EditConstantPopupForm } from '../edit-constant-popup-form/edit-constant-popup-form';\nimport './constant-field.css';\n\n// @vue/component\nexport const ConstantField = {\n\tname: 'ConstantField',\n\tcomponents: {\n\t\tBIcon,\n\t\tEditConstantPopupForm,\n\t},\n\tinject: ['editSlider'],\n\tprops: {\n\t\t/** @type TitleItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\t/** Record<string, string> */\n\t\tfieldTypeNames: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['delete', 'updateItemProperty', 'edit'],\n\tsetup(): { [string]: string }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tMain,\n\t\t};\n\t},\n\tdata(): { isEdit: boolean }\n\t{\n\t\treturn {\n\t\t\tisEdit: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttypeLabel(): string\n\t\t{\n\t\t\treturn this.fieldTypeNames[this.item.constantType]\n\t\t\t\t?? this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_ITEM_TYPE_UNSUPPORTED')\n\t\t\t;\n\t\t},\n\t\ttitleWithType(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_ITEM_TITLE', {\n\t\t\t\t'#NAME#': this.item.name,\n\t\t\t\t'#TYPE#': this.typeLabel,\n\t\t\t});\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tEventEmitter.subscribe('Bitrix24.Slider:onClose', this.handleClosePopup);\n\t},\n\tunmounted(): void\n\t{\n\t\tEventEmitter.unsubscribe('Bitrix24.Slider:onClose', this.handleClosePopup);\n\t},\n\tmethods: {\n\t\thandleClosePopup(): void\n\t\t{\n\t\t\tthis.isEdit = false;\n\t\t},\n\t\tonInput(event: Event): void\n\t\t{\n\t\t\tconst payload: UpdateItemPropertyEventPayload = {\n\t\t\t\tpropertyValues: {\n\t\t\t\t\tdefault: event.target.value,\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.$emit('updateItemProperty', payload);\n\t\t},\n\t\tonUpdateItem(payload): void\n\t\t{\n\t\t\tthis.$emit('updateItemProperty', payload);\n\t\t},\n\t\tonEdit(): void\n\t\t{\n\t\t\tthis?.editSlider?.open();\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.isEdit = true;\n\t\t\t});\n\t\t},\n\t\thandleDragStart(event: Event): void\n\t\t{\n\t\t\tthis.$emit('itemDragStart', {\n\t\t\t\tevent,\n\t\t\t\telement: this.$el,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bizproc-setuptemplateactivity-field-wrapper\">\n\t\t\t<div\n\t\t\t\tclass=\"bizproc-setuptemplateactivity-field-drag-icon\"\n\t\t\t\t@mousedown.prevent=\"handleDragStart\"\n\t\t\t>\n\t\t\t\t<BIcon :name=\"Main.MORE_POINTS\" :size=\"18\"/>\n\t\t\t</div>\n\t\t\t<div class=\"bizproc-setuptemplateactivity-constant-edit\">\n\t\t\t\t<div class=\"bizproc-setuptemplateactivity-constant-edit__wrap\">\n\t\t\t\t\t<div class=\"bizproc-setuptemplateactivity-constant-edit__input-control ui-ctl-container\">\n\t\t\t\t\t\t<div class=\"ui-ctl-top\">\n\t\t\t\t\t\t\t<div class=\"ui-ctl-title\">\n\t\t\t\t\t\t\t\t{{ titleWithType }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t:value=\"item.default\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t@input=\"onInput\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bizproc-setuptemplateactivity-constant-edit__btn-control\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"Outline.EDIT_L\"\n\t\t\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t\t\tclass=\"bizproc-setuptemplateactivity-constant-edit__control-icon\"\n\t\t\t\t\t\t\t@click=\"onEdit\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"Outline.CROSS_L\"\n\t\t\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t\t\tclass=\"bizproc-setuptemplateactivity-constant-edit__control-icon\"\n\t\t\t\t\t\t\t@click=\"$emit('delete')\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\n\t\t\t<Teleport\n\t\t\t\tto=\"#bizproc-setuptemplateactivity-popup-content\"\n\t\t\t>\n\t\t\t\t<EditConstantPopupForm\n\t\t\t\t\tv-if=\"isEdit\"\n\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t:fieldTypeNames=\"fieldTypeNames\"\n\t\t\t\t\t@update:item=\"onUpdateItem\"\n\t\t\t\t/>\n\t\t\t</Teleport>\n\t\t</div>\n\t`,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline, Main } from 'ui.icon-set.api.core';\nimport { BMenu } from 'ui.system.menu.vue';\n\nimport { UpdateItemPropertyEventPayload } from '../../types';\nimport { PRESET_TITLE_ICONS } from '../../constants';\n\nimport './title-icon-field.css';\n\n// eslint-disable-next-line no-unused-vars\nimport type { TitleWithIconItem } from '../../types';\nimport type { MenuOptions } from 'ui.system.menu';\n\n// @vue/component\nexport const TitleIconField = {\n\tname: 'TitleIconField',\n\tcomponents: {\n\t\tBIcon,\n\t\tBMenu,\n\t},\n\tprops: {\n\t\t/** @type TitleWithIconItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['updateItemProperty', 'delete'],\n\tsetup(): { [string]: string }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tMain,\n\t\t};\n\t},\n\tdata(): { isMenuShown: boolean }\n\t{\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tcurrentIconCssClass(): string\n\t\t{\n\t\t\treturn PRESET_TITLE_ICONS[this.item.icon] || PRESET_TITLE_ICONS.IMAGE;\n\t\t},\n\t\tmenuOptions(): MenuOptions\n\t\t{\n\t\t\tconst menuItems = Object.entries(PRESET_TITLE_ICONS).map(([iconKey, iconClass]) => {\n\t\t\t\treturn {\n\t\t\t\t\ticon: iconClass,\n\t\t\t\t\ttitle: ' ',\n\t\t\t\t\tonClick: () => this.selectIcon(iconKey),\n\t\t\t\t};\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\tbindElement: this.$refs.iconTrigger,\n\t\t\t\tcacheable: false,\n\t\t\t\tangle: true,\n\t\t\t\toffsetLeft: 25,\n\t\t\t\tclassName: 'bizproc-setuptemplateactivity-title-field__icon-menu',\n\t\t\t\titems: menuItems,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonInput(event: Event): void\n\t\t{\n\t\t\tconst payload: UpdateItemPropertyEventPayload = {\n\t\t\t\tpropertyValues: {\n\t\t\t\t\ttext: event.target.value,\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.$emit('updateItemProperty', payload);\n\t\t},\n\t\tselectIcon(iconKey: string): void\n\t\t{\n\t\t\tconst payload: UpdateItemPropertyEventPayload = {\n\t\t\t\tpropertyValues: {\n\t\t\t\t\ticon: iconKey,\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.$emit('updateItemProperty', payload);\n\t\t},\n\t\thandleDragStart(event: Event): void\n\t\t{\n\t\t\tthis.$emit('itemDragStart', {\n\t\t\t\tevent,\n\t\t\t\telement: this.$el,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"bizproc-setuptemplateactivity-field-wrapper\">\n\t\t\t<div\n\t\t\t\tclass=\"bizproc-setuptemplateactivity-field-drag-icon\"\n\t\t\t\t@mousedown.prevent=\"handleDragStart\"\n\t\t\t>\n\t\t\t\t<BIcon :name=\"Main.MORE_POINTS\" :size=\"18\"/>\n\t\t\t</div>\n\t\t\t<div class=\"bizproc-setuptemplateactivity-title-field\">\n\t\t\t\t<div class=\"ui-ctl-container\">\n\t\t\t\t\t<div class=\"ui-ctl-top\">\n\t\t\t\t\t\t<div class=\"ui-ctl-title bizproc-setuptemplateactivity-title-field__label\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_ICON_TITLE_ITEM_LABEL') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bizproc-setuptemplateactivity-title-field__container\">\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown bizproc-setuptemplateactivity-title-field__icon-selector\"\n\t\t\t\t\t\t\t @click=\"isMenuShown = true\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div ref=\"iconTrigger\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t\t<i class=\"ui-icon-set --custom\" :class=\"'--' + currentIconCssClass\"></i>\n\t\t\t\t\t\t\t\t<i class=\"ui-icon-set --chevron-down-m\"></i>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t:value=\"item.text\"\n\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t@input=\"onInput\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bizproc-setuptemplateactivity-title-field__controls\">\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\t:name=\"Outline.CROSS_L\"\n\t\t\t\t\t\t:size=\"18\"\n\t\t\t\t\t\tclass=\"bizproc-setuptemplateactivity-title-field__delete-icon\"\n\t\t\t\t\t\t@click=\"$emit('delete')\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<BMenu\n\t\t\t\t\tv-if=\"isMenuShown\"\n\t\t\t\t\t:options=\"menuOptions\"\n\t\t\t\t\t@close=\"isMenuShown = false\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import './preview-layout.css';\n\n// @vue/component\nexport const PreviewLayout = {\n\tname: 'PreviewLayout',\n\ttemplate: `\n\t\t<div class=\"bizproc-setuptemplateactivity-preview-layout\">\n\t\t\t<div class=\"bizproc-setuptemplateactivity-preview-layout__container\">\n\t\t\t\t<div class=\"bizproc-setuptemplateactivity-preview-layout__header\">\n\t\t\t\t\t<slot name=\"header\"/>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"bizproc-setuptemplateactivity-preview-layout__content\">\n\t\t\t\t\t<slot/>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"bizproc-setuptemplateactivity-preview-layout__footer\">\n\t\t\t\t<slot name=\"footer\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import './preview-header.css';\n\n// @vue/component\nexport const PreviewHeader = {\n\tname: 'PreviewHeader',\n\ttemplate: `\n\t\t<header class=\"bizproc-setuptemplateactivity-preview-header\">\n\t\t\t<h3 class=\"bizproc-setuptemplateactivity-preview-header__title\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_PREVIEW_HEADER_TITLE') }}\n\t\t\t\t<span class=\"bizproc-setuptemplateactivity-preview-header__tag-preview\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_PREVIEW_HEADER_TAG') }}\n\t\t\t\t</span>\n\t\t\t</h3>\n\t\t\t<div class=\"bizproc-setuptemplateactivity-preview-header__line\"></div>\n\t\t</header>\n\t`,\n};\n","import './preview-block.css';\n\n// @vue/component\nexport const PreviewBlock = {\n\tname: 'PreviewBlock',\n\tprops: {\n\t\tisEmpty: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"bizproc-setuptemplateactivity-preview-block\"\n\t\t\t:class=\"{ '--empty': isEmpty }\"\n\t\t>\n\t\t\t<slot/>\n\t\t</div>\n\t`,\n};\n","import {\n\tButton as UiButton,\n\tAirButtonStyle,\n\tButtonSize,\n} from 'ui.vue3.components.button';\nimport { PreviewLayout } from '../preview-layout/preview-layout';\nimport { PreviewHeader } from '../preview-header/preview-header';\nimport { PreviewBlock } from '../preview-block/preview-block';\nimport { FormElement } from 'bizproc.setup-template';\nimport { ITEM_TYPES } from '../../constants';\n// eslint-disable-next-line no-unused-vars\nimport type { Block } from '../../types';\n\n// @vue/component\nexport const PreviewApp = {\n\tname: 'PreviewApp',\n\tcomponents: {\n\t\tUiButton,\n\t\tPreviewLayout,\n\t\tPreviewHeader,\n\t\tPreviewBlock,\n\t\tFormElement,\n\t},\n\tprops: {\n\t\t/** @type Array<Block> */\n\t\tblocks: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t},\n\tsetup(): { [string]: string }\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t\tButtonSize,\n\t\t};\n\t},\n\tcomputed: {\n\t\tformData(): { [string]: any }\n\t\t{\n\t\t\treturn this.blocks\n\t\t\t\t.reduce((acc: { [string]: any }, block) => {\n\t\t\t\t\tconst items = block.items\n\t\t\t\t\t\t.reduce((accItems, item) => {\n\t\t\t\t\t\t\tif (item.itemType === ITEM_TYPES.CONSTANT)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\taccItems[item.id] = item.default ?? '';\n\n\t\t\t\t\t\t\t\treturn accItems;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn accItems;\n\t\t\t\t\t\t}, {});\n\n\t\t\t\t\treturn { ...acc, ...items };\n\t\t\t\t}, {});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<PreviewLayout>\n\t\t\t<template #header>\n\t\t\t\t<PreviewHeader/>\n\t\t\t</template>\n\n\t\t\t<template #default>\n\t\t\t\t<PreviewBlock\n\t\t\t\t\tv-for=\"block in blocks\"\n\t\t\t\t\t:key=\"block.id\"\n\t\t\t\t\t:isEmpty=\"block.items.length === 0\"\n\t\t\t\t>\n\t\t\t\t\t<template #default>\n\t\t\t\t\t\t<FormElement\n\t\t\t\t\t\t\tv-for=\"item in block.items\"\n\t\t\t\t\t\t\t:key=\"item.id\"\n\t\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t\t:formData=\"formData\"\n\t\t\t\t\t\t\t:disabled=\"true\"\n\t\t\t\t\t\t\t:errors=\"{}\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</PreviewBlock>\n\t\t\t</template>\n\n\t\t\t<template #footer>\n\t\t\t\t<UiButton\n\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_PREVIEW_RUN_BTN')\"\n\t\t\t\t\t:disabled=\"true\"\n\t\t\t\t\t:size=\"ButtonSize.LARGE\"\n\t\t\t\t/>\n\t\t\t\t<UiButton\n\t\t\t\t\t:text=\"$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_PREVIEW_CANCEL_BTN')\"\n\t\t\t\t\t:disabled=\"true\"\n\t\t\t\t\t:style=\"AirButtonStyle.PLAIN\"\n\t\t\t\t\t:size=\"ButtonSize.LARGE\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</PreviewLayout>\n\t`,\n};\n","import { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Slider } from 'main.sidepanel';\n// eslint-disable-next-line no-unused-vars\nimport { markRaw, computed } from 'ui.vue3';\n\nimport { BlockComponent } from '../block/block';\nimport { AddBlockBtn } from '../add-block-btn/add-block-btn';\nimport { AddElementBtn } from '../add-element-btn/add-element-btn';\n\nimport { AppHeader } from '../app-header/app-header';\nimport { PreviewBtn } from '../preview-btn/preview-btn';\nimport { TitleField } from '../title-field/title-field';\nimport { DescriptionField } from '../description-field/description-field';\nimport { DelimiterField } from '../delimiter-field/delimiter-field';\nimport { ConstantField } from '../constant-field/constant-field';\nimport { TitleIconField } from '../title-icon-field/title-icon-field';\n\nimport { EditConstantPopupForm } from '../edit-constant-popup-form/edit-constant-popup-form';\n\nimport { PreviewApp } from '../preview-app/preview-app';\nimport { makeEmptyBlock, convertConstants } from '../../utils';\nimport { ITEM_TYPES } from '../../constants';\n\nimport './app.css';\nimport type {\n\tBlock,\n\tItem,\n\tUpdateItemPropertyEventPayload,\n\tConstantItem,\n} from '../../types';\n\nconst ACTIVITY_NAME = 'SetupTemplateActivity';\n\nconst ELEMENT_COMPONENTS = {\n\t[ITEM_TYPES.TITLE]: TitleField,\n\t[ITEM_TYPES.TITLE_WITH_ICON]: TitleIconField,\n\t[ITEM_TYPES.DESCRIPTION]: DescriptionField,\n\t[ITEM_TYPES.DELIMITER]: DelimiterField,\n\t[ITEM_TYPES.CONSTANT]: ConstantField,\n};\n\ntype ItemDragStartPayload = {\n\tevent: MouseEvent,\n\telement: HTMLElement,\n};\n\n// @vue/component\nexport const BlocksAppComponent = {\n\tname: 'BlocksAppComponent',\n\tcomponents: {\n\t\tBlockComponent,\n\t\tAddBlockBtn,\n\t\tAddElementBtn,\n\t\tAppHeader,\n\t\tPreviewBtn,\n\t\tTitleField,\n\t\tTitleIconField,\n\t\tDescriptionField,\n\t\tDelimiterField,\n\t\tConstantField,\n\t\tPreviewApp,\n\t\tEditConstantPopupForm,\n\t},\n\tprovide(): { sliderInstance: typeof Slider }\n\t{\n\t\treturn {\n\t\t\teditSlider: computed(() => this.sliderInstance),\n\t\t};\n\t},\n\tprops:\n\t{\n\t\tserializedBlocks: {\n\t\t\ttype: [String, null],\n\t\t\trequired: true,\n\t\t},\n\t\t/** Record<string, string> */\n\t\tfieldTypeNames: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): { blocks: Block[] }\n\t{\n\t\treturn {\n\t\t\tblocks: [],\n\t\t\tisShowPreview: false,\n\t\t\tsliderInstance: null,\n\t\t\tinitialConstantIds: null,\n\t\t\tcurrentBlockIndex: null,\n\t\t\tcreatedConstant: null,\n\t\t};\n\t},\n\tcomputed:\n\t{\n\t\tformValue(): string\n\t\t{\n\t\t\treturn JSON.stringify(this.blocks);\n\t\t},\n\t\tpreparedBlocks(): Block[]\n\t\t{\n\t\t\treturn this.blocks\n\t\t\t\t.map((block, index) => {\n\t\t\t\t\tconst items = block.items\n\t\t\t\t\t\t.map((item) => {\n\t\t\t\t\t\t\tif (!item.text && item.itemType === ITEM_TYPES.TITLE)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t...item,\n\t\t\t\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_TITLE_CONTENT'),\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!item.text && item.itemType === ITEM_TYPES.DESCRIPTION)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t...item,\n\t\t\t\t\t\t\t\t\ttext: this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_DESCRIPTION_CONTENT'),\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn { ...item };\n\t\t\t\t\t\t});\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...block,\n\t\t\t\t\t\titems,\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.initEditSlider();\n\t\tthis.blocks = JSON.parse(this.serializedBlocks) ?? [];\n\n\t\tthis.initialConstantIds = new Set(\n\t\t\tthis.blocks\n\t\t\t\t.flatMap((block) => block.items || [])\n\t\t\t\t.filter((item) => item?.itemType === ITEM_TYPES.CONSTANT && item.id)\n\t\t\t\t.map((item) => item.id),\n\t\t);\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClosing', this.onCancelConstant);\n\t\tEventEmitter.subscribe(\n\t\t\t'Bizproc.NodeSettings:nodeSettingsSaving',\n\t\t\tthis.onNodeSettingsSave,\n\t\t);\n\t\tEventEmitter.subscribe('Bizproc.SetupTemplate:Draggable:drop', this.onItemDrop);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.isShowPreview = false;\n\t\tEventEmitter.unsubscribe('SidePanel.Slider:onClosing', this.onCancelConstant);\n\t\tEventEmitter.unsubscribe('Bizproc.SetupTemplate:Draggable:drop', this.onItemDrop);\n\t\tthis.sliderInstance?.destroy();\n\t},\n\tunmounted()\n\t{\n\t\tEventEmitter.unsubscribe(\n\t\t\t'Bizproc.NodeSettings:nodeSettingsSaving',\n\t\t\tthis.onNodeSettingsSave,\n\t\t);\n\t},\n\tmethods:\n\t{\n\t\tinitEditSlider(): void\n\t\t{\n\t\t\tthis.sliderInstance = markRaw(new Slider('', {\n\t\t\t\tcontentCallback: () => this.$refs.bizprocSetupTemplateActivityPopup,\n\t\t\t\twidth: 596,\n\t\t\t\touterBoundary: {\n\t\t\t\t\tright: 8,\n\t\t\t\t\ttop: 64,\n\t\t\t\t},\n\t\t\t\tstartPosition: 'bottom',\n\t\t\t\toverlayClassName: 'bizproc-setuptemplateactivity-app__overlay',\n\t\t\t}));\n\t\t},\n\t\tonAddBlock(): void\n\t\t{\n\t\t\tthis.blocks.push(makeEmptyBlock());\n\t\t},\n\t\tonAddItem(blockIndex: number, item: Item): void\n\t\t{\n\t\t\tthis.blocks[blockIndex].items.push(item);\n\t\t},\n\t\tonCreateConstant(blockIndex: number, item: Item): void\n\t\t{\n\t\t\tthis.currentBlockIndex = blockIndex;\n\t\t\tthis.createdConstant = { ...item };\n\t\t\tthis.sliderInstance?.open();\n\t\t},\n\t\tonSaveConstant(blockIndex: number, item: Item): void\n\t\t{\n\t\t\tthis.blocks[blockIndex].items.push(item.propertyValues);\n\t\t\tthis.currentBlockIndex = null;\n\t\t\tthis.createdConstant = null;\n\t\t},\n\t\tonCancelConstant(): void\n\t\t{\n\t\t\tthis.currentBlockIndex = null;\n\t\t\tthis.createdConstant = null;\n\t\t},\n\t\tonDeleteBlock(blockIndex: number): void\n\t\t{\n\t\t\tthis.blocks.splice(blockIndex, 1);\n\t\t},\n\t\tonDeleteItem(blockIndex: number, itemIndex: number): void\n\t\t{\n\t\t\tthis.blocks[blockIndex].items.splice(itemIndex, 1);\n\t\t},\n\t\tonUpdateItemProperty(blockIndex: number, itemIndex: number, payload: UpdateItemPropertyEventPayload): void\n\t\t{\n\t\t\tfor (const [property: string, value] of Object.entries(payload.propertyValues))\n\t\t\t{\n\t\t\t\tthis.blocks[blockIndex].items[itemIndex][property] = value;\n\t\t\t}\n\t\t},\n\t\tonItemsReorder(blockIndex: number, newItems: Array<any>): void\n\t\t{\n\t\t\tthis.blocks[blockIndex].items = newItems;\n\t\t},\n\t\tgetElementComponent(type: string): { [string]: Object }\n\t\t{\n\t\t\treturn ELEMENT_COMPONENTS[type];\n\t\t},\n\t\tonToggleShowPreview(): void\n\t\t{\n\t\t\tthis.isShowPreview = !this.isShowPreview;\n\t\t\tEventEmitter.emit('BX.Bizproc:setuptemplateactivity:preview', this.isShowPreview);\n\t\t},\n\t\tonNodeSettingsSave(event): void\n\t\t{\n\t\t\tconst { formData } = event.getData();\n\n\t\t\tif (formData.activity !== ACTIVITY_NAME)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst currentConstants: ConstantItem[] = this.blocks\n\t\t\t\t.flatMap((block) => block.items || [])\n\t\t\t\t.filter((item) => item?.itemType === ITEM_TYPES.CONSTANT);\n\n\t\t\tconst currentConstantIds = new Set(currentConstants.map((item) => item.id));\n\t\t\tconst deletedConstantIds = [];\n\t\t\tfor (const initialId of this.initialConstantIds)\n\t\t\t{\n\t\t\t\tif (!currentConstantIds.has(initialId))\n\t\t\t\t{\n\t\t\t\t\tdeletedConstantIds.push(initialId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst constantsToUpdate = {};\n\t\t\tfor (const constant of currentConstants)\n\t\t\t{\n\t\t\t\tif (constant?.id)\n\t\t\t\t{\n\t\t\t\t\tconstantsToUpdate[constant.id] = convertConstants(constant);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tEventEmitter.emit('Bizproc:onConstantsUpdated', {\n\t\t\t\tconstantsToUpdate,\n\t\t\t\tdeletedConstantIds,\n\t\t\t});\n\n\t\t\tthis.initialConstantIds = currentConstantIds;\n\t\t},\n\t\tonItemDragStart(payload: ItemDragStartPayload, blockIndex: number, itemIndex: number): void\n\t\t{\n\t\t\tEventEmitter.emit('Bizproc.SetupTemplate:Draggable:start', {\n\t\t\t\t...payload,\n\t\t\t\tsourceBlockIndex: blockIndex,\n\t\t\t\tsourceItemIndex: itemIndex,\n\t\t\t});\n\t\t},\n\t\tonItemDrop(event: BaseEvent): void\n\t\t{\n\t\t\tconst payload = event.getData();\n\t\t\tconst { sourceBlockIndex, sourceItemIndex, targetBlockIndex, targetItemIndex } = payload;\n\n\t\t\tif (targetBlockIndex === null || targetItemIndex === null)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst newBlocks = JSON.parse(JSON.stringify(this.blocks));\n\t\t\tconst [movedItem] = newBlocks[sourceBlockIndex].items.splice(sourceItemIndex, 1);\n\t\t\tif (!movedItem)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet finalTargetIndex = targetItemIndex;\n\t\t\tif (sourceBlockIndex === targetBlockIndex && sourceItemIndex < targetItemIndex)\n\t\t\t{\n\t\t\t\tfinalTargetIndex--;\n\t\t\t}\n\n\t\t\tnewBlocks[targetBlockIndex].items.splice(finalTargetIndex, 0, movedItem);\n\n\t\t\tthis.blocks = newBlocks;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"bizproc-setuptemplateactivity-app\"\n\t\t\tid=\"bizproc-setuptemplateactivity-app\"\n\t\t\tref=\"setuptemplateactivity\"\n\t\t>\n\t\t\t<input\n\t\t\t\t:value=\"formValue\"\n\t\t\t\ttype=\"hidden\"\n\t\t\t\tid=\"id_blocks\"\n\t\t\t\tname=\"blocks\"\n\t\t\t/>\n\n\t\t\t<AppHeader>\n\t\t\t\t<template #preview-btn>\n\t\t\t\t\t<PreviewBtn\n\t\t\t\t\t\t:showPreview=\"isShowPreview\"\n\t\t\t\t\t\t@click=\"onToggleShowPreview\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</AppHeader>\n\n\t\t\t<div class=\"bizproc-setuptemplateactivity-app__blocks\">\n\t\t\t\t<BlockComponent\n\t\t\t\t\tv-for=\"(block, blockIndex) in blocks\"\n\t\t\t\t\t:key=\"block.id\"\n\t\t\t\t\t:position=\"blockIndex + 1\"\n\t\t\t\t\t:items=\"block.items\"\n\t\t\t\t\t:blockIndex=\"blockIndex\"\n\t\t\t\t\t@deleteBlock=\"onDeleteBlock(blockIndex)\"\n\t\t\t\t\t@update:items=\"onItemsReorder(blockIndex, $event)\"\n\t\t\t\t>\n\t\t\t\t\t<template #item=\"{ item, itemIndex }\">\n\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t:is=\"getElementComponent(item.itemType)\"\n\t\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t\t:fieldTypeNames=\"fieldTypeNames\"\n\t\t\t\t\t\t\t@delete=\"onDeleteItem(blockIndex, itemIndex)\"\n\t\t\t\t\t\t\t@updateItemProperty=\"onUpdateItemProperty(blockIndex, itemIndex, $event)\"\n\t\t\t\t\t\t\t@itemDragStart=\"onItemDragStart($event, blockIndex, itemIndex)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template #footer>\n\t\t\t\t\t\t<AddElementBtn\n\t\t\t\t\t\t\t@add:element=\"onAddItem(blockIndex, $event)\"\n\t\t\t\t\t\t\t@create:constant=\"onCreateConstant(blockIndex, $event)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</BlockComponent>\n\t\t\t\t<AddBlockBtn @click=\"onAddBlock\"/>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div\n\t\t\tclass=\"bizproc-setuptemplateactivity-app__popup\"\n\t\t\tref=\"bizprocSetupTemplateActivityPopup\"\n\t\t>\n\t\t\t<div\n\t\t\t\tid=\"bizproc-setuptemplateactivity-popup-content\"\n\t\t\t\tclass=\"bizproc-setuptemplateactivity-app__popup-content\"\n\t\t\t>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<Teleport\n\t\t\tto=\"#preview-panel\"\n\t\t\t:disabled=\"!isShowPreview\"\n\t\t>\n\t\t\t<PreviewApp\n\t\t\t\tv-if=\"isShowPreview\"\n\t\t\t\t:blocks=\"preparedBlocks\"\n\t\t\t/>\n\t\t</Teleport>\n\n\t\t<Teleport\n\t\t\tto=\"#bizproc-setuptemplateactivity-popup-content\"\n\t\t\t:disabled=\"!createdConstant\"\n\t\t>\n\t\t\t<EditConstantPopupForm\n\t\t\t\tv-if=\"createdConstant !== null\"\n\t\t\t\t:item=\"createdConstant\"\n\t\t\t\t:fieldTypeNames=\"fieldTypeNames\"\n\t\t\t\t@update:item=\"onSaveConstant(currentBlockIndex, $event)\"\n\t\t\t\t@cancel=\"onCancelConstant\"\n\t\t\t/>\n\t\t</Teleport>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\nimport { BitrixVue } from 'ui.vue3';\nimport { BlocksAppComponent } from './component/app/app';\nimport { generateConstantId } from './utils';\n\nexport class SetupTemplateActivity extends EventEmitter\n{\n\t#app: null;\n\t#currentValues: Object;\n\t#blocksElement: ?(HTMLDivElement | HTMLTableElement);\n\t#fieldTypeNames: Record<string, string>;\n\n\tconstructor(parameters: {\n\t\tcurrentValues: Object,\n\t\tdomElementId: string,\n\t\tfieldTypeNames: Record<string, string>,\n\t\tpreviewComponent: {...},\n\t})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bizproc.Activity');\n\t\tthis.#currentValues = parameters.currentValues;\n\t\tthis.#blocksElement = document.getElementById(parameters.domElementId);\n\t\tthis.#fieldTypeNames = parameters.fieldTypeNames;\n\t}\n\n\t#getBlocks(): string\n\t{\n\t\tconst blocks = JSON.parse(this.#currentValues?.blocks) ?? [];\n\n\t\tblocks.forEach((block) => {\n\t\t\tblock.id = generateConstantId();\n\n\t\t\tblock.items.forEach((item) => {\n\t\t\t\tif (!item?.id)\n\t\t\t\t{\n\t\t\t\t\titem.id = generateConstantId();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\treturn JSON.stringify(blocks);\n\t}\n\n\tunmount(): void\n\t{\n\t\tthis.#app?.unmount();\n\t}\n\n\tinit(): void\n\t{\n\t\tthis.#app = BitrixVue.createApp(BlocksAppComponent, {\n\t\t\tserializedBlocks: this.#getBlocks(),\n\t\t\tfieldTypeNames: this.#fieldTypeNames,\n\t\t});\n\t\tthis.#app.mount(this.#blocksElement);\n\t}\n}\n"],"names":["DraggableContainer","name","props","items","type","Array","required","blockIndex","Number","emits","data","isDragging","dropTargetIndex","dragState","sourceBlockIndex","draggedItemIndex","draggedElement","ghostElement","offsetX","offsetY","lastTargetBlockIndex","lastTargetItemIndex","computed","created","boundHandleDragMove","handleDragMove","bind","boundHandleDragEnd","handleDragEnd","EventEmitter","subscribe","onGlobalDragStart","onGlobalDragOver","onGlobalDragEnd","beforeUnmount","unsubscribe","methods","e","payload","getData","sourceItemIndex","event","element","preventDefault","createGhost","Dom","addClass","document","body","Event","targetBlockIndex","targetItemIndex","updateGhostPosition","result","elementUnderCursor","elementFromPoint","clientX","clientY","container","closest","parseInt","dataset","allItems","querySelectorAll","closestItem","rect","getBoundingClientRect","isAfter","top","height","index","indexOf","length","emit","resetDragState","removeClass","remove","unbind","style","left","ghost","cloneNode","width","append","template","BlockComponent","components","BIcon","position","setup","Outline","title","$Bitrix","Loc","getMessage","onItemsUpdate","newItems","$emit","showDropPlaceholder","dnd","itemIndex","showFinalDropPlaceholder","AddBlockBtn","ITEM_TYPES","Object","freeze","DELIMITER","TITLE","TITLE_WITH_ICON","ICON_TITLE","DESCRIPTION","CONSTANT","CONSTANT_TYPES","STRING","INT","USER","FILE","TEXT","SELECT","DELIMITER_TYPES","LINE","CONSTANT_ID_PREFIX","PRESET_TITLE_ICONS","IMAGE","ATTACH","SETTINGS","STARS","makeEmptyBlock","id","generateConstantId","makeEmptyDelimiter","itemType","delimiterType","makeEmptyTitle","text","makeEmptyTitleWithIcon","icon","makeEmptyDescription","makeEmptyConstant","constantType","multiple","description","default","options","convertConstants","constant","Name","Description","Type","Required","Multiple","Options","Default","generateRandomString","characters","charactersLength","i","charAt","Math","floor","random","AddElementBtn","BMenu","isMenuShown","offsetLeft","menuOptions","bindElement","$refs","addElementButton","fixed","cacheable","onClick","onShowMenu","abs","AppHeader","PreviewBtn","showPreview","Boolean","CROSSED_EYE","OBSERVER","label","TitleField","item","Main","onInput","propertyValues","target","value","handleDragStart","$el","DescriptionField","DelimiterField","onSelect","EditConstantPopupForm","UiButton","inject","fieldTypeNames","AirButtonStyle","ButtonSize","defaultValue","errors","map","isSelectType","errorMessages","watch","onAddOption","push","onDeleteOption","splice","validateName","isStringFilled","trim","validateOption","validateOptions","errorsCount","forEach","option","resetErrors","onSave","isValid","every","editSlider","close","onCancel","ConstantField","isEdit","typeLabel","titleWithType","handleClosePopup","unmounted","onUpdateItem","onEdit","open","$nextTick","TitleIconField","currentIconCssClass","menuItems","entries","iconKey","iconClass","selectIcon","iconTrigger","angle","className","PreviewLayout","PreviewHeader","PreviewBlock","isEmpty","PreviewApp","FormElement","blocks","formData","reduce","acc","block","accItems","ACTIVITY_NAME","ELEMENT_COMPONENTS","BlocksAppComponent","provide","sliderInstance","serializedBlocks","String","isShowPreview","initialConstantIds","currentBlockIndex","createdConstant","formValue","JSON","stringify","preparedBlocks","mounted","initEditSlider","parse","Set","flatMap","filter","onCancelConstant","onNodeSettingsSave","onItemDrop","destroy","markRaw","Slider","contentCallback","bizprocSetupTemplateActivityPopup","outerBoundary","right","startPosition","overlayClassName","onAddBlock","onAddItem","onCreateConstant","onSaveConstant","onDeleteBlock","onDeleteItem","onUpdateItemProperty","property","onItemsReorder","getElementComponent","onToggleShowPreview","activity","currentConstants","currentConstantIds","deletedConstantIds","initialId","has","constantsToUpdate","onItemDragStart","newBlocks","movedItem","finalTargetIndex","SetupTemplateActivity","constructor","parameters","setEventNamespace","currentValues","getElementById","domElementId","unmount","init","BitrixVue","createApp","mount"],"mappings":"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"}