{"version":3,"file":"script.js","sources":["src/constants.js","src/utils.js","src/component/item/constant-edit.js","src/component/item/constant.js","src/component/item/delimiter.js","src/component/item/description.js","src/component/item/title.js","src/component/item.js","src/component/block.js","src/component/app.js","src/index.js"],"sourcesContent":["import type { ConstantType, DelimiterType, ItemType } from './types';\n\nexport const ITEM_TYPES: Record<string, ItemType> = Object.freeze({\n\tDELIMITER: 'delimiter',\n\tTITLE: 'title',\n\tDESCRIPTION: 'description',\n\tCONSTANT: 'constant',\n});\n\nexport const CONSTANT_TYPES: Record<string, ConstantType> = Object.freeze({\n\tSTRING: 'string',\n\tINT: 'int',\n\tUSER: 'user',\n\tFILE: 'file',\n});\n\nexport const DELIMITER_TYPES: Record<string, DelimiterType> = Object.freeze({\n\tLINE: 'line',\n});\n\nexport const CONSTANT_ID_PREFIX = 'SetupTemplateActivity_';\n","import { CONSTANT_ID_PREFIX, CONSTANT_TYPES, DELIMITER_TYPES, ITEM_TYPES } from './constants';\nimport type { ConstantItem, DelimiterItem, DescriptionItem, TitleItem, ConstantConvertedData } from './types';\n\nexport function makeEmptyDelimiter(): DelimiterItem\n{\n\treturn {\n\t\titemType: ITEM_TYPES.DELIMITER,\n\t\tdelimiterType: DELIMITER_TYPES.LINE,\n\t};\n}\n\nexport function makeEmptyTitle(): TitleItem\n{\n\treturn {\n\t\titemType: ITEM_TYPES.TITLE,\n\t\ttext: '',\n\t};\n}\n\nexport function makeEmptyDescription(): DescriptionItem\n{\n\treturn {\n\t\titemType: ITEM_TYPES.DESCRIPTION,\n\t\ttext: '',\n\t};\n}\n\nexport function makeEmptyConstant(): ConstantItem\n{\n\treturn {\n\t\titemType: ITEM_TYPES.CONSTANT,\n\t\tid: generateConstantId(),\n\t\tname: '',\n\t\tconstantType: CONSTANT_TYPES.STRING,\n\t\tmultiple: false,\n\t\tdescription: '',\n\t\tdefault: '',\n\t\toptions: [],\n\t\trequired: false,\n\t};\n}\n\nexport function convertConstants(constant: ConstantItem): ConstantConvertedData\n{\n\treturn {\n\t\tName: constant.name,\n\t\tDescription: constant.description,\n\t\tType: constant.constantType,\n\t\tRequired: 0,\n\t\tMultiple: constant.multiple ? 1 : 0,\n\t\tOptions: (constant.options && constant.options.length > 0) ? constant.options : null,\n\t\tDefault: constant.default,\n\t};\n}\n\nfunction generateRandomString(length: number): string\n{\n\tconst characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\tlet result = '';\n\tconst charactersLength = characters.length;\n\tfor (let i = 0; i < length; i++)\n\t{\n\t\tresult += characters.charAt(Math.floor(Math.random() * charactersLength));\n\t}\n\n\treturn result;\n}\n\nfunction generateConstantId(): string\n{\n\treturn CONSTANT_ID_PREFIX + generateRandomString(10);\n}\n","// eslint-disable-next-line no-unused-vars\nimport { $Bitrix } from 'ui.vue3';\nimport { UpdateItemPropertyEventPayload } from '../../types';\n// eslint-disable-next-line no-unused-vars\nimport type { ConstantItem } from '../../types';\nimport { CONSTANT_TYPES } from '../../constants';\n\n// @vue/component\nexport const ConstantEditComponent = {\n\tname: 'ConstantEditComponent',\n\tprops: {\n\t\t/** @type ConstantItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\t/** Record<string, string> */\n\t\tfieldTypeNames: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['update', 'cancel'],\n\tdata(): { type: string, name: string, multiple: boolean, required: boolean, highlighted: Array<string> }\n\t{\n\t\treturn {\n\t\t\ttype: this.item?.constantType ?? CONSTANT_TYPES.STRING,\n\t\t\tname: this.item?.name ?? '',\n\t\t\tmultiple: this.item?.multiple ?? false,\n\t\t\trequired: this.item?.required ?? false,\n\t\t\tnameInvalid: false,\n\t\t};\n\t},\n\twatch: {\n\t\tname(value: string): void\n\t\t{\n\t\t\tif (value !== '')\n\t\t\t{\n\t\t\t\tthis.nameInvalid = false;\n\t\t\t}\n\t\t},\n\t},\n\tmethods:\n\t{\n\t\tonOk(): void\n\t\t{\n\t\t\tif (this.name === '')\n\t\t\t{\n\t\t\t\tthis.nameInvalid = true;\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.nameInvalid = false;\n\n\t\t\tconst payload: UpdateItemPropertyEventPayload = {\n\t\t\t\tpropertyValues: {\n\t\t\t\t\tconstantType: this.type,\n\t\t\t\t\tname: this.name,\n\t\t\t\t\tmultiple: this.multiple,\n\t\t\t\t\trequired: this.required,\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tthis.$emit('update', payload);\n\t\t},\n\t\tonCancel(): void\n\t\t{\n\t\t\tthis.$emit('cancel');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<div>\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_HEADING') }}\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<label>\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_NAME_LABEL') }}\n\t\t\t\t\t<br>\n\t\t\t\t\t<input v-model.trim=\"name\" type=\"text\" :class=\"{'has-error': this.nameInvalid }\"/>\n\t\t\t\t</label>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<label>\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_TYPE_LABEL') }}\n\t\t\t\t\t<br>\n\t\t\t\t\t<select v-model=\"type\">\n\t\t\t\t\t\t<option v-for=\"(typeName, typeKey) in fieldTypeNames\" :value=\"typeKey\" :key=\"typeKey\">\n\t\t\t\t\t\t\t{{ typeName }}\n\t\t\t\t\t\t</option>\n\t\t\t\t\t</select>\n\t\t\t\t</label>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<label>\n\t\t\t\t\t<input v-model=\"multiple\" type=\"checkbox\"/>\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_MULTIPLE_LABEL') }}\n\t\n\t\t\t\t</label>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<label>\n\t\t\t\t\t<input v-model=\"required\" type=\"checkbox\"/>\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_REQUIRED_LABEL') }}\n\t\t\t\t</label>\n\t\t\t</div>\n\t\n\t\t\t<div>\n\t\t\t\t<button type=\"button\" @click=\"onOk\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_OK') }}\n\t\t\t\t</button>\n\n\t\t\t\t<button type=\"button\" @click=\"onCancel\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT_CANCEL') }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","// eslint-disable-next-line no-unused-vars\nimport { $Bitrix } from 'ui.vue3';\nimport { UpdateItemPropertyEventPayload } from '../../types';\n// eslint-disable-next-line no-unused-vars\nimport type { ConstantItem } from '../../types';\nimport { ConstantEditComponent } from './constant-edit';\n\n// @vue/component\nexport const ConstantComponent = {\n\tname: 'ConstantComponent',\n\tcomponents: { ConstantEditComponent },\n\tprops: {\n\t\t/** @type ConstantItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\t/** Record<string, string> */\n\t\tfieldTypeNames: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['updateItemProperty', 'cancelItem'],\n\tdata(): { editMode: boolean }\n\t{\n\t\treturn {\n\t\t\teditMode: this.item.name === '',\n\t\t};\n\t},\n\tcomputed: {\n\t\ttypeLabel(): string\n\t\t{\n\t\t\treturn this.fieldTypeNames[this.item.constantType]\n\t\t\t\t?? this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_ITEM_TYPE_UNSUPPORTED')\n\t\t\t;\n\t\t},\n\t\ttitleWithType(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_ITEM_TITLE', {\n\t\t\t\t'#NAME#': this.item.name,\n\t\t\t\t'#TYPE#': this.typeLabel,\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tonInput(event: Event): void\n\t\t{\n\t\t\tconst payload: UpdateItemPropertyEventPayload = {\n\t\t\t\tpropertyValues: {\n\t\t\t\t\tdefault: event.target.value,\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.$emit('updateItemProperty', payload);\n\t\t},\n\t\tonEdit(): void\n\t\t{\n\t\t\tthis.editMode = true;\n\t\t},\n\t\tonEditCancel(): void\n\t\t{\n\t\t\tthis.editMode = false;\n\t\t\tif (this.item.name === '')\n\t\t\t{\n\t\t\t\tthis.$emit('cancelItem');\n\t\t\t}\n\t\t},\n\t\tonEditUpdate(payload: UpdateItemPropertyEventPayload): void\n\t\t{\n\t\t\tthis.editMode = false;\n\t\t\tthis.$emit('updateItemProperty', payload);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<div v-if=\"!editMode\">\n\t\t\t\t<div>\n\t\t\t\t\t{{ titleWithType }}\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<input type=\"text\" :value=\"item.default\" @input=\"onInput\">\n\t\t\t\t</div>\n\t\t\t\t<button type=\"button\" @click=\"onEdit\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_EDIT') }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<ConstantEditComponent\n\t\t\t\tv-if=\"editMode\"\n\t\t\t\t:item=\"item\"\n\t\t\t \t:fieldTypeNames=\"fieldTypeNames\"\n\t\t\t\t@cancel=\"onEditCancel\"\n\t\t\t\t@update=\"onEditUpdate\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","// eslint-disable-next-line no-unused-vars\nimport { $Bitrix } from 'ui.vue3';\nimport { UpdateItemPropertyEventPayload } from '../../types';\n// eslint-disable-next-line no-unused-vars\nimport type { DelimiterItem } from '../../types';\n\n// @vue/component\nexport const DelimiterComponent = {\n\tname: 'DelimiterComponent',\n\tprops: {\n\t\t/** @type DelimiterItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['updateItemProperty'],\n\tmethods: {\n\t\tonSelect(event: Event): void\n\t\t{\n\t\t\tconst payload: UpdateItemPropertyEventPayload = {\n\t\t\t\tpropertyValues: {\n\t\t\t\t\tdelimiterType: event.target.value,\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.$emit('updateItemProperty', payload);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<div>\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_DELIMITER_ITEM_LABEL') }}\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<select :value=\"item.delimiterType\" @change=\"onSelect\">\n\t\t\t\t\t<option value=\"line\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_DELIMITER_ITEM_OPTION_LINE') }}\n\t\t\t\t\t</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","// eslint-disable-next-line no-unused-vars\nimport { $Bitrix } from 'ui.vue3';\nimport { UpdateItemPropertyEventPayload } from '../../types';\n// eslint-disable-next-line no-unused-vars\nimport type { DescriptionItem } from '../../types';\n\n// @vue/component\nexport const DescriptionComponent = {\n\tname: 'DescriptionComponent',\n\tprops: {\n\t\t/** @type DescriptionItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['updateItemProperty'],\n\tmethods: {\n\t\tonInput(event: Event): void\n\t\t{\n\t\t\tconst payload: UpdateItemPropertyEventPayload = {\n\t\t\t\tpropertyValues: {\n\t\t\t\t\ttext: event.target.value,\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.$emit('updateItemProperty', payload);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<div>\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_DESCRIPTION_ITEM_LABEL') }}\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<textarea :value=\"item.text\" @input=\"onInput\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","// eslint-disable-next-line no-unused-vars\nimport { $Bitrix } from 'ui.vue3';\nimport { UpdateItemPropertyEventPayload } from '../../types';\n// eslint-disable-next-line no-unused-vars\nimport type { TitleItem } from '../../types';\n\n// @vue/component\nexport const TitleComponent = {\n\tname: 'TitleComponent',\n\tprops: {\n\t\t/** @type TitleItem */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['updateItemProperty'],\n\tmethods: {\n\t\tonInput(event: Event): void\n\t\t{\n\t\t\tconst payload: UpdateItemPropertyEventPayload = {\n\t\t\t\tpropertyValues: {\n\t\t\t\t\ttext: event.target.value,\n\t\t\t\t},\n\t\t\t};\n\t\t\tthis.$emit('updateItemProperty', payload);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<div>\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_TITLE_ITEM_LABEL') }}\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<input type=\"text\" :value=\"item.text\" @input=\"onInput\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","// eslint-disable-next-line no-unused-vars\nimport { $Bitrix } from 'ui.vue3';\nimport { ITEM_TYPES } from '../constants';\n// eslint-disable-next-line no-unused-vars\nimport type { Item, UpdateItemPropertyEventPayload } from '../types';\nimport { ConstantComponent } from './item/constant';\nimport { DelimiterComponent } from './item/delimiter';\nimport { DescriptionComponent } from './item/description';\nimport { TitleComponent } from './item/title';\n\n// @vue/component\nexport const ItemComponent = {\n\tname: 'ItemComponent',\n\tcomponents: {\n\t\tTitleComponent,\n\t\tDelimiterComponent,\n\t\tDescriptionComponent,\n\t\tConstantComponent,\n\t},\n\tprops: {\n\t\t/** @type Item */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\t/** Record<string, string> */\n\t\tfieldTypeNames: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['deleteItem', 'updateItemProperty'],\n\tcomputed: {\n\t\ttype(): string\n\t\t{\n\t\t\treturn this.item.itemType;\n\t\t},\n\t\tisItemTitle(): boolean\n\t\t{\n\t\t\treturn this.type === ITEM_TYPES.TITLE;\n\t\t},\n\t\tisItemDelimiter(): boolean\n\t\t{\n\t\t\treturn this.type === ITEM_TYPES.DELIMITER;\n\t\t},\n\t\tisItemDescription(): boolean\n\t\t{\n\t\t\treturn this.type === ITEM_TYPES.DESCRIPTION;\n\t\t},\n\t\tisItemConstant(): boolean\n\t\t{\n\t\t\treturn this.type === ITEM_TYPES.CONSTANT;\n\t\t},\n\t},\n\tmethods: {\n\t\tdeleteItem(): void\n\t\t{\n\t\t\tthis.$emit('deleteItem');\n\t\t},\n\t\tonUpdateItemProperty(payload: UpdateItemPropertyEventPayload): void\n\t\t{\n\t\t\tthis.$emit('updateItemProperty', payload);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<TitleComponent \n\t\t\t\tv-if=\"isItemTitle\"\n\t\t\t\t:item=\"item\" \n\t\t\t\t@updateItemProperty=\"onUpdateItemProperty\"\n\t\t\t/>\n\t\t\t<DescriptionComponent\n\t\t\t\tv-if=\"isItemDescription\"\n\t\t\t\t:item=\"item\"\n\t\t\t\t@updateItemProperty=\"onUpdateItemProperty\"\n\t\t\t/>\n\t\t\t<DelimiterComponent\n\t\t\t\tv-if=\"isItemDelimiter\"\n\t\t\t\t:item=\"item\"\n\t\t\t\t@updateItemProperty=\"onUpdateItemProperty\"\n\t\t\t/>\n\t\t\t<ConstantComponent\n\t\t\t\tv-if=\"isItemConstant\"\n\t\t\t\t:item=\"item\"\n\t\t\t\t:fieldTypeNames=\"fieldTypeNames\"\n\t\t\t\t@updateItemProperty=\"onUpdateItemProperty\"\n\t\t\t\t@cancelItem=\"deleteItem\"\n\t\t\t/>\n\t\t\t<button @click=\"deleteItem\" type=\"button\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_DELETE') }}\n\t\t\t</button>\n\t\t</div>\n\t`,\n};\n","import { BMenu } from 'ui.system.menu.vue';\nimport type { MenuOptions } from 'ui.system.menu';\n// eslint-disable-next-line no-unused-vars\nimport { $Bitrix } from 'ui.vue';\nimport type { Item, UpdateItemPropertyEventPayload } from '../types';\nimport { makeEmptyConstant, makeEmptyDelimiter, makeEmptyDescription, makeEmptyTitle } from '../utils';\nimport { ItemComponent } from './item';\n\n// @vue/component\nexport const BlockComponent = {\n\tname: 'BlockComponent',\n\tcomponents: {\n\t\tItemComponent,\n\t\tBMenu,\n\t},\n\tprops: {\n\t\t/** @type Array<Item> */\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tposition: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\t/** Record<string, string> */\n\t\tfieldTypeNames: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['addItem', 'deleteBlock', 'deleteItem', 'updateItemProperty'],\n\tdata(): { isMenuShown: boolean }\n\t{\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_BLOCK_TITLE', {\n\t\t\t\t'#POSITION#': this.position,\n\t\t\t});\n\t\t},\n\t\tmenuOptions(): MenuOptions {\n\t\t\treturn {\n\t\t\t\tbindElement: this.$refs.addItemElementRef,\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tonClick: () => this.addItem(makeEmptyTitle()),\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_TITLE_ITEM_LABEL'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tonClick: () => this.addItem(makeEmptyDescription()),\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_DESCRIPTION_ITEM_LABEL'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tonClick: () => this.addItem(makeEmptyDelimiter()),\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_DELIMITER_ITEM_LABEL'),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tonClick: () => this.addItem(makeEmptyConstant()), // todo add event to change constants of workflow\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_CONSTANT_MENU'),\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\taddItem(item: Item): void\n\t\t{\n\t\t\tthis.$emit('addItem', item);\n\t\t},\n\t\tdeleteBlock(): void\n\t\t{\n\t\t\tthis.$emit('deleteBlock');\n\t\t},\n\t\tdeleteItem(itemIndex: number): void\n\t\t{\n\t\t\tthis.$emit('deleteItem', itemIndex);\n\t\t},\n\t\tonUpdateItemProperty(itemIndex: number, payload: UpdateItemPropertyEventPayload): void\n\t\t{\n\t\t\tconst filledPayload: UpdateItemPropertyEventPayload = {\n\t\t\t\tpropertyValues: payload.propertyValues,\n\t\t\t\titemIndex,\n\t\t\t};\n\t\t\tthis.$emit('updateItemProperty', filledPayload);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<div>\n\t\t\t\t{{ title }} \n\t\t\t\t<button @click=\"deleteBlock\" type=\"button\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_DELETE') }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div v-for=\"(item, index) in items\">\n\t\t\t\t<ItemComponent \n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t:fieldTypeNames=\"fieldTypeNames\"\n\t\t\t\t\t@deleteItem=\"deleteItem(index)\"\n\t\t\t\t\t@updateItemProperty=\"onUpdateItemProperty(index, $event)\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div @click=\"isMenuShown = true\" ref=\"addItemElementRef\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_ADD_ITEM') }}\n\t\t\t\t<BMenu  v-if=\"isMenuShown\" :options=\"menuOptions\" @close=\"isMenuShown = false\" />\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\nimport { convertConstants } from '../utils';\nimport { BlockComponent } from './block';\nimport { ITEM_TYPES } from '../constants';\n\nimport type { Block, ConstantItem, Item, UpdateItemPropertyEventPayload } from '../types';\n\nconst ACTIVITY_NAME = 'SetupTemplateActivity';\n\n// @vue/component\nexport const BlocksAppComponent = {\n\tname: 'BlocksAppComponent',\n\tcomponents: { BlockComponent },\n\tprops: {\n\t\tserializedBlocks: {\n\t\t\ttype: [String, null],\n\t\t\trequired: true,\n\t\t},\n\t\t/** Record<string, string> */\n\t\tfieldTypeNames: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): { blocks: Block[] }\n\t{\n\t\treturn {\n\t\t\tblocks: JSON.parse(this.serializedBlocks) ?? [],\n\t\t\tinitialConstantIds: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tformValue(): string\n\t\t{\n\t\t\treturn JSON.stringify(this.blocks);\n\t\t},\n\t},\n\tcreated()\n\t{\n\t\tthis.initialConstantIds = new Set(\n\t\t\tthis.blocks\n\t\t\t\t.flatMap((block) => block.items || [])\n\t\t\t\t.filter((item) => item?.itemType === ITEM_TYPES.CONSTANT && item.id)\n\t\t\t\t.map((item) => item.id),\n\t\t);\n\t},\n\tmounted()\n\t{\n\t\tEventEmitter.subscribe(\n\t\t\t'Bizproc.NodeSettings:nodeSettingsSaving',\n\t\t\tthis.onNodeSettingsSave,\n\t\t);\n\t},\n\tunmounted()\n\t{\n\t\tEventEmitter.unsubscribe(\n\t\t\t'Bizproc.NodeSettings:nodeSettingsSaving',\n\t\t\tthis.onNodeSettingsSave,\n\t\t);\n\t},\n\tmethods: {\n\t\taddBlock(): void\n\t\t{\n\t\t\tthis.blocks.push(this.makeEmptyBlock());\n\t\t},\n\t\tmakeEmptyBlock(): Block\n\t\t{\n\t\t\treturn { items: [] };\n\t\t},\n\t\taddItem(blockIndex: number, item: Item): void\n\t\t{\n\t\t\tthis.blocks[blockIndex].items.push(item);\n\t\t},\n\t\tdeleteBlock(blockIndex: number): void\n\t\t{\n\t\t\tthis.blocks.splice(blockIndex, 1);\n\t\t},\n\t\tdeleteItem(blockIndex: number, itemIndex: number): void\n\t\t{\n\t\t\tthis.blocks[blockIndex].items.splice(itemIndex, 1);\n\t\t},\n\t\tonUpdateItemProperty(blockIndex: number, payload: UpdateItemPropertyEventPayload): void\n\t\t{\n\t\t\tfor (const [property: string, value] of Object.entries(payload.propertyValues))\n\t\t\t{\n\t\t\t\tthis.blocks[blockIndex].items[payload.itemIndex][property] = value;\n\t\t\t}\n\t\t},\n\t\tonNodeSettingsSave(event): void\n\t\t{\n\t\t\tconst { formData } = event.getData();\n\n\t\t\tif (formData.activity !== ACTIVITY_NAME)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst currentConstants: ConstantItem[] = this.blocks\n\t\t\t\t.flatMap((block) => block.items || [])\n\t\t\t\t.filter((item) => item?.itemType === ITEM_TYPES.CONSTANT);\n\n\t\t\tconst currentConstantIds = new Set(currentConstants.map((item) => item.id));\n\t\t\tconst deletedConstantIds = [];\n\t\t\tfor (const initialId of this.initialConstantIds)\n\t\t\t{\n\t\t\t\tif (!currentConstantIds.has(initialId))\n\t\t\t\t{\n\t\t\t\t\tdeletedConstantIds.push(initialId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst constantsToUpdate = {};\n\t\t\tfor (const constant of currentConstants)\n\t\t\t{\n\t\t\t\tif (constant?.id)\n\t\t\t\t{\n\t\t\t\t\tconstantsToUpdate[constant.id] = convertConstants(constant);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tEventEmitter.emit('Bizproc:onConstantsUpdated', {\n\t\t\t\tconstantsToUpdate,\n\t\t\t\tdeletedConstantIds,\n\t\t\t});\n\n\t\t\tthis.initialConstantIds = currentConstantIds;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<input type=\"hidden\" id=\"id_blocks\" name=\"blocks\" :value=\"formValue\"/>\n\t\t\t<div>\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_APP_TITLE') }}\n\t\t\t</div>\n\t\t\t<div v-for=\"(block, index) in blocks\">\n\t\t\t\t<BlockComponent \n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:items=\"block.items\"\n\t\t\t\t\t:position=\"index + 1\"\n\t\t\t\t\t:fieldTypeNames=\"fieldTypeNames\"\n\t\t\t\t\t@addItem=\"addItem(index, $event)\"\n\t\t\t\t\t@deleteBlock=\"deleteBlock(index)\"\n\t\t\t\t\t@deleteItem=\"deleteItem(index, $event)\"\n\t\t\t\t\t@updateItemProperty=\"onUpdateItemProperty(index, $event)\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div @click=\"addBlock\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('BIZPROC_SETUP_TEMPLATE_ACTIVITY_JS_ADD_BLOCK') }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Reflection } from 'main.core';\nimport { BitrixVue } from 'ui.vue3';\nimport { BlocksAppComponent } from './component/app';\n\nconst namespace = Reflection.namespace('BX.Bizproc.Activity');\n\nclass SetupTemplateActivity\n{\n\t#currentValues: Object;\n\t#blocksElement: ?(HTMLDivElement | HTMLTableElement);\n\t#fieldTypeNames: Record<string, string>;\n\n\tconstructor(parameters: {\n\t\tcurrentValues: Object,\n\t\tdomElementId: string,\n\t\tfieldTypeNames: Record<string, string>,\n\t})\n\t{\n\t\tthis.#currentValues = parameters.currentValues;\n\t\tthis.#blocksElement = document.getElementById(parameters.domElementId);\n\t\tthis.#fieldTypeNames = parameters.fieldTypeNames;\n\t}\n\n\tinit(): void\n\t{\n\t\tconst app = BitrixVue.createApp(BlocksAppComponent, {\n\t\t\tserializedBlocks: this.#currentValues?.blocks,\n\t\t\tfieldTypeNames: this.#fieldTypeNames,\n\t\t});\n\t\tapp.mount(this.#blocksElement);\n\t}\n}\n\nnamespace.SetupTemplateActivity = SetupTemplateActivity;\n"],"names":["ITEM_TYPES","Object","freeze","DELIMITER","TITLE","DESCRIPTION","CONSTANT","CONSTANT_TYPES","STRING","INT","USER","FILE","DELIMITER_TYPES","LINE","CONSTANT_ID_PREFIX","makeEmptyDelimiter","itemType","delimiterType","makeEmptyTitle","text","makeEmptyDescription","makeEmptyConstant","id","generateConstantId","name","constantType","multiple","description","options","required","convertConstants","constant","Name","Description","Type","Required","Multiple","Options","length","Default","generateRandomString","characters","result","charactersLength","i","charAt","Math","floor","random","ConstantEditComponent","props","item","type","fieldTypeNames","emits","data","nameInvalid","watch","value","methods","onOk","payload","propertyValues","$emit","onCancel","template","ConstantComponent","components","editMode","computed","typeLabel","$Bitrix","Loc","getMessage","titleWithType","onInput","event","target","onEdit","onEditCancel","onEditUpdate","DelimiterComponent","onSelect","DescriptionComponent","TitleComponent","ItemComponent","isItemTitle","isItemDelimiter","isItemDescription","isItemConstant","deleteItem","onUpdateItemProperty","BlockComponent","BMenu","items","Array","position","Number","isMenuShown","title","menuOptions","bindElement","$refs","addItemElementRef","onClick","addItem","deleteBlock","itemIndex","filledPayload","ACTIVITY_NAME","BlocksAppComponent","serializedBlocks","String","blocks","JSON","parse","initialConstantIds","formValue","stringify","created","Set","flatMap","block","filter","map","mounted","EventEmitter","subscribe","onNodeSettingsSave","unmounted","unsubscribe","addBlock","push","makeEmptyBlock","blockIndex","splice","entries","property","getData","formData","activity","currentConstants","currentConstantIds","deletedConstantIds","initialId","has","constantsToUpdate","emit","namespace","Reflection","SetupTemplateActivity","parameters","currentValues","document","getElementById","domElementId","app","BitrixVue","createApp","mount"],"mappings":"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"}