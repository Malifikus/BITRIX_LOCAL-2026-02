{"version":3,"file":"main.popup.bundle.js","sources":["../src/compatibility/button.js","../src/popup/position-event.js","../src/popup/popup-close-icon-size.js","../src/popup/popup.js","../src/popup/popup-manager.js","../src/menu/menu-item.js","../src/menu/menu.js","../src/menu/menu-manager.js","../src/compatibility/popup-window.js","../src/compatibility/popup-window-button.js","../src/compatibility/buttonlink.js","../src/compatibility/popup-window-button-link.js","../src/compatibility/custombutton.js","../src/compatibility/popup-window-custom-button.js","../src/compatibility/popup-menu-window.js","../src/compatibility/popup-menu-item.js","../src/compatibility/input-popup.js","../src/index.js"],"sourcesContent":["import { Type, Dom } from 'main.core';\n\ndeclare type ButtonOptions = {\n\tid?: string,\n\ttext?: string,\n\tclassName?: string,\n\tevents?: { [event: string]: (event) => {} }\n};\n\n/**\n * @memberOf BX.Main.Popup\n * @deprecated use BX.UI.Button\n */\nexport default class Button\n{\n\tconstructor(params: ButtonOptions)\n\t{\n\t\tthis.popupWindow = null;\n\n\t\tthis.params = params || {};\n\n\t\tthis.text = this.params.text || '';\n\t\tthis.id = this.params.id || '';\n\t\tthis.className = this.params.className || '';\n\t\tthis.events = this.params.events || {};\n\n\t\tthis.contextEvents = {};\n\t\tfor (let eventName in this.events)\n\t\t{\n\t\t\tif (Type.isFunction(this.events[eventName]))\n\t\t\t{\n\t\t\t\tthis.contextEvents[eventName] = this.events[eventName].bind(this);\n\t\t\t}\n\t\t}\n\n\t\tthis.buttonNode = Dom.create(\n\t\t\t'span',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: 'popup-window-button' + (this.className.length > 0 ? ' ' + this.className : ''),\n\t\t\t\t\tid: this.id\n\t\t\t\t},\n\t\t\t\tevents: this.contextEvents,\n\t\t\t\ttext: this.text\n\t\t\t}\n\t\t);\n\t}\n\n\trender(): Element\n\t{\n\t\treturn this.buttonNode;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tgetContainer(): Element\n\t{\n\t\treturn this.buttonNode;\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.text;\n\t}\n\n\tsetName(name: string)\n\t{\n\t\tthis.text = name || '';\n\t\tif (this.buttonNode)\n\t\t{\n\t\t\tDom.clean(this.buttonNode);\n\t\t\tDom.adjust(this.buttonNode, { text: this.text });\n\t\t}\n\t}\n\n\tsetClassName(className: string)\n\t{\n\t\tif (this.buttonNode)\n\t\t{\n\t\t\tif (Type.isString(this.className) && (this.className !== ''))\n\t\t\t{\n\t\t\t\tDom.removeClass(this.buttonNode, this.className);\n\t\t\t}\n\n\t\t\tDom.addClass(this.buttonNode, className);\n\t\t}\n\n\t\tthis.className = className;\n\t}\n\n\taddClassName(className: string)\n\t{\n\t\tif (this.buttonNode)\n\t\t{\n\t\t\tDom.addClass(this.buttonNode, className);\n\t\t\tthis.className = this.buttonNode.className;\n\t\t}\n\t}\n\n\tremoveClassName(className: string)\n\t{\n\t\tif (this.buttonNode)\n\t\t{\n\t\t\tDom.removeClass(this.buttonNode, className);\n\t\t\tthis.className = this.buttonNode.className;\n\t\t}\n\t}\n}","import { Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\n\nexport default class PositionEvent extends BaseEvent\n{\n\t#left: number;\n\t#top: number;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tget left(): number\n\t{\n\t\treturn this.#left;\n\t}\n\n\tset left(value: number)\n\t{\n\t\tif (Type.isNumber(value))\n\t\t{\n\t\t\tthis.#left = value;\n\t\t}\n\t}\n\n\tget top(): number\n\t{\n\t\treturn this.#top;\n\t}\n\n\tset top(value: number): void\n\t{\n\t\tif (Type.isNumber(value))\n\t\t{\n\t\t\tthis.#top = value;\n\t\t}\n\t}\n}","/**\n * @namespace {BX.Main.Popup}\n */\nconst CloseIconSize = Object.freeze({\n\tLARGE: 'large',\n\tSMALL: 'small',\n})\n\nexport default CloseIconSize;","/* eslint-disable @bitrix24/bitrix24-rules/no-style, @bitrix24/bitrix24-rules/no-native-dom-methods */\n\nimport Button from '../compatibility/button';\n\nimport { Type, Text, Tag, Event, Dom, Reflection } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport {\n\ttype PopupOptions,\n\ttype PopupTarget,\n\ttype PopupAnimationOptions,\n\ttype PopupOverlay,\n\ttype PopupDraggable,\n} from './popup-types';\n\nimport { ZIndexManager, ZIndexComponent } from 'main.core.z-index-manager';\nimport PositionEvent from './position-event';\nimport CloseIconSize from './popup-close-icon-size';\n\ndeclare type TargetPosition = {\n\tleft: number,\n\ttop: number,\n\tbottom: number,\n\twindowSize: number,\n\twindowScroll: number,\n\tpopupWidth: number,\n\tpopupHeight: number\n};\n\nconst aliases = {\n\tonPopupWindowInit: { namespace: 'BX.Main.Popup', eventName: 'onInit' },\n\tonPopupWindowIsInitialized: { namespace: 'BX.Main.Popup', eventName: 'onAfterInit' },\n\tonPopupFirstShow: { namespace: 'BX.Main.Popup', eventName: 'onFirstShow' },\n\tonPopupShow: { namespace: 'BX.Main.Popup', eventName: 'onShow' },\n\tonAfterPopupShow: { namespace: 'BX.Main.Popup', eventName: 'onAfterShow' },\n\tonPopupClose: { namespace: 'BX.Main.Popup', eventName: 'onClose' },\n\tonPopupAfterClose: { namespace: 'BX.Main.Popup', eventName: 'onAfterClose' },\n\tonPopupDestroy: { namespace: 'BX.Main.Popup', eventName: 'onDestroy' },\n\tonPopupFullscreenLeave: { namespace: 'BX.Main.Popup', eventName: 'onFullscreenLeave' },\n\tonPopupFullscreenEnter: { namespace: 'BX.Main.Popup', eventName: 'onFullscreenEnter' },\n\tonPopupDragStart: { namespace: 'BX.Main.Popup', eventName: 'onDragStart' },\n\tonPopupDrag: { namespace: 'BX.Main.Popup', eventName: 'onDrag' },\n\tonPopupDragEnd: { namespace: 'BX.Main.Popup', eventName: 'onDragEnd' },\n\tonPopupResizeStart: { namespace: 'BX.Main.Popup', eventName: 'onResizeStart' },\n\tonPopupResize: { namespace: 'BX.Main.Popup', eventName: 'onResize' },\n\tonPopupResizeEnd: { namespace: 'BX.Main.Popup', eventName: 'onResizeEnd' },\n};\n\nEventEmitter.registerAliases(aliases);\n\nconst disabledScrolls: WeakMap<HTMLElement, Set<Popup>> = new WeakMap();\n\n/**\n * @memberof BX.Main\n */\nexport default class Popup extends EventEmitter\n{\n\t/**\n\t * @private\n\t */\n\tstatic options = {};\n\n\t/**\n\t * @private\n\t */\n\tstatic defaultOptions = {\n\n\t\t// left offset for popup about target\n\t\tangleLeftOffset: 40,\n\n\t\t// when popup position is 'top' offset distance between popup body and target node\n\t\tpositionTopXOffset: -11,\n\n\t\t// offset distance between popup body and target node if use angle, sum with positionTopXOffset\n\t\tangleTopOffset: 10,\n\n\t\tpopupZindex: 1000,\n\t\tpopupOverlayZindex: 1100,\n\n\t\tangleMinLeft: 10,\n\t\tangleMaxLeft: 30,\n\n\t\tangleMinRight: 10,\n\t\tangleMaxRight: 30,\n\n\t\tangleMinBottom: 23,\n\t\tangleMaxBottom: 25,\n\n\t\tangleMinTop: 23,\n\t\tangleMaxTop: 25,\n\n\t\toffsetLeft: 0,\n\t\toffsetTop: 0,\n\t};\n\n\tstatic setOptions(options: { [name: string]: any })\n\t{\n\t\tif (!Type.isPlainObject(options))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let option in options)\n\t\t{\n\t\t\tthis.options[option] = options[option];\n\t\t}\n\t}\n\n\tstatic getOption(option: string, defaultValue?: any): string | number | undefined\n\t{\n\t\tif (!Type.isUndefined(this.options[option]))\n\t\t{\n\t\t\treturn this.options[option];\n\t\t}\n\n\t\tif (!Type.isUndefined(defaultValue))\n\t\t{\n\t\t\treturn defaultValue;\n\t\t}\n\n\t\treturn this.defaultOptions[option];\n\t}\n\n\tconstructor(options?: PopupOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Main.Popup');\n\n\t\tlet [popupId: string, bindElement: PopupTarget, params: PopupOptions] = arguments; // compatible arguments\n\n\t\tthis.compatibleMode = params && Type.isBoolean(params.compatibleMode) ? params.compatibleMode : true;\n\t\tif (Type.isPlainObject(options) && !bindElement && !params)\n\t\t{\n\t\t\tparams = options;\n\t\t\tpopupId = options.id;\n\t\t\tbindElement = options.bindElement;\n\t\t\tthis.compatibleMode = false;\n\t\t}\n\n\t\tparams = params || {};\n\t\tthis.params = params;\n\n\t\tif (!Type.isStringFilled(popupId))\n\t\t{\n\t\t\tpopupId = `popup-window-${Text.getRandom().toLowerCase()}`;\n\t\t}\n\n\t\tthis.emit('onInit', new BaseEvent({ compatData: [popupId, bindElement, params] }));\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tthis.uniquePopupId = popupId;\n\t\tthis.params.zIndex = Type.isNumber(params.zIndex) ? parseInt(params.zIndex) : 0;\n\t\tthis.params.zIndexAbsolute = Type.isNumber(params.zIndexAbsolute) ? parseInt(params.zIndexAbsolute) : 0;\n\t\tthis.buttons = params.buttons && Type.isArray(params.buttons) ? params.buttons : [];\n\t\tthis.offsetTop = Popup.getOption('offsetTop');\n\t\tthis.offsetLeft = Popup.getOption('offsetLeft');\n\t\tthis.firstShow = false;\n\t\tthis.bordersWidth = 20;\n\t\tthis.bindElementPos = null;\n\t\tthis.closeIcon = null;\n\t\tthis.resizeIcon = null;\n\t\tthis.angle = null;\n\t\tthis.angleArrowElement = null;\n\t\tthis.overlay = null;\n\t\tthis.titleBar = null;\n\t\tthis.bindOptions = Type.isObject(params.bindOptions) ? params.bindOptions : {};\n\t\tthis.autoHide = params.autoHide === true;\n\t\tthis.disableScroll = params.disableScroll === true || params.isScrollBlock === true;\n\t\tthis.autoHideHandler = Type.isFunction(params.autoHideHandler) ? params.autoHideHandler : null;\n\t\tthis.isAutoHideBinded = false;\n\t\tthis.closeByEsc = params.closeByEsc === true;\n\t\tthis.isCloseByEscBinded = false;\n\t\tthis.toFrontOnShow = true;\n\n\t\tthis.cacheable = true;\n\t\tthis.destroyed = false;\n\t\tthis.fixed = false;\n\n\t\tthis.width = null;\n\t\tthis.height = null;\n\t\tthis.minWidth = null;\n\t\tthis.minHeight = null;\n\t\tthis.maxWidth = null;\n\t\tthis.maxHeight = null;\n\n\t\tthis.padding = null;\n\t\tthis.contentPadding = null;\n\t\tthis.background = null;\n\t\tthis.contentBackground = null;\n\n\t\tthis.borderRadius = null;\n\t\tthis.contentBorderRadius = null;\n\n\t\tthis.setTargetContainer(params.targetContainer);\n\n\t\tthis.dragOptions = {\n\t\t\tcursor: '',\n\t\t\tcallback: function() {\n\t\t\t},\n\t\t\teventName: ''\n\t\t};\n\n\t\tthis.dragged = false;\n\t\tthis.dragPageX = 0;\n\t\tthis.dragPageY = 0;\n\n\t\tthis.animationShowClassName = null;\n\t\tthis.animationCloseClassName = null;\n\t\tthis.animationCloseEventType = null;\n\n\t\tthis.handleDocumentMouseMove = this.handleDocumentMouseMove.bind(this);\n\t\tthis.handleDocumentMouseUp = this.handleDocumentMouseUp.bind(this);\n\t\tthis.handleResizeWindow = this.handleResizeWindow.bind(this);\n\t\tthis.handleResize = this.handleResize.bind(this);\n\t\tthis.handleMove = this.handleMove.bind(this);\n\t\tthis.onTitleMouseDown = this.onTitleMouseDown.bind(this);\n\t\tthis.handleFullScreen = this.handleFullScreen.bind(this);\n\n\t\tthis.subscribeFromOptions(params.events);\n\n\t\tlet popupClassName = 'popup-window';\n\n\t\tif (params.titleBar)\n\t\t{\n\t\t\tpopupClassName += ' popup-window-with-titlebar';\n\t\t}\n\n\t\tif (params.className && Type.isStringFilled(params.className))\n\t\t{\n\t\t\tpopupClassName += ` ${params.className}`;\n\t\t}\n\n\t\tif (params.darkMode)\n\t\t{\n\t\t\tpopupClassName += ' popup-window-dark';\n\t\t}\n\n\t\tthis.designSystemContext = params.darkMode ? '--ui-context-content-dark' : '--ui-context-content-light';\n\t\tpopupClassName += ` ${this.designSystemContext}`;\n\n\t\tif (params.titleBar)\n\t\t{\n\t\t\tthis.titleBar = Tag.render`\n\t\t\t\t<div class=\"popup-window-titlebar\" id=\"popup-window-titlebar-${popupId}\"></div>\n\t\t\t`;\n\t\t}\n\n\t\tif (params.closeIcon)\n\t\t{\n\t\t\tlet className = `popup-window-close-icon${params.titleBar ? ' popup-window-titlebar-close-icon' : ''}`;\n\t\t\tif (Object.values(CloseIconSize).includes(params.closeIconSize) && params.closeIconSize !== CloseIconSize.SMALL)\n\t\t\t{\n\t\t\t\tclassName += ` --${params.closeIconSize}`;\n\t\t\t}\n\n\t\t\tthis.closeIcon = Tag.render`\n\t\t\t\t<span class=\"${className}\" onclick=\"${this.handleCloseIconClick.bind(this)}\"></span>\n\t\t\t`;\n\n\t\t\tif (Type.isPlainObject(params.closeIcon))\n\t\t\t{\n\t\t\t\tDom.style(this.closeIcon, params.closeIcon);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tthis.contentContainer = Tag.render`\n\t\t\t<div id=\"popup-window-content-${popupId}\" class=\"popup-window-content\"></div>\n\t\t`;\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\tthis.popupContainer = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"${popupClassName}\"\n\t\t\t\tid=\"${popupId}\"\n\t\t\t\tstyle=\"display: none; position: absolute; left: 0; top: 0;\"\n\t\t\t>${[this.titleBar, this.contentContainer, this.closeIcon]}</div>\n\t\t`;\n\n\t\tthis.getTargetContainer().append(this.popupContainer);\n\n\t\tthis.zIndexComponent = ZIndexManager.register(this.popupContainer, params.zIndexOptions);\n\n\t\tthis.buttonsContainer = null;\n\n\t\tif (params.contentColor && Type.isStringFilled(params.contentColor))\n\t\t{\n\t\t\tthis.setContentColor(params.contentColor);\n\t\t}\n\n\t\tif (params.angle)\n\t\t{\n\t\t\tthis.setAngle(params.angle);\n\t\t}\n\n\t\tif (params.overlay)\n\t\t{\n\t\t\tthis.setOverlay(params.overlay);\n\t\t}\n\n\t\tthis.setOffset(params);\n\t\tthis.setBindElement(bindElement);\n\t\tthis.setTitleBar(params.titleBar);\n\t\tthis.setDraggable(params.draggable);\n\t\tthis.setContent(params.content);\n\t\tthis.setButtons(params.buttons);\n\t\tthis.setWidth(params.width);\n\t\tthis.setHeight(params.height);\n\t\tthis.setMinWidth(params.minWidth);\n\t\tthis.setMinHeight(params.minHeight);\n\t\tthis.setMaxWidth(params.maxWidth);\n\t\tthis.setMaxHeight(params.maxHeight);\n\t\tthis.setResizeMode(params.resizable);\n\t\tthis.setPadding(params.padding);\n\t\tthis.setContentPadding(params.contentPadding);\n\t\tthis.setBorderRadius(params.borderRadius);\n\t\tthis.setContentBorderRadius(params.contentBorderRadius);\n\t\tthis.setBackground(params.background);\n\t\tthis.setContentBackground(params.contentBackground);\n\t\tthis.setAnimation(params.animation);\n\t\tthis.setCacheable(params.cacheable);\n\t\tthis.setToFrontOnShow(params.toFrontOnShow);\n\t\tthis.setFixed(params.fixed);\n\t\tthis.setDesignSystemContext(params.designSystemContext);\n\n\t\t// Compatibility\n\t\tif (params.contentNoPaddings)\n\t\t{\n\t\t\tthis.setContentPadding(0);\n\t\t}\n\n\t\tif (params.noAllPaddings)\n\t\t{\n\t\t\tthis.setPadding(0);\n\t\t\tthis.setContentPadding(0);\n\t\t}\n\n\t\tif (params.bindOnResize !== false)\n\t\t{\n\t\t\tEvent.bind(window, 'resize', this.handleResizeWindow);\n\t\t}\n\n\t\tthis.emit('onAfterInit', new BaseEvent({ compatData: [popupId, this] }));\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsubscribeFromOptions(events): void\n\t{\n\t\tsuper.subscribeFromOptions(events, aliases);\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.uniquePopupId;\n\t}\n\n\tisCompatibleMode(): boolean\n\t{\n\t\treturn this.compatibleMode;\n\t}\n\n\tsetContent(content: string | Element | Node)\n\t{\n\t\tif (!this.contentContainer || !content)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isElementNode(content))\n\t\t{\n\t\t\tDom.clean(this.contentContainer);\n\n\t\t\tconst hasParent = Type.isDomNode(content.parentNode);\n\t\t\tthis.contentContainer.appendChild(content);\n\t\t\tif (this.isCompatibleMode() || hasParent)\n\t\t\t{\n\t\t\t\tcontent.style.display = 'block';\n\t\t\t}\n\t\t}\n\t\telse if (Type.isString(content))\n\t\t{\n\t\t\tthis.contentContainer.innerHTML = content;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.contentContainer.innerHTML = '&nbsp;';\n\t\t}\n\t}\n\n\tsetButtons(buttons: [])\n\t{\n\t\tthis.buttons = buttons && Type.isArray(buttons) ? buttons : [];\n\n\t\tif (this.buttonsContainer)\n\t\t{\n\t\t\tDom.remove(this.buttonsContainer);\n\t\t}\n\n\t\tconst ButtonClass = Reflection.getClass('BX.UI.Button');\n\t\tif (this.buttons.length > 0 && this.contentContainer)\n\t\t{\n\t\t\tconst newButtons = [];\n\t\t\tfor (let i = 0; i < this.buttons.length; i++)\n\t\t\t{\n\t\t\t\tconst button = this.buttons[i];\n\t\t\t\tif (button instanceof Button)\n\t\t\t\t{\n\t\t\t\t\tbutton.popupWindow = this;\n\t\t\t\t\tnewButtons.push(button.render());\n\t\t\t\t}\n\t\t\t\telse if (ButtonClass && (button instanceof ButtonClass))\n\t\t\t\t{\n\t\t\t\t\tbutton.setContext(this);\n\t\t\t\t\tnewButtons.push(button.render());\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.buttonsContainer = this.contentContainer.parentNode.appendChild(\n\t\t\t\tTag.render`<div class=\"popup-window-buttons\">${newButtons}</div>`,\n\t\t\t);\n\t\t}\n\t}\n\n\tgetButtons(): []\n\t{\n\t\treturn this.buttons;\n\t}\n\n\tgetButton(id: string)\n\t{\n\t\tfor (let i = 0; i < this.buttons.length; i++)\n\t\t{\n\t\t\tconst button = this.buttons[i];\n\t\t\tif (button.getId() === id)\n\t\t\t{\n\t\t\t\treturn button;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tsetBindElement(bindElement: Element | { left: number, top: number } | null | MouseEvent)\n\t{\n\t\tif (bindElement === null)\n\t\t{\n\t\t\tthis.bindElement = null;\n\t\t}\n\t\telse if (Type.isObject(bindElement))\n\t\t{\n\t\t\tif (Type.isDomNode(bindElement) || (Type.isNumber(bindElement.top) && Type.isNumber(bindElement.left)))\n\t\t\t{\n\t\t\t\tthis.bindElement = bindElement;\n\t\t\t}\n\t\t\telse if (Type.isNumber(bindElement.clientX) && Type.isNumber(bindElement.clientY))\n\t\t\t{\n\t\t\t\tthis.bindElement = { left: bindElement.pageX, top: bindElement.pageY, bottom: bindElement.pageY };\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetBindElementPos(bindElement: HTMLElement | any): TargetPosition | DOMRect\n\t{\n\t\tif (Type.isDomNode(bindElement))\n\t\t{\n\t\t\tif (this.isTargetDocumentBody())\n\t\t\t{\n\t\t\t\treturn this.isFixed() ? bindElement.getBoundingClientRect() : Dom.getPosition(bindElement);\n\t\t\t}\n\n\t\t\treturn this.getPositionRelativeToTarget(bindElement);\n\t\t}\n\n\t\tif (bindElement && Type.isObject(bindElement))\n\t\t{\n\t\t\tif (!Type.isNumber(bindElement.bottom))\n\t\t\t{\n\t\t\t\tbindElement.bottom = bindElement.top;\n\t\t\t}\n\n\t\t\treturn bindElement;\n\t\t}\n\n\t\tconst windowSize = this.getWindowSize();\n\t\tconst windowScroll = this.getWindowScroll();\n\n\t\tconst popupWidth = this.getPopupContainer().offsetWidth;\n\t\tconst popupHeight = this.getPopupContainer().offsetHeight;\n\n\t\tthis.bindOptions.forceTop = true;\n\n\t\treturn {\n\t\t\tleft: windowSize.innerWidth / 2 - popupWidth / 2 + windowScroll.scrollLeft,\n\t\t\ttop: windowSize.innerHeight / 2 - popupHeight / 2 + (this.isFixed() ? 0 : windowScroll.scrollTop),\n\t\t\tbottom: windowSize.innerHeight / 2 - popupHeight / 2 + (this.isFixed() ? 0 : windowScroll.scrollTop),\n\n\t\t\t// for optimisation purposes\n\t\t\twindowSize,\n\t\t\twindowScroll,\n\t\t\tpopupWidth,\n\t\t\tpopupHeight,\n\t\t};\n\t}\n\n\t/**\n\t * @internal\n\t */\n\tgetPositionRelativeToTarget(element: HTMLElement): DOMRect\n\t{\n\t\tlet offsetLeft = element.offsetLeft;\n\t\tlet offsetTop = element.offsetTop;\n\t\tlet offsetElement = element.offsetParent;\n\n\t\twhile (offsetElement && offsetElement !== this.getTargetContainer())\n\t\t{\n\t\t\toffsetLeft += offsetElement.offsetLeft;\n\t\t\toffsetTop += offsetElement.offsetTop;\n\t\t\toffsetElement = offsetElement.offsetParent;\n\t\t}\n\n\t\tconst elementRect = element.getBoundingClientRect();\n\n\t\treturn new DOMRect(\n\t\t\toffsetLeft,\n\t\t\toffsetTop,\n\t\t\telementRect.width,\n\t\t\telementRect.height,\n\t\t);\n\t}\n\n\t// private\n\tgetWindowSize(): { innerWidth: number, innerHeight: number }\n\t{\n\t\tif (this.isTargetDocumentBody())\n\t\t{\n\t\t\treturn {\n\t\t\t\tinnerWidth: window.innerWidth,\n\t\t\t\tinnerHeight: window.innerHeight,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tinnerWidth: this.getTargetContainer().offsetWidth,\n\t\t\tinnerHeight: this.getTargetContainer().offsetHeight,\n\t\t};\n\t}\n\n\t// private\n\tgetWindowScroll(): { scrollLeft: number, scrollTop: number }\n\t{\n\t\tif (this.isTargetDocumentBody())\n\t\t{\n\t\t\treturn {\n\t\t\t\tscrollLeft: window.pageXOffset,\n\t\t\t\tscrollTop: window.pageYOffset,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tscrollLeft: this.getTargetContainer().scrollLeft,\n\t\t\tscrollTop: this.getTargetContainer().scrollTop,\n\t\t};\n\t}\n\n\tsetAngle(params: { offset: number, position?: 'top' | 'bottom' | 'left' | 'right' }): void\n\t{\n\t\tif (params === false)\n\t\t{\n\t\t\tif (this.angle !== null)\n\t\t\t{\n\t\t\t\tDom.remove(this.angle.element);\n\t\t\t}\n\n\t\t\tthis.angle = null;\n\t\t\tthis.angleArrowElement = null;\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst className = 'popup-window-angly';\n\t\tif (this.angle === null)\n\t\t{\n\t\t\tconst position = this.bindOptions.position && this.bindOptions.position === 'top' ? 'bottom' : 'top';\n\t\t\tconst angleMinLeft = Popup.getOption(position === 'top' ? 'angleMinTop' : 'angleMinBottom');\n\t\t\tlet defaultOffset = Type.isNumber(params.offset) ? params.offset : 0;\n\n\t\t\tconst angleLeftOffset = Popup.getOption('angleLeftOffset', null);\n\t\t\tif (defaultOffset > 0 && Type.isNumber(angleLeftOffset))\n\t\t\t{\n\t\t\t\tdefaultOffset += angleLeftOffset - Popup.defaultOptions.angleLeftOffset;\n\t\t\t}\n\n\t\t\tthis.angleArrowElement = Tag.render`<div class=\"popup-window-angly--arrow\"></div>`;\n\t\t\tif (this.background)\n\t\t\t{\n\t\t\t\tthis.angleArrowElement.style.background = this.background;\n\t\t\t}\n\n\t\t\tthis.angle = {\n\t\t\t\telement: Tag.render`\n\t\t\t\t\t<div class=\"${className} ${className}-${position}\">\n\t\t\t\t\t\t${this.angleArrowElement}\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\tposition,\n\t\t\t\toffset: 0,\n\t\t\t\tdefaultOffset: Math.max(defaultOffset, angleMinLeft),\n\t\t\t\t// Math.max(Type.isNumber(params.offset) ? params.offset : 0, angleMinLeft)\n\t\t\t};\n\n\t\t\tthis.getPopupContainer().appendChild(this.angle.element);\n\t\t}\n\n\t\tif (Type.isObject(params) && params.position && ['top', 'right', 'bottom', 'left', 'hide'].includes(params.position))\n\t\t{\n\t\t\tDom.removeClass(this.angle.element, `${className}-${this.angle.position}`);\n\t\t\tDom.addClass(this.angle.element, `${className}-${params.position}`);\n\n\t\t\tthis.angle.position = params.position;\n\t\t}\n\n\t\tif (Type.isObject(params) && Type.isNumber(params.offset))\n\t\t{\n\t\t\tconst offset = params.offset;\n\t\t\tlet minOffset, maxOffset;\n\t\t\tif (this.angle.position === 'top')\n\t\t\t{\n\t\t\t\tminOffset = Popup.getOption('angleMinTop');\n\t\t\t\tmaxOffset = this.getPopupContainer().offsetWidth - Popup.getOption('angleMaxTop');\n\t\t\t\tmaxOffset = maxOffset < minOffset ? Math.max(minOffset, offset) : maxOffset;\n\n\t\t\t\tthis.angle.offset = Math.min(Math.max(minOffset, offset), maxOffset);\n\t\t\t\tthis.angle.element.style.left = `${this.angle.offset}px`;\n\t\t\t\tthis.angle.element.style.marginLeft = 0;\n\t\t\t\tthis.angle.element.style.removeProperty('top');\n\t\t\t}\n\t\t\telse if (this.angle.position === 'bottom')\n\t\t\t{\n\t\t\t\tminOffset = Popup.getOption('angleMinBottom');\n\t\t\t\tmaxOffset = this.getPopupContainer().offsetWidth - Popup.getOption('angleMaxBottom');\n\t\t\t\tmaxOffset = maxOffset < minOffset ? Math.max(minOffset, offset) : maxOffset;\n\n\t\t\t\tthis.angle.offset = Math.min(Math.max(minOffset, offset), maxOffset);\n\t\t\t\tthis.angle.element.style.marginLeft = `${this.angle.offset}px`;\n\t\t\t\tthis.angle.element.style.left = 0;\n\t\t\t\tthis.angle.element.style.removeProperty('top');\n\t\t\t}\n\t\t\telse if (this.angle.position === 'right')\n\t\t\t{\n\t\t\t\tminOffset = Popup.getOption('angleMinRight');\n\t\t\t\tmaxOffset = this.getPopupContainer().offsetHeight - Popup.getOption('angleMaxRight');\n\t\t\t\tmaxOffset = maxOffset < minOffset ? Math.max(minOffset, offset) : maxOffset;\n\n\t\t\t\tthis.angle.offset = Math.min(Math.max(minOffset, offset), maxOffset);\n\t\t\t\tthis.angle.element.style.top = `${this.angle.offset}px`;\n\t\t\t\tthis.angle.element.style.removeProperty('left');\n\t\t\t\tthis.angle.element.style.removeProperty('margin-left');\n\t\t\t}\n\t\t\telse if (this.angle.position === 'left')\n\t\t\t{\n\t\t\t\tminOffset = Popup.getOption('angleMinLeft');\n\t\t\t\tmaxOffset = this.getPopupContainer().offsetHeight - Popup.getOption('angleMaxLeft');\n\t\t\t\tmaxOffset = maxOffset < minOffset ? Math.max(minOffset, offset) : maxOffset;\n\n\t\t\t\tthis.angle.offset = Math.min(Math.max(minOffset, offset), maxOffset);\n\t\t\t\tthis.angle.element.style.top = `${this.angle.offset}px`;\n\t\t\t\tthis.angle.element.style.removeProperty('left');\n\t\t\t\tthis.angle.element.style.removeProperty('margin-left');\n\t\t\t}\n\t\t}\n\t}\n\n\tgetWidth(): number\n\t{\n\t\treturn this.width;\n\t}\n\n\tsetWidth(width: number)\n\t{\n\t\tthis.setWidthProperty('width', width);\n\t}\n\n\tgetHeight(): number\n\t{\n\t\treturn this.height;\n\t}\n\n\tsetHeight(height: number)\n\t{\n\t\tthis.setHeightProperty('height', height);\n\t}\n\n\tgetMinWidth(): number\n\t{\n\t\treturn this.minWidth;\n\t}\n\n\tsetMinWidth(width: number)\n\t{\n\t\tthis.setWidthProperty('minWidth', width);\n\t}\n\n\tgetMinHeight(): number\n\t{\n\t\treturn this.minHeight;\n\t}\n\n\tsetMinHeight(height: number)\n\t{\n\t\tthis.setHeightProperty('minHeight', height);\n\t}\n\n\tgetMaxWidth(): number\n\t{\n\t\treturn this.maxWidth;\n\t}\n\n\tsetMaxWidth(width: number)\n\t{\n\t\tthis.setWidthProperty('maxWidth', width);\n\t}\n\n\tgetMaxHeight(): number\n\t{\n\t\treturn this.maxHeight;\n\t}\n\n\tsetMaxHeight(height: number)\n\t{\n\t\tthis.setHeightProperty('maxHeight', height);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetWidthProperty(property: string, width: number)\n\t{\n\t\tconst props = ['width', 'minWidth', 'maxWidth'];\n\t\tif (!props.includes(property))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isNumber(width) && width >= 0)\n\t\t{\n\t\t\tthis[property] = width;\n\t\t\tthis.getResizableContainer().style[property] = `${width}px`;\n\t\t\tthis.getContentContainer().style.overflowX = 'auto';\n\t\t\tthis.getPopupContainer().classList.add('popup-window-fixed-width');\n\t\t}\n\t\telse if (width === null || width === false)\n\t\t{\n\t\t\tthis[property] = null;\n\t\t\tthis.getResizableContainer().style.removeProperty(Text.toKebabCase(property));\n\n\t\t\tconst hasOtherProps = props.some((prop) => {\n\t\t\t\treturn this.getResizableContainer().style.getPropertyValue(Text.toKebabCase(prop)) !== '';\n\t\t\t});\n\n\t\t\tif (!hasOtherProps)\n\t\t\t{\n\t\t\t\tthis.getContentContainer().style.removeProperty('overflow-x');\n\t\t\t\tthis.getPopupContainer().classList.remove('popup-window-fixed-width');\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tsetHeightProperty(property: string, height: number)\n\t{\n\t\tconst props = ['height', 'minHeight', 'maxHeight'];\n\t\tif (!props.includes(property))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isNumber(height) && height >= 0)\n\t\t{\n\t\t\tthis[property] = height;\n\t\t\tthis.getResizableContainer().style[property] = `${height}px`;\n\t\t\tthis.getContentContainer().style.overflowY = 'auto';\n\t\t\tthis.getPopupContainer().classList.add('popup-window-fixed-height');\n\t\t}\n\t\telse if (height === null || height === false)\n\t\t{\n\t\t\tthis[property] = null;\n\t\t\tthis.getResizableContainer().style.removeProperty(Text.toKebabCase(property));\n\n\t\t\tconst hasOtherProps = props.some((prop) => {\n\t\t\t\treturn this.getResizableContainer().style.getPropertyValue(Text.toKebabCase(prop)) !== '';\n\t\t\t});\n\n\t\t\tif (!hasOtherProps)\n\t\t\t{\n\t\t\t\tthis.getContentContainer().style.removeProperty('overflow-y');\n\t\t\t\tthis.getPopupContainer().classList.remove('popup-window-fixed-height');\n\t\t\t}\n\t\t}\n\t}\n\n\tsetPadding(padding: number)\n\t{\n\t\tif (Type.isNumber(padding) && padding >= 0)\n\t\t{\n\t\t\tthis.padding = padding;\n\t\t\tthis.getPopupContainer().style.padding = `${padding}px`;\n\t\t}\n\t\telse if (padding === null)\n\t\t{\n\t\t\tthis.padding = null;\n\t\t\tthis.getPopupContainer().style.removeProperty('padding');\n\t\t}\n\t}\n\n\tgetPadding(): number\n\t{\n\t\treturn this.padding;\n\t}\n\n\tsetContentPadding(padding: number)\n\t{\n\t\tif (Type.isNumber(padding) && padding >= 0)\n\t\t{\n\t\t\tthis.contentPadding = padding;\n\t\t\tthis.getContentContainer().style.padding = `${padding}px`;\n\t\t}\n\t\telse if (padding === null)\n\t\t{\n\t\t\tthis.contentPadding = null;\n\t\t\tthis.getContentContainer().style.removeProperty('padding');\n\t\t}\n\t}\n\n\tgetContentPadding(): number\n\t{\n\t\treturn this.contentPadding;\n\t}\n\n\tsetBorderRadius(radius): void\n\t{\n\t\tif (Type.isStringFilled(radius))\n\t\t{\n\t\t\tthis.borderRadius = radius;\n\t\t\tthis.getPopupContainer().style.setProperty('--popup-window-border-radius', radius);\n\t\t}\n\t\telse if (radius === null)\n\t\t{\n\t\t\tthis.borderRadius = null;\n\t\t\tthis.getPopupContainer().style.removeProperty('--popup-window-border-radius');\n\t\t}\n\t}\n\n\tsetContentBorderRadius(radius): void\n\t{\n\t\tif (Type.isStringFilled(radius))\n\t\t{\n\t\t\tthis.contentBorderRadius = radius;\n\t\t\tthis.getContentContainer().style.setProperty('--popup-window-content-border-radius', radius);\n\t\t}\n\t\telse if (radius === null)\n\t\t{\n\t\t\tthis.contentBorderRadius = null;\n\t\t\tthis.getContentContainer().style.removeProperty('--popup-window-content-border-radius');\n\t\t}\n\t}\n\n\tsetContentColor(color: string | null)\n\t{\n\t\tif (Type.isString(color) && this.contentContainer)\n\t\t{\n\t\t\tthis.contentContainer.style.backgroundColor = color;\n\t\t}\n\t\telse if (color === null)\n\t\t{\n\t\t\tthis.contentContainer.style.style.removeProperty('background-color');\n\t\t}\n\t}\n\n\tsetBackground(background: string | null)\n\t{\n\t\tif (Type.isStringFilled(background))\n\t\t{\n\t\t\tthis.background = background;\n\t\t\tthis.getPopupContainer().style.background = background;\n\n\t\t\tif (this.angleArrowElement)\n\t\t\t{\n\t\t\t\tthis.angleArrowElement.style.background = background;\n\t\t\t}\n\t\t}\n\t\telse if (background === null)\n\t\t{\n\t\t\tthis.background = null;\n\t\t\tthis.getPopupContainer().style.removeProperty('background');\n\n\t\t\tif (this.angleArrowElement)\n\t\t\t{\n\t\t\t\tthis.angleArrowElement.style.removeProperty('background');\n\t\t\t}\n\t\t}\n\t}\n\n\tgetBackground(): string | null\n\t{\n\t\treturn this.background;\n\t}\n\n\tsetContentBackground(background: string | null)\n\t{\n\t\tif (Type.isStringFilled(background))\n\t\t{\n\t\t\tthis.contentBackground = background;\n\t\t\tthis.getContentContainer().style.background = background;\n\t\t}\n\t\telse if (background === null)\n\t\t{\n\t\t\tthis.contentBackground = null;\n\t\t\tthis.getContentContainer().style.removeProperty('background');\n\t\t}\n\t}\n\n\tgetContentBackground(): string | null\n\t{\n\t\treturn this.contentBackground;\n\t}\n\n\tisDestroyed(): boolean\n\t{\n\t\treturn this.destroyed;\n\t}\n\n\tsetCacheable(cacheable: boolean): void\n\t{\n\t\tthis.cacheable = cacheable !== false;\n\t}\n\n\tisCacheable(): boolean\n\t{\n\t\treturn this.cacheable;\n\t}\n\n\tsetToFrontOnShow(flag: boolean): void\n\t{\n\t\tthis.toFrontOnShow = flag !== false;\n\t}\n\n\tshouldFrontOnShow(): boolean\n\t{\n\t\treturn this.toFrontOnShow;\n\t}\n\n\tsetFixed(flag: boolean): void\n\t{\n\t\tif (Type.isBoolean(flag))\n\t\t{\n\t\t\tthis.fixed = flag;\n\t\t\tif (flag)\n\t\t\t{\n\t\t\t\tDom.addClass(this.getPopupContainer(), '--fixed');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(this.getPopupContainer(), '--fixed');\n\t\t\t}\n\t\t}\n\t}\n\n\tisFixed(): boolean\n\t{\n\t\treturn this.fixed;\n\t}\n\n\tsetResizeMode(mode: boolean): void\n\t{\n\t\tif (mode === true || Type.isPlainObject(mode))\n\t\t{\n\t\t\tif (!this.resizeIcon)\n\t\t\t{\n\t\t\t\tthis.resizeIcon = Tag.render`\n\t\t\t\t\t<div class=\"popup-window-resize\" onmousedown=\"${this.handleResizeMouseDown.bind(this)}\"></div>\n\t\t\t\t`;\n\n\t\t\t\tthis.getPopupContainer().appendChild(this.resizeIcon);\n\t\t\t}\n\n\t\t\t// Compatibility\n\t\t\tthis.setMinWidth(mode.minWidth);\n\t\t\tthis.setMinHeight(mode.minHeight);\n\t\t}\n\t\telse if (mode === false && this.resizeIcon)\n\t\t{\n\t\t\tDom.remove(this.resizeIcon);\n\t\t\tthis.resizeIcon = null;\n\t\t}\n\t}\n\n\tgetDesignSystemContext(): string\n\t{\n\t\treturn this.designSystemContext;\n\t}\n\n\tsetDesignSystemContext(context: string): void\n\t{\n\t\tif (Type.isString(context))\n\t\t{\n\t\t\tif (this.popupContainer !== null)\n\t\t\t{\n\t\t\t\tDom.removeClass(this.popupContainer, this.designSystemContext);\n\t\t\t\tDom.addClass(this.popupContainer, context);\n\t\t\t}\n\n\t\t\tthis.designSystemContext = context;\n\t\t}\n\t}\n\n\tsetTargetContainer(targetContainer: HTMLElement): void\n\t{\n\t\tconst newTargetContainer = Type.isElementNode(targetContainer) ? targetContainer : document.body;\n\t\tif (newTargetContainer === this.targetContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.targetContainer = newTargetContainer;\n\t\tif (this.getPopupContainer())\n\t\t{\n\t\t\tZIndexManager.unregister(this.getPopupContainer());\n\t\t\tthis.getTargetContainer().append(this.getPopupContainer());\n\t\t\tZIndexManager.register(this.getPopupContainer());\n\t\t}\n\n\t\tif (this.overlay)\n\t\t{\n\t\t\tDom.append(this.overlay.element, this.getTargetContainer());\n\t\t}\n\t}\n\n\tgetTargetContainer(): HTMLElement\n\t{\n\t\treturn this.targetContainer;\n\t}\n\n\tisTargetDocumentBody(): boolean\n\t{\n\t\treturn this.getTargetContainer() === document.body;\n\t}\n\n\tgetPopupContainer(): HTMLElement\n\t{\n\t\treturn this.popupContainer;\n\t}\n\n\tgetContentContainer(): HTMLElement\n\t{\n\t\treturn this.contentContainer;\n\t}\n\n\tgetResizableContainer(): HTMLElement\n\t{\n\t\treturn this.getPopupContainer();\n\t}\n\n\tgetTitleContainer(): HTMLElement\n\t{\n\t\treturn this.titleBar;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonTitleMouseDown(event: MouseEvent): void\n\t{\n\t\tthis.#startDrag(\n\t\t\tevent,\n\t\t\t{\n\t\t\t\tcursor: 'move',\n\t\t\t\tcallback: this.handleMove,\n\t\t\t\teventName: 'Drag',\n\t\t\t},\n\t\t);\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleResizeMouseDown(event): void\n\t{\n\t\tthis.#startDrag(\n\t\t\tevent,\n\t\t\t{\n\t\t\t\tcursor: 'nwse-resize',\n\t\t\t\teventName: 'Resize',\n\t\t\t\tcallback: this.handleResize,\n\t\t\t},\n\t\t);\n\n\t\tif (this.isTargetDocumentBody())\n\t\t{\n\t\t\tthis.resizeContentPos = Dom.getPosition(this.getResizableContainer());\n\t\t\tthis.resizeContentOffset = (\n\t\t\t\tthis.resizeContentPos.left - Dom.getPosition(this.getPopupContainer()).left\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.resizeContentPos = this.getPositionRelativeToTarget(this.getResizableContainer());\n\t\t\tthis.resizeContentOffset = (\n\t\t\t\tthis.resizeContentPos.left - this.getPositionRelativeToTarget(this.getPopupContainer()).left\n\t\t\t);\n\t\t}\n\n\t\tthis.resizeContentPos.offsetX = 0;\n\t\tthis.resizeContentPos.offsetY = 0;\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleResize(offsetX, offsetY, pageX, pageY): void\n\t{\n\t\tthis.resizeContentPos.offsetX += offsetX;\n\t\tthis.resizeContentPos.offsetY += offsetY;\n\n\t\tlet width = this.resizeContentPos.width + this.resizeContentPos.offsetX;\n\t\tlet height = this.resizeContentPos.height + this.resizeContentPos.offsetY;\n\n\t\tconst scrollWidth = (\n\t\t\tthis.isTargetDocumentBody() ? document.documentElement.scrollWidth : this.getTargetContainer().scrollWidth\n\t\t);\n\n\t\tif (this.resizeContentPos.left + width + this.resizeContentOffset >= scrollWidth)\n\t\t{\n\t\t\twidth = scrollWidth - this.resizeContentPos.left - this.resizeContentOffset;\n\t\t}\n\n\t\twidth = Math.max(width, this.getMinWidth());\n\t\theight = Math.max(height, this.getMinHeight());\n\n\t\tif (this.getMaxWidth() !== null)\n\t\t{\n\t\t\twidth = Math.min(width, this.getMaxWidth());\n\t\t}\n\n\t\tif (this.getMaxHeight() !== null)\n\t\t{\n\t\t\theight = Math.min(height, this.getMaxHeight());\n\t\t}\n\n\t\tthis.setWidth(width);\n\t\tthis.setHeight(height);\n\t}\n\n\tisTopAngle(): boolean\n\t{\n\t\treturn this.angle !== null && this.angle.position === 'top';\n\t}\n\n\tisBottomAngle(): boolean\n\t{\n\t\treturn this.angle !== null && this.angle.position === 'bottom';\n\t}\n\n\tisTopOrBottomAngle(): boolean\n\t{\n\t\treturn this.angle !== null && (this.angle.position === 'top' || this.angle.position === 'bottom');\n\t}\n\n\t/**\n\t * @private\n\t */\n\tgetAngleHeight(): number\n\t{\n\t\treturn (this.isTopOrBottomAngle() ? Popup.getOption('angleTopOffset') : 0);\n\t}\n\n\tsetOffset(params: { offsetTop: number, offsetLeft: number }): void\n\t{\n\t\tif (!Type.isPlainObject(params))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isNumber(params.offsetLeft))\n\t\t{\n\t\t\tthis.offsetLeft = params.offsetLeft + Popup.getOption('offsetLeft');\n\t\t}\n\n\t\tif (Type.isNumber(params.offsetTop))\n\t\t{\n\t\t\tthis.offsetTop = params.offsetTop + Popup.getOption('offsetTop');\n\t\t}\n\t}\n\n\tsetTitleBar(params: string | { content: string }): void\n\t{\n\t\tif (!this.titleBar)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (Type.isObject(params) && Type.isDomNode(params.content))\n\t\t{\n\t\t\tthis.titleBar.innerHTML = '';\n\t\t\tthis.titleBar.appendChild(params.content);\n\t\t}\n\t\telse if (Type.isString(params))\n\t\t{\n\t\t\tthis.titleBar.innerHTML = '';\n\t\t\tthis.titleBar.appendChild(\n\t\t\t\tDom.create('span', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'popup-window-titlebar-text',\n\t\t\t\t\t},\n\t\t\t\t\ttext: params,\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t}\n\n\tsetDraggable(draggable: PopupDraggable): void\n\t{\n\t\tthis.params.draggable = draggable;\n\t\tconst element = draggable?.element ?? this.titleBar;\n\t\tif (!draggable || !element)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.style(element, 'cursor', 'move');\n\t\tEvent.bind(element, 'mousedown', this.onTitleMouseDown);\n\t}\n\n\tsetClosingByEsc(enable: boolean): void\n\t{\n\t\tenable = Type.isBoolean(enable) ? enable : true;\n\t\tif (enable)\n\t\t{\n\t\t\tthis.closeByEsc = true;\n\t\t\tthis.bindClosingByEsc();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.closeByEsc = false;\n\t\t\tthis.unbindClosingByEsc();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tbindClosingByEsc(): void\n\t{\n\t\tif (this.closeByEsc && !this.isCloseByEscBinded)\n\t\t{\n\t\t\tEvent.bind(this.targetContainer.ownerDocument, 'keyup', this.handleDocumentKeyUp, true);\n\t\t\tthis.isCloseByEscBinded = true;\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tunbindClosingByEsc(): void\n\t{\n\t\tif (this.isCloseByEscBinded)\n\t\t{\n\t\t\tEvent.unbind(this.targetContainer.ownerDocument, 'keyup', this.handleDocumentKeyUp, true);\n\t\t\tthis.isCloseByEscBinded = false;\n\t\t}\n\t}\n\n\tsetAutoHide(enable: boolean): void\n\t{\n\t\tenable = Type.isBoolean(enable) ? enable : true;\n\t\tif (enable)\n\t\t{\n\t\t\tthis.autoHide = true;\n\t\t\tthis.bindAutoHide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.autoHide = false;\n\t\t\tthis.unbindAutoHide();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tbindAutoHide(): void\n\t{\n\t\tif (this.autoHide && !this.isAutoHideBinded && this.isShown())\n\t\t{\n\t\t\tthis.isAutoHideBinded = true;\n\n\t\t\tif (this.isCompatibleMode())\n\t\t\t{\n\t\t\t\tEvent.bind(this.getPopupContainer(), 'click', this.handleContainerClick);\n\t\t\t}\n\n\t\t\tif (!this.hasOverlay())\n\t\t\t{\n\t\t\t\tEvent.bind(\n\t\t\t\t\tthis.targetContainer.ownerDocument,\n\t\t\t\t\t'click',\n\t\t\t\t\tthis.handleAutoHide,\n\t\t\t\t\t!this.isCompatibleMode(),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tunbindAutoHide(): void\n\t{\n\t\tif (this.isAutoHideBinded)\n\t\t{\n\t\t\tthis.isAutoHideBinded = false;\n\n\t\t\tif (this.isCompatibleMode())\n\t\t\t{\n\t\t\t\tEvent.unbind(this.getPopupContainer(), 'click', this.handleContainerClick);\n\t\t\t}\n\n\t\t\tif (!this.hasOverlay())\n\t\t\t{\n\t\t\t\tEvent.unbind(\n\t\t\t\t\tthis.targetContainer.ownerDocument,\n\t\t\t\t\t'click',\n\t\t\t\t\tthis.handleAutoHide,\n\t\t\t\t\t!this.isCompatibleMode(),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleAutoHide = (event): void => {\n\t\tif (this.isDestroyed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.autoHideHandler !== null)\n\t\t{\n\t\t\tif (this.autoHideHandler(event))\n\t\t\t{\n\t\t\t\tthis._tryCloseByEvent(event);\n\t\t\t}\n\t\t}\n\t\telse if (event.target !== this.getPopupContainer() && !this.getPopupContainer().contains(event.target))\n\t\t{\n\t\t\tthis._tryCloseByEvent(event);\n\t\t}\n\t};\n\n\t/**\n\t * @private\n\t */\n\t_tryCloseByEvent(event): void\n\t{\n\t\tif (this.isCompatibleMode())\n\t\t{\n\t\t\tthis.tryCloseByEvent(event);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.tryCloseByEvent(event);\n\t\t\t}, 0);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\ttryCloseByEvent(event): void\n\t{\n\t\tif (event.button === 0)\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleOverlayClick(event): void\n\t{\n\t\tif (this.autoHide)\n\t\t{\n\t\t\tthis.tryCloseByEvent(event);\n\t\t\tevent.stopPropagation();\n\t\t}\n\t}\n\n\tsetOverlay(params: PopupOverlay): void\n\t{\n\t\tif (this.overlay === null)\n\t\t{\n\t\t\tthis.unbindAutoHide();\n\n\t\t\tthis.overlay = {\n\t\t\t\telement: Tag.render`\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"popup-window-overlay\" \n\t\t\t\t\t\tid=\"popup-window-overlay-${this.getId()}\"\n\t\t\t\t\t\tonclick=\"${this.handleOverlayClick.bind(this)}\"\n\t\t\t\t\t></div>\n\t\t\t\t`,\n\t\t\t};\n\n\t\t\tthis.resizeOverlay();\n\n\t\t\tDom.append(this.overlay.element, this.getTargetContainer());\n\t\t\tthis.getZIndexComponent().setOverlay(this.overlay.element);\n\t\t}\n\n\t\tif (Type.isNumber(params?.opacity) && params.opacity >= 0 && params.opacity <= 100)\n\t\t{\n\t\t\tDom.style(this.overlay.element, 'opacity', parseFloat(params.opacity / 100).toPrecision(3));\n\t\t}\n\n\t\tif (params?.backgroundColor)\n\t\t{\n\t\t\tDom.style(this.overlay.element, 'background-color', params.backgroundColor);\n\t\t}\n\n\t\tif (params?.blur)\n\t\t{\n\t\t\tDom.style(this.overlay.element, 'backdrop-filter', params.blur);\n\t\t}\n\t}\n\n\thasOverlay(): boolean\n\t{\n\t\treturn this.overlay !== null && this.overlay.element !== null;\n\t}\n\n\tremoveOverlay(): void\n\t{\n\t\tif (this.overlay !== null && this.overlay.element !== null)\n\t\t{\n\t\t\tDom.remove(this.overlay.element);\n\t\t\tthis.getZIndexComponent().setOverlay(null);\n\t\t}\n\n\t\tif (this.overlayTimeout)\n\t\t{\n\t\t\tclearInterval(this.overlayTimeout);\n\t\t\tthis.overlayTimeout = null;\n\t\t}\n\n\t\tthis.overlay = null;\n\t}\n\n\thideOverlay(): void\n\t{\n\t\tif (this.overlay !== null && this.overlay.element !== null)\n\t\t{\n\t\t\tif (this.overlayTimeout)\n\t\t\t{\n\t\t\t\tclearInterval(this.overlayTimeout);\n\t\t\t\tthis.overlayTimeout = null;\n\t\t\t}\n\n\t\t\tthis.overlay.element.style.display = 'none';\n\t\t}\n\t}\n\n\tshowOverlay(): void\n\t{\n\t\tif (this.overlay !== null && this.overlay.element !== null)\n\t\t{\n\t\t\tthis.overlay.element.style.display = 'block';\n\n\t\t\tlet popupHeight = this.getPopupContainer().offsetHeight;\n\t\t\tthis.overlayTimeout = setInterval(() => {\n\t\t\t\tif (popupHeight !== this.getPopupContainer().offsetHeight)\n\t\t\t\t{\n\t\t\t\t\tthis.resizeOverlay();\n\t\t\t\t\tpopupHeight = this.getPopupContainer().offsetHeight;\n\t\t\t\t}\n\t\t\t}, 1000);\n\t\t}\n\t}\n\n\tresizeOverlay(): void\n\t{\n\t\tif (this.overlay !== null && this.overlay.element !== null)\n\t\t{\n\t\t\tlet scrollWidth;\n\t\t\tlet scrollHeight;\n\t\t\tif (this.isTargetDocumentBody())\n\t\t\t{\n\t\t\t\tscrollWidth = document.documentElement.scrollWidth;\n\t\t\t\tscrollHeight = Math.max(\n\t\t\t\t\tdocument.body.scrollHeight,\n\t\t\t\t\tdocument.documentElement.scrollHeight,\n\t\t\t\t\tdocument.body.offsetHeight,\n\t\t\t\t\tdocument.documentElement.offsetHeight,\n\t\t\t\t\tdocument.body.clientHeight,\n\t\t\t\t\tdocument.documentElement.clientHeight,\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tscrollWidth = this.getTargetContainer().scrollWidth;\n\t\t\t\tscrollHeight = this.getTargetContainer().scrollHeight;\n\t\t\t}\n\n\t\t\tthis.overlay.element.style.width = `${scrollWidth}px`;\n\t\t\tthis.overlay.element.style.height = `${scrollHeight}px`;\n\t\t}\n\t}\n\n\tgetZindex(): number\n\t{\n\t\treturn this.getZIndexComponent().getZIndex();\n\t}\n\n\tgetZIndexComponent(): ZIndexComponent\n\t{\n\t\treturn this.zIndexComponent;\n\t}\n\n\tsetDisableScroll(flag: boolean): void\n\t{\n\t\tconst disable = Type.isBoolean(flag) ? flag : true;\n\t\tif (disable)\n\t\t{\n\t\t\tthis.disableScroll = true;\n\t\t\tthis.#disableTargetScroll();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.disableScroll = false;\n\t\t\tthis.#enableTargetScroll();\n\t\t}\n\t}\n\n\t#disableTargetScroll(): void\n\t{\n\t\tconst target = this.getTargetContainer();\n\t\tlet popups: Set<Popup> = disabledScrolls.get(target);\n\t\tif (!popups)\n\t\t{\n\t\t\tpopups = new Set();\n\t\t\tdisabledScrolls.set(target, popups);\n\t\t}\n\n\t\tpopups.add(this);\n\n\t\tDom.addClass(target, 'popup-window-disable-scroll');\n\t}\n\n\t#enableTargetScroll(): void\n\t{\n\t\tconst target = this.getTargetContainer();\n\t\tconst popups: Set<Popup> = disabledScrolls.get(target) || null;\n\t\tif (popups)\n\t\t{\n\t\t\tpopups.delete(this);\n\t\t}\n\n\t\tif (popups === null || popups.size === 0)\n\t\t{\n\t\t\tDom.removeClass(target, 'popup-window-disable-scroll');\n\t\t}\n\t}\n\n\tshow(): void\n\t{\n\t\tif (this.isShown() || this.isDestroyed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('onBeforeShow');\n\n\t\tthis.showOverlay();\n\t\tthis.getPopupContainer().style.display = 'block';\n\t\tDom.addClass(this.getPopupContainer(), '--open');\n\n\t\tif (this.shouldFrontOnShow())\n\t\t{\n\t\t\tthis.bringToFront();\n\t\t}\n\n\t\tif (!this.firstShow)\n\t\t{\n\t\t\tthis.emit('onFirstShow', new BaseEvent({ compatData: [this] }));\n\t\t\tthis.firstShow = true;\n\t\t}\n\n\t\tthis.emit('onShow', new BaseEvent({ compatData: [this] }));\n\n\t\tif (this.disableScroll)\n\t\t{\n\t\t\tthis.#disableTargetScroll();\n\t\t}\n\n\t\tthis.adjustPosition();\n\n\t\tthis.animateOpening(() => {\n\n\t\t\tif (this.isDestroyed())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.removeClass(this.getPopupContainer(), this.animationShowClassName);\n\t\t\tthis.emit('onAfterShow', new BaseEvent({ compatData: [this] }));\n\t\t});\n\n\t\tthis.bindClosingByEsc();\n\n\t\tif (this.isCompatibleMode())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.bindAutoHide();\n\t\t\t}, 100);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.bindAutoHide();\n\t\t}\n\t}\n\n\tclose(): void\n\t{\n\t\tif (this.isDestroyed() || !this.isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('onClose', new BaseEvent({ compatData: [this] }));\n\n\t\tif (this.isDestroyed())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.disableScroll)\n\t\t{\n\t\t\tthis.#enableTargetScroll();\n\t\t}\n\n\t\tthis.animateClosing(() => {\n\n\t\t\tif (this.isDestroyed())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.hideOverlay();\n\n\t\t\tthis.getPopupContainer().style.display = 'none';\n\t\t\tDom.removeClass(this.getPopupContainer(), '--open');\n\n\t\t\tDom.removeClass(this.getPopupContainer(), this.animationCloseClassName);\n\n\t\t\tthis.unbindClosingByEsc();\n\n\t\t\tif (this.isCompatibleMode())\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.unbindAutoHide();\n\t\t\t\t}, 0);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unbindAutoHide();\n\t\t\t}\n\n\t\t\tthis.emit('onAfterClose', new BaseEvent({ compatData: [this] }));\n\n\t\t\tif (!this.isCacheable())\n\t\t\t{\n\t\t\t\tthis.destroy();\n\t\t\t}\n\n\t\t});\n\t}\n\n\tbringToFront(): void\n\t{\n\t\tif (this.isShown())\n\t\t{\n\t\t\tZIndexManager.bringToFront(this.getPopupContainer());\n\t\t}\n\t}\n\n\ttoggle(): void\n\t{\n\t\tif (this.isShown())\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @private\n\t */\n\tanimateOpening(callback: Function): void\n\t{\n\t\tDom.removeClass(this.getPopupContainer(), this.animationCloseClassName);\n\n\t\tif (this.animationShowClassName === null)\n\t\t{\n\t\t\tcallback();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.getPopupContainer(), this.animationShowClassName);\n\n\t\t\tif (this.animationCloseEventType === null)\n\t\t\t{\n\t\t\t\tcallback();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst eventName = `${this.animationCloseEventType}end`;\n\t\t\t\tconst className = this.animationShowClassName;\n\t\t\t\tthis.getPopupContainer().addEventListener(eventName, function handleTransitionEnd(event) {\n\t\t\t\t\tif (!Dom.hasClass(event.target, className))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.removeEventListener(eventName, handleTransitionEnd);\n\n\t\t\t\t\tcallback();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tanimateClosing(callback: Function): void\n\t{\n\t\tDom.removeClass(this.getPopupContainer(), this.animationShowClassName);\n\n\t\tif (this.animationCloseClassName === null)\n\t\t{\n\t\t\tcallback();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.getPopupContainer(), this.animationCloseClassName);\n\n\t\t\tif (this.animationCloseEventType === null)\n\t\t\t{\n\t\t\t\tcallback();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst eventName = `${this.animationCloseEventType}end`;\n\t\t\t\tconst className = this.animationCloseClassName;\n\t\t\t\tthis.getPopupContainer().addEventListener(eventName, function handleTransitionEnd(event) {\n\t\t\t\t\tif (!Dom.hasClass(event.target, className))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.removeEventListener(eventName, handleTransitionEnd);\n\t\t\t\t\tcallback();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tsetAnimation(options: PopupAnimationOptions): void\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.animationShowClassName = Type.isStringFilled(options.showClassName) ? options.showClassName : null;\n\t\t\tthis.animationCloseClassName = Type.isStringFilled(options.closeClassName) ? options.closeClassName : null;\n\t\t\tthis.animationCloseEventType = (\n\t\t\t\toptions.closeAnimationType === 'animation' || options.closeAnimationType === 'transition'\n\t\t\t\t\t? options.closeAnimationType\n\t\t\t\t\t: null\n\t\t\t);\n\t\t}\n\t\telse if (Type.isStringFilled(options))\n\t\t{\n\t\t\tconst animationName = options;\n\t\t\tif (animationName === 'fading')\n\t\t\t{\n\t\t\t\tthis.animationShowClassName = 'popup-window-show-animation-opacity';\n\t\t\t\tthis.animationCloseClassName = 'popup-window-close-animation-opacity';\n\t\t\t\tthis.animationCloseEventType = 'animation';\n\t\t\t}\n\t\t\telse if (animationName === 'fading-slide')\n\t\t\t{\n\t\t\t\tthis.animationShowClassName = 'popup-window-show-animation-opacity-transform';\n\t\t\t\tthis.animationCloseClassName = 'popup-window-close-animation-opacity';\n\t\t\t\tthis.animationCloseEventType = 'animation';\n\t\t\t}\n\t\t\telse if (animationName === 'scale')\n\t\t\t{\n\t\t\t\tthis.animationShowClassName = 'popup-window-show-animation-scale';\n\t\t\t\tthis.animationCloseClassName = 'popup-window-close-animation-opacity';\n\t\t\t\tthis.animationCloseEventType = 'animation';\n\t\t\t}\n\t\t}\n\t\telse if (options === false || options === null)\n\t\t{\n\t\t\tthis.animationShowClassName = null;\n\t\t\tthis.animationCloseClassName = null;\n\t\t\tthis.animationCloseEventType = null;\n\t\t}\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn !this.isDestroyed() && this.getPopupContainer()?.style.display === 'block';\n\t}\n\n\tdestroy(): void\n\t{\n\t\tif (this.destroyed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.disableScroll)\n\t\t{\n\t\t\tthis.#enableTargetScroll();\n\t\t}\n\n\t\tthis.destroyed = true;\n\n\t\tthis.emit('onDestroy', new BaseEvent({ compatData: [this] }));\n\n\t\tthis.unbindClosingByEsc();\n\n\t\tif (this.isCompatibleMode())\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.unbindAutoHide();\n\t\t\t}, 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.unbindAutoHide();\n\t\t}\n\n\t\tEvent.unbindAll(this);\n\t\tEvent.unbind(document, 'mousemove', this.handleDocumentMouseMove);\n\t\tEvent.unbind(document, 'mouseup', this.handleDocumentMouseUp);\n\t\tEvent.unbind(window, 'resize', this.handleResizeWindow);\n\n\t\tthis.removeOverlay();\n\n\t\tZIndexManager.unregister(this.popupContainer);\n\t\tthis.zIndexComponent = null;\n\n\t\tDom.remove(this.popupContainer);\n\n\t\tthis.popupContainer = null;\n\t\tthis.contentContainer = null;\n\t\tthis.closeIcon = null;\n\t\tthis.titleBar = null;\n\t\tthis.buttonsContainer = null;\n\t\tthis.angle = null;\n\t\tthis.angleArrowElement = null;\n\t\tthis.resizeIcon = null;\n\t}\n\n\tadjustPosition(bindOptions: {\n\t\tforceBindPosition?: boolean,\n\t\tforceLeft?: boolean,\n\t\tforceTop?: boolean,\n\t\tposition?: 'top' | 'bootom'\n\t}): void\n\t{\n\t\tif (bindOptions && Type.isObject(bindOptions))\n\t\t{\n\t\t\tthis.bindOptions = bindOptions;\n\t\t}\n\n\t\tconst bindElementPos = this.getBindElementPos(this.bindElement);\n\n\t\tif (\n\t\t\t!this.bindOptions.forceBindPosition\n\t\t\t&& this.bindElementPos !== null\n\t\t\t&& bindElementPos.top === this.bindElementPos.top\n\t\t\t&& bindElementPos.left === this.bindElementPos.left\n\t\t)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst bindElementVanished = (\n\t\t\tbindElementPos.top === 0\n\t\t\t&& bindElementPos.left === 0\n\t\t\t&& bindElementPos.width === 0\n\t\t\t&& bindElementPos.height === 0\n\t\t);\n\n\t\tthis.bindElementPos = bindElementVanished && this.bindElementPos !== null ? this.bindElementPos : bindElementPos;\n\n\t\tconst windowSize = bindElementPos.windowSize ?? this.getWindowSize();\n\t\tconst windowScroll = bindElementPos.windowScroll ?? this.getWindowScroll();\n\n\t\tconst popupWidth = bindElementPos.popupWidth ?? this.popupContainer.offsetWidth;\n\t\tconst popupHeight = bindElementPos.popupHeight ?? this.popupContainer.offsetHeight;\n\n\t\tconst angleTopOffset = Popup.getOption('angleTopOffset');\n\n\t\tlet left = (\n\t\t\tthis.bindElementPos.left\n\t\t\t+ this.offsetLeft\n\t\t\t- (this.isTopOrBottomAngle() ? Popup.getOption('angleLeftOffset') : 0)\n\t\t);\n\n\t\tif (\n\t\t\t!this.bindOptions.forceLeft\n\t\t\t&& (left + popupWidth + this.bordersWidth) >= (windowSize.innerWidth + windowScroll.scrollLeft)\n\t\t\t&& (windowSize.innerWidth + windowScroll.scrollLeft - popupWidth - this.bordersWidth) > 0)\n\t\t{\n\t\t\tconst bindLeft = left;\n\t\t\tleft = windowSize.innerWidth + windowScroll.scrollLeft - popupWidth - this.bordersWidth;\n\t\t\tif (this.isTopOrBottomAngle())\n\t\t\t{\n\t\t\t\tthis.setAngle({ offset: bindLeft - left + this.angle.defaultOffset });\n\t\t\t}\n\t\t}\n\t\telse if (this.isTopOrBottomAngle())\n\t\t{\n\t\t\tthis.setAngle({ offset: this.angle.defaultOffset + (left < 0 ? left : 0) });\n\t\t}\n\n\t\tif (left < 0)\n\t\t{\n\t\t\tleft = 0;\n\t\t}\n\n\t\tlet top = 0;\n\n\t\tif (this.bindOptions.position && this.bindOptions.position === 'top')\n\t\t{\n\n\t\t\ttop = this.bindElementPos.top - popupHeight - this.offsetTop - (this.isBottomAngle() ? angleTopOffset : 0);\n\t\t\tif (top < 0 || (!this.bindOptions.forceTop && top < windowScroll.scrollTop))\n\t\t\t{\n\t\t\t\ttop = this.bindElementPos.bottom + this.offsetTop;\n\t\t\t\tif (this.angle !== null)\n\t\t\t\t{\n\t\t\t\t\ttop += angleTopOffset;\n\t\t\t\t\tthis.setAngle({ position: 'top' });\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.isTopAngle())\n\t\t\t{\n\t\t\t\ttop = top - angleTopOffset + Popup.getOption('positionTopXOffset');\n\t\t\t\tthis.setAngle({ position: 'bottom' });\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttop += Popup.getOption('positionTopXOffset');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttop = this.bindElementPos.bottom + this.offsetTop + this.getAngleHeight();\n\n\t\t\tif (\n\t\t\t\t!this.bindOptions.forceTop\n\t\t\t\t&& (top + popupHeight) > (windowSize.innerHeight + windowScroll.scrollTop)\n\t\t\t\t// Can we place the PopupWindow above the bindElement?\n\t\t\t\t&& (this.bindElementPos.top - popupHeight - this.getAngleHeight()) >= 0)\n\t\t\t{\n\t\t\t\t// The PopupWindow doesn't place below the bindElement. We should place it above.\n\t\t\t\ttop = this.bindElementPos.top - popupHeight;\n\n\t\t\t\tif (this.isTopOrBottomAngle())\n\t\t\t\t{\n\t\t\t\t\ttop -= angleTopOffset;\n\t\t\t\t\tthis.setAngle({ position: 'bottom' });\n\t\t\t\t}\n\n\t\t\t\ttop += Popup.getOption('positionTopXOffset');\n\t\t\t}\n\t\t\telse if (this.isBottomAngle())\n\t\t\t{\n\t\t\t\ttop += angleTopOffset;\n\t\t\t\tthis.setAngle({ position: 'top' });\n\t\t\t}\n\t\t}\n\n\t\tif (top < 0)\n\t\t{\n\t\t\ttop = 0;\n\t\t}\n\n\t\tconst event = new PositionEvent();\n\t\tevent.left = left;\n\t\tevent.top = top;\n\n\t\tthis.emit('onBeforeAdjustPosition', event);\n\n\t\tDom.adjust(this.popupContainer, {\n\t\t\tstyle: {\n\t\t\t\ttop: `${event.top}px`,\n\t\t\t\tleft: `${event.left}px`,\n\t\t\t},\n\t\t});\n\t}\n\n\tenterFullScreen(): void\n\t{\n\t\tif (Popup.fullscreenStatus)\n\t\t{\n\t\t\tif (document.cancelFullScreen)\n\t\t\t{\n\t\t\t\tdocument.cancelFullScreen();\n\t\t\t}\n\t\t\telse if (document.mozCancelFullScreen)\n\t\t\t{\n\t\t\t\tdocument.mozCancelFullScreen();\n\t\t\t}\n\t\t\telse if (document.webkitCancelFullScreen)\n\t\t\t{\n\t\t\t\tdocument.webkitCancelFullScreen();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (this.contentContainer.requestFullScreen)\n\t\t\t{\n\t\t\t\tthis.contentContainer.requestFullScreen();\n\t\t\t\tEvent.bind(window, 'fullscreenchange', this.handleFullScreen);\n\t\t\t}\n\t\t\telse if (this.contentContainer.mozRequestFullScreen)\n\t\t\t{\n\t\t\t\tthis.contentContainer.mozRequestFullScreen();\n\t\t\t\tEvent.bind(window, 'mozfullscreenchange', this.handleFullScreen);\n\t\t\t}\n\t\t\telse if (this.contentContainer.webkitRequestFullScreen)\n\t\t\t{\n\t\t\t\tthis.contentContainer.webkitRequestFullScreen();\n\t\t\t\tEvent.bind(window, 'webkitfullscreenchange', this.handleFullScreen);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconsole.log('fullscreen mode is not supported');\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleFullScreen(event): void\n\t{\n\t\tif (Popup.fullscreenStatus)\n\t\t{\n\t\t\tEvent.unbind(window, 'fullscreenchange', this.handleFullScreen);\n\t\t\tEvent.unbind(window, 'webkitfullscreenchange', this.handleFullScreen);\n\t\t\tEvent.unbind(window, 'mozfullscreenchange', this.handleFullScreen);\n\n\t\t\tPopup.fullscreenStatus = false;\n\n\t\t\tif (!this.isDestroyed())\n\t\t\t{\n\t\t\t\tDom.removeClass(this.contentContainer, 'popup-window-fullscreen');\n\t\t\t\tthis.emit('onFullscreenLeave');\n\t\t\t\tthis.adjustPosition();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tPopup.fullscreenStatus = true;\n\n\t\t\tif (!this.isDestroyed())\n\t\t\t{\n\t\t\t\tDom.addClass(this.contentContainer, 'popup-window-fullscreen');\n\t\t\t\tthis.emit('onFullscreenEnter');\n\t\t\t\tthis.adjustPosition();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleCloseIconClick(event): void\n\t{\n\t\tthis.tryCloseByEvent(event);\n\t\tevent.stopPropagation();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleContainerClick(event): void\n\t{\n\t\tevent.stopPropagation();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleDocumentKeyUp = (event): void => {\n\t\tif (event.keyCode === 27)\n\t\t{\n\t\t\tcheckEscPressed(this.getZindex(), () => {\n\t\t\t\tthis.close();\n\t\t\t});\n\t\t}\n\t};\n\n\t/**\n\t * @private\n\t */\n\thandleResizeWindow(): void\n\t{\n\t\tif (this.isShown())\n\t\t{\n\t\t\tthis.adjustPosition();\n\t\t\tif (this.overlay !== null)\n\t\t\t{\n\t\t\t\tthis.resizeOverlay();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleMove(offsetX: number, offsetY: number, pageX: number, pageY: number): void\n\t{\n\t\tlet left = parseInt(this.popupContainer.style.left, 10) + offsetX;\n\t\tlet top = parseInt(this.popupContainer.style.top, 10) + offsetY;\n\n\t\tif (Type.isObject(this.params.draggable) && this.params.draggable.restrict)\n\t\t{\n\t\t\t// Left side\n\t\t\tif (left < 0)\n\t\t\t{\n\t\t\t\tleft = 0;\n\t\t\t}\n\n\t\t\tlet scrollWidth;\n\t\t\tlet scrollHeight;\n\t\t\tif (this.isTargetDocumentBody())\n\t\t\t{\n\t\t\t\tscrollWidth = document.documentElement.scrollWidth;\n\t\t\t\tscrollHeight = document.documentElement.scrollHeight;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tscrollWidth = this.getTargetContainer().scrollWidth;\n\t\t\t\tscrollHeight = this.getTargetContainer().scrollHeight;\n\t\t\t}\n\n\t\t\t// Right side\n\t\t\tconst floatWidth = this.popupContainer.offsetWidth;\n\t\t\tconst floatHeight = this.popupContainer.offsetHeight;\n\n\t\t\tif (left > (scrollWidth - floatWidth))\n\t\t\t{\n\t\t\t\tleft = scrollWidth - floatWidth;\n\t\t\t}\n\n\t\t\tif (top > (scrollHeight - floatHeight))\n\t\t\t{\n\t\t\t\ttop = scrollHeight - floatHeight;\n\t\t\t}\n\n\t\t\t// Top side\n\t\t\tif (top < 0)\n\t\t\t{\n\t\t\t\ttop = 0;\n\t\t\t}\n\t\t}\n\n\t\tthis.popupContainer.style.left = `${left}px`;\n\t\tthis.popupContainer.style.top = `${top}px`;\n\t}\n\n\t/**\n\t * @private\n\t */\n\t#startDrag(event: MouseEvent, options): void\n\t{\n\t\toptions = options || {};\n\t\tif (Type.isStringFilled(options.cursor))\n\t\t{\n\t\t\tthis.dragOptions.cursor = options.cursor;\n\t\t}\n\n\t\tif (Type.isStringFilled(options.eventName))\n\t\t{\n\t\t\tthis.dragOptions.eventName = options.eventName;\n\t\t}\n\n\t\tif (Type.isFunction(options.callback))\n\t\t{\n\t\t\tthis.dragOptions.callback = options.callback;\n\t\t}\n\n\t\tthis.dragPageX = event.pageX;\n\t\tthis.dragPageY = event.pageY;\n\t\tthis.dragged = false;\n\n\t\tEvent.bind(document, 'mousemove', this.handleDocumentMouseMove);\n\t\tEvent.bind(document, 'mouseup', this.handleDocumentMouseUp);\n\n\t\tif (document.body.setCapture)\n\t\t{\n\t\t\tdocument.body.setCapture();\n\t\t}\n\n\t\tdocument.body.ondrag = () => false;\n\t\tdocument.body.onselectstart = () => false;\n\t\tdocument.body.style.cursor = this.dragOptions.cursor;\n\t\tdocument.body.style.MozUserSelect = 'none';\n\t\tthis.popupContainer.style.MozUserSelect = 'none';\n\n\t\tif (this.shouldFrontOnShow())\n\t\t{\n\t\t\tthis.bringToFront();\n\t\t}\n\n\t\tevent.preventDefault();\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleDocumentMouseMove(event): void\n\t{\n\t\tif (this.dragPageX === event.pageX && this.dragPageY === event.pageY)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.dragOptions.callback(\n\t\t\tevent.pageX - this.dragPageX,\n\t\t\tevent.pageY - this.dragPageY,\n\t\t\tevent.pageX,\n\t\t\tevent.pageY\n\t\t);\n\n\t\tthis.dragPageX = event.pageX;\n\t\tthis.dragPageY = event.pageY;\n\n\t\tif (!this.dragged)\n\t\t{\n\t\t\tthis.emit(`on${this.dragOptions.eventName}Start`, new BaseEvent({ compatData: [this] }));\n\t\t\tthis.dragged = true;\n\t\t}\n\n\t\tthis.emit(`on${this.dragOptions.eventName}`, new BaseEvent({ compatData: [this] }));\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleDocumentMouseUp(event: MouseEvent): void\n\t{\n\t\tif (document.body.releaseCapture)\n\t\t{\n\t\t\tdocument.body.releaseCapture();\n\t\t}\n\n\t\tEvent.unbind(document, 'mousemove', this.handleDocumentMouseMove);\n\t\tEvent.unbind(document, 'mouseup', this.handleDocumentMouseUp);\n\n\t\tdocument.body.ondrag = null;\n\t\tdocument.body.onselectstart = null;\n\t\tdocument.body.style.cursor = '';\n\t\tdocument.body.style.MozUserSelect = '';\n\t\tthis.popupContainer.style.MozUserSelect = '';\n\n\t\tthis.emit(`on${this.dragOptions.eventName}End`, new BaseEvent({ compatData: [this] }));\n\t\tthis.dragged = false;\n\n\t\tevent.preventDefault();\n\t}\n}\n\nlet escCallbackIndex = -1;\nlet escCallback = null;\n\nfunction checkEscPressed(zIndex, callback)\n{\n\tif (zIndex === false)\n\t{\n\t\tif (escCallback && escCallback.length > 0)\n\t\t{\n\t\t\tfor (let i = 0; i < escCallback.length; i++)\n\t\t\t{\n\t\t\t\tescCallback[i]();\n\t\t\t}\n\n\t\t\tescCallback = null;\n\t\t\tescCallbackIndex = -1;\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (escCallback === null)\n\t\t{\n\t\t\tescCallback = [];\n\t\t\tescCallbackIndex = -1;\n\t\t\tsetTimeout(() => {\n\t\t\t\tcheckEscPressed(false);\n\t\t\t}, 10);\n\t\t}\n\n\t\tif (zIndex > escCallbackIndex)\n\t\t{\n\t\t\tescCallbackIndex = zIndex;\n\t\t\tescCallback = [callback];\n\t\t}\n\t\telse if (zIndex === escCallbackIndex)\n\t\t{\n\t\t\tescCallback.push(callback);\n\t\t}\n\t}\n}\n","import Popup from './popup';\nimport { type PopupOptions } from './popup-types';\nimport { Type } from 'main.core';\nimport { EventEmitter, type BaseEvent } from 'main.core.events';\n\nexport default class PopupManager\n{\n\tstatic _popups: Popup[] = [];\n\tstatic _currentPopup: Popup = null;\n\n\tconstructor()\n\t{\n\t\tthrow new Error('You cannot make an instance of PopupManager.');\n\t}\n\n\tstatic create(options: PopupOptions): Popup\n\t{\n\t\tlet [popupId, bindElement, params] = arguments; //compatible arguments\n\n\t\tlet id = popupId;\n\t\tlet compatMode = true;\n\t\tif (Type.isPlainObject(popupId) && !bindElement && !params)\n\t\t{\n\t\t\tcompatMode = false;\n\t\t\tid = popupId.id;\n\t\t\tif (!Type.isStringFilled(id))\n\t\t\t{\n\t\t\t\tthrow new Error('BX.Main.Popup.Manager: \"id\" parameter is required.');\n\t\t\t}\n\t\t}\n\n\t\tlet popupWindow = this.getPopupById(id);\n\t\tif (popupWindow === null)\n\t\t{\n\t\t\tpopupWindow = compatMode ? new Popup(popupId, bindElement, params) : new Popup(options);\n\t\t\tpopupWindow.subscribe('onShow', this.handlePopupShow);\n\t\t\tpopupWindow.subscribe('onClose', this.handlePopupClose);\n\t\t}\n\n\t\treturn popupWindow;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic handleOnAfterInit(event: BaseEvent)\n\t{\n\t\tevent.getTarget().subscribeOnce('onDestroy', this.handlePopupDestroy);\n\n\t\tthis._popups.forEach(popup => {\n\t\t\tif (popup.getId() === event.getTarget().getId())\n\t\t\t{\n\t\t\t\tconsole.error(`Duplicate id (${popup.getId()}) for the BX.Main.Popup instance.`);\n\t\t\t}\n\t\t});\n\n\t\tthis._popups.push(event.getTarget());\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic handlePopupDestroy(event: BaseEvent)\n\t{\n\t\tthis._popups = this._popups.filter(popup => {\n\t\t\treturn popup !== event.getTarget();\n\t\t});\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic handlePopupShow(event: BaseEvent)\n\t{\n\t\tif (this._currentPopup !== null)\n\t\t{\n\t\t\tthis._currentPopup.close();\n\t\t}\n\n\t\tthis._currentPopup = event.getTarget();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tstatic handlePopupClose()\n\t{\n\t\tthis._currentPopup = null;\n\t}\n\n\tstatic getCurrentPopup(): Popup | null\n\t{\n\t\treturn this._currentPopup;\n\t}\n\n\tstatic isPopupExists(id): boolean\n\t{\n\t\treturn this.getPopupById(id) !== null;\n\t}\n\n\tstatic isAnyPopupShown(): boolean\n\t{\n\t\tfor (let i = 0, length = this._popups.length; i < length; i++)\n\t\t{\n\t\t\tif (this._popups[i].isShown())\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tstatic getPopupById(id): Popup | null\n\t{\n\t\tfor (let i = 0; i < this._popups.length; i++)\n\t\t{\n\t\t\tif (this._popups[i].getId() === id)\n\t\t\t{\n\t\t\t\treturn this._popups[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tstatic getMaxZIndex(): number\n\t{\n\t\tlet zIndex = 0;\n\n\t\tthis.getPopups().forEach((popup: Popup) => {\n\t\t\tzIndex = Math.max(zIndex, popup.getZindex());\n\t\t});\n\n\t\treturn zIndex;\n\t}\n\n\tstatic getPopups(): Popup[]\n\t{\n\t\treturn this._popups;\n\t}\n}\n\nPopupManager.handlePopupDestroy = PopupManager.handlePopupDestroy.bind(PopupManager);\nPopupManager.handlePopupShow = PopupManager.handlePopupShow.bind(PopupManager);\nPopupManager.handlePopupClose = PopupManager.handlePopupClose.bind(PopupManager);\nPopupManager.handleOnAfterInit = PopupManager.handleOnAfterInit.bind(PopupManager);\n\nEventEmitter.subscribe('BX.Main.Popup:onAfterInit', PopupManager.handleOnAfterInit);","import Menu from './menu';\nimport { Type, Text, Dom, Event, Tag } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { MenuItemOptions } from './menu-types';\n\nconst aliases = {\n\tonSubMenuShow: { namespace: 'BX.Main.Menu.Item', eventName: 'SubMenu:onShow' },\n\tonSubMenuClose: { namespace: 'BX.Main.Menu.Item', eventName: 'SubMenu:onClose' }\n};\n\nconst reEscape = /[<>'\"]/g;\nconst escapeEntities = {\n\t'<': '&lt;',\n\t'>': '&gt;',\n\t\"'\": '&#39;',\n\t'\"': '&quot;',\n};\n\nfunction encodeSafe(value: string): string\n{\n\tif (Type.isString(value))\n\t{\n\t\treturn value.replace(reEscape, item => escapeEntities[item]);\n\t}\n\n\treturn value;\n}\n\nEventEmitter.registerAliases(aliases);\n\nexport default class MenuItem extends EventEmitter\n{\n\tconstructor(options: MenuItemOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Main.Menu.Item');\n\n\t\toptions = options || {};\n\t\tthis.options = options;\n\n\t\tthis.id = options.id || Text.getRandom();\n\n\t\tthis.text = '';\n\t\tthis.allowHtml = false;\n\t\tif (Type.isStringFilled(options.html) || Type.isElementNode(options.html))\n\t\t{\n\t\t\tthis.text = options.html;\n\t\t\tthis.allowHtml = true;\n\t\t}\n\t\telse if (Type.isStringFilled(options.text))\n\t\t{\n\t\t\tthis.text = options.text;\n\t\t\tif (this.text.match(/<[^>]+>/))\n\t\t\t{\n\t\t\t\tconsole.warn('BX.Main.MenuItem: use \"html\" option for the html item content.', this.getText());\n\t\t\t}\n\t\t}\n\n\t\tthis.title = Type.isStringFilled(options.title) ? options.title : '';\n\t\tthis.delimiter = options.delimiter === true;\n\t\tthis.href = Type.isStringFilled(options.href) ? options.href : null;\n\t\tthis.target = Type.isStringFilled(options.target) ? options.target : null;\n\t\tthis.dataset = Type.isPlainObject(options.dataset) ? options.dataset : null;\n\t\tthis.className = Type.isStringFilled(options.className) ? options.className : null;\n\t\tthis.menuShowDelay = Type.isNumber(options.menuShowDelay) ? options.menuShowDelay : 300;\n\t\tthis.subMenuOffsetX = Type.isNumber(options.subMenuOffsetX) ? options.subMenuOffsetX : 4;\n\t\tthis._items = Type.isArray(options.items) ? options.items : [];\n\t\tthis.disabled = options.disabled === true;\n\t\tthis.cacheable = options.cacheable === true;\n\n\t\t/**\n\t\t *\n\t\t * @type {function|string}\n\t\t */\n\t\tthis.onclick =\n\t\t\tType.isStringFilled(options.onclick) || Type.isFunction(options.onclick)\n\t\t\t\t? options.onclick\n\t\t\t\t: null\n\t\t;\n\n\t\tthis.subscribeFromOptions(options.events, aliases);\n\n\t\t/**\n\t\t *\n\t\t * @type {Menu}\n\t\t */\n\t\tthis.menuWindow = null;\n\n\t\t/**\n\t\t *\n\t\t * @type {Menu}\n\t\t */\n\t\tthis.subMenuWindow = null;\n\n\t\t/**\n\t\t *\n\t\t * @type {{item: HTMLElement, text: HTMLElement}}\n\t\t */\n\t\tthis.layout = {\n\t\t\titem: null,\n\t\t\ttext: null\n\t\t};\n\n\t\tthis.getLayout(); //compatibility\n\n\t\t//compatibility\n\t\t//now use this.options\n\t\tthis.events = {};\n\t\tthis.items = [];\n\t\tfor (let property in options)\n\t\t{\n\t\t\tif (options.hasOwnProperty(property) && typeof (this[property]) === 'undefined')\n\t\t\t{\n\t\t\t\tthis[property] = options[property];\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLayout(): Element\n\t{\n\t\tif (this.layout.item)\n\t\t{\n\t\t\treturn this.layout;\n\t\t}\n\n\t\tif (this.delimiter)\n\t\t{\n\t\t\tif (Type.isStringFilled(this.getText()))\n\t\t\t{\n\t\t\t\tthis.layout.item = Dom.create('span', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: [\n\t\t\t\t\t\t\t'popup-window-delimiter-section',\n\t\t\t\t\t\t\tthis.className ? this.className : '',\n\t\t\t\t\t\t].join(' ')\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\t(this.layout.text = Tag.render`\n\t\t\t\t\t\t\t<span class=\"popup-window-delimiter-text\">${\n\t\t\t\t\t\t\t\tthis.allowHtml ? this.getText() : encodeSafe(this.getText())\n\t\t\t\t\t\t\t}</span>\n\t\t\t\t\t\t`)\n\t\t\t\t\t]\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.layout.item = Tag.render`<span class=\"popup-window-delimiter\">`;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.layout.item = Dom.create(this.href ? 'a' : 'span', {\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: [\n\t\t\t\t\t\t'menu-popup-item',\n\t\t\t\t\t\t(this.className ? this.className : 'menu-popup-no-icon'),\n\t\t\t\t\t\t(this.hasSubMenu() ? 'menu-popup-item-submenu' : '')\n\t\t\t\t\t].join(' ')\n\t\t\t\t},\n\n\t\t\t\tattrs: {\n\t\t\t\t\ttitle: this.title,\n\t\t\t\t\tonclick: Type.isString(this.onclick) ? this.onclick : '', // compatibility\n\t\t\t\t\ttarget: this.target ? this.target : ''\n\t\t\t\t},\n\n\t\t\t\tdataset: this.dataset,\n\n\t\t\t\tevents:\n\t\t\t\t\tType.isFunction(this.onclick)\n\t\t\t\t\t\t? { click: this.onItemClick.bind(this) }\n\t\t\t\t\t\t: null\n\t\t\t\t,\n\n\t\t\t\tchildren: [\n\t\t\t\t\tDom.create('span', { props: { className: 'menu-popup-item-icon' } }),\n\t\t\t\t\t(this.layout.text = Tag.render`\n\t\t\t\t\t\t<span class=\"menu-popup-item-text\">${\n\t\t\t\t\t\t\tthis.allowHtml ? this.getText() : encodeSafe(this.getText())\n\t\t\t\t\t\t}</span>\n\t\t\t\t\t`)\n\t\t\t\t]\n\t\t\t});\n\n\t\t\tif (this.href)\n\t\t\t{\n\t\t\t\tthis.layout.item.href = this.href;\n\t\t\t}\n\n\t\t\tif (this.isDisabled())\n\t\t\t{\n\t\t\t\tthis.disable();\n\t\t\t}\n\n\t\t\tEvent.bind(this.layout.item, 'mouseenter', this.onItemMouseEnter.bind(this));\n\t\t\tEvent.bind(this.layout.item, 'mouseleave', this.onItemMouseLeave.bind(this));\n\t\t}\n\n\t\treturn this.layout;\n\t}\n\n\tgetContainer(): Element\n\t{\n\t\treturn this.getLayout().item;\n\t}\n\n\tgetTextContainer(): Element\n\t{\n\t\treturn this.getLayout().text;\n\t}\n\n\tgetText(): string | HTMLElement\n\t{\n\t\treturn this.text;\n\t}\n\n\tsetText(text: string | HTMLElement, allowHtml = false)\n\t{\n\t\tif (Type.isString(text) || Type.isElementNode(text))\n\t\t{\n\t\t\tthis.allowHtml = allowHtml;\n\t\t\tthis.text = text;\n\n\t\t\tif (Type.isElementNode(text))\n\t\t\t{\n\t\t\t\tDom.clean(this.getTextContainer());\n\t\t\t\tif (this.allowHtml)\n\t\t\t\t{\n\t\t\t\t\tDom.append(text, this.getTextContainer());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.getTextContainer().innerHTML = encodeSafe(text.outerHTML);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getTextContainer().innerHTML = this.allowHtml ? text : encodeSafe(text);\n\t\t\t}\n\t\t}\n\t}\n\n\thasSubMenu(): boolean\n\t{\n\t\treturn this.subMenuWindow !== null || this._items.length;\n\t}\n\n\tshowSubMenu(): void\n\t{\n\t\tif (!this.getMenuWindow().getPopupWindow().isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addSubMenu(this._items);\n\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tDom.addClass(this.layout.item, 'menu-popup-item-open');\n\n\t\t\tthis.closeSiblings();\n\t\t\tthis.closeChildren();\n\n\t\t\tconst popupWindow = this.subMenuWindow.getPopupWindow();\n\t\t\tif (!popupWindow.isShown())\n\t\t\t{\n\t\t\t\tthis.emit('SubMenu:onShow');\n\t\t\t\tpopupWindow.show();\n\t\t\t}\n\n\t\t\tthis.adjustSubMenu();\n\t\t}\n\t}\n\n\taddSubMenu(items: []): Menu\n\t{\n\t\tif (this.subMenuWindow !== null || !Type.isArray(items) || !items.length)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst rootMenuWindow = this.getMenuWindow().getRootMenuWindow() || this.getMenuWindow();\n\t\tconst rootOptions = Object.assign({}, rootMenuWindow.params);\n\t\tdelete rootOptions.events;\n\n\t\tconst subMenuOptions =\n\t\t\tType.isPlainObject(rootMenuWindow.params.subMenuOptions) ? rootMenuWindow.params.subMenuOptions : {}\n\t\t;\n\n\t\tconst options = Object.assign({}, rootOptions, subMenuOptions);\n\n\t\t//Override root menu options\n\t\toptions.autoHide = false;\n\t\toptions.menuShowDelay = this.menuShowDelay;\n\t\toptions.cacheable = this.isCacheable();\n\t\toptions.targetContainer = this.getMenuWindow().getPopupWindow().getTargetContainer();\n\t\toptions.bindOptions = {\n\t\t\tforceTop: true,\n\t\t\tforceLeft: true,\n\t\t\tforceBindPosition: true\n\t\t};\n\n\t\tdelete options.angle;\n\t\tdelete options.overlay;\n\n\t\tthis.subMenuWindow = new Menu('popup-submenu-' + this.id, this.layout.item, items, options);\n\t\tthis.subMenuWindow.setParentMenuWindow(this.getMenuWindow());\n\t\tthis.subMenuWindow.setParentMenuItem(this);\n\n\t\tthis.subMenuWindow.getPopupWindow().subscribe('onDestroy', this.handleSubMenuDestroy.bind(this));\n\t\tDom.addClass(this.layout.item, 'menu-popup-item-submenu');\n\n\t\treturn this.subMenuWindow;\n\t}\n\n\tcloseSubMenu(): void\n\t{\n\t\tthis.clearSubMenuTimeout();\n\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tDom.removeClass(this.layout.item, 'menu-popup-item-open');\n\n\t\t\tthis.closeChildren();\n\n\t\t\tconst popup = this.subMenuWindow.getPopupWindow();\n\t\t\tif (popup.isShown())\n\t\t\t{\n\t\t\t\tthis.emit('SubMenu:onClose');\n\t\t\t}\n\n\t\t\tthis.subMenuWindow.close();\n\t\t}\n\t}\n\n\tcloseSiblings(): void\n\t{\n\t\tconst siblings = this.menuWindow.getMenuItems();\n\t\tfor (let i = 0; i < siblings.length; i++)\n\t\t{\n\t\t\tif (siblings[i] !== this)\n\t\t\t{\n\t\t\t\tsiblings[i].closeSubMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\tcloseChildren(): void\n\t{\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tconst children = this.subMenuWindow.getMenuItems();\n\t\t\tfor (let i = 0; i < children.length; i++)\n\t\t\t{\n\t\t\t\tchildren[i].closeSubMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroySubMenu(): void\n\t{\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tDom.removeClass(this.layout.item, 'menu-popup-item-open menu-popup-item-submenu');\n\t\t\tthis.destroyChildren();\n\t\t\tthis.subMenuWindow.destroy();\n\n\t\t\tthis.subMenuWindow = null;\n\t\t\tthis._items = [];\n\t\t}\n\t}\n\n\tdestroyChildren(): void\n\t{\n\t\tif (this.subMenuWindow)\n\t\t{\n\t\t\tconst children = this.subMenuWindow.getMenuItems();\n\t\t\tfor (let i = 0; i < children.length; i++)\n\t\t\t{\n\t\t\t\tchildren[i].destroySubMenu();\n\t\t\t}\n\t\t}\n\t}\n\n\tadjustSubMenu(): void\n\t{\n\t\tif (!this.subMenuWindow || !this.layout.item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst popupWindow = this.subMenuWindow.getPopupWindow();\n\t\tconst itemRect = this.getBoundingClientRect();\n\n\t\tlet offsetLeft = itemRect.width + this.subMenuOffsetX;\n\t\tlet offsetTop = itemRect.height + this.getPopupPadding();\n\t\tlet angleOffset = itemRect.height / 2 - this.getPopupPadding();\n\t\tlet anglePosition = 'left';\n\n\t\tconst popupWidth = popupWindow.getPopupContainer().offsetWidth;\n\t\tconst popupHeight = popupWindow.getPopupContainer().offsetHeight;\n\t\tconst popupBottom = itemRect.top + popupHeight;\n\n\t\tconst targetContainer = this.getMenuWindow().getPopupWindow().getTargetContainer();\n\t\tconst isGlobalContext = this.getMenuWindow().getPopupWindow().isTargetDocumentBody();\n\t\tconst clientWidth = isGlobalContext ? document.documentElement.clientWidth : targetContainer.offsetWidth;\n\t\tconst clientHeight = isGlobalContext ? document.documentElement.clientHeight : targetContainer.offsetHeight;\n\n\t\t// let's try to fit a submenu to the browser viewport\n\t\tconst exceeded = popupBottom - clientHeight;\n\t\tif (exceeded > 0)\n\t\t{\n\t\t\tlet roundOffset = Math.ceil(exceeded / itemRect.height) * itemRect.height;\n\t\t\tif (roundOffset > itemRect.top)\n\t\t\t{\n\t\t\t\t// it cannot be higher than the browser viewport.\n\t\t\t\troundOffset -= Math.ceil((roundOffset - itemRect.top) / itemRect.height) * itemRect.height;\n\t\t\t}\n\n\t\t\tif (itemRect.bottom > (popupBottom - roundOffset))\n\t\t\t{\n\t\t\t\t// let's sync bottom boundaries.\n\t\t\t\troundOffset -= itemRect.bottom - (popupBottom - roundOffset) + this.getPopupPadding();\n\t\t\t}\n\n\t\t\toffsetTop += roundOffset;\n\t\t\tangleOffset += roundOffset;\n\t\t}\n\n\t\tif ((itemRect.left + offsetLeft + popupWidth) > clientWidth)\n\t\t{\n\t\t\tconst left = itemRect.left - popupWidth - this.subMenuOffsetX;\n\t\t\tif (left > 0)\n\t\t\t{\n\t\t\t\toffsetLeft = -popupWidth - this.subMenuOffsetX;\n\t\t\t\tanglePosition = 'right';\n\t\t\t}\n\t\t}\n\n\t\tpopupWindow.setBindElement(this.layout.item);\n\t\tpopupWindow.setOffset({ offsetLeft: offsetLeft, offsetTop: -offsetTop });\n\t\tpopupWindow.setAngle({ position: anglePosition, offset: angleOffset });\n\t\tpopupWindow.adjustPosition();\n\t}\n\n\tgetBoundingClientRect(): DOMRect\n\t{\n\t\tconst popup = this.getMenuWindow().getPopupWindow();\n\t\tif (popup.isTargetDocumentBody())\n\t\t{\n\t\t\treturn this.layout.item.getBoundingClientRect();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst rect = popup.getPositionRelativeToTarget(this.layout.item);\n\t\t\tconst targetContainer = this.getMenuWindow().getPopupWindow().getTargetContainer();\n\n\t\t\treturn new DOMRect(\n\t\t\t\trect.left - targetContainer.scrollLeft,\n\t\t\t\trect.top - targetContainer.scrollTop,\n\t\t\t\trect.width,\n\t\t\t\trect.height\n\t\t\t);\n\t\t}\n\t}\n\n\tgetPopupPadding(): number\n\t{\n\t\tif (!Type.isNumber(this.popupPadding))\n\t\t{\n\t\t\tif (this.subMenuWindow)\n\t\t\t{\n\t\t\t\tconst menuContainer = this.subMenuWindow.layout.menuContainer;\n\t\t\t\tthis.popupPadding = parseInt(Dom.style(menuContainer, 'paddingTop'), 10);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.popupPadding = 0;\n\t\t\t}\n\t\t}\n\n\t\treturn this.popupPadding;\n\t}\n\n\tgetSubMenu(): Menu | null\n\t{\n\t\treturn this.subMenuWindow;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\tsetMenuWindow(menu: Menu): string\n\t{\n\t\tthis.menuWindow = menu;\n\t}\n\n\tgetMenuWindow(): Menu | null\n\t{\n\t\treturn this.menuWindow;\n\t}\n\n\tgetMenuShowDelay(): number\n\t{\n\t\treturn this.menuShowDelay;\n\t}\n\n\tenable(): void\n\t{\n\t\tthis.disabled = false;\n\t\tthis.getContainer().classList.remove('menu-popup-item-disabled');\n\t}\n\n\tdisable(): void\n\t{\n\t\tthis.disabled = true;\n\t\tthis.closeSubMenu();\n\t\tthis.getContainer().classList.add('menu-popup-item-disabled');\n\t}\n\n\tisDisabled(): boolean\n\t{\n\t\treturn this.disabled;\n\t}\n\n\tsetCacheable(cacheable): void\n\t{\n\t\tthis.cacheable = cacheable !== false;\n\t}\n\n\tisCacheable(): boolean\n\t{\n\t\treturn this.cacheable;\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonItemClick(event): void\n\t{\n\t\tthis.onclick.call(this.menuWindow, event, this); //compatibility\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonItemMouseEnter(mouseEvent: MouseEvent): void\n\t{\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = new BaseEvent({ data: { mouseEvent } });\n\t\tEventEmitter.emit(this, 'onMouseEnter', event, { thisArg: this });\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clearSubMenuTimeout();\n\n\t\tif (this.hasSubMenu())\n\t\t{\n\t\t\tthis.subMenuTimeout = setTimeout(function() {\n\t\t\t\tthis.showSubMenu();\n\t\t\t}.bind(this), this.menuShowDelay);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.subMenuTimeout = setTimeout(function() {\n\t\t\t\tthis.closeSiblings();\n\t\t\t}.bind(this), this.menuShowDelay);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\tonItemMouseLeave(mouseEvent: MouseEvent): void\n\t{\n\t\tif (this.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = new BaseEvent({ data: { mouseEvent } });\n\t\tEventEmitter.emit(this, 'onMouseLeave', event, { thisArg: this });\n\t\tif (event.isDefaultPrevented())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.clearSubMenuTimeout();\n\t}\n\n\t/**\n\t * @private\n\t */\n\tclearSubMenuTimeout(): void\n\t{\n\t\tif (this.subMenuTimeout)\n\t\t{\n\t\t\tclearTimeout(this.subMenuTimeout);\n\t\t}\n\n\t\tthis.subMenuTimeout = null;\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleSubMenuDestroy(): void\n\t{\n\t\tthis.subMenuWindow = null;\n\t}\n}","import MenuItem from './menu-item';\nimport Popup from '../popup/popup';\nimport { Type, Text, Tag } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { type MenuOptions, type MenuItemOptions } from './menu-types';\nimport { type PopupTargetOptions } from '../popup/popup-types';\n\n/**\n * @memberof BX.Main\n */\nexport default class Menu extends EventEmitter\n{\n\tconstructor(options: MenuOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Main.Menu');\n\n\t\tlet [\n\t\t\tid: string,\n\t\t\tbindElement: PopupTargetOptions,\n\t\t\tmenuItems: MenuItemOptions[],\n\t\t\tparams: MenuOptions,\n\t\t] = arguments;\n\n\t\tif (Type.isPlainObject(options) && !bindElement && !menuItems && !params)\n\t\t{\n\t\t\tparams = options;\n\t\t\tparams.compatibleMode = false;\n\n\t\t\tid = options.id;\n\t\t\tbindElement = options.bindElement;\n\t\t\tmenuItems = options.items;\n\n\t\t\tif (!Type.isStringFilled(id))\n\t\t\t{\n\t\t\t\tid = `menu-popup-${Text.getRandom()}`;\n\t\t\t}\n\t\t}\n\n\t\tthis.emit('onInit', { id, bindElement, menuItems, params });\n\n\t\tthis.id = id;\n\t\tthis.bindElement = bindElement;\n\n\t\t/**\n\t\t *\n\t\t * @type {MenuItem[]}\n\t\t */\n\t\tthis.menuItems = [];\n\t\tthis.itemsContainer = null;\n\t\tthis.params = params && typeof (params) === 'object' ? params : {};\n\t\tthis.parentMenuWindow = null;\n\t\tthis.parentMenuItem = null;\n\n\t\tif (menuItems && Type.isArray(menuItems))\n\t\t{\n\t\t\tfor (let i = 0; i < menuItems.length; i++)\n\t\t\t{\n\t\t\t\tthis.addMenuItemInternal(menuItems[i], null);\n\t\t\t}\n\t\t}\n\n\t\tthis.layout = {\n\t\t\tmenuContainer: null,\n\t\t\titemsContainer: null\n\t\t};\n\n\t\tthis.popupWindow = this.__createPopup();\n\t}\n\n\t/**\n\t * @private\n\t */\n\t__createPopup(): Popup\n\t{\n\t\tconst domItems = [];\n\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t{\n\t\t\tconst item = this.menuItems[i];\n\t\t\tconst itemLayout = item.getLayout();\n\t\t\tdomItems.push(itemLayout.item);\n\t\t}\n\n\t\tconst defaults = {\n\t\t\tcloseByEsc: false,\n\t\t\tangle: false,\n\t\t\tautoHide: true,\n\t\t\toffsetTop: 1,\n\t\t\toffsetLeft: 0,\n\t\t\tanimation: 'fading'\n\t\t};\n\n\t\tconst options = Object.assign(defaults, this.params);\n\n\t\t//Override user params\n\t\toptions.noAllPaddings = true;\n\t\toptions.darkMode = false;\n\t\toptions.autoHideHandler = this.handleAutoHide.bind(this);\n\n\t\tthis.layout.itemsContainer = Tag.render`\n\t\t\t<div class=\"menu-popup-items\">${domItems}</div>\n\t\t`;\n\n\t\tthis.layout.menuContainer = Tag.render`\n\t\t\t<div class=\"menu-popup\">${this.layout.itemsContainer}</div>\n\t\t`;\n\n\t\tthis.itemsContainer = this.layout.itemsContainer;\n\t\toptions.content = this.layout.menuContainer;\n\n\t\t//Make internal event handlers first in the queue.\n\t\toptions.events = {\n\t\t\tonClose: this.handlePopupClose.bind(this),\n\t\t\tonDestroy: this.handlePopupDestroy.bind(this)\n\t\t};\n\n\t\tconst id = options.compatibleMode === false ? this.getId() : 'menu-popup-' + this.getId();\n\t\tconst popup = new Popup(id, this.bindElement, options);\n\t\tif (this.params && this.params.events)\n\t\t{\n\t\t\tpopup.subscribeFromOptions(this.params.events);\n\t\t}\n\n\t\treturn popup;\n\t}\n\n\tgetPopupWindow(): Popup\n\t{\n\t\treturn this.popupWindow;\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.getPopupWindow().show();\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.getPopupWindow().close();\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.getPopupWindow().destroy();\n\t}\n\n\ttoggle(): void\n\t{\n\t\tif (this.getPopupWindow().isShown())\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t}\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.id;\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupClose(): void\n\t{\n\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t{\n\t\t\tconst item = this.menuItems[i];\n\t\t\titem.closeSubMenu();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandlePopupDestroy(): void\n\t{\n\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t{\n\t\t\tconst item = this.menuItems[i];\n\t\t\titem.destroySubMenu();\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\thandleAutoHide(event): boolean\n\t{\n\t\treturn !this.containsTarget(event.target);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tcontainsTarget(target: Element): boolean\n\t{\n\t\tconst el = this.getPopupWindow().getPopupContainer();\n\t\tif (this.getPopupWindow().isShown() && (target === el || el.contains(target)))\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn this.getMenuItems().some(function(item: MenuItem) {\n\n\t\t\treturn item.getSubMenu() && item.getSubMenu().containsTarget(target);\n\n\t\t});\n\t}\n\n\tsetParentMenuWindow(parentMenu: Menu): void\n\t{\n\t\tif (parentMenu instanceof Menu)\n\t\t{\n\t\t\tthis.parentMenuWindow = parentMenu;\n\t\t}\n\t}\n\n\tgetParentMenuWindow(): Menu | null\n\t{\n\t\treturn this.parentMenuWindow;\n\t}\n\n\tgetRootMenuWindow(): Menu | null\n\t{\n\t\tlet root = null;\n\t\tlet parent = this.getParentMenuWindow();\n\t\twhile (parent !== null)\n\t\t{\n\t\t\troot = parent;\n\t\t\tparent = parent.getParentMenuWindow();\n\t\t}\n\n\t\treturn root;\n\t}\n\n\tsetParentMenuItem(parentItem: MenuItem): void\n\t{\n\t\tif (parentItem instanceof MenuItem)\n\t\t{\n\t\t\tthis.parentMenuItem = parentItem;\n\t\t}\n\t}\n\n\tgetParentMenuItem(): MenuItem | null\n\t{\n\t\treturn this.parentMenuItem;\n\t}\n\n\taddMenuItem(menuItemJson: any, targetItemId: string): MenuItem\n\t{\n\t\tconst menuItem = this.addMenuItemInternal(menuItemJson, targetItemId);\n\t\tif (!menuItem)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst itemLayout = menuItem.getLayout();\n\t\tconst targetItem = this.getMenuItem(targetItemId);\n\t\tif (targetItem !== null)\n\t\t{\n\t\t\tconst targetLayout = targetItem.getLayout();\n\t\t\tthis.itemsContainer.insertBefore(itemLayout.item, targetLayout.item);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.itemsContainer.appendChild(itemLayout.item);\n\t\t}\n\n\t\treturn menuItem;\n\t}\n\n\t/**\n\t * @private\n\t */\n\taddMenuItemInternal(menuItemJson: any, targetItemId: string): MenuItem\n\t{\n\t\tif (\n\t\t\t!menuItemJson ||\n\t\t\t(\n\t\t\t\t!menuItemJson.delimiter &&\n\t\t\t\t!Type.isStringFilled(menuItemJson.text) &&\n\t\t\t\t!Type.isStringFilled(menuItemJson.html) &&\n\t\t\t\t!Type.isElementNode(menuItemJson.html)\n\t\t\t) ||\n\t\t\t(menuItemJson.id && this.getMenuItem(menuItemJson.id) !== null)\n\t\t)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (Type.isNumber(this.params.menuShowDelay))\n\t\t{\n\t\t\tmenuItemJson.menuShowDelay = this.params.menuShowDelay;\n\t\t}\n\n\t\tconst menuItem = new MenuItem(menuItemJson);\n\t\tmenuItem.setMenuWindow(this);\n\n\t\tconst position = this.getMenuItemPosition(targetItemId);\n\t\tif (position >= 0)\n\t\t{\n\t\t\tthis.menuItems.splice(position, 0, menuItem);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.menuItems.push(menuItem);\n\t\t}\n\n\t\treturn menuItem;\n\t}\n\n\tremoveMenuItem(itemId: string, options = {\n\t\tdestroyEmptyPopup: true,\n\t}): void\n\t{\n\t\tconst item = this.getMenuItem(itemId);\n\t\tif (!item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let position = 0; position < this.menuItems.length; position++)\n\t\t{\n\t\t\tif (this.menuItems[position] === item)\n\t\t\t{\n\t\t\t\titem.destroySubMenu();\n\t\t\t\tthis.menuItems.splice(position, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!this.menuItems.length)\n\t\t{\n\t\t\tconst menuWindow = item.getMenuWindow();\n\t\t\tif (menuWindow)\n\t\t\t{\n\t\t\t\tconst parentMenuItem = menuWindow.getParentMenuItem();\n\t\t\t\tif (parentMenuItem)\n\t\t\t\t{\n\t\t\t\t\tparentMenuItem.destroySubMenu();\n\t\t\t\t}\n\t\t\t\telse if (options.destroyEmptyPopup)\n\t\t\t\t{\n\t\t\t\t\tmenuWindow.destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\titem.layout.item.parentNode.removeChild(item.layout.item);\n\t\titem.layout = {\n\t\t\titem: null,\n\t\t\ttext: null\n\t\t};\n\t}\n\n\tgetMenuItem(itemId: string): MenuItem | null\n\t{\n\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t{\n\t\t\tif (this.menuItems[i].id && this.menuItems[i].id === itemId)\n\t\t\t{\n\t\t\t\treturn this.menuItems[i];\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetMenuItems(): MenuItem[]\n\t{\n\t\treturn this.menuItems;\n\t}\n\n\tgetMenuItemPosition(itemId: string): number\n\t{\n\t\tif (itemId)\n\t\t{\n\t\t\tfor (let i = 0; i < this.menuItems.length; i++)\n\t\t\t{\n\t\t\t\tif (this.menuItems[i].id && this.menuItems[i].id === itemId)\n\t\t\t\t{\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\tgetMenuContainer()\n\t{\n\t\treturn this.getPopupWindow().getPopupContainer();\n\t}\n}\n","import Menu from './menu';\nimport { Type } from 'main.core';\nimport { MenuOptions } from './menu-types';\n\nexport default class MenuManager\n{\n\t/**\n\t * @private\n\t */\n\tstatic Data: { [id: string]: Menu } = {};\n\n\t/**\n\t * @private\n\t */\n\tstatic currentItem: ? Menu = null;\n\n\tconstructor()\n\t{\n\t\tthrow new Error('You cannot make an instance of MenuManager.');\n\t}\n\n\tstatic show(...args)\n\t{\n\t\tif (this.currentItem !== null)\n\t\t{\n\t\t\tthis.currentItem.popupWindow.close();\n\t\t}\n\n\t\tthis.currentItem = this.create.apply(this, args);\n\t\tthis.currentItem.popupWindow.show();\n\t}\n\n\tstatic create(options: MenuOptions)\n\t{\n\t\tlet menuId = null;\n\n\t\t//Compatibility\n\t\tconst bindElement = arguments[1];\n\t\tconst menuItems = arguments[2];\n\t\tconst params = arguments[3];\n\n\t\tif (Type.isPlainObject(options) && !bindElement && !menuItems && !params)\n\t\t{\n\t\t\tmenuId = options.id;\n\t\t\tif (!Type.isStringFilled(menuId))\n\t\t\t{\n\t\t\t\tthrow new Error('BX.Main.Menu.create: \"id\" parameter is required.');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tmenuId = options;\n\t\t}\n\n\t\tif (!this.Data[menuId])\n\t\t{\n\t\t\tconst menu = new Menu(options, bindElement, menuItems, params);\n\t\t\tmenu.getPopupWindow().subscribe('onDestroy', () => {\n\t\t\t\tMenuManager.destroy(menuId);\n\t\t\t});\n\n\t\t\tthis.Data[menuId] = menu;\n\t\t}\n\n\t\treturn this.Data[menuId];\n\t}\n\n\tstatic getCurrentMenu(): Menu | null\n\t{\n\t\treturn this.currentItem;\n\t}\n\n\tstatic getMenuById(id): Menu | null\n\t{\n\t\treturn this.Data[id] ? this.Data[id] : null;\n\t}\n\n\t/**\n\t * compatibility\n\t * @private\n\t */\n\tstatic onPopupDestroy(popupMenuWindow: Menu)\n\t{\n\t\tthis.destroy(popupMenuWindow.id);\n\t}\n\n\tstatic destroy(id)\n\t{\n\t\tconst menu = this.getMenuById(id);\n\t\tif (menu)\n\t\t{\n\t\t\tif (this.currentItem === menu)\n\t\t\t{\n\t\t\t\tthis.currentItem = null;\n\t\t\t}\n\n\t\t\tdelete this.Data[id];\n\t\t\tmenu.getPopupWindow().destroy();\n\t\t}\n\t}\n}","import Popup from '../popup/popup';\n\n/**\n * @deprecated use Popup class instead: import { Popup } from 'main.popup'\n */\nexport default class PopupWindow extends Popup\n{\n\n}","import Button from './button';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class PopupWindowButton extends Button\n{\n\n}","import Button from './button';\nimport { Dom } from 'main.core';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class ButtonLink extends Button\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.buttonNode = Dom.create(\n\t\t\t'span',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName:\n\t\t\t\t\t\t'popup-window-button popup-window-button-link' +\n\t\t\t\t\t\t(this.className.length > 0 ? ' ' + this.className : '')\n\t\t\t\t\t,\n\t\t\t\t\tid: this.id\n\t\t\t\t},\n\t\t\t\ttext: this.text,\n\t\t\t\tevents: this.contextEvents\n\t\t\t}\n\t\t);\n\t}\n}","import ButtonLink from './buttonlink';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class PopupWindowButtonLink extends ButtonLink\n{\n\n}","import Button from './button';\nimport { Dom } from 'main.core';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class CustomButton extends Button\n{\n\tconstructor(params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.buttonNode = Dom.create(\n\t\t\t'span',\n\t\t\t{\n\t\t\t\tprops: {\n\t\t\t\t\tclassName: (this.className.length > 0 ? this.className : ''),\n\t\t\t\t\tid: this.id\n\t\t\t\t},\n\t\t\t\tevents: this.contextEvents,\n\t\t\t\ttext: this.text\n\t\t\t}\n\t\t);\n\t}\n}","import CustomButton from './custombutton';\n\n/**\n * @deprecated use BX.UI.Button\n */\nexport default class PopupWindowCustomButton extends CustomButton\n{\n\n}","import Menu from '../menu/menu';\n\n/**\n * @deprecated use Menu class instead: import { Menu } from 'main.popup'\n */\nexport default class PopupMenuWindow extends Menu\n{\n\n}","import MenuItem from '../menu/menu-item';\n\n/**\n * @deprecated use Menu.Item class instead: import { MenuItem } from 'main.popup'\n */\nexport default class PopupMenuItem extends MenuItem\n{\n\n}","import { Dom } from 'main.core';\nimport Popup from '../popup/popup';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\n\n/**\n * @deprecated\n */\nexport default class InputPopup\n{\n\tconstructor(params)\n\t{\n\t\tthis.id = params.id || 'bx-inp-popup-' + Math.round(Math.random() * 1000000);\n\t\tthis.handler = params.handler || false;\n\t\tthis.values = params.values || false;\n\t\tthis.pInput = params.input;\n\t\tthis.bValues = !!this.values;\n\t\tthis.defaultValue = params.defaultValue || '';\n\t\tthis.openTitle = params.openTitle || '';\n\t\tthis.className = params.className || '';\n\t\tthis.noMRclassName = params.noMRclassName || 'ec-no-rm';\n\t\tthis.emptyClassName = params.noMRclassName || 'ec-label';\n\n\t\tconst _this = this;\n\t\tthis.curInd = false;\n\n\t\tif (this.bValues)\n\t\t{\n\t\t\tthis.pInput.onfocus = this.pInput.onclick = function(e) {\n\t\t\t\tif (this.value == _this.defaultValue)\n\t\t\t\t{\n\t\t\t\t\tthis.value = '';\n\t\t\t\t\tthis.className = _this.className;\n\t\t\t\t}\n\t\t\t\t_this.ShowPopup();\n\t\t\t\treturn e.preventDefault();\n\t\t\t};\n\n\t\t\tthis.pInput.onblur = function() {\n\t\t\t\tif (_this.bShowed)\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t_this.ClosePopup(true);\n\t\t\t\t\t}, 200);\n\t\t\t\t}\n\t\t\t\t_this.OnChange();\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.pInput.className = this.noMRclassName;\n\t\t\tthis.pInput.onblur = this.OnChange.bind(this);\n\t\t}\n\t}\n\n\tShowPopup()\n\t{\n\t\tif (this.bShowed)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst _this = this;\n\t\tif (!this.oPopup)\n\t\t{\n\t\t\tconst pWnd = Dom.create('DIV', { props: { className: 'bxecpl-loc-popup ' + this.className } });\n\n\t\t\tfor (let i = 0, l = this.values.length; i < l; i++)\n\t\t\t{\n\t\t\t\tconst pRow = pWnd.appendChild(Dom.create('DIV', {\n\t\t\t\t\tprops: { id: 'bxecmr_' + i },\n\t\t\t\t\ttext: this.values[i].NAME,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tmouseover: function() {\n\t\t\t\t\t\t\tDom.addClass(this, 'bxecplloc-over');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmouseout: function() {\n\t\t\t\t\t\t\tDom.removeClass(this, 'bxecplloc-over');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tclick: function() {\n\t\t\t\t\t\t\tconst ind = this.id.substr('bxecmr_'.length);\n\t\t\t\t\t\t\t_this.pInput.value = _this.values[ind].NAME;\n\t\t\t\t\t\t\t_this.curInd = ind;\n\t\t\t\t\t\t\t_this.OnChange();\n\t\t\t\t\t\t\t_this.ClosePopup(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tif (this.values[i].DESCRIPTION)\n\t\t\t\t{\n\t\t\t\t\tpRow.title = this.values[i].DESCRIPTION;\n\t\t\t\t}\n\t\t\t\tif (this.values[i].CLASS_NAME)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(pRow, this.values[i].CLASS_NAME);\n\t\t\t\t}\n\n\t\t\t\tif (this.values[i].URL)\n\t\t\t\t{\n\t\t\t\t\tpRow.appendChild(Dom.create('a', {\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\thref: this.values[i].URL,\n\t\t\t\t\t\t\tclassName: 'bxecplloc-view',\n\t\t\t\t\t\t\ttarget: '_blank',\n\t\t\t\t\t\t\ttitle: this.openTitle\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.oPopup = new Popup(this.id, this.pInput, {\n\t\t\t\tautoHide: true,\n\t\t\t\toffsetTop: 1,\n\t\t\t\toffsetLeft: 0,\n\t\t\t\tlightShadow: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tcontent: pWnd,\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: this.ClosePopup.bind(this)\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis.oPopup.show();\n\t\tthis.pInput.select();\n\t\tthis.bShowed = true;\n\n\t\tEventEmitter.emit(this, 'onInputPopupShow', new BaseEvent({ compatData: [this] }));\n\t}\n\n\tClosePopup(bClosePopup)\n\t{\n\t\tthis.bShowed = false;\n\n\t\tif (this.pInput.value === '')\n\t\t{\n\t\t\tthis.OnChange();\n\t\t}\n\n\t\tEventEmitter.emit(this, 'onInputPopupClose', new BaseEvent({ compatData: [this] }));\n\n\t\tif (bClosePopup === true)\n\t\t{\n\t\t\tthis.oPopup.close();\n\t\t}\n\t}\n\n\tOnChange()\n\t{\n\t\tlet val = this.pInput.value;\n\t\tif (this.bValues)\n\t\t{\n\t\t\tif (this.pInput.value == '' || this.pInput.value == this.defaultValue)\n\t\t\t{\n\t\t\t\tthis.pInput.value = this.defaultValue;\n\t\t\t\tthis.pInput.className = this.emptyClassName;\n\t\t\t\tval = '';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.pInput.className = '';\n\t\t\t}\n\t\t}\n\n\t\tif (isNaN(parseInt(this.curInd)) || this.curInd !== false && val != this.values[this.curInd].NAME)\n\t\t{\n\t\t\tthis.curInd = false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.curInd = parseInt(this.curInd);\n\t\t}\n\n\t\tEventEmitter.emit(\n\t\t\tthis,\n\t\t\t'onInputPopupChanged',\n\t\t\tnew BaseEvent({ compatData: [this, this.curInd, val] })\n\t\t);\n\n\t\tif (this.handler && typeof this.handler == 'function')\n\t\t{\n\t\t\tthis.handler({ ind: this.curInd, value: val });\n\t\t}\n\t}\n\n\tSet(ind, val, bOnChange)\n\t{\n\t\tthis.curInd = ind;\n\t\tif (this.curInd !== false)\n\t\t{\n\t\t\tthis.pInput.value = this.values[this.curInd].NAME;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.pInput.value = val;\n\t\t}\n\n\t\tif (bOnChange !== false)\n\t\t{\n\t\t\tthis.OnChange();\n\t\t}\n\t}\n\n\tGet(ind)\n\t{\n\t\tlet id = false;\n\t\tif (typeof ind == 'undefined')\n\t\t{\n\t\t\tind = this.curInd;\n\t\t}\n\n\t\tif (ind !== false && this.values[ind])\n\t\t{\n\t\t\tid = this.values[ind].ID;\n\t\t}\n\n\t\treturn id;\n\t}\n\n\tGetIndex(id)\n\t{\n\t\tfor (let i = 0, l = this.values.length; i < l; i++)\n\t\t{\n\t\t\tif (this.values[i].ID == id)\n\t\t\t{\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tDeactivate(bDeactivate)\n\t{\n\t\tif (this.pInput.value == '' || this.pInput.value == this.defaultValue)\n\t\t{\n\t\t\tif (bDeactivate)\n\t\t\t{\n\t\t\t\tthis.pInput.value = '';\n\t\t\t\tthis.pInput.className = this.noMRclassName;\n\t\t\t}\n\t\t\telse if (this.oEC.bUseMR)\n\t\t\t{\n\t\t\t\tthis.pInput.value = this.defaultValue;\n\t\t\t\tthis.pInput.className = this.emptyClassName;\n\t\t\t}\n\t\t}\n\n\t\tthis.pInput.disabled = bDeactivate;\n\t}\n}","/*\n\n//ES6\nimport { Popup, PopupManager, CloseIconSize } from 'main.popup';\nconst popup = new Popup();\nPopupManager.create();\n\n//ES5\nvar popup = new BX.Main.Popup();\nBX.Main.PopupManager.create();\nBX.Main.Popup.CloseIconSize;\n\n//ES6\nimport { Menu, MenuItem, MenuManager } from 'main.popup';\nconst menu = new Menu();\nconst item = new MenuItem();\nMenuManager.create();\n\n//ES5\nvar menu = new BX.Main.Menu();\nvar item = new BX.Main.MenuItem();\nBX.Main.MenuManager.create();\n\n */\n\nimport Popup from './popup/popup';\nimport PopupManager from './popup/popup-manager';\nimport CloseIconSize from './popup/popup-close-icon-size';\nimport Menu from './menu/menu';\nimport MenuManager from './menu/menu-manager';\nimport MenuItem from './menu/menu-item';\nimport type { PopupOptions, PopupTarget, PopupTargetOptions, PopupAnimationOptions } from './popup/popup-types';\nimport { type MenuOptions, type MenuItemOptions } from './menu/menu-types';\nimport type PositionEvent from './popup/position-event';\n\nimport PopupWindow from './compatibility/popup-window';\nimport PopupWindowButton from './compatibility/popup-window-button';\nimport PopupWindowButtonLink from './compatibility/popup-window-button-link';\nimport PopupWindowCustomButton from './compatibility/popup-window-custom-button';\nimport PopupMenuWindow from './compatibility/popup-menu-window';\nimport PopupMenuItem from './compatibility/popup-menu-item';\nimport InputPopup from './compatibility/input-popup';\nimport Button from './compatibility/button';\nimport ButtonLink from './compatibility/buttonlink';\nimport CustomButton from './compatibility/custombutton';\n\nimport { Reflection } from 'main.core';\n\nimport 'ui.design-tokens';\nimport 'ui.fonts.opensans';\nimport './css/popup.css';\n\nexport {\n\tPopup,\n\tMenu,\n\tMenuItem,\n\tPopupManager,\n\tMenuManager,\n\tCloseIconSize,\n};\n\nexport type {\n\tPopupOptions,\n\tPopupTarget,\n\tPopupTargetOptions,\n\tPopupAnimationOptions,\n\tMenuOptions,\n\tMenuItemOptions,\n\tPositionEvent,\n};\n\n//Compatibility\nexport {\n\tPopupWindow,\n\tPopupMenuWindow,\n\tPopupMenuItem,\n\tPopupManager as PopupWindowManager,\n\tMenuManager as PopupMenu,\n\tPopupWindowButton,\n\tPopupWindowButtonLink,\n\tPopupWindowCustomButton\n};\n\nconst BX = Reflection.namespace('BX');\n\n/** @deprecated use BX.Main.Popup or import { Popup } from 'main.popup' */\nBX.PopupWindow = Popup;\n\n/** @deprecated use BX.Main.PopupManager or import { PopupManager } from 'main.popup' */\nBX.PopupWindowManager = PopupManager;\n\n/** @deprecated use BX.Main.Menu or import { Menu } from 'main.popup' */\nBX.PopupMenuWindow = Menu;\n\n/** @deprecated use BX.Main.MenuManager or import { MenuManager } from 'main.popup' */\nBX.PopupMenu = MenuManager;\n\n/** @deprecated use BX.Main.MenuItem or import { MenuItem } from 'main.popup' */\nBX.PopupMenuItem = MenuItem;\n\n/** @deprecated use BX.UI.Button */\nBX.PopupWindowButton = Button;\n\n/** @deprecated use BX.UI.Button */\nBX.PopupWindowButtonLink = ButtonLink;\n\n/** @deprecated use BX.UI.Button */\nBX.PopupWindowCustomButton = CustomButton;\n\n/** @deprecated use another API */\nwindow.BXInputPopup = InputPopup;\n"],"names":["Button","params","popupWindow","text","id","className","events","contextEvents","eventName","Type","isFunction","bind","buttonNode","Dom","create","props","length","name","clean","adjust","isString","removeClass","addClass","PositionEvent","value","isNumber","BaseEvent","CloseIconSize","Object","freeze","LARGE","SMALL","aliases","onPopupWindowInit","namespace","onPopupWindowIsInitialized","onPopupFirstShow","onPopupShow","onAfterPopupShow","onPopupClose","onPopupAfterClose","onPopupDestroy","onPopupFullscreenLeave","onPopupFullscreenEnter","onPopupDragStart","onPopupDrag","onPopupDragEnd","onPopupResizeStart","onPopupResize","onPopupResizeEnd","EventEmitter","registerAliases","disabledScrolls","WeakMap","Popup","options","isPlainObject","option","defaultValue","isUndefined","defaultOptions","event","isDestroyed","autoHideHandler","_tryCloseByEvent","target","getPopupContainer","contains","keyCode","checkEscPressed","getZindex","close","setEventNamespace","arguments","popupId","bindElement","compatibleMode","isBoolean","isStringFilled","Text","getRandom","toLowerCase","emit","compatData","uniquePopupId","zIndex","parseInt","zIndexAbsolute","buttons","isArray","offsetTop","getOption","offsetLeft","firstShow","bordersWidth","bindElementPos","closeIcon","resizeIcon","angle","angleArrowElement","overlay","titleBar","bindOptions","isObject","autoHide","disableScroll","isScrollBlock","isAutoHideBinded","closeByEsc","isCloseByEscBinded","toFrontOnShow","cacheable","destroyed","fixed","width","height","minWidth","minHeight","maxWidth","maxHeight","padding","contentPadding","background","contentBackground","borderRadius","contentBorderRadius","setTargetContainer","targetContainer","dragOptions","cursor","callback","dragged","dragPageX","dragPageY","animationShowClassName","animationCloseClassName","animationCloseEventType","handleDocumentMouseMove","handleDocumentMouseUp","handleResizeWindow","handleResize","handleMove","onTitleMouseDown","handleFullScreen","subscribeFromOptions","popupClassName","darkMode","designSystemContext","Tag","render","values","includes","closeIconSize","handleCloseIconClick","style","contentContainer","popupContainer","getTargetContainer","append","zIndexComponent","ZIndexManager","register","zIndexOptions","buttonsContainer","contentColor","setContentColor","setAngle","setOverlay","setOffset","setBindElement","setTitleBar","setDraggable","draggable","setContent","content","setButtons","setWidth","setHeight","setMinWidth","setMinHeight","setMaxWidth","setMaxHeight","setResizeMode","resizable","setPadding","setContentPadding","setBorderRadius","setContentBorderRadius","setBackground","setContentBackground","setAnimation","animation","setCacheable","setToFrontOnShow","setFixed","setDesignSystemContext","contentNoPaddings","noAllPaddings","bindOnResize","Event","window","isElementNode","hasParent","isDomNode","parentNode","appendChild","isCompatibleMode","display","innerHTML","remove","ButtonClass","Reflection","getClass","newButtons","i","button","push","setContext","getId","top","left","clientX","clientY","pageX","pageY","bottom","isTargetDocumentBody","isFixed","getBoundingClientRect","getPosition","getPositionRelativeToTarget","windowSize","getWindowSize","windowScroll","getWindowScroll","popupWidth","offsetWidth","popupHeight","offsetHeight","forceTop","innerWidth","scrollLeft","innerHeight","scrollTop","element","offsetElement","offsetParent","elementRect","DOMRect","pageXOffset","pageYOffset","position","angleMinLeft","defaultOffset","offset","angleLeftOffset","Math","max","minOffset","maxOffset","min","marginLeft","removeProperty","setWidthProperty","setHeightProperty","property","getResizableContainer","getContentContainer","overflowX","classList","add","toKebabCase","hasOtherProps","some","prop","getPropertyValue","overflowY","radius","setProperty","color","backgroundColor","flag","mode","handleResizeMouseDown","context","newTargetContainer","document","body","unregister","resizeContentPos","resizeContentOffset","offsetX","offsetY","scrollWidth","documentElement","getMinWidth","getMinHeight","getMaxWidth","getMaxHeight","isTopOrBottomAngle","enable","bindClosingByEsc","unbindClosingByEsc","ownerDocument","handleDocumentKeyUp","unbind","bindAutoHide","unbindAutoHide","isShown","handleContainerClick","hasOverlay","handleAutoHide","tryCloseByEvent","setTimeout","stopPropagation","handleOverlayClick","resizeOverlay","getZIndexComponent","opacity","parseFloat","toPrecision","blur","overlayTimeout","clearInterval","setInterval","scrollHeight","clientHeight","getZIndex","disable","showOverlay","shouldFrontOnShow","bringToFront","adjustPosition","animateOpening","animateClosing","hideOverlay","isCacheable","destroy","show","addEventListener","handleTransitionEnd","hasClass","removeEventListener","showClassName","closeClassName","closeAnimationType","animationName","unbindAll","removeOverlay","getBindElementPos","forceBindPosition","bindElementVanished","angleTopOffset","forceLeft","bindLeft","isBottomAngle","isTopAngle","getAngleHeight","fullscreenStatus","cancelFullScreen","mozCancelFullScreen","webkitCancelFullScreen","requestFullScreen","mozRequestFullScreen","webkitRequestFullScreen","console","log","restrict","floatWidth","floatHeight","releaseCapture","ondrag","onselectstart","MozUserSelect","preventDefault","popups","get","Set","set","size","setCapture","positionTopXOffset","popupZindex","popupOverlayZindex","angleMaxLeft","angleMinRight","angleMaxRight","angleMinBottom","angleMaxBottom","angleMinTop","angleMaxTop","escCallbackIndex","escCallback","PopupManager","Error","compatMode","getPopupById","subscribe","handlePopupShow","handlePopupClose","getTarget","subscribeOnce","handlePopupDestroy","_popups","forEach","popup","error","filter","_currentPopup","getPopups","handleOnAfterInit","onSubMenuShow","onSubMenuClose","reEscape","escapeEntities","encodeSafe","replace","item","MenuItem","allowHtml","html","match","warn","getText","title","delimiter","href","dataset","menuShowDelay","subMenuOffsetX","_items","items","disabled","onclick","menuWindow","subMenuWindow","layout","getLayout","hasOwnProperty","join","children","hasSubMenu","attrs","click","onItemClick","isDisabled","onItemMouseEnter","onItemMouseLeave","getTextContainer","outerHTML","getMenuWindow","getPopupWindow","addSubMenu","closeSiblings","closeChildren","adjustSubMenu","rootMenuWindow","getRootMenuWindow","rootOptions","assign","subMenuOptions","Menu","setParentMenuWindow","setParentMenuItem","handleSubMenuDestroy","clearSubMenuTimeout","siblings","getMenuItems","closeSubMenu","destroyChildren","destroySubMenu","itemRect","getPopupPadding","angleOffset","anglePosition","popupBottom","isGlobalContext","clientWidth","exceeded","roundOffset","ceil","rect","popupPadding","menuContainer","menu","getContainer","call","mouseEvent","data","thisArg","isDefaultPrevented","subMenuTimeout","showSubMenu","clearTimeout","menuItems","itemsContainer","parentMenuWindow","parentMenuItem","addMenuItemInternal","__createPopup","domItems","itemLayout","defaults","onClose","onDestroy","containsTarget","el","getSubMenu","parentMenu","root","parent","getParentMenuWindow","parentItem","menuItemJson","targetItemId","menuItem","targetItem","getMenuItem","targetLayout","insertBefore","setMenuWindow","getMenuItemPosition","splice","itemId","destroyEmptyPopup","getParentMenuItem","removeChild","MenuManager","currentItem","args","apply","menuId","Data","popupMenuWindow","getMenuById","PopupWindow","PopupWindowButton","ButtonLink","PopupWindowButtonLink","CustomButton","PopupWindowCustomButton","PopupMenuWindow","PopupMenuItem","InputPopup","round","random","handler","pInput","input","bValues","openTitle","noMRclassName","emptyClassName","_this","curInd","onfocus","e","ShowPopup","onblur","bShowed","ClosePopup","OnChange","oPopup","pWnd","l","pRow","NAME","mouseover","mouseout","ind","substr","DESCRIPTION","CLASS_NAME","URL","lightShadow","select","bClosePopup","val","isNaN","bOnChange","ID","bDeactivate","oEC","bUseMR","BX","PopupWindowManager","PopupMenu","BXInputPopup"],"mappings":"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"}